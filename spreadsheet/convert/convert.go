//
// Copyright 2020 FoxyUtils ehf. All rights reserved.
//
// This is a commercial product and requires a license to operate.
// A trial license can be obtained at https://unidoc.io
//
// DO NOT EDIT: generated by unitwist Go source code obfuscator.
//
// Use of this source code is governed by the UniDoc End User License Agreement
// terms that can be accessed at https://unidoc.io/eula/

package convert ;import (_ac "github.com/unidoc/unioffice/common/logger";_cd "github.com/unidoc/unioffice/common/tempstorage";_fg "github.com/unidoc/unioffice/internal/convertutils";_e "github.com/unidoc/unioffice/measurement";_g "github.com/unidoc/unioffice/schema/soo/dml";_ca "github.com/unidoc/unioffice/schema/soo/dml/chart";_gf "github.com/unidoc/unioffice/schema/soo/ofc/sharedTypes";_df "github.com/unidoc/unioffice/schema/soo/sml";_bb "github.com/unidoc/unioffice/spreadsheet";_ag "github.com/unidoc/unioffice/spreadsheet/reference";_b "github.com/unidoc/unipdf/v3/creator";_f "github.com/unidoc/unipdf/v3/model";_c "image";_d "strconv";);func (_ba *convertContext )makeAnchors (){_gaf ,_fa :=_ba ._dbcb .GetDrawing ();if _gaf !=nil {for _ ,_aa :=range _gaf .EG_Anchor {_aac :=&anchor {};if _dd :=_aa .TwoCellAnchor ;_dd !=nil {_gab ,_acg :=_dd .From ,_dd .To ;if _gab ==nil ||_acg ==nil {return ;};_aac ._def =int (_gab .Row );_aac ._aef =_fg .FromSTCoordinate (_gab .RowOff );_aac ._dcab =int (_gab .Col );_aac ._gbca =_fg .FromSTCoordinate (_gab .ColOff );_aac ._afaf =int (_acg .Row );_aac ._bbca =_fg .FromSTCoordinate (_acg .RowOff );_aac ._feb =int (_acg .Col );_aac ._bff =_fg .FromSTCoordinate (_acg .ColOff );if _cg :=_dd .Choice ;_cg !=nil {if _bac :=_cg .Pic ;_bac !=nil {if _aacg :=_bac .BlipFill ;_aacg !=nil {if _cbd :=_aacg .Blip ;_cbd !=nil {if _cbf :=_cbd .EmbedAttr ;_cbf !=nil {for _ ,_gdb :=range _fa .X ().Relationship {if _gdb .IdAttr ==*_cbf {for _ ,_ddb :=range _ba ._cece .Images {if _ddb .Target ()==_gdb .TargetAttr {_be ,_ea :=_cd .Open (_ddb .Path ());if _ea !=nil {_ac .Log .Debug ("\u004fp\u0065\u006e\u0020\u0069m\u0061\u0067\u0065\u0020\u0066i\u006ce\u0020e\u0072\u0072\u006f\u0072\u003a\u0020\u0025s",_ea );continue ;};_aff ,_ ,_ea :=_c .Decode (_be );if _ea !=nil {_ac .Log .Debug ("\u0044\u0065\u0063\u006fde\u0020\u0069\u006d\u0061\u0067\u0065\u0020\u0065\u0072\u0072\u006f\u0072\u003a\u0020%\u0073",_ea );continue ;};_aac ._acdge =_aff ;};};};};};};};}else if _gea :=_cg .GraphicFrame ;_gea !=nil {if _bg :=_gea .Graphic ;_bg !=nil {if _ccc :=_bg .GraphicData ;_ccc !=nil {for _ ,_gge :=range _ccc .Any {if _ee ,_cgb :=_gge .(*_ca .Chart );_cgb {for _ ,_efd :=range _fa .X ().Relationship {if _efd .IdAttr ==_ee .IdAttr {_cccd :=_ba ._cece .GetChartByTargetId (_efd .TargetAttr );if _cccd !=nil {_aac ._bdga =_cccd ;};};};};};};};};};};if _aac ._acdge !=nil ||_aac ._bdga !=nil {_ba ._bag =append (_ba ._bag ,_aac );};};};};

// RegisterFontsFromDirectory registers all fonts from the given directory automatically detecting font families and styles.
func RegisterFontsFromDirectory (dirName string )error {return _fg .RegisterFontsFromDirectory (dirName )};func (_gee *convertContext )getContentFromCell (_ddd _bb .Cell ,_bbf *style ,_gbb float64 ,_bdf bool )([]*line ,_df .ST_CellType ){_cca :=_ddd .X ();var _cfea []*symbol ;switch _cca .TAttr {case _df .ST_CellTypeS :_ccdf :=_cca .V ;if _ccdf !=nil {_cbcd ,_afbd :=_d .Atoi (*_ccdf );if _afbd ==nil {_gage :=_gee ._cece .SharedStrings .X ().Si [_cbcd ];if _gage .T !=nil {_cfea =_gee .getSymbolsFromString (*_gage .T ,_bbf );}else if _gage .R !=nil {_cfea =_gee .getSymbolsFromR (_gage .R ,_bbf );};};};case _df .ST_CellTypeB :_ccg :=_cca .V ;if _ccg !=nil {if *_ccg =="\u0030"{_cfea =_gee .getSymbolsFromString ("\u0046\u0041\u004cS\u0045",_bbf );}else {_cfea =_gee .getSymbolsFromString ("\u0054\u0052\u0055\u0045",_bbf );};};default:_cfea =_gee .getSymbolsFromString (_ddd .GetFormattedValue (),_bbf );};_bfg :=0.0;_bcbg :=0.0;var _acb []*line ;var _gfdc bool ;if _bbf !=nil {if _bbf ._bbb !=nil {if *_bbf ._bbb {_gfdc =true ;};};if _bbf ._bcdd !=nil {if *_bbf ._bcdd {_gfdc =true ;};};};if _bdf {_acb =[]*line {};_cda :=_gbb -2*_agc ;_caf :=[]*symbol {};for _ ,_bad :=range _cfea {_bcad (_bad );if _bfg +_bad ._befd >=_cda {_aea :=_bcd (_caf );if _gfdc {_aea /=_ad ;};_acb =append (_acb ,&line {_ggdg :_bcbg ,_bebd :_caf ,_cbe :_aea });_caf =[]*symbol {_bad };_bfg =_bad ._befd ;_bcbg +=_aea ;}else {_bad ._agfa =_bfg ;_bfg +=_bad ._befd ;_caf =append (_caf ,_bad );};};_badg :=_bcd (_caf );if _gfdc {_badg /=_ad ;};if len (_caf )> 0{_acb =append (_acb ,&line {_ggdg :_bcbg ,_bebd :_caf ,_cbe :_badg });};}else {for _ ,_fcc :=range _cfea {_bcad (_fcc );_fcc ._agfa =_bfg ;_bfg +=_fcc ._befd ;};if len (_cfea )> 0{_acb =[]*line {&line {_bebd :_cfea ,_cbe :_bcd (_cfea )}};};};_fee :=_cca .TAttr ;if _fee ==_df .ST_CellTypeUnset {_fee =_df .ST_CellTypeN ;};return _acb ,_fee ;};func (_ddbe *convertContext )makePagespans (){_ddbe ._ddeg =[]*pagespan {};_acdg :=0.0;_fgfd :=0;for _egg ,_ffbd :=range _ddbe ._cdg {_dgg :=_ffbd ._deb ;if _acdg +_dgg <=_ddbe ._ceda {_ffbd ._cace =_acdg ;_acdg +=_dgg ;}else {_ffbd ._cace =0;_ddbe ._ddeg =append (_ddbe ._ddeg ,&pagespan {_cfd :_acdg ,_eae :_fgfd ,_geae :_egg });_acdg =_dgg ;_fgfd =_egg ;};};_ddbe ._ddeg =append (_ddbe ._ddeg ,&pagespan {_cfd :_acdg ,_eae :_fgfd ,_geae :len (_ddbe ._cdg )});};func (_bbfd *convertContext )getStyleFromCell (_bbfcc _bb .Cell ,_ccgg ,_agef *style )*style {_gcgee :=_bbfcc .X ();_efce :=_bbfd .getStyle (_gcgee .SAttr );_bfged (_efce ,_ccgg );_bfged (_efce ,_agef );return _efce ;};type symbol struct{_gcaa string ;_agfa float64 ;_ebg float64 ;_befd float64 ;_adea *_b .TextStyle ;_fea string ;};func _bcd (_efa []*symbol )float64 {_bde :=0.0;for _ ,_abd :=range _efa {if _abd ._ebg > _bde {_bde =_abd ._ebg ;};};return _bde ;};func (_bcb *convertContext )distributeAnchors (){for _ ,_adgf :=range _bcb ._bag {_fdc ,_fge :=_adgf ._def ,_adgf ._aef ;_dgbf ,_fbcb :=_adgf ._dcab ,_adgf ._gbca ;_bce ,_egc :=_adgf ._afaf ,_adgf ._bbca ;_adfa ,_gffc :=_adgf ._feb ,_adgf ._bff ;var _baf ,_ggb ,_ffda ,_bccg *page ;for _ ,_cf :=range _bcb ._ddeg {for _ ,_ddee :=range _cf ._gagc {if _fdc >=_ddee ._gdfe ._dggf &&_fdc < _ddee ._gdfe ._bfb {if _dgbf >=_ddee ._efdb ._eae &&_dgbf < _ddee ._efdb ._geae {_ddee ._ddae =true ;_baf =_ddee ;};if _adfa >=_ddee ._efdb ._eae &&_adfa < _ddee ._efdb ._geae {_ddee ._ddae =true ;_ggb =_ddee ;};};if _bce >=_ddee ._gdfe ._dggf &&_bce < _ddee ._gdfe ._bfb {if _dgbf >=_ddee ._efdb ._eae &&_dgbf < _ddee ._efdb ._geae {_ddee ._ddae =true ;_bccg =_ddee ;};if _adfa >=_ddee ._efdb ._eae &&_adfa < _ddee ._efdb ._geae {_ddee ._ddae =true ;_ffda =_ddee ;};};};};_beg :=_baf !=_ggb ;_fbce :=_baf !=_bccg ;if _beg &&_fbce {_acdd :=_bcb ._cdg [_dgbf ]._cace +_e .FromEMU (_fbcb );_gbd :=_baf ._efdb ._cfd ;_ddc :=_bcb ._cdg [_adfa ]._cace +_e .FromEMU (_gffc );_cfe :=_bcb ._cdag [_fdc ]._baed +_e .FromEMU (_fge );_aab :=float64 (_baf ._gdfe ._ffbe );_dcd :=_bcb ._cdag [_bce ]._baed +_e .FromEMU (_egc );_abg :=_ddc +_gbd -_acdd ;_cfg :=_dcd +_aab -_cfe ;_fdda :=_bcb .imageFromAnchor (_adgf ,_abg ,_cfg );_baf ._eca =append (_baf ._eca ,_bcb .getImage (_fdda ,_cfg ,_abg ,_acdd ,_cfe ,_gbd -_acdd ,_aab -_cfe ,_fg .ImgPart_lt ));_ggb ._eca =append (_ggb ._eca ,_bcb .getImage (_fdda ,_cfg ,_abg ,0,_cfe ,_gbd -_acdd ,_aab -_cfe ,_fg .ImgPart_rt ));_bccg ._eca =append (_bccg ._eca ,_bcb .getImage (_fdda ,_cfg ,_abg ,_acdd ,0,_gbd -_acdd ,_aab -_cfe ,_fg .ImgPart_lb ));_ffda ._eca =append (_ffda ._eca ,_bcb .getImage (_fdda ,_cfg ,_abg ,0,0,_gbd -_acdd ,_aab -_cfe ,_fg .ImgPart_rb ));}else if _beg {_gfdg :=_bcb ._cdag [_fdc ]._baed +_e .FromEMU (_fge );_dff :=_bcb ._cdag [_bce ]._baed +_e .FromEMU (_egc );_gfc :=_bcb ._cdg [_dgbf ]._cace +_e .FromEMU (_fbcb );_fda :=_baf ._efdb ._cfd ;_gdbd :=_bcb ._cdg [_adfa ]._cace +_e .FromEMU (_gffc );_gec :=_gdbd +_fda -_gfc ;_adc :=_dff -_gfdg ;_ggdc :=_bcb .imageFromAnchor (_adgf ,_gec ,_adc );_baf ._eca =append (_baf ._eca ,_bcb .getImage (_ggdc ,_adc ,_gec ,_gfc ,_gfdg ,_fda -_gfc ,0,_fg .ImgPart_l ));_ggb ._eca =append (_ggb ._eca ,_bcb .getImage (_ggdc ,_adc ,_gec ,0,_gfdg ,_fda -_gfc ,0,_fg .ImgPart_r ));}else if _fbce {_gad :=_bcb ._cdg [_dgbf ]._cace +_e .FromEMU (_fbcb );_bga :=_bcb ._cdg [_adfa ]._cace +_e .FromEMU (_gffc );_gaa :=_bcb ._cdag [_fdc ]._baed +_e .FromEMU (_fge );_gef :=float64 (_baf ._gdfe ._ffbe );_beb :=_bcb ._cdag [_bce ]._baed +_e .FromEMU (_egc );_db :=_bga -_gad ;_ceg :=_beb +_gef -_gaa ;_fgeg :=_bcb .imageFromAnchor (_adgf ,_db ,_ceg );_baf ._eca =append (_baf ._eca ,_bcb .getImage (_fgeg ,_ceg ,_db ,_gad ,_gaa ,0,_gef -_gaa ,_fg .ImgPart_t ));_bccg ._eca =append (_bccg ._eca ,_bcb .getImage (_fgeg ,_ceg ,_db ,_gad ,0,0,_gef -_gaa ,_fg .ImgPart_b ));}else {_edb :=_bcb ._cdg [_dgbf ]._cace +_e .FromEMU (_fbcb );_edc :=_bcb ._cdg [_adfa ]._cace +_e .FromEMU (_gffc );_ddeeg :=_bcb ._cdag [_fdc ]._baed +_e .FromEMU (_fge );_begd :=_bcb ._cdag [_bce ]._baed +_e .FromEMU (_egc );_cbfg :=_edc -_edb ;_fae :=_begd -_ddeeg ;_dba :=_bcb .imageFromAnchor (_adgf ,_cbfg ,_fae );_baf ._eca =append (_baf ._eca ,_bcb .getImage (_dba ,_fae ,_cbfg ,_edb ,_ddeeg ,0,0,_fg .ImgPart_whole ));};};};const _agc =3;type style struct{_ddca *string ;_gggg *float64 ;_dag *string ;_fbbd *bool ;_gcb *bool ;_caff *bool ;_bbb *bool ;_bcdd *bool ;_bbg *border ;_eba *border ;_cfa *border ;_bgcf *border ;_agbe bool ;_geec _df .ST_VerticalAlignment ;_ccb _df .ST_HorizontalAlignment ;};const _gc =1.5;var _dbbe =[]string {"\u0030\u0030\u0030\u0030\u0030\u0030","\u0066\u0066\u0066\u0066\u0066\u0066","\u0066\u0066\u0030\u0030\u0030\u0030","\u0030\u0030\u0066\u0066\u0030\u0030","\u0030\u0030\u0030\u0030\u0066\u0066","\u0066\u0066\u0066\u0066\u0030\u0030","\u0066\u0066\u0030\u0030\u0066\u0066","\u0030\u0030\u0066\u0066\u0066\u0066","\u0030\u0030\u0030\u0030\u0030\u0030","\u0066\u0066\u0066\u0066\u0066\u0066","\u0066\u0066\u0030\u0030\u0030\u0030","\u0030\u0030\u0066\u0066\u0030\u0030","\u0030\u0030\u0030\u0030\u0066\u0066","\u0066\u0066\u0066\u0066\u0030\u0030","\u0066\u0066\u0030\u0030\u0066\u0066","\u0030\u0030\u0066\u0066\u0066\u0066","\u0038\u0030\u0030\u0030\u0030\u0030","\u0030\u0030\u0038\u0030\u0030\u0030","\u0030\u0030\u0030\u0030\u0038\u0030","\u0038\u0030\u0038\u0030\u0030\u0030","\u0038\u0030\u0030\u0030\u0038\u0030","\u0030\u0030\u0038\u0030\u0038\u0030","\u0063\u0030\u0063\u0030\u0063\u0030","\u0038\u0030\u0038\u0030\u0038\u0030","\u0039\u0039\u0039\u0039\u0066\u0066","\u0039\u0039\u0033\u0033\u0036\u0036","\u0066\u0066\u0066\u0066\u0063\u0063","\u0063\u0063\u0066\u0066\u0066\u0066","\u0036\u0036\u0030\u0030\u0036\u0036","\u0066\u0066\u0038\u0030\u0038\u0030","\u0030\u0030\u0036\u0036\u0063\u0063","\u0063\u0063\u0063\u0063\u0066\u0066","\u0030\u0030\u0030\u0030\u0038\u0030","\u0066\u0066\u0030\u0030\u0066\u0066","\u0066\u0066\u0066\u0066\u0030\u0030","\u0030\u0030\u0066\u0066\u0066\u0066","\u0038\u0030\u0030\u0030\u0038\u0030","\u0038\u0030\u0030\u0030\u0030\u0030","\u0030\u0030\u0038\u0030\u0038\u0030","\u0030\u0030\u0030\u0030\u0066\u0066","\u0030\u0030\u0063\u0063\u0066\u0066","\u0063\u0063\u0066\u0066\u0066\u0066","\u0063\u0063\u0066\u0066\u0063\u0063","\u0066\u0066\u0066\u0066\u0039\u0039","\u0039\u0039\u0063\u0063\u0066\u0066","\u0066\u0066\u0039\u0039\u0063\u0063","\u0063\u0063\u0039\u0039\u0066\u0066","\u0066\u0066\u0063\u0063\u0039\u0039","\u0033\u0033\u0036\u0036\u0066\u0066","\u0033\u0033\u0063\u0063\u0063\u0063","\u0039\u0039\u0063\u0063\u0030\u0030","\u0066\u0066\u0063\u0063\u0030\u0030","\u0066\u0066\u0039\u0039\u0030\u0030","\u0066\u0066\u0036\u0036\u0030\u0030","\u0036\u0036\u0036\u0036\u0039\u0039","\u0039\u0036\u0039\u0036\u0039\u0036","\u0030\u0030\u0033\u0033\u0036\u0036","\u0033\u0033\u0039\u0039\u0036\u0036","\u0030\u0030\u0033\u0033\u0030\u0030","\u0033\u0033\u0033\u0033\u0030\u0030","\u0039\u0039\u0033\u0033\u0030\u0030","\u0039\u0039\u0033\u0033\u0036\u0036","\u0033\u0033\u0033\u0033\u0039\u0039","\u0033\u0033\u0033\u0033\u0033\u0033"};func _afcg (_bgd []*symbol )float64 {_bceg :=0.0;for _ ,_ddcc :=range _bgd {_bceg +=_ddcc ._befd ;};return _bceg ;};

// ConvertToPdf converts a sheet to a PDF file. This package is beta, breaking changes can take place.
func ConvertToPdf (s *_bb .Sheet )*_b .Creator {_afd :=s .X ();if _afd ==nil {return nil ;};var _bf _b .PageSize ;var _gb bool ;if _ge :=_afd .PageSetup ;_ge !=nil {if _gd :=_ge .PaperSizeAttr ;_gd !=nil {_bf =_efcd [*_gd ];};_gb =_ge .OrientationAttr ==_df .ST_OrientationLandscape ;};if (_bf ==_b .PageSize {}){_bf =_efcd [1];};if _gb {_bf [0],_bf [1]=_bf [1],_bf [0];};_cdf :=_b .New ();_cdf .SetPageSize (_bf );var _agd ,_cb ,_afdd ,_gg float64 ;if _ef :=_afd .PageMargins ;_ef !=nil {_afdd =_ef .LeftAttr ;_gg =_ef .RightAttr ;_agd =_ef .TopAttr ;_cb =_ef .BottomAttr ;};if _afdd < 0.25{_afdd =0.25;};if _gg < 0.25{_gg =0.25;};_agd *=_e .Inch ;_cb *=_e .Inch ;_afdd *=_e .Inch ;_gg *=_e .Inch ;_cdf .SetPageMargins (_afdd ,_gg ,_agd ,_cb );_dg :=s .Workbook ();var _dc *_g .Theme ;if len (_dg .Themes ())> 0{_dc =_dg .Themes ()[0];};_dgb :=&convertContext {_ecc :_cdf ,_dbcb :s ,_cece :s .Workbook (),_agbg :_dc ,_ceca :&s .Workbook ().StyleSheet ,_fde :_agd ,_beac :_afdd ,_ebf :_bf [1]-_cb -_agd ,_ceda :_bf [0]-_gg -_afdd };_dgb .makeAnchors ();_dgb .determineMaxIndexes ();if _dgb ._dbf ==0&&_dgb ._agfd ==0{_cdf .NewPage ();return _cdf ;};_dgb .makeCols ();_dgb .makeRows ();_dgb .makeMergedCells ();_dgb .makeCells ();_dgb .makePagespans ();_dgb .makeRowspans ();_dgb .makePages ();_dgb .fillPages ();_dgb .distributeAnchors ();_dgb .drawSheet ();return _cdf ;};var _ga =_gga (1);type rowInfo struct{_baed float64 ;_ffgc bool ;_fgfe float64 ;_aaab *style ;_acc []*cell ;_eff float64 ;};func (_dec *convertContext )alignSymbolsVertically (_fac *cell ,_cfb _df .ST_VerticalAlignment ){var _ebc float64 ;switch _cfb {case _df .ST_VerticalAlignmentTop :_ebc =_bba ;if _fac ._aec {_ebc -=_gc ;}else if _fac ._gcgdd {_ebc +=4*_gc ;};for _ ,_dbd :=range _fac ._cba {_ebc +=_dbd ._cbe ;_dbd ._ggdg =_ebc ;_ebc +=_ga ;};case _df .ST_VerticalAlignmentCenter :_acda :=0.0;for _ ,_cgbc :=range _fac ._cba {_acda +=_cgbc ._cbe +_gga (1);};_ebc =0.5*(_fac ._aaac -_acda );if _fac ._aec {_ebc -=2*_gc ;}else if _fac ._gcgdd {_ebc +=2*_gc ;};for _ ,_gcfc :=range _fac ._cba {_ebc +=_gcfc ._cbe +0.5*_ga ;_gcfc ._ggdg =_ebc ;_ebc +=0.5*_ga ;};default:_ebc =_fac ._aaac -_bba ;if _fac ._aec {_ebc -=4*_gc ;}else if _fac ._gcgdd {_ebc +=_gc ;};for _dcgg :=len (_fac ._cba )-1;_dcgg >=0;_dcgg --{_fac ._cba [_dcgg ]._ggdg =_ebc ;_ebc -=_fac ._cba [_dcgg ]._cbe ;_ebc -=_ga ;};};};func (_efad *convertContext )getStyle (_gfdgc *uint32 )*style {_cfgd :=&style {};_gaac :=false ;if _gfdgc !=nil {_dgge :=_efad ._ceca .GetCellStyle (*_gfdgc );_gcbb :=_dgge .GetFont ();for _ ,_faf :=range _gcbb .Name {if _faf !=nil {_cfgd ._dag =&_faf .ValAttr ;_gaac =true ;break ;};};for _ ,_bfc :=range _gcbb .B {if _bfc !=nil {_fbfa :=_bfc .ValAttr ==nil ||*_bfc .ValAttr ;_cfgd ._fbbd =&_fbfa ;_gaac =true ;break ;};};for _ ,_aaeb :=range _gcbb .I {if _aaeb !=nil {_gbcf :=_aaeb .ValAttr ==nil ||*_aaeb .ValAttr ;_cfgd ._gcb =&_gbcf ;_gaac =true ;break ;};};for _ ,_bcg :=range _gcbb .U {if _bcg !=nil {_ccbb :=_bcg .ValAttr ==_df .ST_UnderlineValuesSingle ||_bcg .ValAttr ==_df .ST_UnderlineValuesUnset ;_cfgd ._caff =&_ccbb ;_gaac =true ;break ;};};for _ ,_gfdad :=range _gcbb .Sz {if _gfdad !=nil {_ggcc :=_gfdad .ValAttr /12*_fg .DefaultFontSize ;_cfgd ._gggg =&_ggcc ;_gaac =true ;break ;};};for _ ,_agcc :=range _gcbb .VertAlign {if _agcc !=nil {_dgc :=_agcc .ValAttr ==_gf .ST_VerticalAlignRunSuperscript ;_cfgd ._bbb =&_dgc ;_dab :=_agcc .ValAttr ==_gf .ST_VerticalAlignRunSubscript ;_cfgd ._bcdd =&_dab ;_gaac =true ;break ;};};for _ ,_bbgf :=range _gcbb .Color {if _bbgf !=nil {_cfgd ._ddca =_efad .getColorStringFromSmlColor (_bbgf );_gaac =true ;break ;};};_egce :=_dgge .GetBorder ();if _egce .Top !=nil {_cfgd ._bbg =_efad .getBorder (_egce .Top );_gaac =true ;};if _egce .Bottom !=nil {_cfgd ._eba =_efad .getBorder (_egce .Bottom );_gaac =true ;};if _egce .Left !=nil {_cfgd ._cfa =_efad .getBorder (_egce .Left );_gaac =true ;};if _egce .Right !=nil {_cfgd ._bgcf =_efad .getBorder (_egce .Right );_gaac =true ;};if _dgge .Wrapped (){_cfgd ._agbe =true ;_gaac =true ;};if _cgc :=_dgge .GetVerticalAlignment ();_cgc !=_df .ST_VerticalAlignmentUnset {_cfgd ._geec =_cgc ;_gaac =true ;};if _faeg :=_dgge .GetHorizontalAlignment ();_faeg !=_df .ST_HorizontalAlignmentUnset {_cfgd ._ccb =_faeg ;_gaac =true ;};};if _gaac {return _cfgd ;};return nil ;};func (_fbef *convertContext )combineCellStyleWithRPrElt (_fcd *style ,_eagag *_df .CT_RPrElt )*style {_dbcd :=*_fcd ;_deeg :=_fbef .getStyleFromRPrElt (_eagag );if _deeg ==nil {return &_dbcd ;};if _deeg ._ddca !=nil {_dbcd ._ddca =_deeg ._ddca ;};if _deeg ._gggg !=nil {_dbcd ._gggg =_deeg ._gggg ;};if _deeg ._dag !=nil {_dbcd ._dag =_deeg ._dag ;};if _deeg ._fbbd !=nil {_dbcd ._fbbd =_deeg ._fbbd ;};if _deeg ._gcb !=nil {_dbcd ._gcb =_deeg ._gcb ;};if _deeg ._caff !=nil {_dbcd ._caff =_deeg ._caff ;};if _deeg ._bbb !=nil {_dbcd ._bbb =_deeg ._bbb ;};if _deeg ._bcdd !=nil {_dbcd ._bcdd =_deeg ._bcdd ;};return &_dbcd ;};func (_eac *convertContext )makeCols (){_caef :=_eac ._dbcb ;_ff :=_caef .X ();_gcg :=[]*colInfo {};_add :=[]colWidthRange {};if _gbc :=_ff .Cols ;len (_gbc )> 0{for _ ,_cde :=range _gbc [0].Col {_cdee :=65.0;if _bgf :=_cde .WidthAttr ;_bgf !=nil {if *_bgf > 0.83{*_bgf -=0.83;};if *_bgf <=1{_cdee =*_bgf *11;}else {_cdee =5+*_bgf *6;};};_afa :=int (_cde .MinAttr -1);_gcf :=int (_cde .MaxAttr -1);_add =append (_add ,colWidthRange {_effc :_afa ,_efdbc :_gcf ,_aed :_cdee ,_ggbd :_eac .getStyle (_cde .StyleAttr )});};};_agg :=0;for _cab :=0;_cab <=_eac ._agfd ;_cab ++{var _fb float64 ;var _efda *style ;if _agg >=len (_add ){_fb =65;}else {_cgg :=_add [_agg ];if _cab >=_cgg ._effc &&_cab <=_cgg ._efdbc {_fb =_cgg ._aed ;_efda =_cgg ._ggbd ;if _cab ==_cgg ._efdbc {_agg ++;};}else {_fb =65;};};_gcg =append (_gcg ,&colInfo {_deb :_fb ,_gfg :_efda });};_eac ._cdg =_gcg ;};func (_eee *convertContext )makeTextStyleFromCellStyle (_ebca *style )*_b .TextStyle {_dcac :=_eee ._ecc .NewTextStyle ();if _ebca ==nil {_dcac .FontSize =_fg .DefaultFontSize ;_dcac .Font =_fg .AssignStdFontByName (_dcac ,_fg .StdFontsMap ["\u0064e\u0066\u0061\u0075\u006c\u0074"][FontStyle_Regular ]);return &_dcac ;};if _bcbf (_ebca ._caff ){_dcac .Underline =true ;_dcac .UnderlineStyle =_b .TextDecorationLineStyle {Offset :0.5,Thickness :_gga (1/32)};};var _dffg FontStyle ;if _bcbf (_ebca ._fbbd )&&_bcbf (_ebca ._gcb ){_dffg =FontStyle_BoldItalic ;}else if _bcbf (_ebca ._fbbd ){_dffg =FontStyle_Bold ;}else if _bcbf (_ebca ._gcb ){_dffg =FontStyle_Italic ;}else {_dffg =FontStyle_Regular ;};_bece :="\u0064e\u0066\u0061\u0075\u006c\u0074";if _ebca ._dag !=nil {_bece =*_ebca ._dag ;};if _afbb ,_cce :=_fg .StdFontsMap [_bece ];_cce {_dcac .Font =_fg .AssignStdFontByName (_dcac ,_afbb [_dffg ]);}else if _gde :=_fg .GetRegisteredFont (_bece ,_dffg );_gde !=nil {_dcac .Font =_gde ;}else {_ac .Log .Debug ("\u0046\u006f\u006e\u0074\u0020\u0025\u0073\u0020\u0077\u0069\u0074h\u0020\u0073\u0074\u0079\u006c\u0065\u0020\u0025s\u0020i\u0073\u0020\u006e\u006f\u0074\u0020\u0066\u006f\u0075\u006e\u0064\u002c\u0020\u0072\u0065\u0073\u0065\u0074 \u0074\u006f\u0020\u0064\u0065\u0066\u0061\u0075\u006c\u0074\u002e",_bece ,_dffg );_dcac .Font =_fg .AssignStdFontByName (_dcac ,_fg .StdFontsMap ["\u0064e\u0066\u0061\u0075\u006c\u0074"][_dffg ]);};if _ebca ._gggg !=nil {_dcac .FontSize =*_ebca ._gggg ;};if _ebca ._ddca !=nil {_dcac .Color =_b .ColorRGBFromHex (*_ebca ._ddca );};if _ebca ._bbb !=nil &&*_ebca ._bbb {_dcac .FontSize *=_ad ;}else if _ebca ._bcdd !=nil &&*_ebca ._bcdd {_dcac .FontSize *=_ad ;};return &_dcac ;};func (_dfg *convertContext )fillPages (){for _fdd ,_fbbg :=range _dfg ._gcd {_addd :=_dfg ._cdag [_fbbg ._dggf :_fbbg ._bfb ];for _aeb ,_cgd :=range _addd {_cabe :=0;_dde :=0.0;_cabeg :=[]*cell {};if _cgd ._ffgc {for _ ,_fed :=range _cgd ._acc {_ggc :=_dfg ._ddeg [_cabe ];_dfg ._ecgc =_ggc ._gagc [_fdd ];_dfg ._ecgc ._ddae =true ;_cga :=_fed ._facb ;if _dde +_cga > _ggc ._cfd {_dfg .addRowToPage (_cabeg ,_aeb );_cabeg =[]*cell {_fed };_dde =_cga ;_cabe ++;}else {_fed ._gcfa =_dde ;_cabeg =append (_cabeg ,_fed );_dde +=_cga ;};};if len (_cabeg )> 0{_cbc :=_dfg ._ddeg [_cabe ];_dfg ._ecgc =_cbc ._gagc [_fdd ];_dfg ._ecgc ._ddae =true ;_dfg .addRowToPage (_cabeg ,_aeb );};};};};};func (_fbb *convertContext )makeRows (){_cdb :=[]*rowInfo {};_da :=_fbb ._dbcb .Rows ();_gdc :=0;for _ ,_ae :=range _da {_gdc ++;_dcg :=int (_ae .RowNumber ());if _dcg > _gdc {for _gff :=_gdc ;_gff < _dcg ;_gff ++{_cdb =append (_cdb ,&rowInfo {_fgfe :16/_af });};_gdc =_dcg ;};var _ffg float64 ;if _ae .X ().HtAttr ==nil {_ffg =16;}else {_ffg =*_ae .X ().HtAttr ;};_cdb =append (_cdb ,&rowInfo {_fgfe :_ffg /_af ,_ffgc :true ,_aaab :_fbb .getStyle (_ae .X ().SAttr )});};for _fgg :=len (_cdb );_fgg < _fbb ._dbf ;_fgg ++{_cdb =append (_cdb ,&rowInfo {_fgfe :16/_af });};_fbb ._cdag =_cdb ;};func (_dbg *convertContext )addRowToPage (_acac []*cell ,_bdab int ){_acga :=0.0;_fede :=_dbg ._ceda ;for _ ,_ddeb :=range _acac {if len (_ddeb ._cba )!=0{_ddeb ._dbe =_acga ;_acga =_ddeb ._gcfa +_ddeb ._dcfc ;};};for _fedg :=len (_acac )-1;_fedg >=0;_fedg --{_dee :=_acac [_fedg ];if len (_dee ._cba )!=0{_dee ._dgbg =_fede ;_fede =_dee ._gcfa ;};};_dbg ._ecgc ._eacd =append (_dbg ._ecgc ._eacd ,&pageRow {_aag :_bdab ,_cea :_acac });};type pagespan struct{_cfd float64 ;_gagc []*page ;_eae int ;_geae int ;};func (_dgdf *convertContext )getBorder (_bdea *_df .CT_BorderPr )*border {_febd :=&border {};switch _bdea .StyleAttr {case _df .ST_BorderStyleThin :_febd ._faa =_ade ;case _df .ST_BorderStyleMedium :_febd ._faa =_ade *2;case _df .ST_BorderStyleThick :_febd ._faa =_ade *4;};if _febd ._faa ==0.0{return nil ;};if _agccd :=_bdea .Color ;_agccd !=nil {_badd :=_dgdf .getColorStringFromSmlColor (_agccd );if _badd !=nil {_febd ._fggg =_b .ColorRGBFromHex (*_badd );}else {_febd ._fggg =_b .ColorBlack ;};};return _febd ;};func _bfged (_fdcd ,_ebfb *style ){if _ebfb ==nil {return ;};if _fdcd ==nil {_fdcd =_ebfb ;return ;};if _fdcd ._dag ==nil {_fdcd ._dag =_ebfb ._dag ;};if _fdcd ._ddca ==nil {_fdcd ._ddca =_ebfb ._ddca ;};if _fdcd ._gggg ==nil {_fdcd ._gggg =_ebfb ._gggg ;};if _fdcd ._fbbd ==nil {_fdcd ._fbbd =_ebfb ._fbbd ;};if _fdcd ._gcb ==nil {_fdcd ._gcb =_ebfb ._gcb ;};if _fdcd ._caff ==nil {_fdcd ._caff =_ebfb ._caff ;};if _fdcd ._bbb ==nil {_fdcd ._bbb =_ebfb ._bbb ;};if _fdcd ._bcdd ==nil {_fdcd ._bcdd =_ebfb ._bcdd ;};if _fdcd ._bbg ==nil {_fdcd ._bbg =_ebfb ._bbg ;};if _fdcd ._eba ==nil {_fdcd ._eba =_ebfb ._eba ;};if _fdcd ._cfa ==nil {_fdcd ._cfa =_ebfb ._cfa ;};if _fdcd ._bgcf ==nil {_fdcd ._bgcf =_ebfb ._bgcf ;};if _fdcd ._geec ==_df .ST_VerticalAlignmentUnset {_fdcd ._geec =_ebfb ._geec ;};if _fdcd ._ccb ==_df .ST_HorizontalAlignmentUnset {_fdcd ._ccb =_ebfb ._ccb ;};};var _ade =_gga (0.0625);type pageRow struct{_aag int ;_cea []*cell ;};

// RegisterFont makes a PdfFont accessible for using in converting to PDF.
func RegisterFont (name string ,style FontStyle ,font *_f .PdfFont ){_fg .RegisterFont (name ,style ,font );};var _af =3.025/_gga (1);type cell struct{_egbc _df .ST_CellType ;_ccf int ;_gcfa float64 ;_cba []*line ;_dcfc float64 ;_facb float64 ;_aaac float64 ;_dbe float64 ;_dgbg float64 ;_age *_b .TextStyle ;_bdef *border ;_fdeg *border ;_afe *border ;_bbfc *border ;_aec bool ;_gcgdd bool ;};type colWidthRange struct{_effc int ;_efdbc int ;_aed float64 ;_ggbd *style ;};const _fe =0.25;func (_gdg *convertContext )imageFromAnchor (_gabf *anchor ,_daf ,_beba float64 )_c .Image {if _gabf ._acdge !=nil {return _gabf ._acdge ;};if _gabf ._bdga !=nil {_fab ,_afbg :=_fg .MakeImageFromChartSpace (_gabf ._bdga ,_daf ,_beba ,_gdg ._agbg );if _afbg !=nil {_ac .Log .Debug ("C\u0061\u006e\u006e\u006f\u0074\u0020\u006d\u0061\u006b\u0065\u0020\u0061\u006e\u0020\u0069\u006d\u0061\u0067e\u0020\u0066\u0072\u006f\u006d\u0020\u0063\u0068\u0061\u0072tS\u0070\u0061\u0063e\u003a \u0025\u0073",_afbg );return nil ;};return _fab ;};return nil ;};type border struct{_faa float64 ;_fggg _b .Color ;};

// FontStyle represents a kind of font styling. It can be FontStyle_Regular, FontStyle_Bold, FontStyle_Italic and FontStyle_BoldItalic.
type FontStyle =_fg .FontStyle ;const (FontStyle_Regular FontStyle =0;FontStyle_Bold FontStyle =1;FontStyle_Italic FontStyle =2;FontStyle_BoldItalic FontStyle =3;);type anchor struct{_acdge _c .Image ;_bdga *_ca .ChartSpace ;_def int ;_aef int64 ;_dcab int ;_gbca int64 ;_afaf int ;_bbca int64 ;_feb int ;_bff int64 ;};type page struct{_eacd []*pageRow ;_ddae bool ;_eca []*_b .Image ;_efdb *pagespan ;_gdfe *rowspan ;};func (_fbd *convertContext )makePages (){for _ ,_bdg :=range _fbd ._ddeg {for _ ,_cded :=range _fbd ._gcd {_bdg ._gagc =append (_bdg ._gagc ,&page {_eacd :[]*pageRow {},_efdb :_bdg ,_gdfe :_cded });};};};func (_cedb *convertContext )getSymbolsFromString (_cbg string ,_deg *style )[]*symbol {_cdfd :=[]*symbol {};_fba :=_cedb .makeTextStyleFromCellStyle (_deg );for _ ,_egd :=range _cbg {_cdfd =append (_cdfd ,&symbol {_gcaa :string (_egd ),_adea :_fba });};return _cdfd ;};func (_bab *convertContext )makeMergedCells (){_fff :=[]*mergedCell {};for _ ,_ggd :=range _bab ._dbcb .MergedCells (){_cgf ,_bcc ,_ed :=_ag .ParseRangeReference (_ggd .Reference ());if _ed !=nil {_ac .Log .Debug ("\u0065\u0072r\u006f\u0072\u0020\u0070\u0061\u0072\u0073\u0069\u006e\u0067\u0020\u006d\u0065\u0072\u0067\u0065\u0064\u0020\u0063\u0065\u006c\u006c: \u0025\u0073",_ed );continue ;};_eg :=mergedCell {_gfda :_cgf .RowIdx ,_fade :_cgf .ColumnIdx ,_gaaa :_bcc .RowIdx ,_gdcf :_bcc .ColumnIdx };for _fd :=_eg ._fade -1;_fd < _eg ._gdcf ;_fd ++{_eg ._egee +=_bab ._cdg [_fd ]._deb ;};for _bgg :=_eg ._gfda -1;_bgg < _eg ._gaaa ;_bgg ++{_eg ._eaba +=_bab ._cdag [_bgg ]._fgfe ;};_fff =append (_fff ,&_eg );};_bab ._deea =_fff ;};type colInfo struct{_cace float64 ;_deb float64 ;_gfg *style ;};func _gga (_egda float64 )float64 {return _egda *_e .Millimeter };func (_fgcb *convertContext )alignSymbolsHorizontally (_gdbc *cell ,_ggba _df .ST_HorizontalAlignment ){if _ggba ==_df .ST_HorizontalAlignmentUnset {switch _gdbc ._egbc {case _df .ST_CellTypeB :_ggba =_df .ST_HorizontalAlignmentCenter ;case _df .ST_CellTypeN :_ggba =_df .ST_HorizontalAlignmentRight ;default:_ggba =_df .ST_HorizontalAlignmentLeft ;};};var _ecd float64 ;for _ ,_cbdb :=range _gdbc ._cba {switch _ggba {case _df .ST_HorizontalAlignmentLeft :_ecd =_agc ;case _df .ST_HorizontalAlignmentRight :_efb :=_afcg (_cbdb ._bebd );_ecd =_gdbc ._dcfc -_agc -_efb ;case _df .ST_HorizontalAlignmentCenter :_cfc :=_afcg (_cbdb ._bebd );_ecd =(_gdbc ._dcfc -_cfc )/2;};for _ ,_dacf :=range _cbdb ._bebd {_dacf ._agfa +=_ecd ;};};};func _bcbf (_fgbef *bool )bool {return _fgbef !=nil &&*_fgbef };func (_fca *convertContext )getImage (_cedg _c .Image ,_gca ,_fbaf ,_fag ,_dda ,_eacc ,_abgd float64 ,_ega _fg .ImgPart )*_b .Image {_dda +=_fca ._fde ;_fag +=_fca ._beac ;_ede ,_dgd :=_fg .GetImage (_fca ._ecc ,_cedg ,_gca ,_fbaf ,_fag ,_dda ,_eacc ,_abgd ,_ega );if _dgd !=nil {_ac .Log .Debug ("\u0043\u0061\u006eno\u0074\u0020\u0067\u0065\u0074\u0020\u0061\u006e\u0020\u0069\u006d\u0061\u0067\u0065\u003a\u0020\u0025\u0073",_dgd );return nil ;};return _ede ;};func (_fgf *convertContext )makeCells (){_aca :=_fgf ._dbcb ;_efc :=_aca .Rows ();_bed :=0;for _ ,_adg :=range _fgf ._cdag {_adg ._acc =[]*cell {};_adef :=0.0;_dcf :=_adg ._aaab ;if _adg ._ffgc {_bbe :=_efc [_bed ];_bed ++;_fbc :=_adg ._fgfe ;for _ ,_ffb :=range _bbe .Cells (){_dae ,_eag :=_ag .ParseCellReference (_ffb .Reference ());if _eag !=nil {_ac .Log .Debug ("\u0043\u0061\u006e\u006eo\u0074\u0020\u0070\u0061\u0072\u0073\u0065\u0020\u0061\u0020r\u0065f\u0065\u0072\u0065\u006e\u0063\u0065\u003a \u0025\u0073",_eag );continue ;};_fga :=_fgf ._cdg [_dae .ColumnIdx ];_eda :=_fga ._deb ;_gbf :=_eda ;_edab :=_fga ._gfg ;var _babc ,_cgbf ,_ccd ,_adf bool ;for _ ,_afc :=range _fgf ._deea {if _dae .RowIdx >=_afc ._gfda &&_dae .RowIdx <=_afc ._gaaa &&_dae .ColumnIdx >=_afc ._fade &&_dae .ColumnIdx <=_afc ._gdcf {if _dae .ColumnIdx ==_afc ._fade &&_dae .RowIdx ==_afc ._gfda {_eda =_afc ._egee ;_fbc =_afc ._eaba ;};_babc =_dae .RowIdx !=_afc ._gfda ;_cgbf =_dae .RowIdx !=_afc ._gaaa ;_ccd =_dae .ColumnIdx !=_afc ._fade ;_adf =_dae .ColumnIdx !=_afc ._gdcf ;};};_ced :=_fgf .getStyleFromCell (_ffb ,_dcf ,_edab );var _afdg ,_bda ,_efe bool ;var _gdf ,_ec ,_gag ,_bca *border ;var _aaa _df .ST_VerticalAlignment ;var _acd _df .ST_HorizontalAlignment ;if _ced !=nil {if !_babc {_gdf =_ced ._bbg ;};if !_cgbf {_ec =_ced ._eba ;};if !_ccd {_gag =_ced ._cfa ;};if !_adf {_bca =_ced ._bgcf ;};if _ec !=nil &&_ec ._faa > _adef {_adef =_ec ._faa ;};_aaa =_ced ._geec ;_acd =_ced ._ccb ;if _ced ._bbb !=nil {_afdg =*_ced ._bbb ;};if _ced ._bcdd !=nil {_bda =*_ced ._bcdd ;};_efe =_ced ._agbe ;};_cbde ,_bgc :=_fgf .getContentFromCell (_ffb ,_ced ,_eda ,_efe );_bfe :=&cell {_egbc :_bgc ,_dcfc :_eda ,_facb :_gbf ,_aaac :_fbc ,_cba :_cbde ,_bdef :_gdf ,_fdeg :_ec ,_afe :_gag ,_bbfc :_bca ,_aec :_afdg ,_gcgdd :_bda };_fgf .alignSymbolsHorizontally (_bfe ,_acd );_fgf .alignSymbolsVertically (_bfe ,_aaa );_adg ._acc =append (_adg ._acc ,_bfe );};};_adg ._eff =_adef ;};};var _efcd =map[uint32 ]_b .PageSize {1:_b .PageSize {8.5*_e .Inch ,11*_e .Inch },2:_b .PageSize {8.5*_e .Inch ,11*_e .Inch },3:_b .PageSize {11*_e .Inch ,17*_e .Inch },4:_b .PageSize {17*_e .Inch ,11*_e .Inch },5:_b .PageSize {8.5*_e .Inch ,14*_e .Inch },6:_b .PageSize {5.5*_e .Inch ,8.5*_e .Inch },7:_b .PageSize {7.5*_e .Inch ,10*_e .Inch },8:_b .PageSize {_gga (297),_gga (420)},9:_b .PageSize {_gga (210),_gga (297)},10:_b .PageSize {_gga (210),_gga (297)},11:_b .PageSize {_gga (148),_gga (210)},70:_b .PageSize {_gga (105),_gga (148)},12:_b .PageSize {_gga (250),_gga (354)},13:_b .PageSize {_gga (182),_gga (257)},14:_b .PageSize {8.5*_e .Inch ,13*_e .Inch },20:_b .PageSize {4.125*_e .Inch ,9.5*_e .Inch },27:_b .PageSize {_gga (110),_gga (220)},28:_b .PageSize {_gga (162),_gga (229)},34:_b .PageSize {_gga (250),_gga (176)},29:_b .PageSize {_gga (324),_gga (458)},30:_b .PageSize {_gga (229),_gga (324)},31:_b .PageSize {_gga (114),_gga (162)},37:_b .PageSize {3.88*_e .Inch ,7.5*_e .Inch },43:_b .PageSize {_gga (100),_gga (148)},69:_b .PageSize {_gga (200),_gga (148)}};func _bcad (_cbce *symbol ){_dgf :=_b .New ();_agcd :=_dgf .NewStyledParagraph ();_agcd .SetMargins (0,0,0,0);_dbac :=_agcd .Append (_cbce ._gcaa );if _cbce ._adea !=nil {_dbac .Style =*_cbce ._adea ;};_cbce ._ebg =_agcd .Height ();if _cbce ._befd ==0{_cbce ._befd =_agcd .Width ();};};func (_bfge *convertContext )getStyleFromRPrElt (_bfcf *_df .CT_RPrElt )*style {if _bfcf ==nil {return nil ;};_accb :=&style {};_accb ._dag =&_bfcf .RFont .ValAttr ;if _acge :=_bfcf .B ;_acge !=nil {_ccee :=_acge .ValAttr ==nil ||*_acge .ValAttr ;_accb ._fbbd =&_ccee ;};if _feced :=_bfcf .I ;_feced !=nil {_eedg :=_feced .ValAttr ==nil ||*_feced .ValAttr ;_accb ._gcb =&_eedg ;};if _cbggg :=_bfcf .U ;_cbggg !=nil {_eaee :=_cbggg .ValAttr ==_df .ST_UnderlineValuesSingle ||_cbggg .ValAttr ==_df .ST_UnderlineValuesUnset ;_accb ._caff =&_eaee ;};if _gafa :=_bfcf .VertAlign ;_gafa !=nil {_bbaaa :=_gafa .ValAttr ==_gf .ST_VerticalAlignRunSuperscript ;_accb ._bbb =&_bbaaa ;_bgdf :=_gafa .ValAttr ==_gf .ST_VerticalAlignRunSubscript ;_accb ._bcdd =&_bgdf ;};if _abb :=_bfcf .Sz ;_abb !=nil {_eaa :=_abb .ValAttr /12*_fg .DefaultFontSize ;_accb ._gggg =&_eaa ;};if _aecd :=_bfcf .Color ;_aecd !=nil {_accb ._ddca =_bfge .getColorStringFromSmlColor (_aecd );};return _accb ;};func (_fce *convertContext )drawSheet (){for _bee ,_fgc :=range _fce ._ddeg {_dca :=len (_fgc ._gagc );if _bee ==len (_fce ._ddeg )-1{for _ccce :=len (_fgc ._gagc )-1;_ccce >=0;_ccce --{if !_fgc ._gagc [_ccce ]._ddae {_dca =_ccce ;};};};_cad :=_fgc ._gagc [:_dca ];for _ ,_eaga :=range _cad {_fce ._ecc .NewPage ();_fce .drawPage (_eaga );};};};const _ad =0.64;type line struct{_ggdg float64 ;_bebd []*symbol ;_cbe float64 ;};func (_bc *convertContext )determineMaxIndexes (){var _eb ,_agb int ;_eb =int (_bc ._dbcb .MaxColumnIdx ());_dfcf :=_bc ._dbcb .Rows ();if len (_dfcf )> 0{_agb =int (_dfcf [len (_dfcf )-1].RowNumber ());};for _ ,_cae :=range _bc ._bag {if _cae ._afaf >=_agb {_agb =_cae ._afaf +1;};if _cae ._feb >=_eb {_eb =_cae ._feb +1;};};_bc ._dbf =_agb ;_bc ._agfd =_eb ;};func (_fceg *convertContext )drawPage (_ccca *page ){_fedc :=_fceg ._fde ;_dga :=_fceg ._beac ;for _ ,_fddag :=range _ccca ._eacd {_de :=_fceg ._cdag [_fddag ._aag ];for _ ,_aad :=range _fddag ._cea {_ggde :=_aad ._dbe < _aad ._gcfa ;_gba :=_aad ._dgbg > _aad ._gcfa +_aad ._dcfc ;var _ged ,_aae bool ;for _ ,_eed :=range _aad ._cba {for _ ,_gbg :=range _eed ._bebd {if _ggde &&!_ged {_ged =_gbg ._agfa < 0;};if _gba &&!_aae {_aae =_aad ._dcfc < _gbg ._agfa +_gbg ._befd ;};if _aad ._gcfa +_gbg ._agfa >=_aad ._dbe &&_aad ._gcfa +_gbg ._agfa +_gbg ._befd <=_aad ._dgbg {_fffg :=_fceg ._ecc .NewStyledParagraph ();_afb :=_dga +_aad ._gcfa +_gbg ._agfa ;_dded :=_fedc +_de ._baed +_eed ._ggdg -_gbg ._ebg -_gga (0.5);_fffg .SetPos (_afb ,_dded );var _gcgd *_b .TextChunk ;if _gbg ._fea !=""{_gcgd =_fffg .AddExternalLink (_gbg ._gcaa ,_gbg ._fea );}else {_gcgd =_fffg .Append (_gbg ._gcaa );};if _gbg ._adea !=nil {_gcgd .Style =*_gbg ._adea ;};_fceg ._ecc .Draw (_fffg );};};};var _efg ,_eggb ,_dbc ,_gcge ,_daea ,_fad float64 ;var _geag ,_abe ,_cac ,_dfcd _b .Color ;if _begdb :=_aad ._bdef ;_begdb !=nil {_efg =_begdb ._faa ;_geag =_begdb ._fggg ;};if _ege :=_aad ._fdeg ;_ege !=nil {_eggb =_ege ._faa ;_abe =_ege ._fggg ;};if _fdab :=_aad ._afe ;_fdab !=nil {_dbc =_fdab ._faa ;_daea =_dbc /2;_cac =_fdab ._fggg ;};if _fbe :=_aad ._bbfc ;_fbe !=nil {_gcge =_fbe ._faa ;_fad =_gcge /2;_dfcd =_fbe ._fggg ;};var _fbg float64 ;if _fddag ._aag > 1{_fbg =_fceg ._cdag [_fddag ._aag -1]._eff ;};_fcf :=_fedc +_de ._baed -0.5*(_fbg -_efg );_fadf :=_fedc +_de ._baed +_de ._fgfe +0.5*(_de ._eff +_eggb );_ggg :=_dga +_aad ._gcfa ;_gdba :=_ggg +_aad ._facb ;_fg .DrawLine (_fceg ._ecc ,_ggg ,_fcf ,_gdba ,_fcf ,_efg ,_geag );_fg .DrawLine (_fceg ._ecc ,_ggg ,_fadf ,_gdba ,_fadf ,_eggb ,_abe );if !_ged {_fg .DrawLine (_fceg ._ecc ,_ggg -_daea ,_fcf ,_ggg -_daea ,_fadf ,_dbc ,_cac );};if !_aae {_fg .DrawLine (_fceg ._ecc ,_gdba -_fad ,_fcf ,_gdba -_fad ,_fadf ,_gcge ,_dfcd );};};};for _ ,_aaf :=range _ccca ._eca {if _aaf !=nil {_fceg ._ecc .Draw (_aaf );};};};func (_afab *convertContext )makeRowspans (){var _fece float64 ;_agf :=0;for _aeg ,_bbc :=range _afab ._cdag {_bbaa :=_bbc ._fgfe +_bbc ._eff ;if _fece +_bbaa <=_afab ._ebf {_bbc ._baed =_fece ;_fece +=_bbaa ;}else {_afab ._gcd =append (_afab ._gcd ,&rowspan {_ffbe :_fece ,_dggf :_agf ,_bfb :_aeg });_agf =_aeg ;_bbc ._baed =0;_fece =_bbaa ;};};_afab ._gcd =append (_afab ._gcd ,&rowspan {_ffbe :_fece ,_dggf :_agf ,_bfb :len (_afab ._cdag )});};type convertContext struct{_ecc *_b .Creator ;_cece *_bb .Workbook ;_agbg *_g .Theme ;_dbcb *_bb .Sheet ;_ceca *_bb .StyleSheet ;_dbf int ;_agfd int ;_ddeg []*pagespan ;_ecgc *page ;_cdg []*colInfo ;_cdag []*rowInfo ;_gcd []*rowspan ;_fde float64 ;_beac float64 ;_ebf float64 ;_ceda float64 ;_deea []*mergedCell ;_bag []*anchor ;};const _bba =2;func (_cbgg *convertContext )getSymbolsFromR (_ecg []*_df .CT_RElt ,_ece *style )[]*symbol {_fef :=[]*symbol {};for _ ,_fbf :=range _ecg {_ffe :=_cbgg .combineCellStyleWithRPrElt (_ece ,_fbf .RPr );for _ ,_dfbf :=range _fbf .T {_fef =append (_fef ,&symbol {_gcaa :string (_dfbf ),_adea :_cbgg .makeTextStyleFromCellStyle (_ffe )});};};return _fef ;};type rowspan struct{_ffbe float64 ;_dggf int ;_bfb int ;};type mergedCell struct{_gfda uint32 ;_fade uint32 ;_gaaa uint32 ;_gdcf uint32 ;_egee float64 ;_eaba float64 ;};func (_bbd *convertContext )getColorFromTheme (_cdc uint32 )string {_fcag :=_bbd ._cece .Themes ();if len (_fcag )!=0{_ecec :=_fcag [0];if _ddaa :=_ecec .ThemeElements ;_ddaa !=nil {if _becf :=_ddaa .ClrScheme ;_becf !=nil {switch _cdc {case 0:return _fg .GetColorStringFromDmlColor (_becf .Lt1 );case 1:return _fg .GetColorStringFromDmlColor (_becf .Dk1 );case 2:return _fg .GetColorStringFromDmlColor (_becf .Lt2 );case 3:return _fg .GetColorStringFromDmlColor (_becf .Dk2 );case 4:return _fg .GetColorStringFromDmlColor (_becf .Accent1 );case 5:return _fg .GetColorStringFromDmlColor (_becf .Accent2 );case 6:return _fg .GetColorStringFromDmlColor (_becf .Accent3 );case 7:return _fg .GetColorStringFromDmlColor (_becf .Accent4 );case 8:return _fg .GetColorStringFromDmlColor (_becf .Accent5 );case 9:return _fg .GetColorStringFromDmlColor (_becf .Accent6 );};};};};return "";};func (_cafe *convertContext )getColorStringFromSmlColor (_dfd *_df .CT_Color )*string {var _cfgcb string ;if _dfd .RgbAttr !=nil {_cfgcb =*_dfd .RgbAttr ;}else if _dfd .IndexedAttr !=nil &&*_dfd .IndexedAttr < 64{_cfgcb =_dbbe [*_dfd .IndexedAttr ];}else if _dfd .ThemeAttr !=nil {_ageg :=*_dfd .ThemeAttr ;_cfgcb =_cafe .getColorFromTheme (_ageg );};if _cfgcb ==""{return nil ;};if len (_cfgcb )> 6{_cfgcb =_cfgcb [(len (_cfgcb )-6):];};if _dfd .TintAttr !=nil {_bagf :=*_dfd .TintAttr ;_cfgcb =_fg .AdjustColorByTint (_cfgcb ,_bagf );};_cfgcb ="\u0023"+_cfgcb ;return &_cfgcb ;};