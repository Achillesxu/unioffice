//
// Copyright 2020 FoxyUtils ehf. All rights reserved.
//
// This is a commercial product and requires a license to operate.
// A trial license can be obtained at https://unidoc.io
//
// DO NOT EDIT: generated by unitwist Go source code obfuscator.
//
// Use of this source code is governed by the UniDoc End User License Agreement
// terms that can be accessed at https://unidoc.io/eula/

package convert ;import (_b "github.com/unidoc/unioffice/common/logger";_bc "github.com/unidoc/unioffice/common/tempstorage";_ca "github.com/unidoc/unioffice/internal/convertutils";_fc "github.com/unidoc/unioffice/measurement";_c "github.com/unidoc/unioffice/schema/soo/dml";_ce "github.com/unidoc/unioffice/schema/soo/dml/chart";_e "github.com/unidoc/unioffice/schema/soo/ofc/sharedTypes";_da "github.com/unidoc/unioffice/schema/soo/sml";_cf "github.com/unidoc/unioffice/spreadsheet";_eb "github.com/unidoc/unioffice/spreadsheet/reference";_bd "github.com/unidoc/unipdf/v3/creator";_fg "github.com/unidoc/unipdf/v3/model";_dd "image";_f "strconv";);func (_ecf *convertContext )makePages (){for _ ,_efg :=range _ecf ._aga {for _ ,_ffa :=range _ecf ._aacc {_efg ._adae =append (_efg ._adae ,&page {_fca :[]*pageRow {},_ffba :_efg ,_gadf :_ffa });};};};type cell struct{_bfbe _da .ST_CellType ;_abea int ;_decg float64 ;_dcfg []*line ;_aggba float64 ;_dged float64 ;_ecg float64 ;_dae float64 ;_cdg float64 ;_abad *_bd .TextStyle ;_baef *border ;_ceee *border ;_edee *border ;_agbc *border ;_aef bool ;_gfbb bool ;};func (_fcfe *convertContext )combineCellStyleWithRPrElt (_cfdf *style ,_bced *_da .CT_RPrElt )*style {_faae :=*_cfdf ;_gdea :=_fcfe .getStyleFromRPrElt (_bced );if _gdea ==nil {return &_faae ;};if _gdea ._gbd !=nil {_faae ._gbd =_gdea ._gbd ;};if _gdea ._gddc !=nil {_faae ._gddc =_gdea ._gddc ;};if _gdea ._dec !=nil {_faae ._dec =_gdea ._dec ;};if _gdea ._bedg !=nil {_faae ._bedg =_gdea ._bedg ;};if _gdea ._agab !=nil {_faae ._agab =_gdea ._agab ;};if _gdea ._fage !=nil {_faae ._fage =_gdea ._fage ;};if _gdea ._cecg !=nil {_faae ._cecg =_gdea ._cecg ;};if _gdea ._ecef !=nil {_faae ._ecef =_gdea ._ecef ;};return &_faae ;};func (_aaf *convertContext )determineMaxIndexes (){var _eeg ,_df int ;_eeg =int (_aaf ._caae .MaxColumnIdx ());_fcd :=_aaf ._caae .Rows ();if len (_fcd )> 0{_df =int (_fcd [len (_fcd )-1].RowNumber ());};for _ ,_fgb :=range _aaf ._eae {if _fgb ._fgfe >=_df {_df =_fgb ._fgfe +1;};if _fgb ._cded >=_eeg {_eeg =_fgb ._cded +1;};};_aaf ._gab =_df ;_aaf ._aggb =_eeg ;};func _beeb (_cdfg *bool )bool {return _cdfg !=nil &&*_cdfg };var _cef =[]string {"\u0030\u0030\u0030\u0030\u0030\u0030","\u0066\u0066\u0066\u0066\u0066\u0066","\u0066\u0066\u0030\u0030\u0030\u0030","\u0030\u0030\u0066\u0066\u0030\u0030","\u0030\u0030\u0030\u0030\u0066\u0066","\u0066\u0066\u0066\u0066\u0030\u0030","\u0066\u0066\u0030\u0030\u0066\u0066","\u0030\u0030\u0066\u0066\u0066\u0066","\u0030\u0030\u0030\u0030\u0030\u0030","\u0066\u0066\u0066\u0066\u0066\u0066","\u0066\u0066\u0030\u0030\u0030\u0030","\u0030\u0030\u0066\u0066\u0030\u0030","\u0030\u0030\u0030\u0030\u0066\u0066","\u0066\u0066\u0066\u0066\u0030\u0030","\u0066\u0066\u0030\u0030\u0066\u0066","\u0030\u0030\u0066\u0066\u0066\u0066","\u0038\u0030\u0030\u0030\u0030\u0030","\u0030\u0030\u0038\u0030\u0030\u0030","\u0030\u0030\u0030\u0030\u0038\u0030","\u0038\u0030\u0038\u0030\u0030\u0030","\u0038\u0030\u0030\u0030\u0038\u0030","\u0030\u0030\u0038\u0030\u0038\u0030","\u0063\u0030\u0063\u0030\u0063\u0030","\u0038\u0030\u0038\u0030\u0038\u0030","\u0039\u0039\u0039\u0039\u0066\u0066","\u0039\u0039\u0033\u0033\u0036\u0036","\u0066\u0066\u0066\u0066\u0063\u0063","\u0063\u0063\u0066\u0066\u0066\u0066","\u0036\u0036\u0030\u0030\u0036\u0036","\u0066\u0066\u0038\u0030\u0038\u0030","\u0030\u0030\u0036\u0036\u0063\u0063","\u0063\u0063\u0063\u0063\u0066\u0066","\u0030\u0030\u0030\u0030\u0038\u0030","\u0066\u0066\u0030\u0030\u0066\u0066","\u0066\u0066\u0066\u0066\u0030\u0030","\u0030\u0030\u0066\u0066\u0066\u0066","\u0038\u0030\u0030\u0030\u0038\u0030","\u0038\u0030\u0030\u0030\u0030\u0030","\u0030\u0030\u0038\u0030\u0038\u0030","\u0030\u0030\u0030\u0030\u0066\u0066","\u0030\u0030\u0063\u0063\u0066\u0066","\u0063\u0063\u0066\u0066\u0066\u0066","\u0063\u0063\u0066\u0066\u0063\u0063","\u0066\u0066\u0066\u0066\u0039\u0039","\u0039\u0039\u0063\u0063\u0066\u0066","\u0066\u0066\u0039\u0039\u0063\u0063","\u0063\u0063\u0039\u0039\u0066\u0066","\u0066\u0066\u0063\u0063\u0039\u0039","\u0033\u0033\u0036\u0036\u0066\u0066","\u0033\u0033\u0063\u0063\u0063\u0063","\u0039\u0039\u0063\u0063\u0030\u0030","\u0066\u0066\u0063\u0063\u0030\u0030","\u0066\u0066\u0039\u0039\u0030\u0030","\u0066\u0066\u0036\u0036\u0030\u0030","\u0036\u0036\u0036\u0036\u0039\u0039","\u0039\u0036\u0039\u0036\u0039\u0036","\u0030\u0030\u0033\u0033\u0036\u0036","\u0033\u0033\u0039\u0039\u0036\u0036","\u0030\u0030\u0033\u0033\u0030\u0030","\u0033\u0033\u0033\u0033\u0030\u0030","\u0039\u0039\u0033\u0033\u0030\u0030","\u0039\u0039\u0033\u0033\u0036\u0036","\u0033\u0033\u0033\u0033\u0039\u0039","\u0033\u0033\u0033\u0033\u0033\u0033"};

// ConvertToPdf converts a sheet to a PDF file. This package is beta, breaking changes can take place.
func ConvertToPdf (s *_cf .Sheet )*_bd .Creator {_abd :=s .X ();if _abd ==nil {return nil ;};var _fe _bd .PageSize ;var _ee bool ;if _ag :=_abd .PageSetup ;_ag !=nil {if _eg :=_ag .PaperSizeAttr ;_eg !=nil {_fe =_gdag [*_eg ];};_ee =_ag .OrientationAttr ==_da .ST_OrientationLandscape ;};if (_fe ==_bd .PageSize {}){_fe =_gdag [1];};if _ee {_fe [0],_fe [1]=_fe [1],_fe [0];};_g :=_bd .New ();_g .SetPageSize (_fe );var _gb ,_gc ,_aa ,_dgd float64 ;if _cc :=_abd .PageMargins ;_cc !=nil {_aa =_cc .LeftAttr ;_dgd =_cc .RightAttr ;_gb =_cc .TopAttr ;_gc =_cc .BottomAttr ;};if _aa < 0.25{_aa =0.25;};if _dgd < 0.25{_dgd =0.25;};_gb *=_fc .Inch ;_gc *=_fc .Inch ;_aa *=_fc .Inch ;_dgd *=_fc .Inch ;_g .SetPageMargins (_aa ,_dgd ,_gb ,_gc );_gd :=s .Workbook ();var _ae *_c .Theme ;if len (_gd .Themes ())> 0{_ae =_gd .Themes ()[0];};_dde :=&convertContext {_ggc :_g ,_caae :s ,_dgdb :s .Workbook (),_ggca :_ae ,_ddcb :&s .Workbook ().StyleSheet ,_gcfc :_gb ,_dega :_aa ,_cafb :_fe [1]-_gc -_gb ,_acga :_fe [0]-_dgd -_aa };_dde .makeAnchors ();_dde .determineMaxIndexes ();if _dde ._gab ==0&&_dde ._aggb ==0{_g .NewPage ();return _g ;};_dde .makeCols ();_dde .makeRows ();_dde .makeMergedCells ();_dde .makeCells ();_dde .makePagespans ();_dde .makeRowspans ();_dde .makePages ();_dde .fillPages ();_dde .distributeAnchors ();_dde .drawSheet ();return _g ;};func _ddcbd (_ecgb ,_ebff *style ){if _ebff ==nil {return ;};if _ecgb ==nil {_ecgb =_ebff ;return ;};if _ecgb ._dec ==nil {_ecgb ._dec =_ebff ._dec ;};if _ecgb ._gbd ==nil {_ecgb ._gbd =_ebff ._gbd ;};if _ecgb ._gddc ==nil {_ecgb ._gddc =_ebff ._gddc ;};if _ecgb ._bedg ==nil {_ecgb ._bedg =_ebff ._bedg ;};if _ecgb ._agab ==nil {_ecgb ._agab =_ebff ._agab ;};if _ecgb ._fage ==nil {_ecgb ._fage =_ebff ._fage ;};if _ecgb ._cecg ==nil {_ecgb ._cecg =_ebff ._cecg ;};if _ecgb ._ecef ==nil {_ecgb ._ecef =_ebff ._ecef ;};if _ecgb ._febf ==nil {_ecgb ._febf =_ebff ._febf ;};if _ecgb ._ebec ==nil {_ecgb ._ebec =_ebff ._ebec ;};if _ecgb ._dgf ==nil {_ecgb ._dgf =_ebff ._dgf ;};if _ecgb ._cecf ==nil {_ecgb ._cecf =_ebff ._cecf ;};if _ecgb ._beg ==_da .ST_VerticalAlignmentUnset {_ecgb ._beg =_ebff ._beg ;};if _ecgb ._fafg ==_da .ST_HorizontalAlignmentUnset {_ecgb ._fafg =_ebff ._fafg ;};};func (_cccg *convertContext )makeTextStyleFromCellStyle (_fcgf *style )*_bd .TextStyle {_eadb :=_cccg ._ggc .NewTextStyle ();if _fcgf ==nil {_eadb .FontSize =_ca .DefaultFontSize ;_eadb .Font =_ca .AssignStdFontByName (_eadb ,_ca .StdFontsMap ["\u0064e\u0066\u0061\u0075\u006c\u0074"][FontStyle_Regular ]);return &_eadb ;};if _beeb (_fcgf ._fage ){_eadb .Underline =true ;_eadb .UnderlineStyle =_bd .TextDecorationLineStyle {Offset :0.5,Thickness :_cfbd (1/32)};};var _abdd FontStyle ;if _beeb (_fcgf ._bedg )&&_beeb (_fcgf ._agab ){_abdd =FontStyle_BoldItalic ;}else if _beeb (_fcgf ._bedg ){_abdd =FontStyle_Bold ;}else if _beeb (_fcgf ._agab ){_abdd =FontStyle_Italic ;}else {_abdd =FontStyle_Regular ;};_bccd :="\u0064e\u0066\u0061\u0075\u006c\u0074";if _fcgf ._dec !=nil {_bccd =*_fcgf ._dec ;};if _ffge ,_eggd :=_ca .StdFontsMap [_bccd ];_eggd {_eadb .Font =_ca .AssignStdFontByName (_eadb ,_ffge [_abdd ]);}else if _fea :=_ca .GetRegisteredFont (_bccd ,_abdd );_fea !=nil {_eadb .Font =_fea ;}else {_b .Log .Debug ("\u0046\u006f\u006e\u0074\u0020\u0025\u0073\u0020\u0077\u0069\u0074h\u0020\u0073\u0074\u0079\u006c\u0065\u0020\u0025s\u0020i\u0073\u0020\u006e\u006f\u0074\u0020\u0066\u006f\u0075\u006e\u0064\u002c\u0020\u0072\u0065\u0073\u0065\u0074 \u0074\u006f\u0020\u0064\u0065\u0066\u0061\u0075\u006c\u0074\u002e",_bccd ,_abdd );_eadb .Font =_ca .AssignStdFontByName (_eadb ,_ca .StdFontsMap ["\u0064e\u0066\u0061\u0075\u006c\u0074"][_abdd ]);};if _fcgf ._gddc !=nil {_eadb .FontSize =*_fcgf ._gddc ;};if _fcgf ._gbd !=nil {_eadb .Color =_bd .ColorRGBFromHex (*_fcgf ._gbd );};if _fcgf ._cecg !=nil &&*_fcgf ._cecg {_eadb .FontSize *=_ba ;}else if _fcgf ._ecef !=nil &&*_fcgf ._ecef {_eadb .FontSize *=_ba ;};return &_eadb ;};func _cgcg (_gfc []*symbol )float64 {_ebf :=0.0;for _ ,_cgda :=range _gfc {if _cgda ._ggaf > _ebf {_ebf =_cgda ._ggaf ;};};return _ebf ;};func (_fggg *convertContext )makeCols (){_fa :=_fggg ._caae ;_fgc :=_fa .X ();_cgd :=[]*colInfo {};_caa :=[]colWidthRange {};if _cbg :=_fgc .Cols ;len (_cbg )> 0{for _ ,_fae :=range _cbg [0].Col {_ebd :=65.0;if _ffd :=_fae .WidthAttr ;_ffd !=nil {if *_ffd > 0.83{*_ffd -=0.83;};if *_ffd <=1{_ebd =*_ffd *11;}else {_ebd =5+*_ffd *6;};};_gda :=int (_fae .MinAttr -1);_dff :=int (_fae .MaxAttr -1);_caa =append (_caa ,colWidthRange {_dcbe :_gda ,_bdfd :_dff ,_edgf :_ebd ,_agd :_fggg .getStyle (_fae .StyleAttr )});};};_caac :=0;for _bb :=0;_bb <=_fggg ._aggb ;_bb ++{var _dac float64 ;var _abe *style ;if _caac >=len (_caa ){_dac =65;}else {_egb :=_caa [_caac ];if _bb >=_egb ._dcbe &&_bb <=_egb ._bdfd {_dac =_egb ._edgf ;_abe =_egb ._agd ;if _bb ==_egb ._bdfd {_caac ++;};}else {_dac =65;};};_cgd =append (_cgd ,&colInfo {_dadd :_dac ,_ggbe :_abe });};_fggg ._afg =_cgd ;};func (_acgb *convertContext )getImage (_deab _dd .Image ,_feeg ,_bebf ,_aeaa ,_gffg ,_faf ,_gegf float64 ,_aedf _ca .ImgPart )*_bd .Image {_gffg +=_acgb ._gcfc ;_aeaa +=_acgb ._dega ;_eed ,_bgeg :=_ca .GetImage (_acgb ._ggc ,_deab ,_feeg ,_bebf ,_aeaa ,_gffg ,_faf ,_gegf ,_aedf );if _bgeg !=nil {_b .Log .Debug ("\u0043\u0061\u006eno\u0074\u0020\u0067\u0065\u0074\u0020\u0061\u006e\u0020\u0069\u006d\u0061\u0067\u0065\u003a\u0020\u0025\u0073",_bgeg );return nil ;};return _eed ;};type colWidthRange struct{_dcbe int ;_bdfd int ;_edgf float64 ;_agd *style ;};const _bg =2;func (_fcag *convertContext )getColorFromTheme (_dcca uint32 )string {_geagc :=_fcag ._dgdb .Themes ();if len (_geagc )!=0{_fcbe :=_geagc [0];if _becb :=_fcbe .ThemeElements ;_becb !=nil {if _faef :=_becb .ClrScheme ;_faef !=nil {switch _dcca {case 0:return _ca .GetColorStringFromDmlColor (_faef .Lt1 );case 1:return _ca .GetColorStringFromDmlColor (_faef .Dk1 );case 2:return _ca .GetColorStringFromDmlColor (_faef .Lt2 );case 3:return _ca .GetColorStringFromDmlColor (_faef .Dk2 );case 4:return _ca .GetColorStringFromDmlColor (_faef .Accent1 );case 5:return _ca .GetColorStringFromDmlColor (_faef .Accent2 );case 6:return _ca .GetColorStringFromDmlColor (_faef .Accent3 );case 7:return _ca .GetColorStringFromDmlColor (_faef .Accent4 );case 8:return _ca .GetColorStringFromDmlColor (_faef .Accent5 );case 9:return _ca .GetColorStringFromDmlColor (_faef .Accent6 );};};};};return "";};func (_ea *convertContext )makeMergedCells (){_bbf :=[]*mergedCell {};for _ ,_dgde :=range _ea ._caae .MergedCells (){_edb ,_dfb ,_af :=_eb .ParseRangeReference (_dgde .Reference ());if _af !=nil {_b .Log .Debug ("\u0065\u0072r\u006f\u0072\u0020\u0070\u0061\u0072\u0073\u0069\u006e\u0067\u0020\u006d\u0065\u0072\u0067\u0065\u0064\u0020\u0063\u0065\u006c\u006c: \u0025\u0073",_af );continue ;};_agg :=mergedCell {_fgcd :_edb .RowIdx ,_gbdf :_edb .ColumnIdx ,_ddge :_dfb .RowIdx ,_dbc :_dfb .ColumnIdx };for _dfbb :=_agg ._gbdf -1;_dfbb < _agg ._dbc ;_dfbb ++{_agg ._dba +=_ea ._afg [_dfbb ]._dadd ;};for _bbg :=_agg ._fgcd -1;_bbg < _agg ._ddge ;_bbg ++{_agg ._ggdg +=_ea ._efbe [_bbg ]._gec ;};_bbf =append (_bbf ,&_agg );};_ea ._eggb =_bbf ;};const _dg =3;type page struct{_fca []*pageRow ;_dge bool ;_dceg []*_bd .Image ;_ffba *pagespan ;_gadf *rowspan ;};func (_ebg *convertContext )makeAnchors (){_ad ,_ec :=_ebg ._caae .GetDrawing ();if _ad !=nil {for _ ,_ge :=range _ad .EG_Anchor {_edd :=&anchor {};if _fed :=_ge .TwoCellAnchor ;_fed !=nil {_aac ,_gbe :=_fed .From ,_fed .To ;if _aac ==nil ||_gbe ==nil {return ;};_edd ._fcb =int (_aac .Row );_edd ._edc =_ca .FromSTCoordinate (_aac .RowOff );_edd ._faag =int (_aac .Col );_edd ._gffe =_ca .FromSTCoordinate (_aac .ColOff );_edd ._fgfe =int (_gbe .Row );_edd ._facb =_ca .FromSTCoordinate (_gbe .RowOff );_edd ._cded =int (_gbe .Col );_edd ._aad =_ca .FromSTCoordinate (_gbe .ColOff );if _cb :=_fed .Choice ;_cb !=nil {if _cg :=_cb .Pic ;_cg !=nil {if _gf :=_cg .BlipFill ;_gf !=nil {if _agb :=_gf .Blip ;_agb !=nil {if _fb :=_agb .EmbedAttr ;_fb !=nil {for _ ,_ef :=range _ec .X ().Relationship {if _ef .IdAttr ==*_fb {for _ ,_cba :=range _ebg ._dgdb .Images {if _cba .Target ()==_ef .TargetAttr {_gg ,_ged :=_bc .Open (_cba .Path ());if _ged !=nil {_b .Log .Debug ("\u004fp\u0065\u006e\u0020\u0069m\u0061\u0067\u0065\u0020\u0066i\u006ce\u0020e\u0072\u0072\u006f\u0072\u003a\u0020\u0025s",_ged );continue ;};_geb ,_ ,_ged :=_dd .Decode (_gg );if _ged !=nil {_b .Log .Debug ("\u0044\u0065\u0063\u006fde\u0020\u0069\u006d\u0061\u0067\u0065\u0020\u0065\u0072\u0072\u006f\u0072\u003a\u0020%\u0073",_ged );continue ;};_edd ._ddga =_geb ;};};};};};};};}else if _ff :=_cb .GraphicFrame ;_ff !=nil {if _cab :=_ff .Graphic ;_cab !=nil {if _cgc :=_cab .GraphicData ;_cgc !=nil {for _ ,_ac :=range _cgc .Any {if _ada ,_gad :=_ac .(*_ce .Chart );_gad {for _ ,_cd :=range _ec .X ().Relationship {if _cd .IdAttr ==_ada .IdAttr {_cdd :=_ebg ._dgdb .GetChartByTargetId (_cd .TargetAttr );if _cdd !=nil {_edd ._dece =_cdd ;};};};};};};};};};};if _edd ._ddga !=nil ||_edd ._dece !=nil {_ebg ._eae =append (_ebg ._eae ,_edd );};};};};func (_fgd *convertContext )getColorStringFromSmlColor (_bbdg *_da .CT_Color )*string {var _gbb string ;if _bbdg .RgbAttr !=nil {_gbb =*_bbdg .RgbAttr ;}else if _bbdg .IndexedAttr !=nil &&*_bbdg .IndexedAttr < 64{_gbb =_cef [*_bbdg .IndexedAttr ];}else if _bbdg .ThemeAttr !=nil {_bbcd :=*_bbdg .ThemeAttr ;_gbb =_fgd .getColorFromTheme (_bbcd );};if _gbb ==""{return nil ;};if len (_gbb )> 6{_gbb =_gbb [(len (_gbb )-6):];};if _bbdg .TintAttr !=nil {_afb :=*_bbdg .TintAttr ;_gbb =_ca .AdjustColorByTint (_gbb ,_afb );};_gbb ="\u0023"+_gbb ;return &_gbb ;};func (_egab *convertContext )getSymbolsFromR (_gaea []*_da .CT_RElt ,_bgaf *style )[]*symbol {_gdg :=[]*symbol {};for _ ,_fgec :=range _gaea {_deba :=_egab .combineCellStyleWithRPrElt (_bgaf ,_fgec .RPr );for _ ,_fgf :=range _fgec .T {_gdg =append (_gdg ,&symbol {_cfa :string (_fgf ),_cce :_egab .makeTextStyleFromCellStyle (_deba )});};};return _gdg ;};func (_fee *convertContext )addRowToPage (_dgcc []*cell ,_gebb int ){_gccc :=0.0;_bbad :=_fee ._acga ;for _ ,_bdf :=range _dgcc {if len (_bdf ._dcfg )!=0{_bdf ._dae =_gccc ;_gccc =_bdf ._decg +_bdf ._aggba ;};};for _eef :=len (_dgcc )-1;_eef >=0;_eef --{_eefb :=_dgcc [_eef ];if len (_eefb ._dcfg )!=0{_eefb ._cdg =_bbad ;_bbad =_eefb ._decg ;};};_fee ._cfcgg ._fca =append (_fee ._cfcgg ._fca ,&pageRow {_cfe :_gebb ,_geff :_dgcc });};func _cfbd (_ebfb float64 )float64 {return _ebfb *_fc .Millimeter };func _fac (_adgg *symbol ){_fcffe :=_bd .New ();_gdf :=_fcffe .NewStyledParagraph ();_gdf .SetMargins (0,0,0,0);_cfd :=_gdf .Append (_adgg ._cfa );if _adgg ._cce !=nil {_cfd .Style =*_adgg ._cce ;};_adgg ._ggaf =_gdf .Height ();if _adgg ._abgd ==0{_adgg ._abgd =_gdf .Width ();};};type anchor struct{_ddga _dd .Image ;_dece *_ce .ChartSpace ;_fcb int ;_edc int64 ;_faag int ;_gffe int64 ;_fgfe int ;_facb int64 ;_cded int ;_aad int64 ;};func (_gdfa *convertContext )alignSymbolsHorizontally (_geg *cell ,_fbf _da .ST_HorizontalAlignment ){if _fbf ==_da .ST_HorizontalAlignmentUnset {switch _geg ._bfbe {case _da .ST_CellTypeB :_fbf =_da .ST_HorizontalAlignmentCenter ;case _da .ST_CellTypeN :_fbf =_da .ST_HorizontalAlignmentRight ;default:_fbf =_da .ST_HorizontalAlignmentLeft ;};};var _cafc float64 ;for _ ,_eea :=range _geg ._dcfg {switch _fbf {case _da .ST_HorizontalAlignmentLeft :_cafc =_dg ;case _da .ST_HorizontalAlignmentRight :_bgf :=_egbc (_eea ._eda );_cafc =_geg ._aggba -_dg -_bgf ;case _da .ST_HorizontalAlignmentCenter :_affc :=_egbc (_eea ._eda );_cafc =(_geg ._aggba -_affc )/2;};for _ ,_deec :=range _eea ._eda {_deec ._dcgd +=_cafc ;};};};type rowspan struct{_feea float64 ;_cbda int ;_gead int ;};var _a =3.025/_cfbd (1);

// FontStyle represents a kind of font styling. It can be FontStyle_Regular, FontStyle_Bold, FontStyle_Italic and FontStyle_BoldItalic.
type FontStyle =_ca .FontStyle ;

// RegisterFont makes a PdfFont accessible for using in converting to PDF.
func RegisterFont (name string ,style FontStyle ,font *_fg .PdfFont ){_ca .RegisterFont (name ,style ,font );};type style struct{_gbd *string ;_gddc *float64 ;_dec *string ;_bedg *bool ;_agab *bool ;_fage *bool ;_cecg *bool ;_ecef *bool ;_febf *border ;_ebec *border ;_dgf *border ;_cecf *border ;_fcdf bool ;_beg _da .ST_VerticalAlignment ;_fafg _da .ST_HorizontalAlignment ;};func (_ccfg *convertContext )imageFromAnchor (_febg *anchor ,_faa ,_fbg float64 )_dd .Image {if _febg ._ddga !=nil {return _febg ._ddga ;};if _febg ._dece !=nil {_aag ,_bec :=_ca .MakeImageFromChartSpace (_febg ._dece ,_faa ,_fbg ,_ccfg ._ggca );if _bec !=nil {_b .Log .Debug ("C\u0061\u006e\u006e\u006f\u0074\u0020\u006d\u0061\u006b\u0065\u0020\u0061\u006e\u0020\u0069\u006d\u0061\u0067e\u0020\u0066\u0072\u006f\u006d\u0020\u0063\u0068\u0061\u0072tS\u0070\u0061\u0063e\u003a \u0025\u0073",_bec );return nil ;};return _aag ;};return nil ;};type pagespan struct{_bffe float64 ;_adae []*page ;_geag int ;_efbg int ;};func (_aec *convertContext )getStyleFromRPrElt (_egbg *_da .CT_RPrElt )*style {if _egbg ==nil {return nil ;};_edeb :=&style {};_edeb ._dec =&_egbg .RFont .ValAttr ;if _dgef :=_egbg .B ;_dgef !=nil {_bafc :=_dgef .ValAttr ==nil ||*_dgef .ValAttr ;_edeb ._bedg =&_bafc ;};if _eba :=_egbg .I ;_eba !=nil {_age :=_eba .ValAttr ==nil ||*_eba .ValAttr ;_edeb ._agab =&_age ;};if _fafd :=_egbg .U ;_fafd !=nil {_gfea :=_fafd .ValAttr ==_da .ST_UnderlineValuesSingle ||_fafd .ValAttr ==_da .ST_UnderlineValuesUnset ;_edeb ._fage =&_gfea ;};if _bag :=_egbg .VertAlign ;_bag !=nil {_cacf :=_bag .ValAttr ==_e .ST_VerticalAlignRunSuperscript ;_edeb ._cecg =&_cacf ;_cdc :=_bag .ValAttr ==_e .ST_VerticalAlignRunSubscript ;_edeb ._ecef =&_cdc ;};if _daee :=_egbg .Sz ;_daee !=nil {_bedc :=_daee .ValAttr /12*_ca .DefaultFontSize ;_edeb ._gddc =&_bedc ;};if _dbd :=_egbg .Color ;_dbd !=nil {_edeb ._gbd =_aec .getColorStringFromSmlColor (_dbd );};return _edeb ;};const _ba =0.64;const _fgg =0.25;type border struct{_dffe float64 ;_gdda _bd .Color ;};func (_ddee *convertContext )makeRows (){_ggb :=[]*rowInfo {};_bbe :=_ddee ._caae .Rows ();_ccc :=0;for _ ,_acc :=range _bbe {_ccc ++;_daa :=int (_acc .RowNumber ());if _daa > _ccc {for _dcf :=_ccc ;_dcf < _daa ;_dcf ++{_ggb =append (_ggb ,&rowInfo {_gec :16/_a });};_ccc =_daa ;};var _abdg float64 ;if _acc .X ().HtAttr ==nil {_abdg =16;}else {_abdg =*_acc .X ().HtAttr ;};_ggb =append (_ggb ,&rowInfo {_gec :_abdg /_a ,_ccde :true ,_cefc :_ddee .getStyle (_acc .X ().SAttr )});};for _bae :=len (_ggb );_bae < _ddee ._gab ;_bae ++{_ggb =append (_ggb ,&rowInfo {_gec :16/_a });};_ddee ._efbe =_ggb ;};func (_bfac *convertContext )getBorder (_bffb *_da .CT_BorderPr )*border {_ecea :=&border {};switch _bffb .StyleAttr {case _da .ST_BorderStyleThin :_ecea ._dffe =_ab ;case _da .ST_BorderStyleMedium :_ecea ._dffe =_ab *2;case _da .ST_BorderStyleThick :_ecea ._dffe =_ab *4;};if _ecea ._dffe ==0.0{return nil ;};if _dcce :=_bffb .Color ;_dcce !=nil {_faed :=_bfac .getColorStringFromSmlColor (_dcce );if _faed !=nil {_ecea ._gdda =_bd .ColorRGBFromHex (*_faed );}else {_ecea ._gdda =_bd .ColorBlack ;};};return _ecea ;};type line struct{_gfeg float64 ;_eda []*symbol ;_bbd float64 ;};func (_ggea *convertContext )drawPage (_fdb *page ){_ddb :=_ggea ._gcfc ;_ddf :=_ggea ._dega ;for _ ,_bade :=range _fdb ._fca {_ecfd :=_ggea ._efbe [_bade ._cfe ];for _ ,_ace :=range _bade ._geff {_acf :=_ace ._dae < _ace ._decg ;_ccd :=_ace ._cdg > _ace ._decg +_ace ._aggba ;var _aab ,_bff bool ;for _ ,_caf :=range _ace ._dcfg {for _ ,_badc :=range _caf ._eda {if _acf &&!_aab {_aab =_badc ._dcgd < 0;};if _ccd &&!_bff {_bff =_ace ._aggba < _badc ._dcgd +_badc ._abgd ;};if _ace ._decg +_badc ._dcgd >=_ace ._dae &&_ace ._decg +_badc ._dcgd +_badc ._abgd <=_ace ._cdg {_cadc :=_ggea ._ggc .NewStyledParagraph ();_ade :=_ddf +_ace ._decg +_badc ._dcgd ;_fab :=_ddb +_ecfd ._cee +_caf ._gfeg -_badc ._ggaf -_cfbd (0.5);_cadc .SetPos (_ade ,_fab );var _bgdb *_bd .TextChunk ;if _badc ._cdfb !=""{_bgdb =_cadc .AddExternalLink (_badc ._cfa ,_badc ._cdfb );}else {_bgdb =_cadc .Append (_badc ._cfa );};if _badc ._cce !=nil {_bgdb .Style =*_badc ._cce ;};_ggea ._ggc .Draw (_cadc );};};};var _gfe ,_agc ,_aggd ,_agfb ,_cbea ,_eaf float64 ;var _gfb ,_efb ,_bbc ,_dee _bd .Color ;if _ddc :=_ace ._baef ;_ddc !=nil {_gfe =_ddc ._dffe ;_gfb =_ddc ._gdda ;};if _gca :=_ace ._ceee ;_gca !=nil {_agc =_gca ._dffe ;_efb =_gca ._gdda ;};if _fdbg :=_ace ._edee ;_fdbg !=nil {_aggd =_fdbg ._dffe ;_cbea =_aggd /2;_bbc =_fdbg ._gdda ;};if _fcee :=_ace ._agbc ;_fcee !=nil {_agfb =_fcee ._dffe ;_eaf =_agfb /2;_dee =_fcee ._gdda ;};var _gccg float64 ;if _bade ._cfe > 1{_gccg =_ggea ._efbe [_bade ._cfe -1]._gbfg ;};_cbc :=_ddb +_ecfd ._cee -0.5*(_gccg -_gfe );_caaa :=_ddb +_ecfd ._cee +_ecfd ._gec +0.5*(_ecfd ._gbfg +_agc );_cdb :=_ddf +_ace ._decg ;_aff :=_cdb +_ace ._dged ;_ca .DrawLine (_ggea ._ggc ,_cdb ,_cbc ,_aff ,_cbc ,_gfe ,_gfb );_ca .DrawLine (_ggea ._ggc ,_cdb ,_caaa ,_aff ,_caaa ,_agc ,_efb );if !_aab {_ca .DrawLine (_ggea ._ggc ,_cdb -_cbea ,_cbc ,_cdb -_cbea ,_caaa ,_aggd ,_bbc );};if !_bff {_ca .DrawLine (_ggea ._ggc ,_aff -_eaf ,_cbc ,_aff -_eaf ,_caaa ,_agfb ,_dee );};};};for _ ,_deg :=range _fdb ._dceg {if _deg !=nil {_ggea ._ggc .Draw (_deg );};};};type convertContext struct{_ggc *_bd .Creator ;_dgdb *_cf .Workbook ;_ggca *_c .Theme ;_caae *_cf .Sheet ;_ddcb *_cf .StyleSheet ;_gab int ;_aggb int ;_aga []*pagespan ;_cfcgg *page ;_afg []*colInfo ;_efbe []*rowInfo ;_aacc []*rowspan ;_gcfc float64 ;_dega float64 ;_cafb float64 ;_acga float64 ;_eggb []*mergedCell ;_eae []*anchor ;};func (_efd *convertContext )fillPages (){for _ffbc ,_cbad :=range _efd ._aacc {_cggd :=_efd ._efbe [_cbad ._cbda :_cbad ._gead ];for _dfd ,_dcc :=range _cggd {_feg :=0;_beb :=0.0;_agbe :=[]*cell {};if _dcc ._ccde {for _ ,_db :=range _dcc ._dcaf {_ebc :=_efd ._aga [_feg ];_efd ._cfcgg =_ebc ._adae [_ffbc ];_efd ._cfcgg ._dge =true ;_aba :=_db ._dged ;if _beb +_aba > _ebc ._bffe {_efd .addRowToPage (_agbe ,_dfd );_agbe =[]*cell {_db };_beb =_aba ;_feg ++;}else {_db ._decg =_beb ;_agbe =append (_agbe ,_db );_beb +=_aba ;};};if len (_agbe )> 0{_gfa :=_efd ._aga [_feg ];_efd ._cfcgg =_gfa ._adae [_ffbc ];_efd ._cfcgg ._dge =true ;_efd .addRowToPage (_agbe ,_dfd );};};};};};var _ed =_cfbd (1);func (_dcbb *convertContext )getContentFromCell (_gccf _cf .Cell ,_cbcd *style ,_fbd float64 ,_cfcd bool )([]*line ,_da .ST_CellType ){_eff :=_gccf .X ();var _fcff []*symbol ;switch _eff .TAttr {case _da .ST_CellTypeS :_bbed :=_eff .V ;if _bbed !=nil {_ccfb ,_deb :=_f .Atoi (*_bbed );if _deb ==nil {_gcb :=_dcbb ._dgdb .SharedStrings .X ().Si [_ccfb ];if _gcb .T !=nil {_fcff =_dcbb .getSymbolsFromString (*_gcb .T ,_cbcd );}else if _gcb .R !=nil {_fcff =_dcbb .getSymbolsFromR (_gcb .R ,_cbcd );};};};case _da .ST_CellTypeB :_gbad :=_eff .V ;if _gbad !=nil {if *_gbad =="\u0030"{_fcff =_dcbb .getSymbolsFromString ("\u0046\u0041\u004cS\u0045",_cbcd );}else {_fcff =_dcbb .getSymbolsFromString ("\u0054\u0052\u0055\u0045",_cbcd );};};default:_fcff =_dcbb .getSymbolsFromString (_gccf .GetFormattedValue (),_cbcd );};_ege :=0.0;_efaf :=0.0;var _aaa []*line ;var _afca bool ;if _cbcd !=nil {if _cbcd ._cecg !=nil {if *_cbcd ._cecg {_afca =true ;};};if _cbcd ._ecef !=nil {if *_cbcd ._ecef {_afca =true ;};};};if _cfcd {_aaa =[]*line {};_ebb :=_fbd -2*_dg ;_acea :=[]*symbol {};for _ ,_abg :=range _fcff {_fac (_abg );if _ege +_abg ._abgd >=_ebb {_bfa :=_cgcg (_acea );if _afca {_bfa /=_ba ;};_aaa =append (_aaa ,&line {_gfeg :_efaf ,_eda :_acea ,_bbd :_bfa });_acea =[]*symbol {_abg };_ege =_abg ._abgd ;_efaf +=_bfa ;}else {_abg ._dcgd =_ege ;_ege +=_abg ._abgd ;_acea =append (_acea ,_abg );};};_bcf :=_cgcg (_acea );if _afca {_bcf /=_ba ;};if len (_acea )> 0{_aaa =append (_aaa ,&line {_gfeg :_efaf ,_eda :_acea ,_bbd :_bcf });};}else {for _ ,_dfg :=range _fcff {_fac (_dfg );_dfg ._dcgd =_ege ;_ege +=_dfg ._abgd ;};if len (_fcff )> 0{_aaa =[]*line {&line {_eda :_fcff ,_bbd :_cgcg (_fcff )}};};};_gcbe :=_eff .TAttr ;if _gcbe ==_da .ST_CellTypeUnset {_gcbe =_da .ST_CellTypeN ;};return _aaa ,_gcbe ;};func (_gcc *convertContext )drawSheet (){for _gee ,_cfc :=range _gcc ._aga {_dbe :=len (_cfc ._adae );if _gee ==len (_gcc ._aga )-1{for _fag :=len (_cfc ._adae )-1;_fag >=0;_fag --{if !_cfc ._adae [_fag ]._dge {_dbe =_fag ;};};};_aae :=_cfc ._adae [:_dbe ];for _ ,_afdf :=range _aae {_gcc ._ggc .NewPage ();_gcc .drawPage (_afdf );};};};type symbol struct{_cfa string ;_dcgd float64 ;_ggaf float64 ;_abgd float64 ;_cce *_bd .TextStyle ;_cdfb string ;};type pageRow struct{_cfe int ;_geff []*cell ;};type rowInfo struct{_cee float64 ;_ccde bool ;_gec float64 ;_cefc *style ;_dcaf []*cell ;_gbfg float64 ;};func (_dccb *convertContext )getStyleFromCell (_dfcc _cf .Cell ,_ebde ,_bfbd *style )*style {_cbeag :=_dfcc .X ();_cfb :=_dccb .getStyle (_cbeag .SAttr );_ddcbd (_cfb ,_ebde );_ddcbd (_cfb ,_bfbd );return _cfb ;};var _ab =_cfbd (0.0625);const _bde =1.5;var _gdag =map[uint32 ]_bd .PageSize {1:_bd .PageSize {8.5*_fc .Inch ,11*_fc .Inch },2:_bd .PageSize {8.5*_fc .Inch ,11*_fc .Inch },3:_bd .PageSize {11*_fc .Inch ,17*_fc .Inch },4:_bd .PageSize {17*_fc .Inch ,11*_fc .Inch },5:_bd .PageSize {8.5*_fc .Inch ,14*_fc .Inch },6:_bd .PageSize {5.5*_fc .Inch ,8.5*_fc .Inch },7:_bd .PageSize {7.5*_fc .Inch ,10*_fc .Inch },8:_bd .PageSize {_cfbd (297),_cfbd (420)},9:_bd .PageSize {_cfbd (210),_cfbd (297)},10:_bd .PageSize {_cfbd (210),_cfbd (297)},11:_bd .PageSize {_cfbd (148),_cfbd (210)},70:_bd .PageSize {_cfbd (105),_cfbd (148)},12:_bd .PageSize {_cfbd (250),_cfbd (354)},13:_bd .PageSize {_cfbd (182),_cfbd (257)},14:_bd .PageSize {8.5*_fc .Inch ,13*_fc .Inch },20:_bd .PageSize {4.125*_fc .Inch ,9.5*_fc .Inch },27:_bd .PageSize {_cfbd (110),_cfbd (220)},28:_bd .PageSize {_cfbd (162),_cfbd (229)},34:_bd .PageSize {_cfbd (250),_cfbd (176)},29:_bd .PageSize {_cfbd (324),_cfbd (458)},30:_bd .PageSize {_cfbd (229),_cfbd (324)},31:_bd .PageSize {_cfbd (114),_cfbd (162)},37:_bd .PageSize {3.88*_fc .Inch ,7.5*_fc .Inch },43:_bd .PageSize {_cfbd (100),_cfbd (148)},69:_bd .PageSize {_cfbd (200),_cfbd (148)}};func (_bed *convertContext )distributeAnchors (){for _ ,_cad :=range _bed ._eae {_adg ,_egg :=_cad ._fcb ,_cad ._edc ;_gebec ,_cgbg :=_cad ._faag ,_cad ._gffe ;_gdab ,_fge :=_cad ._fgfe ,_cad ._facb ;_bab ,_babb :=_cad ._cded ,_cad ._aad ;var _afc ,_ddg ,_adgf ,_eca *page ;for _ ,_aeb :=range _bed ._aga {for _ ,_efa :=range _aeb ._adae {if _adg >=_efa ._gadf ._cbda &&_adg < _efa ._gadf ._gead {if _gebec >=_efa ._ffba ._geag &&_gebec < _efa ._ffba ._efbg {_efa ._dge =true ;_afc =_efa ;};if _bab >=_efa ._ffba ._geag &&_bab < _efa ._ffba ._efbg {_efa ._dge =true ;_ddg =_efa ;};};if _gdab >=_efa ._gadf ._cbda &&_gdab < _efa ._gadf ._gead {if _gebec >=_efa ._ffba ._geag &&_gebec < _efa ._ffba ._efbg {_efa ._dge =true ;_eca =_efa ;};if _bab >=_efa ._ffba ._geag &&_bab < _efa ._ffba ._efbg {_efa ._dge =true ;_adgf =_efa ;};};};};_acg :=_afc !=_ddg ;_efe :=_afc !=_eca ;if _acg &&_efe {_bcc :=_bed ._afg [_gebec ]._dda +_fc .FromEMU (_cgbg );_dfbf :=_afc ._ffba ._bffe ;_bgac :=_bed ._afg [_bab ]._dda +_fc .FromEMU (_babb );_cdf :=_bed ._efbe [_adg ]._cee +_fc .FromEMU (_egg );_cde :=float64 (_afc ._gadf ._feea );_gae :=_bed ._efbe [_gdab ]._cee +_fc .FromEMU (_fge );_beba :=_bgac +_dfbf -_bcc ;_cabc :=_gae +_cde -_cdf ;_bad :=_bed .imageFromAnchor (_cad ,_beba ,_cabc );_afc ._dceg =append (_afc ._dceg ,_bed .getImage (_bad ,_cabc ,_beba ,_bcc ,_cdf ,_dfbf -_bcc ,_cde -_cdf ,_ca .ImgPart_lt ));_ddg ._dceg =append (_ddg ._dceg ,_bed .getImage (_bad ,_cabc ,_beba ,0,_cdf ,_dfbf -_bcc ,_cde -_cdf ,_ca .ImgPart_rt ));_eca ._dceg =append (_eca ._dceg ,_bed .getImage (_bad ,_cabc ,_beba ,_bcc ,0,_dfbf -_bcc ,_cde -_cdf ,_ca .ImgPart_lb ));_adgf ._dceg =append (_adgf ._dceg ,_bed .getImage (_bad ,_cabc ,_beba ,0,0,_dfbf -_bcc ,_cde -_cdf ,_ca .ImgPart_rb ));}else if _acg {_gaa :=_bed ._efbe [_adg ]._cee +_fc .FromEMU (_egg );_dcb :=_bed ._efbe [_gdab ]._cee +_fc .FromEMU (_fge );_gebd :=_bed ._afg [_gebec ]._dda +_fc .FromEMU (_cgbg );_fced :=_afc ._ffba ._bffe ;_bgcd :=_bed ._afg [_bab ]._dda +_fc .FromEMU (_babb );_egd :=_bgcd +_fced -_gebd ;_bce :=_dcb -_gaa ;_gbf :=_bed .imageFromAnchor (_cad ,_egd ,_bce );_afc ._dceg =append (_afc ._dceg ,_bed .getImage (_gbf ,_bce ,_egd ,_gebd ,_gaa ,_fced -_gebd ,0,_ca .ImgPart_l ));_ddg ._dceg =append (_ddg ._dceg ,_bed .getImage (_gbf ,_bce ,_egd ,0,_gaa ,_fced -_gebd ,0,_ca .ImgPart_r ));}else if _efe {_bcd :=_bed ._afg [_gebec ]._dda +_fc .FromEMU (_cgbg );_gfae :=_bed ._afg [_bab ]._dda +_fc .FromEMU (_babb );_dfc :=_bed ._efbe [_adg ]._cee +_fc .FromEMU (_egg );_fcf :=float64 (_afc ._gadf ._feea );_gde :=_bed ._efbe [_gdab ]._cee +_fc .FromEMU (_fge );_ddd :=_gfae -_bcd ;_cbgb :=_gde +_fcf -_dfc ;_bfb :=_bed .imageFromAnchor (_cad ,_ddd ,_cbgb );_afc ._dceg =append (_afc ._dceg ,_bed .getImage (_bfb ,_cbgb ,_ddd ,_bcd ,_dfc ,0,_fcf -_dfc ,_ca .ImgPart_t ));_eca ._dceg =append (_eca ._dceg ,_bed .getImage (_bfb ,_cbgb ,_ddd ,_bcd ,0,0,_fcf -_dfc ,_ca .ImgPart_b ));}else {_dcg :=_bed ._afg [_gebec ]._dda +_fc .FromEMU (_cgbg );_def :=_bed ._afg [_bab ]._dda +_fc .FromEMU (_babb );_cff :=_bed ._efbe [_adg ]._cee +_fc .FromEMU (_egg );_cec :=_bed ._efbe [_gdab ]._cee +_fc .FromEMU (_fge );_ggg :=_def -_dcg ;_bea :=_cec -_cff ;_bdb :=_bed .imageFromAnchor (_cad ,_ggg ,_bea );_afc ._dceg =append (_afc ._dceg ,_bed .getImage (_bdb ,_bea ,_ggg ,_dcg ,_cff ,0,0,_ca .ImgPart_whole ));};};};func (_abdb *convertContext )getStyle (_eged *uint32 )*style {_daf :=&style {};_agfd :=false ;if _eged !=nil {_ecd :=_abdb ._ddcb .GetCellStyle (*_eged );_cfee :=_ecd .GetFont ();for _ ,_feae :=range _cfee .Name {if _feae !=nil {_daf ._dec =&_feae .ValAttr ;_agfd =true ;break ;};};for _ ,_bfc :=range _cfee .B {if _bfc !=nil {_dga :=_bfc .ValAttr ==nil ||*_bfc .ValAttr ;_daf ._bedg =&_dga ;_agfd =true ;break ;};};for _ ,_affa :=range _cfee .I {if _affa !=nil {_cgac :=_affa .ValAttr ==nil ||*_affa .ValAttr ;_daf ._agab =&_cgac ;_agfd =true ;break ;};};for _ ,_begg :=range _cfee .U {if _begg !=nil {_fdf :=_begg .ValAttr ==_da .ST_UnderlineValuesSingle ||_begg .ValAttr ==_da .ST_UnderlineValuesUnset ;_daf ._fage =&_fdf ;_agfd =true ;break ;};};for _ ,_gcee :=range _cfee .Sz {if _gcee !=nil {_effg :=_gcee .ValAttr /12*_ca .DefaultFontSize ;_daf ._gddc =&_effg ;_agfd =true ;break ;};};for _ ,_deed :=range _cfee .VertAlign {if _deed !=nil {_afcf :=_deed .ValAttr ==_e .ST_VerticalAlignRunSuperscript ;_daf ._cecg =&_afcf ;_ebfec :=_deed .ValAttr ==_e .ST_VerticalAlignRunSubscript ;_daf ._ecef =&_ebfec ;_agfd =true ;break ;};};for _ ,_dgcd :=range _cfee .Color {if _dgcd !=nil {_daf ._gbd =_abdb .getColorStringFromSmlColor (_dgcd );_agfd =true ;break ;};};_cfeb :=_ecd .GetBorder ();if _cfeb .Top !=nil {_daf ._febf =_abdb .getBorder (_cfeb .Top );_agfd =true ;};if _cfeb .Bottom !=nil {_daf ._ebec =_abdb .getBorder (_cfeb .Bottom );_agfd =true ;};if _cfeb .Left !=nil {_daf ._dgf =_abdb .getBorder (_cfeb .Left );_agfd =true ;};if _cfeb .Right !=nil {_daf ._cecf =_abdb .getBorder (_cfeb .Right );_agfd =true ;};if _ecd .Wrapped (){_daf ._fcdf =true ;_agfd =true ;};if _efc :=_ecd .GetVerticalAlignment ();_efc !=_da .ST_VerticalAlignmentUnset {_daf ._beg =_efc ;_agfd =true ;};if _fgca :=_ecd .GetHorizontalAlignment ();_fgca !=_da .ST_HorizontalAlignmentUnset {_daf ._fafg =_fgca ;_agfd =true ;};};if _agfd {return _daf ;};return nil ;};func (_be *convertContext )makeCells (){_eaa :=_be ._caae ;_cabd :=_eaa .Rows ();_ebe :=0;for _ ,_bge :=range _be ._efbe {_bge ._dcaf =[]*cell {};_fce :=0.0;_bgce :=_bge ._cefc ;if _bge ._ccde {_ccca :=_cabd [_ebe ];_ebe ++;_ead :=_bge ._gec ;for _ ,_feb :=range _ccca .Cells (){_cgb ,_aed :=_eb .ParseCellReference (_feb .Reference ());if _aed !=nil {_b .Log .Debug ("\u0043\u0061\u006e\u006eo\u0074\u0020\u0070\u0061\u0072\u0073\u0065\u0020\u0061\u0020r\u0065f\u0065\u0072\u0065\u006e\u0063\u0065\u003a \u0025\u0073",_aed );continue ;};_gga :=_be ._afg [_cgb .ColumnIdx ];_ffb :=_gga ._dadd ;_fcef :=_ffb ;_gff :=_gga ._ggbe ;var _gba ,_aggf ,_cga ,_cae bool ;for _ ,_bf :=range _be ._eggb {if _cgb .RowIdx >=_bf ._fgcd &&_cgb .RowIdx <=_bf ._ddge &&_cgb .ColumnIdx >=_bf ._gbdf &&_cgb .ColumnIdx <=_bf ._dbc {if _cgb .ColumnIdx ==_bf ._gbdf &&_cgb .RowIdx ==_bf ._fgcd {_ffb =_bf ._dba ;_ead =_bf ._ggdg ;};_gba =_cgb .RowIdx !=_bf ._fgcd ;_aggf =_cgb .RowIdx !=_bf ._ddge ;_cga =_cgb .ColumnIdx !=_bf ._gbdf ;_cae =_cgb .ColumnIdx !=_bf ._dbc ;};};_gfg :=_be .getStyleFromCell (_feb ,_bgce ,_gff );var _edg ,_dca ,_fcg bool ;var _gcf ,_bfe ,_bee ,_adac *border ;var _bgd _da .ST_VerticalAlignment ;var _aafa _da .ST_HorizontalAlignment ;if _gfg !=nil {if !_gba {_gcf =_gfg ._febf ;};if !_aggf {_bfe =_gfg ._ebec ;};if !_cga {_bee =_gfg ._dgf ;};if !_cae {_adac =_gfg ._cecf ;};if _bfe !=nil &&_bfe ._dffe > _fce {_fce =_bfe ._dffe ;};_bgd =_gfg ._beg ;_aafa =_gfg ._fafg ;if _gfg ._cecg !=nil {_edg =*_gfg ._cecg ;};if _gfg ._ecef !=nil {_dca =*_gfg ._ecef ;};_fcg =_gfg ._fcdf ;};_gef ,_de :=_be .getContentFromCell (_feb ,_gfg ,_ffb ,_fcg );_gge :=&cell {_bfbe :_de ,_aggba :_ffb ,_dged :_fcef ,_ecg :_ead ,_dcfg :_gef ,_baef :_gcf ,_ceee :_bfe ,_edee :_bee ,_agbc :_adac ,_aef :_edg ,_gfbb :_dca };_be .alignSymbolsHorizontally (_gge ,_aafa );_be .alignSymbolsVertically (_gge ,_bgd );_bge ._dcaf =append (_bge ._dcaf ,_gge );};};_bge ._gbfg =_fce ;};};const (FontStyle_Regular FontStyle =0;FontStyle_Bold FontStyle =1;FontStyle_Italic FontStyle =2;FontStyle_BoldItalic FontStyle =3;);

// RegisterFontsFromDirectory registers all fonts from the given directory automatically detecting font families and styles.
func RegisterFontsFromDirectory (dirName string )error {return _ca .RegisterFontsFromDirectory (dirName )};func (_daaf *convertContext )makePagespans (){_daaf ._aga =[]*pagespan {};_cbe :=0.0;_bbga :=0;for _fcdd ,_gdd :=range _daaf ._afg {_ecc :=_gdd ._dadd ;if _cbe +_ecc <=_daaf ._acga {_gdd ._dda =_cbe ;_cbe +=_ecc ;}else {_gdd ._dda =0;_daaf ._aga =append (_daaf ._aga ,&pagespan {_bffe :_cbe ,_geag :_bbga ,_efbg :_fcdd });_cbe =_ecc ;_bbga =_fcdd ;};};_daaf ._aga =append (_daaf ._aga ,&pagespan {_bffe :_cbe ,_geag :_bbga ,_efbg :len (_daaf ._afg )});};type colInfo struct{_dda float64 ;_dadd float64 ;_ggbe *style ;};type mergedCell struct{_fgcd uint32 ;_gbdf uint32 ;_ddge uint32 ;_dbc uint32 ;_dba float64 ;_ggdg float64 ;};func (_baf *convertContext )makeRowspans (){var _afd float64 ;_cgg :=0;for _bbae ,_ceb :=range _baf ._efbe {_cbef :=_ceb ._gec +_ceb ._gbfg ;if _afd +_cbef <=_baf ._cafb {_ceb ._cee =_afd ;_afd +=_cbef ;}else {_baf ._aacc =append (_baf ._aacc ,&rowspan {_feea :_afd ,_cbda :_cgg ,_gead :_bbae });_cgg =_bbae ;_ceb ._cee =0;_afd =_cbef ;};};_baf ._aacc =append (_baf ._aacc ,&rowspan {_feea :_afd ,_cbda :_cgg ,_gead :len (_baf ._efbe )});};func _egbc (_dcaa []*symbol )float64 {_afce :=0.0;for _ ,_cfcg :=range _dcaa {_afce +=_cfcg ._abgd ;};return _afce ;};func (_ebcf *convertContext )getSymbolsFromString (_gdb string ,_gce *style )[]*symbol {_egaa :=[]*symbol {};_aacd :=_ebcf .makeTextStyleFromCellStyle (_gce );for _ ,_aee :=range _gdb {_egaa =append (_egaa ,&symbol {_cfa :string (_aee ),_cce :_aacd });};return _egaa ;};func (_dad *convertContext )alignSymbolsVertically (_dea *cell ,_ddcd _da .ST_VerticalAlignment ){var _ece float64 ;switch _ddcd {case _da .ST_VerticalAlignmentTop :_ece =_bg ;if _dea ._aef {_ece -=_bde ;}else if _dea ._gfbb {_ece +=4*_bde ;};for _ ,_fcc :=range _dea ._dcfg {_ece +=_fcc ._bbd ;_fcc ._gfeg =_ece ;_ece +=_ed ;};case _da .ST_VerticalAlignmentCenter :_aggc :=0.0;for _ ,_ceca :=range _dea ._dcfg {_aggc +=_ceca ._bbd +_cfbd (1);};_ece =0.5*(_dea ._ecg -_aggc );if _dea ._aef {_ece -=2*_bde ;}else if _dea ._gfbb {_ece +=2*_bde ;};for _ ,_gfd :=range _dea ._dcfg {_ece +=_gfd ._bbd +0.5*_ed ;_gfd ._gfeg =_ece ;_ece +=0.5*_ed ;};default:_ece =_dea ._ecg -_bg ;if _dea ._aef {_ece -=4*_bde ;}else if _dea ._gfbb {_ece +=_bde ;};for _fde :=len (_dea ._dcfg )-1;_fde >=0;_fde --{_dea ._dcfg [_fde ]._gfeg =_ece ;_ece -=_dea ._dcfg [_fde ]._bbd ;_ece -=_ed ;};};};