//
// Copyright 2020 FoxyUtils ehf. All rights reserved.
//
// This is a commercial product and requires a license to operate.
// A trial license can be obtained at https://unidoc.io
//
// DO NOT EDIT: generated by unitwist Go source code obfuscator.
//
// Use of this source code is governed by the UniDoc End User License Agreement
// terms that can be accessed at https://unidoc.io/eula/

package convert ;import (_ce "github.com/unidoc/unioffice/common/tempstorage";_add "github.com/unidoc/unioffice/internal/convertutils";_fd "github.com/unidoc/unioffice/measurement";_b "github.com/unidoc/unioffice/schema/soo/dml";_dd "github.com/unidoc/unioffice/schema/soo/dml/chart";_g "github.com/unidoc/unioffice/schema/soo/ofc/sharedTypes";_gg "github.com/unidoc/unioffice/schema/soo/sml";_ec "github.com/unidoc/unioffice/spreadsheet";_e "github.com/unidoc/unioffice/spreadsheet/reference";_ad "github.com/unidoc/unipdf/v3/creator";_fb "github.com/unidoc/unipdf/v3/model";_c "image";_f "log";_a "strconv";);func (_fbdb *convertContext )imageFromAnchor (_cdcg *anchor ,_ddae ,_aba float64 )_c .Image {if _cdcg ._cdcd !=nil {return _cdcg ._cdcd ;};if _cdcg ._eeg !=nil {_gcfa ,_dcag :=_add .MakeImageFromChartSpace (_cdcg ._eeg ,_ddae ,_aba ,_fbdb ._cbf );if _dcag !=nil {_f .Println ("\u0043\u0061n\u006e\u006f\u0074\u0020m\u0061\u006be\u0020\u0061\u006e\u0020\u0069\u006d\u0061\u0067e\u0020\u0066\u0072\u006f\u006d\u0020\u0063\u0068\u0061\u0072\u0074\u0053p\u0061\u0063\u0065\u003a",_dcag );return nil ;};return _gcfa ;};return nil ;};func _gdfc (_ceagd ,_gfbc *style ){if _gfbc ==nil {return ;};if _ceagd ==nil {_ceagd =_gfbc ;return ;};if _ceagd ._efe ==nil {_ceagd ._efe =_gfbc ._efe ;};if _ceagd ._agfd ==nil {_ceagd ._agfd =_gfbc ._agfd ;};if _ceagd ._ebdg ==nil {_ceagd ._ebdg =_gfbc ._ebdg ;};if _ceagd ._egabb ==nil {_ceagd ._egabb =_gfbc ._egabb ;};if _ceagd ._eabd ==nil {_ceagd ._eabd =_gfbc ._eabd ;};if _ceagd ._bfde ==nil {_ceagd ._bfde =_gfbc ._bfde ;};if _ceagd ._fagd ==nil {_ceagd ._fagd =_gfbc ._fagd ;};if _ceagd ._beb ==nil {_ceagd ._beb =_gfbc ._beb ;};if _ceagd ._cfe ==nil {_ceagd ._cfe =_gfbc ._cfe ;};if _ceagd ._dga ==nil {_ceagd ._dga =_gfbc ._dga ;};if _ceagd ._cae ==nil {_ceagd ._cae =_gfbc ._cae ;};if _ceagd ._gcg ==nil {_ceagd ._gcg =_gfbc ._gcg ;};if _ceagd ._dgaf ==_gg .ST_VerticalAlignmentUnset {_ceagd ._dgaf =_gfbc ._dgaf ;};if _ceagd ._dcg ==_gg .ST_HorizontalAlignmentUnset {_ceagd ._dcg =_gfbc ._dcg ;};};type border struct{_cgfd float64 ;_edgc _ad .Color ;};func (_gaf *convertContext )makePagespans (){_gaf ._gcb =[]*pagespan {};_gf :=0.0;_efd :=0;for _ggde ,_dde :=range _gaf ._bbga {_dad :=_dde ._aab ;if _gf +_dad <=_gaf ._eeag {_dde ._dfdb =_gf ;_gf +=_dad ;}else {_dde ._dfdb =0;_gaf ._gcb =append (_gaf ._gcb ,&pagespan {_bfbgf :_gf ,_bage :_efd ,_cfg :_ggde });_gf =_dad ;_efd =_ggde ;};};_gaf ._gcb =append (_gaf ._gcb ,&pagespan {_bfbgf :_gf ,_bage :_efd ,_cfg :len (_gaf ._bbga )});};func (_gebg *convertContext )alignSymbolsVertically (_cgac *cell ,_deee _gg .ST_VerticalAlignment ){var _fgdf float64 ;switch _deee {case _gg .ST_VerticalAlignmentTop :_fgdf =_gb ;if _cgac ._eeff {_fgdf -=_fdd ;}else if _cgac ._adee {_fgdf +=4*_fdd ;};for _ ,_gac :=range _cgac ._edcb {_fgdf +=_gac ._ddc ;_gac ._affc =_fgdf ;_fgdf +=_cd ;};case _gg .ST_VerticalAlignmentCenter :_fgce :=0.0;for _ ,_egc :=range _cgac ._edcb {_fgce +=_egc ._ddc +_bfg (1);};_fgdf =0.5*(_cgac ._abaf -_fgce );if _cgac ._eeff {_fgdf -=2*_fdd ;}else if _cgac ._adee {_fgdf +=2*_fdd ;};for _ ,_gdga :=range _cgac ._edcb {_fgdf +=_gdga ._ddc +0.5*_cd ;_gdga ._affc =_fgdf ;_fgdf +=0.5*_cd ;};default:_fgdf =_cgac ._abaf -_gb ;if _cgac ._eeff {_fgdf -=4*_fdd ;}else if _cgac ._adee {_fgdf +=_fdd ;};for _dcc :=len (_cgac ._edcb )-1;_dcc >=0;_dcc --{_cgac ._edcb [_dcc ]._affc =_fgdf ;_fgdf -=_cgac ._edcb [_dcc ]._ddc ;_fgdf -=_cd ;};};};type anchor struct{_cdcd _c .Image ;_eeg *_dd .ChartSpace ;_gcfe int ;_dfcdf int64 ;_ceab int ;_fgbf int64 ;_fbcg int ;_agda int64 ;_gbfg int ;_aaea int64 ;};func (_bg *convertContext )determineMaxIndexes (){var _bbf ,_fde int ;_bbf =int (_bg ._bgef .MaxColumnIdx ());_edd :=_bg ._bgef .Rows ();if len (_edd )> 0{_fde =int (_edd [len (_edd )-1].RowNumber ());};for _ ,_aa :=range _bg ._cabe {if _aa ._fbcg >=_fde {_fde =_aa ._fbcg +1;};if _aa ._gbfg >=_bbf {_bbf =_aa ._gbfg +1;};};_bg ._dbe =_fde ;_bg ._fage =_bbf ;};func (_acgb *convertContext )getStyleFromCell (_eadb _ec .Cell ,_dafc ,_gfc *style )*style {_ggfe :=_eadb .X ();_ffcb :=_acgb .getStyle (_ggfe .SAttr );_gdfc (_ffcb ,_dafc );_gdfc (_ffcb ,_gfc );return _ffcb ;};func _gff (_fcge []*symbol )float64 {_gcag :=0.0;for _ ,_gcac :=range _fcge {_gcag +=_gcac ._dce ;};return _gcag ;};

// ConvertToPdf converts a sheet to a PDF file. This package is beta, breaking changes can take place.
func ConvertToPdf (s *_ec .Sheet )*_ad .Creator {_ca :=s .X ();if _ca ==nil {return nil ;};var _cdd _ad .PageSize ;var _adb bool ;if _cc :=_ca .PageSetup ;_cc !=nil {if _gd :=_cc .PaperSizeAttr ;_gd !=nil {_cdd =_ded [*_gd ];};_adb =_cc .OrientationAttr ==_gg .ST_OrientationLandscape ;};if (_cdd ==_ad .PageSize {}){_cdd =_ded [1];};if _adb {_cdd [0],_cdd [1]=_cdd [1],_cdd [0];};_bd :=_ad .New ();_bd .SetPageSize (_cdd );var _bf ,_dcb ,_ab ,_ag float64 ;if _ef :=_ca .PageMargins ;_ef !=nil {_ab =_ef .LeftAttr ;_ag =_ef .RightAttr ;_bf =_ef .TopAttr ;_dcb =_ef .BottomAttr ;};if _ab < 0.25{_ab =0.25;};if _ag < 0.25{_ag =0.25;};_bf *=_fd .Inch ;_dcb *=_fd .Inch ;_ab *=_fd .Inch ;_ag *=_fd .Inch ;_bd .SetPageMargins (_ab ,_ag ,_bf ,_dcb );_ba :=s .Workbook ();var _ff *_b .Theme ;if len (_ba .Themes ())> 0{_ff =_ba .Themes ()[0];};_ecg :=&convertContext {_aff :_bd ,_bgef :s ,_bbbc :s .Workbook (),_cbf :_ff ,_bfaf :&s .Workbook ().StyleSheet ,_gbce :_bf ,_bcfe :_ab ,_gcae :_cdd [1]-_dcb -_bf ,_eeag :_cdd [0]-_ag -_ab };_ecg .makeAnchors ();_ecg .determineMaxIndexes ();if _ecg ._dbe ==0&&_ecg ._fage ==0{_bd .NewPage ();return _bd ;};_ecg .makeCols ();_ecg .makeRows ();_ecg .makeMergedCells ();_ecg .makeCells ();_ecg .makePagespans ();_ecg .makeRowspans ();_ecg .makePages ();_ecg .fillPages ();_ecg .distributeAnchors ();_ecg .drawSheet ();return _bd ;};func (_acc *convertContext )makeRowspans (){var _bed float64 ;_bcaf :=0;for _ege ,_bge :=range _acc ._fagg {_cfd :=_bge ._agga +_bge ._eee ;if _bed +_cfd <=_acc ._gcae {_bge ._ccgf =_bed ;_bed +=_cfd ;}else {_acc ._eefg =append (_acc ._eefg ,&rowspan {_fce :_bed ,_dfd :_bcaf ,_edgb :_ege });_bcaf =_ege ;_bge ._ccgf =0;_bed =_cfd ;};};_acc ._eefg =append (_acc ._eefg ,&rowspan {_fce :_bed ,_dfd :_bcaf ,_edgb :len (_acc ._fagg )});};func _gcf (_bcbd *symbol ){_fffa :=_ad .New ();_efb :=_fffa .NewStyledParagraph ();_efb .SetMargins (0,0,0,0);_afd :=_efb .Append (_bcbd ._bgfa );if _bcbd ._dba !=nil {_afd .Style =*_bcbd ._dba ;};_bcbd ._gcaf =_efb .Height ();if _bcbd ._dce ==0{_bcbd ._dce =_efb .Width ();};};func (_ged *convertContext )makePages (){for _ ,_dbc :=range _ged ._gcb {for _ ,_ebbc :=range _ged ._eefg {_dbc ._dafd =append (_dbc ._dafd ,&page {_gaea :[]*pageRow {},_dbeg :_dbc ,_bcadb :_ebbc });};};};const _eb =0.25;var _ccfc =[]string {"\u0030\u0030\u0030\u0030\u0030\u0030","\u0066\u0066\u0066\u0066\u0066\u0066","\u0066\u0066\u0030\u0030\u0030\u0030","\u0030\u0030\u0066\u0066\u0030\u0030","\u0030\u0030\u0030\u0030\u0066\u0066","\u0066\u0066\u0066\u0066\u0030\u0030","\u0066\u0066\u0030\u0030\u0066\u0066","\u0030\u0030\u0066\u0066\u0066\u0066","\u0030\u0030\u0030\u0030\u0030\u0030","\u0066\u0066\u0066\u0066\u0066\u0066","\u0066\u0066\u0030\u0030\u0030\u0030","\u0030\u0030\u0066\u0066\u0030\u0030","\u0030\u0030\u0030\u0030\u0066\u0066","\u0066\u0066\u0066\u0066\u0030\u0030","\u0066\u0066\u0030\u0030\u0066\u0066","\u0030\u0030\u0066\u0066\u0066\u0066","\u0038\u0030\u0030\u0030\u0030\u0030","\u0030\u0030\u0038\u0030\u0030\u0030","\u0030\u0030\u0030\u0030\u0038\u0030","\u0038\u0030\u0038\u0030\u0030\u0030","\u0038\u0030\u0030\u0030\u0038\u0030","\u0030\u0030\u0038\u0030\u0038\u0030","\u0063\u0030\u0063\u0030\u0063\u0030","\u0038\u0030\u0038\u0030\u0038\u0030","\u0039\u0039\u0039\u0039\u0066\u0066","\u0039\u0039\u0033\u0033\u0036\u0036","\u0066\u0066\u0066\u0066\u0063\u0063","\u0063\u0063\u0066\u0066\u0066\u0066","\u0036\u0036\u0030\u0030\u0036\u0036","\u0066\u0066\u0038\u0030\u0038\u0030","\u0030\u0030\u0036\u0036\u0063\u0063","\u0063\u0063\u0063\u0063\u0066\u0066","\u0030\u0030\u0030\u0030\u0038\u0030","\u0066\u0066\u0030\u0030\u0066\u0066","\u0066\u0066\u0066\u0066\u0030\u0030","\u0030\u0030\u0066\u0066\u0066\u0066","\u0038\u0030\u0030\u0030\u0038\u0030","\u0038\u0030\u0030\u0030\u0030\u0030","\u0030\u0030\u0038\u0030\u0038\u0030","\u0030\u0030\u0030\u0030\u0066\u0066","\u0030\u0030\u0063\u0063\u0066\u0066","\u0063\u0063\u0066\u0066\u0066\u0066","\u0063\u0063\u0066\u0066\u0063\u0063","\u0066\u0066\u0066\u0066\u0039\u0039","\u0039\u0039\u0063\u0063\u0066\u0066","\u0066\u0066\u0039\u0039\u0063\u0063","\u0063\u0063\u0039\u0039\u0066\u0066","\u0066\u0066\u0063\u0063\u0039\u0039","\u0033\u0033\u0036\u0036\u0066\u0066","\u0033\u0033\u0063\u0063\u0063\u0063","\u0039\u0039\u0063\u0063\u0030\u0030","\u0066\u0066\u0063\u0063\u0030\u0030","\u0066\u0066\u0039\u0039\u0030\u0030","\u0066\u0066\u0036\u0036\u0030\u0030","\u0036\u0036\u0036\u0036\u0039\u0039","\u0039\u0036\u0039\u0036\u0039\u0036","\u0030\u0030\u0033\u0033\u0036\u0036","\u0033\u0033\u0039\u0039\u0036\u0036","\u0030\u0030\u0033\u0033\u0030\u0030","\u0033\u0033\u0033\u0033\u0030\u0030","\u0039\u0039\u0033\u0033\u0030\u0030","\u0039\u0039\u0033\u0033\u0036\u0036","\u0033\u0033\u0033\u0033\u0039\u0039","\u0033\u0033\u0033\u0033\u0033\u0033"};const _fdd =1.5;const _gb =2;

// RegisterFontsFromDirectory registers all fonts from the given directory automatically detecting font families and styles.
func RegisterFontsFromDirectory (dirName string )error {return _add .RegisterFontsFromDirectory (dirName );};type pagespan struct{_bfbgf float64 ;_dafd []*page ;_bage int ;_cfg int ;};var _ga =3.025/_bfg (1);type symbol struct{_bgfa string ;_eagg float64 ;_gcaf float64 ;_dce float64 ;_dba *_ad .TextStyle ;_efa string ;};

// FontStyle represents a kind of font styling. It can be FontStyle_Regular, FontStyle_Bold, FontStyle_Italic and FontStyle_BoldItalic.
type FontStyle =_add .FontStyle ;

// RegisterFont makes a PdfFont accessible for using in converting to PDF.
func RegisterFont (name string ,style FontStyle ,font *_fb .PdfFont ){_add .RegisterFont (name ,style ,font );};const _dc =0.64;func (_ggd *convertContext )makeCols (){_bfb :=_ggd ._bgef ;_ggf :=_bfb .X ();_ceg :=[]*colInfo {};_fdeg :=[]colWidthRange {};if _eg :=_ggf .Cols ;len (_eg )> 0{for _ ,_cca :=range _eg [0].Col {_agf :=65.0;if _aca :=_cca .WidthAttr ;_aca !=nil {if *_aca > 0.83{*_aca -=0.83;};if *_aca <=1{_agf =*_aca *11;}else {_agf =5+*_aca *6;};};_cag :=int (_cca .MinAttr -1);_bfd :=int (_cca .MaxAttr -1);_fdeg =append (_fdeg ,colWidthRange {_gbfd :_cag ,_baa :_bfd ,_bdcc :_agf ,_fac :_ggd .getStyle (_cca .StyleAttr )});};};_cddc :=0;for _gbe :=0;_gbe <=_ggd ._fage ;_gbe ++{var _gda float64 ;var _aeb *style ;if _cddc >=len (_fdeg ){_gda =65;}else {_egf :=_fdeg [_cddc ];if _gbe >=_egf ._gbfd &&_gbe <=_egf ._baa {_gda =_egf ._bdcc ;_aeb =_egf ._fac ;if _gbe ==_egf ._baa {_cddc ++;};}else {_gda =65;};};_ceg =append (_ceg ,&colInfo {_aab :_gda ,_fbea :_aeb });};_ggd ._bbga =_ceg ;};type pageRow struct{_agef int ;_aafe []*cell ;};var _cd =_bfg (1);func (_bbb *convertContext )makeMergedCells (){_gde :=[]*mergedCell {};for _ ,_dag :=range _bbb ._bgef .MergedCells (){_eea ,_ecc ,_dagb :=_e .ParseRangeReference (_dag .Reference ());if _dagb !=nil {_f .Println ("\u0065r\u0072\u006f\u0072\u0020p\u0061\u0072\u0073\u0069\u006eg\u0020m\u0065r\u0067\u0065\u0064\u0020\u0063\u0065\u006cl",_dagb );continue ;};_bde :=mergedCell {_egg :_eea .RowIdx ,_bagc :_eea .ColumnIdx ,_gcfg :_ecc .RowIdx ,_gede :_ecc .ColumnIdx };for _gdad :=_bde ._bagc -1;_gdad < _bde ._gede ;_gdad ++{_bde ._fegb +=_bbb ._bbga [_gdad ]._aab ;};for _ceag :=_bde ._egg -1;_ceag < _bde ._gcfg ;_ceag ++{_bde ._cdcgg +=_bbb ._fagg [_ceag ]._agga ;};_gde =append (_gde ,&_bde );};_bbb ._ebf =_gde ;};func (_fff *convertContext )makeCells (){_addg :=_fff ._bgef ;_cfc :=_addg .Rows ();_efc :=0;for _ ,_ecb :=range _fff ._fagg {_ecb ._gebd =[]*cell {};_gca :=0.0;_fg :=_ecb ._dbf ;if _ecb ._deb {_fef :=_cfc [_efc ];_efc ++;_edde :=_ecb ._agga ;for _ ,_bfa :=range _fef .Cells (){_adf ,_dagf :=_e .ParseCellReference (_bfa .Reference ());if _dagf !=nil {_f .Println (_dagf );continue ;};_dca :=_fff ._bbga [_adf .ColumnIdx ];_db :=_dca ._aab ;_gef :=_db ;_bff :=_dca ._fbea ;var _ffff ,_cfa ,_gdfa ,_abb bool ;for _ ,_be :=range _fff ._ebf {if _adf .RowIdx >=_be ._egg &&_adf .RowIdx <=_be ._gcfg &&_adf .ColumnIdx >=_be ._bagc &&_adf .ColumnIdx <=_be ._gede {if _adf .ColumnIdx ==_be ._bagc &&_adf .RowIdx ==_be ._egg {_db =_be ._fegb ;_edde =_be ._cdcgg ;};_ffff =_adf .RowIdx !=_be ._egg ;_cfa =_adf .RowIdx !=_be ._gcfg ;_gdfa =_adf .ColumnIdx !=_be ._bagc ;_abb =_adf .ColumnIdx !=_be ._gede ;};};_fbb :=_fff .getStyleFromCell (_bfa ,_fg ,_bff );var _bag ,_ffa ,_fc bool ;var _cddb ,_fag ,_afg ,_bac *border ;var _ea _gg .ST_VerticalAlignment ;var _gbb _gg .ST_HorizontalAlignment ;if _fbb !=nil {if !_ffff {_cddb =_fbb ._cfe ;};if !_cfa {_fag =_fbb ._dga ;};if !_gdfa {_afg =_fbb ._cae ;};if !_abb {_bac =_fbb ._gcg ;};if _fag !=nil &&_fag ._cgfd > _gca {_gca =_fag ._cgfd ;};_ea =_fbb ._dgaf ;_gbb =_fbb ._dcg ;if _fbb ._fagd !=nil {_bag =*_fbb ._fagd ;};if _fbb ._beb !=nil {_ffa =*_fbb ._beb ;};_fc =_fbb ._ccc ;};_dee ,_ebc :=_fff .getContentFromCell (_bfa ,_fbb ,_db ,_fc );_bce :=&cell {_fbgcd :_ebc ,_aage :_db ,_cff :_gef ,_abaf :_edde ,_edcb :_dee ,_ddg :_cddb ,_aga :_fag ,_efdd :_afg ,_ccdd :_bac ,_eeff :_bag ,_adee :_ffa };_fff .alignSymbolsHorizontally (_bce ,_gbb );_fff .alignSymbolsVertically (_bce ,_ea );_ecb ._gebd =append (_ecb ._gebd ,_bce );};};_ecb ._eee =_gca ;};};func (_abed *convertContext )alignSymbolsHorizontally (_bdc *cell ,_eag _gg .ST_HorizontalAlignment ){if _eag ==_gg .ST_HorizontalAlignmentUnset {switch _bdc ._fbgcd {case _gg .ST_CellTypeB :_eag =_gg .ST_HorizontalAlignmentCenter ;case _gg .ST_CellTypeN :_eag =_gg .ST_HorizontalAlignmentRight ;default:_eag =_gg .ST_HorizontalAlignmentLeft ;};};var _gbfe float64 ;for _ ,_dbcb :=range _bdc ._edcb {switch _eag {case _gg .ST_HorizontalAlignmentLeft :_gbfe =_fa ;case _gg .ST_HorizontalAlignmentRight :_fga :=_gff (_dbcb ._aaec );_gbfe =_bdc ._aage -_fa -_fga ;case _gg .ST_HorizontalAlignmentCenter :_fcb :=_gff (_dbcb ._aaec );_gbfe =(_bdc ._aage -_fcb )/2;};for _ ,_fea :=range _dbcb ._aaec {_fea ._eagg +=_gbfe ;};};};type colWidthRange struct{_gbfd int ;_baa int ;_bdcc float64 ;_fac *style ;};type style struct{_agfd *string ;_ebdg *float64 ;_efe *string ;_egabb *bool ;_eabd *bool ;_bfde *bool ;_fagd *bool ;_beb *bool ;_cfe *border ;_dga *border ;_cae *border ;_gcg *border ;_ccc bool ;_dgaf _gg .ST_VerticalAlignment ;_dcg _gg .ST_HorizontalAlignment ;};type line struct{_affc float64 ;_aaec []*symbol ;_ddc float64 ;};func (_fafb *convertContext )getColorFromTheme (_bee uint32 )string {_fefd :=_fafb ._bbbc .Themes ();if len (_fefd )!=0{_bdaa :=_fefd [0];if _cbcg :=_bdaa .ThemeElements ;_cbcg !=nil {if _fgfa :=_cbcg .ClrScheme ;_fgfa !=nil {switch _bee {case 0:return _add .GetColorStringFromDmlColor (_fgfa .Lt1 );case 1:return _add .GetColorStringFromDmlColor (_fgfa .Dk1 );case 2:return _add .GetColorStringFromDmlColor (_fgfa .Lt2 );case 3:return _add .GetColorStringFromDmlColor (_fgfa .Dk2 );case 4:return _add .GetColorStringFromDmlColor (_fgfa .Accent1 );case 5:return _add .GetColorStringFromDmlColor (_fgfa .Accent2 );case 6:return _add .GetColorStringFromDmlColor (_fgfa .Accent3 );case 7:return _add .GetColorStringFromDmlColor (_fgfa .Accent4 );case 8:return _add .GetColorStringFromDmlColor (_fgfa .Accent5 );case 9:return _add .GetColorStringFromDmlColor (_fgfa .Accent6 );};};};};return "";};func (_gagbc *convertContext )combineCellStyleWithRPrElt (_caag *style ,_dcgb *_gg .CT_RPrElt )*style {_ebee :=*_caag ;_fbeg :=_gagbc .getStyleFromRPrElt (_dcgb );if _fbeg ==nil {return &_ebee ;};if _fbeg ._agfd !=nil {_ebee ._agfd =_fbeg ._agfd ;};if _fbeg ._ebdg !=nil {_ebee ._ebdg =_fbeg ._ebdg ;};if _fbeg ._efe !=nil {_ebee ._efe =_fbeg ._efe ;};if _fbeg ._egabb !=nil {_ebee ._egabb =_fbeg ._egabb ;};if _fbeg ._eabd !=nil {_ebee ._eabd =_fbeg ._eabd ;};if _fbeg ._bfde !=nil {_ebee ._bfde =_fbeg ._bfde ;};if _fbeg ._fagd !=nil {_ebee ._fagd =_fbeg ._fagd ;};if _fbeg ._beb !=nil {_ebee ._beb =_fbeg ._beb ;};return &_ebee ;};func (_feg *convertContext )getContentFromCell (_gaaf _ec .Cell ,_dac *style ,_cbac float64 ,_bbbg bool )([]*line ,_gg .ST_CellType ){_gafa :=_gaaf .X ();var _fbfa []*symbol ;switch _gafa .TAttr {case _gg .ST_CellTypeS :_ccbe :=_gafa .V ;if _ccbe !=nil {_fgfe ,_ffc :=_a .Atoi (*_ccbe );if _ffc ==nil {_begc :=_feg ._bbbc .SharedStrings .X ().Si [_fgfe ];if _begc .T !=nil {_fbfa =_feg .getSymbolsFromString (*_begc .T ,_dac );}else if _begc .R !=nil {_fbfa =_feg .getSymbolsFromR (_begc .R ,_dac );};};};case _gg .ST_CellTypeB :_fdea :=_gafa .V ;if _fdea !=nil {if *_fdea =="\u0030"{_fbfa =_feg .getSymbolsFromString ("\u0046\u0041\u004cS\u0045",_dac );}else {_fbfa =_feg .getSymbolsFromString ("\u0054\u0052\u0055\u0045",_dac );};};default:_fbfa =_feg .getSymbolsFromString (_gaaf .GetFormattedValue (),_dac );};_bbfc :=0.0;_efce :=0.0;var _gdg []*line ;var _ede bool ;if _dac !=nil {if _dac ._fagd !=nil {if *_dac ._fagd {_ede =true ;};};if _dac ._beb !=nil {if *_dac ._beb {_ede =true ;};};};if _bbbg {_gdg =[]*line {};_dade :=_cbac -2*_fa ;_faa :=[]*symbol {};for _ ,_gcab :=range _fbfa {_gcf (_gcab );if _bbfc +_gcab ._dce >=_dade {_cagf :=_fgb (_faa );if _ede {_cagf /=_dc ;};_gdg =append (_gdg ,&line {_affc :_efce ,_aaec :_faa ,_ddc :_cagf });_faa =[]*symbol {_gcab };_bbfc =_gcab ._dce ;_efce +=_cagf ;}else {_gcab ._eagg =_bbfc ;_bbfc +=_gcab ._dce ;_faa =append (_faa ,_gcab );};};_ggbc :=_fgb (_faa );if _ede {_ggbc /=_dc ;};if len (_faa )> 0{_gdg =append (_gdg ,&line {_affc :_efce ,_aaec :_faa ,_ddc :_ggbc });};}else {for _ ,_eabe :=range _fbfa {_gcf (_eabe );_eabe ._eagg =_bbfc ;_bbfc +=_eabe ._dce ;};if len (_fbfa )> 0{_gdg =[]*line {&line {_aaec :_fbfa ,_ddc :_fgb (_fbfa )}};};};_ageb :=_gafa .TAttr ;if _ageb ==_gg .ST_CellTypeUnset {_ageb =_gg .ST_CellTypeN ;};return _gdg ,_ageb ;};type convertContext struct{_aff *_ad .Creator ;_bbbc *_ec .Workbook ;_cbf *_b .Theme ;_bgef *_ec .Sheet ;_bfaf *_ec .StyleSheet ;_dbe int ;_fage int ;_gcb []*pagespan ;_ebeg *page ;_bbga []*colInfo ;_fagg []*rowInfo ;_eefg []*rowspan ;_gbce float64 ;_bcfe float64 ;_gcae float64 ;_eeag float64 ;_ebf []*mergedCell ;_cabe []*anchor ;};type rowInfo struct{_ccgf float64 ;_deb bool ;_agga float64 ;_dbf *style ;_gebd []*cell ;_eee float64 ;};func (_abg *convertContext )distributeAnchors (){for _ ,_edf :=range _abg ._cabe {_bcg ,_dfac :=_edf ._gcfe ,_edf ._dfcdf ;_bfbg ,_ffb :=_edf ._ceab ,_edf ._fgbf ;_bgf ,_fcg :=_edf ._fbcg ,_edf ._agda ;_bae ,_cfb :=_edf ._gbfg ,_edf ._aaea ;var _daf ,_daa ,_cdc ,_fge *page ;for _ ,_def :=range _abg ._gcb {for _ ,_ccf :=range _def ._dafd {if _bcg >=_ccf ._bcadb ._dfd &&_bcg < _ccf ._bcadb ._edgb {if _bfbg >=_ccf ._dbeg ._bage &&_bfbg < _ccf ._dbeg ._cfg {_ccf ._ffbd =true ;_daf =_ccf ;};if _bae >=_ccf ._dbeg ._bage &&_bae < _ccf ._dbeg ._cfg {_ccf ._ffbd =true ;_daa =_ccf ;};};if _bgf >=_ccf ._bcadb ._dfd &&_bgf < _ccf ._bcadb ._edgb {if _bfbg >=_ccf ._dbeg ._bage &&_bfbg < _ccf ._dbeg ._cfg {_ccf ._ffbd =true ;_fge =_ccf ;};if _bae >=_ccf ._dbeg ._bage &&_bae < _ccf ._dbeg ._cfg {_ccf ._ffbd =true ;_cdc =_ccf ;};};};};_abff :=_daf !=_daa ;_bcad :=_daf !=_fge ;if _abff &&_bcad {_ecgf :=_abg ._bbga [_bfbg ]._dfdb +_fd .FromEMU (_ffb );_bffc :=_daf ._dbeg ._bfbgf ;_fbg :=_abg ._bbga [_bae ]._dfdb +_fd .FromEMU (_cfb );_dbg :=_abg ._fagg [_bcg ]._ccgf +_fd .FromEMU (_dfac );_bbg :=float64 (_daf ._bcadb ._fce );_fgc :=_abg ._fagg [_bgf ]._ccgf +_fd .FromEMU (_fcg );_aed :=_fbg +_bffc -_ecgf ;_gcd :=_fgc +_bbg -_dbg ;_cge :=_abg .imageFromAnchor (_edf ,_aed ,_gcd );_daf ._eeac =append (_daf ._eeac ,_abg .getImage (_cge ,_gcd ,_aed ,_ecgf ,_dbg ,_bffc -_ecgf ,_bbg -_dbg ,_add .ImgPart_lt ));_daa ._eeac =append (_daa ._eeac ,_abg .getImage (_cge ,_gcd ,_aed ,0,_dbg ,_bffc -_ecgf ,_bbg -_dbg ,_add .ImgPart_rt ));_fge ._eeac =append (_fge ._eeac ,_abg .getImage (_cge ,_gcd ,_aed ,_ecgf ,0,_bffc -_ecgf ,_bbg -_dbg ,_add .ImgPart_lb ));_cdc ._eeac =append (_cdc ._eeac ,_abg .getImage (_cge ,_gcd ,_aed ,0,0,_bffc -_ecgf ,_bbg -_dbg ,_add .ImgPart_rb ));}else if _abff {_beg :=_abg ._fagg [_bcg ]._ccgf +_fd .FromEMU (_dfac );_ade :=_abg ._fagg [_bgf ]._ccgf +_fd .FromEMU (_fcg );_fdb :=_abg ._bbga [_bfbg ]._dfdb +_fd .FromEMU (_ffb );_bea :=_daf ._dbeg ._bfbgf ;_fefg :=_abg ._bbga [_bae ]._dfdb +_fd .FromEMU (_cfb );_geda :=_fefg +_bea -_fdb ;_agg :=_ade -_beg ;_dbcf :=_abg .imageFromAnchor (_edf ,_geda ,_agg );_daf ._eeac =append (_daf ._eeac ,_abg .getImage (_dbcf ,_agg ,_geda ,_fdb ,_beg ,_bea -_fdb ,0,_add .ImgPart_l ));_daa ._eeac =append (_daa ._eeac ,_abg .getImage (_dbcf ,_agg ,_geda ,0,_beg ,_bea -_fdb ,0,_add .ImgPart_r ));}else if _bcad {_fda :=_abg ._bbga [_bfbg ]._dfdb +_fd .FromEMU (_ffb );_cbb :=_abg ._bbga [_bae ]._dfdb +_fd .FromEMU (_cfb );_gdb :=_abg ._fagg [_bcg ]._ccgf +_fd .FromEMU (_dfac );_geg :=float64 (_daf ._bcadb ._fce );_ddd :=_abg ._fagg [_bgf ]._ccgf +_fd .FromEMU (_fcg );_cce :=_cbb -_fda ;_gafb :=_ddd +_geg -_gdb ;_fab :=_abg .imageFromAnchor (_edf ,_cce ,_gafb );_daf ._eeac =append (_daf ._eeac ,_abg .getImage (_fab ,_gafb ,_cce ,_fda ,_gdb ,0,_geg -_gdb ,_add .ImgPart_t ));_fge ._eeac =append (_fge ._eeac ,_abg .getImage (_fab ,_gafb ,_cce ,_fda ,0,0,_geg -_gdb ,_add .ImgPart_b ));}else {_age :=_abg ._bbga [_bfbg ]._dfdb +_fd .FromEMU (_ffb );_dge :=_abg ._bbga [_bae ]._dfdb +_fd .FromEMU (_cfb );_dfad :=_abg ._fagg [_bcg ]._ccgf +_fd .FromEMU (_dfac );_dfcd :=_abg ._fagg [_bgf ]._ccgf +_fd .FromEMU (_fcg );_cde :=_dge -_age ;_dgf :=_dfcd -_dfad ;_dage :=_abg .imageFromAnchor (_edf ,_cde ,_dgf );_daf ._eeac =append (_daf ._eeac ,_abg .getImage (_dage ,_dgf ,_cde ,_age ,_dfad ,0,0,_add .ImgPart_whole ));};};};func _bcd (_afgc *bool )bool {return _afgc !=nil &&*_afgc };func (_ebg *convertContext )getStyle (_cbed *uint32 )*style {_cabg :=&style {};_fcgg :=false ;if _cbed !=nil {_gddc :=_ebg ._bfaf .GetCellStyle (*_cbed );_gbed :=_gddc .GetFont ();for _ ,_cgd :=range _gbed .Name {if _cgd !=nil {_cabg ._efe =&_cgd .ValAttr ;_fcgg =true ;break ;};};for _ ,_ffbdf :=range _gbed .B {if _ffbdf !=nil {_fbdfg :=_ffbdf .ValAttr ==nil ||*_ffbdf .ValAttr ;_cabg ._egabb =&_fbdfg ;_fcgg =true ;break ;};};for _ ,_gcbf :=range _gbed .I {if _gcbf !=nil {_ebag :=_gcbf .ValAttr ==nil ||*_gcbf .ValAttr ;_cabg ._eabd =&_ebag ;_fcgg =true ;break ;};};for _ ,_begb :=range _gbed .U {if _begb !=nil {_fcgf :=_begb .ValAttr ==_gg .ST_UnderlineValuesSingle ||_begb .ValAttr ==_gg .ST_UnderlineValuesUnset ;_cabg ._bfde =&_fcgf ;_fcgg =true ;break ;};};for _ ,_fcae :=range _gbed .Sz {if _fcae !=nil {_cgg :=_fcae .ValAttr /12*_add .DefaultFontSize ;_cabg ._ebdg =&_cgg ;_fcgg =true ;break ;};};for _ ,_caa :=range _gbed .VertAlign {if _caa !=nil {_aafd :=_caa .ValAttr ==_g .ST_VerticalAlignRunSuperscript ;_cabg ._fagd =&_aafd ;_dfcg :=_caa .ValAttr ==_g .ST_VerticalAlignRunSubscript ;_cabg ._beb =&_dfcg ;_fcgg =true ;break ;};};for _ ,_gbca :=range _gbed .Color {if _gbca !=nil {_cabg ._agfd =_ebg .getColorStringFromSmlColor (_gbca );_fcgg =true ;break ;};};_acd :=_gddc .GetBorder ();if _acd .Top !=nil {_cabg ._cfe =_ebg .getBorder (_acd .Top );_fcgg =true ;};if _acd .Bottom !=nil {_cabg ._dga =_ebg .getBorder (_acd .Bottom );_fcgg =true ;};if _acd .Left !=nil {_cabg ._cae =_ebg .getBorder (_acd .Left );_fcgg =true ;};if _acd .Right !=nil {_cabg ._gcg =_ebg .getBorder (_acd .Right );_fcgg =true ;};if _gddc .Wrapped (){_cabg ._ccc =true ;_fcgg =true ;};if _cdg :=_gddc .GetVerticalAlignment ();_cdg !=_gg .ST_VerticalAlignmentUnset {_cabg ._dgaf =_cdg ;_fcgg =true ;};if _ebga :=_gddc .GetHorizontalAlignment ();_ebga !=_gg .ST_HorizontalAlignmentUnset {_cabg ._dcg =_ebga ;_fcgg =true ;};};if _fcgg {return _cabg ;};return nil ;};type rowspan struct{_fce float64 ;_dfd int ;_edgb int ;};const (FontStyle_Regular FontStyle =0;FontStyle_Bold FontStyle =1;FontStyle_Italic FontStyle =2;FontStyle_BoldItalic FontStyle =3;);var _ded =map[uint32 ]_ad .PageSize {1:_ad .PageSize {8.5*_fd .Inch ,11*_fd .Inch },2:_ad .PageSize {8.5*_fd .Inch ,11*_fd .Inch },3:_ad .PageSize {11*_fd .Inch ,17*_fd .Inch },4:_ad .PageSize {17*_fd .Inch ,11*_fd .Inch },5:_ad .PageSize {8.5*_fd .Inch ,14*_fd .Inch },6:_ad .PageSize {5.5*_fd .Inch ,8.5*_fd .Inch },7:_ad .PageSize {7.5*_fd .Inch ,10*_fd .Inch },8:_ad .PageSize {_bfg (297),_bfg (420)},9:_ad .PageSize {_bfg (210),_bfg (297)},10:_ad .PageSize {_bfg (210),_bfg (297)},11:_ad .PageSize {_bfg (148),_bfg (210)},70:_ad .PageSize {_bfg (105),_bfg (148)},12:_ad .PageSize {_bfg (250),_bfg (354)},13:_ad .PageSize {_bfg (182),_bfg (257)},14:_ad .PageSize {8.5*_fd .Inch ,13*_fd .Inch },20:_ad .PageSize {4.125*_fd .Inch ,9.5*_fd .Inch },27:_ad .PageSize {_bfg (110),_bfg (220)},28:_ad .PageSize {_bfg (162),_bfg (229)},34:_ad .PageSize {_bfg (250),_bfg (176)},29:_ad .PageSize {_bfg (324),_bfg (458)},30:_ad .PageSize {_bfg (229),_bfg (324)},31:_ad .PageSize {_bfg (114),_bfg (162)},37:_ad .PageSize {3.88*_fd .Inch ,7.5*_fd .Inch },43:_ad .PageSize {_bfg (100),_bfg (148)},69:_ad .PageSize {_bfg (200),_bfg (148)}};func (_eaf *convertContext )getSymbolsFromString (_aae string ,_gfg *style )[]*symbol {_dfb :=[]*symbol {};_gbf :=_eaf .makeTextStyleFromCellStyle (_gfg );for _ ,_ebed :=range _aae {_dfb =append (_dfb ,&symbol {_bgfa :string (_ebed ),_dba :_gbf });};return _dfb ;};func (_abd *convertContext )addRowToPage (_daae []*cell ,_cafb int ){_fgf :=0.0;_fbdf :=_abd ._eeag ;for _ ,_edcf :=range _daae {if len (_edcf ._edcb )!=0{_edcf ._aac =_fgf ;_fgf =_edcf ._daaed +_edcf ._aage ;};};for _gbg :=len (_daae )-1;_gbg >=0;_gbg --{_gbc :=_daae [_gbg ];if len (_gbc ._edcb )!=0{_gbc ._dcdc =_fbdf ;_fbdf =_gbc ._daaed ;};};_abd ._ebeg ._gaea =append (_abd ._ebeg ._gaea ,&pageRow {_agef :_cafb ,_aafe :_daae });};type colInfo struct{_dfdb float64 ;_aab float64 ;_fbea *style ;};func (_efcb *convertContext )getColorStringFromSmlColor (_ccba *_gg .CT_Color )*string {var _aedf string ;if _ccba .RgbAttr !=nil {_aedf =*_ccba .RgbAttr ;}else if _ccba .IndexedAttr !=nil &&*_ccba .IndexedAttr < 64{_aedf =_ccfc [*_ccba .IndexedAttr ];}else if _ccba .ThemeAttr !=nil {_cead :=*_ccba .ThemeAttr ;_aedf =_efcb .getColorFromTheme (_cead );};if _aedf ==""{return nil ;};if len (_aedf )> 6{_aedf =_aedf [(len (_aedf )-6):];};if _ccba .TintAttr !=nil {_dced :=*_ccba .TintAttr ;_aedf =_add .AdjustColorByTint (_aedf ,_dced );};_aedf ="\u0023"+_aedf ;return &_aedf ;};func (_aeea *convertContext )getBorder (_gecg *_gg .CT_BorderPr )*border {_beba :=&border {};switch _gecg .StyleAttr {case _gg .ST_BorderStyleThin :_beba ._cgfd =_ed ;case _gg .ST_BorderStyleMedium :_beba ._cgfd =_ed *2;case _gg .ST_BorderStyleThick :_beba ._cgfd =_ed *4;};if _beba ._cgfd ==0.0{return nil ;};if _addf :=_gecg .Color ;_addf !=nil {_fcaf :=_aeea .getColorStringFromSmlColor (_addf );if _fcaf !=nil {_beba ._edgc =_ad .ColorRGBFromHex (*_fcaf );}else {_beba ._edgc =_ad .ColorBlack ;};};return _beba ;};func (_edg *convertContext )getImage (_fgee _c .Image ,_ecf ,_deeg ,_afee ,_cbgb ,_fada ,_gdd float64 ,_gefe _add .ImgPart )*_ad .Image {_cbgb +=_edg ._gbce ;_afee +=_edg ._bcfe ;_cdb ,_eef :=_add .GetImage (_edg ._aff ,_fgee ,_ecf ,_deeg ,_afee ,_cbgb ,_fada ,_gdd ,_gefe );if _eef !=nil {_f .Println ("C\u0061n\u006e\u006f\u0074\u0020\u0067\u0065\u0074\u0020a\u006e\u0020\u0069\u006dag\u0065\u003a",_eef );return nil ;};return _cdb ;};func (_ead *convertContext )drawSheet (){for _acg ,_egfe :=range _ead ._gcb {_cga :=len (_egfe ._dafd );if _acg ==len (_ead ._gcb )-1{for _aag :=len (_egfe ._dafd )-1;_aag >=0;_aag --{if !_egfe ._dafd [_aag ]._ffbd {_cga =_aag ;};};};_cac :=_egfe ._dafd [:_cga ];for _ ,_dgg :=range _cac {_ead ._aff .NewPage ();_ead .drawPage (_dgg );};};};func (_ced *convertContext )makeRows (){_cbg :=[]*rowInfo {};_aee :=_ced ._bgef .Rows ();_ebd :=0;for _ ,_fdf :=range _aee {_ebd ++;_bca :=int (_fdf .RowNumber ());if _bca > _ebd {for _eed :=_ebd ;_eed < _bca ;_eed ++{_cbg =append (_cbg ,&rowInfo {_agga :16/_ga });};_ebd =_bca ;};var _fee float64 ;if _fdf .X ().HtAttr ==nil {_fee =16;}else {_fee =*_fdf .X ().HtAttr ;};_cbg =append (_cbg ,&rowInfo {_agga :_fee /_ga ,_deb :true ,_dbf :_ced .getStyle (_fdf .X ().SAttr )});};for _fed :=len (_cbg );_fed < _ced ._dbe ;_fed ++{_cbg =append (_cbg ,&rowInfo {_agga :16/_ga });};_ced ._fagg =_cbg ;};func _fgb (_gbga []*symbol )float64 {_bbe :=0.0;for _ ,_eaa :=range _gbga {if _eaa ._gcaf > _bbe {_bbe =_eaa ._gcaf ;};};return _bbe ;};var _ed =_bfg (0.0625);func _bfg (_acbb float64 )float64 {return _acbb *_fd .Millimeter };func (_dbgd *convertContext )drawPage (_eeaa *page ){_cbe :=_dbgd ._gbce ;_baf :=_dbgd ._bcfe ;for _ ,_fad :=range _eeaa ._gaea {_fbe :=_dbgd ._fagg [_fad ._agef ];for _ ,_deg :=range _fad ._aafe {_aggd :=_deg ._aac < _deg ._daaed ;_abc :=_deg ._dcdc > _deg ._daaed +_deg ._aage ;var _dea ,_bcba bool ;for _ ,_cddcd :=range _deg ._edcb {for _ ,_aggf :=range _cddcd ._aaec {if _aggd &&!_dea {_dea =_aggf ._eagg < 0;};if _abc &&!_bcba {_bcba =_deg ._aage < _aggf ._eagg +_aggf ._dce ;};if _deg ._daaed +_aggf ._eagg >=_deg ._aac &&_deg ._daaed +_aggf ._eagg +_aggf ._dce <=_deg ._dcdc {_fgd :=_dbgd ._aff .NewStyledParagraph ();_fbdc :=_baf +_deg ._daaed +_aggf ._eagg ;_defa :=_cbe +_fbe ._ccgf +_cddcd ._affc -_aggf ._gcaf -_bfg (0.5);_fgd .SetPos (_fbdc ,_defa );var _bedf *_ad .TextChunk ;if _aggf ._efa !=""{_bedf =_fgd .AddExternalLink (_aggf ._bgfa ,_aggf ._efa );}else {_bedf =_fgd .Append (_aggf ._bgfa );};if _aggf ._dba !=nil {_bedf .Style =*_aggf ._dba ;};_dbgd ._aff .Draw (_fgd );};};};var _cgf ,_fbc ,_dfaf ,_deab ,_gag ,_fffg float64 ;var _feeb ,_ccb ,_fbgc ,_ccgd _ad .Color ;if _gbee :=_deg ._ddg ;_gbee !=nil {_cgf =_gbee ._cgfd ;_feeb =_gbee ._edgc ;};if _geb :=_deg ._aga ;_geb !=nil {_fbc =_geb ._cgfd ;_ccb =_geb ._edgc ;};if _eab :=_deg ._efdd ;_eab !=nil {_dfaf =_eab ._cgfd ;_gag =_dfaf /2;_fbgc =_eab ._edgc ;};if _gedae :=_deg ._ccdd ;_gedae !=nil {_deab =_gedae ._cgfd ;_fffg =_deab /2;_ccgd =_gedae ._edgc ;};var _ega float64 ;if _fad ._agef > 1{_ega =_dbgd ._fagg [_fad ._agef -1]._eee ;};_eabg :=_cbe +_fbe ._ccgf -0.5*(_ega -_cgf );_gbba :=_cbe +_fbe ._ccgf +_fbe ._agga +0.5*(_fbe ._eee +_fbc );_cegb :=_baf +_deg ._daaed ;_gdc :=_cegb +_deg ._cff ;_add .DrawLine (_dbgd ._aff ,_cegb ,_eabg ,_gdc ,_eabg ,_cgf ,_feeb );_add .DrawLine (_dbgd ._aff ,_cegb ,_gbba ,_gdc ,_gbba ,_fbc ,_ccb );if !_dea {_add .DrawLine (_dbgd ._aff ,_cegb -_gag ,_eabg ,_cegb -_gag ,_gbba ,_dfaf ,_fbgc );};if !_bcba {_add .DrawLine (_dbgd ._aff ,_gdc -_fffg ,_eabg ,_gdc -_fffg ,_gbba ,_deab ,_ccgd );};};};for _ ,_gfd :=range _eeaa ._eeac {if _gfd !=nil {_dbgd ._aff .Draw (_gfd );};};};func (_deeef *convertContext )makeTextStyleFromCellStyle (_baab *style )*_ad .TextStyle {_adba :=_deeef ._aff .NewTextStyle ();if _baab ==nil {_adba .FontSize =_add .DefaultFontSize ;_adba .Font =_add .AssignStdFontByName (_adba ,_add .StdFontsMap ["\u0064e\u0066\u0061\u0075\u006c\u0074"][FontStyle_Regular ]);return &_adba ;};if _bcd (_baab ._bfde ){_adba .Underline =true ;_adba .UnderlineStyle =_ad .TextDecorationLineStyle {Offset :0.5,Thickness :_bfg (1/32)};};var _fca FontStyle ;if _bcd (_baab ._egabb )&&_bcd (_baab ._eabd ){_fca =FontStyle_BoldItalic ;}else if _bcd (_baab ._egabb ){_fca =FontStyle_Bold ;}else if _bcd (_baab ._eabd ){_fca =FontStyle_Italic ;}else {_fca =FontStyle_Regular ;};_agb :="\u0064e\u0066\u0061\u0075\u006c\u0074";if _baab ._efe !=nil {_agb =*_baab ._efe ;};if _dgee ,_affe :=_add .StdFontsMap [_agb ];_affe {_adba .Font =_add .AssignStdFontByName (_adba ,_dgee [_fca ]);}else if _efdf :=_add .GetRegisteredFont (_agb ,_fca );_efdf !=nil {_adba .Font =_efdf ;}else {_f .Printf ("\u0046\u006f\u006e\u0074\u0020\u0025\u0073\u0020\u0077\u0069\u0074\u0068\u0020\u0073\u0074y\u006c\u0065\u0020\u0025\u0073\u0020\u0069\u0073\u0020\u006e\u006f\u0074\u0020f\u006f\u0075\u006e\u0064\u002c\u0020\u0072\u0065\u0073\u0065\u0074\u0020to\u0020\u0064\u0065\u0066\u0061\u0075\u006c\u0074\u002e\u000a",_agb ,_fca );_adba .Font =_add .AssignStdFontByName (_adba ,_add .StdFontsMap ["\u0064e\u0066\u0061\u0075\u006c\u0074"][_fca ]);};if _baab ._ebdg !=nil {_adba .FontSize =*_baab ._ebdg ;};if _baab ._agfd !=nil {_adba .Color =_ad .ColorRGBFromHex (*_baab ._agfd );};if _baab ._fagd !=nil &&*_baab ._fagd {_adba .FontSize *=_dc ;}else if _baab ._beb !=nil &&*_baab ._beb {_adba .FontSize *=_dc ;};return &_adba ;};func (_fedc *convertContext )getStyleFromRPrElt (_dcee *_gg .CT_RPrElt )*style {if _dcee ==nil {return nil ;};_ggg :=&style {};_ggg ._efe =&_dcee .RFont .ValAttr ;if _dged :=_dcee .B ;_dged !=nil {_eac :=_dged .ValAttr ==nil ||*_dged .ValAttr ;_ggg ._egabb =&_eac ;};if _adbb :=_dcee .I ;_adbb !=nil {_baff :=_adbb .ValAttr ==nil ||*_adbb .ValAttr ;_ggg ._eabd =&_baff ;};if _daac :=_dcee .U ;_daac !=nil {_bfc :=_daac .ValAttr ==_gg .ST_UnderlineValuesSingle ||_daac .ValAttr ==_gg .ST_UnderlineValuesUnset ;_ggg ._bfde =&_bfc ;};if _adga :=_dcee .VertAlign ;_adga !=nil {_cccd :=_adga .ValAttr ==_g .ST_VerticalAlignRunSuperscript ;_ggg ._fagd =&_cccd ;_cgfg :=_adga .ValAttr ==_g .ST_VerticalAlignRunSubscript ;_ggg ._beb =&_cgfg ;};if _fadf :=_dcee .Sz ;_fadf !=nil {_ddaf :=_fadf .ValAttr /12*_add .DefaultFontSize ;_ggg ._ebdg =&_ddaf ;};if _bbfd :=_dcee .Color ;_bbfd !=nil {_ggg ._agfd =_fedc .getColorStringFromSmlColor (_bbfd );};return _ggg ;};type cell struct{_fbgcd _gg .ST_CellType ;_ccge int ;_daaed float64 ;_edcb []*line ;_aage float64 ;_cff float64 ;_abaf float64 ;_aac float64 ;_dcdc float64 ;_dgfb *_ad .TextStyle ;_ddg *border ;_aga *border ;_efdd *border ;_ccdd *border ;_eeff bool ;_adee bool ;};type page struct{_gaea []*pageRow ;_ffbd bool ;_eeac []*_ad .Image ;_dbeg *pagespan ;_bcadb *rowspan ;};func (_cg *convertContext )makeAnchors (){_gdf ,_ee :=_cg ._bgef .GetDrawing ();if _gdf !=nil {for _ ,_eba :=range _gdf .EG_Anchor {_fe :=&anchor {};if _fbf :=_eba .TwoCellAnchor ;_fbf !=nil {_agd ,_de :=_fbf .From ,_fbf .To ;if _agd ==nil ||_de ==nil {return ;};_fe ._gcfe =int (_agd .Row );_fe ._dfcdf =_add .FromSTCoordinate (_agd .RowOff );_fe ._ceab =int (_agd .Col );_fe ._fgbf =_add .FromSTCoordinate (_agd .ColOff );_fe ._fbcg =int (_de .Row );_fe ._agda =_add .FromSTCoordinate (_de .RowOff );_fe ._gbfg =int (_de .Col );_fe ._aaea =_add .FromSTCoordinate (_de .ColOff );if _dfa :=_fbf .Choice ;_dfa !=nil {if _ac :=_dfa .Pic ;_ac !=nil {if _ae :=_ac .BlipFill ;_ae !=nil {if _abe :=_ae .Blip ;_abe !=nil {if _dda :=_abe .EmbedAttr ;_dda !=nil {for _ ,_fbd :=range _ee .X ().Relationship {if _fbd .IdAttr ==*_dda {for _ ,_ge :=range _cg ._bbbc .Images {if _ge .Target ()==_fbd .TargetAttr {_af ,_ebb :=_ce .Open (_ge .Path ());if _ebb !=nil {_f .Println ("\u004f\u0070\u0065\u006e i\u006d\u0061\u0067\u0065\u0020\u0066\u0069\u006c\u0065\u0020\u0065\u0072\u0072\u006fr\u003a",_ebb );continue ;};_acb ,_ ,_ebb :=_c .Decode (_af );if _ebb !=nil {_f .Println ("\u0044\u0065\u0063\u006fde\u0020\u0069\u006d\u0061\u0067\u0065\u0020\u0065\u0072\u0072\u006f\u0072\u003a",_ebb );continue ;};_fe ._cdcd =_acb ;};};};};};};};}else if _cb :=_dfa .GraphicFrame ;_cb !=nil {if _gc :=_cb .Graphic ;_gc !=nil {if _caf :=_gc .GraphicData ;_caf !=nil {for _ ,_aea :=range _caf .Any {if _bfe ,_ggc :=_aea .(*_dd .Chart );_ggc {for _ ,_dcd :=range _ee .X ().Relationship {if _dcd .IdAttr ==_bfe .IdAttr {_bb :=_cg ._bbbc .GetChartByTargetId (_dcd .TargetAttr );if _bb !=nil {_fe ._eeg =_bb ;};};};};};};};};};};if _fe ._cdcd !=nil ||_fe ._eeg !=nil {_cg ._cabe =append (_cg ._cabe ,_fe );};};};};func (_gagb *convertContext )getSymbolsFromR (_fgeg []*_gg .CT_RElt ,_bdfb *style )[]*symbol {_fbad :=[]*symbol {};for _ ,_gae :=range _fgeg {_gdbd :=_gagb .combineCellStyleWithRPrElt (_bdfb ,_gae .RPr );for _ ,_ceda :=range _gae .T {_fbad =append (_fbad ,&symbol {_bgfa :string (_ceda ),_dba :_gagb .makeTextStyleFromCellStyle (_gdbd )});};};return _fbad ;};func (_dg *convertContext )fillPages (){for _dfc ,_bcb :=range _dg ._eefg {_dbd :=_dg ._fagg [_bcb ._dfd :_bcb ._edgb ];for _ddb ,_bdf :=range _dbd {_cab :=0;_cbc :=0.0;_aec :=[]*cell {};if _bdf ._deb {for _ ,_fcf :=range _bdf ._gebd {_edc :=_dg ._gcb [_cab ];_dg ._ebeg =_edc ._dafd [_dfc ];_dg ._ebeg ._ffbd =true ;_faf :=_fcf ._cff ;if _cbc +_faf > _edc ._bfbgf {_dg .addRowToPage (_aec ,_ddb );_aec =[]*cell {_fcf };_cbc =_faf ;_cab ++;}else {_fcf ._daaed =_cbc ;_aec =append (_aec ,_fcf );_cbc +=_faf ;};};if len (_aec )> 0{_cba :=_dg ._gcb [_cab ];_dg ._ebeg =_cba ._dafd [_dfc ];_dg ._ebeg ._ffbd =true ;_dg .addRowToPage (_aec ,_ddb );};};};};};const _fa =3;type mergedCell struct{_egg uint32 ;_bagc uint32 ;_gcfg uint32 ;_gede uint32 ;_fegb float64 ;_cdcgg float64 ;};