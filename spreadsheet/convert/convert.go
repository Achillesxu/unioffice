//
// Copyright 2020 FoxyUtils ehf. All rights reserved.
//
// This is a commercial product and requires a license to operate.
// A trial license can be obtained at https://unidoc.io
//
// DO NOT EDIT: generated by unitwist Go source code obfuscator.
//
// Use of this source code is governed by the UniDoc End User License Agreement
// terms that can be accessed at https://unidoc.io/eula/

package convert ;import (_bc "github.com/unidoc/unioffice/common/logger";_dgb "github.com/unidoc/unioffice/common/tempstorage";_bf "github.com/unidoc/unioffice/internal/convertutils";_dg "github.com/unidoc/unioffice/measurement";_f "github.com/unidoc/unioffice/schema/soo/dml";_ge "github.com/unidoc/unioffice/schema/soo/dml/chart";_eg "github.com/unidoc/unioffice/schema/soo/ofc/sharedTypes";_a "github.com/unidoc/unioffice/schema/soo/sml";_be "github.com/unidoc/unioffice/spreadsheet";_cd "github.com/unidoc/unioffice/spreadsheet/reference";_c "github.com/unidoc/unipdf/v3/creator";_e "github.com/unidoc/unipdf/v3/model";_g "image";_d "strconv";);type line struct{_add float64 ;_ebfd []*symbol ;_aga float64 ;};func (_fb *convertContext )determineMaxIndexes (){var _fe ,_df int ;_fe =int (_fb ._dfc .MaxColumnIdx ());_afg :=_fb ._dfc .Rows ();if len (_afg )> 0{_df =int (_afg [len (_afg )-1].RowNumber ());};for _ ,_aee :=range _fb ._gca {if _aee ._aegg >=_df {_df =_aee ._aegg +1;};if _aee ._cdfa >=_fe {_fe =_aee ._cdfa +1;};};_fb ._bege =_df ;_fb ._fae =_fe ;};const _cf =3;

// FontStyle represents a kind of font styling. It can be FontStyle_Regular, FontStyle_Bold, FontStyle_Italic and FontStyle_BoldItalic.
type FontStyle =_bf .FontStyle ;type pagespan struct{_defa float64 ;_dcec []*page ;_dgc int ;_fea int ;};func (_agff *convertContext )getColorFromTheme (_bea uint32 )string {_bcagc :=_agff ._cffg .Themes ();if len (_bcagc )!=0{_dbd :=_bcagc [0];if _fddb :=_dbd .ThemeElements ;_fddb !=nil {if _aecac :=_fddb .ClrScheme ;_aecac !=nil {switch _bea {case 0:return _bf .GetColorStringFromDmlColor (_aecac .Lt1 );case 1:return _bf .GetColorStringFromDmlColor (_aecac .Dk1 );case 2:return _bf .GetColorStringFromDmlColor (_aecac .Lt2 );case 3:return _bf .GetColorStringFromDmlColor (_aecac .Dk2 );case 4:return _bf .GetColorStringFromDmlColor (_aecac .Accent1 );case 5:return _bf .GetColorStringFromDmlColor (_aecac .Accent2 );case 6:return _bf .GetColorStringFromDmlColor (_aecac .Accent3 );case 7:return _bf .GetColorStringFromDmlColor (_aecac .Accent4 );case 8:return _bf .GetColorStringFromDmlColor (_aecac .Accent5 );case 9:return _bf .GetColorStringFromDmlColor (_aecac .Accent6 );};};};};return "";};var _gg =3.025/_eea (1);func (_bcag *convertContext )drawSheet (){for _defb ,_efb :=range _bcag ._eae {_fef :=len (_efb ._dcec );if _defb ==len (_bcag ._eae )-1{for _afae :=len (_efb ._dcec )-1;_afae >=0;_afae --{if !_efb ._dcec [_afae ]._bee {_fef =_afae ;};};};_gfcg :=_efb ._dcec [:_fef ];for _ ,_efab :=range _gfcg {_bcag ._bafg .NewPage ();_bcag .drawPage (_efab );};};};func (_ddba *convertContext )getColorStringFromSmlColor (_daeb *_a .CT_Color )*string {var _acebg string ;if _daeb .RgbAttr !=nil {_acebg =*_daeb .RgbAttr ;}else if _daeb .IndexedAttr !=nil &&*_daeb .IndexedAttr < 64{_acebg =_caea [*_daeb .IndexedAttr ];}else if _daeb .ThemeAttr !=nil {_ece :=*_daeb .ThemeAttr ;_acebg =_ddba .getColorFromTheme (_ece );};if _acebg ==""{return nil ;};if len (_acebg )> 6{_acebg =_acebg [(len (_acebg )-6):];};if _daeb .TintAttr !=nil {_gcbb :=*_daeb .TintAttr ;_acebg =_bf .AdjustColorByTint (_acebg ,_gcbb );};_acebg ="\u0023"+_acebg ;return &_acebg ;};func (_ce *convertContext )makeAnchors (){_ca ,_eaf :=_ce ._dfc .GetDrawing ();if _ca !=nil {for _ ,_bcc :=range _ca .EG_Anchor {_eec :=&anchor {};if _gge :=_bcc .TwoCellAnchor ;_gge !=nil {_fg ,_bg :=_gge .From ,_gge .To ;if _fg ==nil ||_bg ==nil {return ;};_eec ._abgd =int (_fg .Row );_eec ._acfb =_bf .FromSTCoordinate (_fg .RowOff );_eec ._dac =int (_fg .Col );_eec ._dedf =_bf .FromSTCoordinate (_fg .ColOff );_eec ._aegg =int (_bg .Row );_eec ._bfdg =_bf .FromSTCoordinate (_bg .RowOff );_eec ._cdfa =int (_bg .Col );_eec ._cfg =_bf .FromSTCoordinate (_bg .ColOff );if _ace :=_gge .Choice ;_ace !=nil {if _bfg :=_ace .Pic ;_bfg !=nil {if _caa :=_bfg .BlipFill ;_caa !=nil {if _ba :=_caa .Blip ;_ba !=nil {if _cda :=_ba .EmbedAttr ;_cda !=nil {for _ ,_bfe :=range _eaf .X ().Relationship {if _bfe .IdAttr ==*_cda {for _ ,_cc :=range _ce ._cffg .Images {if _cc .Target ()==_bfe .TargetAttr {_de ,_egbf :=_dgb .Open (_cc .Path ());if _egbf !=nil {_bc .Log .Debug ("\u004fp\u0065\u006e\u0020\u0069m\u0061\u0067\u0065\u0020\u0066i\u006ce\u0020e\u0072\u0072\u006f\u0072\u003a\u0020\u0025s",_egbf );continue ;};_ef ,_ ,_egbf :=_g .Decode (_de );if _egbf !=nil {_bc .Log .Debug ("\u0044\u0065\u0063\u006fde\u0020\u0069\u006d\u0061\u0067\u0065\u0020\u0065\u0072\u0072\u006f\u0072\u003a\u0020%\u0073",_egbf );continue ;};_eec ._bfcd =_ef ;};};};};};};};}else if _ff :=_ace .GraphicFrame ;_ff !=nil {if _cdf :=_ff .Graphic ;_cdf !=nil {if _bda :=_cdf .GraphicData ;_bda !=nil {for _ ,_ae :=range _bda .Any {if _bca ,_cg :=_ae .(*_ge .Chart );_cg {for _ ,_ed :=range _eaf .X ().Relationship {if _ed .IdAttr ==_bca .IdAttr {_dec :=_ce ._cffg .GetChartByTargetId (_ed .TargetAttr );if _dec !=nil {_eec ._egfe =_dec ;};};};};};};};};};};if _eec ._bfcd !=nil ||_eec ._egfe !=nil {_ce ._gca =append (_ce ._gca ,_eec );};};};};func (_bfa *convertContext )makePages (){for _ ,_bcg :=range _bfa ._eae {for _ ,_eef :=range _bfa ._fca {_bcg ._dcec =append (_bcg ._dcec ,&page {_gdf :[]*pageRow {},_aeae :_bcg ,_dadf :_eef });};};};const _fd =0.25;type convertContext struct{_bafg *_c .Creator ;_cffg *_be .Workbook ;_bfgf *_f .Theme ;_dfc *_be .Sheet ;_agd *_be .StyleSheet ;_bege int ;_fae int ;_eae []*pagespan ;_afdfe *page ;_dfe []*colInfo ;_ccf []*rowInfo ;_fca []*rowspan ;_egfda float64 ;_bbgd float64 ;_aaf float64 ;_afdg float64 ;_fgee []*mergedCell ;_gca []*anchor ;};type mergedCell struct{_fbc uint32 ;_gdfb uint32 ;_gcc uint32 ;_gee uint32 ;_cgf float64 ;_egfb float64 ;};func (_bec *convertContext )getContentFromCell (_cdcc _be .Cell ,_gege *style ,_bab float64 ,_agb bool )([]*line ,_a .ST_CellType ){_edca :=_cdcc .X ();var _dbbd []*symbol ;switch _edca .TAttr {case _a .ST_CellTypeS :_dagb :=_edca .V ;if _dagb !=nil {_dad ,_bcea :=_d .Atoi (*_dagb );if _bcea ==nil {_ebfg :=_bec ._cffg .SharedStrings .X ().Si [_dad ];if _ebfg .T !=nil {_dbbd =_bec .getSymbolsFromString (*_ebfg .T ,_gege );}else if _ebfg .R !=nil {_dbbd =_bec .getSymbolsFromR (_ebfg .R ,_gege );};};};case _a .ST_CellTypeB :_fgg :=_edca .V ;if _fgg !=nil {if *_fgg =="\u0030"{_dbbd =_bec .getSymbolsFromString ("\u0046\u0041\u004cS\u0045",_gege );}else {_dbbd =_bec .getSymbolsFromString ("\u0054\u0052\u0055\u0045",_gege );};};default:_dbbd =_bec .getSymbolsFromString (_cdcc .GetFormattedValue (),_gege );};_abgf :=0.0;_agf :=0.0;var _bced []*line ;var _cged bool ;if _gege !=nil {if _gege ._babg !=nil {if *_gege ._babg {_cged =true ;};};if _gege ._gfa !=nil {if *_gege ._gfa {_cged =true ;};};};if _agb {_bced =[]*line {};_ffd :=_bab -2*_cf ;_gda :=[]*symbol {};for _ ,_abb :=range _dbbd {_fdf (_abb );if _abgf +_abb ._fcgc >=_ffd {_ggd :=_bdd (_gda );if _cged {_ggd /=_ac ;};_bced =append (_bced ,&line {_add :_agf ,_ebfd :_gda ,_aga :_ggd });_gda =[]*symbol {_abb };_abgf =_abb ._fcgc ;_agf +=_ggd ;}else {_abb ._face =_abgf ;_abgf +=_abb ._fcgc ;_gda =append (_gda ,_abb );};};_daff :=_bdd (_gda );if _cged {_daff /=_ac ;};if len (_gda )> 0{_bced =append (_bced ,&line {_add :_agf ,_ebfd :_gda ,_aga :_daff });};}else {for _ ,_cdd :=range _dbbd {_fdf (_cdd );_cdd ._face =_abgf ;_abgf +=_cdd ._fcgc ;};if len (_dbbd )> 0{_bced =[]*line {&line {_ebfd :_dbbd ,_aga :_bdd (_dbbd )}};};};_defg :=_edca .TAttr ;if _defg ==_a .ST_CellTypeUnset {_defg =_a .ST_CellTypeN ;};return _bced ,_defg ;};func (_afa *convertContext )makeCells (){_efcc :=_afa ._dfc ;_ddbb :=_efcc .Rows ();_fc :=0;for _ ,_aac :=range _afa ._ccf {_aac ._beeb =[]*cell {};_dbc :=0.0;_ggc :=_aac ._adbc ;if _aac ._agfe {_def :=_ddbb [_fc ];_fc ++;_fce :=_aac ._ccfc ;for _ ,_acg :=range _def .Cells (){_edc ,_baf :=_cd .ParseCellReference (_acg .Reference ());if _baf !=nil {_bc .Log .Debug ("\u0043\u0061\u006e\u006eo\u0074\u0020\u0070\u0061\u0072\u0073\u0065\u0020\u0061\u0020r\u0065f\u0065\u0072\u0065\u006e\u0063\u0065\u003a \u0025\u0073",_baf );continue ;};_dfdb :=_afa ._dfe [_edc .ColumnIdx ];_bdb :=_dfdb ._dbg ;_cec :=_bdb ;_cdb :=_dfdb ._dgbg ;var _dfdc ,_fag ,_da ,_bff bool ;for _ ,_ddg :=range _afa ._fgee {if _edc .RowIdx >=_ddg ._fbc &&_edc .RowIdx <=_ddg ._gcc &&_edc .ColumnIdx >=_ddg ._gdfb &&_edc .ColumnIdx <=_ddg ._gee {if _edc .ColumnIdx ==_ddg ._gdfb &&_edc .RowIdx ==_ddg ._fbc {_bdb =_ddg ._cgf ;_fce =_ddg ._egfb ;};_dfdc =_edc .RowIdx !=_ddg ._fbc ;_fag =_edc .RowIdx !=_ddg ._gcc ;_da =_edc .ColumnIdx !=_ddg ._gdfb ;_bff =_edc .ColumnIdx !=_ddg ._gee ;};};_cdfc :=_afa .getStyleFromCell (_acg ,_ggc ,_cdb );var _ecb ,_bgd ,_ad bool ;var _daf ,_cgc ,_gce ,_dafg *border ;var _fcg _a .ST_VerticalAlignment ;var _fdda _a .ST_HorizontalAlignment ;if _cdfc !=nil {if !_dfdc {_daf =_cdfc ._ecc ;};if !_fag {_cgc =_cdfc ._debcb ;};if !_da {_gce =_cdfc ._ebe ;};if !_bff {_dafg =_cdfc ._ccad ;};if _cgc !=nil &&_cgc ._bae > _dbc {_dbc =_cgc ._bae ;};_fcg =_cdfc ._dafd ;_fdda =_cdfc ._gace ;if _cdfc ._babg !=nil {_ecb =*_cdfc ._babg ;};if _cdfc ._gfa !=nil {_bgd =*_cdfc ._gfa ;};_ad =_cdfc ._ddbg ;};_cad ,_edb :=_afa .getContentFromCell (_acg ,_cdfc ,_bdb ,_ad );_eecd :=&cell {_bfefb :_edb ,_afde :_bdb ,_egg :_cec ,_dged :_fce ,_cegd :_cad ,_bebc :_daf ,_bfc :_cgc ,_aeaa :_gce ,_aeb :_dafg ,_cab :_ecb ,_abgg :_bgd };_afa .alignSymbolsHorizontally (_eecd ,_fdda );_afa .alignSymbolsVertically (_eecd ,_fcg );_aac ._beeb =append (_aac ._beeb ,_eecd );};};_aac ._aeac =_dbc ;};};func (_bbf *convertContext )getSymbolsFromString (_bdcf string ,_ebb *style )[]*symbol {_becb :=[]*symbol {};_egaa :=_bbf .makeTextStyleFromCellStyle (_ebb );for _ ,_beff :=range _bdcf {_becb =append (_becb ,&symbol {_fcba :string (_beff ),_fdgd :_egaa });};return _becb ;};func _cgga (_dffd *bool )bool {return _dffd !=nil &&*_dffd };func (_beg *convertContext )addRowToPage (_agc []*cell ,_eaga int ){_bcga :=0.0;_adg :=_beg ._afdg ;for _ ,_cgeb :=range _agc {if len (_cgeb ._cegd )!=0{_cgeb ._gab =_bcga ;_bcga =_cgeb ._dee +_cgeb ._afde ;};};for _ebf :=len (_agc )-1;_ebf >=0;_ebf --{_efe :=_agc [_ebf ];if len (_efe ._cegd )!=0{_efe ._bdcc =_adg ;_adg =_efe ._dee ;};};_beg ._afdfe ._gdf =append (_beg ._afdfe ._gdf ,&pageRow {_dfef :_eaga ,_cfa :_agc });};func (_dfdf *convertContext )getStyle (_ebde *uint32 )*style {_daffg :=&style {};_ecbb :=false ;if _ebde !=nil {_aegc :=_dfdf ._agd .GetCellStyle (*_ebde );_fggc :=_aegc .GetFont ();for _ ,_gaa :=range _fggc .Name {if _gaa !=nil {_daffg ._acefb =&_gaa .ValAttr ;_ecbb =true ;break ;};};for _ ,_ddbf :=range _fggc .B {if _ddbf !=nil {_daab :=_ddbf .ValAttr ==nil ||*_ddbf .ValAttr ;_daffg ._edd =&_daab ;_ecbb =true ;break ;};};for _ ,_efdg :=range _fggc .I {if _efdg !=nil {_ffe :=_efdg .ValAttr ==nil ||*_efdg .ValAttr ;_daffg ._gbd =&_ffe ;_ecbb =true ;break ;};};for _ ,_gbbb :=range _fggc .U {if _gbbb !=nil {_dfed :=_gbbb .ValAttr ==_a .ST_UnderlineValuesSingle ||_gbbb .ValAttr ==_a .ST_UnderlineValuesUnset ;_daffg ._efg =&_dfed ;_ecbb =true ;break ;};};for _ ,_eedg :=range _fggc .Sz {if _eedg !=nil {_egbfd :=_eedg .ValAttr /12*_bf .DefaultFontSize ;_daffg ._feff =&_egbfd ;_ecbb =true ;break ;};};for _ ,_bgda :=range _fggc .VertAlign {if _bgda !=nil {_bcge :=_bgda .ValAttr ==_eg .ST_VerticalAlignRunSuperscript ;_daffg ._babg =&_bcge ;_ceec :=_bgda .ValAttr ==_eg .ST_VerticalAlignRunSubscript ;_daffg ._gfa =&_ceec ;_ecbb =true ;break ;};};for _ ,_dgec :=range _fggc .Color {if _dgec !=nil {_daffg ._faeb =_dfdf .getColorStringFromSmlColor (_dgec );_ecbb =true ;break ;};};_gbf :=_aegc .GetBorder ();if _gbf .Top !=nil {_daffg ._ecc =_dfdf .getBorder (_gbf .Top );_ecbb =true ;};if _gbf .Bottom !=nil {_daffg ._debcb =_dfdf .getBorder (_gbf .Bottom );_ecbb =true ;};if _gbf .Left !=nil {_daffg ._ebe =_dfdf .getBorder (_gbf .Left );_ecbb =true ;};if _gbf .Right !=nil {_daffg ._ccad =_dfdf .getBorder (_gbf .Right );_ecbb =true ;};if _aegc .Wrapped (){_daffg ._ddbg =true ;_ecbb =true ;};if _cagd :=_aegc .GetVerticalAlignment ();_cagd !=_a .ST_VerticalAlignmentUnset {_daffg ._dafd =_cagd ;_ecbb =true ;};if _fcga :=_aegc .GetHorizontalAlignment ();_fcga !=_a .ST_HorizontalAlignmentUnset {_daffg ._gace =_fcga ;_ecbb =true ;};};if _ecbb {return _daffg ;};return nil ;};type pageRow struct{_dfef int ;_cfa []*cell ;};type symbol struct{_fcba string ;_face float64 ;_bdae float64 ;_fcgc float64 ;_fdgd *_c .TextStyle ;_fbfa string ;};type border struct{_bae float64 ;_bdbe _c .Color ;};const _ac =0.64;type rowInfo struct{_aeca float64 ;_agfe bool ;_ccfc float64 ;_adbc *style ;_beeb []*cell ;_aeac float64 ;};func (_fcea *convertContext )alignSymbolsHorizontally (_fede *cell ,_bfeb _a .ST_HorizontalAlignment ){if _bfeb ==_a .ST_HorizontalAlignmentUnset {switch _fede ._bfefb {case _a .ST_CellTypeB :_bfeb =_a .ST_HorizontalAlignmentCenter ;case _a .ST_CellTypeN :_bfeb =_a .ST_HorizontalAlignmentRight ;default:_bfeb =_a .ST_HorizontalAlignmentLeft ;};};var _fde float64 ;for _ ,_cea :=range _fede ._cegd {switch _bfeb {case _a .ST_HorizontalAlignmentLeft :_fde =_cf ;case _a .ST_HorizontalAlignmentRight :_cdag :=_ccd (_cea ._ebfd );_fde =_fede ._afde -_cf -_cdag ;case _a .ST_HorizontalAlignmentCenter :_aeg :=_ccd (_cea ._ebfd );_fde =(_fede ._afde -_aeg )/2;};for _ ,_fad :=range _cea ._ebfd {_fad ._face +=_fde ;};};};var _bddd =map[uint32 ]_c .PageSize {1:_c .PageSize {8.5*_dg .Inch ,11*_dg .Inch },2:_c .PageSize {8.5*_dg .Inch ,11*_dg .Inch },3:_c .PageSize {11*_dg .Inch ,17*_dg .Inch },4:_c .PageSize {17*_dg .Inch ,11*_dg .Inch },5:_c .PageSize {8.5*_dg .Inch ,14*_dg .Inch },6:_c .PageSize {5.5*_dg .Inch ,8.5*_dg .Inch },7:_c .PageSize {7.5*_dg .Inch ,10*_dg .Inch },8:_c .PageSize {_eea (297),_eea (420)},9:_c .PageSize {_eea (210),_eea (297)},10:_c .PageSize {_eea (210),_eea (297)},11:_c .PageSize {_eea (148),_eea (210)},70:_c .PageSize {_eea (105),_eea (148)},12:_c .PageSize {_eea (250),_eea (354)},13:_c .PageSize {_eea (182),_eea (257)},14:_c .PageSize {8.5*_dg .Inch ,13*_dg .Inch },20:_c .PageSize {4.125*_dg .Inch ,9.5*_dg .Inch },27:_c .PageSize {_eea (110),_eea (220)},28:_c .PageSize {_eea (162),_eea (229)},34:_c .PageSize {_eea (250),_eea (176)},29:_c .PageSize {_eea (324),_eea (458)},30:_c .PageSize {_eea (229),_eea (324)},31:_c .PageSize {_eea (114),_eea (162)},37:_c .PageSize {3.88*_dg .Inch ,7.5*_dg .Inch },43:_c .PageSize {_eea (100),_eea (148)},69:_c .PageSize {_eea (200),_eea (148)}};const _db =2;var _fdc =_eea (1);func (_dgda *convertContext )alignSymbolsVertically (_daga *cell ,_bfdf _a .ST_VerticalAlignment ){var _cgcg float64 ;switch _bfdf {case _a .ST_VerticalAlignmentTop :_cgcg =_db ;if _daga ._cab {_cgcg -=_gc ;}else if _daga ._abgg {_cgcg +=4*_gc ;};for _ ,_afe :=range _daga ._cegd {_cgcg +=_afe ._aga ;_afe ._add =_cgcg ;_cgcg +=_fdc ;};case _a .ST_VerticalAlignmentCenter :_afc :=0.0;for _ ,_cee :=range _daga ._cegd {_afc +=_cee ._aga +_eea (1);};_cgcg =0.5*(_daga ._dged -_afc );if _daga ._cab {_cgcg -=2*_gc ;}else if _daga ._abgg {_cgcg +=2*_gc ;};for _ ,_ebda :=range _daga ._cegd {_cgcg +=_ebda ._aga +0.5*_fdc ;_ebda ._add =_cgcg ;_cgcg +=0.5*_fdc ;};default:_cgcg =_daga ._dged -_db ;if _daga ._cab {_cgcg -=4*_gc ;}else if _daga ._abgg {_cgcg +=_gc ;};for _edf :=len (_daga ._cegd )-1;_edf >=0;_edf --{_daga ._cegd [_edf ]._add =_cgcg ;_cgcg -=_daga ._cegd [_edf ]._aga ;_cgcg -=_fdc ;};};};

// RegisterFont makes a PdfFont accessible for using in converting to PDF.
func RegisterFont (name string ,style FontStyle ,font *_e .PdfFont ){_bf .RegisterFont (name ,style ,font );};func (_bga *convertContext )makePagespans (){_bga ._eae =[]*pagespan {};_dff :=0.0;_fcf :=0;for _gfg ,_dcf :=range _bga ._dfe {_abd :=_dcf ._dbg ;if _dff +_abd <=_bga ._afdg {_dcf ._cfee =_dff ;_dff +=_abd ;}else {_dcf ._cfee =0;_bga ._eae =append (_bga ._eae ,&pagespan {_defa :_dff ,_dgc :_fcf ,_fea :_gfg });_dff =_abd ;_fcf =_gfg ;};};_bga ._eae =append (_bga ._eae ,&pagespan {_defa :_dff ,_dgc :_fcf ,_fea :len (_bga ._dfe )});};type page struct{_gdf []*pageRow ;_bee bool ;_aaacb []*_c .Image ;_aeae *pagespan ;_dadf *rowspan ;};func (_dd *convertContext )makeCols (){_acf :=_dd ._dfc ;_ded :=_acf .X ();_dfd :=[]*colInfo {};_afd :=[]colWidthRange {};if _gf :=_ded .Cols ;len (_gf )> 0{for _ ,_efdb :=range _gf [0].Col {_dbf :=65.0;if _ec :=_efdb .WidthAttr ;_ec !=nil {if *_ec > 0.83{*_ec -=0.83;};if *_ec <=1{_dbf =*_ec *11;}else {_dbf =5+*_ec *6;};};_bge :=int (_efdb .MinAttr -1);_aceb :=int (_efdb .MaxAttr -1);_afd =append (_afd ,colWidthRange {_afag :_bge ,_bdbd :_aceb ,_gccc :_dbf ,_bac :_dd .getStyle (_efdb .StyleAttr )});};};_ab :=0;for _ced :=0;_ced <=_dd ._fae ;_ced ++{var _ccg float64 ;var _efc *style ;if _ab >=len (_afd ){_ccg =65;}else {_cgd :=_afd [_ab ];if _ced >=_cgd ._afag &&_ced <=_cgd ._bdbd {_ccg =_cgd ._gccc ;_efc =_cgd ._bac ;if _ced ==_cgd ._bdbd {_ab ++;};}else {_ccg =65;};};_dfd =append (_dfd ,&colInfo {_dbg :_ccg ,_dgbg :_efc });};_dd ._dfe =_dfd ;};func (_fec *convertContext )distributeAnchors (){for _ ,_dcaf :=range _fec ._gca {_ggae ,_ffa :=_dcaf ._abgd ,_dcaf ._acfb ;_dag ,_dgbe :=_dcaf ._dac ,_dcaf ._dedf ;_eca ,_efa :=_dcaf ._aegg ,_dcaf ._bfdg ;_fcd ,_gcfa :=_dcaf ._cdfa ,_dcaf ._cfg ;var _dfb ,_edce ,_cdee ,_bfb *page ;for _ ,_acef :=range _fec ._eae {for _ ,_acdb :=range _acef ._dcec {if _ggae >=_acdb ._dadf ._ggbc &&_ggae < _acdb ._dadf ._fade {if _dag >=_acdb ._aeae ._dgc &&_dag < _acdb ._aeae ._fea {_acdb ._bee =true ;_dfb =_acdb ;};if _fcd >=_acdb ._aeae ._dgc &&_fcd < _acdb ._aeae ._fea {_acdb ._bee =true ;_edce =_acdb ;};};if _eca >=_acdb ._dadf ._ggbc &&_eca < _acdb ._dadf ._fade {if _dag >=_acdb ._aeae ._dgc &&_dag < _acdb ._aeae ._fea {_acdb ._bee =true ;_bfb =_acdb ;};if _fcd >=_acdb ._aeae ._dgc &&_fcd < _acdb ._aeae ._fea {_acdb ._bee =true ;_cdee =_acdb ;};};};};_bef :=_dfb !=_edce ;_cae :=_dfb !=_bfb ;if _bef &&_cae {_acb :=_fec ._dfe [_dag ]._cfee +_dg .FromEMU (_dgbe );_fbe :=_dfb ._aeae ._defa ;_cb :=_fec ._dfe [_fcd ]._cfee +_dg .FromEMU (_gcfa );_ega :=_fec ._ccf [_ggae ]._aeca +_dg .FromEMU (_ffa );_ceca :=float64 (_dfb ._dadf ._debd );_fcb :=_fec ._ccf [_eca ]._aeca +_dg .FromEMU (_efa );_acfa :=_cb +_fbe -_acb ;_gd :=_fcb +_ceca -_ega ;_cga :=_fec .imageFromAnchor (_dcaf ,_acfa ,_gd );_dfb ._aaacb =append (_dfb ._aaacb ,_fec .getImage (_cga ,_gd ,_acfa ,_acb ,_ega ,_fbe -_acb ,_ceca -_ega ,_bf .ImgPart_lt ));_edce ._aaacb =append (_edce ._aaacb ,_fec .getImage (_cga ,_gd ,_acfa ,0,_ega ,_fbe -_acb ,_ceca -_ega ,_bf .ImgPart_rt ));_bfb ._aaacb =append (_bfb ._aaacb ,_fec .getImage (_cga ,_gd ,_acfa ,_acb ,0,_fbe -_acb ,_ceca -_ega ,_bf .ImgPart_lb ));_cdee ._aaacb =append (_cdee ._aaacb ,_fec .getImage (_cga ,_gd ,_acfa ,0,0,_fbe -_acb ,_ceca -_ega ,_bf .ImgPart_rb ));}else if _bef {_fdb :=_fec ._ccf [_ggae ]._aeca +_dg .FromEMU (_ffa );_fbf :=_fec ._ccf [_eca ]._aeca +_dg .FromEMU (_efa );_bdcd :=_fec ._dfe [_dag ]._cfee +_dg .FromEMU (_dgbe );_ebd :=_dfb ._aeae ._defa ;_eed :=_fec ._dfe [_fcd ]._cfee +_dg .FromEMU (_gcfa );_cfe :=_eed +_ebd -_bdcd ;_aaa :=_fbf -_fdb ;_bfef :=_fec .imageFromAnchor (_dcaf ,_cfe ,_aaa );_dfb ._aaacb =append (_dfb ._aaacb ,_fec .getImage (_bfef ,_aaa ,_cfe ,_bdcd ,_fdb ,_ebd -_bdcd ,0,_bf .ImgPart_l ));_edce ._aaacb =append (_edce ._aaacb ,_fec .getImage (_bfef ,_aaa ,_cfe ,0,_fdb ,_ebd -_bdcd ,0,_bf .ImgPart_r ));}else if _cae {_cbd :=_fec ._dfe [_dag ]._cfee +_dg .FromEMU (_dgbe );_bage :=_fec ._dfe [_fcd ]._cfee +_dg .FromEMU (_gcfa );_cgcd :=_fec ._ccf [_ggae ]._aeca +_dg .FromEMU (_ffa );_fedd :=float64 (_dfb ._dadf ._debd );_dce :=_fec ._ccf [_eca ]._aeca +_dg .FromEMU (_efa );_baff :=_bage -_cbd ;_gcd :=_dce +_fedd -_cgcd ;_faaa :=_fec .imageFromAnchor (_dcaf ,_baff ,_gcd );_dfb ._aaacb =append (_dfb ._aaacb ,_fec .getImage (_faaa ,_gcd ,_baff ,_cbd ,_cgcd ,0,_fedd -_cgcd ,_bf .ImgPart_t ));_bfb ._aaacb =append (_bfb ._aaacb ,_fec .getImage (_faaa ,_gcd ,_baff ,_cbd ,0,0,_fedd -_cgcd ,_bf .ImgPart_b ));}else {_egfd :=_fec ._dfe [_dag ]._cfee +_dg .FromEMU (_dgbe );_bgec :=_fec ._dfe [_fcd ]._cfee +_dg .FromEMU (_gcfa );_adb :=_fec ._ccf [_ggae ]._aeca +_dg .FromEMU (_ffa );_cba :=_fec ._ccf [_eca ]._aeca +_dg .FromEMU (_efa );_bcce :=_bgec -_egfd ;_eagd :=_cba -_adb ;_dcaa :=_fec .imageFromAnchor (_dcaf ,_bcce ,_eagd );_dfb ._aaacb =append (_dfb ._aaacb ,_fec .getImage (_dcaa ,_eagd ,_bcce ,_egfd ,_adb ,0,0,_bf .ImgPart_whole ));};};};func (_bba *convertContext )getSymbolsFromR (_caec []*_a .CT_RElt ,_cbg *style )[]*symbol {_bedc :=[]*symbol {};for _ ,_cbdc :=range _caec {_dda :=_bba .combineCellStyleWithRPrElt (_cbg ,_cbdc .RPr );for _ ,_cdg :=range _cbdc .T {_bedc =append (_bedc ,&symbol {_fcba :string (_cdg ),_fdgd :_bba .makeTextStyleFromCellStyle (_dda )});};};return _bedc ;};func (_dbcb *convertContext )imageFromAnchor (_gac *anchor ,_bdbb ,_bbe float64 )_g .Image {if _gac ._bfcd !=nil {return _gac ._bfcd ;};if _gac ._egfe !=nil {_fdgc ,_dfg :=_bf .MakeImageFromChartSpace (_gac ._egfe ,_bdbb ,_bbe ,_dbcb ._bfgf );if _dfg !=nil {_bc .Log .Debug ("C\u0061\u006e\u006e\u006f\u0074\u0020\u006d\u0061\u006b\u0065\u0020\u0061\u006e\u0020\u0069\u006d\u0061\u0067e\u0020\u0066\u0072\u006f\u006d\u0020\u0063\u0068\u0061\u0072tS\u0070\u0061\u0063e\u003a \u0025\u0073",_dfg );return nil ;};return _fdgc ;};return nil ;};func (_aab *convertContext )fillPages (){for _eag ,_dbb :=range _aab ._fca {_cfd :=_aab ._ccf [_dbb ._ggbc :_dbb ._fade ];for _cca ,_ag :=range _cfd {_dgd :=0;_gb :=0.0;_abe :=[]*cell {};if _ag ._agfe {for _ ,_gcf :=range _ag ._beeb {_afdf :=_aab ._eae [_dgd ];_aab ._afdfe =_afdf ._dcec [_eag ];_aab ._afdfe ._bee =true ;_eeb :=_gcf ._egg ;if _gb +_eeb > _afdf ._defa {_aab .addRowToPage (_abe ,_cca );_abe =[]*cell {_gcf };_gb =_eeb ;_dgd ++;}else {_gcf ._dee =_gb ;_abe =append (_abe ,_gcf );_gb +=_eeb ;};};if len (_abe )> 0{_gfcd :=_aab ._eae [_dgd ];_aab ._afdfe =_gfcd ._dcec [_eag ];_aab ._afdfe ._bee =true ;_aab .addRowToPage (_abe ,_cca );};};};};};type colInfo struct{_cfee float64 ;_dbg float64 ;_dgbg *style ;};func (_bcd *convertContext )getStyleFromCell (_bfaa _be .Cell ,_fgb ,_dfdg *style )*style {_daffe :=_bfaa .X ();_faga :=_bcd .getStyle (_daffe .SAttr );_ggdg (_faga ,_fgb );_ggdg (_faga ,_dfdg );return _faga ;};type cell struct{_bfefb _a .ST_CellType ;_ddbgb int ;_dee float64 ;_cegd []*line ;_afde float64 ;_egg float64 ;_dged float64 ;_gab float64 ;_bdcc float64 ;_aeag *_c .TextStyle ;_bebc *border ;_bfc *border ;_aeaa *border ;_aeb *border ;_cab bool ;_abgg bool ;};type colWidthRange struct{_afag int ;_bdbd int ;_gccc float64 ;_bac *style ;};const (FontStyle_Regular FontStyle =0;FontStyle_Bold FontStyle =1;FontStyle_Italic FontStyle =2;FontStyle_BoldItalic FontStyle =3;);func _ccd (_ggeb []*symbol )float64 {_agce :=0.0;for _ ,_dga :=range _ggeb {_agce +=_dga ._fcgc ;};return _agce ;};type style struct{_faeb *string ;_feff *float64 ;_acefb *string ;_edd *bool ;_gbd *bool ;_efg *bool ;_babg *bool ;_gfa *bool ;_ecc *border ;_debcb *border ;_ebe *border ;_ccad *border ;_ddbg bool ;_dafd _a .ST_VerticalAlignment ;_gace _a .ST_HorizontalAlignment ;};type anchor struct{_bfcd _g .Image ;_egfe *_ge .ChartSpace ;_abgd int ;_acfb int64 ;_dac int ;_dedf int64 ;_aegg int ;_bfdg int64 ;_cdfa int ;_cfg int64 ;};func (_gde *convertContext )drawPage (_fda *page ){_daa :=_gde ._egfda ;_dedd :=_gde ._bbgd ;for _ ,_ccc :=range _fda ._gdf {_eee :=_gde ._ccf [_ccc ._dfef ];for _ ,_egab :=range _ccc ._cfa {_age :=_egab ._gab < _egab ._dee ;_cecaa :=_egab ._bdcc > _egab ._dee +_egab ._afde ;var _ddf ,_fbdc bool ;for _ ,_geg :=range _egab ._cegd {for _ ,_caaa :=range _geg ._ebfd {if _age &&!_ddf {_ddf =_caaa ._face < 0;};if _cecaa &&!_fbdc {_fbdc =_egab ._afde < _caaa ._face +_caaa ._fcgc ;};if _egab ._dee +_caaa ._face >=_egab ._gab &&_egab ._dee +_caaa ._face +_caaa ._fcgc <=_egab ._bdcc {_fge :=_gde ._bafg .NewStyledParagraph ();_dgf :=_dedd +_egab ._dee +_caaa ._face ;_gba :=_daa +_eee ._aeca +_geg ._add -_caaa ._bdae -_eea (0.5);_fge .SetPos (_dgf ,_gba );var _dcb *_c .TextChunk ;if _caaa ._fbfa !=""{_dcb =_fge .AddExternalLink (_caaa ._fcba ,_caaa ._fbfa );}else {_dcb =_fge .Append (_caaa ._fcba );};if _caaa ._fdgd !=nil {_dcb .Style =*_caaa ._fdgd ;};_gde ._bafg .Draw (_fge );};};};var _gag ,_fbb ,_abda ,_bcae ,_acab ,_cgb float64 ;var _ecf ,_baa ,_agef ,_fff _c .Color ;if _aba :=_egab ._bebc ;_aba !=nil {_gag =_aba ._bae ;_ecf =_aba ._bdbe ;};if _cag :=_egab ._bfc ;_cag !=nil {_fbb =_cag ._bae ;_baa =_cag ._bdbe ;};if _dedb :=_egab ._aeaa ;_dedb !=nil {_abda =_dedb ._bae ;_acab =_abda /2;_agef =_dedb ._bdbe ;};if _bdca :=_egab ._aeb ;_bdca !=nil {_bcae =_bdca ._bae ;_cgb =_bcae /2;_fff =_bdca ._bdbe ;};var _dcbe float64 ;if _ccc ._dfef > 1{_dcbe =_gde ._ccf [_ccc ._dfef -1]._aeac ;};_fecf :=_daa +_eee ._aeca -0.5*(_dcbe -_gag );_aaac :=_daa +_eee ._aeca +_eee ._ccfc +0.5*(_eee ._aeac +_fbb );_aea :=_dedd +_egab ._dee ;_gage :=_aea +_egab ._egg ;_bf .DrawLine (_gde ._bafg ,_aea ,_fecf ,_gage ,_fecf ,_gag ,_ecf );_bf .DrawLine (_gde ._bafg ,_aea ,_aaac ,_gage ,_aaac ,_fbb ,_baa );if !_ddf {_bf .DrawLine (_gde ._bafg ,_aea -_acab ,_fecf ,_aea -_acab ,_aaac ,_abda ,_agef );};if !_fbdc {_bf .DrawLine (_gde ._bafg ,_gage -_cgb ,_fecf ,_gage -_cgb ,_aaac ,_bcae ,_fff );};};};for _ ,_eff :=range _fda ._aaacb {if _eff !=nil {_gde ._bafg .Draw (_eff );};};};func (_bed *convertContext )makeMergedCells (){_ga :=[]*mergedCell {};for _ ,_cdc :=range _bed ._dfc .MergedCells (){_egea ,_cde ,_afgd :=_cd .ParseRangeReference (_cdc .Reference ());if _afgd !=nil {_bc .Log .Debug ("\u0065\u0072r\u006f\u0072\u0020\u0070\u0061\u0072\u0073\u0069\u006e\u0067\u0020\u006d\u0065\u0072\u0067\u0065\u0064\u0020\u0063\u0065\u006c\u006c: \u0025\u0073",_afgd );continue ;};_deb :=mergedCell {_fbc :_egea .RowIdx ,_gdfb :_egea .ColumnIdx ,_gcc :_cde .RowIdx ,_gee :_cde .ColumnIdx };for _gfc :=_deb ._gdfb -1;_gfc < _deb ._gee ;_gfc ++{_deb ._cgf +=_bed ._dfe [_gfc ]._dbg ;};for _fdd :=_deb ._fbc -1;_fdd < _deb ._gcc ;_fdd ++{_deb ._egfb +=_bed ._ccf [_fdd ]._ccfc ;};_ga =append (_ga ,&_deb );};_bed ._fgee =_ga ;};

// ConvertToPdf converts a sheet to a PDF file. This package is beta, breaking changes can take place.
func ConvertToPdf (s *_be .Sheet )*_c .Creator {_egb :=s .X ();if _egb ==nil {return nil ;};var _egf _c .PageSize ;var _ea bool ;if _dc :=_egb .PageSetup ;_dc !=nil {if _bce :=_dc .PaperSizeAttr ;_bce !=nil {_egf =_bddd [*_bce ];};_ea =_dc .OrientationAttr ==_a .ST_OrientationLandscape ;};if (_egf ==_c .PageSize {}){_egf =_bddd [1];};if _ea {_egf [0],_egf [1]=_egf [1],_egf [0];};_fa :=_c .New ();_fa .SetPageSize (_egf );var _bb ,_af ,_bbg ,_fdg float64 ;if _ee :=_egb .PageMargins ;_ee !=nil {_bbg =_ee .LeftAttr ;_fdg =_ee .RightAttr ;_bb =_ee .TopAttr ;_af =_ee .BottomAttr ;};if _bbg < 0.25{_bbg =0.25;};if _fdg < 0.25{_fdg =0.25;};_bb *=_dg .Inch ;_af *=_dg .Inch ;_bbg *=_dg .Inch ;_fdg *=_dg .Inch ;_fa .SetPageMargins (_bbg ,_fdg ,_bb ,_af );_cff :=s .Workbook ();var _dcg *_f .Theme ;if len (_cff .Themes ())> 0{_dcg =_cff .Themes ()[0];};_aa :=&convertContext {_bafg :_fa ,_dfc :s ,_cffg :s .Workbook (),_bfgf :_dcg ,_agd :&s .Workbook ().StyleSheet ,_egfda :_bb ,_bbgd :_bbg ,_aaf :_egf [1]-_af -_bb ,_afdg :_egf [0]-_fdg -_bbg };_aa .makeAnchors ();_aa .determineMaxIndexes ();if _aa ._bege ==0&&_aa ._fae ==0{_fa .NewPage ();return _fa ;};_aa .makeCols ();_aa .makeRows ();_aa .makeMergedCells ();_aa .makeCells ();_aa .makePagespans ();_aa .makeRowspans ();_aa .makePages ();_aa .fillPages ();_aa .distributeAnchors ();_aa .drawSheet ();return _fa ;};func (_dcbg *convertContext )combineCellStyleWithRPrElt (_aace *style ,_cbc *_a .CT_RPrElt )*style {_eccb :=*_aace ;_bgeg :=_dcbg .getStyleFromRPrElt (_cbc );if _bgeg ==nil {return &_eccb ;};if _bgeg ._faeb !=nil {_eccb ._faeb =_bgeg ._faeb ;};if _bgeg ._feff !=nil {_eccb ._feff =_bgeg ._feff ;};if _bgeg ._acefb !=nil {_eccb ._acefb =_bgeg ._acefb ;};if _bgeg ._edd !=nil {_eccb ._edd =_bgeg ._edd ;};if _bgeg ._gbd !=nil {_eccb ._gbd =_bgeg ._gbd ;};if _bgeg ._efg !=nil {_eccb ._efg =_bgeg ._efg ;};if _bgeg ._babg !=nil {_eccb ._babg =_bgeg ._babg ;};if _bgeg ._gfa !=nil {_eccb ._gfa =_bgeg ._gfa ;};return &_eccb ;};func (_dae *convertContext )makeRowspans (){var _eaa float64 ;_bafd :=0;for _fac ,_fgc :=range _dae ._ccf {_aag :=_fgc ._ccfc +_fgc ._aeac ;if _eaa +_aag <=_dae ._aaf {_fgc ._aeca =_eaa ;_eaa +=_aag ;}else {_dae ._fca =append (_dae ._fca ,&rowspan {_debd :_eaa ,_ggbc :_bafd ,_fade :_fac });_bafd =_fac ;_fgc ._aeca =0;_eaa =_aag ;};};_dae ._fca =append (_dae ._fca ,&rowspan {_debd :_eaa ,_ggbc :_bafd ,_fade :len (_dae ._ccf )});};func (_ffb *convertContext )makeTextStyleFromCellStyle (_cabc *style )*_c .TextStyle {_gcdc :=_ffb ._bafg .NewTextStyle ();if _cabc ==nil {_gcdc .FontSize =_bf .DefaultFontSize ;_gcdc .Font =_bf .AssignStdFontByName (_gcdc ,_bf .StdFontsMap ["\u0064e\u0066\u0061\u0075\u006c\u0074"][FontStyle_Regular ]);return &_gcdc ;};if _cgga (_cabc ._efg ){_gcdc .Underline =true ;_gcdc .UnderlineStyle =_c .TextDecorationLineStyle {Offset :0.5,Thickness :_eea (1/32)};};var _ade FontStyle ;if _cgga (_cabc ._edd )&&_cgga (_cabc ._gbd ){_ade =FontStyle_BoldItalic ;}else if _cgga (_cabc ._edd ){_ade =FontStyle_Bold ;}else if _cgga (_cabc ._gbd ){_ade =FontStyle_Italic ;}else {_ade =FontStyle_Regular ;};_bcb :="\u0064e\u0066\u0061\u0075\u006c\u0074";if _cabc ._acefb !=nil {_bcb =*_cabc ._acefb ;};if _ggf ,_cgfe :=_bf .StdFontsMap [_bcb ];_cgfe {_gcdc .Font =_bf .AssignStdFontByName (_gcdc ,_ggf [_ade ]);}else if _acba :=_bf .GetRegisteredFont (_bcb ,_ade );_acba !=nil {_gcdc .Font =_acba ;}else {_bc .Log .Debug ("\u0046\u006f\u006e\u0074\u0020\u0025\u0073\u0020\u0077\u0069\u0074h\u0020\u0073\u0074\u0079\u006c\u0065\u0020\u0025s\u0020i\u0073\u0020\u006e\u006f\u0074\u0020\u0066\u006f\u0075\u006e\u0064\u002c\u0020\u0072\u0065\u0073\u0065\u0074 \u0074\u006f\u0020\u0064\u0065\u0066\u0061\u0075\u006c\u0074\u002e",_bcb ,_ade );_gcdc .Font =_bf .AssignStdFontByName (_gcdc ,_bf .StdFontsMap ["\u0064e\u0066\u0061\u0075\u006c\u0074"][_ade ]);};if _cabc ._feff !=nil {_gcdc .FontSize =*_cabc ._feff ;};if _cabc ._faeb !=nil {_gcdc .Color =_c .ColorRGBFromHex (*_cabc ._faeb );};if _cabc ._babg !=nil &&*_cabc ._babg {_gcdc .FontSize *=_ac ;}else if _cabc ._gfa !=nil &&*_cabc ._gfa {_gcdc .FontSize *=_ac ;};return &_gcdc ;};func _fdf (_caaf *symbol ){_aec :=_c .New ();_eadg :=_aec .NewStyledParagraph ();_eadg .SetMargins (0,0,0,0);_bffc :=_eadg .Append (_caaf ._fcba );if _caaf ._fdgd !=nil {_bffc .Style =*_caaf ._fdgd ;};_caaf ._bdae =_eadg .Height ();if _caaf ._fcgc ==0{_caaf ._fcgc =_eadg .Width ();};};func (_fbg *convertContext )getStyleFromRPrElt (_fceg *_a .CT_RPrElt )*style {if _fceg ==nil {return nil ;};_aeaad :=&style {};_aeaad ._acefb =&_fceg .RFont .ValAttr ;if _gagc :=_fceg .B ;_gagc !=nil {_bcf :=_gagc .ValAttr ==nil ||*_gagc .ValAttr ;_aeaad ._edd =&_bcf ;};if _bgef :=_fceg .I ;_bgef !=nil {_dcc :=_bgef .ValAttr ==nil ||*_bgef .ValAttr ;_aeaad ._gbd =&_dcc ;};if _gff :=_fceg .U ;_gff !=nil {_gecd :=_gff .ValAttr ==_a .ST_UnderlineValuesSingle ||_gff .ValAttr ==_a .ST_UnderlineValuesUnset ;_aeaad ._efg =&_gecd ;};if _faf :=_fceg .VertAlign ;_faf !=nil {_ggda :=_faf .ValAttr ==_eg .ST_VerticalAlignRunSuperscript ;_aeaad ._babg =&_ggda ;_fcge :=_faf .ValAttr ==_eg .ST_VerticalAlignRunSubscript ;_aeaad ._gfa =&_fcge ;};if _fab :=_fceg .Sz ;_fab !=nil {_bgg :=_fab .ValAttr /12*_bf .DefaultFontSize ;_aeaad ._feff =&_bgg ;};if _befc :=_fceg .Color ;_befc !=nil {_aeaad ._faeb =_fbg .getColorStringFromSmlColor (_befc );};return _aeaad ;};func (_fed *convertContext )makeRows (){_bdf :=[]*rowInfo {};_gga :=_fed ._dfc .Rows ();_ege :=0;for _ ,_ddb :=range _gga {_ege ++;_dfdd :=int (_ddb .RowNumber ());if _dfdd > _ege {for _dca :=_ege ;_dca < _dfdd ;_dca ++{_bdf =append (_bdf ,&rowInfo {_ccfc :16/_gg });};_ege =_dfdd ;};var _faa float64 ;if _ddb .X ().HtAttr ==nil {_faa =16;}else {_faa =*_ddb .X ().HtAttr ;};_bdf =append (_bdf ,&rowInfo {_ccfc :_faa /_gg ,_agfe :true ,_adbc :_fed .getStyle (_ddb .X ().SAttr )});};for _ggb :=len (_bdf );_ggb < _fed ._bege ;_ggb ++{_bdf =append (_bdf ,&rowInfo {_ccfc :16/_gg });};_fed ._ccf =_bdf ;};func _ggdg (_bgdf ,_dcde *style ){if _dcde ==nil {return ;};if _bgdf ==nil {_bgdf =_dcde ;return ;};if _bgdf ._acefb ==nil {_bgdf ._acefb =_dcde ._acefb ;};if _bgdf ._faeb ==nil {_bgdf ._faeb =_dcde ._faeb ;};if _bgdf ._feff ==nil {_bgdf ._feff =_dcde ._feff ;};if _bgdf ._edd ==nil {_bgdf ._edd =_dcde ._edd ;};if _bgdf ._gbd ==nil {_bgdf ._gbd =_dcde ._gbd ;};if _bgdf ._efg ==nil {_bgdf ._efg =_dcde ._efg ;};if _bgdf ._babg ==nil {_bgdf ._babg =_dcde ._babg ;};if _bgdf ._gfa ==nil {_bgdf ._gfa =_dcde ._gfa ;};if _bgdf ._ecc ==nil {_bgdf ._ecc =_dcde ._ecc ;};if _bgdf ._debcb ==nil {_bgdf ._debcb =_dcde ._debcb ;};if _bgdf ._ebe ==nil {_bgdf ._ebe =_dcde ._ebe ;};if _bgdf ._ccad ==nil {_bgdf ._ccad =_dcde ._ccad ;};if _bgdf ._dafd ==_a .ST_VerticalAlignmentUnset {_bgdf ._dafd =_dcde ._dafd ;};if _bgdf ._gace ==_a .ST_HorizontalAlignmentUnset {_bgdf ._gace =_dcde ._gace ;};};func _bdd (_bgc []*symbol )float64 {_gfgc :=0.0;for _ ,_bbd :=range _bgc {if _bbd ._bdae > _gfgc {_gfgc =_bbd ._bdae ;};};return _gfgc ;};func (_gbc *convertContext )getBorder (_cggf *_a .CT_BorderPr )*border {_gfb :=&border {};switch _cggf .StyleAttr {case _a .ST_BorderStyleThin :_gfb ._bae =_acd ;case _a .ST_BorderStyleMedium :_gfb ._bae =_acd *2;case _a .ST_BorderStyleThick :_gfb ._bae =_acd *4;};if _gfb ._bae ==0.0{return nil ;};if _gec :=_cggf .Color ;_gec !=nil {_fcff :=_gbc .getColorStringFromSmlColor (_gec );if _fcff !=nil {_gfb ._bdbe =_c .ColorRGBFromHex (*_fcff );}else {_gfb ._bdbe =_c .ColorBlack ;};};return _gfb ;};type rowspan struct{_debd float64 ;_ggbc int ;_fade int ;};func _eea (_fdbg float64 )float64 {return _fdbg *_dg .Millimeter };var _caea =[]string {"\u0030\u0030\u0030\u0030\u0030\u0030","\u0066\u0066\u0066\u0066\u0066\u0066","\u0066\u0066\u0030\u0030\u0030\u0030","\u0030\u0030\u0066\u0066\u0030\u0030","\u0030\u0030\u0030\u0030\u0066\u0066","\u0066\u0066\u0066\u0066\u0030\u0030","\u0066\u0066\u0030\u0030\u0066\u0066","\u0030\u0030\u0066\u0066\u0066\u0066","\u0030\u0030\u0030\u0030\u0030\u0030","\u0066\u0066\u0066\u0066\u0066\u0066","\u0066\u0066\u0030\u0030\u0030\u0030","\u0030\u0030\u0066\u0066\u0030\u0030","\u0030\u0030\u0030\u0030\u0066\u0066","\u0066\u0066\u0066\u0066\u0030\u0030","\u0066\u0066\u0030\u0030\u0066\u0066","\u0030\u0030\u0066\u0066\u0066\u0066","\u0038\u0030\u0030\u0030\u0030\u0030","\u0030\u0030\u0038\u0030\u0030\u0030","\u0030\u0030\u0030\u0030\u0038\u0030","\u0038\u0030\u0038\u0030\u0030\u0030","\u0038\u0030\u0030\u0030\u0038\u0030","\u0030\u0030\u0038\u0030\u0038\u0030","\u0063\u0030\u0063\u0030\u0063\u0030","\u0038\u0030\u0038\u0030\u0038\u0030","\u0039\u0039\u0039\u0039\u0066\u0066","\u0039\u0039\u0033\u0033\u0036\u0036","\u0066\u0066\u0066\u0066\u0063\u0063","\u0063\u0063\u0066\u0066\u0066\u0066","\u0036\u0036\u0030\u0030\u0036\u0036","\u0066\u0066\u0038\u0030\u0038\u0030","\u0030\u0030\u0036\u0036\u0063\u0063","\u0063\u0063\u0063\u0063\u0066\u0066","\u0030\u0030\u0030\u0030\u0038\u0030","\u0066\u0066\u0030\u0030\u0066\u0066","\u0066\u0066\u0066\u0066\u0030\u0030","\u0030\u0030\u0066\u0066\u0066\u0066","\u0038\u0030\u0030\u0030\u0038\u0030","\u0038\u0030\u0030\u0030\u0030\u0030","\u0030\u0030\u0038\u0030\u0038\u0030","\u0030\u0030\u0030\u0030\u0066\u0066","\u0030\u0030\u0063\u0063\u0066\u0066","\u0063\u0063\u0066\u0066\u0066\u0066","\u0063\u0063\u0066\u0066\u0063\u0063","\u0066\u0066\u0066\u0066\u0039\u0039","\u0039\u0039\u0063\u0063\u0066\u0066","\u0066\u0066\u0039\u0039\u0063\u0063","\u0063\u0063\u0039\u0039\u0066\u0066","\u0066\u0066\u0063\u0063\u0039\u0039","\u0033\u0033\u0036\u0036\u0066\u0066","\u0033\u0033\u0063\u0063\u0063\u0063","\u0039\u0039\u0063\u0063\u0030\u0030","\u0066\u0066\u0063\u0063\u0030\u0030","\u0066\u0066\u0039\u0039\u0030\u0030","\u0066\u0066\u0036\u0036\u0030\u0030","\u0036\u0036\u0036\u0036\u0039\u0039","\u0039\u0036\u0039\u0036\u0039\u0036","\u0030\u0030\u0033\u0033\u0036\u0036","\u0033\u0033\u0039\u0039\u0036\u0036","\u0030\u0030\u0033\u0033\u0030\u0030","\u0033\u0033\u0033\u0033\u0030\u0030","\u0039\u0039\u0033\u0033\u0030\u0030","\u0039\u0039\u0033\u0033\u0036\u0036","\u0033\u0033\u0033\u0033\u0039\u0039","\u0033\u0033\u0033\u0033\u0033\u0033"};var _acd =_eea (0.0625);func (_bbea *convertContext )getImage (_gcb _g .Image ,_eda ,_bfbd ,_dfa ,_bgb ,_cbab ,_faac float64 ,_ecbf _bf .ImgPart )*_c .Image {_bgb +=_bbea ._egfda ;_dfa +=_bbea ._bbgd ;_agg ,_dbbe :=_bf .GetImage (_bbea ._bafg ,_gcb ,_eda ,_bfbd ,_dfa ,_bgb ,_cbab ,_faac ,_ecbf );if _dbbe !=nil {_bc .Log .Debug ("\u0043\u0061\u006eno\u0074\u0020\u0067\u0065\u0074\u0020\u0061\u006e\u0020\u0069\u006d\u0061\u0067\u0065\u003a\u0020\u0025\u0073",_dbbe );return nil ;};return _agg ;};

// RegisterFontsFromDirectory registers all fonts from the given directory automatically detecting font families and styles.
func RegisterFontsFromDirectory (dirName string )error {return _bf .RegisterFontsFromDirectory (dirName )};const _gc =1.5;