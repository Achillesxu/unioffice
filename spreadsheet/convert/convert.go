//
// Copyright 2020 FoxyUtils ehf. All rights reserved.
//
// This is a commercial product and requires a license to operate.
// A trial license can be obtained at https://unidoc.io
//
// DO NOT EDIT: generated by unitwist Go source code obfuscator.
//
// Use of this source code is governed by the UniDoc End User License Agreement
// terms that can be accessed at https://unidoc.io/eula/

package convert ;import (_a "github.com/unidoc/unioffice/common/logger";_b "github.com/unidoc/unioffice/common/tempstorage";_gd "github.com/unidoc/unioffice/internal/convertutils";_cg "github.com/unidoc/unioffice/measurement";_ad "github.com/unidoc/unioffice/schema/soo/dml";_dc "github.com/unidoc/unioffice/schema/soo/dml/chart";_cf "github.com/unidoc/unioffice/schema/soo/ofc/sharedTypes";_eb "github.com/unidoc/unioffice/schema/soo/sml";_dd "github.com/unidoc/unioffice/spreadsheet";_dg "github.com/unidoc/unioffice/spreadsheet/reference";_c "github.com/unidoc/unipdf/v3/creator";_f "github.com/unidoc/unipdf/v3/model";_d "image";_e "strconv";);func (_afeac *convertContext )makeCells (){_fda :=_afeac ._cbg ;_aad :=_fda .Rows ();_fcde :=0;for _ ,_gga :=range _afeac ._caca {_gga ._faeb =[]*cell {};_eec :=0.0;_eba :=_gga ._dbfae ;if _gga ._fga {_cgf :=_aad [_fcde ];_fcde ++;_deee :=_gga ._eebd ;for _ ,_gba :=range _cgf .Cells (){_agff ,_bca :=_dg .ParseCellReference (_gba .Reference ());if _bca !=nil {_a .Log .Debug ("\u0043\u0061\u006e\u006eo\u0074\u0020\u0070\u0061\u0072\u0073\u0065\u0020\u0061\u0020r\u0065f\u0065\u0072\u0065\u006e\u0063\u0065\u003a \u0025\u0073",_bca );continue ;};_deg :=_afeac ._gedb [_agff .ColumnIdx ];_cfa :=_deg ._ebad ;_ed :=_cfa ;_ffe :=_deg ._fcba ;var _ece ,_fec ,_aef ,_fce bool ;for _ ,_cfbc :=range _afeac ._abf {if _agff .RowIdx >=_cfbc ._ecab &&_agff .RowIdx <=_cfbc ._acbc &&_agff .ColumnIdx >=_cfbc ._ggcbe &&_agff .ColumnIdx <=_cfbc ._cbdg {if _agff .ColumnIdx ==_cfbc ._ggcbe &&_agff .RowIdx ==_cfbc ._ecab {_cfa =_cfbc ._fdgf ;_deee =_cfbc ._gcc ;};_ece =_agff .RowIdx !=_cfbc ._ecab ;_fec =_agff .RowIdx !=_cfbc ._acbc ;_aef =_agff .ColumnIdx !=_cfbc ._ggcbe ;_fce =_agff .ColumnIdx !=_cfbc ._cbdg ;};};_efg :=_afeac .getStyleFromCell (_gba ,_eba ,_ffe );var _cded ,_cb ,_dbf bool ;var _acg ,_affc ,_efaf ,_fac *border ;var _aca _eb .ST_VerticalAlignment ;var _ge _eb .ST_HorizontalAlignment ;if _efg !=nil {if !_ece {_acg =_efg ._ccc ;};if !_fec {_affc =_efg ._dcd ;};if !_aef {_efaf =_efg ._cgg ;};if !_fce {_fac =_efg ._cdb ;};if _affc !=nil &&_affc ._gegf > _eec {_eec =_affc ._gegf ;};_aca =_efg ._adca ;_ge =_efg ._bgcf ;if _efg ._feea !=nil {_cded =*_efg ._feea ;};if _efg ._efff !=nil {_cb =*_efg ._efff ;};_dbf =_efg ._daag ;};_cae ,_caa :=_afeac .getContentFromCell (_gba ,_efg ,_cfa ,_dbf );_cc :=&cell {_gabg :_caa ,_abcf :_cfa ,_ebgb :_ed ,_cbgc :_deee ,_afeb :_cae ,_ggfe :_acg ,_cefg :_affc ,_eeeb :_efaf ,_adfcc :_fac ,_cefa :_cded ,_ffee :_cb };_afeac .alignSymbolsHorizontally (_cc ,_ge );_afeac .alignSymbolsVertically (_cc ,_aca );_gga ._faeb =append (_gga ._faeb ,_cc );};};_gga ._cadc =_eec ;};};var _cfb =_gbfc (0.0625);type border struct{_gegf float64 ;_efc _c .Color ;};func _acd (_acda []*symbol )float64 {_agbf :=0.0;for _ ,_acdb :=range _acda {_agbf +=_acdb ._gdd ;};return _agbf ;};func (_dedb *convertContext )getColorStringFromSmlColor (_degf *_eb .CT_Color )*string {var _gae string ;if _degf .RgbAttr !=nil {_gae =*_degf .RgbAttr ;}else if _degf .IndexedAttr !=nil &&*_degf .IndexedAttr < 64{_gae =_cbcd [*_degf .IndexedAttr ];}else if _degf .ThemeAttr !=nil {_acaad :=*_degf .ThemeAttr ;_gae =_dedb .getColorFromTheme (_acaad );};if _gae ==""{return nil ;};if len (_gae )> 6{_gae =_gae [(len (_gae )-6):];};if _degf .TintAttr !=nil {_egacg :=*_degf .TintAttr ;_gae =_gd .AdjustColorByTint (_gae ,_egacg );};_gae ="\u0023"+_gae ;return &_gae ;};func _gbfc (_ebb float64 )float64 {return _ebb *_cg .Millimeter };func (_adcd *convertContext )getSymbolsFromR (_dfg []*_eb .CT_RElt ,_abgd *style )[]*symbol {_eda :=[]*symbol {};for _ ,_ceff :=range _dfg {_fab :=_adcd .combineCellStyleWithRPrElt (_abgd ,_ceff .RPr );for _ ,_dbb :=range _ceff .T {_eda =append (_eda ,&symbol {_gff :string (_dbb ),_eab :_adcd .makeTextStyleFromCellStyle (_fab )});};};return _eda ;};type rowspan struct{_adga float64 ;_daaa int ;_cab int ;};func (_ffeb *convertContext )getContentFromCell (_eed _dd .Cell ,_eae *style ,_cac float64 ,_gbf bool )([]*line ,_eb .ST_CellType ){_dbeg :=_eed .X ();var _fgf []*symbol ;switch _dbeg .TAttr {case _eb .ST_CellTypeS :_cfab :=_dbeg .V ;if _cfab !=nil {_aaa ,_agd :=_e .Atoi (*_cfab );if _agd ==nil {_egeb :=_ffeb ._cgfe .SharedStrings .X ().Si [_aaa ];if _egeb .T !=nil {_fgf =_ffeb .getSymbolsFromString (*_egeb .T ,_eae );}else if _egeb .R !=nil {_fgf =_ffeb .getSymbolsFromR (_egeb .R ,_eae );};};};case _eb .ST_CellTypeB :_aebd :=_dbeg .V ;if _aebd !=nil {if *_aebd =="\u0030"{_fgf =_ffeb .getSymbolsFromString ("\u0046\u0041\u004cS\u0045",_eae );}else {_fgf =_ffeb .getSymbolsFromString ("\u0054\u0052\u0055\u0045",_eae );};};default:_fgf =_ffeb .getSymbolsFromString (_eed .GetFormattedValue (),_eae );};_ggcb :=0.0;_gee :=0.0;var _dcc []*line ;var _fae bool ;if _eae !=nil {if _eae ._feea !=nil {if *_eae ._feea {_fae =true ;};};if _eae ._efff !=nil {if *_eae ._efff {_fae =true ;};};};if _gbf {_dcc =[]*line {};_ecfg :=_cac -2*_af ;_feeg :=[]*symbol {};for _ ,_fde :=range _fgf {_cdd (_fde );if _ggcb +_fde ._gdd >=_ecfg {_gcb :=_ffa (_feeg );if _fae {_gcb /=_ca ;};_dcc =append (_dcc ,&line {_fabb :_gee ,_ececa :_feeg ,_bdef :_gcb });_feeg =[]*symbol {_fde };_ggcb =_fde ._gdd ;_gee +=_gcb ;}else {_fde ._ddgdf =_ggcb ;_ggcb +=_fde ._gdd ;_feeg =append (_feeg ,_fde );};};_egd :=_ffa (_feeg );if _fae {_egd /=_ca ;};if len (_feeg )> 0{_dcc =append (_dcc ,&line {_fabb :_gee ,_ececa :_feeg ,_bdef :_egd });};}else {for _ ,_cgce :=range _fgf {_cdd (_cgce );_cgce ._ddgdf =_ggcb ;_ggcb +=_cgce ._gdd ;};if len (_fgf )> 0{_dcc =[]*line {&line {_ececa :_fgf ,_bdef :_ffa (_fgf )}};};};_adg :=_dbeg .TAttr ;if _adg ==_eb .ST_CellTypeUnset {_adg =_eb .ST_CellTypeN ;};return _dcc ,_adg ;};const (FontStyle_Regular FontStyle =0;FontStyle_Bold FontStyle =1;FontStyle_Italic FontStyle =2;FontStyle_BoldItalic FontStyle =3;);func (_ececbg *convertContext )getStyleFromRPrElt (_adggc *_eb .CT_RPrElt )*style {if _adggc ==nil {return nil ;};_fbca :=&style {};_fbca ._fgfb =&_adggc .RFont .ValAttr ;if _aegf :=_adggc .B ;_aegf !=nil {_gebg :=_aegf .ValAttr ==nil ||*_aegf .ValAttr ;_fbca ._bde =&_gebg ;};if _cede :=_adggc .I ;_cede !=nil {_acba :=_cede .ValAttr ==nil ||*_cede .ValAttr ;_fbca ._ced =&_acba ;};if _cdeg :=_adggc .U ;_cdeg !=nil {_begc :=_cdeg .ValAttr ==_eb .ST_UnderlineValuesSingle ||_cdeg .ValAttr ==_eb .ST_UnderlineValuesUnset ;_fbca ._eccd =&_begc ;};if _fdfe :=_adggc .VertAlign ;_fdfe !=nil {_cee :=_fdfe .ValAttr ==_cf .ST_VerticalAlignRunSuperscript ;_fbca ._feea =&_cee ;_dafd :=_fdfe .ValAttr ==_cf .ST_VerticalAlignRunSubscript ;_fbca ._efff =&_dafd ;};if _cfbe :=_adggc .Sz ;_cfbe !=nil {_afbcd :=_cfbe .ValAttr /12*_gd .DefaultFontSize ;_fbca ._cfbbd =&_afbcd ;};if _fef :=_adggc .Color ;_fef !=nil {_fbca ._bbae =_ececbg .getColorStringFromSmlColor (_fef );};return _fbca ;};const _af =3;func (_bebg *convertContext )addRowToPage (_ea []*cell ,_dec int ){_geb :=0.0;_ffea :=_bebg ._ececb ;for _ ,_ege :=range _ea {if len (_ege ._afeb )!=0{_ege ._cfgc =_geb ;_geb =_ege ._edd +_ege ._abcf ;};};for _bce :=len (_ea )-1;_bce >=0;_bce --{_eca :=_ea [_bce ];if len (_eca ._afeb )!=0{_eca ._egef =_ffea ;_ffea =_eca ._edd ;};};_bebg ._dcb ._aae =append (_bebg ._dcb ._aae ,&pageRow {_abgdf :_dec ,_egec :_ea });};var _bgef =map[uint32 ]_c .PageSize {1:_c .PageSize {8.5*_cg .Inch ,11*_cg .Inch },2:_c .PageSize {8.5*_cg .Inch ,11*_cg .Inch },3:_c .PageSize {11*_cg .Inch ,17*_cg .Inch },4:_c .PageSize {17*_cg .Inch ,11*_cg .Inch },5:_c .PageSize {8.5*_cg .Inch ,14*_cg .Inch },6:_c .PageSize {5.5*_cg .Inch ,8.5*_cg .Inch },7:_c .PageSize {7.5*_cg .Inch ,10*_cg .Inch },8:_c .PageSize {_gbfc (297),_gbfc (420)},9:_c .PageSize {_gbfc (210),_gbfc (297)},10:_c .PageSize {_gbfc (210),_gbfc (297)},11:_c .PageSize {_gbfc (148),_gbfc (210)},70:_c .PageSize {_gbfc (105),_gbfc (148)},12:_c .PageSize {_gbfc (250),_gbfc (354)},13:_c .PageSize {_gbfc (182),_gbfc (257)},14:_c .PageSize {8.5*_cg .Inch ,13*_cg .Inch },20:_c .PageSize {4.125*_cg .Inch ,9.5*_cg .Inch },27:_c .PageSize {_gbfc (110),_gbfc (220)},28:_c .PageSize {_gbfc (162),_gbfc (229)},34:_c .PageSize {_gbfc (250),_gbfc (176)},29:_c .PageSize {_gbfc (324),_gbfc (458)},30:_c .PageSize {_gbfc (229),_gbfc (324)},31:_c .PageSize {_gbfc (114),_gbfc (162)},37:_c .PageSize {3.88*_cg .Inch ,7.5*_cg .Inch },43:_c .PageSize {_gbfc (100),_gbfc (148)},69:_c .PageSize {_gbfc (200),_gbfc (148)}};func (_aac *convertContext )fillPages (){for _affa ,_afg :=range _aac ._ebce {_cbd :=_aac ._caca [_afg ._daaa :_afg ._cab ];for _ace ,_bfd :=range _cbd {_dfc :=0;_eff :=0.0;_bbb :=[]*cell {};if _bfd ._fga {for _ ,_dade :=range _bfd ._faeb {_bge :=_aac ._gafe [_dfc ];_aac ._dcb =_bge ._bdfe [_affa ];_aac ._dcb ._ffd =true ;_dde :=_dade ._ebgb ;if _eff +_dde > _bge ._cfbb {_aac .addRowToPage (_bbb ,_ace );_bbb =[]*cell {_dade };_eff =_dde ;_dfc ++;}else {_dade ._edd =_eff ;_bbb =append (_bbb ,_dade );_eff +=_dde ;};};if len (_bbb )> 0{_adce :=_aac ._gafe [_dfc ];_aac ._dcb =_adce ._bdfe [_affa ];_aac ._dcb ._ffd =true ;_aac .addRowToPage (_bbb ,_ace );};};};};};type colInfo struct{_ddga float64 ;_ebad float64 ;_fcba *style ;};func (_bdge *convertContext )makePagespans (){_bdge ._gafe =[]*pagespan {};_bgc :=0.0;_fed :=0;for _fcce ,_dbe :=range _bdge ._gedb {_cge :=_dbe ._ebad ;if _bgc +_cge <=_bdge ._ececb {_dbe ._ddga =_bgc ;_bgc +=_cge ;}else {_dbe ._ddga =0;_bdge ._gafe =append (_bdge ._gafe ,&pagespan {_cfbb :_bgc ,_dcad :_fed ,_fgfc :_fcce });_bgc =_cge ;_fed =_fcce ;};};_bdge ._gafe =append (_bdge ._gafe ,&pagespan {_cfbb :_bgc ,_dcad :_fed ,_fgfc :len (_bdge ._gedb )});};func (_bebgg *convertContext )alignSymbolsHorizontally (_eeb *cell ,_gbfd _eb .ST_HorizontalAlignment ){if _gbfd ==_eb .ST_HorizontalAlignmentUnset {switch _eeb ._gabg {case _eb .ST_CellTypeB :_gbfd =_eb .ST_HorizontalAlignmentCenter ;case _eb .ST_CellTypeN :_gbfd =_eb .ST_HorizontalAlignmentRight ;default:_gbfd =_eb .ST_HorizontalAlignmentLeft ;};};var _acaa float64 ;for _ ,_eeed :=range _eeb ._afeb {switch _gbfd {case _eb .ST_HorizontalAlignmentLeft :_acaa =_af ;case _eb .ST_HorizontalAlignmentRight :_edf :=_acd (_eeed ._ececa );_acaa =_eeb ._abcf -_af -_edf ;case _eb .ST_HorizontalAlignmentCenter :_aade :=_acd (_eeed ._ececa );_acaa =(_eeb ._abcf -_aade )/2;};for _ ,_fea :=range _eeed ._ececa {_fea ._ddgdf +=_acaa ;};};};var _fg =3.025/_gbfc (1);type rowInfo struct{_gbe float64 ;_fga bool ;_eebd float64 ;_dbfae *style ;_faeb []*cell ;_cadc float64 ;};func (_edfa *convertContext )makeTextStyleFromCellStyle (_adgab *style )*_c .TextStyle {_dcdg :=_edfa ._beg .NewTextStyle ();if _adgab ==nil {_dcdg .FontSize =_gd .DefaultFontSize ;_dcdg .Font =_gd .AssignStdFontByName (_dcdg ,_gd .StdFontsMap ["\u0064e\u0066\u0061\u0075\u006c\u0074"][FontStyle_Regular ]);return &_dcdg ;};if _gag (_adgab ._eccd ){_dcdg .Underline =true ;_dcdg .UnderlineStyle =_c .TextDecorationLineStyle {Offset :0.5,Thickness :_gbfc (1/32)};};var _edbe FontStyle ;if _gag (_adgab ._bde )&&_gag (_adgab ._ced ){_edbe =FontStyle_BoldItalic ;}else if _gag (_adgab ._bde ){_edbe =FontStyle_Bold ;}else if _gag (_adgab ._ced ){_edbe =FontStyle_Italic ;}else {_edbe =FontStyle_Regular ;};_bfg :="\u0064e\u0066\u0061\u0075\u006c\u0074";if _adgab ._fgfb !=nil {_bfg =*_adgab ._fgfb ;};if _adb ,_bfe :=_gd .StdFontsMap [_bfg ];_bfe {_dcdg .Font =_gd .AssignStdFontByName (_dcdg ,_adb [_edbe ]);}else if _bgb :=_gd .GetRegisteredFont (_bfg ,_edbe );_bgb !=nil {_dcdg .Font =_bgb ;}else {_a .Log .Debug ("\u0046\u006f\u006e\u0074\u0020\u0025\u0073\u0020\u0077\u0069\u0074h\u0020\u0073\u0074\u0079\u006c\u0065\u0020\u0025s\u0020i\u0073\u0020\u006e\u006f\u0074\u0020\u0066\u006f\u0075\u006e\u0064\u002c\u0020\u0072\u0065\u0073\u0065\u0074 \u0074\u006f\u0020\u0064\u0065\u0066\u0061\u0075\u006c\u0074\u002e",_bfg ,_edbe );_dcdg .Font =_gd .AssignStdFontByName (_dcdg ,_gd .StdFontsMap ["\u0064e\u0066\u0061\u0075\u006c\u0074"][_edbe ]);};if _adgab ._cfbbd !=nil {_dcdg .FontSize =*_adgab ._cfbbd ;};if _adgab ._bbae !=nil {_dcdg .Color =_c .ColorRGBFromHex (*_adgab ._bbae );};if _adgab ._feea !=nil &&*_adgab ._feea {_dcdg .FontSize *=_ca ;}else if _adgab ._efff !=nil &&*_adgab ._efff {_dcdg .FontSize *=_ca ;};return &_dcdg ;};const _ca =0.64;func (_fff *convertContext )makeAnchors (){_fcc ,_ada :=_fff ._cbg .GetDrawing ();if _fcc !=nil {for _ ,_ecf :=range _fcc .EG_Anchor {_de :=&anchor {};if _afe :=_ecf .TwoCellAnchor ;_afe !=nil {_fd ,_ae :=_afe .From ,_afe .To ;if _fd ==nil ||_ae ==nil {return ;};_de ._bgg =int (_fd .Row );_de ._dbg =_gd .FromSTCoordinate (_fd .RowOff );_de ._fgc =int (_fd .Col );_de ._egac =_gd .FromSTCoordinate (_fd .ColOff );_de ._afga =int (_ae .Row );_de ._bee =_gd .FromSTCoordinate (_ae .RowOff );_de ._eebb =int (_ae .Col );_de ._dagc =_gd .FromSTCoordinate (_ae .ColOff );if _bdb :=_afe .Choice ;_bdb !=nil {if _bf :=_bdb .Pic ;_bf !=nil {if _fa :=_bf .BlipFill ;_fa !=nil {if _ac :=_fa .Blip ;_ac !=nil {if _afea :=_ac .EmbedAttr ;_afea !=nil {for _ ,_dfe :=range _ada .X ().Relationship {if _dfe .IdAttr ==*_afea {for _ ,_aff :=range _fff ._cgfe .Images {if _aff .Target ()==_dfe .TargetAttr {_daa ,_deb :=_b .Open (_aff .Path ());if _deb !=nil {_a .Log .Debug ("\u004fp\u0065\u006e\u0020\u0069m\u0061\u0067\u0065\u0020\u0066i\u006ce\u0020e\u0072\u0072\u006f\u0072\u003a\u0020\u0025s",_deb );continue ;};_gg ,_ ,_deb :=_d .Decode (_daa );if _deb !=nil {_a .Log .Debug ("\u0044\u0065\u0063\u006fde\u0020\u0069\u006d\u0061\u0067\u0065\u0020\u0065\u0072\u0072\u006f\u0072\u003a\u0020%\u0073",_deb );continue ;};_de ._cfcd =_gg ;};};};};};};};}else if _fe :=_bdb .GraphicFrame ;_fe !=nil {if _eg :=_fe .Graphic ;_eg !=nil {if _dfd :=_eg .GraphicData ;_dfd !=nil {for _ ,_ag :=range _dfd .Any {if _fdg ,_fdf :=_ag .(*_dc .Chart );_fdf {for _ ,_agf :=range _ada .X ().Relationship {if _agf .IdAttr ==_fdg .IdAttr {_aea :=_fff ._cgfe .GetChartByTargetId (_agf .TargetAttr );if _aea !=nil {_de ._caag =_aea ;};};};};};};};};};};if _de ._cfcd !=nil ||_de ._caag !=nil {_fff ._baac =append (_fff ._baac ,_de );};};};};func _ffa (_adcg []*symbol )float64 {_agdg :=0.0;for _ ,_acbb :=range _adcg {if _acbb ._fcdc > _agdg {_agdg =_acbb ._fcdc ;};};return _agdg ;};type pageRow struct{_abgdf int ;_egec []*cell ;};func (_fbe *convertContext )makeRows (){_adf :=[]*rowInfo {};_eef :=_fbe ._cbg .Rows ();_ecc :=0;for _ ,_gaf :=range _eef {_ecc ++;_adaf :=int (_gaf .RowNumber ());if _adaf > _ecc {for _efa :=_ecc ;_efa < _adaf ;_efa ++{_adf =append (_adf ,&rowInfo {_eebd :16/_fg });};_ecc =_adaf ;};var _gbd float64 ;if _gaf .X ().HtAttr ==nil {_gbd =16;}else {_gbd =*_gaf .X ().HtAttr ;};_adf =append (_adf ,&rowInfo {_eebd :_gbd /_fg ,_fga :true ,_dbfae :_fbe .getStyle (_gaf .X ().SAttr )});};for _bgd :=len (_adf );_bgd < _fbe ._aed ;_bgd ++{_adf =append (_adf ,&rowInfo {_eebd :16/_fg });};_fbe ._caca =_adf ;};type page struct{_aae []*pageRow ;_ffd bool ;_fbef []*_c .Image ;_bebd *pagespan ;_ecaa *rowspan ;};func (_fcea *convertContext )makeRowspans (){var _dfeb float64 ;_ade :=0;for _bga ,_fcb :=range _fcea ._caca {_egc :=_fcb ._eebd +_fcb ._cadc ;if _dfeb +_egc <=_fcea ._bacd {_fcb ._gbe =_dfeb ;_dfeb +=_egc ;}else {_fcea ._ebce =append (_fcea ._ebce ,&rowspan {_adga :_dfeb ,_daaa :_ade ,_cab :_bga });_ade =_bga ;_fcb ._gbe =0;_dfeb =_egc ;};};_fcea ._ebce =append (_fcea ._ebce ,&rowspan {_adga :_dfeb ,_daaa :_ade ,_cab :len (_fcea ._caca )});};

// RegisterFont makes a PdfFont accessible for using in converting to PDF.
func RegisterFont (name string ,style FontStyle ,font *_f .PdfFont ){_gd .RegisterFont (name ,style ,font );};func (_cacf *convertContext )getSymbolsFromString (_dgc string ,_abgf *style )[]*symbol {_cbdc :=[]*symbol {};_defe :=_cacf .makeTextStyleFromCellStyle (_abgf );for _ ,_dbfa :=range _dgc {_cbdc =append (_cbdc ,&symbol {_gff :string (_dbfa ),_eab :_defe });};return _cbdc ;};type line struct{_fabb float64 ;_ececa []*symbol ;_bdef float64 ;};func (_daf *convertContext )determineMaxIndexes (){var _bdc ,_fb int ;_bdc =int (_daf ._cbg .MaxColumnIdx ());_cadag :=_daf ._cbg .Rows ();if len (_cadag )> 0{_fb =int (_cadag [len (_cadag )-1].RowNumber ());};for _ ,_abb :=range _daf ._baac {if _abb ._afga >=_fb {_fb =_abb ._afga +1;};if _abb ._eebb >=_bdc {_bdc =_abb ._eebb +1;};};_daf ._aed =_fb ;_daf ._adgg =_bdc ;};func (_cfcf *convertContext )getStyleFromCell (_gfe _dd .Cell ,_afd ,_bgcd *style )*style {_gdg :=_gfe .X ();_efag :=_cfcf .getStyle (_gdg .SAttr );_acf (_efag ,_afd );_acf (_efag ,_bgcd );return _efag ;};type style struct{_bbae *string ;_cfbbd *float64 ;_fgfb *string ;_bde *bool ;_ced *bool ;_eccd *bool ;_feea *bool ;_efff *bool ;_ccc *border ;_dcd *border ;_cgg *border ;_cdb *border ;_daag bool ;_adca _eb .ST_VerticalAlignment ;_bgcf _eb .ST_HorizontalAlignment ;};const _bd =1.5;type pagespan struct{_cfbb float64 ;_bdfe []*page ;_dcad int ;_fgfc int ;};type cell struct{_gabg _eb .ST_CellType ;_bbd int ;_edd float64 ;_afeb []*line ;_abcf float64 ;_ebgb float64 ;_cbgc float64 ;_cfgc float64 ;_egef float64 ;_dfbf *_c .TextStyle ;_ggfe *border ;_cefg *border ;_eeeb *border ;_adfcc *border ;_cefa bool ;_ffee bool ;};func (_ffb *convertContext )getImage (_eceb _d .Image ,_adfd ,_bae ,_fad ,_dbcc ,_dbed ,_bcaa float64 ,_bfb _gd .ImgPart )*_c .Image {_dbcc +=_ffb ._deef ;_fad +=_ffb ._bbafg ;_efd ,_egge :=_gd .GetImage (_ffb ._beg ,_eceb ,_adfd ,_bae ,_fad ,_dbcc ,_dbed ,_bcaa ,_bfb );if _egge !=nil {_a .Log .Debug ("\u0043\u0061\u006eno\u0074\u0020\u0067\u0065\u0074\u0020\u0061\u006e\u0020\u0069\u006d\u0061\u0067\u0065\u003a\u0020\u0025\u0073",_egge );return nil ;};return _efd ;};type anchor struct{_cfcd _d .Image ;_caag *_dc .ChartSpace ;_bgg int ;_dbg int64 ;_fgc int ;_egac int64 ;_afga int ;_bee int64 ;_eebb int ;_dagc int64 ;};func (_fdfb *convertContext )makePages (){for _ ,_caef :=range _fdfb ._gafe {for _ ,_ggf :=range _fdfb ._ebce {_caef ._bdfe =append (_caef ._bdfe ,&page {_aae :[]*pageRow {},_bebd :_caef ,_ecaa :_ggf });};};};

// ConvertToPdf converts a sheet to a PDF file. This package is beta, breaking changes can take place.
func ConvertToPdf (s *_dd .Sheet )*_c .Creator {_fc :=s .X ();if _fc ==nil {return nil ;};var _ddf _c .PageSize ;var _ab bool ;if _ddfd :=_fc .PageSetup ;_ddfd !=nil {if _cad :=_ddfd .PaperSizeAttr ;_cad !=nil {_ddf =_bgef [*_cad ];};_ab =_ddfd .OrientationAttr ==_eb .ST_OrientationLandscape ;};if (_ddf ==_c .PageSize {}){_ddf =_bgef [1];};if _ab {_ddf [0],_ddf [1]=_ddf [1],_ddf [0];};_ff :=_c .New ();_ff .SetPageSize (_ddf );var _fcd ,_cd ,_cde ,_df float64 ;if _fcf :=_fc .PageMargins ;_fcf !=nil {_cde =_fcf .LeftAttr ;_df =_fcf .RightAttr ;_fcd =_fcf .TopAttr ;_cd =_fcf .BottomAttr ;};if _cde < 0.25{_cde =0.25;};if _df < 0.25{_df =0.25;};_fcd *=_cg .Inch ;_cd *=_cg .Inch ;_cde *=_cg .Inch ;_df *=_cg .Inch ;_ff .SetPageMargins (_cde ,_df ,_fcd ,_cd );_cada :=s .Workbook ();var _da *_ad .Theme ;if len (_cada .Themes ())> 0{_da =_cada .Themes ()[0];};_ec :=&convertContext {_beg :_ff ,_cbg :s ,_cgfe :s .Workbook (),_edab :_da ,_egea :&s .Workbook ().StyleSheet ,_deef :_fcd ,_bbafg :_cde ,_bacd :_ddf [1]-_cd -_fcd ,_ececb :_ddf [0]-_df -_cde };_ec .makeAnchors ();_ec .determineMaxIndexes ();if _ec ._aed ==0&&_ec ._adgg ==0{_ff .NewPage ();return _ff ;};_ec .makeCols ();_ec .makeRows ();_ec .makeMergedCells ();_ec .makeCells ();_ec .makePagespans ();_ec .makeRowspans ();_ec .makePages ();_ec .fillPages ();_ec .distributeAnchors ();_ec .drawSheet ();return _ff ;};func (_fecc *convertContext )drawSheet (){for _affbf ,_fbab :=range _fecc ._gafe {_gac :=len (_fbab ._bdfe );if _affbf ==len (_fecc ._gafe )-1{for _geg :=len (_fbab ._bdfe )-1;_geg >=0;_geg --{if !_fbab ._bdfe [_geg ]._ffd {_gac =_geg ;};};};_gbb :=_fbab ._bdfe [:_gac ];for _ ,_efgf :=range _gbb {_fecc ._beg .NewPage ();_fecc .drawPage (_efgf );};};};func (_cgd *convertContext )imageFromAnchor (_ggff *anchor ,_aebb ,_faf float64 )_d .Image {if _ggff ._cfcd !=nil {return _ggff ._cfcd ;};if _ggff ._caag !=nil {_ecdd ,_cegc :=_gd .MakeImageFromChartSpace (_ggff ._caag ,_aebb ,_faf ,_cgd ._edab );if _cegc !=nil {_a .Log .Debug ("C\u0061\u006e\u006e\u006f\u0074\u0020\u006d\u0061\u006b\u0065\u0020\u0061\u006e\u0020\u0069\u006d\u0061\u0067e\u0020\u0066\u0072\u006f\u006d\u0020\u0063\u0068\u0061\u0072tS\u0070\u0061\u0063e\u003a \u0025\u0073",_cegc );return nil ;};return _ecdd ;};return nil ;};func _gag (_affagf *bool )bool {return _affagf !=nil &&*_affagf };

// RegisterFontsFromDirectory registers all fonts from the given directory automatically detecting font families and styles.
func RegisterFontsFromDirectory (dirName string )error {return _gd .RegisterFontsFromDirectory (dirName )};func (_efeb *convertContext )getColorFromTheme (_fbea uint32 )string {_bcg :=_efeb ._cgfe .Themes ();if len (_bcg )!=0{_cdg :=_bcg [0];if _dfgc :=_cdg .ThemeElements ;_dfgc !=nil {if _ccff :=_dfgc .ClrScheme ;_ccff !=nil {switch _fbea {case 0:return _gd .GetColorStringFromDmlColor (_ccff .Lt1 );case 1:return _gd .GetColorStringFromDmlColor (_ccff .Dk1 );case 2:return _gd .GetColorStringFromDmlColor (_ccff .Lt2 );case 3:return _gd .GetColorStringFromDmlColor (_ccff .Dk2 );case 4:return _gd .GetColorStringFromDmlColor (_ccff .Accent1 );case 5:return _gd .GetColorStringFromDmlColor (_ccff .Accent2 );case 6:return _gd .GetColorStringFromDmlColor (_ccff .Accent3 );case 7:return _gd .GetColorStringFromDmlColor (_ccff .Accent4 );case 8:return _gd .GetColorStringFromDmlColor (_ccff .Accent5 );case 9:return _gd .GetColorStringFromDmlColor (_ccff .Accent6 );};};};};return "";};func (_eddd *convertContext )combineCellStyleWithRPrElt (_ebd *style ,_dcf *_eb .CT_RPrElt )*style {_cbf :=*_ebd ;_ebe :=_eddd .getStyleFromRPrElt (_dcf );if _ebe ==nil {return &_cbf ;};if _ebe ._bbae !=nil {_cbf ._bbae =_ebe ._bbae ;};if _ebe ._cfbbd !=nil {_cbf ._cfbbd =_ebe ._cfbbd ;};if _ebe ._fgfb !=nil {_cbf ._fgfb =_ebe ._fgfb ;};if _ebe ._bde !=nil {_cbf ._bde =_ebe ._bde ;};if _ebe ._ced !=nil {_cbf ._ced =_ebe ._ced ;};if _ebe ._eccd !=nil {_cbf ._eccd =_ebe ._eccd ;};if _ebe ._feea !=nil {_cbf ._feea =_ebe ._feea ;};if _ebe ._efff !=nil {_cbf ._efff =_ebe ._efff ;};return &_cbf ;};func _cdd (_bag *symbol ){_fbd :=_c .New ();_baa :=_fbd .NewStyledParagraph ();_baa .SetMargins (0,0,0,0);_adff :=_baa .Append (_bag ._gff );if _bag ._eab !=nil {_adff .Style =*_bag ._eab ;};_bag ._fcdc =_baa .Height ();if _bag ._gdd ==0{_bag ._gdd =_baa .Width ();};};func (_ef *convertContext )makeCols (){_fdgc :=_ef ._cbg ;_bdg :=_fdgc .X ();_bg :=[]*colInfo {};_fge :=[]colWidthRange {};if _ga :=_bdg .Cols ;len (_ga )> 0{for _ ,_adc :=range _ga [0].Col {_gc :=65.0;if _dee :=_adc .WidthAttr ;_dee !=nil {if *_dee > 0.83{*_dee -=0.83;};if *_dee <=1{_gc =*_dee *11;}else {_gc =5+*_dee *6;};};_fdfd :=int (_adc .MinAttr -1);_affb :=int (_adc .MaxAttr -1);_fge =append (_fge ,colWidthRange {_edfc :_fdfd ,_fgae :_affb ,_fgdb :_gc ,_ega :_ef .getStyle (_adc .StyleAttr )});};};_db :=0;for _bgf :=0;_bgf <=_ef ._adgg ;_bgf ++{var _abg float64 ;var _abc *style ;if _db >=len (_fge ){_abg =65;}else {_aeb :=_fge [_db ];if _bgf >=_aeb ._edfc &&_bgf <=_aeb ._fgae {_abg =_aeb ._fgdb ;_abc =_aeb ._ega ;if _bgf ==_aeb ._fgae {_db ++;};}else {_abg =65;};};_bg =append (_bg ,&colInfo {_ebad :_abg ,_fcba :_abc });};_ef ._gedb =_bg ;};const _aa =0.25;func (_agb *convertContext )makeMergedCells (){_eccg :=[]*mergedCell {};for _ ,_fbc :=range _agb ._cbg .MergedCells (){_dad ,_aga ,_cfd :=_dg .ParseRangeReference (_fbc .Reference ());if _cfd !=nil {_a .Log .Debug ("\u0065\u0072r\u006f\u0072\u0020\u0070\u0061\u0072\u0073\u0069\u006e\u0067\u0020\u006d\u0065\u0072\u0067\u0065\u0064\u0020\u0063\u0065\u006c\u006c: \u0025\u0073",_cfd );continue ;};_dafg :=mergedCell {_ecab :_dad .RowIdx ,_ggcbe :_dad .ColumnIdx ,_acbc :_aga .RowIdx ,_cbdg :_aga .ColumnIdx };for _gfc :=_dafg ._ggcbe -1;_gfc < _dafg ._cbdg ;_gfc ++{_dafg ._fdgf +=_agb ._gedb [_gfc ]._ebad ;};for _ggb :=_dafg ._ecab -1;_ggb < _dafg ._acbc ;_ggb ++{_dafg ._gcc +=_agb ._caca [_ggb ]._eebd ;};_eccg =append (_eccg ,&_dafg );};_agb ._abf =_eccg ;};var _ba =_gbfc (1);func _acf (_bdgb ,_aeba *style ){if _aeba ==nil {return ;};if _bdgb ==nil {_bdgb =_aeba ;return ;};if _bdgb ._fgfb ==nil {_bdgb ._fgfb =_aeba ._fgfb ;};if _bdgb ._bbae ==nil {_bdgb ._bbae =_aeba ._bbae ;};if _bdgb ._cfbbd ==nil {_bdgb ._cfbbd =_aeba ._cfbbd ;};if _bdgb ._bde ==nil {_bdgb ._bde =_aeba ._bde ;};if _bdgb ._ced ==nil {_bdgb ._ced =_aeba ._ced ;};if _bdgb ._eccd ==nil {_bdgb ._eccd =_aeba ._eccd ;};if _bdgb ._feea ==nil {_bdgb ._feea =_aeba ._feea ;};if _bdgb ._efff ==nil {_bdgb ._efff =_aeba ._efff ;};if _bdgb ._ccc ==nil {_bdgb ._ccc =_aeba ._ccc ;};if _bdgb ._dcd ==nil {_bdgb ._dcd =_aeba ._dcd ;};if _bdgb ._cgg ==nil {_bdgb ._cgg =_aeba ._cgg ;};if _bdgb ._cdb ==nil {_bdgb ._cdb =_aeba ._cdb ;};if _bdgb ._adca ==_eb .ST_VerticalAlignmentUnset {_bdgb ._adca =_aeba ._adca ;};if _bdgb ._bgcf ==_eb .ST_HorizontalAlignmentUnset {_bdgb ._bgcf =_aeba ._bgcf ;};};

// FontStyle represents a kind of font styling. It can be FontStyle_Regular, FontStyle_Bold, FontStyle_Italic and FontStyle_BoldItalic.
type FontStyle =_gd .FontStyle ;type colWidthRange struct{_edfc int ;_fgae int ;_fgdb float64 ;_ega *style ;};type mergedCell struct{_ecab uint32 ;_ggcbe uint32 ;_acbc uint32 ;_cbdg uint32 ;_fdgf float64 ;_gcc float64 ;};func (_ffef *convertContext )alignSymbolsVertically (_bgce *cell ,_dgb _eb .ST_VerticalAlignment ){var _geab float64 ;switch _dgb {case _eb .ST_VerticalAlignmentTop :_geab =_gf ;if _bgce ._cefa {_geab -=_bd ;}else if _bgce ._ffee {_geab +=4*_bd ;};for _ ,_cfg :=range _bgce ._afeb {_geab +=_cfg ._bdef ;_cfg ._fabb =_geab ;_geab +=_ba ;};case _eb .ST_VerticalAlignmentCenter :_ceaf :=0.0;for _ ,_aaf :=range _bgce ._afeb {_ceaf +=_aaf ._bdef +_gbfc (1);};_geab =0.5*(_bgce ._cbgc -_ceaf );if _bgce ._cefa {_geab -=2*_bd ;}else if _bgce ._ffee {_geab +=2*_bd ;};for _ ,_ggg :=range _bgce ._afeb {_geab +=_ggg ._bdef +0.5*_ba ;_ggg ._fabb =_geab ;_geab +=0.5*_ba ;};default:_geab =_bgce ._cbgc -_gf ;if _bgce ._cefa {_geab -=4*_bd ;}else if _bgce ._ffee {_geab +=_bd ;};for _bfa :=len (_bgce ._afeb )-1;_bfa >=0;_bfa --{_bgce ._afeb [_bfa ]._fabb =_geab ;_geab -=_bgce ._afeb [_bfa ]._bdef ;_geab -=_ba ;};};};func (_ccd *convertContext )drawPage (_defb *page ){_age :=_ccd ._deef ;_cbcb :=_ccd ._bbafg ;for _ ,_fdbb :=range _defb ._aae {_gge :=_ccd ._caca [_fdbb ._abgdf ];for _ ,_dfb :=range _fdbb ._egec {_fcded :=_dfb ._cfgc < _dfb ._edd ;_egce :=_dfb ._egef > _dfb ._edd +_dfb ._abcf ;var _aeg ,_beb bool ;for _ ,_gdaa :=range _dfb ._afeb {for _ ,_ecdf :=range _gdaa ._ececa {if _fcded &&!_aeg {_aeg =_ecdf ._ddgdf < 0;};if _egce &&!_beb {_beb =_dfb ._abcf < _ecdf ._ddgdf +_ecdf ._gdd ;};if _dfb ._edd +_ecdf ._ddgdf >=_dfb ._cfgc &&_dfb ._edd +_ecdf ._ddgdf +_ecdf ._gdd <=_dfb ._egef {_ecec :=_ccd ._beg .NewStyledParagraph ();_ceg :=_cbcb +_dfb ._edd +_ecdf ._ddgdf ;_afbc :=_age +_gge ._gbe +_gdaa ._fabb -_ecdf ._fcdc -_gbfc (0.5);_ecec .SetPos (_ceg ,_afbc );var _fee *_c .TextChunk ;if _ecdf ._cfca !=""{_fee =_ecec .AddExternalLink (_ecdf ._gff ,_ecdf ._cfca );}else {_fee =_ecec .Append (_ecdf ._gff );};if _ecdf ._eab !=nil {_fee .Style =*_ecdf ._eab ;};_ccd ._beg .Draw (_ecec );};};};var _acbd ,_ebgc ,_edbd ,_caf ,_gbbd ,_aadg float64 ;var _ggbe ,_aadf ,_afeg ,_cea _c .Color ;if _ebf :=_dfb ._ggfe ;_ebf !=nil {_acbd =_ebf ._gegf ;_ggbe =_ebf ._efc ;};if _fcbgf :=_dfb ._cefg ;_fcbgf !=nil {_ebgc =_fcbgf ._gegf ;_aadf =_fcbgf ._efc ;};if _cdef :=_dfb ._eeeb ;_cdef !=nil {_edbd =_cdef ._gegf ;_gbbd =_edbd /2;_afeg =_cdef ._efc ;};if _faca :=_dfb ._adfcc ;_faca !=nil {_caf =_faca ._gegf ;_aadg =_caf /2;_cea =_faca ._efc ;};var _bac float64 ;if _fdbb ._abgdf > 1{_bac =_ccd ._caca [_fdbb ._abgdf -1]._cadc ;};_ccf :=_age +_gge ._gbe -0.5*(_bac -_acbd );_dafa :=_age +_gge ._gbe +_gge ._eebd +0.5*(_gge ._cadc +_ebgc );_cda :=_cbcb +_dfb ._edd ;_edc :=_cda +_dfb ._ebgb ;_gd .DrawLine (_ccd ._beg ,_cda ,_ccf ,_edc ,_ccf ,_acbd ,_ggbe );_gd .DrawLine (_ccd ._beg ,_cda ,_dafa ,_edc ,_dafa ,_ebgc ,_aadf );if !_aeg {_gd .DrawLine (_ccd ._beg ,_cda -_gbbd ,_ccf ,_cda -_gbbd ,_dafa ,_edbd ,_afeg );};if !_beb {_gd .DrawLine (_ccd ._beg ,_edc -_aadg ,_ccf ,_edc -_aadg ,_dafa ,_caf ,_cea );};};};for _ ,_geaf :=range _defb ._fbef {if _geaf !=nil {_ccd ._beg .Draw (_geaf );};};};const _gf =2;var _cbcd =[]string {"\u0030\u0030\u0030\u0030\u0030\u0030","\u0066\u0066\u0066\u0066\u0066\u0066","\u0066\u0066\u0030\u0030\u0030\u0030","\u0030\u0030\u0066\u0066\u0030\u0030","\u0030\u0030\u0030\u0030\u0066\u0066","\u0066\u0066\u0066\u0066\u0030\u0030","\u0066\u0066\u0030\u0030\u0066\u0066","\u0030\u0030\u0066\u0066\u0066\u0066","\u0030\u0030\u0030\u0030\u0030\u0030","\u0066\u0066\u0066\u0066\u0066\u0066","\u0066\u0066\u0030\u0030\u0030\u0030","\u0030\u0030\u0066\u0066\u0030\u0030","\u0030\u0030\u0030\u0030\u0066\u0066","\u0066\u0066\u0066\u0066\u0030\u0030","\u0066\u0066\u0030\u0030\u0066\u0066","\u0030\u0030\u0066\u0066\u0066\u0066","\u0038\u0030\u0030\u0030\u0030\u0030","\u0030\u0030\u0038\u0030\u0030\u0030","\u0030\u0030\u0030\u0030\u0038\u0030","\u0038\u0030\u0038\u0030\u0030\u0030","\u0038\u0030\u0030\u0030\u0038\u0030","\u0030\u0030\u0038\u0030\u0038\u0030","\u0063\u0030\u0063\u0030\u0063\u0030","\u0038\u0030\u0038\u0030\u0038\u0030","\u0039\u0039\u0039\u0039\u0066\u0066","\u0039\u0039\u0033\u0033\u0036\u0036","\u0066\u0066\u0066\u0066\u0063\u0063","\u0063\u0063\u0066\u0066\u0066\u0066","\u0036\u0036\u0030\u0030\u0036\u0036","\u0066\u0066\u0038\u0030\u0038\u0030","\u0030\u0030\u0036\u0036\u0063\u0063","\u0063\u0063\u0063\u0063\u0066\u0066","\u0030\u0030\u0030\u0030\u0038\u0030","\u0066\u0066\u0030\u0030\u0066\u0066","\u0066\u0066\u0066\u0066\u0030\u0030","\u0030\u0030\u0066\u0066\u0066\u0066","\u0038\u0030\u0030\u0030\u0038\u0030","\u0038\u0030\u0030\u0030\u0030\u0030","\u0030\u0030\u0038\u0030\u0038\u0030","\u0030\u0030\u0030\u0030\u0066\u0066","\u0030\u0030\u0063\u0063\u0066\u0066","\u0063\u0063\u0066\u0066\u0066\u0066","\u0063\u0063\u0066\u0066\u0063\u0063","\u0066\u0066\u0066\u0066\u0039\u0039","\u0039\u0039\u0063\u0063\u0066\u0066","\u0066\u0066\u0039\u0039\u0063\u0063","\u0063\u0063\u0039\u0039\u0066\u0066","\u0066\u0066\u0063\u0063\u0039\u0039","\u0033\u0033\u0036\u0036\u0066\u0066","\u0033\u0033\u0063\u0063\u0063\u0063","\u0039\u0039\u0063\u0063\u0030\u0030","\u0066\u0066\u0063\u0063\u0030\u0030","\u0066\u0066\u0039\u0039\u0030\u0030","\u0066\u0066\u0036\u0036\u0030\u0030","\u0036\u0036\u0036\u0036\u0039\u0039","\u0039\u0036\u0039\u0036\u0039\u0036","\u0030\u0030\u0033\u0033\u0036\u0036","\u0033\u0033\u0039\u0039\u0036\u0036","\u0030\u0030\u0033\u0033\u0030\u0030","\u0033\u0033\u0033\u0033\u0030\u0030","\u0039\u0039\u0033\u0033\u0030\u0030","\u0039\u0039\u0033\u0033\u0036\u0036","\u0033\u0033\u0033\u0033\u0039\u0039","\u0033\u0033\u0033\u0033\u0033\u0033"};type convertContext struct{_beg *_c .Creator ;_cgfe *_dd .Workbook ;_edab *_ad .Theme ;_cbg *_dd .Sheet ;_egea *_dd .StyleSheet ;_aed int ;_adgg int ;_gafe []*pagespan ;_dcb *page ;_gedb []*colInfo ;_caca []*rowInfo ;_ebce []*rowspan ;_deef float64 ;_bbafg float64 ;_bacd float64 ;_ececb float64 ;_abf []*mergedCell ;_baac []*anchor ;};func (_gaae *convertContext )getBorder (_feb *_eb .CT_BorderPr )*border {_dbedg :=&border {};switch _feb .StyleAttr {case _eb .ST_BorderStyleThin :_dbedg ._gegf =_cfb ;case _eb .ST_BorderStyleMedium :_dbedg ._gegf =_cfb *2;case _eb .ST_BorderStyleThick :_dbedg ._gegf =_cfb *4;};if _dbedg ._gegf ==0.0{return nil ;};if _bebdd :=_feb .Color ;_bebdd !=nil {_bgeb :=_gaae .getColorStringFromSmlColor (_bebdd );if _bgeb !=nil {_dbedg ._efc =_c .ColorRGBFromHex (*_bgeb );}else {_dbedg ._efc =_c .ColorBlack ;};};return _dbedg ;};type symbol struct{_gff string ;_ddgdf float64 ;_fcdc float64 ;_gdd float64 ;_eab *_c .TextStyle ;_cfca string ;};func (_gfceg *convertContext )getStyle (_bcb *uint32 )*style {_gdc :=&style {};_cgfba :=false ;if _bcb !=nil {_efcc :=_gfceg ._egea .GetCellStyle (*_bcb );_egb :=_efcc .GetFont ();for _ ,_fcdd :=range _egb .Name {if _fcdd !=nil {_gdc ._fgfb =&_fcdd .ValAttr ;_cgfba =true ;break ;};};for _ ,_dgfa :=range _egb .B {if _dgfa !=nil {_gafb :=_dgfa .ValAttr ==nil ||*_dgfa .ValAttr ;_gdc ._bde =&_gafb ;_cgfba =true ;break ;};};for _ ,_cacc :=range _egb .I {if _cacc !=nil {_fbacb :=_cacc .ValAttr ==nil ||*_cacc .ValAttr ;_gdc ._ced =&_fbacb ;_cgfba =true ;break ;};};for _ ,_efe :=range _egb .U {if _efe !=nil {_dbgg :=_efe .ValAttr ==_eb .ST_UnderlineValuesSingle ||_efe .ValAttr ==_eb .ST_UnderlineValuesUnset ;_gdc ._eccd =&_dbgg ;_cgfba =true ;break ;};};for _ ,_aeadg :=range _egb .Sz {if _aeadg !=nil {_cedf :=_aeadg .ValAttr /12*_gd .DefaultFontSize ;_gdc ._cfbbd =&_cedf ;_cgfba =true ;break ;};};for _ ,_fgg :=range _egb .VertAlign {if _fgg !=nil {_edad :=_fgg .ValAttr ==_cf .ST_VerticalAlignRunSuperscript ;_gdc ._feea =&_edad ;_bgdf :=_fgg .ValAttr ==_cf .ST_VerticalAlignRunSubscript ;_gdc ._efff =&_bgdf ;_cgfba =true ;break ;};};for _ ,_bef :=range _egb .Color {if _bef !=nil {_gdc ._bbae =_gfceg .getColorStringFromSmlColor (_bef );_cgfba =true ;break ;};};_bbdc :=_efcc .GetBorder ();if _bbdc .Top !=nil {_gdc ._ccc =_gfceg .getBorder (_bbdc .Top );_cgfba =true ;};if _bbdc .Bottom !=nil {_gdc ._dcd =_gfceg .getBorder (_bbdc .Bottom );_cgfba =true ;};if _bbdc .Left !=nil {_gdc ._cgg =_gfceg .getBorder (_bbdc .Left );_cgfba =true ;};if _bbdc .Right !=nil {_gdc ._cdb =_gfceg .getBorder (_bbdc .Right );_cgfba =true ;};if _efcc .Wrapped (){_gdc ._daag =true ;_cgfba =true ;};if _adcb :=_efcc .GetVerticalAlignment ();_adcb !=_eb .ST_VerticalAlignmentUnset {_gdc ._adca =_adcb ;_cgfba =true ;};if _agac :=_efcc .GetHorizontalAlignment ();_agac !=_eb .ST_HorizontalAlignmentUnset {_gdc ._bgcf =_agac ;_cgfba =true ;};};if _cgfba {return _gdc ;};return nil ;};func (_bgdb *convertContext )distributeAnchors (){for _ ,_dca :=range _bgdb ._baac {_cca ,_bgda :=_dca ._bgg ,_dca ._dbg ;_bdf ,_cfad :=_dca ._fgc ,_dca ._egac ;_fdd ,_fcg :=_dca ._afga ,_dca ._bee ;_ded ,_edb :=_dca ._eebb ,_dca ._dagc ;var _ebc ,_gea ,_bbf ,_ddgd *page ;for _ ,_aead :=range _bgdb ._gafe {for _ ,_efb :=range _aead ._bdfe {if _cca >=_efb ._ecaa ._daaa &&_cca < _efb ._ecaa ._cab {if _bdf >=_efb ._bebd ._dcad &&_bdf < _efb ._bebd ._fgfc {_efb ._ffd =true ;_ebc =_efb ;};if _ded >=_efb ._bebd ._dcad &&_ded < _efb ._bebd ._fgfc {_efb ._ffd =true ;_gea =_efb ;};};if _fdd >=_efb ._ecaa ._daaa &&_fdd < _efb ._ecaa ._cab {if _bdf >=_efb ._bebd ._dcad &&_bdf < _efb ._bebd ._fgfc {_efb ._ffd =true ;_ddgd =_efb ;};if _ded >=_efb ._bebd ._dcad &&_ded < _efb ._bebd ._fgfc {_efb ._ffd =true ;_bbf =_efb ;};};};};_adfc :=_ebc !=_gea ;_fdb :=_ebc !=_ddgd ;if _adfc &&_fdb {_feda :=_bgdb ._gedb [_bdf ]._ddga +_cg .FromEMU (_cfad );_fgd :=_ebc ._bebd ._cfbb ;_dag :=_bgdb ._gedb [_ded ]._ddga +_cg .FromEMU (_edb );_ddeg :=_bgdb ._caca [_cca ]._gbe +_cg .FromEMU (_bgda );_cef :=float64 (_ebc ._ecaa ._adga );_bba :=_bgdb ._caca [_fdd ]._gbe +_cg .FromEMU (_fcg );_ggd :=_dag +_fgd -_feda ;_fdgb :=_bba +_cef -_ddeg ;_afb :=_bgdb .imageFromAnchor (_dca ,_ggd ,_fdgb );_ebc ._fbef =append (_ebc ._fbef ,_bgdb .getImage (_afb ,_fdgb ,_ggd ,_feda ,_ddeg ,_fgd -_feda ,_cef -_ddeg ,_gd .ImgPart_lt ));_gea ._fbef =append (_gea ._fbef ,_bgdb .getImage (_afb ,_fdgb ,_ggd ,0,_ddeg ,_fgd -_feda ,_cef -_ddeg ,_gd .ImgPart_rt ));_ddgd ._fbef =append (_ddgd ._fbef ,_bgdb .getImage (_afb ,_fdgb ,_ggd ,_feda ,0,_fgd -_feda ,_cef -_ddeg ,_gd .ImgPart_lb ));_bbf ._fbef =append (_bbf ._fbef ,_bgdb .getImage (_afb ,_fdgb ,_ggd ,0,0,_fgd -_feda ,_cef -_ddeg ,_gd .ImgPart_rb ));}else if _adfc {_gab :=_bgdb ._caca [_cca ]._gbe +_cg .FromEMU (_bgda );_adcc :=_bgdb ._caca [_fdd ]._gbe +_cg .FromEMU (_fcg );_ecdg :=_bgdb ._gedb [_bdf ]._ddga +_cg .FromEMU (_cfad );_gbc :=_ebc ._bebd ._cfbb ;_bdgf :=_bgdb ._gedb [_ded ]._ddga +_cg .FromEMU (_edb );_bgaf :=_bdgf +_gbc -_ecdg ;_ged :=_adcc -_gab ;_cbc :=_bgdb .imageFromAnchor (_dca ,_bgaf ,_ged );_ebc ._fbef =append (_ebc ._fbef ,_bgdb .getImage (_cbc ,_ged ,_bgaf ,_ecdg ,_gab ,_gbc -_ecdg ,0,_gd .ImgPart_l ));_gea ._fbef =append (_gea ._fbef ,_bgdb .getImage (_cbc ,_ged ,_bgaf ,0,_gab ,_gbc -_ecdg ,0,_gd .ImgPart_r ));}else if _fdb {_fcbe :=_bgdb ._gedb [_bdf ]._ddga +_cg .FromEMU (_cfad );_bed :=_bgdb ._gedb [_ded ]._ddga +_cg .FromEMU (_edb );_cgc :=_bgdb ._caca [_cca ]._gbe +_cg .FromEMU (_bgda );_def :=float64 (_ebc ._ecaa ._adga );_fba :=_bgdb ._caca [_fdd ]._gbe +_cg .FromEMU (_fcg );_ebg :=_bed -_fcbe ;_dege :=_fba +_def -_cgc ;_gad :=_bgdb .imageFromAnchor (_dca ,_ebg ,_dege );_ebc ._fbef =append (_ebc ._fbef ,_bgdb .getImage (_gad ,_dege ,_ebg ,_fcbe ,_cgc ,0,_def -_cgc ,_gd .ImgPart_t ));_ddgd ._fbef =append (_ddgd ._fbef ,_bgdb .getImage (_gad ,_dege ,_ebg ,_fcbe ,0,0,_def -_cgc ,_gd .ImgPart_b ));}else {_gaa :=_bgdb ._gedb [_bdf ]._ddga +_cg .FromEMU (_cfad );_bea :=_bgdb ._gedb [_ded ]._ddga +_cg .FromEMU (_edb );_fedd :=_bgdb ._caca [_cca ]._gbe +_cg .FromEMU (_bgda );_fbac :=_bgdb ._caca [_fdd ]._gbe +_cg .FromEMU (_fcg );_acc :=_bea -_gaa ;_fcbg :=_fbac -_fedd ;_cgfb :=_bgdb .imageFromAnchor (_dca ,_acc ,_fcbg );_ebc ._fbef =append (_ebc ._fbef ,_bgdb .getImage (_cgfb ,_fcbg ,_acc ,_gaa ,_fedd ,0,0,_gd .ImgPart_whole ));};};};