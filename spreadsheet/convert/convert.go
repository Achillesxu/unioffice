//
// Copyright 2020 FoxyUtils ehf. All rights reserved.
//
// This is a commercial product and requires a license to operate.
// A trial license can be obtained at https://unidoc.io
//
// DO NOT EDIT: generated by unitwist Go source code obfuscator.
//
// Use of this source code is governed by the UniDoc End User License Agreement
// terms that can be accessed at https://unidoc.io/eula/

package convert ;import (_c "github.com/unidoc/unioffice/common/logger";_ce "github.com/unidoc/unioffice/common/tempstorage";_df "github.com/unidoc/unioffice/internal/convertutils";_a "github.com/unidoc/unioffice/measurement";_bb "github.com/unidoc/unioffice/schema/soo/dml";_cd "github.com/unidoc/unioffice/schema/soo/dml/chart";_dg "github.com/unidoc/unioffice/schema/soo/ofc/sharedTypes";_g "github.com/unidoc/unioffice/schema/soo/sml";_ge "github.com/unidoc/unioffice/spreadsheet";_cb "github.com/unidoc/unioffice/spreadsheet/reference";_b "github.com/unidoc/unipdf/v3/creator";_db "github.com/unidoc/unipdf/v3/model";_de "image";_f "strconv";);const _gc =1.5;func (_add *convertContext )makeRows (){_efd :=[]*rowInfo {};_bbga :=_add ._acg .Rows ();_gee :=0;for _ ,_fea :=range _bbga {_gee ++;_bef :=int (_fea .RowNumber ());if _bef > _gee {for _cbb :=_gee ;_cbb < _bef ;_cbb ++{_efd =append (_efd ,&rowInfo {_bdee :16/_ba });};_gee =_bef ;};var _bbf float64 ;if _fea .X ().HtAttr ==nil {_bbf =16;}else {_bbf =*_fea .X ().HtAttr ;};_efd =append (_efd ,&rowInfo {_bdee :_bbf /_ba ,_gfff :true ,_gcff :_add .getStyle (_fea .X ().SAttr )});};for _ac :=len (_efd );_ac < _add ._bgbb ;_ac ++{_efd =append (_efd ,&rowInfo {_bdee :16/_ba });};_add ._defa =_efd ;};func (_cbe *convertContext )alignSymbolsHorizontally (_fee *cell ,_dcfc _g .ST_HorizontalAlignment ){if _dcfc ==_g .ST_HorizontalAlignmentUnset {switch _fee ._cega {case _g .ST_CellTypeB :_dcfc =_g .ST_HorizontalAlignmentCenter ;case _g .ST_CellTypeN :_dcfc =_g .ST_HorizontalAlignmentRight ;default:_dcfc =_g .ST_HorizontalAlignmentLeft ;};};var _bbae float64 ;for _ ,_dcgb :=range _fee ._edgf {switch _dcfc {case _g .ST_HorizontalAlignmentLeft :_bbae =_dc ;case _g .ST_HorizontalAlignmentRight :_affg :=_gbgg (_dcgb ._edb );_bbae =_fee ._afee -_dc -_affg ;case _g .ST_HorizontalAlignmentCenter :_cda :=_gbgg (_dcgb ._edb );_bbae =(_fee ._afee -_cda )/2;};for _ ,_bfe :=range _dcgb ._edb {_bfe ._gde +=_bbae ;};};};func (_dfb *convertContext )drawPage (_fgcc *page ){_eace :=_dfb ._bff ;_eab :=_dfb ._ecad ;for _ ,_gdff :=range _fgcc ._ddbg {_bab :=_dfb ._defa [_gdff ._addf ];for _ ,_bga :=range _gdff ._ccda {_dff :=_bga ._bgab < _bga ._gae ;_cef :=_bga ._ebc > _bga ._gae +_bga ._afee ;var _efde ,_faf bool ;for _ ,_cdg :=range _bga ._edgf {for _ ,_gbcf :=range _cdg ._edb {if _dff &&!_efde {_efde =_gbcf ._gde < 0;};if _cef &&!_faf {_faf =_bga ._afee < _gbcf ._gde +_gbcf ._aeg ;};if _bga ._gae +_gbcf ._gde >=_bga ._bgab &&_bga ._gae +_gbcf ._gde +_gbcf ._aeg <=_bga ._ebc {_bbge :=_dfb ._ccfc .NewStyledParagraph ();_eeb :=_eab +_bga ._gae +_gbcf ._gde ;_acb :=_eace +_bab ._babad +_cdg ._aeb -_gbcf ._dad -_ecf (0.5);_bbge .SetPos (_eeb ,_acb );var _aac *_b .TextChunk ;if _gbcf ._dedd !=""{_aac =_bbge .AddExternalLink (_gbcf ._cdbg ,_gbcf ._dedd );}else {_aac =_bbge .Append (_gbcf ._cdbg );};if _gbcf ._gcbg !=nil {_aac .Style =*_gbcf ._gcbg ;};_dfb ._ccfc .Draw (_bbge );};};};var _eaab ,_abc ,_gebd ,_fac ,_fcca ,_cbcf float64 ;var _gad ,_abb ,_dea ,_eeccc _b .Color ;if _baeb :=_bga ._dfca ;_baeb !=nil {_eaab =_baeb ._gaeb ;_gad =_baeb ._fcg ;};if _bcb :=_bga ._efbe ;_bcb !=nil {_abc =_bcb ._gaeb ;_abb =_bcb ._fcg ;};if _ebb :=_bga ._ecdc ;_ebb !=nil {_gebd =_ebb ._gaeb ;_fcca =_gebd /2;_dea =_ebb ._fcg ;};if _gec :=_bga ._dag ;_gec !=nil {_fac =_gec ._gaeb ;_cbcf =_fac /2;_eeccc =_gec ._fcg ;};var _cff float64 ;if _gdff ._addf > 1{_cff =_dfb ._defa [_gdff ._addf -1]._efgcb ;};_ggb :=_eace +_bab ._babad -0.5*(_cff -_eaab );_abd :=_eace +_bab ._babad +_bab ._bdee +0.5*(_bab ._efgcb +_abc );_dcc :=_eab +_bga ._gae ;_gcgdd :=_dcc +_bga ._gggd ;_df .DrawLine (_dfb ._ccfc ,_dcc ,_ggb ,_gcgdd ,_ggb ,_eaab ,_gad );_df .DrawLine (_dfb ._ccfc ,_dcc ,_abd ,_gcgdd ,_abd ,_abc ,_abb );if !_efde {_df .DrawLine (_dfb ._ccfc ,_dcc -_fcca ,_ggb ,_dcc -_fcca ,_abd ,_gebd ,_dea );};if !_faf {_df .DrawLine (_dfb ._ccfc ,_gcgdd -_cbcf ,_ggb ,_gcgdd -_cbcf ,_abd ,_fac ,_eeccc );};};};for _ ,_dee :=range _fgcc ._ffec {if _dee !=nil {_dfb ._ccfc .Draw (_dee );};};};func _ggaf (_gef ,_dbede *style ){if _dbede ==nil {return ;};if _gef ==nil {_gef =_dbede ;return ;};if _gef ._cea ==nil {_gef ._cea =_dbede ._cea ;};if _gef ._cdcd ==nil {_gef ._cdcd =_dbede ._cdcd ;};if _gef ._ffd ==nil {_gef ._ffd =_dbede ._ffd ;};if _gef ._cbeb ==nil {_gef ._cbeb =_dbede ._cbeb ;};if _gef ._dgbc ==nil {_gef ._dgbc =_dbede ._dgbc ;};if _gef ._afeb ==nil {_gef ._afeb =_dbede ._afeb ;};if _gef ._gcf ==nil {_gef ._gcf =_dbede ._gcf ;};if _gef ._bbab ==nil {_gef ._bbab =_dbede ._bbab ;};if _gef ._fcdf ==nil {_gef ._fcdf =_dbede ._fcdf ;};if _gef ._eaca ==nil {_gef ._eaca =_dbede ._eaca ;};if _gef ._dca ==nil {_gef ._dca =_dbede ._dca ;};if _gef ._bfb ==nil {_gef ._bfb =_dbede ._bfb ;};if _gef ._abec ==_g .ST_VerticalAlignmentUnset {_gef ._abec =_dbede ._abec ;};if _gef ._ecadg ==_g .ST_HorizontalAlignmentUnset {_gef ._ecadg =_dbede ._ecadg ;};};func (_gdfc *convertContext )fillPages (){for _fgd ,_decd :=range _gdfc ._dcec {_dfe :=_gdfc ._defa [_decd ._babab :_decd ._bddg ];for _bdgg ,_cga :=range _dfe {_bce :=0;_eef :=0.0;_gdgf :=[]*cell {};if _cga ._gfff {for _ ,_fgg :=range _cga ._aad {_gga :=_gdfc ._cdb [_bce ];_gdfc ._cab =_gga ._gcgdc [_fgd ];_gdfc ._cab ._beaf =true ;_cge :=_fgg ._gggd ;if _eef +_cge > _gga ._fgec {_gdfc .addRowToPage (_gdgf ,_bdgg );_gdgf =[]*cell {_fgg };_eef =_cge ;_bce ++;}else {_fgg ._gae =_eef ;_gdgf =append (_gdgf ,_fgg );_eef +=_cge ;};};if len (_gdgf )> 0{_ddaa :=_gdfc ._cdb [_bce ];_gdfc ._cab =_ddaa ._gcgdc [_fgd ];_gdfc ._cab ._beaf =true ;_gdfc .addRowToPage (_gdgf ,_bdgg );};};};};};type pageRow struct{_addf int ;_ccda []*cell ;};func (_dde *convertContext )makeRowspans (){var _dgg float64 ;_bgg :=0;for _fgf ,_aff :=range _dde ._defa {_faa :=_aff ._bdee +_aff ._efgcb ;if _dgg +_faa <=_dde ._deca {_aff ._babad =_dgg ;_dgg +=_faa ;}else {_dde ._dcec =append (_dde ._dcec ,&rowspan {_bebf :_dgg ,_babab :_bgg ,_bddg :_fgf });_bgg =_fgf ;_aff ._babad =0;_dgg =_faa ;};};_dde ._dcec =append (_dde ._dcec ,&rowspan {_bebf :_dgg ,_babab :_bgg ,_bddg :len (_dde ._defa )});};func (_dgab *convertContext )getSymbolsFromString (_aee string ,_dgcg *style )[]*symbol {_ccec :=[]*symbol {};_ddd :=_dgab .makeTextStyleFromCellStyle (_dgcg );for _ ,_eabf :=range _aee {_ccec =append (_ccec ,&symbol {_cdbg :string (_eabf ),_gcbg :_ddd });};return _ccec ;};type rowInfo struct{_babad float64 ;_gfff bool ;_bdee float64 ;_gcff *style ;_aad []*cell ;_efgcb float64 ;};func (_ffdd *convertContext )getBorder (_fgbg *_g .CT_BorderPr )*border {_dcb :=&border {};switch _fgbg .StyleAttr {case _g .ST_BorderStyleThin :_dcb ._gaeb =_bf ;case _g .ST_BorderStyleMedium :_dcb ._gaeb =_bf *2;case _g .ST_BorderStyleThick :_dcb ._gaeb =_bf *4;};if _dcb ._gaeb ==0.0{return nil ;};if _dadg :=_fgbg .Color ;_dadg !=nil {_begcf :=_ffdd .getColorStringFromSmlColor (_dadg );if _begcf !=nil {_dcb ._fcg =_b .ColorRGBFromHex (*_begcf );}else {_dcb ._fcg =_b .ColorBlack ;};};return _dcb ;};type colWidthRange struct{_bdf int ;_decac int ;_fcdb float64 ;_dgf *style ;};type pagespan struct{_fgec float64 ;_gcgdc []*page ;_ecd int ;_fab int ;};var _cgf =[]string {"\u0030\u0030\u0030\u0030\u0030\u0030","\u0066\u0066\u0066\u0066\u0066\u0066","\u0066\u0066\u0030\u0030\u0030\u0030","\u0030\u0030\u0066\u0066\u0030\u0030","\u0030\u0030\u0030\u0030\u0066\u0066","\u0066\u0066\u0066\u0066\u0030\u0030","\u0066\u0066\u0030\u0030\u0066\u0066","\u0030\u0030\u0066\u0066\u0066\u0066","\u0030\u0030\u0030\u0030\u0030\u0030","\u0066\u0066\u0066\u0066\u0066\u0066","\u0066\u0066\u0030\u0030\u0030\u0030","\u0030\u0030\u0066\u0066\u0030\u0030","\u0030\u0030\u0030\u0030\u0066\u0066","\u0066\u0066\u0066\u0066\u0030\u0030","\u0066\u0066\u0030\u0030\u0066\u0066","\u0030\u0030\u0066\u0066\u0066\u0066","\u0038\u0030\u0030\u0030\u0030\u0030","\u0030\u0030\u0038\u0030\u0030\u0030","\u0030\u0030\u0030\u0030\u0038\u0030","\u0038\u0030\u0038\u0030\u0030\u0030","\u0038\u0030\u0030\u0030\u0038\u0030","\u0030\u0030\u0038\u0030\u0038\u0030","\u0063\u0030\u0063\u0030\u0063\u0030","\u0038\u0030\u0038\u0030\u0038\u0030","\u0039\u0039\u0039\u0039\u0066\u0066","\u0039\u0039\u0033\u0033\u0036\u0036","\u0066\u0066\u0066\u0066\u0063\u0063","\u0063\u0063\u0066\u0066\u0066\u0066","\u0036\u0036\u0030\u0030\u0036\u0036","\u0066\u0066\u0038\u0030\u0038\u0030","\u0030\u0030\u0036\u0036\u0063\u0063","\u0063\u0063\u0063\u0063\u0066\u0066","\u0030\u0030\u0030\u0030\u0038\u0030","\u0066\u0066\u0030\u0030\u0066\u0066","\u0066\u0066\u0066\u0066\u0030\u0030","\u0030\u0030\u0066\u0066\u0066\u0066","\u0038\u0030\u0030\u0030\u0038\u0030","\u0038\u0030\u0030\u0030\u0030\u0030","\u0030\u0030\u0038\u0030\u0038\u0030","\u0030\u0030\u0030\u0030\u0066\u0066","\u0030\u0030\u0063\u0063\u0066\u0066","\u0063\u0063\u0066\u0066\u0066\u0066","\u0063\u0063\u0066\u0066\u0063\u0063","\u0066\u0066\u0066\u0066\u0039\u0039","\u0039\u0039\u0063\u0063\u0066\u0066","\u0066\u0066\u0039\u0039\u0063\u0063","\u0063\u0063\u0039\u0039\u0066\u0066","\u0066\u0066\u0063\u0063\u0039\u0039","\u0033\u0033\u0036\u0036\u0066\u0066","\u0033\u0033\u0063\u0063\u0063\u0063","\u0039\u0039\u0063\u0063\u0030\u0030","\u0066\u0066\u0063\u0063\u0030\u0030","\u0066\u0066\u0039\u0039\u0030\u0030","\u0066\u0066\u0036\u0036\u0030\u0030","\u0036\u0036\u0036\u0036\u0039\u0039","\u0039\u0036\u0039\u0036\u0039\u0036","\u0030\u0030\u0033\u0033\u0036\u0036","\u0033\u0033\u0039\u0039\u0036\u0036","\u0030\u0030\u0033\u0033\u0030\u0030","\u0033\u0033\u0033\u0033\u0030\u0030","\u0039\u0039\u0033\u0033\u0030\u0030","\u0039\u0039\u0033\u0033\u0036\u0036","\u0033\u0033\u0033\u0033\u0039\u0039","\u0033\u0033\u0033\u0033\u0033\u0033"};func (_fdg *convertContext )distributeAnchors (){for _ ,_bbdc :=range _fdg ._aaf {_bde ,_ffg :=_bbdc ._egb ,_bbdc ._cfd ;_eb ,_gaa :=_bbdc ._agcc ,_bbdc ._bcf ;_ace ,_efbf :=_bbdc ._cgc ,_bbdc ._ccee ;_cfbe ,_dfa :=_bbdc ._gddb ,_bbdc ._gdb ;var _bgd ,_fb ,_ege ,_dcd *page ;for _ ,_eecc :=range _fdg ._cdb {for _ ,_beaa :=range _eecc ._gcgdc {if _bde >=_beaa ._feb ._babab &&_bde < _beaa ._feb ._bddg {if _eb >=_beaa ._ecac ._ecd &&_eb < _beaa ._ecac ._fab {_beaa ._beaf =true ;_bgd =_beaa ;};if _cfbe >=_beaa ._ecac ._ecd &&_cfbe < _beaa ._ecac ._fab {_beaa ._beaf =true ;_fb =_beaa ;};};if _ace >=_beaa ._feb ._babab &&_ace < _beaa ._feb ._bddg {if _eb >=_beaa ._ecac ._ecd &&_eb < _beaa ._ecac ._fab {_beaa ._beaf =true ;_dcd =_beaa ;};if _cfbe >=_beaa ._ecac ._ecd &&_cfbe < _beaa ._ecac ._fab {_beaa ._beaf =true ;_ege =_beaa ;};};};};_afb :=_bgd !=_fb ;_gfgg :=_bgd !=_dcd ;if _afb &&_gfgg {_geb :=_fdg ._fdf [_eb ]._gfeee +_a .FromEMU (_gaa );_ggg :=_bgd ._ecac ._fgec ;_eaf :=_fdg ._fdf [_cfbe ]._gfeee +_a .FromEMU (_dfa );_def :=_fdg ._defa [_bde ]._babad +_a .FromEMU (_ffg );_ddf :=float64 (_bgd ._feb ._bebf );_cgaa :=_fdg ._defa [_ace ]._babad +_a .FromEMU (_efbf );_gfee :=_eaf +_ggg -_geb ;_bbc :=_cgaa +_ddf -_def ;_cfac :=_fdg .imageFromAnchor (_bbdc ,_gfee ,_bbc );_bgd ._ffec =append (_bgd ._ffec ,_fdg .getImage (_cfac ,_bbc ,_gfee ,_geb ,_def ,_ggg -_geb ,_ddf -_def ,_df .ImgPart_lt ));_fb ._ffec =append (_fb ._ffec ,_fdg .getImage (_cfac ,_bbc ,_gfee ,0,_def ,_ggg -_geb ,_ddf -_def ,_df .ImgPart_rt ));_dcd ._ffec =append (_dcd ._ffec ,_fdg .getImage (_cfac ,_bbc ,_gfee ,_geb ,0,_ggg -_geb ,_ddf -_def ,_df .ImgPart_lb ));_ege ._ffec =append (_ege ._ffec ,_fdg .getImage (_cfac ,_bbc ,_gfee ,0,0,_ggg -_geb ,_ddf -_def ,_df .ImgPart_rb ));}else if _afb {_ecc :=_fdg ._defa [_bde ]._babad +_a .FromEMU (_ffg );_gfde :=_fdg ._defa [_ace ]._babad +_a .FromEMU (_efbf );_gcb :=_fdg ._fdf [_eb ]._gfeee +_a .FromEMU (_gaa );_bceg :=_bgd ._ecac ._fgec ;_ae :=_fdg ._fdf [_cfbe ]._gfeee +_a .FromEMU (_dfa );_dbb :=_ae +_bceg -_gcb ;_bba :=_gfde -_ecc ;_eeg :=_fdg .imageFromAnchor (_bbdc ,_dbb ,_bba );_bgd ._ffec =append (_bgd ._ffec ,_fdg .getImage (_eeg ,_bba ,_dbb ,_gcb ,_ecc ,_bceg -_gcb ,0,_df .ImgPart_l ));_fb ._ffec =append (_fb ._ffec ,_fdg .getImage (_eeg ,_bba ,_dbb ,0,_ecc ,_bceg -_gcb ,0,_df .ImgPart_r ));}else if _gfgg {_edc :=_fdg ._fdf [_eb ]._gfeee +_a .FromEMU (_gaa );_dbed :=_fdg ._fdf [_cfbe ]._gfeee +_a .FromEMU (_dfa );_decc :=_fdg ._defa [_bde ]._babad +_a .FromEMU (_ffg );_fggf :=float64 (_bgd ._feb ._bebf );_agbd :=_fdg ._defa [_ace ]._babad +_a .FromEMU (_efbf );_fgc :=_dbed -_edc ;_fba :=_agbd +_fggf -_decc ;_ggd :=_fdg .imageFromAnchor (_bbdc ,_fgc ,_fba );_bgd ._ffec =append (_bgd ._ffec ,_fdg .getImage (_ggd ,_fba ,_fgc ,_edc ,_decc ,0,_fggf -_decc ,_df .ImgPart_t ));_dcd ._ffec =append (_dcd ._ffec ,_fdg .getImage (_ggd ,_fba ,_fgc ,_edc ,0,0,_fggf -_decc ,_df .ImgPart_b ));}else {_fgde :=_fdg ._fdf [_eb ]._gfeee +_a .FromEMU (_gaa );_agda :=_fdg ._fdf [_cfbe ]._gfeee +_a .FromEMU (_dfa );_aba :=_fdg ._defa [_bde ]._babad +_a .FromEMU (_ffg );_fcbf :=_fdg ._defa [_ace ]._babad +_a .FromEMU (_efbf );_bgdg :=_agda -_fgde ;_acc :=_fcbf -_aba ;_cdd :=_fdg .imageFromAnchor (_bbdc ,_bgdg ,_acc );_bgd ._ffec =append (_bgd ._ffec ,_fdg .getImage (_cdd ,_acc ,_bgdg ,_fgde ,_aba ,0,0,_df .ImgPart_whole ));};};};func (_dafg *convertContext )getStyle (_cag *uint32 )*style {_efce :=&style {};_ccfcg :=false ;if _cag !=nil {_bdfb :=_dafg ._adgc .GetCellStyle (*_cag );_dfcf :=_bdfb .GetFont ();for _ ,_cfce :=range _dfcf .Name {if _cfce !=nil {_efce ._cea =&_cfce .ValAttr ;_ccfcg =true ;break ;};};for _ ,_egaf :=range _dfcf .B {if _egaf !=nil {_cabc :=_egaf .ValAttr ==nil ||*_egaf .ValAttr ;_efce ._cbeb =&_cabc ;_ccfcg =true ;break ;};};for _ ,_eaag :=range _dfcf .I {if _eaag !=nil {_bdea :=_eaag .ValAttr ==nil ||*_eaag .ValAttr ;_efce ._dgbc =&_bdea ;_ccfcg =true ;break ;};};for _ ,_bbe :=range _dfcf .U {if _bbe !=nil {_cddf :=_bbe .ValAttr ==_g .ST_UnderlineValuesSingle ||_bbe .ValAttr ==_g .ST_UnderlineValuesUnset ;_efce ._afeb =&_cddf ;_ccfcg =true ;break ;};};for _ ,_affd :=range _dfcf .Sz {if _affd !=nil {_deg :=_affd .ValAttr /12*_df .DefaultFontSize ;_efce ._ffd =&_deg ;_ccfcg =true ;break ;};};for _ ,_agdc :=range _dfcf .VertAlign {if _agdc !=nil {_ecbf :=_agdc .ValAttr ==_dg .ST_VerticalAlignRunSuperscript ;_efce ._gcf =&_ecbf ;_fgeg :=_agdc .ValAttr ==_dg .ST_VerticalAlignRunSubscript ;_efce ._bbab =&_fgeg ;_ccfcg =true ;break ;};};for _ ,_dcab :=range _dfcf .Color {if _dcab !=nil {_efce ._cdcd =_dafg .getColorStringFromSmlColor (_dcab );_ccfcg =true ;break ;};};_baa :=_bdfb .GetBorder ();if _baa .Top !=nil {_efce ._fcdf =_dafg .getBorder (_baa .Top );_ccfcg =true ;};if _baa .Bottom !=nil {_efce ._eaca =_dafg .getBorder (_baa .Bottom );_ccfcg =true ;};if _baa .Left !=nil {_efce ._dca =_dafg .getBorder (_baa .Left );_ccfcg =true ;};if _baa .Right !=nil {_efce ._bfb =_dafg .getBorder (_baa .Right );_ccfcg =true ;};if _bdfb .Wrapped (){_efce ._edcf =true ;_ccfcg =true ;};if _fcbe :=_bdfb .GetVerticalAlignment ();_fcbe !=_g .ST_VerticalAlignmentUnset {_efce ._abec =_fcbe ;_ccfcg =true ;};if _ecace :=_bdfb .GetHorizontalAlignment ();_ecace !=_g .ST_HorizontalAlignmentUnset {_efce ._ecadg =_ecace ;_ccfcg =true ;};};if _ccfcg {return _efce ;};return nil ;};func _gbgg (_egac []*symbol )float64 {_ccd :=0.0;for _ ,_bgad :=range _egac {_ccd +=_bgad ._aeg ;};return _ccd ;};type line struct{_aeb float64 ;_edb []*symbol ;_afeab float64 ;};func (_baba *convertContext )getImage (_adc _de .Image ,_fdbb ,_fbc ,_gcc ,_aedb ,_ccfe ,_bfgg float64 ,_fca _df .ImgPart )*_b .Image {_aedb +=_baba ._bff ;_gcc +=_baba ._ecad ;_gdd ,_ffgd :=_df .GetImage (_baba ._ccfc ,_adc ,_fdbb ,_fbc ,_gcc ,_aedb ,_ccfe ,_bfgg ,_fca );if _ffgd !=nil {_c .Log .Debug ("\u0043\u0061\u006eno\u0074\u0020\u0067\u0065\u0074\u0020\u0061\u006e\u0020\u0069\u006d\u0061\u0067\u0065\u003a\u0020\u0025\u0073",_ffgd );return nil ;};return _gdd ;};func (_bge *convertContext )imageFromAnchor (_deeb *anchor ,_bbac ,_ebf float64 )_de .Image {if _deeb ._edcd !=nil {return _deeb ._edcd ;};if _deeb ._eebd !=nil {_gbcfa ,_cebb :=_df .MakeImageFromChartSpace (_deeb ._eebd ,_bbac ,_ebf ,_bge ._cba );if _cebb !=nil {_c .Log .Debug ("C\u0061\u006e\u006e\u006f\u0074\u0020\u006d\u0061\u006b\u0065\u0020\u0061\u006e\u0020\u0069\u006d\u0061\u0067e\u0020\u0066\u0072\u006f\u006d\u0020\u0063\u0068\u0061\u0072tS\u0070\u0061\u0063e\u003a \u0025\u0073",_cebb );return nil ;};return _gbcfa ;};return nil ;};var _efbee =map[uint32 ]_b .PageSize {1:_b .PageSize {8.5*_a .Inch ,11*_a .Inch },2:_b .PageSize {8.5*_a .Inch ,11*_a .Inch },3:_b .PageSize {11*_a .Inch ,17*_a .Inch },4:_b .PageSize {17*_a .Inch ,11*_a .Inch },5:_b .PageSize {8.5*_a .Inch ,14*_a .Inch },6:_b .PageSize {5.5*_a .Inch ,8.5*_a .Inch },7:_b .PageSize {7.5*_a .Inch ,10*_a .Inch },8:_b .PageSize {_ecf (297),_ecf (420)},9:_b .PageSize {_ecf (210),_ecf (297)},10:_b .PageSize {_ecf (210),_ecf (297)},11:_b .PageSize {_ecf (148),_ecf (210)},70:_b .PageSize {_ecf (105),_ecf (148)},12:_b .PageSize {_ecf (250),_ecf (354)},13:_b .PageSize {_ecf (182),_ecf (257)},14:_b .PageSize {8.5*_a .Inch ,13*_a .Inch },20:_b .PageSize {4.125*_a .Inch ,9.5*_a .Inch },27:_b .PageSize {_ecf (110),_ecf (220)},28:_b .PageSize {_ecf (162),_ecf (229)},34:_b .PageSize {_ecf (250),_ecf (176)},29:_b .PageSize {_ecf (324),_ecf (458)},30:_b .PageSize {_ecf (229),_ecf (324)},31:_b .PageSize {_ecf (114),_ecf (162)},37:_b .PageSize {3.88*_a .Inch ,7.5*_a .Inch },43:_b .PageSize {_ecf (100),_ecf (148)},69:_b .PageSize {_ecf (200),_ecf (148)}};const _dc =3;const _e =0.25;func (_cce *convertContext )makePages (){for _ ,_gff :=range _cce ._cdb {for _ ,_dcef :=range _cce ._dcec {_gff ._gcgdc =append (_gff ._gcgdc ,&page {_ddbg :[]*pageRow {},_ecac :_gff ,_feb :_dcef });};};};func (_bdd *convertContext )getSymbolsFromR (_effc []*_g .CT_RElt ,_eae *style )[]*symbol {_ddec :=[]*symbol {};for _ ,_fae :=range _effc {_gge :=_bdd .combineCellStyleWithRPrElt (_eae ,_fae .RPr );for _ ,_dgeg :=range _fae .T {_ddec =append (_ddec ,&symbol {_cdbg :string (_dgeg ),_gcbg :_bdd .makeTextStyleFromCellStyle (_gge )});};};return _ddec ;};type anchor struct{_edcd _de .Image ;_eebd *_cd .ChartSpace ;_egb int ;_cfd int64 ;_agcc int ;_bcf int64 ;_cgc int ;_ccee int64 ;_gddb int ;_gdb int64 ;};

// FontStyle represents a kind of font styling. It can be FontStyle_Regular, FontStyle_Bold, FontStyle_Italic and FontStyle_BoldItalic.
type FontStyle =_df .FontStyle ;func (_fda *convertContext )alignSymbolsVertically (_gbce *cell ,_geeb _g .ST_VerticalAlignment ){var _dgb float64 ;switch _geeb {case _g .ST_VerticalAlignmentTop :_dgb =_dec ;if _gbce ._fgb {_dgb -=_gc ;}else if _gbce ._fgecg {_dgb +=4*_gc ;};for _ ,_gadf :=range _gbce ._edgf {_dgb +=_gadf ._afeab ;_gadf ._aeb =_dgb ;_dgb +=_fe ;};case _g .ST_VerticalAlignmentCenter :_fggff :=0.0;for _ ,_aaaf :=range _gbce ._edgf {_fggff +=_aaaf ._afeab +_ecf (1);};_dgb =0.5*(_gbce ._fgcd -_fggff );if _gbce ._fgb {_dgb -=2*_gc ;}else if _gbce ._fgecg {_dgb +=2*_gc ;};for _ ,_aeec :=range _gbce ._edgf {_dgb +=_aeec ._afeab +0.5*_fe ;_aeec ._aeb =_dgb ;_dgb +=0.5*_fe ;};default:_dgb =_gbce ._fgcd -_dec ;if _gbce ._fgb {_dgb -=4*_gc ;}else if _gbce ._fgecg {_dgb +=_gc ;};for _egc :=len (_gbce ._edgf )-1;_egc >=0;_egc --{_gbce ._edgf [_egc ]._aeb =_dgb ;_dgb -=_gbce ._edgf [_egc ]._afeab ;_dgb -=_fe ;};};};func (_fcgc *convertContext )getColorStringFromSmlColor (_gccb *_g .CT_Color )*string {var _ggac string ;if _gccb .RgbAttr !=nil {_ggac =*_gccb .RgbAttr ;}else if _gccb .IndexedAttr !=nil &&*_gccb .IndexedAttr < 64{_ggac =_cgf [*_gccb .IndexedAttr ];}else if _gccb .ThemeAttr !=nil {_aeba :=*_gccb .ThemeAttr ;_ggac =_fcgc .getColorFromTheme (_aeba );};if _ggac ==""{return nil ;};if len (_ggac )> 6{_ggac =_ggac [(len (_ggac )-6):];};if _gccb .TintAttr !=nil {_ddge :=*_gccb .TintAttr ;_ggac =_df .AdjustColorByTint (_ggac ,_ddge );};_ggac ="\u0023"+_ggac ;return &_ggac ;};const (FontStyle_Regular FontStyle =0;FontStyle_Bold FontStyle =1;FontStyle_Italic FontStyle =2;FontStyle_BoldItalic FontStyle =3;);var _ba =3.025/_ecf (1);func _ecf (_abf float64 )float64 {return _abf *_a .Millimeter };func _cdeb (_gfab []*symbol )float64 {_feac :=0.0;for _ ,_efcb :=range _gfab {if _efcb ._dad > _feac {_feac =_efcb ._dad ;};};return _feac ;};var _fe =_ecf (1);func (_abg *convertContext )addRowToPage (_eacc []*cell ,_efe int ){_afea :=0.0;_cdgc :=_abg ._dba ;for _ ,_beba :=range _eacc {if len (_beba ._edgf )!=0{_beba ._bgab =_afea ;_afea =_beba ._gae +_beba ._afee ;};};for _abae :=len (_eacc )-1;_abae >=0;_abae --{_fged :=_eacc [_abae ];if len (_fged ._edgf )!=0{_fged ._ebc =_cdgc ;_cdgc =_fged ._gae ;};};_abg ._cab ._ddbg =append (_abg ._cab ._ddbg ,&pageRow {_addf :_efe ,_ccda :_eacc });};func (_ecbg *convertContext )makeTextStyleFromCellStyle (_addc *style )*_b .TextStyle {_fggd :=_ecbg ._ccfc .NewTextStyle ();if _addc ==nil {_fggd .FontSize =_df .DefaultFontSize ;_fggd .Font =_df .AssignStdFontByName (_fggd ,_df .StdFontsMap ["\u0064e\u0066\u0061\u0075\u006c\u0074"][FontStyle_Regular ]);return &_fggd ;};if _ddce (_addc ._afeb ){_fggd .Underline =true ;_fggd .UnderlineStyle =_b .TextDecorationLineStyle {Offset :0.5,Thickness :_ecf (1/32)};};var _begc FontStyle ;if _ddce (_addc ._cbeb )&&_ddce (_addc ._dgbc ){_begc =FontStyle_BoldItalic ;}else if _ddce (_addc ._cbeb ){_begc =FontStyle_Bold ;}else if _ddce (_addc ._dgbc ){_begc =FontStyle_Italic ;}else {_begc =FontStyle_Regular ;};_faee :="\u0064e\u0066\u0061\u0075\u006c\u0074";if _addc ._cea !=nil {_faee =*_addc ._cea ;};if _febg ,_agdf :=_df .StdFontsMap [_faee ];_agdf {_fggd .Font =_df .AssignStdFontByName (_fggd ,_febg [_begc ]);}else if _cec :=_df .GetRegisteredFont (_faee ,_begc );_cec !=nil {_fggd .Font =_cec ;}else {_c .Log .Debug ("\u0046\u006f\u006e\u0074\u0020\u0025\u0073\u0020\u0077\u0069\u0074h\u0020\u0073\u0074\u0079\u006c\u0065\u0020\u0025s\u0020i\u0073\u0020\u006e\u006f\u0074\u0020\u0066\u006f\u0075\u006e\u0064\u002c\u0020\u0072\u0065\u0073\u0065\u0074 \u0074\u006f\u0020\u0064\u0065\u0066\u0061\u0075\u006c\u0074\u002e",_faee ,_begc );_fggd .Font =_df .AssignStdFontByName (_fggd ,_df .StdFontsMap ["\u0064e\u0066\u0061\u0075\u006c\u0074"][_begc ]);};if _addc ._ffd !=nil {_fggd .FontSize =*_addc ._ffd ;};if _addc ._cdcd !=nil {_fggd .Color =_b .ColorRGBFromHex (*_addc ._cdcd );};if _addc ._gcf !=nil &&*_addc ._gcf {_fggd .FontSize *=_ag ;}else if _addc ._bbab !=nil &&*_addc ._bbab {_fggd .FontSize *=_ag ;};return &_fggd ;};type style struct{_cdcd *string ;_ffd *float64 ;_cea *string ;_cbeb *bool ;_dgbc *bool ;_afeb *bool ;_gcf *bool ;_bbab *bool ;_fcdf *border ;_eaca *border ;_dca *border ;_bfb *border ;_edcf bool ;_abec _g .ST_VerticalAlignment ;_ecadg _g .ST_HorizontalAlignment ;};type border struct{_gaeb float64 ;_fcg _b .Color ;};func _ddce (_adf *bool )bool {return _adf !=nil &&*_adf };func (_agbg *convertContext )makeMergedCells (){_gg :=[]*mergedCell {};for _ ,_gbd :=range _agbg ._acg .MergedCells (){_efg ,_cdc ,_dbe :=_cb .ParseRangeReference (_gbd .Reference ());if _dbe !=nil {_c .Log .Debug ("\u0065\u0072r\u006f\u0072\u0020\u0070\u0061\u0072\u0073\u0069\u006e\u0067\u0020\u006d\u0065\u0072\u0067\u0065\u0064\u0020\u0063\u0065\u006c\u006c: \u0025\u0073",_dbe );continue ;};_ddc :=mergedCell {_bded :_efg .RowIdx ,_defg :_efg .ColumnIdx ,_fbfc :_cdc .RowIdx ,_cdbgb :_cdc .ColumnIdx };for _gfc :=_ddc ._defg -1;_gfc < _ddc ._cdbgb ;_gfc ++{_ddc ._ade +=_agbg ._fdf [_gfc ]._gfb ;};for _bgf :=_ddc ._bded -1;_bgf < _ddc ._fbfc ;_bgf ++{_ddc ._feg +=_agbg ._defa [_bgf ]._bdee ;};_gg =append (_gg ,&_ddc );};_agbg ._gfag =_gg ;};const _dec =2;func (_gcgd *convertContext )drawSheet (){for _cebe ,_begb :=range _gcgd ._cdb {_bcc :=len (_begb ._gcgdc );if _cebe ==len (_gcgd ._cdb )-1{for _fedd :=len (_begb ._gcgdc )-1;_fedd >=0;_fedd --{if !_begb ._gcgdc [_fedd ]._beaf {_bcc =_fedd ;};};};_aec :=_begb ._gcgdc [:_bcc ];for _ ,_ega :=range _aec {_gcgd ._ccfc .NewPage ();_gcgd .drawPage (_ega );};};};

// RegisterFont makes a PdfFont accessible for using in converting to PDF.
func RegisterFont (name string ,style FontStyle ,font *_db .PdfFont ){_df .RegisterFont (name ,style ,font );};func (_bbdd *convertContext )makeCells (){_fg :=_bbdd ._acg ;_fd :=_fg .Rows ();_dbfg :=0;for _ ,_dce :=range _bbdd ._defa {_dce ._aad =[]*cell {};_fed :=0.0;_aga :=_dce ._gcff ;if _dce ._gfff {_cfc :=_fd [_dbfg ];_dbfg ++;_ccf :=_dce ._bdee ;for _ ,_gacd :=range _cfc .Cells (){_efa ,_agba :=_cb .ParseCellReference (_gacd .Reference ());if _agba !=nil {_c .Log .Debug ("\u0043\u0061\u006e\u006eo\u0074\u0020\u0070\u0061\u0072\u0073\u0065\u0020\u0061\u0020r\u0065f\u0065\u0072\u0065\u006e\u0063\u0065\u003a \u0025\u0073",_agba );continue ;};_cac :=_bbdd ._fdf [_efa .ColumnIdx ];_gdf :=_cac ._gfb ;_cad :=_gdf ;_cbc :=_cac ._ebbf ;var _fge ,_efb ,_dge ,_ceg bool ;for _ ,_eac :=range _bbdd ._gfag {if _efa .RowIdx >=_eac ._bded &&_efa .RowIdx <=_eac ._fbfc &&_efa .ColumnIdx >=_eac ._defg &&_efa .ColumnIdx <=_eac ._cdbgb {if _efa .ColumnIdx ==_eac ._defg &&_efa .RowIdx ==_eac ._bded {_gdf =_eac ._ade ;_ccf =_eac ._feg ;};_fge =_efa .RowIdx !=_eac ._bded ;_efb =_efa .RowIdx !=_eac ._fbfc ;_dge =_efa .ColumnIdx !=_eac ._defg ;_ceg =_efa .ColumnIdx !=_eac ._cdbgb ;};};_dgaf :=_bbdd .getStyleFromCell (_gacd ,_aga ,_cbc );var _geef ,_gaf ,_cfaf bool ;var _eecb ,_beg ,_bdg ,_gbg *border ;var _gfd _g .ST_VerticalAlignment ;var _bfg _g .ST_HorizontalAlignment ;if _dgaf !=nil {if !_fge {_eecb =_dgaf ._fcdf ;};if !_efb {_beg =_dgaf ._eaca ;};if !_dge {_bdg =_dgaf ._dca ;};if !_ceg {_gbg =_dgaf ._bfb ;};if _beg !=nil &&_beg ._gaeb > _fed {_fed =_beg ._gaeb ;};_gfd =_dgaf ._abec ;_bfg =_dgaf ._ecadg ;if _dgaf ._gcf !=nil {_geef =*_dgaf ._gcf ;};if _dgaf ._bbab !=nil {_gaf =*_dgaf ._bbab ;};_cfaf =_dgaf ._edcf ;};_ced ,_cee :=_bbdd .getContentFromCell (_gacd ,_dgaf ,_gdf ,_cfaf );_bag :=&cell {_cega :_cee ,_afee :_gdf ,_gggd :_cad ,_fgcd :_ccf ,_edgf :_ced ,_dfca :_eecb ,_efbe :_beg ,_ecdc :_bdg ,_dag :_gbg ,_fgb :_geef ,_fgecg :_gaf };_bbdd .alignSymbolsHorizontally (_bag ,_bfg );_bbdd .alignSymbolsVertically (_bag ,_gfd );_dce ._aad =append (_dce ._aad ,_bag );};};_dce ._efgcb =_fed ;};};func (_fcb *convertContext )determineMaxIndexes (){var _bg ,_eg int ;_bg =int (_fcb ._acg .MaxColumnIdx ());_edf :=_fcb ._acg .Rows ();if len (_edf )> 0{_eg =int (_edf [len (_edf )-1].RowNumber ());};for _ ,_agge :=range _fcb ._aaf {if _agge ._cgc >=_eg {_eg =_agge ._cgc +1;};if _agge ._gddb >=_bg {_bg =_agge ._gddb +1;};};_fcb ._bgbb =_eg ;_fcb ._gege =_bg ;};var _bf =_ecf (0.0625);type convertContext struct{_ccfc *_b .Creator ;_bgbc *_ge .Workbook ;_cba *_bb .Theme ;_acg *_ge .Sheet ;_adgc *_ge .StyleSheet ;_bgbb int ;_gege int ;_cdb []*pagespan ;_cab *page ;_fdf []*colInfo ;_defa []*rowInfo ;_dcec []*rowspan ;_bff float64 ;_ecad float64 ;_deca float64 ;_dba float64 ;_gfag []*mergedCell ;_aaf []*anchor ;};func (_abeb *convertContext )makePagespans (){_abeb ._cdb =[]*pagespan {};_eaa :=0.0;_cg :=0;for _eff ,_geeg :=range _abeb ._fdf {_age :=_geeg ._gfb ;if _eaa +_age <=_abeb ._dba {_geeg ._gfeee =_eaa ;_eaa +=_age ;}else {_geeg ._gfeee =0;_abeb ._cdb =append (_abeb ._cdb ,&pagespan {_fgec :_eaa ,_ecd :_cg ,_fab :_eff });_eaa =_age ;_cg =_eff ;};};_abeb ._cdb =append (_abeb ._cdb ,&pagespan {_fgec :_eaa ,_ecd :_cg ,_fab :len (_abeb ._fdf )});};type page struct{_ddbg []*pageRow ;_beaf bool ;_ffec []*_b .Image ;_ecac *pagespan ;_feb *rowspan ;};

// ConvertToPdf converts a sheet to a PDF file. This package is beta, breaking changes can take place.
func ConvertToPdf (s *_ge .Sheet )*_b .Creator {_da :=s .X ();if _da ==nil {return nil ;};var _af _b .PageSize ;var _dd bool ;if _ed :=_da .PageSetup ;_ed !=nil {if _fa :=_ed .PaperSizeAttr ;_fa !=nil {_af =_efbee [*_fa ];};_dd =_ed .OrientationAttr ==_g .ST_OrientationLandscape ;};if (_af ==_b .PageSize {}){_af =_efbee [1];};if _dd {_af [0],_af [1]=_af [1],_af [0];};_agg :=_b .New ();_agg .SetPageSize (_af );var _bfc ,_dga ,_ddb ,_ca float64 ;if _gb :=_da .PageMargins ;_gb !=nil {_ddb =_gb .LeftAttr ;_ca =_gb .RightAttr ;_bfc =_gb .TopAttr ;_dga =_gb .BottomAttr ;};if _ddb < 0.25{_ddb =0.25;};if _ca < 0.25{_ca =0.25;};_bfc *=_a .Inch ;_dga *=_a .Inch ;_ddb *=_a .Inch ;_ca *=_a .Inch ;_agg .SetPageMargins (_ddb ,_ca ,_bfc ,_dga );_ec :=s .Workbook ();var _afe *_bb .Theme ;if len (_ec .Themes ())> 0{_afe =_ec .Themes ()[0];};_dbg :=&convertContext {_ccfc :_agg ,_acg :s ,_bgbc :s .Workbook (),_cba :_afe ,_adgc :&s .Workbook ().StyleSheet ,_bff :_bfc ,_ecad :_ddb ,_deca :_af [1]-_dga -_bfc ,_dba :_af [0]-_ca -_ddb };_dbg .makeAnchors ();_dbg .determineMaxIndexes ();if _dbg ._bgbb ==0&&_dbg ._gege ==0{_agg .NewPage ();return _agg ;};_dbg .makeCols ();_dbg .makeRows ();_dbg .makeMergedCells ();_dbg .makeCells ();_dbg .makePagespans ();_dbg .makeRowspans ();_dbg .makePages ();_dbg .fillPages ();_dbg .distributeAnchors ();_dbg .drawSheet ();return _agg ;};func (_bbg *convertContext )makeCols (){_agd :=_bbg ._acg ;_gfa :=_agd .X ();_cfb :=[]*colInfo {};_bfcd :=[]colWidthRange {};if _dac :=_gfa .Cols ;len (_dac )> 0{for _ ,_bae :=range _dac [0].Col {_daf :=65.0;if _be :=_bae .WidthAttr ;_be !=nil {if *_be > 0.83{*_be -=0.83;};if *_be <=1{_daf =*_be *11;}else {_daf =5+*_be *6;};};_bea :=int (_bae .MinAttr -1);_efc :=int (_bae .MaxAttr -1);_bfcd =append (_bfcd ,colWidthRange {_bdf :_bea ,_decac :_efc ,_fcdb :_daf ,_dgf :_bbg .getStyle (_bae .StyleAttr )});};};_dda :=0;for _gbc :=0;_gbc <=_bbg ._gege ;_gbc ++{var _cca float64 ;var _gac *style ;if _dda >=len (_bfcd ){_cca =65;}else {_bgc :=_bfcd [_dda ];if _gbc >=_bgc ._bdf &&_gbc <=_bgc ._decac {_cca =_bgc ._fcdb ;_gac =_bgc ._dgf ;if _gbc ==_bgc ._decac {_dda ++;};}else {_cca =65;};};_cfb =append (_cfb ,&colInfo {_gfb :_cca ,_ebbf :_gac });};_bbg ._fdf =_cfb ;};func (_ecb *convertContext )getContentFromCell (_fbf _ge .Cell ,_dfc *style ,_addb float64 ,_dcf bool )([]*line ,_g .ST_CellType ){_eba :=_fbf .X ();var _aecb []*symbol ;switch _eba .TAttr {case _g .ST_CellTypeS :_bced :=_eba .V ;if _bced !=nil {_edd ,_ffb :=_f .Atoi (*_bced );if _ffb ==nil {_aaa :=_ecb ._bgbc .SharedStrings .X ().Si [_edd ];if _aaa .T !=nil {_aecb =_ecb .getSymbolsFromString (*_aaa .T ,_dfc );}else if _aaa .R !=nil {_aecb =_ecb .getSymbolsFromR (_aaa .R ,_dfc );};};};case _g .ST_CellTypeB :_cede :=_eba .V ;if _cede !=nil {if *_cede =="\u0030"{_aecb =_ecb .getSymbolsFromString ("\u0046\u0041\u004cS\u0045",_dfc );}else {_aecb =_ecb .getSymbolsFromString ("\u0054\u0052\u0055\u0045",_dfc );};};default:_aecb =_ecb .getSymbolsFromString (_fbf .GetFormattedValue (),_dfc );};_ede :=0.0;_faad :=0.0;var _aed []*line ;var _cbbf bool ;if _dfc !=nil {if _dfc ._gcf !=nil {if *_dfc ._gcf {_cbbf =true ;};};if _dfc ._bbab !=nil {if *_dfc ._bbab {_cbbf =true ;};};};if _dcf {_aed =[]*line {};_gced :=_addb -2*_dc ;_efgc :=[]*symbol {};for _ ,_bgfe :=range _aecb {_ddca (_bgfe );if _ede +_bgfe ._aeg >=_gced {_ebd :=_cdeb (_efgc );if _cbbf {_ebd /=_ag ;};_aed =append (_aed ,&line {_aeb :_faad ,_edb :_efgc ,_afeab :_ebd });_efgc =[]*symbol {_bgfe };_ede =_bgfe ._aeg ;_faad +=_ebd ;}else {_bgfe ._gde =_ede ;_ede +=_bgfe ._aeg ;_efgc =append (_efgc ,_bgfe );};};_gggc :=_cdeb (_efgc );if _cbbf {_gggc /=_ag ;};if len (_efgc )> 0{_aed =append (_aed ,&line {_aeb :_faad ,_edb :_efgc ,_afeab :_gggc });};}else {for _ ,_fbd :=range _aecb {_ddca (_fbd );_fbd ._gde =_ede ;_ede +=_fbd ._aeg ;};if len (_aecb )> 0{_aed =[]*line {&line {_edb :_aecb ,_afeab :_cdeb (_aecb )}};};};_fce :=_eba .TAttr ;if _fce ==_g .ST_CellTypeUnset {_fce =_g .ST_CellTypeN ;};return _aed ,_fce ;};type colInfo struct{_gfeee float64 ;_gfb float64 ;_ebbf *style ;};func (_ebda *convertContext )getStyleFromRPrElt (_ffdg *_g .CT_RPrElt )*style {if _ffdg ==nil {return nil ;};_eaae :=&style {};_eaae ._cea =&_ffdg .RFont .ValAttr ;if _fgbe :=_ffdg .B ;_fgbe !=nil {_deeg :=_fgbe .ValAttr ==nil ||*_fgbe .ValAttr ;_eaae ._cbeb =&_deeg ;};if _gbgf :=_ffdg .I ;_gbgf !=nil {_eefg :=_gbgf .ValAttr ==nil ||*_gbgf .ValAttr ;_eaae ._dgbc =&_eefg ;};if _eeda :=_ffdg .U ;_eeda !=nil {_gcbb :=_eeda .ValAttr ==_g .ST_UnderlineValuesSingle ||_eeda .ValAttr ==_g .ST_UnderlineValuesUnset ;_eaae ._afeb =&_gcbb ;};if _cebbd :=_ffdg .VertAlign ;_cebbd !=nil {_edbc :=_cebbd .ValAttr ==_dg .ST_VerticalAlignRunSuperscript ;_eaae ._gcf =&_edbc ;_cgcb :=_cebbd .ValAttr ==_dg .ST_VerticalAlignRunSubscript ;_eaae ._bbab =&_cgcb ;};if _ebad :=_ffdg .Sz ;_ebad !=nil {_ebbd :=_ebad .ValAttr /12*_df .DefaultFontSize ;_eaae ._ffd =&_ebbd ;};if _dcff :=_ffdg .Color ;_dcff !=nil {_eaae ._cdcd =_ebda .getColorStringFromSmlColor (_dcff );};return _eaae ;};type rowspan struct{_bebf float64 ;_babab int ;_bddg int ;};func (_ecbb *convertContext )getColorFromTheme (_ada uint32 )string {_aaac :=_ecbb ._bgbc .Themes ();if len (_aaac )!=0{_ffge :=_aaac [0];if _bac :=_ffge .ThemeElements ;_bac !=nil {if _dcea :=_bac .ClrScheme ;_dcea !=nil {switch _ada {case 0:return _df .GetColorStringFromDmlColor (_dcea .Lt1 );case 1:return _df .GetColorStringFromDmlColor (_dcea .Dk1 );case 2:return _df .GetColorStringFromDmlColor (_dcea .Lt2 );case 3:return _df .GetColorStringFromDmlColor (_dcea .Dk2 );case 4:return _df .GetColorStringFromDmlColor (_dcea .Accent1 );case 5:return _df .GetColorStringFromDmlColor (_dcea .Accent2 );case 6:return _df .GetColorStringFromDmlColor (_dcea .Accent3 );case 7:return _df .GetColorStringFromDmlColor (_dcea .Accent4 );case 8:return _df .GetColorStringFromDmlColor (_dcea .Accent5 );case 9:return _df .GetColorStringFromDmlColor (_dcea .Accent6 );};};};};return "";};const _ag =0.64;type mergedCell struct{_bded uint32 ;_defg uint32 ;_fbfc uint32 ;_cdbgb uint32 ;_ade float64 ;_feg float64 ;};func (_ead *convertContext )combineCellStyleWithRPrElt (_dab *style ,_deed *_g .CT_RPrElt )*style {_cgb :=*_dab ;_agce :=_ead .getStyleFromRPrElt (_deed );if _agce ==nil {return &_cgb ;};if _agce ._cdcd !=nil {_cgb ._cdcd =_agce ._cdcd ;};if _agce ._ffd !=nil {_cgb ._ffd =_agce ._ffd ;};if _agce ._cea !=nil {_cgb ._cea =_agce ._cea ;};if _agce ._cbeb !=nil {_cgb ._cbeb =_agce ._cbeb ;};if _agce ._dgbc !=nil {_cgb ._dgbc =_agce ._dgbc ;};if _agce ._afeb !=nil {_cgb ._afeb =_agce ._afeb ;};if _agce ._gcf !=nil {_cgb ._gcf =_agce ._gcf ;};if _agce ._bbab !=nil {_cgb ._bbab =_agce ._bbab ;};return &_cgb ;};type symbol struct{_cdbg string ;_gde float64 ;_dad float64 ;_aeg float64 ;_gcbg *_b .TextStyle ;_dedd string ;};func (_bfce *convertContext )makeAnchors (){_fc ,_ad :=_bfce ._acg .GetDrawing ();if _fc !=nil {for _ ,_dgc :=range _fc .EG_Anchor {_ab :=&anchor {};if _gcg :=_dgc .TwoCellAnchor ;_gcg !=nil {_bbd ,_ga :=_gcg .From ,_gcg .To ;if _bbd ==nil ||_ga ==nil {return ;};_ab ._egb =int (_bbd .Row );_ab ._cfd =_df .FromSTCoordinate (_bbd .RowOff );_ab ._agcc =int (_bbd .Col );_ab ._bcf =_df .FromSTCoordinate (_bbd .ColOff );_ab ._cgc =int (_ga .Row );_ab ._ccee =_df .FromSTCoordinate (_ga .RowOff );_ab ._gddb =int (_ga .Col );_ab ._gdb =_df .FromSTCoordinate (_ga .ColOff );if _dbf :=_gcg .Choice ;_dbf !=nil {if _bd :=_dbf .Pic ;_bd !=nil {if _afc :=_bd .BlipFill ;_afc !=nil {if _cc :=_afc .Blip ;_cc !=nil {if _adg :=_cc .EmbedAttr ;_adg !=nil {for _ ,_cf :=range _ad .X ().Relationship {if _cf .IdAttr ==*_adg {for _ ,_fcc :=range _bfce ._bgbc .Images {if _fcc .Target ()==_cf .TargetAttr {_cbg ,_ef :=_ce .Open (_fcc .Path ());if _ef !=nil {_c .Log .Debug ("\u004fp\u0065\u006e\u0020\u0069m\u0061\u0067\u0065\u0020\u0066i\u006ce\u0020e\u0072\u0072\u006f\u0072\u003a\u0020\u0025s",_ef );continue ;};_edg ,_ ,_ef :=_de .Decode (_cbg );if _ef !=nil {_c .Log .Debug ("\u0044\u0065\u0063\u006fde\u0020\u0069\u006d\u0061\u0067\u0065\u0020\u0065\u0072\u0072\u006f\u0072\u003a\u0020%\u0073",_ef );continue ;};_ab ._edcd =_edg ;};};};};};};};}else if _geg :=_dbf .GraphicFrame ;_geg !=nil {if _ged :=_geg .Graphic ;_ged !=nil {if _agb :=_ged .GraphicData ;_agb !=nil {for _ ,_ff :=range _agb .Any {if _gf ,_ee :=_ff .(*_cd .Chart );_ee {for _ ,_eag :=range _ad .X ().Relationship {if _eag .IdAttr ==_gf .IdAttr {_ddg :=_bfce ._bgbc .GetChartByTargetId (_eag .TargetAttr );if _ddg !=nil {_ab ._eebd =_ddg ;};};};};};};};};};};if _ab ._edcd !=nil ||_ab ._eebd !=nil {_bfce ._aaf =append (_bfce ._aaf ,_ab );};};};};func (_dfab *convertContext )getStyleFromCell (_gcbe _ge .Cell ,_eed ,_eda *style )*style {_adge :=_gcbe .X ();_cgd :=_dfab .getStyle (_adge .SAttr );_ggaf (_cgd ,_eed );_ggaf (_cgd ,_eda );return _cgd ;};

// RegisterFontsFromDirectory registers all fonts from the given directory automatically detecting font families and styles.
func RegisterFontsFromDirectory (dirName string )error {return _df .RegisterFontsFromDirectory (dirName )};func _ddca (_ffe *symbol ){_dafc :=_b .New ();_bdc :=_dafc .NewStyledParagraph ();_bdc .SetMargins (0,0,0,0);_bgb :=_bdc .Append (_ffe ._cdbg );if _ffe ._gcbg !=nil {_bgb .Style =*_ffe ._gcbg ;};_ffe ._dad =_bdc .Height ();if _ffe ._aeg ==0{_ffe ._aeg =_bdc .Width ();};};type cell struct{_cega _g .ST_CellType ;_ceee int ;_gae float64 ;_edgf []*line ;_afee float64 ;_gggd float64 ;_fgcd float64 ;_bgab float64 ;_ebc float64 ;_ebdd *_b .TextStyle ;_dfca *border ;_efbe *border ;_ecdc *border ;_dag *border ;_fgb bool ;_fgecg bool ;};