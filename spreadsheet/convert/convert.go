//
// Copyright 2020 FoxyUtils ehf. All rights reserved.
//
// This is a commercial product and requires a license to operate.
// A trial license can be obtained at https://unidoc.io
//
// DO NOT EDIT: generated by unitwist Go source code obfuscator.
//
// Use of this source code is governed by the UniDoc End User License Agreement
// terms that can be accessed at https://unidoc.io/eula/

package convert ;import (_ce "github.com/unidoc/unioffice/common/logger";_ba "github.com/unidoc/unioffice/common/tempstorage";_gb "github.com/unidoc/unioffice/internal/convertutils";_ae "github.com/unidoc/unioffice/measurement";_be "github.com/unidoc/unioffice/schema/soo/dml";_cf "github.com/unidoc/unioffice/schema/soo/dml/chart";_bb "github.com/unidoc/unioffice/schema/soo/ofc/sharedTypes";_ced "github.com/unidoc/unioffice/schema/soo/sml";_d "github.com/unidoc/unioffice/spreadsheet";_f "github.com/unidoc/unioffice/spreadsheet/reference";_e "github.com/unidoc/unipdf/v3/creator";_b "github.com/unidoc/unipdf/v3/model";_a "image";_c "strconv";);func (_bdba *convertContext )determineMaxIndexes (){var _deg ,_bga int ;_deg =int (_bdba ._bccb .MaxColumnIdx ());_adb :=_bdba ._bccb .Rows ();if len (_adb )> 0{_bga =int (_adb [len (_adb )-1].RowNumber ());};for _ ,_gad :=range _bdba ._abba {if _gad ._cfdc >=_bga {_bga =_gad ._cfdc +1;};if _gad ._eacd >=_deg {_deg =_gad ._eacd +1;};};_bdba ._dbc =_bga ;_bdba ._face =_deg ;};

// ConvertToPdf converts a sheet to a PDF file. This package is beta, breaking changes can take place.
func ConvertToPdf (s *_d .Sheet )*_e .Creator {_ge :=s .X ();if _ge ==nil {return nil ;};var _dg _e .PageSize ;var _acc bool ;if _cb :=_ge .PageSetup ;_cb !=nil {if _bac :=_cb .PaperSizeAttr ;_bac !=nil {_dg =_egac [*_bac ];};_acc =_cb .OrientationAttr ==_ced .ST_OrientationLandscape ;};if (_dg ==_e .PageSize {}){_dg =_egac [1];};if _acc {_dg [0],_dg [1]=_dg [1],_dg [0];};_af :=_e .New ();_af .SetPageSize (_dg );var _ea ,_dge ,_db ,_fgc float64 ;if _gab :=_ge .PageMargins ;_gab !=nil {_db =_gab .LeftAttr ;_fgc =_gab .RightAttr ;_ea =_gab .TopAttr ;_dge =_gab .BottomAttr ;};if _db < 0.25{_db =0.25;};if _fgc < 0.25{_fgc =0.25;};_ea *=_ae .Inch ;_dge *=_ae .Inch ;_db *=_ae .Inch ;_fgc *=_ae .Inch ;_af .SetPageMargins (_db ,_fgc ,_ea ,_dge );_fb :=s .Workbook ();var _ad *_be .Theme ;if len (_fb .Themes ())> 0{_ad =_fb .Themes ()[0];};_ef :=&convertContext {_eefa :_af ,_bccb :s ,_cbbb :s .Workbook (),_ggce :_ad ,_aeg :&s .Workbook ().StyleSheet ,_bcag :_ea ,_ebae :_db ,_abg :_dg [1]-_dge -_ea ,_egf :_dg [0]-_fgc -_db };_ef .makeAnchors ();_ef .determineMaxIndexes ();if _ef ._dbc ==0&&_ef ._face ==0{_af .NewPage ();return _af ;};_ef .makeCols ();_ef .makeRows ();_ef .makeMergedCells ();_ef .makeCells ();_ef .makePagespans ();_ef .makeRowspans ();_ef .makePages ();_ef .fillPages ();_ef .distributeAnchors ();_ef .drawSheet ();return _af ;};type style struct{_gege *string ;_efad *float64 ;_bbg *string ;_cbab *bool ;_gdgae *bool ;_bcd *bool ;_ffab *bool ;_eac *bool ;_aagf *border ;_cbfb *border ;_gacee *border ;_gbf *border ;_gea bool ;_egd _ced .ST_VerticalAlignment ;_cbef _ced .ST_HorizontalAlignment ;};func (_afeb *convertContext )imageFromAnchor (_acf *anchor ,_gca ,_bdcb float64 )_a .Image {if _acf ._cgaf !=nil {return _acf ._cgaf ;};if _acf ._fagc !=nil {_adfd ,_ggcc :=_gb .MakeImageFromChartSpace (_acf ._fagc ,_gca ,_bdcb ,_afeb ._ggce );if _ggcc !=nil {_ce .Log .Debug ("C\u0061\u006e\u006e\u006f\u0074\u0020\u006d\u0061\u006b\u0065\u0020\u0061\u006e\u0020\u0069\u006d\u0061\u0067e\u0020\u0066\u0072\u006f\u006d\u0020\u0063\u0068\u0061\u0072tS\u0070\u0061\u0063e\u003a \u0025\u0073",_ggcc );return nil ;};return _adfd ;};return nil ;};func _bgfc (_fdfe *symbol ){_cgfg :=_e .New ();_bcca :=_cgfg .NewStyledParagraph ();_bcca .SetMargins (0,0,0,0);_dee :=_bcca .Append (_fdfe ._aeaf );if _fdfe ._fae !=nil {_dee .Style =*_fdfe ._fae ;};_fdfe ._fgfag =_bcca .Height ();if _fdfe ._fceca ==0{_fdfe ._fceca =_bcca .Width ();};};func (_dda *convertContext )fillPages (){for _fag ,_abb :=range _dda ._gbg {_cec :=_dda ._egca [_abb ._aebb :_abb ._fbee ];for _cbg ,_efb :=range _cec {_cgb :=0;_cbec :=0.0;_bbe :=[]*cell {};if _efb ._bgc {for _ ,_bcaa :=range _efb ._eec {_bed :=_dda ._fefc [_cgb ];_dda ._dfdc =_bed ._eed [_fag ];_dda ._dfdc ._ebbf =true ;_ccd :=_bcaa ._bcf ;if _cbec +_ccd > _bed ._ebed {_dda .addRowToPage (_bbe ,_cbg );_bbe =[]*cell {_bcaa };_cbec =_ccd ;_cgb ++;}else {_bcaa ._bffg =_cbec ;_bbe =append (_bbe ,_bcaa );_cbec +=_ccd ;};};if len (_bbe )> 0{_egb :=_dda ._fefc [_cgb ];_dda ._dfdc =_egb ._eed [_fag ];_dda ._dfdc ._ebbf =true ;_dda .addRowToPage (_bbe ,_cbg );};};};};};func (_cgg *convertContext )getContentFromCell (_dce _d .Cell ,_eged *style ,_cga float64 ,_gdeg bool )([]*line ,_ced .ST_CellType ){_gdd :=_dce .X ();var _cacf []*symbol ;switch _gdd .TAttr {case _ced .ST_CellTypeS :_ggf :=_gdd .V ;if _ggf !=nil {_ega ,_aceg :=_c .Atoi (*_ggf );if _aceg ==nil {_cba :=_cgg ._cbbb .SharedStrings .X ().Si [_ega ];if _cba .T !=nil {_cacf =_cgg .getSymbolsFromString (*_cba .T ,_eged );}else if _cba .R !=nil {_cacf =_cgg .getSymbolsFromR (_cba .R ,_eged );};};};case _ced .ST_CellTypeB :_gfag :=_gdd .V ;if _gfag !=nil {if *_gfag =="\u0030"{_cacf =_cgg .getSymbolsFromString ("\u0046\u0041\u004cS\u0045",_eged );}else {_cacf =_cgg .getSymbolsFromString ("\u0054\u0052\u0055\u0045",_eged );};};default:_cacf =_cgg .getSymbolsFromString (_dce .GetFormattedValue (),_eged );};_bff :=0.0;_gdg :=0.0;var _decc []*line ;var _gdaf bool ;if _eged !=nil {if _eged ._ffab !=nil {if *_eged ._ffab {_gdaf =true ;};};if _eged ._eac !=nil {if *_eged ._eac {_gdaf =true ;};};};if _gdeg {_decc =[]*line {};_acb :=_cga -2*_eb ;_dadg :=[]*symbol {};for _ ,_eaa :=range _cacf {_bgfc (_eaa );if _bff +_eaa ._fceca >=_acb {_dbea :=_bgab (_dadg );if _gdaf {_dbea /=_ga ;};_decc =append (_decc ,&line {_aabb :_gdg ,_cgfe :_dadg ,_fdfc :_dbea });_dadg =[]*symbol {_eaa };_bff =_eaa ._fceca ;_gdg +=_dbea ;}else {_eaa ._ebaf =_bff ;_bff +=_eaa ._fceca ;_dadg =append (_dadg ,_eaa );};};_cbgf :=_bgab (_dadg );if _gdaf {_cbgf /=_ga ;};if len (_dadg )> 0{_decc =append (_decc ,&line {_aabb :_gdg ,_cgfe :_dadg ,_fdfc :_cbgf });};}else {for _ ,_agd :=range _cacf {_bgfc (_agd );_agd ._ebaf =_bff ;_bff +=_agd ._fceca ;};if len (_cacf )> 0{_decc =[]*line {&line {_cgfe :_cacf ,_fdfc :_bgab (_cacf )}};};};_daf :=_gdd .TAttr ;if _daf ==_ced .ST_CellTypeUnset {_daf =_ced .ST_CellTypeN ;};return _decc ,_daf ;};

// RegisterFontsFromDirectory registers all fonts from the given directory automatically detecting font families and styles.
func RegisterFontsFromDirectory (dirName string )error {return _gb .RegisterFontsFromDirectory (dirName )};func (_dbgc *convertContext )getStyleFromRPrElt (_ccab *_ced .CT_RPrElt )*style {if _ccab ==nil {return nil ;};_aabg :=&style {};_aabg ._bbg =&_ccab .RFont .ValAttr ;if _dbbc :=_ccab .B ;_dbbc !=nil {_ccabf :=_dbbc .ValAttr ==nil ||*_dbbc .ValAttr ;_aabg ._cbab =&_ccabf ;};if _bcb :=_ccab .I ;_bcb !=nil {_gbfg :=_bcb .ValAttr ==nil ||*_bcb .ValAttr ;_aabg ._gdgae =&_gbfg ;};if _ddb :=_ccab .U ;_ddb !=nil {_ddfc :=_ddb .ValAttr ==_ced .ST_UnderlineValuesSingle ||_ddb .ValAttr ==_ced .ST_UnderlineValuesUnset ;_aabg ._bcd =&_ddfc ;};if _dgee :=_ccab .VertAlign ;_dgee !=nil {_dgea :=_dgee .ValAttr ==_bb .ST_VerticalAlignRunSuperscript ;_aabg ._ffab =&_dgea ;_aef :=_dgee .ValAttr ==_bb .ST_VerticalAlignRunSubscript ;_aabg ._eac =&_aef ;};if _cad :=_ccab .Sz ;_cad !=nil {_cgcc :=_cad .ValAttr /12*_gb .DefaultFontSize ;_aabg ._efad =&_cgcc ;};if _bfdd :=_ccab .Color ;_bfdd !=nil {_aabg ._gege =_dbgc .getColorStringFromSmlColor (_bfdd );};return _aabg ;};func (_gdc *convertContext )makeCols (){_ecd :=_gdc ._bccb ;_ggbd :=_ecd .X ();_aa :=[]*colInfo {};_fgf :=[]colWidthRange {};if _fad :=_ggbd .Cols ;len (_fad )> 0{for _ ,_cdd :=range _fad [0].Col {_bca :=65.0;if _fbe :=_cdd .WidthAttr ;_fbe !=nil {if *_fbe > 0.83{*_fbe -=0.83;};if *_fbe <=1{_bca =*_fbe *11;}else {_bca =5+*_fbe *6;};};_bgb :=int (_cdd .MinAttr -1);_aab :=int (_cdd .MaxAttr -1);_fgf =append (_fgf ,colWidthRange {_cbbg :_bgb ,_aeafc :_aab ,_cdad :_bca ,_fadf :_gdc .getStyle (_cdd .StyleAttr )});};};_cfd :=0;for _ceb :=0;_ceb <=_gdc ._face ;_ceb ++{var _beg float64 ;var _cda *style ;if _cfd >=len (_fgf ){_beg =65;}else {_cbe :=_fgf [_cfd ];if _ceb >=_cbe ._cbbg &&_ceb <=_cbe ._aeafc {_beg =_cbe ._cdad ;_cda =_cbe ._fadf ;if _ceb ==_cbe ._aeafc {_cfd ++;};}else {_beg =65;};};_aa =append (_aa ,&colInfo {_dfc :_beg ,_abd :_cda });};_gdc ._cbce =_aa ;};type colWidthRange struct{_cbbg int ;_aeafc int ;_cdad float64 ;_fadf *style ;};func (_ebd *convertContext )distributeAnchors (){for _ ,_fddd :=range _ebd ._abba {_dec ,_dcd :=_fddd ._ebfd ,_fddd ._adc ;_gbaf ,_fcf :=_fddd ._afga ,_fddd ._aeaa ;_fce ,_cca :=_fddd ._cfdc ,_fddd ._fgad ;_geb ,_fac :=_fddd ._eacd ,_fddd ._gag ;var _gbb ,_aeb ,_cedg ,_eabf *page ;for _ ,_eba :=range _ebd ._fefc {for _ ,_dbdc :=range _eba ._eed {if _dec >=_dbdc ._ebdd ._aebb &&_dec < _dbdc ._ebdd ._fbee {if _gbaf >=_dbdc ._cbf ._fcea &&_gbaf < _dbdc ._cbf ._gced {_dbdc ._ebbf =true ;_gbb =_dbdc ;};if _geb >=_dbdc ._cbf ._fcea &&_geb < _dbdc ._cbf ._gced {_dbdc ._ebbf =true ;_aeb =_dbdc ;};};if _fce >=_dbdc ._ebdd ._aebb &&_fce < _dbdc ._ebdd ._fbee {if _gbaf >=_dbdc ._cbf ._fcea &&_gbaf < _dbdc ._cbf ._gced {_dbdc ._ebbf =true ;_eabf =_dbdc ;};if _geb >=_dbdc ._cbf ._fcea &&_geb < _dbdc ._cbf ._gced {_dbdc ._ebbf =true ;_cedg =_dbdc ;};};};};_bbcbf :=_gbb !=_aeb ;_fbb :=_gbb !=_eabf ;if _bbcbf &&_fbb {_bdgf :=_ebd ._cbce [_gbaf ]._bce +_ae .FromEMU (_fcf );_fcd :=_gbb ._cbf ._ebed ;_ccb :=_ebd ._cbce [_geb ]._bce +_ae .FromEMU (_fac );_beae :=_ebd ._egca [_dec ]._fffd +_ae .FromEMU (_dcd );_dac :=float64 (_gbb ._ebdd ._afg );_agba :=_ebd ._egca [_fce ]._fffd +_ae .FromEMU (_cca );_fda :=_ccb +_fcd -_bdgf ;_gegf :=_agba +_dac -_beae ;_aca :=_ebd .imageFromAnchor (_fddd ,_fda ,_gegf );_gbb ._agc =append (_gbb ._agc ,_ebd .getImage (_aca ,_gegf ,_fda ,_bdgf ,_beae ,_fcd -_bdgf ,_dac -_beae ,_gb .ImgPart_lt ));_aeb ._agc =append (_aeb ._agc ,_ebd .getImage (_aca ,_gegf ,_fda ,0,_beae ,_fcd -_bdgf ,_dac -_beae ,_gb .ImgPart_rt ));_eabf ._agc =append (_eabf ._agc ,_ebd .getImage (_aca ,_gegf ,_fda ,_bdgf ,0,_fcd -_bdgf ,_dac -_beae ,_gb .ImgPart_lb ));_cedg ._agc =append (_cedg ._agc ,_ebd .getImage (_aca ,_gegf ,_fda ,0,0,_fcd -_bdgf ,_dac -_beae ,_gb .ImgPart_rb ));}else if _bbcbf {_gfg :=_ebd ._egca [_dec ]._fffd +_ae .FromEMU (_dcd );_bbd :=_ebd ._egca [_fce ]._fffd +_ae .FromEMU (_cca );_cfb :=_ebd ._cbce [_gbaf ]._bce +_ae .FromEMU (_fcf );_gfa :=_gbb ._cbf ._ebed ;_gff :=_ebd ._cbce [_geb ]._bce +_ae .FromEMU (_fac );_dfd :=_gff +_gfa -_cfb ;_bab :=_bbd -_gfg ;_fcec :=_ebd .imageFromAnchor (_fddd ,_dfd ,_bab );_gbb ._agc =append (_gbb ._agc ,_ebd .getImage (_fcec ,_bab ,_dfd ,_cfb ,_gfg ,_gfa -_cfb ,0,_gb .ImgPart_l ));_aeb ._agc =append (_aeb ._agc ,_ebd .getImage (_fcec ,_bab ,_dfd ,0,_gfg ,_gfa -_cfb ,0,_gb .ImgPart_r ));}else if _fbb {_gdb :=_ebd ._cbce [_gbaf ]._bce +_ae .FromEMU (_fcf );_ddf :=_ebd ._cbce [_geb ]._bce +_ae .FromEMU (_fac );_cdfc :=_ebd ._egca [_dec ]._fffd +_ae .FromEMU (_dcd );_cecg :=float64 (_gbb ._ebdd ._afg );_acaf :=_ebd ._egca [_fce ]._fffd +_ae .FromEMU (_cca );_fed :=_ddf -_gdb ;_dbe :=_acaf +_cecg -_cdfc ;_dgg :=_ebd .imageFromAnchor (_fddd ,_fed ,_dbe );_gbb ._agc =append (_gbb ._agc ,_ebd .getImage (_dgg ,_dbe ,_fed ,_gdb ,_cdfc ,0,_cecg -_cdfc ,_gb .ImgPart_t ));_eabf ._agc =append (_eabf ._agc ,_ebd .getImage (_dgg ,_dbe ,_fed ,_gdb ,0,0,_cecg -_cdfc ,_gb .ImgPart_b ));}else {_fbg :=_ebd ._cbce [_gbaf ]._bce +_ae .FromEMU (_fcf );_agg :=_ebd ._cbce [_geb ]._bce +_ae .FromEMU (_fac );_dcf :=_ebd ._egca [_dec ]._fffd +_ae .FromEMU (_dcd );_gee :=_ebd ._egca [_fce ]._fffd +_ae .FromEMU (_cca );_aed :=_agg -_fbg ;_abf :=_gee -_dcf ;_bcg :=_ebd .imageFromAnchor (_fddd ,_aed ,_abf );_gbb ._agc =append (_gbb ._agc ,_ebd .getImage (_bcg ,_abf ,_aed ,_fbg ,_dcf ,0,0,_gb .ImgPart_whole ));};};};type pageRow struct{_cdff int ;_cbdb []*cell ;};type mergedCell struct{_bcdc uint32 ;_ecde uint32 ;_ebee uint32 ;_gcd uint32 ;_efac float64 ;_egbgb float64 ;};func (_ecg *convertContext )makeMergedCells (){_fee :=[]*mergedCell {};for _ ,_gga :=range _ecg ._bccb .MergedCells (){_cfg ,_ggae ,_bag :=_f .ParseRangeReference (_gga .Reference ());if _bag !=nil {_ce .Log .Debug ("\u0065\u0072r\u006f\u0072\u0020\u0070\u0061\u0072\u0073\u0069\u006e\u0067\u0020\u006d\u0065\u0072\u0067\u0065\u0064\u0020\u0063\u0065\u006c\u006c: \u0025\u0073",_bag );continue ;};_ada :=mergedCell {_bcdc :_cfg .RowIdx ,_ecde :_cfg .ColumnIdx ,_ebee :_ggae .RowIdx ,_gcd :_ggae .ColumnIdx };for _gf :=_ada ._ecde -1;_gf < _ada ._gcd ;_gf ++{_ada ._efac +=_ecg ._cbce [_gf ]._dfc ;};for _geg :=_ada ._bcdc -1;_geg < _ada ._ebee ;_geg ++{_ada ._egbgb +=_ecg ._egca [_geg ]._fcaa ;};_fee =append (_fee ,&_ada );};_ecg ._aadb =_fee ;};type symbol struct{_aeaf string ;_ebaf float64 ;_fgfag float64 ;_fceca float64 ;_fae *_e .TextStyle ;_cbeg string ;};type rowspan struct{_afg float64 ;_aebb int ;_fbee int ;};

// FontStyle represents a kind of font styling. It can be FontStyle_Regular, FontStyle_Bold, FontStyle_Italic and FontStyle_BoldItalic.
type FontStyle =_gb .FontStyle ;func _fcc (_ffd []*symbol )float64 {_ebf :=0.0;for _ ,_fec :=range _ffd {_ebf +=_fec ._fceca ;};return _ebf ;};var _egac =map[uint32 ]_e .PageSize {1:_e .PageSize {8.5*_ae .Inch ,11*_ae .Inch },2:_e .PageSize {8.5*_ae .Inch ,11*_ae .Inch },3:_e .PageSize {11*_ae .Inch ,17*_ae .Inch },4:_e .PageSize {17*_ae .Inch ,11*_ae .Inch },5:_e .PageSize {8.5*_ae .Inch ,14*_ae .Inch },6:_e .PageSize {5.5*_ae .Inch ,8.5*_ae .Inch },7:_e .PageSize {7.5*_ae .Inch ,10*_ae .Inch },8:_e .PageSize {_gefg (297),_gefg (420)},9:_e .PageSize {_gefg (210),_gefg (297)},10:_e .PageSize {_gefg (210),_gefg (297)},11:_e .PageSize {_gefg (148),_gefg (210)},70:_e .PageSize {_gefg (105),_gefg (148)},12:_e .PageSize {_gefg (250),_gefg (354)},13:_e .PageSize {_gefg (182),_gefg (257)},14:_e .PageSize {8.5*_ae .Inch ,13*_ae .Inch },20:_e .PageSize {4.125*_ae .Inch ,9.5*_ae .Inch },27:_e .PageSize {_gefg (110),_gefg (220)},28:_e .PageSize {_gefg (162),_gefg (229)},34:_e .PageSize {_gefg (250),_gefg (176)},29:_e .PageSize {_gefg (324),_gefg (458)},30:_e .PageSize {_gefg (229),_gefg (324)},31:_e .PageSize {_gefg (114),_gefg (162)},37:_e .PageSize {3.88*_ae .Inch ,7.5*_ae .Inch },43:_e .PageSize {_gefg (100),_gefg (148)},69:_e .PageSize {_gefg (200),_gefg (148)}};type line struct{_aabb float64 ;_cgfe []*symbol ;_fdfc float64 ;};const _ac =0.25;const _bd =2;var _fg =_gefg (0.0625);func (_aeeb *convertContext )makePages (){for _ ,_dbb :=range _aeeb ._fefc {for _ ,_ddg :=range _aeeb ._gbg {_dbb ._eed =append (_dbb ._eed ,&page {_bdda :[]*pageRow {},_cbf :_dbb ,_ebdd :_ddg });};};};func _becc (_ece *bool )bool {return _ece !=nil &&*_ece };func (_bbeg *convertContext )getImage (_cdc _a .Image ,_aadd ,_fefg ,_cebd ,_dga ,_gdfe ,_adag float64 ,_aeef _gb .ImgPart )*_e .Image {_dga +=_bbeg ._bcag ;_cebd +=_bbeg ._ebae ;_cdcb ,_edg :=_gb .GetImage (_bbeg ._eefa ,_cdc ,_aadd ,_fefg ,_cebd ,_dga ,_gdfe ,_adag ,_aeef );if _edg !=nil {_ce .Log .Debug ("\u0043\u0061\u006eno\u0074\u0020\u0067\u0065\u0074\u0020\u0061\u006e\u0020\u0069\u006d\u0061\u0067\u0065\u003a\u0020\u0025\u0073",_edg );return nil ;};return _cdcb ;};func (_ebeg *convertContext )getStyle (_dfe *uint32 )*style {_aagfa :=&style {};_fdg :=false ;if _dfe !=nil {_cee :=_ebeg ._aeg .GetCellStyle (*_dfe );_faga :=_cee .GetFont ();for _ ,_gbc :=range _faga .Name {if _gbc !=nil {_aagfa ._bbg =&_gbc .ValAttr ;_fdg =true ;break ;};};for _ ,_gfee :=range _faga .B {if _gfee !=nil {_dcb :=_gfee .ValAttr ==nil ||*_gfee .ValAttr ;_aagfa ._cbab =&_dcb ;_fdg =true ;break ;};};for _ ,_cecb :=range _faga .I {if _cecb !=nil {_beef :=_cecb .ValAttr ==nil ||*_cecb .ValAttr ;_aagfa ._gdgae =&_beef ;_fdg =true ;break ;};};for _ ,_cbecd :=range _faga .U {if _cbecd !=nil {_add :=_cbecd .ValAttr ==_ced .ST_UnderlineValuesSingle ||_cbecd .ValAttr ==_ced .ST_UnderlineValuesUnset ;_aagfa ._bcd =&_add ;_fdg =true ;break ;};};for _ ,_cfcf :=range _faga .Sz {if _cfcf !=nil {_gfcg :=_cfcf .ValAttr /12*_gb .DefaultFontSize ;_aagfa ._efad =&_gfcg ;_fdg =true ;break ;};};for _ ,_caag :=range _faga .VertAlign {if _caag !=nil {_ffag :=_caag .ValAttr ==_bb .ST_VerticalAlignRunSuperscript ;_aagfa ._ffab =&_ffag ;_fede :=_caag .ValAttr ==_bb .ST_VerticalAlignRunSubscript ;_aagfa ._eac =&_fede ;_fdg =true ;break ;};};for _ ,_ccdf :=range _faga .Color {if _ccdf !=nil {_aagfa ._gege =_ebeg .getColorStringFromSmlColor (_ccdf );_fdg =true ;break ;};};_fdgd :=_cee .GetBorder ();if _fdgd .Top !=nil {_aagfa ._aagf =_ebeg .getBorder (_fdgd .Top );_fdg =true ;};if _fdgd .Bottom !=nil {_aagfa ._cbfb =_ebeg .getBorder (_fdgd .Bottom );_fdg =true ;};if _fdgd .Left !=nil {_aagfa ._gacee =_ebeg .getBorder (_fdgd .Left );_fdg =true ;};if _fdgd .Right !=nil {_aagfa ._gbf =_ebeg .getBorder (_fdgd .Right );_fdg =true ;};if _cee .Wrapped (){_aagfa ._gea =true ;_fdg =true ;};if _dcg :=_cee .GetVerticalAlignment ();_dcg !=_ced .ST_VerticalAlignmentUnset {_aagfa ._egd =_dcg ;_fdg =true ;};if _adfg :=_cee .GetHorizontalAlignment ();_adfg !=_ced .ST_HorizontalAlignmentUnset {_aagfa ._cbef =_adfg ;_fdg =true ;};};if _fdg {return _aagfa ;};return nil ;};const _ga =0.64;func (_cbee *convertContext )getBorder (_afbf *_ced .CT_BorderPr )*border {_afbd :=&border {};switch _afbf .StyleAttr {case _ced .ST_BorderStyleThin :_afbd ._fbbf =_fg ;case _ced .ST_BorderStyleMedium :_afbd ._fbbf =_fg *2;case _ced .ST_BorderStyleThick :_afbd ._fbbf =_fg *4;};if _afbd ._fbbf ==0.0{return nil ;};if _edbf :=_afbf .Color ;_edbf !=nil {_abfa :=_cbee .getColorStringFromSmlColor (_edbf );if _abfa !=nil {_afbd ._adbf =_e .ColorRGBFromHex (*_abfa );}else {_afbd ._adbf =_e .ColorBlack ;};};return _afbd ;};type rowInfo struct{_fffd float64 ;_bgc bool ;_fcaa float64 ;_egbg *style ;_eec []*cell ;_fggg float64 ;};type convertContext struct{_eefa *_e .Creator ;_cbbb *_d .Workbook ;_ggce *_be .Theme ;_bccb *_d .Sheet ;_aeg *_d .StyleSheet ;_dbc int ;_face int ;_fefc []*pagespan ;_dfdc *page ;_cbce []*colInfo ;_egca []*rowInfo ;_gbg []*rowspan ;_bcag float64 ;_ebae float64 ;_abg float64 ;_egf float64 ;_aadb []*mergedCell ;_abba []*anchor ;};func _adce (_bdac ,_addc *style ){if _addc ==nil {return ;};if _bdac ==nil {_bdac =_addc ;return ;};if _bdac ._bbg ==nil {_bdac ._bbg =_addc ._bbg ;};if _bdac ._gege ==nil {_bdac ._gege =_addc ._gege ;};if _bdac ._efad ==nil {_bdac ._efad =_addc ._efad ;};if _bdac ._cbab ==nil {_bdac ._cbab =_addc ._cbab ;};if _bdac ._gdgae ==nil {_bdac ._gdgae =_addc ._gdgae ;};if _bdac ._bcd ==nil {_bdac ._bcd =_addc ._bcd ;};if _bdac ._ffab ==nil {_bdac ._ffab =_addc ._ffab ;};if _bdac ._eac ==nil {_bdac ._eac =_addc ._eac ;};if _bdac ._aagf ==nil {_bdac ._aagf =_addc ._aagf ;};if _bdac ._cbfb ==nil {_bdac ._cbfb =_addc ._cbfb ;};if _bdac ._gacee ==nil {_bdac ._gacee =_addc ._gacee ;};if _bdac ._gbf ==nil {_bdac ._gbf =_addc ._gbf ;};if _bdac ._egd ==_ced .ST_VerticalAlignmentUnset {_bdac ._egd =_addc ._egd ;};if _bdac ._cbef ==_ced .ST_HorizontalAlignmentUnset {_bdac ._cbef =_addc ._cbef ;};};func (_fgce *convertContext )drawSheet (){for _cbgg ,_eebe :=range _fgce ._fefc {_ddaf :=len (_eebe ._eed );if _cbgg ==len (_fgce ._fefc )-1{for _dgde :=len (_eebe ._eed )-1;_dgde >=0;_dgde --{if !_eebe ._eed [_dgde ]._ebbf {_ddaf =_dgde ;};};};_eaf :=_eebe ._eed [:_ddaf ];for _ ,_bbee :=range _eaf {_fgce ._eefa .NewPage ();_fgce .drawPage (_bbee );};};};func (_fgfa *convertContext )makePagespans (){_fgfa ._fefc =[]*pagespan {};_bbb :=0.0;_eeb :=0;for _ded ,_fbc :=range _fgfa ._cbce {_ebb :=_fbc ._dfc ;if _bbb +_ebb <=_fgfa ._egf {_fbc ._bce =_bbb ;_bbb +=_ebb ;}else {_fbc ._bce =0;_fgfa ._fefc =append (_fgfa ._fefc ,&pagespan {_ebed :_bbb ,_fcea :_eeb ,_gced :_ded });_bbb =_ebb ;_eeb =_ded ;};};_fgfa ._fefc =append (_fgfa ._fefc ,&pagespan {_ebed :_bbb ,_fcea :_eeb ,_gced :len (_fgfa ._cbce )});};type pagespan struct{_ebed float64 ;_eed []*page ;_fcea int ;_gced int ;};type colInfo struct{_bce float64 ;_dfc float64 ;_abd *style ;};func (_gacg *convertContext )alignSymbolsHorizontally (_bfd *cell ,_cab _ced .ST_HorizontalAlignment ){if _cab ==_ced .ST_HorizontalAlignmentUnset {switch _bfd ._gebf {case _ced .ST_CellTypeB :_cab =_ced .ST_HorizontalAlignmentCenter ;case _ced .ST_CellTypeN :_cab =_ced .ST_HorizontalAlignmentRight ;default:_cab =_ced .ST_HorizontalAlignmentLeft ;};};var _ggd float64 ;for _ ,_bba :=range _bfd ._gdcf {switch _cab {case _ced .ST_HorizontalAlignmentLeft :_ggd =_eb ;case _ced .ST_HorizontalAlignmentRight :_ebeb :=_fcc (_bba ._cgfe );_ggd =_bfd ._bde -_eb -_ebeb ;case _ced .ST_HorizontalAlignmentCenter :_eccg :=_fcc (_bba ._cgfe );_ggd =(_bfd ._bde -_eccg )/2;};for _ ,_acd :=range _bba ._cgfe {_acd ._ebaf +=_ggd ;};};};func (_aaaf *convertContext )getColorFromTheme (_fcg uint32 )string {_bddag :=_aaaf ._cbbb .Themes ();if len (_bddag )!=0{_affg :=_bddag [0];if _dde :=_affg .ThemeElements ;_dde !=nil {if _dcef :=_dde .ClrScheme ;_dcef !=nil {switch _fcg {case 0:return _gb .GetColorStringFromDmlColor (_dcef .Lt1 );case 1:return _gb .GetColorStringFromDmlColor (_dcef .Dk1 );case 2:return _gb .GetColorStringFromDmlColor (_dcef .Lt2 );case 3:return _gb .GetColorStringFromDmlColor (_dcef .Dk2 );case 4:return _gb .GetColorStringFromDmlColor (_dcef .Accent1 );case 5:return _gb .GetColorStringFromDmlColor (_dcef .Accent2 );case 6:return _gb .GetColorStringFromDmlColor (_dcef .Accent3 );case 7:return _gb .GetColorStringFromDmlColor (_dcef .Accent4 );case 8:return _gb .GetColorStringFromDmlColor (_dcef .Accent5 );case 9:return _gb .GetColorStringFromDmlColor (_dcef .Accent6 );};};};};return "";};var _ec =_gefg (1);func (_dbed *convertContext )getStyleFromCell (_abbad _d .Cell ,_abe ,_cfe *style )*style {_gebff :=_abbad .X ();_gdfb :=_dbed .getStyle (_gebff .SAttr );_adce (_gdfb ,_abe );_adce (_gdfb ,_cfe );return _gdfb ;};func (_fddf *convertContext )getSymbolsFromR (_agdd []*_ced .CT_RElt ,_gdga *style )[]*symbol {_efc :=[]*symbol {};for _ ,_fcfd :=range _agdd {_agbb :=_fddf .combineCellStyleWithRPrElt (_gdga ,_fcfd .RPr );for _ ,_bdf :=range _fcfd .T {_efc =append (_efc ,&symbol {_aeaf :string (_bdf ),_fae :_fddf .makeTextStyleFromCellStyle (_agbb )});};};return _efc ;};var _ca =3.025/_gefg (1);var _ceag =[]string {"\u0030\u0030\u0030\u0030\u0030\u0030","\u0066\u0066\u0066\u0066\u0066\u0066","\u0066\u0066\u0030\u0030\u0030\u0030","\u0030\u0030\u0066\u0066\u0030\u0030","\u0030\u0030\u0030\u0030\u0066\u0066","\u0066\u0066\u0066\u0066\u0030\u0030","\u0066\u0066\u0030\u0030\u0066\u0066","\u0030\u0030\u0066\u0066\u0066\u0066","\u0030\u0030\u0030\u0030\u0030\u0030","\u0066\u0066\u0066\u0066\u0066\u0066","\u0066\u0066\u0030\u0030\u0030\u0030","\u0030\u0030\u0066\u0066\u0030\u0030","\u0030\u0030\u0030\u0030\u0066\u0066","\u0066\u0066\u0066\u0066\u0030\u0030","\u0066\u0066\u0030\u0030\u0066\u0066","\u0030\u0030\u0066\u0066\u0066\u0066","\u0038\u0030\u0030\u0030\u0030\u0030","\u0030\u0030\u0038\u0030\u0030\u0030","\u0030\u0030\u0030\u0030\u0038\u0030","\u0038\u0030\u0038\u0030\u0030\u0030","\u0038\u0030\u0030\u0030\u0038\u0030","\u0030\u0030\u0038\u0030\u0038\u0030","\u0063\u0030\u0063\u0030\u0063\u0030","\u0038\u0030\u0038\u0030\u0038\u0030","\u0039\u0039\u0039\u0039\u0066\u0066","\u0039\u0039\u0033\u0033\u0036\u0036","\u0066\u0066\u0066\u0066\u0063\u0063","\u0063\u0063\u0066\u0066\u0066\u0066","\u0036\u0036\u0030\u0030\u0036\u0036","\u0066\u0066\u0038\u0030\u0038\u0030","\u0030\u0030\u0036\u0036\u0063\u0063","\u0063\u0063\u0063\u0063\u0066\u0066","\u0030\u0030\u0030\u0030\u0038\u0030","\u0066\u0066\u0030\u0030\u0066\u0066","\u0066\u0066\u0066\u0066\u0030\u0030","\u0030\u0030\u0066\u0066\u0066\u0066","\u0038\u0030\u0030\u0030\u0038\u0030","\u0038\u0030\u0030\u0030\u0030\u0030","\u0030\u0030\u0038\u0030\u0038\u0030","\u0030\u0030\u0030\u0030\u0066\u0066","\u0030\u0030\u0063\u0063\u0066\u0066","\u0063\u0063\u0066\u0066\u0066\u0066","\u0063\u0063\u0066\u0066\u0063\u0063","\u0066\u0066\u0066\u0066\u0039\u0039","\u0039\u0039\u0063\u0063\u0066\u0066","\u0066\u0066\u0039\u0039\u0063\u0063","\u0063\u0063\u0039\u0039\u0066\u0066","\u0066\u0066\u0063\u0063\u0039\u0039","\u0033\u0033\u0036\u0036\u0066\u0066","\u0033\u0033\u0063\u0063\u0063\u0063","\u0039\u0039\u0063\u0063\u0030\u0030","\u0066\u0066\u0063\u0063\u0030\u0030","\u0066\u0066\u0039\u0039\u0030\u0030","\u0066\u0066\u0036\u0036\u0030\u0030","\u0036\u0036\u0036\u0036\u0039\u0039","\u0039\u0036\u0039\u0036\u0039\u0036","\u0030\u0030\u0033\u0033\u0036\u0036","\u0033\u0033\u0039\u0039\u0036\u0036","\u0030\u0030\u0033\u0033\u0030\u0030","\u0033\u0033\u0033\u0033\u0030\u0030","\u0039\u0039\u0033\u0033\u0030\u0030","\u0039\u0039\u0033\u0033\u0036\u0036","\u0033\u0033\u0033\u0033\u0039\u0039","\u0033\u0033\u0033\u0033\u0033\u0033"};func (_ecgd *convertContext )alignSymbolsVertically (_aac *cell ,_dff _ced .ST_VerticalAlignment ){var _bgae float64 ;switch _dff {case _ced .ST_VerticalAlignmentTop :_bgae =_bd ;if _aac ._cccb {_bgae -=_bf ;}else if _aac ._aaee {_bgae +=4*_bf ;};for _ ,_gfe :=range _aac ._gdcf {_bgae +=_gfe ._fdfc ;_gfe ._aabb =_bgae ;_bgae +=_ec ;};case _ced .ST_VerticalAlignmentCenter :_ebg :=0.0;for _ ,_eea :=range _aac ._gdcf {_ebg +=_eea ._fdfc +_gefg (1);};_bgae =0.5*(_aac ._gaa -_ebg );if _aac ._cccb {_bgae -=2*_bf ;}else if _aac ._aaee {_bgae +=2*_bf ;};for _ ,_feed :=range _aac ._gdcf {_bgae +=_feed ._fdfc +0.5*_ec ;_feed ._aabb =_bgae ;_bgae +=0.5*_ec ;};default:_bgae =_aac ._gaa -_bd ;if _aac ._cccb {_bgae -=4*_bf ;}else if _aac ._aaee {_bgae +=_bf ;};for _ecc :=len (_aac ._gdcf )-1;_ecc >=0;_ecc --{_aac ._gdcf [_ecc ]._aabb =_bgae ;_bgae -=_aac ._gdcf [_ecc ]._fdfc ;_bgae -=_ec ;};};};func (_feg *convertContext )combineCellStyleWithRPrElt (_afff *style ,_egab *_ced .CT_RPrElt )*style {_bggc :=*_afff ;_fbae :=_feg .getStyleFromRPrElt (_egab );if _fbae ==nil {return &_bggc ;};if _fbae ._gege !=nil {_bggc ._gege =_fbae ._gege ;};if _fbae ._efad !=nil {_bggc ._efad =_fbae ._efad ;};if _fbae ._bbg !=nil {_bggc ._bbg =_fbae ._bbg ;};if _fbae ._cbab !=nil {_bggc ._cbab =_fbae ._cbab ;};if _fbae ._gdgae !=nil {_bggc ._gdgae =_fbae ._gdgae ;};if _fbae ._bcd !=nil {_bggc ._bcd =_fbae ._bcd ;};if _fbae ._ffab !=nil {_bggc ._ffab =_fbae ._ffab ;};if _fbae ._eac !=nil {_bggc ._eac =_fbae ._eac ;};return &_bggc ;};const (FontStyle_Regular FontStyle =0;FontStyle_Bold FontStyle =1;FontStyle_Italic FontStyle =2;FontStyle_BoldItalic FontStyle =3;);func (_bg *convertContext )makeAnchors (){_ag ,_cg :=_bg ._bccb .GetDrawing ();if _ag !=nil {for _ ,_gac :=range _ag .EG_Anchor {_dbf :=&anchor {};if _ee :=_gac .TwoCellAnchor ;_ee !=nil {_de ,_bgf :=_ee .From ,_ee .To ;if _de ==nil ||_bgf ==nil {return ;};_dbf ._ebfd =int (_de .Row );_dbf ._adc =_gb .FromSTCoordinate (_de .RowOff );_dbf ._afga =int (_de .Col );_dbf ._aeaa =_gb .FromSTCoordinate (_de .ColOff );_dbf ._cfdc =int (_bgf .Row );_dbf ._fgad =_gb .FromSTCoordinate (_bgf .RowOff );_dbf ._eacd =int (_bgf .Col );_dbf ._gag =_gb .FromSTCoordinate (_bgf .ColOff );if _gd :=_ee .Choice ;_gd !=nil {if _fa :=_gd .Pic ;_fa !=nil {if _bbc :=_fa .BlipFill ;_bbc !=nil {if _dd :=_bbc .Blip ;_dd !=nil {if _fe :=_dd .EmbedAttr ;_fe !=nil {for _ ,_fef :=range _cg .X ().Relationship {if _fef .IdAttr ==*_fe {for _ ,_ace :=range _bg ._cbbb .Images {if _ace .Target ()==_fef .TargetAttr {_gg ,_fc :=_ba .Open (_ace .Path ());if _fc !=nil {_ce .Log .Debug ("\u004fp\u0065\u006e\u0020\u0069m\u0061\u0067\u0065\u0020\u0066i\u006ce\u0020e\u0072\u0072\u006f\u0072\u003a\u0020\u0025s",_fc );continue ;};_bdg ,_ ,_fc :=_a .Decode (_gg );if _fc !=nil {_ce .Log .Debug ("\u0044\u0065\u0063\u006fde\u0020\u0069\u006d\u0061\u0067\u0065\u0020\u0065\u0072\u0072\u006f\u0072\u003a\u0020%\u0073",_fc );continue ;};_dbf ._cgaf =_bdg ;};};};};};};};}else if _ggb :=_gd .GraphicFrame ;_ggb !=nil {if _dgd :=_ggb .Graphic ;_dgd !=nil {if _eef :=_dgd .GraphicData ;_eef !=nil {for _ ,_cgf :=range _eef .Any {if _fca ,_cfa :=_cgf .(*_cf .Chart );_cfa {for _ ,_ebe :=range _cg .X ().Relationship {if _ebe .IdAttr ==_fca .IdAttr {_acg :=_bg ._cbbb .GetChartByTargetId (_ebe .TargetAttr );if _acg !=nil {_dbf ._fagc =_acg ;};};};};};};};};};};if _dbf ._cgaf !=nil ||_dbf ._fagc !=nil {_bg ._abba =append (_bg ._abba ,_dbf );};};};};func (_def *convertContext )getColorStringFromSmlColor (_bec *_ced .CT_Color )*string {var _bbcbg string ;if _bec .RgbAttr !=nil {_bbcbg =*_bec .RgbAttr ;}else if _bec .IndexedAttr !=nil &&*_bec .IndexedAttr < 64{_bbcbg =_ceag [*_bec .IndexedAttr ];}else if _bec .ThemeAttr !=nil {_egbc :=*_bec .ThemeAttr ;_bbcbg =_def .getColorFromTheme (_egbc );};if _bbcbg ==""{return nil ;};if len (_bbcbg )> 6{_bbcbg =_bbcbg [(len (_bbcbg )-6):];};if _bec .TintAttr !=nil {_cfeg :=*_bec .TintAttr ;_bbcbg =_gb .AdjustColorByTint (_bbcbg ,_cfeg );};_bbcbg ="\u0023"+_bbcbg ;return &_bbcbg ;};

// RegisterFont makes a PdfFont accessible for using in converting to PDF.
func RegisterFont (name string ,style FontStyle ,font *_b .PdfFont ){_gb .RegisterFont (name ,style ,font );};const _bf =1.5;func (_cc *convertContext )makeCells (){_ddc :=_cc ._bccb ;_afb :=_ddc .Rows ();_cfc :=0;for _ ,_fcaf :=range _cc ._egca {_fcaf ._eec =[]*cell {};_gfc :=0.0;_fdd :=_fcaf ._egbg ;if _fcaf ._bgc {_bgaf :=_afb [_cfc ];_cfc ++;_cac :=_fcaf ._fcaa ;for _ ,_feef :=range _bgaf .Cells (){_dbfc ,_ab :=_f .ParseCellReference (_feef .Reference ());if _ab !=nil {_ce .Log .Debug ("\u0043\u0061\u006e\u006eo\u0074\u0020\u0070\u0061\u0072\u0073\u0065\u0020\u0061\u0020r\u0065f\u0065\u0072\u0065\u006e\u0063\u0065\u003a \u0025\u0073",_ab );continue ;};_adf :=_cc ._cbce [_dbfc .ColumnIdx ];_eg :=_adf ._dfc ;_baf :=_eg ;_dc :=_adf ._abd ;var _bdd ,_fcb ,_bda ,_dea bool ;for _ ,_feb :=range _cc ._aadb {if _dbfc .RowIdx >=_feb ._bcdc &&_dbfc .RowIdx <=_feb ._ebee &&_dbfc .ColumnIdx >=_feb ._ecde &&_dbfc .ColumnIdx <=_feb ._gcd {if _dbfc .ColumnIdx ==_feb ._ecde &&_dbfc .RowIdx ==_feb ._bcdc {_eg =_feb ._efac ;_cac =_feb ._egbgb ;};_bdd =_dbfc .RowIdx !=_feb ._bcdc ;_fcb =_dbfc .RowIdx !=_feb ._ebee ;_bda =_dbfc .ColumnIdx !=_feb ._ecde ;_dea =_dbfc .ColumnIdx !=_feb ._gcd ;};};_dbd :=_cc .getStyleFromCell (_feef ,_fdd ,_dc );var _ed ,_eeff ,_aad bool ;var _ead ,_cff ,_bea ,_aee *border ;var _eab _ced .ST_VerticalAlignment ;var _ceg _ced .ST_HorizontalAlignment ;if _dbd !=nil {if !_bdd {_ead =_dbd ._aagf ;};if !_fcb {_cff =_dbd ._cbfb ;};if !_bda {_bea =_dbd ._gacee ;};if !_dea {_aee =_dbd ._gbf ;};if _cff !=nil &&_cff ._fbbf > _gfc {_gfc =_cff ._fbbf ;};_eab =_dbd ._egd ;_ceg =_dbd ._cbef ;if _dbd ._ffab !=nil {_ed =*_dbd ._ffab ;};if _dbd ._eac !=nil {_eeff =*_dbd ._eac ;};_aad =_dbd ._gea ;};_agb ,_dgf :=_cc .getContentFromCell (_feef ,_dbd ,_eg ,_aad );_affd :=&cell {_gebf :_dgf ,_bde :_eg ,_bcf :_baf ,_gaa :_cac ,_gdcf :_agb ,_fga :_ead ,_dba :_cff ,_aada :_bea ,_cgd :_aee ,_cccb :_ed ,_aaee :_eeff };_cc .alignSymbolsHorizontally (_affd ,_ceg );_cc .alignSymbolsVertically (_affd ,_eab );_fcaf ._eec =append (_fcaf ._eec ,_affd );};};_fcaf ._fggg =_gfc ;};};type anchor struct{_cgaf _a .Image ;_fagc *_cf .ChartSpace ;_ebfd int ;_adc int64 ;_afga int ;_aeaa int64 ;_cfdc int ;_fgad int64 ;_eacd int ;_gag int64 ;};func (_agdde *convertContext )makeTextStyleFromCellStyle (_eag *style )*_e .TextStyle {_cge :=_agdde ._eefa .NewTextStyle ();if _eag ==nil {_cge .FontSize =_gb .DefaultFontSize ;_cge .Font =_gb .AssignStdFontByName (_cge ,_gb .StdFontsMap ["\u0064e\u0066\u0061\u0075\u006c\u0074"][FontStyle_Regular ]);return &_cge ;};if _becc (_eag ._bcd ){_cge .Underline =true ;_cge .UnderlineStyle =_e .TextDecorationLineStyle {Offset :0.5,Thickness :_gefg (1/32)};};var _aebc FontStyle ;if _becc (_eag ._cbab )&&_becc (_eag ._gdgae ){_aebc =FontStyle_BoldItalic ;}else if _becc (_eag ._cbab ){_aebc =FontStyle_Bold ;}else if _becc (_eag ._gdgae ){_aebc =FontStyle_Italic ;}else {_aebc =FontStyle_Regular ;};_eaec :="\u0064e\u0066\u0061\u0075\u006c\u0074";if _eag ._bbg !=nil {_eaec =*_eag ._bbg ;};if _fbd ,_ebea :=_gb .StdFontsMap [_eaec ];_ebea {_cge .Font =_gb .AssignStdFontByName (_cge ,_fbd [_aebc ]);}else if _cgdg :=_gb .GetRegisteredFont (_eaec ,_aebc );_cgdg !=nil {_cge .Font =_cgdg ;}else {_ce .Log .Debug ("\u0046\u006f\u006e\u0074\u0020\u0025\u0073\u0020\u0077\u0069\u0074h\u0020\u0073\u0074\u0079\u006c\u0065\u0020\u0025s\u0020i\u0073\u0020\u006e\u006f\u0074\u0020\u0066\u006f\u0075\u006e\u0064\u002c\u0020\u0072\u0065\u0073\u0065\u0074 \u0074\u006f\u0020\u0064\u0065\u0066\u0061\u0075\u006c\u0074\u002e",_eaec ,_aebc );_cge .Font =_gb .AssignStdFontByName (_cge ,_gb .StdFontsMap ["\u0064e\u0066\u0061\u0075\u006c\u0074"][_aebc ]);};if _eag ._efad !=nil {_cge .FontSize =*_eag ._efad ;};if _eag ._gege !=nil {_cge .Color =_e .ColorRGBFromHex (*_eag ._gege );};if _eag ._ffab !=nil &&*_eag ._ffab {_cge .FontSize *=_ga ;}else if _eag ._eac !=nil &&*_eag ._eac {_cge .FontSize *=_ga ;};return &_cge ;};func _gefg (_ccdb float64 )float64 {return _ccdb *_ae .Millimeter };func (_fdda *convertContext )makeRowspans (){var _cbc float64 ;_ff :=0;for _cag ,_bafe :=range _fdda ._egca {_cbb :=_bafe ._fcaa +_bafe ._fggg ;if _cbc +_cbb <=_fdda ._abg {_bafe ._fffd =_cbc ;_cbc +=_cbb ;}else {_fdda ._gbg =append (_fdda ._gbg ,&rowspan {_afg :_cbc ,_aebb :_ff ,_fbee :_cag });_ff =_cag ;_bafe ._fffd =0;_cbc =_cbb ;};};_fdda ._gbg =append (_fdda ._gbg ,&rowspan {_afg :_cbc ,_aebb :_ff ,_fbee :len (_fdda ._egca )});};type border struct{_fbbf float64 ;_adbf _e .Color ;};func (_agf *convertContext )getSymbolsFromString (_gec string ,_dadge *style )[]*symbol {_eefb :=[]*symbol {};_cfca :=_agf .makeTextStyleFromCellStyle (_dadge );for _ ,_ddgc :=range _gec {_eefb =append (_eefb ,&symbol {_aeaf :string (_ddgc ),_fae :_cfca });};return _eefb ;};func (_aabf *convertContext )addRowToPage (_dgeg []*cell ,_aede int ){_afa :=0.0;_cfdg :=_aabf ._egf ;for _ ,_ccc :=range _dgeg {if len (_ccc ._gdcf )!=0{_ccc ._bbbc =_afa ;_afa =_ccc ._bffg +_ccc ._bde ;};};for _dgdef :=len (_dgeg )-1;_dgdef >=0;_dgdef --{_gdbg :=_dgeg [_dgdef ];if len (_gdbg ._gdcf )!=0{_gdbg ._gbge =_cfdg ;_cfdg =_gdbg ._bffg ;};};_aabf ._dfdc ._bdda =append (_aabf ._dfdc ._bdda ,&pageRow {_cdff :_aede ,_cbdb :_dgeg });};const _eb =3;func (_bdc *convertContext )drawPage (_fddc *page ){_dgce :=_bdc ._bcag ;_egc :=_bdc ._ebae ;for _ ,_cdda :=range _fddc ._bdda {_aeab :=_bdc ._egca [_cdda ._cdff ];for _ ,_bee :=range _cdda ._cbdb {_abfd :=_bee ._bbbc < _bee ._bffg ;_bbf :=_bee ._gbge > _bee ._bffg +_bee ._bde ;var _fadd ,_fdf bool ;for _ ,_ebad :=range _bee ._gdcf {for _ ,_ddfa :=range _ebad ._cgfe {if _abfd &&!_fadd {_fadd =_ddfa ._ebaf < 0;};if _bbf &&!_fdf {_fdf =_bee ._bde < _ddfa ._ebaf +_ddfa ._fceca ;};if _bee ._bffg +_ddfa ._ebaf >=_bee ._bbbc &&_bee ._bffg +_ddfa ._ebaf +_ddfa ._fceca <=_bee ._gbge {_ege :=_bdc ._eefa .NewStyledParagraph ();_gda :=_egc +_bee ._bffg +_ddfa ._ebaf ;_fff :=_dgce +_aeab ._fffd +_ebad ._aabb -_ddfa ._fgfag -_gefg (0.5);_ege .SetPos (_gda ,_fff );var _ccg *_e .TextChunk ;if _ddfa ._cbeg !=""{_ccg =_ege .AddExternalLink (_ddfa ._aeaf ,_ddfa ._cbeg );}else {_ccg =_ege .Append (_ddfa ._aeaf );};if _ddfa ._fae !=nil {_ccg .Style =*_ddfa ._fae ;};_bdc ._eefa .Draw (_ege );};};};var _afe ,_aae ,_gcg ,_gcb ,_dcc ,_bbdc float64 ;var _caa ,_efa ,_dcde ,_bfb _e .Color ;if _adfe :=_bee ._fga ;_adfe !=nil {_afe =_adfe ._fbbf ;_caa =_adfe ._adbf ;};if _gdf :=_bee ._dba ;_gdf !=nil {_aae =_gdf ._fbbf ;_efa =_gdf ._adbf ;};if _fgg :=_bee ._aada ;_fgg !=nil {_gcg =_fgg ._fbbf ;_dcc =_gcg /2;_dcde =_fgg ._adbf ;};if _gef :=_bee ._cgd ;_gef !=nil {_gcb =_gef ._fbbf ;_bbdc =_gcb /2;_bfb =_gef ._adbf ;};var _fba float64 ;if _cdda ._cdff > 1{_fba =_bdc ._egca [_cdda ._cdff -1]._fggg ;};_bgg :=_dgce +_aeab ._fffd -0.5*(_fba -_afe );_dcdc :=_dgce +_aeab ._fffd +_aeab ._fcaa +0.5*(_aeab ._fggg +_aae );_beeb :=_egc +_bee ._bffg ;_febf :=_beeb +_bee ._bcf ;_gb .DrawLine (_bdc ._eefa ,_beeb ,_bgg ,_febf ,_bgg ,_afe ,_caa );_gb .DrawLine (_bdc ._eefa ,_beeb ,_dcdc ,_febf ,_dcdc ,_aae ,_efa );if !_fadd {_gb .DrawLine (_bdc ._eefa ,_beeb -_dcc ,_bgg ,_beeb -_dcc ,_dcdc ,_gcg ,_dcde );};if !_fdf {_gb .DrawLine (_bdc ._eefa ,_febf -_bbdc ,_bgg ,_febf -_bbdc ,_dcdc ,_gcb ,_bfb );};};};for _ ,_dae :=range _fddc ._agc {if _dae !=nil {_bdc ._eefa .Draw (_dae );};};};type page struct{_bdda []*pageRow ;_ebbf bool ;_agc []*_e .Image ;_cbf *pagespan ;_ebdd *rowspan ;};type cell struct{_gebf _ced .ST_CellType ;_gdfg int ;_bffg float64 ;_gdcf []*line ;_bde float64 ;_bcf float64 ;_gaa float64 ;_bbbc float64 ;_gbge float64 ;_fbf *_e .TextStyle ;_fga *border ;_dba *border ;_aada *border ;_cgd *border ;_cccb bool ;_aaee bool ;};func _bgab (_cef []*symbol )float64 {_accc :=0.0;for _ ,_edb :=range _cef {if _edb ._fgfag > _accc {_accc =_edb ._fgfag ;};};return _accc ;};func (_cde *convertContext )makeRows (){_cbd :=[]*rowInfo {};_gace :=_cde ._bccb .Rows ();_fd :=0;for _ ,_aff :=range _gace {_fd ++;_gde :=int (_aff .RowNumber ());if _gde > _fd {for _aabc :=_fd ;_aabc < _gde ;_aabc ++{_cbd =append (_cbd ,&rowInfo {_fcaa :16/_ca });};_fd =_gde ;};var _bfg float64 ;if _aff .X ().HtAttr ==nil {_bfg =16;}else {_bfg =*_aff .X ().HtAttr ;};_cbd =append (_cbd ,&rowInfo {_fcaa :_bfg /_ca ,_bgc :true ,_egbg :_cde .getStyle (_aff .X ().SAttr )});};for _faa :=len (_cbd );_faa < _cde ._dbc ;_faa ++{_cbd =append (_cbd ,&rowInfo {_fcaa :16/_ca });};_cde ._egca =_cbd ;};