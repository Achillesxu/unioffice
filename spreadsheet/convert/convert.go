//
// Copyright 2020 FoxyUtils ehf. All rights reserved.
//
// This is a commercial product and requires a license to operate.
// A trial license can be obtained at https://unidoc.io
//
// DO NOT EDIT: generated by unitwist Go source code obfuscator.
//
// Use of this source code is governed by the UniDoc End User License Agreement
// terms that can be accessed at https://unidoc.io/eula/

package convert ;import (_f "github.com/unidoc/unioffice/common/logger";_ff "github.com/unidoc/unioffice/common/tempstorage";_dd "github.com/unidoc/unioffice/internal/convertutils";_af "github.com/unidoc/unioffice/measurement";_fe "github.com/unidoc/unioffice/schema/soo/dml";_e "github.com/unidoc/unioffice/schema/soo/dml/chart";_g "github.com/unidoc/unioffice/schema/soo/ofc/sharedTypes";_bc "github.com/unidoc/unioffice/schema/soo/sml";_fb "github.com/unidoc/unioffice/spreadsheet";_fd "github.com/unidoc/unioffice/spreadsheet/reference";_ce "github.com/unidoc/unipdf/v3/creator";_b "github.com/unidoc/unipdf/v3/model";_c "image";_d "strconv";);func (_gce *convertContext )getSymbolsFromString (_dbbg string ,_fcb *style )[]*symbol {_gbea :=[]*symbol {};_cfe :=_gce .makeTextStyleFromCellStyle (_fcb );for _ ,_cfd :=range _dbbg {_gbea =append (_gbea ,&symbol {_cbef :string (_cfd ),_dffd :_cfe });};return _gbea ;};type symbol struct{_cbef string ;_aca float64 ;_gdcg float64 ;_eeeg float64 ;_dffd *_ce .TextStyle ;_edfg string ;};func (_fg *convertContext )makeRows (){_eee :=[]*rowInfo {};_gab :=_fg ._fggb .Rows ();_gbg :=0;for _ ,_dcc :=range _gab {_gbg ++;_aegf :=int (_dcc .RowNumber ());if _aegf > _gbg {for _bab :=_gbg ;_bab < _aegf ;_bab ++{_eee =append (_eee ,&rowInfo {_gbbdd :16/_ebg });};_gbg =_aegf ;};var _adb float64 ;if _dcc .X ().HtAttr ==nil {_adb =16;}else {_adb =*_dcc .X ().HtAttr ;};_eee =append (_eee ,&rowInfo {_gbbdd :_adb /_ebg ,_aaf :true ,_fgcef :_fg .getStyle (_dcc .X ().SAttr )});};for _edb :=len (_eee );_edb < _fg ._bgd ;_edb ++{_eee =append (_eee ,&rowInfo {_gbbdd :16/_ebg });};_fg ._cbcfd =_eee ;};func (_acf *convertContext )getStyleFromCell (_dbgfg _fb .Cell ,_eea ,_edeb *style )*style {_fcac :=_dbgfg .X ();_cafd :=_acf .getStyle (_fcac .SAttr );_debf (_cafd ,_eea );_debf (_cafd ,_edeb );return _cafd ;};func _ddca (_gacd *symbol ){_aac :=_ce .New ();_aaa :=_aac .NewStyledParagraph ();_aaa .SetMargins (0,0,0,0);_aec :=_aaa .Append (_gacd ._cbef );if _gacd ._dffd !=nil {_aec .Style =*_gacd ._dffd ;};_gacd ._gdcg =_aaa .Height ();if _gacd ._eeeg ==0{_gacd ._eeeg =_aaa .Width ();};};func (_cda *convertContext )getSymbolsFromR (_egc []*_bc .CT_RElt ,_ddde *style )[]*symbol {_cge :=[]*symbol {};for _ ,_daa :=range _egc {_bda :=_cda .combineCellStyleWithRPrElt (_ddde ,_daa .RPr );for _ ,_gef :=range _daa .T {_cge =append (_cge ,&symbol {_cbef :string (_gef ),_dffd :_cda .makeTextStyleFromCellStyle (_bda )});};};return _cge ;};func (_cgca *convertContext )makeMergedCells (){_abd :=[]*mergedCell {};for _ ,_beb :=range _cgca ._fggb .MergedCells (){_gag ,_ebc ,_gbgb :=_fd .ParseRangeReference (_beb .Reference ());if _gbgb !=nil {_f .Log .Debug ("\u0065\u0072r\u006f\u0072\u0020\u0070\u0061\u0072\u0073\u0069\u006e\u0067\u0020\u006d\u0065\u0072\u0067\u0065\u0064\u0020\u0063\u0065\u006c\u006c: \u0025\u0073",_gbgb );continue ;};_fca :=mergedCell {_caff :_gag .RowIdx ,_bbdac :_gag .ColumnIdx ,_bcee :_ebc .RowIdx ,_dfec :_ebc .ColumnIdx };for _fgd :=_fca ._bbdac -1;_fgd < _fca ._dfec ;_fgd ++{_fca ._cgdb +=_cgca ._gage [_fgd ]._cad ;};for _adeb :=_fca ._caff -1;_adeb < _fca ._bcee ;_adeb ++{_fca ._aaae +=_cgca ._cbcfd [_adeb ]._gbbdd ;};_abd =append (_abd ,&_fca );};_cgca ._adf =_abd ;};type line struct{_egf float64 ;_gcc []*symbol ;_bfbb float64 ;};func (_edec *convertContext )addRowToPage (_gffa []*cell ,_cgff int ){_bbc :=0.0;_afd :=_edec ._adc ;for _ ,_dgd :=range _gffa {if len (_dgd ._ceb )!=0{_dgd ._efde =_bbc ;_bbc =_dgd ._gea +_dgd ._aecd ;};};for _gbgc :=len (_gffa )-1;_gbgc >=0;_gbgc --{_eeed :=_gffa [_gbgc ];if len (_eeed ._ceb )!=0{_eeed ._fgec =_afd ;_afd =_eeed ._gea ;};};_edec ._bgeg ._abcb =append (_edec ._bgeg ._abcb ,&pageRow {_cace :_cgff ,_fgcg :_gffa });};func (_baag *convertContext )getImage (_eac _c .Image ,_fbf ,_gffg ,_gbc ,_bac ,_gdg ,_bge float64 ,_deae _dd .ImgPart )*_ce .Image {_bac +=_baag ._fag ;_gbc +=_baag ._cgd ;_edea ,_ddgb :=_dd .GetImage (_baag ._acde ,_eac ,_fbf ,_gffg ,_gbc ,_bac ,_gdg ,_bge ,_deae );if _ddgb !=nil {_f .Log .Debug ("\u0043\u0061\u006eno\u0074\u0020\u0067\u0065\u0074\u0020\u0061\u006e\u0020\u0069\u006d\u0061\u0067\u0065\u003a\u0020\u0025\u0073",_ddgb );return nil ;};return _edea ;};func (_bed *convertContext )makePagespans (){_bed ._eafba =[]*pagespan {};_efd :=0.0;_dbgf :=0;for _dbb ,_edd :=range _bed ._gage {_caf :=_edd ._cad ;if _efd +_caf <=_bed ._adc {_edd ._ebcfc =_efd ;_efd +=_caf ;}else {_edd ._ebcfc =0;_bed ._eafba =append (_bed ._eafba ,&pagespan {_cefa :_efd ,_bgb :_dbgf ,_fbgc :_dbb });_efd =_caf ;_dbgf =_dbb ;};};_bed ._eafba =append (_bed ._eafba ,&pagespan {_cefa :_efd ,_bgb :_dbgf ,_fbgc :len (_bed ._gage )});};

// ConvertToPdf converts a sheet to a PDF file. This package is beta, breaking changes can take place.
func ConvertToPdf (s *_fb .Sheet )*_ce .Creator {_dc :=s .X ();if _dc ==nil {return nil ;};var _cbe _ce .PageSize ;var _ea bool ;if _cg :=_dc .PageSetup ;_cg !=nil {if _gbb :=_cg .PaperSizeAttr ;_gbb !=nil {_cbe =_fef [*_gbb ];};_ea =_cg .OrientationAttr ==_bc .ST_OrientationLandscape ;};if (_cbe ==_ce .PageSize {}){_cbe =_fef [1];};if _ea {_cbe [0],_cbe [1]=_cbe [1],_cbe [0];};_ac :=_ce .New ();_ac .SetPageSize (_cbe );var _fc ,_agc ,_ab ,_fdb float64 ;if _aeg :=_dc .PageMargins ;_aeg !=nil {_ab =_aeg .LeftAttr ;_fdb =_aeg .RightAttr ;_fc =_aeg .TopAttr ;_agc =_aeg .BottomAttr ;};if _ab < 0.25{_ab =0.25;};if _fdb < 0.25{_fdb =0.25;};_fc *=_af .Inch ;_agc *=_af .Inch ;_ab *=_af .Inch ;_fdb *=_af .Inch ;_ac .SetPageMargins (_ab ,_fdb ,_fc ,_agc );_dg :=s .Workbook ();var _ec *_fe .Theme ;if len (_dg .Themes ())> 0{_ec =_dg .Themes ()[0];};_aef :=&convertContext {_acde :_ac ,_fggb :s ,_adaa :s .Workbook (),_cfg :_ec ,_bbda :&s .Workbook ().StyleSheet ,_fag :_fc ,_cgd :_ab ,_cgeb :_cbe [1]-_agc -_fc ,_adc :_cbe [0]-_fdb -_ab };_aef .makeAnchors ();_aef .determineMaxIndexes ();if _aef ._bgd ==0&&_aef ._bcea ==0{_ac .NewPage ();return _ac ;};_aef .makeCols ();_aef .makeRows ();_aef .makeMergedCells ();_aef .makeCells ();_aef .makePagespans ();_aef .makeRowspans ();_aef .makePages ();_aef .fillPages ();_aef .distributeAnchors ();_aef .drawSheet ();return _ac ;};type rowspan struct{_aagc float64 ;_fdea int ;_fdeg int ;};var _cb =_cgea (0.0625);func _dgbb (_gede []*symbol )float64 {_aacg :=0.0;for _ ,_caa :=range _gede {_aacg +=_caa ._eeeg ;};return _aacg ;};type anchor struct{_cagf _c .Image ;_acgf *_e .ChartSpace ;_efcd int ;_bgda int64 ;_bae int ;_ceg int64 ;_faa int ;_gga int64 ;_daf int ;_bafa int64 ;};func _bedd (_cfa []*symbol )float64 {_gba :=0.0;for _ ,_eebf :=range _cfa {if _eebf ._gdcg > _gba {_gba =_eebf ._gdcg ;};};return _gba ;};func (_gbba *convertContext )imageFromAnchor (_fcae *anchor ,_gad ,_dbac float64 )_c .Image {if _fcae ._cagf !=nil {return _fcae ._cagf ;};if _fcae ._acgf !=nil {_dbcf ,_bedc :=_dd .MakeImageFromChartSpace (_fcae ._acgf ,_gad ,_dbac ,_gbba ._cfg );if _bedc !=nil {_f .Log .Debug ("C\u0061\u006e\u006e\u006f\u0074\u0020\u006d\u0061\u006b\u0065\u0020\u0061\u006e\u0020\u0069\u006d\u0061\u0067e\u0020\u0066\u0072\u006f\u006d\u0020\u0063\u0068\u0061\u0072tS\u0070\u0061\u0063e\u003a \u0025\u0073",_bedc );return nil ;};return _dbcf ;};return nil ;};type colInfo struct{_ebcfc float64 ;_cad float64 ;_ebe *style ;};const _gb =0.64;const _ed =2;var _fef =map[uint32 ]_ce .PageSize {1:_ce .PageSize {8.5*_af .Inch ,11*_af .Inch },2:_ce .PageSize {8.5*_af .Inch ,11*_af .Inch },3:_ce .PageSize {11*_af .Inch ,17*_af .Inch },4:_ce .PageSize {17*_af .Inch ,11*_af .Inch },5:_ce .PageSize {8.5*_af .Inch ,14*_af .Inch },6:_ce .PageSize {5.5*_af .Inch ,8.5*_af .Inch },7:_ce .PageSize {7.5*_af .Inch ,10*_af .Inch },8:_ce .PageSize {_cgea (297),_cgea (420)},9:_ce .PageSize {_cgea (210),_cgea (297)},10:_ce .PageSize {_cgea (210),_cgea (297)},11:_ce .PageSize {_cgea (148),_cgea (210)},70:_ce .PageSize {_cgea (105),_cgea (148)},12:_ce .PageSize {_cgea (250),_cgea (354)},13:_ce .PageSize {_cgea (182),_cgea (257)},14:_ce .PageSize {8.5*_af .Inch ,13*_af .Inch },20:_ce .PageSize {4.125*_af .Inch ,9.5*_af .Inch },27:_ce .PageSize {_cgea (110),_cgea (220)},28:_ce .PageSize {_cgea (162),_cgea (229)},34:_ce .PageSize {_cgea (250),_cgea (176)},29:_ce .PageSize {_cgea (324),_cgea (458)},30:_ce .PageSize {_cgea (229),_cgea (324)},31:_ce .PageSize {_cgea (114),_cgea (162)},37:_ce .PageSize {3.88*_af .Inch ,7.5*_af .Inch },43:_ce .PageSize {_cgea (100),_cgea (148)},69:_ce .PageSize {_cgea (200),_cgea (148)}};const _ag =0.25;func (_cbdb *convertContext )alignSymbolsVertically (_cdab *cell ,_gddb _bc .ST_VerticalAlignment ){var _ffa float64 ;switch _gddb {case _bc .ST_VerticalAlignmentTop :_ffa =_ed ;if _cdab ._dcdg {_ffa -=_eb ;}else if _cdab ._bdaf {_ffa +=4*_eb ;};for _ ,_gfc :=range _cdab ._ceb {_ffa +=_gfc ._bfbb ;_gfc ._egf =_ffa ;_ffa +=_db ;};case _bc .ST_VerticalAlignmentCenter :_ggea :=0.0;for _ ,_fgg :=range _cdab ._ceb {_ggea +=_fgg ._bfbb +_cgea (1);};_ffa =0.5*(_cdab ._cbg -_ggea );if _cdab ._dcdg {_ffa -=2*_eb ;}else if _cdab ._bdaf {_ffa +=2*_eb ;};for _ ,_ega :=range _cdab ._ceb {_ffa +=_ega ._bfbb +0.5*_db ;_ega ._egf =_ffa ;_ffa +=0.5*_db ;};default:_ffa =_cdab ._cbg -_ed ;if _cdab ._dcdg {_ffa -=4*_eb ;}else if _cdab ._bdaf {_ffa +=_eb ;};for _cdae :=len (_cdab ._ceb )-1;_cdae >=0;_cdae --{_cdab ._ceb [_cdae ]._egf =_ffa ;_ffa -=_cdab ._ceb [_cdae ]._bfbb ;_ffa -=_db ;};};};func (_ddb *convertContext )getBorder (_gbf *_bc .CT_BorderPr )*border {_efb :=&border {};switch _gbf .StyleAttr {case _bc .ST_BorderStyleThin :_efb ._ccf =_cb ;case _bc .ST_BorderStyleMedium :_efb ._ccf =_cb *2;case _bc .ST_BorderStyleThick :_efb ._ccf =_cb *4;};if _efb ._ccf ==0.0{return nil ;};if _fdbd :=_gbf .Color ;_fdbd !=nil {_cded :=_ddb .getColorStringFromSmlColor (_fdbd );if _cded !=nil {_efb ._fged =_ce .ColorRGBFromHex (*_cded );}else {_efb ._fged =_ce .ColorBlack ;};};return _efb ;};func (_ged *convertContext )distributeAnchors (){for _ ,_dec :=range _ged ._gdc {_edbb ,_fbe :=_dec ._efcd ,_dec ._bgda ;_fbg ,_gaa :=_dec ._bae ,_dec ._ceg ;_dff ,_baf :=_dec ._faa ,_dec ._gga ;_cfb ,_gaca :=_dec ._daf ,_dec ._bafa ;var _eae ,_eaab ,_cab ,_eeg *page ;for _ ,_eef :=range _ged ._eafba {for _ ,_fde :=range _eef ._fbgaa {if _edbb >=_fde ._acggb ._fdea &&_edbb < _fde ._acggb ._fdeg {if _fbg >=_fde ._aegaf ._bgb &&_fbg < _fde ._aegaf ._fbgc {_fde ._fddc =true ;_eae =_fde ;};if _cfb >=_fde ._aegaf ._bgb &&_cfb < _fde ._aegaf ._fbgc {_fde ._fddc =true ;_eaab =_fde ;};};if _dff >=_fde ._acggb ._fdea &&_dff < _fde ._acggb ._fdeg {if _fbg >=_fde ._aegaf ._bgb &&_fbg < _fde ._aegaf ._fbgc {_fde ._fddc =true ;_eeg =_fde ;};if _cfb >=_fde ._aegaf ._bgb &&_cfb < _fde ._aegaf ._fbgc {_fde ._fddc =true ;_cab =_fde ;};};};};_aff :=_eae !=_eaab ;_dbfc :=_eae !=_eeg ;if _aff &&_dbfc {_gee :=_ged ._gage [_fbg ]._ebcfc +_af .FromEMU (_gaa );_eaf :=_eae ._aegaf ._cefa ;_deg :=_ged ._gage [_cfb ]._ebcfc +_af .FromEMU (_gaca );_dadb :=_ged ._cbcfd [_edbb ]._fdcd +_af .FromEMU (_fbe );_gfd :=float64 (_eae ._acggb ._aagc );_cbc :=_ged ._cbcfd [_dff ]._fdcd +_af .FromEMU (_baf );_dfe :=_deg +_eaf -_gee ;_cgg :=_cbc +_gfd -_dadb ;_dfg :=_ged .imageFromAnchor (_dec ,_dfe ,_cgg );_eae ._cfc =append (_eae ._cfc ,_ged .getImage (_dfg ,_cgg ,_dfe ,_gee ,_dadb ,_eaf -_gee ,_gfd -_dadb ,_dd .ImgPart_lt ));_eaab ._cfc =append (_eaab ._cfc ,_ged .getImage (_dfg ,_cgg ,_dfe ,0,_dadb ,_eaf -_gee ,_gfd -_dadb ,_dd .ImgPart_rt ));_eeg ._cfc =append (_eeg ._cfc ,_ged .getImage (_dfg ,_cgg ,_dfe ,_gee ,0,_eaf -_gee ,_gfd -_dadb ,_dd .ImgPart_lb ));_cab ._cfc =append (_cab ._cfc ,_ged .getImage (_dfg ,_cgg ,_dfe ,0,0,_eaf -_gee ,_gfd -_dadb ,_dd .ImgPart_rb ));}else if _aff {_adg :=_ged ._cbcfd [_edbb ]._fdcd +_af .FromEMU (_fbe );_fegd :=_ged ._cbcfd [_dff ]._fdcd +_af .FromEMU (_baf );_bce :=_ged ._gage [_fbg ]._ebcfc +_af .FromEMU (_gaa );_aedb :=_eae ._aegaf ._cefa ;_gfb :=_ged ._gage [_cfb ]._ebcfc +_af .FromEMU (_gaca );_afa :=_gfb +_aedb -_bce ;_fec :=_fegd -_adg ;_cff :=_ged .imageFromAnchor (_dec ,_afa ,_fec );_eae ._cfc =append (_eae ._cfc ,_ged .getImage (_cff ,_fec ,_afa ,_bce ,_adg ,_aedb -_bce ,0,_dd .ImgPart_l ));_eaab ._cfc =append (_eaab ._cfc ,_ged .getImage (_cff ,_fec ,_afa ,0,_adg ,_aedb -_bce ,0,_dd .ImgPart_r ));}else if _dbfc {_ebcf :=_ged ._gage [_fbg ]._ebcfc +_af .FromEMU (_gaa );_fae :=_ged ._gage [_cfb ]._ebcfc +_af .FromEMU (_gaca );_eec :=_ged ._cbcfd [_edbb ]._fdcd +_af .FromEMU (_fbe );_fcd :=float64 (_eae ._acggb ._aagc );_edac :=_ged ._cbcfd [_dff ]._fdcd +_af .FromEMU (_baf );_fbga :=_fae -_ebcf ;_gff :=_edac +_fcd -_eec ;_dfd :=_ged .imageFromAnchor (_dec ,_fbga ,_gff );_eae ._cfc =append (_eae ._cfc ,_ged .getImage (_dfd ,_gff ,_fbga ,_ebcf ,_eec ,0,_fcd -_eec ,_dd .ImgPart_t ));_eeg ._cfc =append (_eeg ._cfc ,_ged .getImage (_dfd ,_gff ,_fbga ,_ebcf ,0,0,_fcd -_eec ,_dd .ImgPart_b ));}else {_fbc :=_ged ._gage [_fbg ]._ebcfc +_af .FromEMU (_gaa );_ffb :=_ged ._gage [_cfb ]._ebcfc +_af .FromEMU (_gaca );_ddg :=_ged ._cbcfd [_edbb ]._fdcd +_af .FromEMU (_fbe );_ggd :=_ged ._cbcfd [_dff ]._fdcd +_af .FromEMU (_baf );_fccb :=_ffb -_fbc ;_bba :=_ggd -_ddg ;_fbb :=_ged .imageFromAnchor (_dec ,_fccb ,_bba );_eae ._cfc =append (_eae ._cfc ,_ged .getImage (_fbb ,_bba ,_fccb ,_fbc ,_ddg ,0,0,_dd .ImgPart_whole ));};};};var _ebg =3.025/_cgea (1);func (_bdf *convertContext )getContentFromCell (_cde _fb .Cell ,_efg *style ,_eegd float64 ,_cac bool )([]*line ,_bc .ST_CellType ){_cdgb :=_cde .X ();var _bec []*symbol ;switch _cdgb .TAttr {case _bc .ST_CellTypeS :_cc :=_cdgb .V ;if _cc !=nil {_ece ,_bdg :=_d .Atoi (*_cc );if _bdg ==nil {_efc :=_bdf ._adaa .SharedStrings .X ().Si [_ece ];if _efc .T !=nil {_bec =_bdf .getSymbolsFromString (*_efc .T ,_efg );}else if _efc .R !=nil {_bec =_bdf .getSymbolsFromR (_efc .R ,_efg );};};};case _bc .ST_CellTypeB :_dba :=_cdgb .V ;if _dba !=nil {if *_dba =="\u0030"{_bec =_bdf .getSymbolsFromString ("\u0046\u0041\u004cS\u0045",_efg );}else {_bec =_bdf .getSymbolsFromString ("\u0054\u0052\u0055\u0045",_efg );};};default:_bec =_bdf .getSymbolsFromString (_cde .GetFormattedValue (),_efg );};_fafe :=0.0;_eaaa :=0.0;var _cgcd []*line ;var _bdff bool ;if _efg !=nil {if _efg ._baff !=nil {if *_efg ._baff {_bdff =true ;};};if _efg ._bfd !=nil {if *_efg ._bfd {_bdff =true ;};};};if _cac {_cgcd =[]*line {};_gge :=_eegd -2*_ae ;_bcgc :=[]*symbol {};for _ ,_fdg :=range _bec {_ddca (_fdg );if _fafe +_fdg ._eeeg >=_gge {_fgce :=_bedd (_bcgc );if _bdff {_fgce /=_gb ;};_cgcd =append (_cgcd ,&line {_egf :_eaaa ,_gcc :_bcgc ,_bfbb :_fgce });_bcgc =[]*symbol {_fdg };_fafe =_fdg ._eeeg ;_eaaa +=_fgce ;}else {_fdg ._aca =_fafe ;_fafe +=_fdg ._eeeg ;_bcgc =append (_bcgc ,_fdg );};};_cec :=_bedd (_bcgc );if _bdff {_cec /=_gb ;};if len (_bcgc )> 0{_cgcd =append (_cgcd ,&line {_egf :_eaaa ,_gcc :_bcgc ,_bfbb :_cec });};}else {for _ ,_fff :=range _bec {_ddca (_fff );_fff ._aca =_fafe ;_fafe +=_fff ._eeeg ;};if len (_bec )> 0{_cgcd =[]*line {&line {_gcc :_bec ,_bfbb :_bedd (_bec )}};};};_bedg :=_cdgb .TAttr ;if _bedg ==_bc .ST_CellTypeUnset {_bedg =_bc .ST_CellTypeN ;};return _cgcd ,_bedg ;};func _cgea (_faeg float64 )float64 {return _faeg *_af .Millimeter };func _gfdb (_dbga *bool )bool {return _dbga !=nil &&*_dbga };

// FontStyle represents a kind of font styling. It can be FontStyle_Regular, FontStyle_Bold, FontStyle_Italic and FontStyle_BoldItalic.
type FontStyle =_dd .FontStyle ;type convertContext struct{_acde *_ce .Creator ;_adaa *_fb .Workbook ;_cfg *_fe .Theme ;_fggb *_fb .Sheet ;_bbda *_fb .StyleSheet ;_bgd int ;_bcea int ;_eafba []*pagespan ;_bgeg *page ;_gage []*colInfo ;_cbcfd []*rowInfo ;_eage []*rowspan ;_fag float64 ;_cgd float64 ;_cgeb float64 ;_adc float64 ;_adf []*mergedCell ;_gdc []*anchor ;};

// RegisterFont makes a PdfFont accessible for using in converting to PDF.
func RegisterFont (name string ,style FontStyle ,font *_b .PdfFont ){_dd .RegisterFont (name ,style ,font );};type rowInfo struct{_fdcd float64 ;_aaf bool ;_gbbdd float64 ;_fgcef *style ;_fea []*cell ;_dfab float64 ;};var _db =_cgea (1);const _ae =3;

// RegisterFontsFromDirectory registers all fonts from the given directory automatically detecting font families and styles.
func RegisterFontsFromDirectory (dirName string )error {return _dd .RegisterFontsFromDirectory (dirName )};func (_bbd *convertContext )makeRowspans (){var _bgc float64 ;_fge :=0;for _ace ,_aed :=range _bbd ._cbcfd {_bef :=_aed ._gbbdd +_aed ._dfab ;if _bgc +_bef <=_bbd ._cgeb {_aed ._fdcd =_bgc ;_bgc +=_bef ;}else {_bbd ._eage =append (_bbd ._eage ,&rowspan {_aagc :_bgc ,_fdea :_fge ,_fdeg :_ace });_fge =_ace ;_aed ._fdcd =0;_bgc =_bef ;};};_bbd ._eage =append (_bbd ._eage ,&rowspan {_aagc :_bgc ,_fdea :_fge ,_fdeg :len (_bbd ._cbcfd )});};type border struct{_ccf float64 ;_fged _ce .Color ;};func (_df *convertContext )makeAnchors (){_eag ,_gd :=_df ._fggb .GetDrawing ();if _eag !=nil {for _ ,_dcd :=range _eag .EG_Anchor {_ga :=&anchor {};if _ge :=_dcd .TwoCellAnchor ;_ge !=nil {_aea ,_cba :=_ge .From ,_ge .To ;if _aea ==nil ||_cba ==nil {return ;};_ga ._efcd =int (_aea .Row );_ga ._bgda =_dd .FromSTCoordinate (_aea .RowOff );_ga ._bae =int (_aea .Col );_ga ._ceg =_dd .FromSTCoordinate (_aea .ColOff );_ga ._faa =int (_cba .Row );_ga ._gga =_dd .FromSTCoordinate (_cba .RowOff );_ga ._daf =int (_cba .Col );_ga ._bafa =_dd .FromSTCoordinate (_cba .ColOff );if _eab :=_ge .Choice ;_eab !=nil {if _cgc :=_eab .Pic ;_cgc !=nil {if _gbe :=_cgc .BlipFill ;_gbe !=nil {if _gdd :=_gbe .Blip ;_gdd !=nil {if _ced :=_gdd .EmbedAttr ;_ced !=nil {for _ ,_ead :=range _gd .X ().Relationship {if _ead .IdAttr ==*_ced {for _ ,_bca :=range _df ._adaa .Images {if _bca .Target ()==_ead .TargetAttr {_ba ,_bf :=_ff .Open (_bca .Path ());if _bf !=nil {_f .Log .Debug ("\u004fp\u0065\u006e\u0020\u0069m\u0061\u0067\u0065\u0020\u0066i\u006ce\u0020e\u0072\u0072\u006f\u0072\u003a\u0020\u0025s",_bf );continue ;};_ddd ,_ ,_bf :=_c .Decode (_ba );if _bf !=nil {_f .Log .Debug ("\u0044\u0065\u0063\u006fde\u0020\u0069\u006d\u0061\u0067\u0065\u0020\u0065\u0072\u0072\u006f\u0072\u003a\u0020%\u0073",_bf );continue ;};_ga ._cagf =_ddd ;};};};};};};};}else if _ca :=_eab .GraphicFrame ;_ca !=nil {if _bb :=_ca .Graphic ;_bb !=nil {if _ede :=_bb .GraphicData ;_ede !=nil {for _ ,_ebf :=range _ede .Any {if _gbd ,_fba :=_ebf .(*_e .Chart );_fba {for _ ,_ef :=range _gd .X ().Relationship {if _ef .IdAttr ==_gbd .IdAttr {_aega :=_df ._adaa .GetChartByTargetId (_ef .TargetAttr );if _aega !=nil {_ga ._acgf =_aega ;};};};};};};};};};};if _ga ._cagf !=nil ||_ga ._acgf !=nil {_df ._gdc =append (_df ._gdc ,_ga );};};};};func (_babd *convertContext )getStyleFromRPrElt (_egfd *_bc .CT_RPrElt )*style {if _egfd ==nil {return nil ;};_bedb :=&style {};_bedb ._bdgf =&_egfd .RFont .ValAttr ;if _fdde :=_egfd .B ;_fdde !=nil {_fded :=_fdde .ValAttr ==nil ||*_fdde .ValAttr ;_bedb ._bfgg =&_fded ;};if _efad :=_egfd .I ;_efad !=nil {_dgc :=_efad .ValAttr ==nil ||*_efad .ValAttr ;_bedb ._bfggb =&_dgc ;};if _cega :=_egfd .U ;_cega !=nil {_ebfe :=_cega .ValAttr ==_bc .ST_UnderlineValuesSingle ||_cega .ValAttr ==_bc .ST_UnderlineValuesUnset ;_bedb ._daecc =&_ebfe ;};if _baaa :=_egfd .VertAlign ;_baaa !=nil {_eegg :=_baaa .ValAttr ==_g .ST_VerticalAlignRunSuperscript ;_bedb ._baff =&_eegg ;_gbaa :=_baaa .ValAttr ==_g .ST_VerticalAlignRunSubscript ;_bedb ._bfd =&_gbaa ;};if _dcec :=_egfd .Sz ;_dcec !=nil {_ebfa :=_dcec .ValAttr /12*_dd .DefaultFontSize ;_bedb ._fac =&_ebfa ;};if _gdf :=_egfd .Color ;_gdf !=nil {_bedb ._deb =_babd .getColorStringFromSmlColor (_gdf );};return _bedb ;};type page struct{_abcb []*pageRow ;_fddc bool ;_cfc []*_ce .Image ;_aegaf *pagespan ;_acggb *rowspan ;};func (_fbfg *convertContext )combineCellStyleWithRPrElt (_feff *style ,_fegc *_bc .CT_RPrElt )*style {_aab :=*_feff ;_egg :=_fbfg .getStyleFromRPrElt (_fegc );if _egg ==nil {return &_aab ;};if _egg ._deb !=nil {_aab ._deb =_egg ._deb ;};if _egg ._fac !=nil {_aab ._fac =_egg ._fac ;};if _egg ._bdgf !=nil {_aab ._bdgf =_egg ._bdgf ;};if _egg ._bfgg !=nil {_aab ._bfgg =_egg ._bfgg ;};if _egg ._bfggb !=nil {_aab ._bfggb =_egg ._bfggb ;};if _egg ._daecc !=nil {_aab ._daecc =_egg ._daecc ;};if _egg ._baff !=nil {_aab ._baff =_egg ._baff ;};if _egg ._bfd !=nil {_aab ._bfd =_egg ._bfd ;};return &_aab ;};type mergedCell struct{_caff uint32 ;_bbdac uint32 ;_bcee uint32 ;_dfec uint32 ;_cgdb float64 ;_aaae float64 ;};func _debf (_eadc ,_bgf *style ){if _bgf ==nil {return ;};if _eadc ==nil {_eadc =_bgf ;return ;};if _eadc ._bdgf ==nil {_eadc ._bdgf =_bgf ._bdgf ;};if _eadc ._deb ==nil {_eadc ._deb =_bgf ._deb ;};if _eadc ._fac ==nil {_eadc ._fac =_bgf ._fac ;};if _eadc ._bfgg ==nil {_eadc ._bfgg =_bgf ._bfgg ;};if _eadc ._bfggb ==nil {_eadc ._bfggb =_bgf ._bfggb ;};if _eadc ._daecc ==nil {_eadc ._daecc =_bgf ._daecc ;};if _eadc ._baff ==nil {_eadc ._baff =_bgf ._baff ;};if _eadc ._bfd ==nil {_eadc ._bfd =_bgf ._bfd ;};if _eadc ._gaac ==nil {_eadc ._gaac =_bgf ._gaac ;};if _eadc ._bbf ==nil {_eadc ._bbf =_bgf ._bbf ;};if _eadc ._befa ==nil {_eadc ._befa =_bgf ._befa ;};if _eadc ._acddc ==nil {_eadc ._acddc =_bgf ._acddc ;};if _eadc ._degb ==_bc .ST_VerticalAlignmentUnset {_eadc ._degb =_bgf ._degb ;};if _eadc ._bedcg ==_bc .ST_HorizontalAlignmentUnset {_eadc ._bedcg =_bgf ._bedcg ;};};const _eb =1.5;func (_fad *convertContext )getColorFromTheme (_dafa uint32 )string {_ecc :=_fad ._adaa .Themes ();if len (_ecc )!=0{_efbe :=_ecc [0];if _bcc :=_efbe .ThemeElements ;_bcc !=nil {if _cdb :=_bcc .ClrScheme ;_cdb !=nil {switch _dafa {case 0:return _dd .GetColorStringFromDmlColor (_cdb .Lt1 );case 1:return _dd .GetColorStringFromDmlColor (_cdb .Dk1 );case 2:return _dd .GetColorStringFromDmlColor (_cdb .Lt2 );case 3:return _dd .GetColorStringFromDmlColor (_cdb .Dk2 );case 4:return _dd .GetColorStringFromDmlColor (_cdb .Accent1 );case 5:return _dd .GetColorStringFromDmlColor (_cdb .Accent2 );case 6:return _dd .GetColorStringFromDmlColor (_cdb .Accent3 );case 7:return _dd .GetColorStringFromDmlColor (_cdb .Accent4 );case 8:return _dd .GetColorStringFromDmlColor (_cdb .Accent5 );case 9:return _dd .GetColorStringFromDmlColor (_cdb .Accent6 );};};};};return "";};func (_cf *convertContext )makePages (){for _ ,_bcb :=range _cf ._eafba {for _ ,_cd :=range _cf ._eage {_bcb ._fbgaa =append (_bcb ._fbgaa ,&page {_abcb :[]*pageRow {},_aegaf :_bcb ,_acggb :_cd });};};};func (_aae *convertContext )fillPages (){for _ebb ,_fcc :=range _aae ._eage {_bbg :=_aae ._cbcfd [_fcc ._fdea :_fcc ._fdeg ];for _bde ,_eda :=range _bbg {_fgf :=0;_edfd :=0.0;_bfe :=[]*cell {};if _eda ._aaf {for _ ,_daec :=range _eda ._fea {_aedf :=_aae ._eafba [_fgf ];_aae ._bgeg =_aedf ._fbgaa [_ebb ];_aae ._bgeg ._fddc =true ;_add :=_daec ._bgcb ;if _edfd +_add > _aedf ._cefa {_aae .addRowToPage (_bfe ,_bde );_bfe =[]*cell {_daec };_edfd =_add ;_fgf ++;}else {_daec ._gea =_edfd ;_bfe =append (_bfe ,_daec );_edfd +=_add ;};};if len (_bfe )> 0{_aaee :=_aae ._eafba [_fgf ];_aae ._bgeg =_aaee ._fbgaa [_ebb ];_aae ._bgeg ._fddc =true ;_aae .addRowToPage (_bfe ,_bde );};};};};};func (_bedbc *convertContext )getColorStringFromSmlColor (_agd *_bc .CT_Color )*string {var _dfge string ;if _agd .RgbAttr !=nil {_dfge =*_agd .RgbAttr ;}else if _agd .IndexedAttr !=nil &&*_agd .IndexedAttr < 64{_dfge =_fffd [*_agd .IndexedAttr ];}else if _agd .ThemeAttr !=nil {_adbf :=*_agd .ThemeAttr ;_dfge =_bedbc .getColorFromTheme (_adbf );};if _dfge ==""{return nil ;};if len (_dfge )> 6{_dfge =_dfge [(len (_dfge )-6):];};if _agd .TintAttr !=nil {_cabc :=*_agd .TintAttr ;_dfge =_dd .AdjustColorByTint (_dfge ,_cabc );};_dfge ="\u0023"+_dfge ;return &_dfge ;};func (_cdcd *convertContext )makeTextStyleFromCellStyle (_cfeb *style )*_ce .TextStyle {_bgg :=_cdcd ._acde .NewTextStyle ();if _cfeb ==nil {_bgg .FontSize =_dd .DefaultFontSize ;_bgg .Font =_dd .AssignStdFontByName (_bgg ,_dd .StdFontsMap ["\u0064e\u0066\u0061\u0075\u006c\u0074"][FontStyle_Regular ]);return &_bgg ;};if _gfdb (_cfeb ._daecc ){_bgg .Underline =true ;_bgg .UnderlineStyle =_ce .TextDecorationLineStyle {Offset :0.5,Thickness :_cgea (1/32)};};var _bdgb FontStyle ;if _gfdb (_cfeb ._bfgg )&&_gfdb (_cfeb ._bfggb ){_bdgb =FontStyle_BoldItalic ;}else if _gfdb (_cfeb ._bfgg ){_bdgb =FontStyle_Bold ;}else if _gfdb (_cfeb ._bfggb ){_bdgb =FontStyle_Italic ;}else {_bdgb =FontStyle_Regular ;};_efce :="\u0064e\u0066\u0061\u0075\u006c\u0074";if _cfeb ._bdgf !=nil {_efce =*_cfeb ._bdgf ;};if _decd ,_cdec :=_dd .StdFontsMap [_efce ];_cdec {_bgg .Font =_dd .AssignStdFontByName (_bgg ,_decd [_bdgb ]);}else if _gffc :=_dd .GetRegisteredFont (_efce ,_bdgb );_gffc !=nil {_bgg .Font =_gffc ;}else {_f .Log .Debug ("\u0046\u006f\u006e\u0074\u0020\u0025\u0073\u0020\u0077\u0069\u0074h\u0020\u0073\u0074\u0079\u006c\u0065\u0020\u0025s\u0020i\u0073\u0020\u006e\u006f\u0074\u0020\u0066\u006f\u0075\u006e\u0064\u002c\u0020\u0072\u0065\u0073\u0065\u0074 \u0074\u006f\u0020\u0064\u0065\u0066\u0061\u0075\u006c\u0074\u002e",_efce ,_bdgb );_bgg .Font =_dd .AssignStdFontByName (_bgg ,_dd .StdFontsMap ["\u0064e\u0066\u0061\u0075\u006c\u0074"][_bdgb ]);};if _cfeb ._fac !=nil {_bgg .FontSize =*_cfeb ._fac ;};if _cfeb ._deb !=nil {_bgg .Color =_ce .ColorRGBFromHex (*_cfeb ._deb );};if _cfeb ._baff !=nil &&*_cfeb ._baff {_bgg .FontSize *=_gb ;}else if _cfeb ._bfd !=nil &&*_cfeb ._bfd {_bgg .FontSize *=_gb ;};return &_bgg ;};func (_egb *convertContext )drawSheet (){for _acd ,_cdg :=range _egb ._eafba {_dcde :=len (_cdg ._fbgaa );if _acd ==len (_egb ._eafba )-1{for _gagd :=len (_cdg ._fbgaa )-1;_gagd >=0;_gagd --{if !_cdg ._fbgaa [_gagd ]._fddc {_dcde =_gagd ;};};};_eafb :=_cdg ._fbgaa [:_dcde ];for _ ,_fbac :=range _eafb {_egb ._acde .NewPage ();_egb .drawPage (_fbac );};};};type style struct{_deb *string ;_fac *float64 ;_bdgf *string ;_bfgg *bool ;_bfggb *bool ;_daecc *bool ;_baff *bool ;_bfd *bool ;_gaac *border ;_bbf *border ;_befa *border ;_acddc *border ;_ebgd bool ;_degb _bc .ST_VerticalAlignment ;_bedcg _bc .ST_HorizontalAlignment ;};func (_da *convertContext )makeCells (){_eaa :=_da ._fggb ;_gfa :=_eaa .Rows ();_dfa :=0;for _ ,_gcb :=range _da ._cbcfd {_gcb ._fea =[]*cell {};_dad :=0.0;_bcg :=_gcb ._fgcef ;if _gcb ._aaf {_cee :=_gfa [_dfa ];_dfa ++;_dbff :=_gcb ._gbbdd ;for _ ,_acg :=range _cee .Cells (){_edf ,_dade :=_fd .ParseCellReference (_acg .Reference ());if _dade !=nil {_f .Log .Debug ("\u0043\u0061\u006e\u006eo\u0074\u0020\u0070\u0061\u0072\u0073\u0065\u0020\u0061\u0020r\u0065f\u0065\u0072\u0065\u006e\u0063\u0065\u003a \u0025\u0073",_dade );continue ;};_dgb :=_da ._gage [_edf .ColumnIdx ];_bea :=_dgb ._cad ;_bd :=_bea ;_aeae :=_dgb ._ebe ;var _dcdf ,_dgg ,_def ,_gbgg bool ;for _ ,_gac :=range _da ._adf {if _edf .RowIdx >=_gac ._caff &&_edf .RowIdx <=_gac ._bcee &&_edf .ColumnIdx >=_gac ._bbdac &&_edf .ColumnIdx <=_gac ._dfec {if _edf .ColumnIdx ==_gac ._bbdac &&_edf .RowIdx ==_gac ._caff {_bea =_gac ._cgdb ;_dbff =_gac ._aaae ;};_dcdf =_edf .RowIdx !=_gac ._caff ;_dgg =_edf .RowIdx !=_gac ._bcee ;_def =_edf .ColumnIdx !=_gac ._bbdac ;_gbgg =_edf .ColumnIdx !=_gac ._dfec ;};};_fa :=_da .getStyleFromCell (_acg ,_bcg ,_aeae );var _eeb ,_dae ,_ecbd bool ;var _gabc ,_ada ,_dac ,_ffg *border ;var _dea _bc .ST_VerticalAlignment ;var _fab _bc .ST_HorizontalAlignment ;if _fa !=nil {if !_dcdf {_gabc =_fa ._gaac ;};if !_dgg {_ada =_fa ._bbf ;};if !_def {_dac =_fa ._befa ;};if !_gbgg {_ffg =_fa ._acddc ;};if _ada !=nil &&_ada ._ccf > _dad {_dad =_ada ._ccf ;};_dea =_fa ._degb ;_fab =_fa ._bedcg ;if _fa ._baff !=nil {_eeb =*_fa ._baff ;};if _fa ._bfd !=nil {_dae =*_fa ._bfd ;};_ecbd =_fa ._ebgd ;};_gddf ,_ebfc :=_da .getContentFromCell (_acg ,_fa ,_bea ,_ecbd );_eg :=&cell {_egce :_ebfc ,_aecd :_bea ,_bgcb :_bd ,_cbg :_dbff ,_ceb :_gddf ,_geg :_gabc ,_age :_ada ,_ecd :_dac ,_eed :_ffg ,_dcdg :_eeb ,_bdaf :_dae };_da .alignSymbolsHorizontally (_eg ,_fab );_da .alignSymbolsVertically (_eg ,_dea );_gcb ._fea =append (_gcb ._fea ,_eg );};};_gcb ._dfab =_dad ;};};func (_edcg *convertContext )getStyle (_ecda *uint32 )*style {_edbf :=&style {};_cgcb :=false ;if _ecda !=nil {_gcdb :=_edcg ._bbda .GetCellStyle (*_ecda );_dcg :=_gcdb .GetFont ();for _ ,_becc :=range _dcg .Name {if _becc !=nil {_edbf ._bdgf =&_becc .ValAttr ;_cgcb =true ;break ;};};for _ ,_bfda :=range _dcg .B {if _bfda !=nil {_ded :=_bfda .ValAttr ==nil ||*_bfda .ValAttr ;_edbf ._bfgg =&_ded ;_cgcb =true ;break ;};};for _ ,_fgcb :=range _dcg .I {if _fgcb !=nil {_bcbg :=_fgcb .ValAttr ==nil ||*_fgcb .ValAttr ;_edbf ._bfggb =&_bcbg ;_cgcb =true ;break ;};};for _ ,_efdd :=range _dcg .U {if _efdd !=nil {_adcg :=_efdd .ValAttr ==_bc .ST_UnderlineValuesSingle ||_efdd .ValAttr ==_bc .ST_UnderlineValuesUnset ;_edbf ._daecc =&_adcg ;_cgcb =true ;break ;};};for _ ,_deab :=range _dcg .Sz {if _deab !=nil {_fgcf :=_deab .ValAttr /12*_dd .DefaultFontSize ;_edbf ._fac =&_fgcf ;_cgcb =true ;break ;};};for _ ,_gffce :=range _dcg .VertAlign {if _gffce !=nil {_geb :=_gffce .ValAttr ==_g .ST_VerticalAlignRunSuperscript ;_edbf ._baff =&_geb ;_ffda :=_gffce .ValAttr ==_g .ST_VerticalAlignRunSubscript ;_edbf ._bfd =&_ffda ;_cgcb =true ;break ;};};for _ ,_gacbe :=range _dcg .Color {if _gacbe !=nil {_edbf ._deb =_edcg .getColorStringFromSmlColor (_gacbe );_cgcb =true ;break ;};};_gaba :=_gcdb .GetBorder ();if _gaba .Top !=nil {_edbf ._gaac =_edcg .getBorder (_gaba .Top );_cgcb =true ;};if _gaba .Bottom !=nil {_edbf ._bbf =_edcg .getBorder (_gaba .Bottom );_cgcb =true ;};if _gaba .Left !=nil {_edbf ._befa =_edcg .getBorder (_gaba .Left );_cgcb =true ;};if _gaba .Right !=nil {_edbf ._acddc =_edcg .getBorder (_gaba .Right );_cgcb =true ;};if _gcdb .Wrapped (){_edbf ._ebgd =true ;_cgcb =true ;};if _cgdc :=_gcdb .GetVerticalAlignment ();_cgdc !=_bc .ST_VerticalAlignmentUnset {_edbf ._degb =_cgdc ;_cgcb =true ;};if _faba :=_gcdb .GetHorizontalAlignment ();_faba !=_bc .ST_HorizontalAlignmentUnset {_edbf ._bedcg =_faba ;_cgcb =true ;};};if _cgcb {return _edbf ;};return nil ;};var _fffd =[]string {"\u0030\u0030\u0030\u0030\u0030\u0030","\u0066\u0066\u0066\u0066\u0066\u0066","\u0066\u0066\u0030\u0030\u0030\u0030","\u0030\u0030\u0066\u0066\u0030\u0030","\u0030\u0030\u0030\u0030\u0066\u0066","\u0066\u0066\u0066\u0066\u0030\u0030","\u0066\u0066\u0030\u0030\u0066\u0066","\u0030\u0030\u0066\u0066\u0066\u0066","\u0030\u0030\u0030\u0030\u0030\u0030","\u0066\u0066\u0066\u0066\u0066\u0066","\u0066\u0066\u0030\u0030\u0030\u0030","\u0030\u0030\u0066\u0066\u0030\u0030","\u0030\u0030\u0030\u0030\u0066\u0066","\u0066\u0066\u0066\u0066\u0030\u0030","\u0066\u0066\u0030\u0030\u0066\u0066","\u0030\u0030\u0066\u0066\u0066\u0066","\u0038\u0030\u0030\u0030\u0030\u0030","\u0030\u0030\u0038\u0030\u0030\u0030","\u0030\u0030\u0030\u0030\u0038\u0030","\u0038\u0030\u0038\u0030\u0030\u0030","\u0038\u0030\u0030\u0030\u0038\u0030","\u0030\u0030\u0038\u0030\u0038\u0030","\u0063\u0030\u0063\u0030\u0063\u0030","\u0038\u0030\u0038\u0030\u0038\u0030","\u0039\u0039\u0039\u0039\u0066\u0066","\u0039\u0039\u0033\u0033\u0036\u0036","\u0066\u0066\u0066\u0066\u0063\u0063","\u0063\u0063\u0066\u0066\u0066\u0066","\u0036\u0036\u0030\u0030\u0036\u0036","\u0066\u0066\u0038\u0030\u0038\u0030","\u0030\u0030\u0036\u0036\u0063\u0063","\u0063\u0063\u0063\u0063\u0066\u0066","\u0030\u0030\u0030\u0030\u0038\u0030","\u0066\u0066\u0030\u0030\u0066\u0066","\u0066\u0066\u0066\u0066\u0030\u0030","\u0030\u0030\u0066\u0066\u0066\u0066","\u0038\u0030\u0030\u0030\u0038\u0030","\u0038\u0030\u0030\u0030\u0030\u0030","\u0030\u0030\u0038\u0030\u0038\u0030","\u0030\u0030\u0030\u0030\u0066\u0066","\u0030\u0030\u0063\u0063\u0066\u0066","\u0063\u0063\u0066\u0066\u0066\u0066","\u0063\u0063\u0066\u0066\u0063\u0063","\u0066\u0066\u0066\u0066\u0039\u0039","\u0039\u0039\u0063\u0063\u0066\u0066","\u0066\u0066\u0039\u0039\u0063\u0063","\u0063\u0063\u0039\u0039\u0066\u0066","\u0066\u0066\u0063\u0063\u0039\u0039","\u0033\u0033\u0036\u0036\u0066\u0066","\u0033\u0033\u0063\u0063\u0063\u0063","\u0039\u0039\u0063\u0063\u0030\u0030","\u0066\u0066\u0063\u0063\u0030\u0030","\u0066\u0066\u0039\u0039\u0030\u0030","\u0066\u0066\u0036\u0036\u0030\u0030","\u0036\u0036\u0036\u0036\u0039\u0039","\u0039\u0036\u0039\u0036\u0039\u0036","\u0030\u0030\u0033\u0033\u0036\u0036","\u0033\u0033\u0039\u0039\u0036\u0036","\u0030\u0030\u0033\u0033\u0030\u0030","\u0033\u0033\u0033\u0033\u0030\u0030","\u0039\u0039\u0033\u0033\u0030\u0030","\u0039\u0039\u0033\u0033\u0036\u0036","\u0033\u0033\u0033\u0033\u0039\u0039","\u0033\u0033\u0033\u0033\u0033\u0033"};func (_efa *convertContext )makeCols (){_gf :=_efa ._fggb ;_gaf :=_gf .X ();_dbg :=[]*colInfo {};_agb :=[]colWidthRange {};if _aa :=_gaf .Cols ;len (_aa )> 0{for _ ,_efag :=range _aa [0].Col {_feg :=65.0;if _ee :=_efag .WidthAttr ;_ee !=nil {if *_ee > 0.83{*_ee -=0.83;};if *_ee <=1{_feg =*_ee *11;}else {_feg =5+*_ee *6;};};_aegg :=int (_efag .MinAttr -1);_cef :=int (_efag .MaxAttr -1);_agb =append (_agb ,colWidthRange {_dddc :_aegg ,_aacf :_cef ,_ffaf :_feg ,_bbb :_efa .getStyle (_efag .StyleAttr )});};};_ade :=0;for _ecb :=0;_ecb <=_efa ._bcea ;_ecb ++{var _cgf float64 ;var _gg *style ;if _ade >=len (_agb ){_cgf =65;}else {_dfb :=_agb [_ade ];if _ecb >=_dfb ._dddc &&_ecb <=_dfb ._aacf {_cgf =_dfb ._ffaf ;_gg =_dfb ._bbb ;if _ecb ==_dfb ._aacf {_ade ++;};}else {_cgf =65;};};_dbg =append (_dbg ,&colInfo {_cad :_cgf ,_ebe :_gg });};_efa ._gage =_dbg ;};func (_bcge *convertContext )alignSymbolsHorizontally (_adec *cell ,_dcf _bc .ST_HorizontalAlignment ){if _dcf ==_bc .ST_HorizontalAlignmentUnset {switch _adec ._egce {case _bc .ST_CellTypeB :_dcf =_bc .ST_HorizontalAlignmentCenter ;case _bc .ST_CellTypeN :_dcf =_bc .ST_HorizontalAlignmentRight ;default:_dcf =_bc .ST_HorizontalAlignmentLeft ;};};var _ecbf float64 ;for _ ,_bdfd :=range _adec ._ceb {switch _dcf {case _bc .ST_HorizontalAlignmentLeft :_ecbf =_ae ;case _bc .ST_HorizontalAlignmentRight :_bcbe :=_dgbb (_bdfd ._gcc );_ecbf =_adec ._aecd -_ae -_bcbe ;case _bc .ST_HorizontalAlignmentCenter :_cagb :=_dgbb (_bdfd ._gcc );_ecbf =(_adec ._aecd -_cagb )/2;};for _ ,_bee :=range _bdfd ._gcc {_bee ._aca +=_ecbf ;};};};func (_egbg *convertContext )drawPage (_eaed *page ){_cggf :=_egbg ._fag ;_egbc :=_egbg ._cgd ;for _ ,_eddd :=range _eaed ._abcb {_fbbe :=_egbg ._cbcfd [_eddd ._cace ];for _ ,_gcd :=range _eddd ._fgcg {_gbbe :=_gcd ._efde < _gcd ._gea ;_baa :=_gcd ._fgec > _gcd ._gea +_gcd ._aecd ;var _gacb ,_gabd bool ;for _ ,_fbdd :=range _gcd ._ceb {for _ ,_cdc :=range _fbdd ._gcc {if _gbbe &&!_gacb {_gacb =_cdc ._aca < 0;};if _baa &&!_gabd {_gabd =_gcd ._aecd < _cdc ._aca +_cdc ._eeeg ;};if _gcd ._gea +_cdc ._aca >=_gcd ._efde &&_gcd ._gea +_cdc ._aca +_cdc ._eeeg <=_gcd ._fgec {_cdce :=_egbg ._acde .NewStyledParagraph ();_ffc :=_egbc +_gcd ._gea +_cdc ._aca ;_cag :=_cggf +_fbbe ._fdcd +_fbdd ._egf -_cdc ._gdcg -_cgea (0.5);_cdce .SetPos (_ffc ,_cag );var _gfag *_ce .TextChunk ;if _cdc ._edfg !=""{_gfag =_cdce .AddExternalLink (_cdc ._cbef ,_cdc ._edfg );}else {_gfag =_cdce .Append (_cdc ._cbef );};if _cdc ._dffd !=nil {_gfag .Style =*_cdc ._dffd ;};_egbg ._acde .Draw (_cdce );};};};var _dce ,_fbbg ,_babb ,_fdcf ,_aga ,_fcg float64 ;var _fegb ,_fegf ,_faf ,_gedg _ce .Color ;if _fgc :=_gcd ._geg ;_fgc !=nil {_dce =_fgc ._ccf ;_fegb =_fgc ._fged ;};if _gdb :=_gcd ._age ;_gdb !=nil {_fbbg =_gdb ._ccf ;_fegf =_gdb ._fged ;};if _abc :=_gcd ._ecd ;_abc !=nil {_babb =_abc ._ccf ;_aga =_babb /2;_faf =_abc ._fged ;};if _cbeb :=_gcd ._eed ;_cbeb !=nil {_fdcf =_cbeb ._ccf ;_fcg =_fdcf /2;_gedg =_cbeb ._fged ;};var _cedc float64 ;if _eddd ._cace > 1{_cedc =_egbg ._cbcfd [_eddd ._cace -1]._dfab ;};_aeb :=_cggf +_fbbe ._fdcd -0.5*(_cedc -_dce );_acdd :=_cggf +_fbbe ._fdcd +_fbbe ._gbbdd +0.5*(_fbbe ._dfab +_fbbg );_edc :=_egbc +_gcd ._gea ;_ebd :=_edc +_gcd ._bgcb ;_dd .DrawLine (_egbg ._acde ,_edc ,_aeb ,_ebd ,_aeb ,_dce ,_fegb );_dd .DrawLine (_egbg ._acde ,_edc ,_acdd ,_ebd ,_acdd ,_fbbg ,_fegf );if !_gacb {_dd .DrawLine (_egbg ._acde ,_edc -_aga ,_aeb ,_edc -_aga ,_acdd ,_babb ,_faf );};if !_gabd {_dd .DrawLine (_egbg ._acde ,_ebd -_fcg ,_aeb ,_ebd -_fcg ,_acdd ,_fdcf ,_gedg );};};};for _ ,_afe :=range _eaed ._cfc {if _afe !=nil {_egbg ._acde .Draw (_afe );};};};type colWidthRange struct{_dddc int ;_aacf int ;_ffaf float64 ;_bbb *style ;};const (FontStyle_Regular FontStyle =0;FontStyle_Bold FontStyle =1;FontStyle_Italic FontStyle =2;FontStyle_BoldItalic FontStyle =3;);type pagespan struct{_cefa float64 ;_fbgaa []*page ;_bgb int ;_fbgc int ;};func (_bg *convertContext )determineMaxIndexes (){var _bfb ,_gbdf int ;_bfb =int (_bg ._fggb .MaxColumnIdx ());_ddc :=_bg ._fggb .Rows ();if len (_ddc )> 0{_gbdf =int (_ddc [len (_ddc )-1].RowNumber ());};for _ ,_edg :=range _bg ._gdc {if _edg ._faa >=_gbdf {_gbdf =_edg ._faa +1;};if _edg ._daf >=_bfb {_bfb =_edg ._daf +1;};};_bg ._bgd =_gbdf ;_bg ._bcea =_bfb ;};type pageRow struct{_cace int ;_fgcg []*cell ;};type cell struct{_egce _bc .ST_CellType ;_befad int ;_gea float64 ;_ceb []*line ;_aecd float64 ;_bgcb float64 ;_cbg float64 ;_efde float64 ;_fgec float64 ;_aefb *_ce .TextStyle ;_geg *border ;_age *border ;_ecd *border ;_eed *border ;_dcdg bool ;_bdaf bool ;};