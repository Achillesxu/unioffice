//
// Copyright 2020 FoxyUtils ehf. All rights reserved.
//
// This is a commercial product and requires a license to operate.
// A trial license can be obtained at https://unidoc.io
//
// DO NOT EDIT: generated by unitwist Go source code obfuscator.
//
// Use of this source code is governed by the UniDoc End User License Agreement
// terms that can be accessed at https://unidoc.io/eula/

package convert ;import (_a "github.com/unidoc/unioffice/common/logger";_ad "github.com/unidoc/unioffice/common/tempstorage";_b "github.com/unidoc/unioffice/internal/convertutils";_ff "github.com/unidoc/unioffice/measurement";_ag "github.com/unidoc/unioffice/schema/soo/dml";_d "github.com/unidoc/unioffice/schema/soo/dml/chart";_ge "github.com/unidoc/unioffice/schema/soo/ofc/sharedTypes";_gg "github.com/unidoc/unioffice/schema/soo/sml";_de "github.com/unidoc/unioffice/spreadsheet";_gd "github.com/unidoc/unioffice/spreadsheet/reference";_g "github.com/unidoc/unipdf/v3/creator";_ed "github.com/unidoc/unipdf/v3/model";_f "image";_e "strconv";);

// FontStyle represents a kind of font styling. It can be FontStyle_Regular, FontStyle_Bold, FontStyle_Italic and FontStyle_BoldItalic.
type FontStyle =_b .FontStyle ;func (_aeb *convertContext )getSymbolsFromR (_dfgc []*_gg .CT_RElt ,_geff *style )[]*symbol {_gddd :=[]*symbol {};for _ ,_fce :=range _dfgc {_cbda :=_aeb .combineCellStyleWithRPrElt (_geff ,_fce .RPr );for _ ,_eged :=range _fce .T {_gddd =append (_gddd ,&symbol {_fdeg :string (_eged ),_gece :_aeb .makeTextStyleFromCellStyle (_cbda )});};};return _gddd ;};func (_geb *convertContext )getColorStringFromSmlColor (_dbfd *_gg .CT_Color )*string {var _feggeb string ;if _dbfd .RgbAttr !=nil {_feggeb =*_dbfd .RgbAttr ;}else if _dbfd .IndexedAttr !=nil &&*_dbfd .IndexedAttr < 64{_feggeb =_ebeb [*_dbfd .IndexedAttr ];}else if _dbfd .ThemeAttr !=nil {_eefc :=*_dbfd .ThemeAttr ;_feggeb =_geb .getColorFromTheme (_eefc );};if _feggeb ==""{return nil ;};if len (_feggeb )> 6{_feggeb =_feggeb [(len (_feggeb )-6):];};if _dbfd .TintAttr !=nil {_gddc :=*_dbfd .TintAttr ;_feggeb =_b .AdjustColorByTint (_feggeb ,_gddc );};_feggeb ="\u0023"+_feggeb ;return &_feggeb ;};func (_eg *convertContext )makeAnchors (){_cf ,_cbf :=_eg ._gaac .GetDrawing ();if _cf !=nil {for _ ,_bba :=range _cf .EG_Anchor {_cg :=&anchor {};if _dag :=_bba .TwoCellAnchor ;_dag !=nil {_cgf ,_ba :=_dag .From ,_dag .To ;if _cgf ==nil ||_ba ==nil {return ;};_cg ._gceb =int (_cgf .Row );_cg ._cgge =_b .FromSTCoordinate (_cgf .RowOff );_cg ._ecb =int (_cgf .Col );_cg ._fcfad =_b .FromSTCoordinate (_cgf .ColOff );_cg ._dfb =int (_ba .Row );_cg ._afc =_b .FromSTCoordinate (_ba .RowOff );_cg ._ebee =int (_ba .Col );_cg ._geag =_b .FromSTCoordinate (_ba .ColOff );if _feg :=_dag .Choice ;_feg !=nil {if _gc :=_feg .Pic ;_gc !=nil {if _dgd :=_gc .BlipFill ;_dgd !=nil {if _bff :=_dgd .Blip ;_bff !=nil {if _ea :=_bff .EmbedAttr ;_ea !=nil {for _ ,_dc :=range _cbf .X ().Relationship {if _dc .IdAttr ==*_ea {for _ ,_eec :=range _eg ._fbbb .Images {if _eec .Target ()==_dc .TargetAttr {_eaa ,_bca :=_ad .Open (_eec .Path ());if _bca !=nil {_a .Log .Debug ("\u004fp\u0065\u006e\u0020\u0069m\u0061\u0067\u0065\u0020\u0066i\u006ce\u0020e\u0072\u0072\u006f\u0072\u003a\u0020\u0025s",_bca );continue ;};_ged ,_ ,_bca :=_f .Decode (_eaa );if _bca !=nil {_a .Log .Debug ("\u0044\u0065\u0063\u006fde\u0020\u0069\u006d\u0061\u0067\u0065\u0020\u0065\u0072\u0072\u006f\u0072\u003a\u0020%\u0073",_bca );continue ;};_cg ._cag =_ged ;};};};};};};};}else if _ggc :=_feg .GraphicFrame ;_ggc !=nil {if _ce :=_ggc .Graphic ;_ce !=nil {if _dcd :=_ce .GraphicData ;_dcd !=nil {for _ ,_fdf :=range _dcd .Any {if _dd ,_cgfa :=_fdf .(*_d .Chart );_cgfa {for _ ,_dac :=range _cbf .X ().Relationship {if _dac .IdAttr ==_dd .IdAttr {_ffd :=_eg ._fbbb .GetChartByTargetId (_dac .TargetAttr );if _ffd !=nil {_cg ._daeb =_ffd ;};};};};};};};};};};if _cg ._cag !=nil ||_cg ._daeb !=nil {_eg ._bfbc =append (_eg ._bfbc ,_cg );};};};};func (_ddd *convertContext )drawPage (_acg *page ){_cfebg :=_ddd ._age ;_gadef :=_ddd ._fgfg ;for _ ,_eadg :=range _acg ._ecf {_cbff :=_ddd ._afd [_eadg ._degae ];for _ ,_efcaf :=range _eadg ._gbf {_affa :=_efcaf ._aeda < _efcaf ._gab ;_dcad :=_efcaf ._fagf > _efcaf ._gab +_efcaf ._bccg ;var _fbea ,_debg bool ;for _ ,_gbg :=range _efcaf ._bbda {for _ ,_dga :=range _gbg ._cefb {if _affa &&!_fbea {_fbea =_dga ._eebe < 0;};if _dcad &&!_debg {_debg =_efcaf ._bccg < _dga ._eebe +_dga ._bbfgg ;};if _efcaf ._gab +_dga ._eebe >=_efcaf ._aeda &&_efcaf ._gab +_dga ._eebe +_dga ._bbfgg <=_efcaf ._fagf {_aef :=_ddd ._fad .NewStyledParagraph ();_abf :=_gadef +_efcaf ._gab +_dga ._eebe ;_fabd :=_cfebg +_cbff ._degd +_gbg ._ageg -_dga ._ddag -_egf (0.5);_aef .SetPos (_abf ,_fabd );var _bde *_g .TextChunk ;if _dga ._aebd !=""{_bde =_aef .AddExternalLink (_dga ._fdeg ,_dga ._aebd );}else {_bde =_aef .Append (_dga ._fdeg );};if _dga ._gece !=nil {_bde .Style =*_dga ._gece ;};_ddd ._fad .Draw (_aef );};};};var _fge ,_gga ,_dega ,_gdd ,_bfaa ,_cbe float64 ;var _bfff ,_cab ,_ade ,_aaf _g .Color ;if _bge :=_efcaf ._bdd ;_bge !=nil {_fge =_bge ._affag ;_bfff =_bge ._fagb ;};if _bbec :=_efcaf ._eagd ;_bbec !=nil {_gga =_bbec ._affag ;_cab =_bbec ._fagb ;};if _abb :=_efcaf ._bbg ;_abb !=nil {_dega =_abb ._affag ;_bfaa =_dega /2;_ade =_abb ._fagb ;};if _eea :=_efcaf ._agfg ;_eea !=nil {_gdd =_eea ._affag ;_cbe =_gdd /2;_aaf =_eea ._fagb ;};var _bac float64 ;if _eadg ._degae > 1{_bac =_ddd ._afd [_eadg ._degae -1]._dbe ;};_cdf :=_cfebg +_cbff ._degd -0.5*(_bac -_fge );_dffd :=_cfebg +_cbff ._degd +_cbff ._fgdd +0.5*(_cbff ._dbe +_gga );_fcg :=_gadef +_efcaf ._gab ;_cge :=_fcg +_efcaf ._fbfd ;_b .DrawLine (_ddd ._fad ,_fcg ,_cdf ,_cge ,_cdf ,_fge ,_bfff );_b .DrawLine (_ddd ._fad ,_fcg ,_dffd ,_cge ,_dffd ,_gga ,_cab );if !_fbea {_b .DrawLine (_ddd ._fad ,_fcg -_bfaa ,_cdf ,_fcg -_bfaa ,_dffd ,_dega ,_ade );};if !_debg {_b .DrawLine (_ddd ._fad ,_cge -_cbe ,_cdf ,_cge -_cbe ,_dffd ,_gdd ,_aaf );};};};for _ ,_abd :=range _acg ._cdc {if _abd !=nil {_ddd ._fad .Draw (_abd );};};};func (_deg *convertContext )makeCols (){_efa :=_deg ._gaac ;_acb :=_efa .X ();_ab :=[]*colInfo {};_fa :=[]colWidthRange {};if _dgc :=_acb .Cols ;len (_dgc )> 0{for _ ,_cga :=range _dgc [0].Col {_aa :=65.0;if _fag :=_cga .WidthAttr ;_fag !=nil {if *_fag > 0.83{*_fag -=0.83;};if *_fag <=1{_aa =*_fag *11;}else {_aa =5+*_fag *6;};};_bcd :=int (_cga .MinAttr -1);_be :=int (_cga .MaxAttr -1);_fa =append (_fa ,colWidthRange {_bfad :_bcd ,_ffbb :_be ,_gfdc :_aa ,_ggac :_deg .getStyle (_cga .StyleAttr )});};};_cgaf :=0;for _bed :=0;_bed <=_deg ._febae ;_bed ++{var _dec float64 ;var _ae *style ;if _cgaf >=len (_fa ){_dec =65;}else {_ded :=_fa [_cgaf ];if _bed >=_ded ._bfad &&_bed <=_ded ._ffbb {_dec =_ded ._gfdc ;_ae =_ded ._ggac ;if _bed ==_ded ._ffbb {_cgaf ++;};}else {_dec =65;};};_ab =append (_ab ,&colInfo {_bgagb :_dec ,_cggc :_ae });};_deg ._aega =_ab ;};var _agg =_egf (0.0625);const _ga =0.25;const _df =0.64;func (_feb *convertContext )makePagespans (){_feb ._edgc =[]*pagespan {};_cgb :=0.0;_fbb :=0;for _fcd ,_fgdc :=range _feb ._aega {_bab :=_fgdc ._bgagb ;if _cgb +_bab <=_feb ._dee {_fgdc ._babbg =_cgb ;_cgb +=_bab ;}else {_fgdc ._babbg =0;_feb ._edgc =append (_feb ._edgc ,&pagespan {_aeeb :_cgb ,_eafd :_fbb ,_gfe :_fcd });_cgb =_bab ;_fbb =_fcd ;};};_feb ._edgc =append (_feb ._edgc ,&pagespan {_aeeb :_cgb ,_eafd :_fbb ,_gfe :len (_feb ._aega )});};func (_ddcb *convertContext )addRowToPage (_fgad []*cell ,_gbad int ){_adg :=0.0;_ebf :=_ddcb ._dee ;for _ ,_edda :=range _fgad {if len (_edda ._bbda )!=0{_edda ._aeda =_adg ;_adg =_edda ._gab +_edda ._bccg ;};};for _cgba :=len (_fgad )-1;_cgba >=0;_cgba --{_ec :=_fgad [_cgba ];if len (_ec ._bbda )!=0{_ec ._fagf =_ebf ;_ebf =_ec ._gab ;};};_ddcb ._fgcd ._ecf =append (_ddcb ._fgcd ._ecf ,&pageRow {_degae :_gbad ,_gbf :_fgad });};func (_fcb *convertContext )makeMergedCells (){_edf :=[]*mergedCell {};for _ ,_bg :=range _fcb ._gaac .MergedCells (){_ceed ,_ffc ,_fee :=_gd .ParseRangeReference (_bg .Reference ());if _fee !=nil {_a .Log .Debug ("\u0065\u0072r\u006f\u0072\u0020\u0070\u0061\u0072\u0073\u0069\u006e\u0067\u0020\u006d\u0065\u0072\u0067\u0065\u0064\u0020\u0063\u0065\u006c\u006c: \u0025\u0073",_fee );continue ;};_ddf :=mergedCell {_dcaf :_ceed .RowIdx ,_fccg :_ceed .ColumnIdx ,_adb :_ffc .RowIdx ,_fcfa :_ffc .ColumnIdx };for _ebb :=_ddf ._fccg -1;_ebb < _ddf ._fcfa ;_ebb ++{_ddf ._gbga +=_fcb ._aega [_ebb ]._bgagb ;};for _aec :=_ddf ._dcaf -1;_aec < _ddf ._adb ;_aec ++{_ddf ._bbbc +=_fcb ._afd [_aec ]._fgdd ;};_edf =append (_edf ,&_ddf );};_fcb ._feda =_edf ;};func _bddb (_gabb *bool )bool {return _gabb !=nil &&*_gabb };type border struct{_affag float64 ;_fagb _g .Color ;};type pageRow struct{_degae int ;_gbf []*cell ;};func (_aee *convertContext )imageFromAnchor (_bce *anchor ,_ccg ,_dadg float64 )_f .Image {if _bce ._cag !=nil {return _bce ._cag ;};if _bce ._daeb !=nil {_edg ,_dce :=_b .MakeImageFromChartSpace (_bce ._daeb ,_ccg ,_dadg ,_aee ._fde );if _dce !=nil {_a .Log .Debug ("C\u0061\u006e\u006e\u006f\u0074\u0020\u006d\u0061\u006b\u0065\u0020\u0061\u006e\u0020\u0069\u006d\u0061\u0067e\u0020\u0066\u0072\u006f\u006d\u0020\u0063\u0068\u0061\u0072tS\u0070\u0061\u0063e\u003a \u0025\u0073",_dce );return nil ;};return _edg ;};return nil ;};func (_badc *convertContext )getImage (_bdag _f .Image ,_bfbg ,_gac ,_afg ,_cba ,_aedg ,_gdea float64 ,_egb _b .ImgPart )*_g .Image {_cba +=_badc ._age ;_afg +=_badc ._fgfg ;_bgee ,_fdfd :=_b .GetImage (_badc ._fad ,_bdag ,_bfbg ,_gac ,_afg ,_cba ,_aedg ,_gdea ,_egb );if _fdfd !=nil {_a .Log .Debug ("\u0043\u0061\u006eno\u0074\u0020\u0067\u0065\u0074\u0020\u0061\u006e\u0020\u0069\u006d\u0061\u0067\u0065\u003a\u0020\u0025\u0073",_fdfd );return nil ;};return _bgee ;};type page struct{_ecf []*pageRow ;_ddb bool ;_cdc []*_g .Image ;_dadb *pagespan ;_fabe *rowspan ;};type colInfo struct{_babbg float64 ;_bgagb float64 ;_cggc *style ;};

// RegisterFont makes a PdfFont accessible for using in converting to PDF.
func RegisterFont (name string ,style FontStyle ,font *_ed .PdfFont ){_b .RegisterFont (name ,style ,font );};func (_dbf *convertContext )makeTextStyleFromCellStyle (_deef *style )*_g .TextStyle {_gdb :=_dbf ._fad .NewTextStyle ();if _deef ==nil {_gdb .FontSize =_b .DefaultFontSize ;_gdb .Font =_b .AssignStdFontByName (_gdb ,_b .StdFontsMap ["\u0064e\u0066\u0061\u0075\u006c\u0074"][FontStyle_Regular ]);return &_gdb ;};if _bddb (_deef ._abg ){_gdb .Underline =true ;_gdb .UnderlineStyle =_g .TextDecorationLineStyle {Offset :0.5,Thickness :_egf (1/32)};};var _abea FontStyle ;if _bddb (_deef ._acf )&&_bddb (_deef ._gbc ){_abea =FontStyle_BoldItalic ;}else if _bddb (_deef ._acf ){_abea =FontStyle_Bold ;}else if _bddb (_deef ._gbc ){_abea =FontStyle_Italic ;}else {_abea =FontStyle_Regular ;};_ccc :="\u0064e\u0066\u0061\u0075\u006c\u0074";if _deef ._bdf !=nil {_ccc =*_deef ._bdf ;};if _bea ,_fgag :=_b .StdFontsMap [_ccc ];_fgag {_gdb .Font =_b .AssignStdFontByName (_gdb ,_bea [_abea ]);}else if _fcbc :=_b .GetRegisteredFont (_ccc ,_abea );_fcbc !=nil {_gdb .Font =_fcbc ;}else {_a .Log .Debug ("\u0046\u006f\u006e\u0074\u0020\u0025\u0073\u0020\u0077\u0069\u0074h\u0020\u0073\u0074\u0079\u006c\u0065\u0020\u0025s\u0020i\u0073\u0020\u006e\u006f\u0074\u0020\u0066\u006f\u0075\u006e\u0064\u002c\u0020\u0072\u0065\u0073\u0065\u0074 \u0074\u006f\u0020\u0064\u0065\u0066\u0061\u0075\u006c\u0074\u002e",_ccc ,_abea );_gdb .Font =_b .AssignStdFontByName (_gdb ,_b .StdFontsMap ["\u0064e\u0066\u0061\u0075\u006c\u0074"][_abea ]);};if _deef ._gcab !=nil {_gdb .FontSize =*_deef ._gcab ;};if _deef ._gdddg !=nil {_gdb .Color =_g .ColorRGBFromHex (*_deef ._gdddg );};if _deef ._bgag !=nil &&*_deef ._bgag {_gdb .FontSize *=_df ;}else if _deef ._dgfe !=nil &&*_deef ._dgfe {_gdb .FontSize *=_df ;};return &_gdb ;};

// ConvertToPdf converts a sheet to a PDF file. This package is beta, breaking changes can take place.
func ConvertToPdf (s *_de .Sheet )*_g .Creator {_af :=s .X ();if _af ==nil {return nil ;};var _bc _g .PageSize ;var _cb bool ;if _fe :=_af .PageSetup ;_fe !=nil {if _cbd :=_fe .PaperSizeAttr ;_cbd !=nil {_bc =_gefb [*_cbd ];};_cb =_fe .OrientationAttr ==_gg .ST_OrientationLandscape ;};if (_bc ==_g .PageSize {}){_bc =_gefb [1];};if _cb {_bc [0],_bc [1]=_bc [1],_bc [0];};_da :=_g .New ();_da .SetPageSize (_bc );var _ee ,_bf ,_dad ,_fd float64 ;if _bb :=_af .PageMargins ;_bb !=nil {_dad =_bb .LeftAttr ;_fd =_bb .RightAttr ;_ee =_bb .TopAttr ;_bf =_bb .BottomAttr ;};if _dad < 0.25{_dad =0.25;};if _fd < 0.25{_fd =0.25;};_ee *=_ff .Inch ;_bf *=_ff .Inch ;_dad *=_ff .Inch ;_fd *=_ff .Inch ;_da .SetPageMargins (_dad ,_fd ,_ee ,_bf );_cd :=s .Workbook ();var _ef *_ag .Theme ;if len (_cd .Themes ())> 0{_ef =_cd .Themes ()[0];};_efc :=&convertContext {_fad :_da ,_gaac :s ,_fbbb :s .Workbook (),_fde :_ef ,_gdgg :&s .Workbook ().StyleSheet ,_age :_ee ,_fgfg :_dad ,_agdgb :_bc [1]-_bf -_ee ,_dee :_bc [0]-_fd -_dad };_efc .makeAnchors ();_efc .determineMaxIndexes ();if _efc ._ccgc ==0&&_efc ._febae ==0{_da .NewPage ();return _da ;};_efc .makeCols ();_efc .makeRows ();_efc .makeMergedCells ();_efc .makeCells ();_efc .makePagespans ();_efc .makeRowspans ();_efc .makePages ();_efc .fillPages ();_efc .distributeAnchors ();_efc .drawSheet ();return _da ;};func _babb (_dcff *symbol ){_gaada :=_g .New ();_dfe :=_gaada .NewStyledParagraph ();_dfe .SetMargins (0,0,0,0);_ebgg :=_dfe .Append (_dcff ._fdeg );if _dcff ._gece !=nil {_ebgg .Style =*_dcff ._gece ;};_dcff ._ddag =_dfe .Height ();if _dcff ._bbfgg ==0{_dcff ._bbfgg =_dfe .Width ();};};

// RegisterFontsFromDirectory registers all fonts from the given directory automatically detecting font families and styles.
func RegisterFontsFromDirectory (dirName string )error {return _b .RegisterFontsFromDirectory (dirName )};func (_efca *convertContext )makeRows (){_bd :=[]*rowInfo {};_gca :=_efca ._gaac .Rows ();_cfe :=0;for _ ,_bcc :=range _gca {_cfe ++;_gdg :=int (_bcc .RowNumber ());if _gdg > _cfe {for _cee :=_cfe ;_cee < _gdg ;_cee ++{_bd =append (_bd ,&rowInfo {_fgdd :16/_gf });};_cfe =_gdg ;};var _dfc float64 ;if _bcc .X ().HtAttr ==nil {_dfc =16;}else {_dfc =*_bcc .X ().HtAttr ;};_bd =append (_bd ,&rowInfo {_fgdd :_dfc /_gf ,_ecc :true ,_deeb :_efca .getStyle (_bcc .X ().SAttr )});};for _gb :=len (_bd );_gb < _efca ._ccgc ;_gb ++{_bd =append (_bd ,&rowInfo {_fgdd :16/_gf });};_efca ._afd =_bd ;};type cell struct{_cbbf _gg .ST_CellType ;_fcga int ;_gab float64 ;_bbda []*line ;_bccg float64 ;_fbfd float64 ;_aag float64 ;_aeda float64 ;_fagf float64 ;_gcg *_g .TextStyle ;_bdd *border ;_eagd *border ;_bbg *border ;_agfg *border ;_bbdb bool ;_cae bool ;};const _gag =3;func (_gce *convertContext )alignSymbolsVertically (_gbadf *cell ,_bae _gg .ST_VerticalAlignment ){var _ebac float64 ;switch _bae {case _gg .ST_VerticalAlignmentTop :_ebac =_def ;if _gbadf ._bbdb {_ebac -=_dg ;}else if _gbadf ._cae {_ebac +=4*_dg ;};for _ ,_gcaa :=range _gbadf ._bbda {_ebac +=_gcaa ._gfcb ;_gcaa ._ageg =_ebac ;_ebac +=_fg ;};case _gg .ST_VerticalAlignmentCenter :_fbag :=0.0;for _ ,_ffba :=range _gbadf ._bbda {_fbag +=_ffba ._gfcb +_egf (1);};_ebac =0.5*(_gbadf ._aag -_fbag );if _gbadf ._bbdb {_ebac -=2*_dg ;}else if _gbadf ._cae {_ebac +=2*_dg ;};for _ ,_cbba :=range _gbadf ._bbda {_ebac +=_cbba ._gfcb +0.5*_fg ;_cbba ._ageg =_ebac ;_ebac +=0.5*_fg ;};default:_ebac =_gbadf ._aag -_def ;if _gbadf ._bbdb {_ebac -=4*_dg ;}else if _gbadf ._cae {_ebac +=_dg ;};for _fcc :=len (_gbadf ._bbda )-1;_fcc >=0;_fcc --{_gbadf ._bbda [_fcc ]._ageg =_ebac ;_ebac -=_gbadf ._bbda [_fcc ]._gfcb ;_ebac -=_fg ;};};};func (_dfbg *convertContext )getColorFromTheme (_cbae uint32 )string {_dede :=_dfbg ._fbbb .Themes ();if len (_dede )!=0{_cgef :=_dede [0];if _aege :=_cgef .ThemeElements ;_aege !=nil {if _bee :=_aege .ClrScheme ;_bee !=nil {switch _cbae {case 0:return _b .GetColorStringFromDmlColor (_bee .Lt1 );case 1:return _b .GetColorStringFromDmlColor (_bee .Dk1 );case 2:return _b .GetColorStringFromDmlColor (_bee .Lt2 );case 3:return _b .GetColorStringFromDmlColor (_bee .Dk2 );case 4:return _b .GetColorStringFromDmlColor (_bee .Accent1 );case 5:return _b .GetColorStringFromDmlColor (_bee .Accent2 );case 6:return _b .GetColorStringFromDmlColor (_bee .Accent3 );case 7:return _b .GetColorStringFromDmlColor (_bee .Accent4 );case 8:return _b .GetColorStringFromDmlColor (_bee .Accent5 );case 9:return _b .GetColorStringFromDmlColor (_bee .Accent6 );};};};};return "";};type mergedCell struct{_dcaf uint32 ;_fccg uint32 ;_adb uint32 ;_fcfa uint32 ;_gbga float64 ;_bbbc float64 ;};const _dg =1.5;func (_dggdg *convertContext )getStyleFromRPrElt (_debgf *_gg .CT_RPrElt )*style {if _debgf ==nil {return nil ;};_bdfb :=&style {};_bdfb ._bdf =&_debgf .RFont .ValAttr ;if _agbc :=_debgf .B ;_agbc !=nil {_ddcd :=_agbc .ValAttr ==nil ||*_agbc .ValAttr ;_bdfb ._acf =&_ddcd ;};if _cefa :=_debgf .I ;_cefa !=nil {_bbc :=_cefa .ValAttr ==nil ||*_cefa .ValAttr ;_bdfb ._gbc =&_bbc ;};if _ecbc :=_debgf .U ;_ecbc !=nil {_gaga :=_ecbc .ValAttr ==_gg .ST_UnderlineValuesSingle ||_ecbc .ValAttr ==_gg .ST_UnderlineValuesUnset ;_bdfb ._abg =&_gaga ;};if _eafg :=_debgf .VertAlign ;_eafg !=nil {_fegge :=_eafg .ValAttr ==_ge .ST_VerticalAlignRunSuperscript ;_bdfb ._bgag =&_fegge ;_dgeg :=_eafg .ValAttr ==_ge .ST_VerticalAlignRunSubscript ;_bdfb ._dgfe =&_dgeg ;};if _gdda :=_debgf .Sz ;_gdda !=nil {_ddaf :=_gdda .ValAttr /12*_b .DefaultFontSize ;_bdfb ._gcab =&_ddaf ;};if _faa :=_debgf .Color ;_faa !=nil {_bdfb ._gdddg =_dggdg .getColorStringFromSmlColor (_faa );};return _bdfb ;};func _cega (_egaf ,_ccd *style ){if _ccd ==nil {return ;};if _egaf ==nil {_egaf =_ccd ;return ;};if _egaf ._bdf ==nil {_egaf ._bdf =_ccd ._bdf ;};if _egaf ._gdddg ==nil {_egaf ._gdddg =_ccd ._gdddg ;};if _egaf ._gcab ==nil {_egaf ._gcab =_ccd ._gcab ;};if _egaf ._acf ==nil {_egaf ._acf =_ccd ._acf ;};if _egaf ._gbc ==nil {_egaf ._gbc =_ccd ._gbc ;};if _egaf ._abg ==nil {_egaf ._abg =_ccd ._abg ;};if _egaf ._bgag ==nil {_egaf ._bgag =_ccd ._bgag ;};if _egaf ._dgfe ==nil {_egaf ._dgfe =_ccd ._dgfe ;};if _egaf ._ecfc ==nil {_egaf ._ecfc =_ccd ._ecfc ;};if _egaf ._bacc ==nil {_egaf ._bacc =_ccd ._bacc ;};if _egaf ._gfd ==nil {_egaf ._gfd =_ccd ._gfd ;};if _egaf ._efef ==nil {_egaf ._efef =_ccd ._efef ;};if _egaf ._bdg ==_gg .ST_VerticalAlignmentUnset {_egaf ._bdg =_ccd ._bdg ;};if _egaf ._ceef ==_gg .ST_HorizontalAlignmentUnset {_egaf ._ceef =_ccd ._ceef ;};};func (_efg *convertContext )getStyle (_gfge *uint32 )*style {_eaae :=&style {};_ggfe :=false ;if _gfge !=nil {_dceg :=_efg ._gdgg .GetCellStyle (*_gfge );_fcee :=_dceg .GetFont ();for _ ,_affg :=range _fcee .Name {if _affg !=nil {_eaae ._bdf =&_affg .ValAttr ;_ggfe =true ;break ;};};for _ ,_cdcd :=range _fcee .B {if _cdcd !=nil {_cfd :=_cdcd .ValAttr ==nil ||*_cdcd .ValAttr ;_eaae ._acf =&_cfd ;_ggfe =true ;break ;};};for _ ,_baa :=range _fcee .I {if _baa !=nil {_cfc :=_baa .ValAttr ==nil ||*_baa .ValAttr ;_eaae ._gbc =&_cfc ;_ggfe =true ;break ;};};for _ ,_fagbb :=range _fcee .U {if _fagbb !=nil {_bade :=_fagbb .ValAttr ==_gg .ST_UnderlineValuesSingle ||_fagbb .ValAttr ==_gg .ST_UnderlineValuesUnset ;_eaae ._abg =&_bade ;_ggfe =true ;break ;};};for _ ,_cgbe :=range _fcee .Sz {if _cgbe !=nil {_gedg :=_cgbe .ValAttr /12*_b .DefaultFontSize ;_eaae ._gcab =&_gedg ;_ggfe =true ;break ;};};for _ ,_dacd :=range _fcee .VertAlign {if _dacd !=nil {_bcf :=_dacd .ValAttr ==_ge .ST_VerticalAlignRunSuperscript ;_eaae ._bgag =&_bcf ;_abef :=_dacd .ValAttr ==_ge .ST_VerticalAlignRunSubscript ;_eaae ._dgfe =&_abef ;_ggfe =true ;break ;};};for _ ,_cadc :=range _fcee .Color {if _cadc !=nil {_eaae ._gdddg =_efg .getColorStringFromSmlColor (_cadc );_ggfe =true ;break ;};};_bdbg :=_dceg .GetBorder ();if _bdbg .Top !=nil {_eaae ._ecfc =_efg .getBorder (_bdbg .Top );_ggfe =true ;};if _bdbg .Bottom !=nil {_eaae ._bacc =_efg .getBorder (_bdbg .Bottom );_ggfe =true ;};if _bdbg .Left !=nil {_eaae ._gfd =_efg .getBorder (_bdbg .Left );_ggfe =true ;};if _bdbg .Right !=nil {_eaae ._efef =_efg .getBorder (_bdbg .Right );_ggfe =true ;};if _dceg .Wrapped (){_eaae ._gec =true ;_ggfe =true ;};if _aaa :=_dceg .GetVerticalAlignment ();_aaa !=_gg .ST_VerticalAlignmentUnset {_eaae ._bdg =_aaa ;_ggfe =true ;};if _gcgb :=_dceg .GetHorizontalAlignment ();_gcgb !=_gg .ST_HorizontalAlignmentUnset {_eaae ._ceef =_gcgb ;_ggfe =true ;};};if _ggfe {return _eaae ;};return nil ;};func (_gee *convertContext )getStyleFromCell (_daf _de .Cell ,_efb ,_cad *style )*style {_ggf :=_daf .X ();_gfga :=_gee .getStyle (_ggf .SAttr );_cega (_gfga ,_efb );_cega (_gfga ,_cad );return _gfga ;};const (FontStyle_Regular FontStyle =0;FontStyle_Bold FontStyle =1;FontStyle_Italic FontStyle =2;FontStyle_BoldItalic FontStyle =3;);type anchor struct{_cag _f .Image ;_daeb *_d .ChartSpace ;_gceb int ;_cgge int64 ;_ecb int ;_fcfad int64 ;_dfb int ;_afc int64 ;_ebee int ;_geag int64 ;};type rowspan struct{_afgf float64 ;_gcec int ;_ebgfd int ;};func (_bgaa *convertContext )drawSheet (){for _bef ,_edd :=range _bgaa ._edgc {_daca :=len (_edd ._fdb );if _bef ==len (_bgaa ._edgc )-1{for _dcf :=len (_edd ._fdb )-1;_dcf >=0;_dcf --{if !_edd ._fdb [_dcf ]._ddb {_daca =_dcf ;};};};_efdd :=_edd ._fdb [:_daca ];for _ ,_gagd :=range _efdd {_bgaa ._fad .NewPage ();_bgaa .drawPage (_gagd );};};};func (_ega *convertContext )fillPages (){for _bad ,_fef :=range _ega ._dba {_ggec :=_ega ._afd [_fef ._gcec :_fef ._ebgfd ];for _eeb ,_bbe :=range _ggec {_bbbe :=0;_dgf :=0.0;_fbd :=[]*cell {};if _bbe ._ecc {for _ ,_aed :=range _bbe ._eeab {_ddg :=_ega ._edgc [_bbbe ];_ega ._fgcd =_ddg ._fdb [_bad ];_ega ._fgcd ._ddb =true ;_gaa :=_aed ._fbfd ;if _dgf +_gaa > _ddg ._aeeb {_ega .addRowToPage (_fbd ,_eeb );_fbd =[]*cell {_aed };_dgf =_gaa ;_bbbe ++;}else {_aed ._gab =_dgf ;_fbd =append (_fbd ,_aed );_dgf +=_gaa ;};};if len (_fbd )> 0{_gbea :=_ega ._edgc [_bbbe ];_ega ._fgcd =_gbea ._fdb [_bad ];_ega ._fgcd ._ddb =true ;_ega .addRowToPage (_fbd ,_eeb );};};};};};type convertContext struct{_fad *_g .Creator ;_fbbb *_de .Workbook ;_fde *_ag .Theme ;_gaac *_de .Sheet ;_gdgg *_de .StyleSheet ;_ccgc int ;_febae int ;_edgc []*pagespan ;_fgcd *page ;_aega []*colInfo ;_afd []*rowInfo ;_dba []*rowspan ;_age float64 ;_fgfg float64 ;_agdgb float64 ;_dee float64 ;_feda []*mergedCell ;_bfbc []*anchor ;};type line struct{_ageg float64 ;_cefb []*symbol ;_gfcb float64 ;};var _gefb =map[uint32 ]_g .PageSize {1:_g .PageSize {8.5*_ff .Inch ,11*_ff .Inch },2:_g .PageSize {8.5*_ff .Inch ,11*_ff .Inch },3:_g .PageSize {11*_ff .Inch ,17*_ff .Inch },4:_g .PageSize {17*_ff .Inch ,11*_ff .Inch },5:_g .PageSize {8.5*_ff .Inch ,14*_ff .Inch },6:_g .PageSize {5.5*_ff .Inch ,8.5*_ff .Inch },7:_g .PageSize {7.5*_ff .Inch ,10*_ff .Inch },8:_g .PageSize {_egf (297),_egf (420)},9:_g .PageSize {_egf (210),_egf (297)},10:_g .PageSize {_egf (210),_egf (297)},11:_g .PageSize {_egf (148),_egf (210)},70:_g .PageSize {_egf (105),_egf (148)},12:_g .PageSize {_egf (250),_egf (354)},13:_g .PageSize {_egf (182),_egf (257)},14:_g .PageSize {8.5*_ff .Inch ,13*_ff .Inch },20:_g .PageSize {4.125*_ff .Inch ,9.5*_ff .Inch },27:_g .PageSize {_egf (110),_egf (220)},28:_g .PageSize {_egf (162),_egf (229)},34:_g .PageSize {_egf (250),_egf (176)},29:_g .PageSize {_egf (324),_egf (458)},30:_g .PageSize {_egf (229),_egf (324)},31:_g .PageSize {_egf (114),_egf (162)},37:_g .PageSize {3.88*_ff .Inch ,7.5*_ff .Inch },43:_g .PageSize {_egf (100),_egf (148)},69:_g .PageSize {_egf (200),_egf (148)}};func (_ffb *convertContext )makeRowspans (){var _gaf float64 ;_fgdf :=0;for _adcc ,_bbf :=range _ffb ._afd {_baf :=_bbf ._fgdd +_bbf ._dbe ;if _gaf +_baf <=_ffb ._agdgb {_bbf ._degd =_gaf ;_gaf +=_baf ;}else {_ffb ._dba =append (_ffb ._dba ,&rowspan {_afgf :_gaf ,_gcec :_fgdf ,_ebgfd :_adcc });_fgdf =_adcc ;_bbf ._degd =0;_gaf =_baf ;};};_ffb ._dba =append (_ffb ._dba ,&rowspan {_afgf :_gaf ,_gcec :_fgdf ,_ebgfd :len (_ffb ._afd )});};type pagespan struct{_aeeb float64 ;_fdb []*page ;_eafd int ;_gfe int ;};type symbol struct{_fdeg string ;_eebe float64 ;_ddag float64 ;_bbfgg float64 ;_gece *_g .TextStyle ;_aebd string ;};func (_affc *convertContext )alignSymbolsHorizontally (_defc *cell ,_ebfg _gg .ST_HorizontalAlignment ){if _ebfg ==_gg .ST_HorizontalAlignmentUnset {switch _defc ._cbbf {case _gg .ST_CellTypeB :_ebfg =_gg .ST_HorizontalAlignmentCenter ;case _gg .ST_CellTypeN :_ebfg =_gg .ST_HorizontalAlignmentRight ;default:_ebfg =_gg .ST_HorizontalAlignmentLeft ;};};var _adeb float64 ;for _ ,_eeba :=range _defc ._bbda {switch _ebfg {case _gg .ST_HorizontalAlignmentLeft :_adeb =_gag ;case _gg .ST_HorizontalAlignmentRight :_dbg :=_dda (_eeba ._cefb );_adeb =_defc ._bccg -_gag -_dbg ;case _gg .ST_HorizontalAlignmentCenter :_eaf :=_dda (_eeba ._cefb );_adeb =(_defc ._bccg -_eaf )/2;};for _ ,_agb :=range _eeba ._cefb {_agb ._eebe +=_adeb ;};};};type style struct{_gdddg *string ;_gcab *float64 ;_bdf *string ;_acf *bool ;_gbc *bool ;_abg *bool ;_bgag *bool ;_dgfe *bool ;_ecfc *border ;_bacc *border ;_gfd *border ;_efef *border ;_gec bool ;_bdg _gg .ST_VerticalAlignment ;_ceef _gg .ST_HorizontalAlignment ;};func (_ebe *convertContext )getSymbolsFromString (_gae string ,_fbg *style )[]*symbol {_bbfg :=[]*symbol {};_agdg :=_ebe .makeTextStyleFromCellStyle (_fbg );for _ ,_agf :=range _gae {_bbfg =append (_bbfg ,&symbol {_fdeg :string (_agf ),_gece :_agdg });};return _bbfg ;};func (_geg *convertContext )determineMaxIndexes (){var _afa ,_fb int ;_afa =int (_geg ._gaac .MaxColumnIdx ());_fc :=_geg ._gaac .Rows ();if len (_fc )> 0{_fb =int (_fc [len (_fc )-1].RowNumber ());};for _ ,_deb :=range _geg ._bfbc {if _deb ._dfb >=_fb {_fb =_deb ._dfb +1;};if _deb ._ebee >=_afa {_afa =_deb ._ebee +1;};};_geg ._ccgc =_fb ;_geg ._febae =_afa ;};func _facg (_fgc []*symbol )float64 {_geab :=0.0;for _ ,_efab :=range _fgc {if _efab ._ddag > _geab {_geab =_efab ._ddag ;};};return _geab ;};func _dda (_geaf []*symbol )float64 {_bbagc :=0.0;for _ ,_efde :=range _geaf {_bbagc +=_efde ._bbfgg ;};return _bbagc ;};func (_dacf *convertContext )getBorder (_gege *_gg .CT_BorderPr )*border {_cbfb :=&border {};switch _gege .StyleAttr {case _gg .ST_BorderStyleThin :_cbfb ._affag =_agg ;case _gg .ST_BorderStyleMedium :_cbfb ._affag =_agg *2;case _gg .ST_BorderStyleThick :_cbfb ._affag =_agg *4;};if _cbfb ._affag ==0.0{return nil ;};if _fbaa :=_gege .Color ;_fbaa !=nil {_ecg :=_dacf .getColorStringFromSmlColor (_fbaa );if _ecg !=nil {_cbfb ._fagb =_g .ColorRGBFromHex (*_ecg );}else {_cbfb ._fagb =_g .ColorBlack ;};};return _cbfb ;};type colWidthRange struct{_bfad int ;_ffbb int ;_gfdc float64 ;_ggac *style ;};var _gf =3.025/_egf (1);var _ebeb =[]string {"\u0030\u0030\u0030\u0030\u0030\u0030","\u0066\u0066\u0066\u0066\u0066\u0066","\u0066\u0066\u0030\u0030\u0030\u0030","\u0030\u0030\u0066\u0066\u0030\u0030","\u0030\u0030\u0030\u0030\u0066\u0066","\u0066\u0066\u0066\u0066\u0030\u0030","\u0066\u0066\u0030\u0030\u0066\u0066","\u0030\u0030\u0066\u0066\u0066\u0066","\u0030\u0030\u0030\u0030\u0030\u0030","\u0066\u0066\u0066\u0066\u0066\u0066","\u0066\u0066\u0030\u0030\u0030\u0030","\u0030\u0030\u0066\u0066\u0030\u0030","\u0030\u0030\u0030\u0030\u0066\u0066","\u0066\u0066\u0066\u0066\u0030\u0030","\u0066\u0066\u0030\u0030\u0066\u0066","\u0030\u0030\u0066\u0066\u0066\u0066","\u0038\u0030\u0030\u0030\u0030\u0030","\u0030\u0030\u0038\u0030\u0030\u0030","\u0030\u0030\u0030\u0030\u0038\u0030","\u0038\u0030\u0038\u0030\u0030\u0030","\u0038\u0030\u0030\u0030\u0038\u0030","\u0030\u0030\u0038\u0030\u0038\u0030","\u0063\u0030\u0063\u0030\u0063\u0030","\u0038\u0030\u0038\u0030\u0038\u0030","\u0039\u0039\u0039\u0039\u0066\u0066","\u0039\u0039\u0033\u0033\u0036\u0036","\u0066\u0066\u0066\u0066\u0063\u0063","\u0063\u0063\u0066\u0066\u0066\u0066","\u0036\u0036\u0030\u0030\u0036\u0036","\u0066\u0066\u0038\u0030\u0038\u0030","\u0030\u0030\u0036\u0036\u0063\u0063","\u0063\u0063\u0063\u0063\u0066\u0066","\u0030\u0030\u0030\u0030\u0038\u0030","\u0066\u0066\u0030\u0030\u0066\u0066","\u0066\u0066\u0066\u0066\u0030\u0030","\u0030\u0030\u0066\u0066\u0066\u0066","\u0038\u0030\u0030\u0030\u0038\u0030","\u0038\u0030\u0030\u0030\u0030\u0030","\u0030\u0030\u0038\u0030\u0038\u0030","\u0030\u0030\u0030\u0030\u0066\u0066","\u0030\u0030\u0063\u0063\u0066\u0066","\u0063\u0063\u0066\u0066\u0066\u0066","\u0063\u0063\u0066\u0066\u0063\u0063","\u0066\u0066\u0066\u0066\u0039\u0039","\u0039\u0039\u0063\u0063\u0066\u0066","\u0066\u0066\u0039\u0039\u0063\u0063","\u0063\u0063\u0039\u0039\u0066\u0066","\u0066\u0066\u0063\u0063\u0039\u0039","\u0033\u0033\u0036\u0036\u0066\u0066","\u0033\u0033\u0063\u0063\u0063\u0063","\u0039\u0039\u0063\u0063\u0030\u0030","\u0066\u0066\u0063\u0063\u0030\u0030","\u0066\u0066\u0039\u0039\u0030\u0030","\u0066\u0066\u0036\u0036\u0030\u0030","\u0036\u0036\u0036\u0036\u0039\u0039","\u0039\u0036\u0039\u0036\u0039\u0036","\u0030\u0030\u0033\u0033\u0036\u0036","\u0033\u0033\u0039\u0039\u0036\u0036","\u0030\u0030\u0033\u0033\u0030\u0030","\u0033\u0033\u0033\u0033\u0030\u0030","\u0039\u0039\u0033\u0033\u0030\u0030","\u0039\u0039\u0033\u0033\u0036\u0036","\u0033\u0033\u0033\u0033\u0039\u0039","\u0033\u0033\u0033\u0033\u0033\u0033"};func (_eef *convertContext )makeCells (){_bda :=_eef ._gaac ;_fgd :=_bda .Rows ();_fga :=0;for _ ,_dggb :=range _eef ._afd {_dggb ._eeab =[]*cell {};_ege :=0.0;_gagb :=_dggb ._deeb ;if _dggb ._ecc {_ddc :=_fgd [_fga ];_fga ++;_eed :=_dggb ._fgdd ;for _ ,_bfa :=range _ddc .Cells (){_fff ,_dadc :=_gd .ParseCellReference (_bfa .Reference ());if _dadc !=nil {_a .Log .Debug ("\u0043\u0061\u006e\u006eo\u0074\u0020\u0070\u0061\u0072\u0073\u0065\u0020\u0061\u0020r\u0065f\u0065\u0072\u0065\u006e\u0063\u0065\u003a \u0025\u0073",_dadc );continue ;};_adf :=_eef ._aega [_fff .ColumnIdx ];_adc :=_adf ._bgagb ;_db :=_adc ;_bag :=_adf ._cggc ;var _bbd ,_dadcf ,_efd ,_gda bool ;for _ ,_bgb :=range _eef ._feda {if _fff .RowIdx >=_bgb ._dcaf &&_fff .RowIdx <=_bgb ._adb &&_fff .ColumnIdx >=_bgb ._fccg &&_fff .ColumnIdx <=_bgb ._fcfa {if _fff .ColumnIdx ==_bgb ._fccg &&_fff .RowIdx ==_bgb ._dcaf {_adc =_bgb ._gbga ;_eed =_bgb ._bbbc ;};_bbd =_fff .RowIdx !=_bgb ._dcaf ;_dadcf =_fff .RowIdx !=_bgb ._adb ;_efd =_fff .ColumnIdx !=_bgb ._fccg ;_gda =_fff .ColumnIdx !=_bgb ._fcfa ;};};_fdd :=_eef .getStyleFromCell (_bfa ,_gagb ,_bag );var _bbdd ,_efe ,_cgaa bool ;var _gbe ,_dgb ,_gge ,_fbf *border ;var _ddca _gg .ST_VerticalAlignment ;var _eaad _gg .ST_HorizontalAlignment ;if _fdd !=nil {if !_bbd {_gbe =_fdd ._ecfc ;};if !_dadcf {_dgb =_fdd ._bacc ;};if !_efd {_gge =_fdd ._gfd ;};if !_gda {_fbf =_fdd ._efef ;};if _dgb !=nil &&_dgb ._affag > _ege {_ege =_dgb ._affag ;};_ddca =_fdd ._bdg ;_eaad =_fdd ._ceef ;if _fdd ._bgag !=nil {_bbdd =*_fdd ._bgag ;};if _fdd ._dgfe !=nil {_efe =*_fdd ._dgfe ;};_cgaa =_fdd ._gec ;};_ceb ,_eda :=_eef .getContentFromCell (_bfa ,_fdd ,_adc ,_cgaa );_cca :=&cell {_cbbf :_eda ,_bccg :_adc ,_fbfd :_db ,_aag :_eed ,_bbda :_ceb ,_bdd :_gbe ,_eagd :_dgb ,_bbg :_gge ,_agfg :_fbf ,_bbdb :_bbdd ,_cae :_efe };_eef .alignSymbolsHorizontally (_cca ,_eaad );_eef .alignSymbolsVertically (_cca ,_ddca );_dggb ._eeab =append (_dggb ._eeab ,_cca );};};_dggb ._dbe =_ege ;};};func (_efcg *convertContext )combineCellStyleWithRPrElt (_dcffe *style ,_ggb *_gg .CT_RPrElt )*style {_affb :=*_dcffe ;_add :=_efcg .getStyleFromRPrElt (_ggb );if _add ==nil {return &_affb ;};if _add ._gdddg !=nil {_affb ._gdddg =_add ._gdddg ;};if _add ._gcab !=nil {_affb ._gcab =_add ._gcab ;};if _add ._bdf !=nil {_affb ._bdf =_add ._bdf ;};if _add ._acf !=nil {_affb ._acf =_add ._acf ;};if _add ._gbc !=nil {_affb ._gbc =_add ._gbc ;};if _add ._abg !=nil {_affb ._abg =_add ._abg ;};if _add ._bgag !=nil {_affb ._bgag =_add ._bgag ;};if _add ._dgfe !=nil {_affb ._dgfe =_add ._dgfe ;};return &_affb ;};func (_efdf *convertContext )getContentFromCell (_dgge _de .Cell ,_fed *style ,_fae float64 ,_deda bool )([]*line ,_gg .ST_CellType ){_aca :=_dgge .X ();var _gfg []*symbol ;switch _aca .TAttr {case _gg .ST_CellTypeS :_fagg :=_aca .V ;if _fagg !=nil {_dgab ,_fcbf :=_e .Atoi (*_fagg );if _fcbf ==nil {_fegd :=_efdf ._fbbb .SharedStrings .X ().Si [_dgab ];if _fegd .T !=nil {_gfg =_efdf .getSymbolsFromString (*_fegd .T ,_fed );}else if _fegd .R !=nil {_gfg =_efdf .getSymbolsFromR (_fegd .R ,_fed );};};};case _gg .ST_CellTypeB :_gaad :=_aca .V ;if _gaad !=nil {if *_gaad =="\u0030"{_gfg =_efdf .getSymbolsFromString ("\u0046\u0041\u004cS\u0045",_fed );}else {_gfg =_efdf .getSymbolsFromString ("\u0054\u0052\u0055\u0045",_fed );};};default:_gfg =_efdf .getSymbolsFromString (_dgge .GetFormattedValue (),_fed );};_eeg :=0.0;_ebgf :=0.0;var _dagb []*line ;var _gfc bool ;if _fed !=nil {if _fed ._bgag !=nil {if *_fed ._bgag {_gfc =true ;};};if _fed ._dgfe !=nil {if *_fed ._dgfe {_gfc =true ;};};};if _deda {_dagb =[]*line {};_acdg :=_fae -2*_gag ;_ced :=[]*symbol {};for _ ,_acc :=range _gfg {_babb (_acc );if _eeg +_acc ._bbfgg >=_acdg {_fgf :=_facg (_ced );if _gfc {_fgf /=_df ;};_dagb =append (_dagb ,&line {_ageg :_ebgf ,_cefb :_ced ,_gfcb :_fgf });_ced =[]*symbol {_acc };_eeg =_acc ._bbfgg ;_ebgf +=_fgf ;}else {_acc ._eebe =_eeg ;_eeg +=_acc ._bbfgg ;_ced =append (_ced ,_acc );};};_eag :=_facg (_ced );if _gfc {_eag /=_df ;};if len (_ced )> 0{_dagb =append (_dagb ,&line {_ageg :_ebgf ,_cefb :_ced ,_gfcb :_eag });};}else {for _ ,_bgg :=range _gfg {_babb (_bgg );_bgg ._eebe =_eeg ;_eeg +=_bgg ._bbfgg ;};if len (_gfg )> 0{_dagb =[]*line {&line {_cefb :_gfg ,_gfcb :_facg (_gfg )}};};};_cbb :=_aca .TAttr ;if _cbb ==_gg .ST_CellTypeUnset {_cbb =_gg .ST_CellTypeN ;};return _dagb ,_cbb ;};type rowInfo struct{_degd float64 ;_ecc bool ;_fgdd float64 ;_deeb *style ;_eeab []*cell ;_dbe float64 ;};var _fg =_egf (1);func (_bdb *convertContext )distributeAnchors (){for _ ,_dggd :=range _bdb ._bfbc {_eba ,_gef :=_dggd ._gceb ,_dggd ._cgge ;_acda ,_aecd :=_dggd ._ecb ,_dggd ._fcfad ;_aff ,_fbe :=_dggd ._dfb ,_dggd ._afc ;_cef ,_gad :=_dggd ._ebee ,_dggd ._geag ;var _bgbd ,_dfa ,_ceg ,_ead *page ;for _ ,_fac :=range _bdb ._edgc {for _ ,_gbed :=range _fac ._fdb {if _eba >=_gbed ._fabe ._gcec &&_eba < _gbed ._fabe ._ebgfd {if _acda >=_gbed ._dadb ._eafd &&_acda < _gbed ._dadb ._gfe {_gbed ._ddb =true ;_bgbd =_gbed ;};if _cef >=_gbed ._dadb ._eafd &&_cef < _gbed ._dadb ._gfe {_gbed ._ddb =true ;_dfa =_gbed ;};};if _aff >=_gbed ._fabe ._gcec &&_aff < _gbed ._fabe ._ebgfd {if _acda >=_gbed ._dadb ._eafd &&_acda < _gbed ._dadb ._gfe {_gbed ._ddb =true ;_ead =_gbed ;};if _cef >=_gbed ._dadb ._eafd &&_cef < _gbed ._dadb ._gfe {_gbed ._ddb =true ;_ceg =_gbed ;};};};};_fdg :=_bgbd !=_dfa ;_daaf :=_bgbd !=_ead ;if _fdg &&_daaf {_fgdg :=_bdb ._aega [_acda ]._babbg +_ff .FromEMU (_aecd );_bga :=_bgbd ._dadb ._aeeb ;_dca :=_bdb ._aega [_cef ]._babbg +_ff .FromEMU (_gad );_abe :=_bdb ._afd [_eba ]._degd +_ff .FromEMU (_gef );_beda :=float64 (_bgbd ._fabe ._afgf );_ccbb :=_bdb ._afd [_aff ]._degd +_ff .FromEMU (_fbe );_cgg :=_dca +_bga -_fgdg ;_efce :=_ccbb +_beda -_abe ;_dfg :=_bdb .imageFromAnchor (_dggd ,_cgg ,_efce );_bgbd ._cdc =append (_bgbd ._cdc ,_bdb .getImage (_dfg ,_efce ,_cgg ,_fgdg ,_abe ,_bga -_fgdg ,_beda -_abe ,_b .ImgPart_lt ));_dfa ._cdc =append (_dfa ._cdc ,_bdb .getImage (_dfg ,_efce ,_cgg ,0,_abe ,_bga -_fgdg ,_beda -_abe ,_b .ImgPart_rt ));_ead ._cdc =append (_ead ._cdc ,_bdb .getImage (_dfg ,_efce ,_cgg ,_fgdg ,0,_bga -_fgdg ,_beda -_abe ,_b .ImgPart_lb ));_ceg ._cdc =append (_ceg ._cdc ,_bdb .getImage (_dfg ,_efce ,_cgg ,0,0,_bga -_fgdg ,_beda -_abe ,_b .ImgPart_rb ));}else if _fdg {_aga :=_bdb ._afd [_eba ]._degd +_ff .FromEMU (_gef );_gade :=_bdb ._afd [_aff ]._degd +_ff .FromEMU (_fbe );_ebg :=_bdb ._aega [_acda ]._babbg +_ff .FromEMU (_aecd );_fab :=_bgbd ._dadb ._aeeb ;_cgcb :=_bdb ._aega [_cef ]._babbg +_ff .FromEMU (_gad );_eff :=_cgcb +_fab -_ebg ;_gbeb :=_gade -_aga ;_ca :=_bdb .imageFromAnchor (_dggd ,_eff ,_gbeb );_bgbd ._cdc =append (_bgbd ._cdc ,_bdb .getImage (_ca ,_gbeb ,_eff ,_ebg ,_aga ,_fab -_ebg ,0,_b .ImgPart_l ));_dfa ._cdc =append (_dfa ._cdc ,_bdb .getImage (_ca ,_gbeb ,_eff ,0,_aga ,_fab -_ebg ,0,_b .ImgPart_r ));}else if _daaf {_edc :=_bdb ._aega [_acda ]._babbg +_ff .FromEMU (_aecd );_aab :=_bdb ._aega [_cef ]._babbg +_ff .FromEMU (_gad );_fca :=_bdb ._afd [_eba ]._degd +_ff .FromEMU (_gef );_gaaf :=float64 (_bgbd ._fabe ._afgf );_dae :=_bdb ._afd [_aff ]._degd +_ff .FromEMU (_fbe );_ffda :=_aab -_edc ;_fcf :=_dae +_gaaf -_fca ;_bgab :=_bdb .imageFromAnchor (_dggd ,_ffda ,_fcf );_bgbd ._cdc =append (_bgbd ._cdc ,_bdb .getImage (_bgab ,_fcf ,_ffda ,_edc ,_fca ,0,_gaaf -_fca ,_b .ImgPart_t ));_ead ._cdc =append (_ead ._cdc ,_bdb .getImage (_bgab ,_fcf ,_ffda ,_edc ,0,0,_gaaf -_fca ,_b .ImgPart_b ));}else {_cff :=_bdb ._aega [_acda ]._babbg +_ff .FromEMU (_aecd );_bbfa :=_bdb ._aega [_cef ]._babbg +_ff .FromEMU (_gad );_fbda :=_bdb ._afd [_eba ]._degd +_ff .FromEMU (_gef );_fegg :=_bdb ._afd [_aff ]._degd +_ff .FromEMU (_fbe );_fba :=_bbfa -_cff ;_bgf :=_fegg -_fbda ;_gea :=_bdb .imageFromAnchor (_dggd ,_fba ,_bgf );_bgbd ._cdc =append (_bgbd ._cdc ,_bdb .getImage (_gea ,_bgf ,_fba ,_cff ,_fbda ,0,0,_b .ImgPart_whole ));};};};const _def =2;func _egf (_eegf float64 )float64 {return _eegf *_ff .Millimeter };func (_cfeb *convertContext )makePages (){for _ ,_gba :=range _cfeb ._edgc {for _ ,_agd :=range _cfeb ._dba {_gba ._fdb =append (_gba ._fdb ,&page {_ecf :[]*pageRow {},_dadb :_gba ,_fabe :_agd });};};};