//
// Copyright 2020 FoxyUtils ehf. All rights reserved.
//
// This is a commercial product and requires a license to operate.
// A trial license can be obtained at https://unidoc.io
//
// DO NOT EDIT: generated by unitwist Go source code obfuscator.
//
// Use of this source code is governed by the UniDoc End User License Agreement
// terms that can be accessed at https://unidoc.io/eula/

package convert ;import (_a "github.com/unidoc/unioffice/common/logger";_ae "github.com/unidoc/unioffice/common/tempstorage";_efa "github.com/unidoc/unioffice/internal/convertutils";_fd "github.com/unidoc/unioffice/measurement";_ef "github.com/unidoc/unioffice/schema/soo/dml";_fg "github.com/unidoc/unioffice/schema/soo/dml/chart";_bf "github.com/unidoc/unioffice/schema/soo/ofc/sharedTypes";_bd "github.com/unidoc/unioffice/schema/soo/sml";_bfe "github.com/unidoc/unioffice/spreadsheet";_bdc "github.com/unidoc/unioffice/spreadsheet/reference";_bb "github.com/unidoc/unipdf/v3/creator";_e "github.com/unidoc/unipdf/v3/model";_f "image";_b "strconv";);func (_daed *convertContext )combineCellStyleWithRPrElt (_eag *style ,_gdg *_bd .CT_RPrElt )*style {_eggf :=*_eag ;_cbcaa :=_daed .getStyleFromRPrElt (_gdg );if _cbcaa ==nil {return &_eggf ;};if _cbcaa ._bggb !=nil {_eggf ._bggb =_cbcaa ._bggb ;};if _cbcaa ._eea !=nil {_eggf ._eea =_cbcaa ._eea ;};if _cbcaa ._acde !=nil {_eggf ._acde =_cbcaa ._acde ;};if _cbcaa ._faee !=nil {_eggf ._faee =_cbcaa ._faee ;};if _cbcaa ._bfbd !=nil {_eggf ._bfbd =_cbcaa ._bfbd ;};if _cbcaa ._abd !=nil {_eggf ._abd =_cbcaa ._abd ;};if _cbcaa ._cgbf !=nil {_eggf ._cgbf =_cbcaa ._cgbf ;};if _cbcaa ._gbaa !=nil {_eggf ._gbaa =_cbcaa ._gbaa ;};return &_eggf ;};const _dc =0.64;type colWidthRange struct{_daeb int ;_feee int ;_feac float64 ;_gfdf *style ;};var _gb =_ebg (0.0625);func (_cbfc *convertContext )makeRowspans (){var _dbg float64 ;_cdf :=0;for _gfgc ,_aba :=range _cbfc ._cdfa {_afb :=_aba ._geaa +_aba ._eeceg ;if _dbg +_afb <=_cbfc ._acfa {_aba ._bceb =_dbg ;_dbg +=_afb ;}else {_cbfc ._gcdf =append (_cbfc ._gcdf ,&rowspan {_feda :_dbg ,_dgbf :_cdf ,_faed :_gfgc });_cdf =_gfgc ;_aba ._bceb =0;_dbg =_afb ;};};_cbfc ._gcdf =append (_cbfc ._gcdf ,&rowspan {_feda :_dbg ,_dgbf :_cdf ,_faed :len (_cbfc ._cdfa )});};type page struct{_bdg []*pageRow ;_bdcb bool ;_bcf []*_bb .Image ;_dab *pagespan ;_efbg *rowspan ;};const _ed =3;type rowInfo struct{_bceb float64 ;_aefb bool ;_geaa float64 ;_feb *style ;_dgf []*cell ;_eeceg float64 ;};const _bc =2;type pagespan struct{_ecgad float64 ;_ggb []*page ;_faa int ;_fbcd int ;};func (_ca *convertContext )makeCols (){_eee :=_ca ._abc ;_be :=_eee .X ();_cf :=[]*colInfo {};_bfec :=[]colWidthRange {};if _eae :=_be .Cols ;len (_eae )> 0{for _ ,_fae :=range _eae [0].Col {_bcdd :=65.0;if _fbe :=_fae .WidthAttr ;_fbe !=nil {if *_fbe > 0.83{*_fbe -=0.83;};if *_fbe <=1{_bcdd =*_fbe *11;}else {_bcdd =5+*_fbe *6;};};_dcg :=int (_fae .MinAttr -1);_beb :=int (_fae .MaxAttr -1);_bfec =append (_bfec ,colWidthRange {_daeb :_dcg ,_feee :_beb ,_feac :_bcdd ,_gfdf :_ca .getStyle (_fae .StyleAttr )});};};_aac :=0;for _cdb :=0;_cdb <=_ca ._egaf ;_cdb ++{var _fba float64 ;var _daa *style ;if _aac >=len (_bfec ){_fba =65;}else {_cde :=_bfec [_aac ];if _cdb >=_cde ._daeb &&_cdb <=_cde ._feee {_fba =_cde ._feac ;_daa =_cde ._gfdf ;if _cdb ==_cde ._feee {_aac ++;};}else {_fba =65;};};_cf =append (_cf ,&colInfo {_dfcc :_fba ,_aacc :_daa });};_ca ._ebbf =_cf ;};func (_ecd *convertContext )getStyle (_dbef *uint32 )*style {_bdfd :=&style {};_dgfg :=false ;if _dbef !=nil {_ffaa :=_ecd ._ddf .GetCellStyle (*_dbef );_dfbd :=_ffaa .GetFont ();for _ ,_agge :=range _dfbd .Name {if _agge !=nil {_bdfd ._acde =&_agge .ValAttr ;_dgfg =true ;break ;};};for _ ,_aed :=range _dfbd .B {if _aed !=nil {_aafg :=_aed .ValAttr ==nil ||*_aed .ValAttr ;_bdfd ._faee =&_aafg ;_dgfg =true ;break ;};};for _ ,_ade :=range _dfbd .I {if _ade !=nil {_bbge :=_ade .ValAttr ==nil ||*_ade .ValAttr ;_bdfd ._bfbd =&_bbge ;_dgfg =true ;break ;};};for _ ,_dacc :=range _dfbd .U {if _dacc !=nil {_gca :=_dacc .ValAttr ==_bd .ST_UnderlineValuesSingle ||_dacc .ValAttr ==_bd .ST_UnderlineValuesUnset ;_bdfd ._abd =&_gca ;_dgfg =true ;break ;};};for _ ,_dabg :=range _dfbd .Sz {if _dabg !=nil {_cbca :=_dabg .ValAttr /12*_efa .DefaultFontSize ;_bdfd ._eea =&_cbca ;_dgfg =true ;break ;};};for _ ,_gfgd :=range _dfbd .VertAlign {if _gfgd !=nil {_dffd :=_gfgd .ValAttr ==_bf .ST_VerticalAlignRunSuperscript ;_bdfd ._cgbf =&_dffd ;_dfcg :=_gfgd .ValAttr ==_bf .ST_VerticalAlignRunSubscript ;_bdfd ._gbaa =&_dfcg ;_dgfg =true ;break ;};};for _ ,_dbag :=range _dfbd .Color {if _dbag !=nil {_bdfd ._bggb =_ecd .getColorStringFromSmlColor (_dbag );_dgfg =true ;break ;};};_ggff :=_ffaa .GetBorder ();if _ggff .Top !=nil {_bdfd ._fegf =_ecd .getBorder (_ggff .Top );_dgfg =true ;};if _ggff .Bottom !=nil {_bdfd ._fcce =_ecd .getBorder (_ggff .Bottom );_dgfg =true ;};if _ggff .Left !=nil {_bdfd ._gae =_ecd .getBorder (_ggff .Left );_dgfg =true ;};if _ggff .Right !=nil {_bdfd ._eabe =_ecd .getBorder (_ggff .Right );_dgfg =true ;};if _ffaa .Wrapped (){_bdfd ._dcgb =true ;_dgfg =true ;};if _daef :=_ffaa .GetVerticalAlignment ();_daef !=_bd .ST_VerticalAlignmentUnset {_bdfd ._bfba =_daef ;_dgfg =true ;};if _ebc :=_ffaa .GetHorizontalAlignment ();_ebc !=_bd .ST_HorizontalAlignmentUnset {_bdfd ._gecg =_ebc ;_dgfg =true ;};};if _dgfg {return _bdfd ;};return nil ;};func (_bfg *convertContext )determineMaxIndexes (){var _fa ,_baac int ;_fa =int (_bfg ._abc .MaxColumnIdx ());_bdb :=_bfg ._abc .Rows ();if len (_bdb )> 0{_baac =int (_bdb [len (_bdb )-1].RowNumber ());};for _ ,_cb :=range _bfg ._fdbc {if _cb ._ggc >=_baac {_baac =_cb ._ggc +1;};if _cb ._cbgd >=_fa {_fa =_cb ._cbgd +1;};};_bfg ._abbf =_baac ;_bfg ._egaf =_fa ;};var _gd =_ebg (1);func (_acgd *convertContext )getBorder (_dbbc *_bd .CT_BorderPr )*border {_fggd :=&border {};switch _dbbc .StyleAttr {case _bd .ST_BorderStyleThin :_fggd ._cda =_gb ;case _bd .ST_BorderStyleMedium :_fggd ._cda =_gb *2;case _bd .ST_BorderStyleThick :_fggd ._cda =_gb *4;};if _fggd ._cda ==0.0{return nil ;};if _bbee :=_dbbc .Color ;_bbee !=nil {_cgc :=_acgd .getColorStringFromSmlColor (_bbee );if _cgc !=nil {_fggd ._bgeg =_bb .ColorRGBFromHex (*_cgc );}else {_fggd ._bgeg =_bb .ColorBlack ;};};return _fggd ;};const _fc =0.25;

// RegisterFont makes a PdfFont accessible for using in converting to PDF.
func RegisterFont (name string ,style FontStyle ,font *_e .PdfFont ){_efa .RegisterFont (name ,style ,font );};func (_ccf *convertContext )getColorFromTheme (_ceef uint32 )string {_bbeg :=_ccf ._dae .Themes ();if len (_bbeg )!=0{_afeab :=_bbeg [0];if _ddef :=_afeab .ThemeElements ;_ddef !=nil {if _cfec :=_ddef .ClrScheme ;_cfec !=nil {switch _ceef {case 0:return _efa .GetColorStringFromDmlColor (_cfec .Lt1 );case 1:return _efa .GetColorStringFromDmlColor (_cfec .Dk1 );case 2:return _efa .GetColorStringFromDmlColor (_cfec .Lt2 );case 3:return _efa .GetColorStringFromDmlColor (_cfec .Dk2 );case 4:return _efa .GetColorStringFromDmlColor (_cfec .Accent1 );case 5:return _efa .GetColorStringFromDmlColor (_cfec .Accent2 );case 6:return _efa .GetColorStringFromDmlColor (_cfec .Accent3 );case 7:return _efa .GetColorStringFromDmlColor (_cfec .Accent4 );case 8:return _efa .GetColorStringFromDmlColor (_cfec .Accent5 );case 9:return _efa .GetColorStringFromDmlColor (_cfec .Accent6 );};};};};return "";};type cell struct{_gccf _bd .ST_CellType ;_eggd int ;_gbbd float64 ;_dgfa []*line ;_cdgf float64 ;_cec float64 ;_gcca float64 ;_ggfa float64 ;_fgf float64 ;_cagd *_bb .TextStyle ;_agd *border ;_ffad *border ;_ddea *border ;_dca *border ;_dea bool ;_aecd bool ;};func _cage (_efgb *symbol ){_bbec :=_bb .New ();_geb :=_bbec .NewStyledParagraph ();_geb .SetMargins (0,0,0,0);_dda :=_geb .Append (_efgb ._aebb );if _efgb ._ggfag !=nil {_dda .Style =*_efgb ._ggfag ;};_efgb ._aefc =_geb .Height ();if _efgb ._eafc ==0{_efgb ._eafc =_geb .Width ();};};func (_gaf *convertContext )makePages (){for _ ,_fff :=range _gaf ._fdda {for _ ,_gafd :=range _gaf ._gcdf {_fff ._ggb =append (_fff ._ggb ,&page {_bdg :[]*pageRow {},_dab :_fff ,_efbg :_gafd });};};};func (_geaf *convertContext )drawSheet (){for _fbc ,_gaa :=range _geaf ._fdda {_dgd :=len (_gaa ._ggb );if _fbc ==len (_geaf ._fdda )-1{for _bce :=len (_gaa ._ggb )-1;_bce >=0;_bce --{if !_gaa ._ggb [_bce ]._bdcb {_dgd =_bce ;};};};_bgb :=_gaa ._ggb [:_dgd ];for _ ,_gbg :=range _bgb {_geaf ._fcde .NewPage ();_geaf .drawPage (_gbg );};};};func (_cff *convertContext )getSymbolsFromR (_cfcf []*_bd .CT_RElt ,_bcae *style )[]*symbol {_bfaf :=[]*symbol {};for _ ,_bad :=range _cfcf {_egd :=_cff .combineCellStyleWithRPrElt (_bcae ,_bad .RPr );for _ ,_geg :=range _bad .T {_bfaf =append (_bfaf ,&symbol {_aebb :string (_geg ),_ggfag :_cff .makeTextStyleFromCellStyle (_egd )});};};return _bfaf ;};type anchor struct{_dffc _f .Image ;_adgae *_fg .ChartSpace ;_dbcf int ;_acbee int64 ;_fga int ;_cfca int64 ;_ggc int ;_cbce int64 ;_cbgd int ;_gce int64 ;};func (_ad *convertContext )fillPages (){for _fdf ,_cee :=range _ad ._gcdf {_dge :=_ad ._cdfa [_cee ._dgbf :_cee ._faed ];for _cdc ,_efb :=range _dge {_gdc :=0;_fffe :=0.0;_cgg :=[]*cell {};if _efb ._aefb {for _ ,_dbbd :=range _efb ._dgf {_efc :=_ad ._fdda [_gdc ];_ad ._aggfg =_efc ._ggb [_fdf ];_ad ._aggfg ._bdcb =true ;_dbbf :=_dbbd ._cec ;if _fffe +_dbbf > _efc ._ecgad {_ad .addRowToPage (_cgg ,_cdc );_cgg =[]*cell {_dbbd };_fffe =_dbbf ;_gdc ++;}else {_dbbd ._gbbd =_fffe ;_cgg =append (_cgg ,_dbbd );_fffe +=_dbbf ;};};if len (_cgg )> 0{_add :=_ad ._fdda [_gdc ];_ad ._aggfg =_add ._ggb [_fdf ];_ad ._aggfg ._bdcb =true ;_ad .addRowToPage (_cgg ,_cdc );};};};};};const (FontStyle_Regular FontStyle =0;FontStyle_Bold FontStyle =1;FontStyle_Italic FontStyle =2;FontStyle_BoldItalic FontStyle =3;);type rowspan struct{_feda float64 ;_dgbf int ;_faed int ;};func _ebg (_acc float64 )float64 {return _acc *_fd .Millimeter };func (_bafc *convertContext )distributeAnchors (){for _ ,_cdfb :=range _bafc ._fdbc {_fbbg ,_aeg :=_cdfb ._dbcf ,_cdfb ._acbee ;_acg ,_ecc :=_cdfb ._fga ,_cdfb ._cfca ;_cea ,_cbg :=_cdfb ._ggc ,_cdfb ._cbce ;_fgbf ,_eaec :=_cdfb ._cbgd ,_cdfb ._gce ;var _ged ,_eac ,_gbad ,_fgg *page ;for _ ,_bcbf :=range _bafc ._fdda {for _ ,_cbd :=range _bcbf ._ggb {if _fbbg >=_cbd ._efbg ._dgbf &&_fbbg < _cbd ._efbg ._faed {if _acg >=_cbd ._dab ._faa &&_acg < _cbd ._dab ._fbcd {_cbd ._bdcb =true ;_ged =_cbd ;};if _fgbf >=_cbd ._dab ._faa &&_fgbf < _cbd ._dab ._fbcd {_cbd ._bdcb =true ;_eac =_cbd ;};};if _cea >=_cbd ._efbg ._dgbf &&_cea < _cbd ._efbg ._faed {if _acg >=_cbd ._dab ._faa &&_acg < _cbd ._dab ._fbcd {_cbd ._bdcb =true ;_fgg =_cbd ;};if _fgbf >=_cbd ._dab ._faa &&_fgbf < _cbd ._dab ._fbcd {_cbd ._bdcb =true ;_gbad =_cbd ;};};};};_acd :=_ged !=_eac ;_eec :=_ged !=_fgg ;if _acd &&_eec {_cgd :=_bafc ._ebbf [_acg ]._cafc +_fd .FromEMU (_ecc );_fdb :=_ged ._dab ._ecgad ;_dff :=_bafc ._ebbf [_fgbf ]._cafc +_fd .FromEMU (_eaec );_egc :=_bafc ._cdfa [_fbbg ]._bceb +_fd .FromEMU (_aeg );_edd :=float64 (_ged ._efbg ._feda );_gcd :=_bafc ._cdfa [_cea ]._bceb +_fd .FromEMU (_cbg );_gg :=_dff +_fdb -_cgd ;_cab :=_gcd +_edd -_egc ;_aca :=_bafc .imageFromAnchor (_cdfb ,_gg ,_cab );_ged ._bcf =append (_ged ._bcf ,_bafc .getImage (_aca ,_cab ,_gg ,_cgd ,_egc ,_fdb -_cgd ,_edd -_egc ,_efa .ImgPart_lt ));_eac ._bcf =append (_eac ._bcf ,_bafc .getImage (_aca ,_cab ,_gg ,0,_egc ,_fdb -_cgd ,_edd -_egc ,_efa .ImgPart_rt ));_fgg ._bcf =append (_fgg ._bcf ,_bafc .getImage (_aca ,_cab ,_gg ,_cgd ,0,_fdb -_cgd ,_edd -_egc ,_efa .ImgPart_lb ));_gbad ._bcf =append (_gbad ._bcf ,_bafc .getImage (_aca ,_cab ,_gg ,0,0,_fdb -_cgd ,_edd -_egc ,_efa .ImgPart_rb ));}else if _acd {_gea :=_bafc ._cdfa [_fbbg ]._bceb +_fd .FromEMU (_aeg );_bfeg :=_bafc ._cdfa [_cea ]._bceb +_fd .FromEMU (_cbg );_bbe :=_bafc ._ebbf [_acg ]._cafc +_fd .FromEMU (_ecc );_eab :=_ged ._dab ._ecgad ;_dbd :=_bafc ._ebbf [_fgbf ]._cafc +_fd .FromEMU (_eaec );_cdcc :=_dbd +_eab -_bbe ;_bbb :=_bfeg -_gea ;_dbdg :=_bafc .imageFromAnchor (_cdfb ,_cdcc ,_bbb );_ged ._bcf =append (_ged ._bcf ,_bafc .getImage (_dbdg ,_bbb ,_cdcc ,_bbe ,_gea ,_eab -_bbe ,0,_efa .ImgPart_l ));_eac ._bcf =append (_eac ._bcf ,_bafc .getImage (_dbdg ,_bbb ,_cdcc ,0,_gea ,_eab -_bbe ,0,_efa .ImgPart_r ));}else if _eec {_bbca :=_bafc ._ebbf [_acg ]._cafc +_fd .FromEMU (_ecc );_fffee :=_bafc ._ebbf [_fgbf ]._cafc +_fd .FromEMU (_eaec );_fdde :=_bafc ._cdfa [_fbbg ]._bceb +_fd .FromEMU (_aeg );_geff :=float64 (_ged ._efbg ._feda );_ffa :=_bafc ._cdfa [_cea ]._bceb +_fd .FromEMU (_cbg );_bgdf :=_fffee -_bbca ;_cbfd :=_ffa +_geff -_fdde ;_gec :=_bafc .imageFromAnchor (_cdfb ,_bgdf ,_cbfd );_ged ._bcf =append (_ged ._bcf ,_bafc .getImage (_gec ,_cbfd ,_bgdf ,_bbca ,_fdde ,0,_geff -_fdde ,_efa .ImgPart_t ));_fgg ._bcf =append (_fgg ._bcf ,_bafc .getImage (_gec ,_cbfd ,_bgdf ,_bbca ,0,0,_geff -_fdde ,_efa .ImgPart_b ));}else {_fdbb :=_bafc ._ebbf [_acg ]._cafc +_fd .FromEMU (_ecc );_afe :=_bafc ._ebbf [_fgbf ]._cafc +_fd .FromEMU (_eaec );_bca :=_bafc ._cdfa [_fbbg ]._bceb +_fd .FromEMU (_aeg );_afa :=_bafc ._cdfa [_cea ]._bceb +_fd .FromEMU (_cbg );_gfa :=_afe -_fdbb ;_daca :=_afa -_bca ;_fea :=_bafc .imageFromAnchor (_cdfb ,_gfa ,_daca );_ged ._bcf =append (_ged ._bcf ,_bafc .getImage (_fea ,_daca ,_gfa ,_fdbb ,_bca ,0,0,_efa .ImgPart_whole ));};};};func (_bg *convertContext )makeAnchors (){_de ,_da :=_bg ._abc .GetDrawing ();if _de !=nil {for _ ,_acf :=range _de .EG_Anchor {_fgb :=&anchor {};if _eb :=_acf .TwoCellAnchor ;_eb !=nil {_cd ,_ea :=_eb .From ,_eb .To ;if _cd ==nil ||_ea ==nil {return ;};_fgb ._dbcf =int (_cd .Row );_fgb ._acbee =_efa .FromSTCoordinate (_cd .RowOff );_fgb ._fga =int (_cd .Col );_fgb ._cfca =_efa .FromSTCoordinate (_cd .ColOff );_fgb ._ggc =int (_ea .Row );_fgb ._cbce =_efa .FromSTCoordinate (_ea .RowOff );_fgb ._cbgd =int (_ea .Col );_fgb ._gce =_efa .FromSTCoordinate (_ea .ColOff );if _gbc :=_eb .Choice ;_gbc !=nil {if _eg :=_gbc .Pic ;_eg !=nil {if _aec :=_eg .BlipFill ;_aec !=nil {if _fda :=_aec .Blip ;_fda !=nil {if _fge :=_fda .EmbedAttr ;_fge !=nil {for _ ,_cc :=range _da .X ().Relationship {if _cc .IdAttr ==*_fge {for _ ,_fgc :=range _bg ._dae .Images {if _fgc .Target ()==_cc .TargetAttr {_gc ,_eba :=_ae .Open (_fgc .Path ());if _eba !=nil {_a .Log .Debug ("\u004fp\u0065\u006e\u0020\u0069m\u0061\u0067\u0065\u0020\u0066i\u006ce\u0020e\u0072\u0072\u006f\u0072\u003a\u0020\u0025s",_eba );continue ;};_bcb ,_ ,_eba :=_f .Decode (_gc );if _eba !=nil {_a .Log .Debug ("\u0044\u0065\u0063\u006fde\u0020\u0069\u006d\u0061\u0067\u0065\u0020\u0065\u0072\u0072\u006f\u0072\u003a\u0020%\u0073",_eba );continue ;};_fgb ._dffc =_bcb ;};};};};};};};}else if _fbb :=_gbc .GraphicFrame ;_fbb !=nil {if _af :=_fbb .Graphic ;_af !=nil {if _dde :=_af .GraphicData ;_dde !=nil {for _ ,_bbc :=range _dde .Any {if _ee ,_fef :=_bbc .(*_fg .Chart );_fef {for _ ,_eaa :=range _da .X ().Relationship {if _eaa .IdAttr ==_ee .IdAttr {_dcf :=_bg ._dae .GetChartByTargetId (_eaa .TargetAttr );if _dcf !=nil {_fgb ._adgae =_dcf ;};};};};};};};};};};if _fgb ._dffc !=nil ||_fgb ._adgae !=nil {_bg ._fdbc =append (_bg ._fdbc ,_fgb );};};};};func (_daff *convertContext )makePagespans (){_daff ._fdda =[]*pagespan {};_ge :=0.0;_agfd :=0;for _cdgb ,_bde :=range _daff ._ebbf {_bbgb :=_bde ._dfcc ;if _ge +_bbgb <=_daff ._ecgc {_bde ._cafc =_ge ;_ge +=_bbgb ;}else {_bde ._cafc =0;_daff ._fdda =append (_daff ._fdda ,&pagespan {_ecgad :_ge ,_faa :_agfd ,_fbcd :_cdgb });_ge =_bbgb ;_agfd =_cdgb ;};};_daff ._fdda =append (_daff ._fdda ,&pagespan {_ecgad :_ge ,_faa :_agfd ,_fbcd :len (_daff ._ebbf )});};const _aa =1.5;type convertContext struct{_fcde *_bb .Creator ;_dae *_bfe .Workbook ;_dfab *_ef .Theme ;_abc *_bfe .Sheet ;_ddf *_bfe .StyleSheet ;_abbf int ;_egaf int ;_fdda []*pagespan ;_aggfg *page ;_ebbf []*colInfo ;_cdfa []*rowInfo ;_gcdf []*rowspan ;_dec float64 ;_eaf float64 ;_acfa float64 ;_ecgc float64 ;_dfac []*mergedCell ;_fdbc []*anchor ;};type symbol struct{_aebb string ;_gfff float64 ;_aefc float64 ;_eafc float64 ;_ggfag *_bb .TextStyle ;_dbca string ;};func (_egab *convertContext )alignSymbolsVertically (_bdad *cell ,_dbc _bd .ST_VerticalAlignment ){var _dede float64 ;switch _dbc {case _bd .ST_VerticalAlignmentTop :_dede =_bc ;if _bdad ._dea {_dede -=_aa ;}else if _bdad ._aecd {_dede +=4*_aa ;};for _ ,_bge :=range _bdad ._dgfa {_dede +=_bge ._ecgf ;_bge ._gcda =_dede ;_dede +=_gd ;};case _bd .ST_VerticalAlignmentCenter :_cggg :=0.0;for _ ,_bbcb :=range _bdad ._dgfa {_cggg +=_bbcb ._ecgf +_ebg (1);};_dede =0.5*(_bdad ._gcca -_cggg );if _bdad ._dea {_dede -=2*_aa ;}else if _bdad ._aecd {_dede +=2*_aa ;};for _ ,_eece :=range _bdad ._dgfa {_dede +=_eece ._ecgf +0.5*_gd ;_eece ._gcda =_dede ;_dede +=0.5*_gd ;};default:_dede =_bdad ._gcca -_bc ;if _bdad ._dea {_dede -=4*_aa ;}else if _bdad ._aecd {_dede +=_aa ;};for _ccc :=len (_bdad ._dgfa )-1;_ccc >=0;_ccc --{_bdad ._dgfa [_ccc ]._gcda =_dede ;_dede -=_bdad ._dgfa [_ccc ]._ecgf ;_dede -=_gd ;};};};func (_dba *convertContext )imageFromAnchor (_aaf *anchor ,_afea ,_dbgeb float64 )_f .Image {if _aaf ._dffc !=nil {return _aaf ._dffc ;};if _aaf ._adgae !=nil {_bbbf ,_bae :=_efa .MakeImageFromChartSpace (_aaf ._adgae ,_afea ,_dbgeb ,_dba ._dfab );if _bae !=nil {_a .Log .Debug ("C\u0061\u006e\u006e\u006f\u0074\u0020\u006d\u0061\u006b\u0065\u0020\u0061\u006e\u0020\u0069\u006d\u0061\u0067e\u0020\u0066\u0072\u006f\u006d\u0020\u0063\u0068\u0061\u0072tS\u0070\u0061\u0063e\u003a \u0025\u0073",_bae );return nil ;};return _bbbf ;};return nil ;};func (_dfc *convertContext )makeCells (){_bee :=_dfc ._abc ;_ega :=_bee .Rows ();_agc :=0;for _ ,_fdd :=range _dfc ._cdfa {_fdd ._dgf =[]*cell {};_ffc :=0.0;_fgd :=_fdd ._feb ;if _fdd ._aefb {_dbb :=_ega [_agc ];_agc ++;_ede :=_fdd ._geaa ;for _ ,_ecb :=range _dbb .Cells (){_bed ,_cag :=_bdc .ParseCellReference (_ecb .Reference ());if _cag !=nil {_a .Log .Debug ("\u0043\u0061\u006e\u006eo\u0074\u0020\u0070\u0061\u0072\u0073\u0065\u0020\u0061\u0020r\u0065f\u0065\u0072\u0065\u006e\u0063\u0065\u003a \u0025\u0073",_cag );continue ;};_dfd :=_dfc ._ebbf [_bed .ColumnIdx ];_gag :=_dfd ._dfcc ;_aeb :=_gag ;_gfb :=_dfd ._aacc ;var _ded ,_baf ,_cdbb ,_egf bool ;for _ ,_ebb :=range _dfc ._dfac {if _bed .RowIdx >=_ebb ._beg &&_bed .RowIdx <=_ebb ._deb &&_bed .ColumnIdx >=_ebb ._ecfa &&_bed .ColumnIdx <=_ebb ._bcfc {if _bed .ColumnIdx ==_ebb ._ecfa &&_bed .RowIdx ==_ebb ._beg {_gag =_ebb ._gbbc ;_ede =_ebb ._cfg ;};_ded =_bed .RowIdx !=_ebb ._beg ;_baf =_bed .RowIdx !=_ebb ._deb ;_cdbb =_bed .ColumnIdx !=_ebb ._ecfa ;_egf =_bed .ColumnIdx !=_ebb ._bcfc ;};};_daf :=_dfc .getStyleFromCell (_ecb ,_fgd ,_gfb );var _efgd ,_dg ,_edef bool ;var _gda ,_fbae ,_deg ,_edab *border ;var _eeb _bd .ST_VerticalAlignment ;var _gfg _bd .ST_HorizontalAlignment ;if _daf !=nil {if !_ded {_gda =_daf ._fegf ;};if !_baf {_fbae =_daf ._fcce ;};if !_cdbb {_deg =_daf ._gae ;};if !_egf {_edab =_daf ._eabe ;};if _fbae !=nil &&_fbae ._cda > _ffc {_ffc =_fbae ._cda ;};_eeb =_daf ._bfba ;_gfg =_daf ._gecg ;if _daf ._cgbf !=nil {_efgd =*_daf ._cgbf ;};if _daf ._gbaa !=nil {_dg =*_daf ._gbaa ;};_edef =_daf ._dcgb ;};_gfc ,_ab :=_dfc .getContentFromCell (_ecb ,_daf ,_gag ,_edef );_fce :=&cell {_gccf :_ab ,_cdgf :_gag ,_cec :_aeb ,_gcca :_ede ,_dgfa :_gfc ,_agd :_gda ,_ffad :_fbae ,_ddea :_deg ,_dca :_edab ,_dea :_efgd ,_aecd :_dg };_dfc .alignSymbolsHorizontally (_fce ,_gfg );_dfc .alignSymbolsVertically (_fce ,_eeb );_fdd ._dgf =append (_fdd ._dgf ,_fce );};};_fdd ._eeceg =_ffc ;};};func (_gfda *convertContext )getStyleFromCell (_cbcf _bfe .Cell ,_ffcc ,_bea *style )*style {_cede :=_cbcf .X ();_cgbe :=_gfda .getStyle (_cede .SAttr );_bbfb (_cgbe ,_ffcc );_bbfb (_cgbe ,_bea );return _cgbe ;};type colInfo struct{_cafc float64 ;_dfcc float64 ;_aacc *style ;};

// RegisterFontsFromDirectory registers all fonts from the given directory automatically detecting font families and styles.
func RegisterFontsFromDirectory (dirName string )error {return _efa .RegisterFontsFromDirectory (dirName );};func (_aggf *convertContext )getContentFromCell (_gad _bfe .Cell ,_ddb *style ,_cfa float64 ,_cgdd bool )([]*line ,_bd .ST_CellType ){_bcg :=_gad .X ();var _gaaf []*symbol ;switch _bcg .TAttr {case _bd .ST_CellTypeS :_fdc :=_bcg .V ;if _fdc !=nil {_cce ,_fdcf :=_b .Atoi (*_fdc );if _fdcf ==nil {_ddbg :=_aggf ._dae .SharedStrings .X ().Si [_cce ];if _ddbg .T !=nil {_gaaf =_aggf .getSymbolsFromString (*_ddbg .T ,_ddb );}else if _ddbg .R !=nil {_gaaf =_aggf .getSymbolsFromR (_ddbg .R ,_ddb );};};};case _bd .ST_CellTypeB :_gbb :=_bcg .V ;if _gbb !=nil {if *_gbb =="\u0030"{_gaaf =_aggf .getSymbolsFromString ("\u0046\u0041\u004cS\u0045",_ddb );}else {_gaaf =_aggf .getSymbolsFromString ("\u0054\u0052\u0055\u0045",_ddb );};};default:_gaaf =_aggf .getSymbolsFromString (_gad .GetFormattedValue (),_ddb );};_edg :=0.0;_adga :=0.0;var _ebd []*line ;var _fdg bool ;if _ddb !=nil {if _ddb ._cgbf !=nil {if *_ddb ._cgbf {_fdg =true ;};};if _ddb ._gbaa !=nil {if *_ddb ._gbaa {_fdg =true ;};};};if _cgdd {_ebd =[]*line {};_eaad :=_cfa -2*_ed ;_ggf :=[]*symbol {};for _ ,_cdd :=range _gaaf {_cage (_cdd );if _edg +_cdd ._eafc >=_eaad {_beda :=_adc (_ggf );if _fdg {_beda /=_dc ;};_ebd =append (_ebd ,&line {_gcda :_adga ,_cgbd :_ggf ,_ecgf :_beda });_ggf =[]*symbol {_cdd };_edg =_cdd ._eafc ;_adga +=_beda ;}else {_cdd ._gfff =_edg ;_edg +=_cdd ._eafc ;_ggf =append (_ggf ,_cdd );};};_ceb :=_adc (_ggf );if _fdg {_ceb /=_dc ;};if len (_ggf )> 0{_ebd =append (_ebd ,&line {_gcda :_adga ,_cgbd :_ggf ,_ecgf :_ceb });};}else {for _ ,_gff :=range _gaaf {_cage (_gff );_gff ._gfff =_edg ;_edg +=_gff ._eafc ;};if len (_gaaf )> 0{_ebd =[]*line {&line {_cgbd :_gaaf ,_ecgf :_adc (_gaaf )}};};};_gbf :=_bcg .TAttr ;if _gbf ==_bd .ST_CellTypeUnset {_gbf =_bd .ST_CellTypeN ;};return _ebd ,_gbf ;};type line struct{_gcda float64 ;_cgbd []*symbol ;_ecgf float64 ;};func (_bfb *convertContext )makeRows (){_bgd :=[]*rowInfo {};_aeee :=_bfb ._abc .Rows ();_ff :=0;for _ ,_fed :=range _aeee {_ff ++;_cbf :=int (_fed .RowNumber ());if _cbf > _ff {for _afg :=_ff ;_afg < _cbf ;_afg ++{_bgd =append (_bgd ,&rowInfo {_geaa :16/_g });};_ff =_cbf ;};var _eda float64 ;if _fed .X ().HtAttr ==nil {_eda =16;}else {_eda =*_fed .X ().HtAttr ;};_bgd =append (_bgd ,&rowInfo {_geaa :_eda /_g ,_aefb :true ,_feb :_bfb .getStyle (_fed .X ().SAttr )});};for _gac :=len (_bgd );_gac < _bfb ._abbf ;_gac ++{_bgd =append (_bgd ,&rowInfo {_geaa :16/_g });};_bfb ._cdfa =_bgd ;};func (_baaf *convertContext )getColorStringFromSmlColor (_dgea *_bd .CT_Color )*string {var _adf string ;if _dgea .RgbAttr !=nil {_adf =*_dgea .RgbAttr ;}else if _dgea .IndexedAttr !=nil &&*_dgea .IndexedAttr < 64{_adf =_deea [*_dgea .IndexedAttr ];}else if _dgea .ThemeAttr !=nil {_aag :=*_dgea .ThemeAttr ;_adf =_baaf .getColorFromTheme (_aag );};if _adf ==""{return nil ;};if len (_adf )> 6{_adf =_adf [(len (_adf )-6):];};if _dgea .TintAttr !=nil {_fbgc :=*_dgea .TintAttr ;_adf =_efa .AdjustColorByTint (_adf ,_fbgc );};_adf ="\u0023"+_adf ;return &_adf ;};func (_bgdfg *convertContext )makeTextStyleFromCellStyle (_cagf *style )*_bb .TextStyle {_edfa :=_bgdfg ._fcde .NewTextStyle ();if _cagf ==nil {_edfa .FontSize =_efa .DefaultFontSize ;_edfa .Font =_efa .AssignStdFontByName (_edfa ,_efa .StdFontsMap ["\u0064e\u0066\u0061\u0075\u006c\u0074"][FontStyle_Regular ]);return &_edfa ;};if _bga (_cagf ._abd ){_edfa .Underline =true ;_edfa .UnderlineStyle =_bb .TextDecorationLineStyle {Offset :0.5,Thickness :_ebg (1/32)};};var _ebdg FontStyle ;if _bga (_cagf ._faee )&&_bga (_cagf ._bfbd ){_ebdg =FontStyle_BoldItalic ;}else if _bga (_cagf ._faee ){_ebdg =FontStyle_Bold ;}else if _bga (_cagf ._bfbd ){_ebdg =FontStyle_Italic ;}else {_ebdg =FontStyle_Regular ;};_cca :="\u0064e\u0066\u0061\u0075\u006c\u0074";if _cagf ._acde !=nil {_cca =*_cagf ._acde ;};if _gadd ,_gdb :=_efa .StdFontsMap [_cca ];_gdb {_edfa .Font =_efa .AssignStdFontByName (_edfa ,_gadd [_ebdg ]);}else if _cfad :=_efa .GetRegisteredFont (_cca ,_ebdg );_cfad !=nil {_edfa .Font =_cfad ;}else {_a .Log .Debug ("\u0046\u006f\u006e\u0074\u0020\u0025\u0073\u0020\u0077\u0069\u0074h\u0020\u0073\u0074\u0079\u006c\u0065\u0020\u0025s\u0020i\u0073\u0020\u006e\u006f\u0074\u0020\u0066\u006f\u0075\u006e\u0064\u002c\u0020\u0072\u0065\u0073\u0065\u0074 \u0074\u006f\u0020\u0064\u0065\u0066\u0061\u0075\u006c\u0074\u002e",_cca ,_ebdg );_edfa .Font =_efa .AssignStdFontByName (_edfa ,_efa .StdFontsMap ["\u0064e\u0066\u0061\u0075\u006c\u0074"][_ebdg ]);};if _cagf ._eea !=nil {_edfa .FontSize =*_cagf ._eea ;};if _cagf ._bggb !=nil {_edfa .Color =_bb .ColorRGBFromHex (*_cagf ._bggb );};if _cagf ._cgbf !=nil &&*_cagf ._cgbf {_edfa .FontSize *=_dc ;}else if _cagf ._gbaa !=nil &&*_cagf ._gbaa {_edfa .FontSize *=_dc ;};return &_edfa ;};var _deea =[]string {"\u0030\u0030\u0030\u0030\u0030\u0030","\u0066\u0066\u0066\u0066\u0066\u0066","\u0066\u0066\u0030\u0030\u0030\u0030","\u0030\u0030\u0066\u0066\u0030\u0030","\u0030\u0030\u0030\u0030\u0066\u0066","\u0066\u0066\u0066\u0066\u0030\u0030","\u0066\u0066\u0030\u0030\u0066\u0066","\u0030\u0030\u0066\u0066\u0066\u0066","\u0030\u0030\u0030\u0030\u0030\u0030","\u0066\u0066\u0066\u0066\u0066\u0066","\u0066\u0066\u0030\u0030\u0030\u0030","\u0030\u0030\u0066\u0066\u0030\u0030","\u0030\u0030\u0030\u0030\u0066\u0066","\u0066\u0066\u0066\u0066\u0030\u0030","\u0066\u0066\u0030\u0030\u0066\u0066","\u0030\u0030\u0066\u0066\u0066\u0066","\u0038\u0030\u0030\u0030\u0030\u0030","\u0030\u0030\u0038\u0030\u0030\u0030","\u0030\u0030\u0030\u0030\u0038\u0030","\u0038\u0030\u0038\u0030\u0030\u0030","\u0038\u0030\u0030\u0030\u0038\u0030","\u0030\u0030\u0038\u0030\u0038\u0030","\u0063\u0030\u0063\u0030\u0063\u0030","\u0038\u0030\u0038\u0030\u0038\u0030","\u0039\u0039\u0039\u0039\u0066\u0066","\u0039\u0039\u0033\u0033\u0036\u0036","\u0066\u0066\u0066\u0066\u0063\u0063","\u0063\u0063\u0066\u0066\u0066\u0066","\u0036\u0036\u0030\u0030\u0036\u0036","\u0066\u0066\u0038\u0030\u0038\u0030","\u0030\u0030\u0036\u0036\u0063\u0063","\u0063\u0063\u0063\u0063\u0066\u0066","\u0030\u0030\u0030\u0030\u0038\u0030","\u0066\u0066\u0030\u0030\u0066\u0066","\u0066\u0066\u0066\u0066\u0030\u0030","\u0030\u0030\u0066\u0066\u0066\u0066","\u0038\u0030\u0030\u0030\u0038\u0030","\u0038\u0030\u0030\u0030\u0030\u0030","\u0030\u0030\u0038\u0030\u0038\u0030","\u0030\u0030\u0030\u0030\u0066\u0066","\u0030\u0030\u0063\u0063\u0066\u0066","\u0063\u0063\u0066\u0066\u0066\u0066","\u0063\u0063\u0066\u0066\u0063\u0063","\u0066\u0066\u0066\u0066\u0039\u0039","\u0039\u0039\u0063\u0063\u0066\u0066","\u0066\u0066\u0039\u0039\u0063\u0063","\u0063\u0063\u0039\u0039\u0066\u0066","\u0066\u0066\u0063\u0063\u0039\u0039","\u0033\u0033\u0036\u0036\u0066\u0066","\u0033\u0033\u0063\u0063\u0063\u0063","\u0039\u0039\u0063\u0063\u0030\u0030","\u0066\u0066\u0063\u0063\u0030\u0030","\u0066\u0066\u0039\u0039\u0030\u0030","\u0066\u0066\u0036\u0036\u0030\u0030","\u0036\u0036\u0036\u0036\u0039\u0039","\u0039\u0036\u0039\u0036\u0039\u0036","\u0030\u0030\u0033\u0033\u0036\u0036","\u0033\u0033\u0039\u0039\u0036\u0036","\u0030\u0030\u0033\u0033\u0030\u0030","\u0033\u0033\u0033\u0033\u0030\u0030","\u0039\u0039\u0033\u0033\u0030\u0030","\u0039\u0039\u0033\u0033\u0036\u0036","\u0033\u0033\u0033\u0033\u0039\u0039","\u0033\u0033\u0033\u0033\u0033\u0033"};var _g =3.025/_ebg (1);func _dgc (_afee []*symbol )float64 {_gcc :=0.0;for _ ,_dbge :=range _afee {_gcc +=_dbge ._eafc ;};return _gcc ;};func (_cdcce *convertContext )getStyleFromRPrElt (_aeag *_bd .CT_RPrElt )*style {if _aeag ==nil {return nil ;};_cfaf :=&style {};_cfaf ._acde =&_aeag .RFont .ValAttr ;if _gbdg :=_aeag .B ;_gbdg !=nil {_gadc :=_gbdg .ValAttr ==nil ||*_gbdg .ValAttr ;_cfaf ._faee =&_gadc ;};if _fbbd :=_aeag .I ;_fbbd !=nil {_fgab :=_fbbd .ValAttr ==nil ||*_fbbd .ValAttr ;_cfaf ._bfbd =&_fgab ;};if _aad :=_aeag .U ;_aad !=nil {_gegf :=_aad .ValAttr ==_bd .ST_UnderlineValuesSingle ||_aad .ValAttr ==_bd .ST_UnderlineValuesUnset ;_cfaf ._abd =&_gegf ;};if _abdc :=_aeag .VertAlign ;_abdc !=nil {_bbga :=_abdc .ValAttr ==_bf .ST_VerticalAlignRunSuperscript ;_cfaf ._cgbf =&_bbga ;_abbd :=_abdc .ValAttr ==_bf .ST_VerticalAlignRunSubscript ;_cfaf ._gbaa =&_abbd ;};if _eed :=_aeag .Sz ;_eed !=nil {_bgbd :=_eed .ValAttr /12*_efa .DefaultFontSize ;_cfaf ._eea =&_bgbd ;};if _aeff :=_aeag .Color ;_aeff !=nil {_cfaf ._bggb =_cdcce .getColorStringFromSmlColor (_aeff );};return _cfaf ;};func (_ege *convertContext )makeMergedCells (){_db :=[]*mergedCell {};for _ ,_dac :=range _ege ._abc .MergedCells (){_dbe ,_fbeb ,_ffd :=_bdc .ParseRangeReference (_dac .Reference ());if _ffd !=nil {_a .Log .Debug ("\u0065\u0072r\u006f\u0072\u0020\u0070\u0061\u0072\u0073\u0069\u006e\u0067\u0020\u006d\u0065\u0072\u0067\u0065\u0064\u0020\u0063\u0065\u006c\u006c: \u0025\u0073",_ffd );continue ;};_cg :=mergedCell {_beg :_dbe .RowIdx ,_ecfa :_dbe .ColumnIdx ,_deb :_fbeb .RowIdx ,_bcfc :_fbeb .ColumnIdx };for _ce :=_cg ._ecfa -1;_ce < _cg ._bcfc ;_ce ++{_cg ._gbbc +=_ege ._ebbf [_ce ]._dfcc ;};for _cdg :=_cg ._beg -1;_cdg < _cg ._deb ;_cdg ++{_cg ._cfg +=_ege ._cdfa [_cdg ]._geaa ;};_db =append (_db ,&_cg );};_ege ._dfac =_db ;};func (_edgg *convertContext )getSymbolsFromString (_cgb string ,_cdfg *style )[]*symbol {_bfa :=[]*symbol {};_bab :=_edgg .makeTextStyleFromCellStyle (_cdfg );for _ ,_eca :=range _cgb {_bfa =append (_bfa ,&symbol {_aebb :string (_eca ),_ggfag :_bab });};return _bfa ;};func _bga (_afgd *bool )bool {return _afgd !=nil &&*_afgd };type mergedCell struct{_beg uint32 ;_ecfa uint32 ;_deb uint32 ;_bcfc uint32 ;_gbbc float64 ;_cfg float64 ;};

// ConvertToPdf converts a sheet to a PDF file. This package is beta, breaking changes can take place.
func ConvertToPdf (s *_bfe .Sheet )*_bb .Creator {_ba :=s .X ();if _ba ==nil {return nil ;};var _gf _bb .PageSize ;var _ac bool ;if _df :=_ba .PageSetup ;_df !=nil {if _baa :=_df .PaperSizeAttr ;_baa !=nil {_gf =_daea [*_baa ];};_ac =_df .OrientationAttr ==_bd .ST_OrientationLandscape ;};if (_gf ==_bb .PageSize {}){_gf =_daea [1];};if _ac {_gf [0],_gf [1]=_gf [1],_gf [0];};_bcc :=_bb .New ();_bcc .SetPageSize (_gf );var _efg ,_bcd ,_ag ,_fe float64 ;if _bbg :=_ba .PageMargins ;_bbg !=nil {_ag =_bbg .LeftAttr ;_fe =_bbg .RightAttr ;_efg =_bbg .TopAttr ;_bcd =_bbg .BottomAttr ;};if _ag < 0.25{_ag =0.25;};if _fe < 0.25{_fe =0.25;};_efg *=_fd .Inch ;_bcd *=_fd .Inch ;_ag *=_fd .Inch ;_fe *=_fd .Inch ;_bcc .SetPageMargins (_ag ,_fe ,_efg ,_bcd );_c :=s .Workbook ();var _agf *_ef .Theme ;if len (_c .Themes ())> 0{_agf =_c .Themes ()[0];};_ec :=&convertContext {_fcde :_bcc ,_abc :s ,_dae :s .Workbook (),_dfab :_agf ,_ddf :&s .Workbook ().StyleSheet ,_dec :_efg ,_eaf :_ag ,_acfa :_gf [1]-_bcd -_efg ,_ecgc :_gf [0]-_fe -_ag };_ec .makeAnchors ();_ec .determineMaxIndexes ();if _ec ._abbf ==0&&_ec ._egaf ==0{_bcc .NewPage ();return _bcc ;};_ec .makeCols ();_ec .makeRows ();_ec .makeMergedCells ();_ec .makeCells ();_ec .makePagespans ();_ec .makeRowspans ();_ec .makePages ();_ec .fillPages ();_ec .distributeAnchors ();_ec .drawSheet ();return _bcc ;};type pageRow struct{_dfb int ;_gbd []*cell ;};

// FontStyle represents a kind of font styling. It can be FontStyle_Regular, FontStyle_Bold, FontStyle_Italic and FontStyle_BoldItalic.
type FontStyle =_efa .FontStyle ;type style struct{_bggb *string ;_eea *float64 ;_acde *string ;_faee *bool ;_bfbd *bool ;_abd *bool ;_cgbf *bool ;_gbaa *bool ;_fegf *border ;_fcce *border ;_gae *border ;_eabe *border ;_dcgb bool ;_bfba _bd .ST_VerticalAlignment ;_gecg _bd .ST_HorizontalAlignment ;};type border struct{_cda float64 ;_bgeg _bb .Color ;};func _bbfb (_caa ,_cafd *style ){if _cafd ==nil {return ;};if _caa ==nil {_caa =_cafd ;return ;};if _caa ._acde ==nil {_caa ._acde =_cafd ._acde ;};if _caa ._bggb ==nil {_caa ._bggb =_cafd ._bggb ;};if _caa ._eea ==nil {_caa ._eea =_cafd ._eea ;};if _caa ._faee ==nil {_caa ._faee =_cafd ._faee ;};if _caa ._bfbd ==nil {_caa ._bfbd =_cafd ._bfbd ;};if _caa ._abd ==nil {_caa ._abd =_cafd ._abd ;};if _caa ._cgbf ==nil {_caa ._cgbf =_cafd ._cgbf ;};if _caa ._gbaa ==nil {_caa ._gbaa =_cafd ._gbaa ;};if _caa ._fegf ==nil {_caa ._fegf =_cafd ._fegf ;};if _caa ._fcce ==nil {_caa ._fcce =_cafd ._fcce ;};if _caa ._gae ==nil {_caa ._gae =_cafd ._gae ;};if _caa ._eabe ==nil {_caa ._eabe =_cafd ._eabe ;};if _caa ._bfba ==_bd .ST_VerticalAlignmentUnset {_caa ._bfba =_cafd ._bfba ;};if _caa ._gecg ==_bd .ST_HorizontalAlignmentUnset {_caa ._gecg =_cafd ._gecg ;};};var _daea =map[uint32 ]_bb .PageSize {1:_bb .PageSize {8.5*_fd .Inch ,11*_fd .Inch },2:_bb .PageSize {8.5*_fd .Inch ,11*_fd .Inch },3:_bb .PageSize {11*_fd .Inch ,17*_fd .Inch },4:_bb .PageSize {17*_fd .Inch ,11*_fd .Inch },5:_bb .PageSize {8.5*_fd .Inch ,14*_fd .Inch },6:_bb .PageSize {5.5*_fd .Inch ,8.5*_fd .Inch },7:_bb .PageSize {7.5*_fd .Inch ,10*_fd .Inch },8:_bb .PageSize {_ebg (297),_ebg (420)},9:_bb .PageSize {_ebg (210),_ebg (297)},10:_bb .PageSize {_ebg (210),_ebg (297)},11:_bb .PageSize {_ebg (148),_ebg (210)},70:_bb .PageSize {_ebg (105),_ebg (148)},12:_bb .PageSize {_ebg (250),_ebg (354)},13:_bb .PageSize {_ebg (182),_ebg (257)},14:_bb .PageSize {8.5*_fd .Inch ,13*_fd .Inch },20:_bb .PageSize {4.125*_fd .Inch ,9.5*_fd .Inch },27:_bb .PageSize {_ebg (110),_ebg (220)},28:_bb .PageSize {_ebg (162),_ebg (229)},34:_bb .PageSize {_ebg (250),_ebg (176)},29:_bb .PageSize {_ebg (324),_ebg (458)},30:_bb .PageSize {_ebg (229),_ebg (324)},31:_bb .PageSize {_ebg (114),_ebg (162)},37:_bb .PageSize {3.88*_fd .Inch ,7.5*_fd .Inch },43:_bb .PageSize {_ebg (100),_ebg (148)},69:_bb .PageSize {_ebg (200),_ebg (148)}};func _adc (_ddg []*symbol )float64 {_cfc :=0.0;for _ ,_fcdd :=range _ddg {if _fcdd ._aefc > _cfc {_cfc =_fcdd ._aefc ;};};return _cfc ;};func (_fag *convertContext )addRowToPage (_daffb []*cell ,_acgf int ){_caf :=0.0;_eccc :=_fag ._ecgc ;for _ ,_abb :=range _daffb {if len (_abb ._dgfa )!=0{_abb ._ggfa =_caf ;_caf =_abb ._gbbd +_abb ._cdgf ;};};for _fabe :=len (_daffb )-1;_fabe >=0;_fabe --{_agca :=_daffb [_fabe ];if len (_agca ._dgfa )!=0{_agca ._fgf =_eccc ;_eccc =_agca ._gbbd ;};};_fag ._aggfg ._bdg =append (_fag ._aggfg ._bdg ,&pageRow {_dfb :_acgf ,_gbd :_daffb });};func (_fbd *convertContext )drawPage (_egg *page ){_ccd :=_fbd ._dec ;_bdf :=_fbd ._eaf ;for _ ,_agg :=range _egg ._bdg {_aef :=_fbd ._cdfa [_agg ._dfb ];for _ ,_bgc :=range _agg ._gbd {_ecf :=_bgc ._ggfa < _bgc ._gbbd ;_bda :=_bgc ._fgf > _bgc ._gbbd +_bgc ._cdgf ;var _dce ,_cbb bool ;for _ ,_fee :=range _bgc ._dgfa {for _ ,_fcf :=range _fee ._cgbd {if _ecf &&!_dce {_dce =_fcf ._gfff < 0;};if _bda &&!_cbb {_cbb =_bgc ._cdgf < _fcf ._gfff +_fcf ._eafc ;};if _bgc ._gbbd +_fcf ._gfff >=_bgc ._ggfa &&_bgc ._gbbd +_fcf ._gfff +_fcf ._eafc <=_bgc ._fgf {_fcd :=_fbd ._fcde .NewStyledParagraph ();_fcc :=_bdf +_bgc ._gbbd +_fcf ._gfff ;_aega :=_ccd +_aef ._bceb +_fee ._gcda -_fcf ._aefc -_ebg (0.5);_fcd .SetPos (_fcc ,_aega );var _adg *_bb .TextChunk ;if _fcf ._dbca !=""{_adg =_fcd .AddExternalLink (_fcf ._aebb ,_fcf ._dbca );}else {_adg =_fcd .Append (_fcf ._aebb );};if _fcf ._ggfag !=nil {_adg .Style =*_fcf ._ggfag ;};_fbd ._fcde .Draw (_fcd );};};};var _beba ,_bbgc ,_gdcf ,_dfce ,_ecg ,_ecga float64 ;var _dfdf ,_fccc ,_feec ,_aacb _bb .Color ;if _eef :=_bgc ._agd ;_eef !=nil {_beba =_eef ._cda ;_dfdf =_eef ._bgeg ;};if _fec :=_bgc ._ffad ;_fec !=nil {_bbgc =_fec ._cda ;_fccc =_fec ._bgeg ;};if _ebbg :=_bgc ._ddea ;_ebbg !=nil {_gdcf =_ebbg ._cda ;_ecg =_gdcf /2;_feec =_ebbg ._bgeg ;};if _fab :=_bgc ._dca ;_fab !=nil {_dfce =_fab ._cda ;_ecga =_dfce /2;_aacb =_fab ._bgeg ;};var _fbg float64 ;if _agg ._dfb > 1{_fbg =_fbd ._cdfa [_agg ._dfb -1]._eeceg ;};_ced :=_ccd +_aef ._bceb -0.5*(_fbg -_beba );_bag :=_ccd +_aef ._bceb +_aef ._geaa +0.5*(_aef ._eeceg +_bbgc );_ead :=_bdf +_bgc ._gbbd ;_cbc :=_ead +_bgc ._cec ;_efa .DrawLine (_fbd ._fcde ,_ead ,_ced ,_cbc ,_ced ,_beba ,_dfdf );_efa .DrawLine (_fbd ._fcde ,_ead ,_bag ,_cbc ,_bag ,_bbgc ,_fccc );if !_dce {_efa .DrawLine (_fbd ._fcde ,_ead -_ecg ,_ced ,_ead -_ecg ,_bag ,_gdcf ,_feec );};if !_cbb {_efa .DrawLine (_fbd ._fcde ,_cbc -_ecga ,_ced ,_cbc -_ecga ,_bag ,_dfce ,_aacb );};};};for _ ,_bbf :=range _egg ._bcf {if _bbf !=nil {_fbd ._fcde .Draw (_bbf );};};};func (_bdd *convertContext )alignSymbolsHorizontally (_fac *cell ,_dee _bd .ST_HorizontalAlignment ){if _dee ==_bd .ST_HorizontalAlignmentUnset {switch _fac ._gccf {case _bd .ST_CellTypeB :_dee =_bd .ST_HorizontalAlignmentCenter ;case _bd .ST_CellTypeN :_dee =_bd .ST_HorizontalAlignmentRight ;default:_dee =_bd .ST_HorizontalAlignmentLeft ;};};var _aeec float64 ;for _ ,_ecbf :=range _fac ._dgfa {switch _dee {case _bd .ST_HorizontalAlignmentLeft :_aeec =_ed ;case _bd .ST_HorizontalAlignmentRight :_dad :=_dgc (_ecbf ._cgbd );_aeec =_fac ._cdgf -_ed -_dad ;case _bd .ST_HorizontalAlignmentCenter :_afaf :=_dgc (_ecbf ._cgbd );_aeec =(_fac ._cdgf -_afaf )/2;};for _ ,_dfdc :=range _ecbf ._cgbd {_dfdc ._gfff +=_aeec ;};};};func (_gcb *convertContext )getImage (_dgdb _f .Image ,_ccb ,_gee ,_dgcb ,_ffb ,_gfgca ,_cdfd float64 ,_eccf _efa .ImgPart )*_bb .Image {_ffb +=_gcb ._dec ;_dgcb +=_gcb ._eaf ;_dgb ,_acbe :=_efa .GetImage (_gcb ._fcde ,_dgdb ,_ccb ,_gee ,_dgcb ,_ffb ,_gfgca ,_cdfd ,_eccf );if _acbe !=nil {_a .Log .Debug ("\u0043\u0061\u006eno\u0074\u0020\u0067\u0065\u0074\u0020\u0061\u006e\u0020\u0069\u006d\u0061\u0067\u0065\u003a\u0020\u0025\u0073",_acbe );return nil ;};return _dgb ;};