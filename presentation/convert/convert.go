//
// Copyright 2020 FoxyUtils ehf. All rights reserved.
//
// This is a commercial product and requires a license to operate.
// A trial license can be obtained at https://unidoc.io
//
// DO NOT EDIT: generated by unitwist Go source code obfuscator.
//
// Use of this source code is governed by the UniDoc End User License Agreement
// terms that can be accessed at https://unidoc.io/eula/

package convert ;import (_fd "bytes";_f "errors";_ba "github.com/unidoc/unioffice/common/logger";_fdf "github.com/unidoc/unioffice/common/tempstorage";_fg "github.com/unidoc/unioffice/internal/convertutils";_d "github.com/unidoc/unioffice/measurement";_ce "github.com/unidoc/unioffice/presentation";_cd "github.com/unidoc/unioffice/schema/soo/dml";_ga "github.com/unidoc/unioffice/schema/soo/dml/chart";_e "github.com/unidoc/unioffice/schema/soo/pml";_bd "github.com/unidoc/unipdf/v3/contentstream/draw";_gg "github.com/unidoc/unipdf/v3/creator";_bb "github.com/unidoc/unipdf/v3/model";_ceb "github.com/unidoc/unipdf/v3/render";_b "image";_cb "image/color";_a "image/draw";_cbc "strconv";_g "strings";);func (_dfd *convertContext )makePdfDivisionFromTxBody (_fad *_cd .CT_TextBody ,_bfge ,_eeg float64 ,_eff *_cd .CT_TableStyleTextStyle )*_gg .Division {_gae :=_dfd ._eceg .NewDivision ();_fgad :=_dfd ._bcgc ;_efgc :=_cd .ST_TextAnchoringTypeT ;if _ddcg :=_fad .BodyPr ;_ddcg !=nil {if _aedf :=_ddcg .AnchorAttr ;_aedf !=_cd .ST_TextAnchoringTypeUnset {_efgc =_ddcg .AnchorAttr ;};};if _cfdf :=_fad .LstStyle ;_cfdf !=nil {var _aad *_cd .CT_TextParagraphProperties ;if _cfdf .Lvl1pPr !=nil {_aad =_cfdf .Lvl1pPr ;}else {_aad =_dfd ._efcc [0];};_fgad =_eecc (_aad ,_eecc (_cfdf .DefPPr ,_fgad ));};for _ ,_beg :=range _fad .P {if _beg !=nil {_bcd :=_dfd ._eceg .NewStyledParagraph ();_gdg :=_eecc (_beg .PPr ,_fgad );_dedg :=_bfgc (_beg .EndParaRPr ,_gdg .DefRPr );if len (_beg .EG_TextRun )==0{_bcd .Append ("\u000a");_gae .Add (_bcd );continue ;};for _ ,_fead :=range _beg .EG_TextRun {if _aff :=_fead .Br ;_aff !=nil {_bcd .Append ("\u000a");}else if _gfff :=_fead .R ;_gfff !=nil {_gcd :=_ddfe (_gfff .RPr ,_eff );_gcd =_bfgc (_gcd ,_dedg );var _bdf _gg .Color ;if _gcd .SolidFill !=nil {_bdf ,_ =_dfd .getColorFromSolidFill (_gcd .SolidFill );}else {_bdf =_gg .ColorBlack ;};_agd ,_daf ,_aeg ,_ :=_dfd .makeStyleFromRPr (_gcd );_agd .Color =_bdf ;if _daf {_agd .TextRise =0.5;}else if _aeg {_agd .TextRise =-0.5;};_cgdd :=_gfff .T ;if _gcd .CapAttr ==_cd .ST_TextCapsTypeAll {for _ ,_ffef :=range _cgdd {_ffef =[]rune (_g .ToUpper (string (_ffef )))[0];};};_aaaf :=_bcd .Append (_cgdd );_aaaf .Style =*_agd ;};};_ =_efgc ;_gae .Add (_bcd );};};return _gae ;};func (_dcaa *convertContext )getBorderStyle (_cgabb *_cd .CT_LineProperties )(_gg .CellBorderStyle ,*_gg .Color ,float64 ){if _cgabb ==nil ||_cgabb .NoFill !=nil {return _gg .CellBorderStyleNone ,nil ,0;};var _ggc _gg .Color ;if _fbeb :=_cgabb .SolidFill ;_fbeb !=nil {_ggc ,_ =_dcaa .getColorFromSolidFill (_fbeb );};_bbba :=0.0;if _dad :=_cgabb .WAttr ;_dad !=nil {_bbba =_d .FromEMU (int64 (*_dad ));};return _gg .CellBorderStyleSingle ,&_ggc ,_bbba ;};type background struct{_gagc _gg .Color ;_gfdf float64 ;_aefc *_cd .CT_BlipFillProperties ;};func (_bdc *convertContext )getPhData (_dcfbc *_e .CT_Shape )(*_cd .CT_Transform2D ,*_cd .CT_TextBodyProperties ,*_cd .CT_TextListStyle ,bool ,bool ){_dag ,_ggfeb :=_bce (_dcfbc );_afed :=_ggfeb ==nil ;_cfac ,_dgge ,_decf ,_cbd :=_fbgc (_bdc ._gbfe .CSld ,_dag ,_ggfeb ,_afed );_ceec ,_cgabbf ,_cabca ,_aadb :=_fbgc (_bdc ._gdad .CSld ,_dag ,_ggfeb ,_afed );if _ceec ==nil {_ceec =_cfac ;};_cfda ,_gadf :=_gbeb (_cgabbf ,_dgge );var _bfga ,_fed bool ;if _cabca ==nil {if _decf !=nil {_bfga =*_decf ;};}else {_bfga =*_cabca ;};if _aadb ==nil {if _cbd !=nil {_fed =*_cbd ;};}else {_fed =*_aadb ;};return _ceec ,_cfda ,_gadf ,_bfga ,_fed ;};func _dafff (_ccfc int ,_bfec bool )string {_adef :=_fd .NewBuffer ([]byte {});for _ ,_eefc :=range _ecae {for {if _ccfc < _eefc ._ebae {break ;};_adef .WriteString (_eefc ._agcd );_ccfc -=_eefc ._ebae ;};};_cff :=_adef .String ();if _bfec {_cff =_g .ToUpper (_cff );};return _cff ;};type symbolStyle struct{_befbc *string ;_bbgf *float64 ;_gfgd *string ;_edeb *bool ;_efag *bool ;_bbda *bool ;_gfac *bool ;_ebddc *bool ;};type textboxContext struct{_deeg *convertContext ;_gffg float64 ;_fdca float64 ;_gafa *_gg .Creator ;_gbc float64 ;_fgg []*paragraph ;_edce *paragraph ;_gcbg *line ;_dga *word ;_gccg bool ;};func _eecc (_fccc ,_gbed *_cd .CT_TextParagraphProperties )*_cd .CT_TextParagraphProperties {_gbg :=_cd .NewCT_TextParagraphProperties ();if _fccc !=nil {*_gbg =*_fccc ;};if _gbed ==nil {return _gbg ;};if _gbg .MarLAttr ==nil {_gbg .MarLAttr =_gbed .MarLAttr ;};if _gbg .MarRAttr ==nil {_gbg .MarRAttr =_gbed .MarRAttr ;};if _gbg .LvlAttr ==nil {_gbg .LvlAttr =_gbed .LvlAttr ;};if _gbg .IndentAttr ==nil {_gbg .IndentAttr =_gbed .IndentAttr ;};if _gbg .AlgnAttr ==_cd .ST_TextAlignTypeUnset {_gbg .AlgnAttr =_gbed .AlgnAttr ;};if _gbg .DefTabSzAttr ==nil {_gbg .DefTabSzAttr =_gbed .DefTabSzAttr ;};if _gbg .RtlAttr ==nil {_gbg .RtlAttr =_gbed .RtlAttr ;};if _gbg .EaLnBrkAttr ==nil {_gbg .EaLnBrkAttr =_gbed .EaLnBrkAttr ;};if _gbg .FontAlgnAttr ==_cd .ST_TextFontAlignTypeUnset {_gbg .FontAlgnAttr =_gbed .FontAlgnAttr ;};if _gbg .LatinLnBrkAttr ==nil {_gbg .LatinLnBrkAttr =_gbed .LatinLnBrkAttr ;};if _gbg .HangingPunctAttr ==nil {_gbg .HangingPunctAttr =_gbed .HangingPunctAttr ;};if _gbg .LnSpc ==nil {_gbg .LnSpc =_gbed .LnSpc ;};if _gbg .SpcBef ==nil {_gbg .SpcBef =_gbed .SpcBef ;};if _gbg .SpcAft ==nil {_gbg .SpcAft =_gbed .SpcAft ;};if _gbg .BuClrTx ==nil {_gbg .BuClrTx =_gbed .BuClrTx ;};if _gbg .BuClr ==nil {_gbg .BuClr =_gbed .BuClr ;};if _gbg .BuSzTx ==nil {_gbg .BuSzTx =_gbed .BuSzTx ;};if _gbg .BuSzPct ==nil {_gbg .BuSzPct =_gbed .BuSzPct ;};if _gbg .BuSzPts ==nil {_gbg .BuSzPts =_gbed .BuSzPts ;};if _gbg .BuFontTx ==nil {_gbg .BuFontTx =_gbed .BuFontTx ;};if _gbg .BuFont ==nil {_gbg .BuFont =_gbed .BuFont ;};if _gbg .BuNone ==nil {_gbg .BuNone =_gbed .BuNone ;};if _gbg .BuAutoNum ==nil {_gbg .BuAutoNum =_gbed .BuAutoNum ;};if _gbg .BuChar ==nil {_gbg .BuChar =_gbed .BuChar ;};if _gbg .BuBlip ==nil {_gbg .BuBlip =_gbed .BuBlip ;};if _gbg .TabLst ==nil {_gbg .TabLst =_gbed .TabLst ;};if _gbg .ExtLst ==nil {_gbg .ExtLst =_gbed .ExtLst ;};_gbg .DefRPr =_bfgc (_gbg .DefRPr ,_gbed .DefRPr );return _gbg ;};func (_aegb *textboxContext )alignSymbolsVertically (){for _ ,_ebbd :=range _aegb ._fgg {for _ ,_gfecg :=range _ebbd ._fde {_dgcg :=0.0;for _ ,_fcgd :=range _gfecg ._beeb {for _ ,_afe :=range _fcgd ._bgeg {if _afe ._dgbc > _dgcg {_dgcg =_afe ._dgbc ;};};};for _ ,_eee :=range _gfecg ._beeb {for _ ,_dadf :=range _eee ._bgeg {if _dadf ._gfec < _dgcg {_dadf ._eca =_dgcg -_dadf ._gfec ;};};};};};};func (_ccgg *convertContext )renderCurrentStateToGoImage ()(_b .Image ,error ){_ecec :=_fg .MakeTempCreator (_ccgg ._gca ,_ccgg ._efff );_ecec .NewPage ();for _ ,_ccd :=range _ccgg ._dgfd {if _ccd !=nil {_ecec .MoveTo (0,0);_ecec .Draw (_ccd );};};_cebd ,_bcdb :=_fg .GetPageFromCreator (_ecec );if _bcdb !=nil {return nil ,_bcdb ;};return _ceb .NewImageDevice ().Render (_cebd );};func _ceg (_cage string )[]*symbol {_ebba :=[]*symbol {};for _ ,_daed :=range _cage {_ebba =append (_ebba ,&symbol {_gadc :string (_daed )});};return _ebba ;};func (_af *convertContext )makePdfBlockFromChart (_df *_ga .Chart ,_ee ,_ef float64 )(*_gg .Block ,error ){_fb :=_df .CT_RelId .IdAttr ;_cbf :=_af ._fada .GetChartSpaceByRelId (_fb );if _cbf ==nil {return nil ,_f .New ("\u004e\u006f\u0020\u0063\u0068\u0061\u0072\u0074\u0073\u0070\u0061\u0063\u0065");};var _aa *_cd .Theme ;_ab :=_af ._aea .Themes ();if len (_ab )> 0{_aa =_ab [0];};return _fg .MakeBlockFromChartSpace (_cbf ,_ee ,_ef ,_aa );};type paragraph struct{_dcfb float64 ;_dda float64 ;_bac float64 ;_gaa float64 ;_gea float64 ;_afdd float64 ;_ggdd float64 ;_fba float64 ;_fggd _cd .ST_TextAlignType ;_eac float64 ;_cgde bool ;_fde []*line ;};func (_gfe *convertContext )getShapesFromSpPr (_ffd *_cd .CT_ShapeProperties ,_cfc *_cd .CT_ShapeStyle ,_aaa bool )([]_gg .Drawable ,float64 ,float64 ,float64 ,float64 ,_gg .Color ,bool ){_eda :=[]_gg .Drawable {};var _age ,_bbd ,_eef ,_fcfc ,_bfcd float64 ;var _ecf ,_eg ,_bbdc ,_ccf _gg .Color ;var _cea *_cd .CT_BlipFillProperties ;_bfbe ,_aba :=1.0,1.0;if _cfc !=nil {_ecf ,_eg ,_ccf =_gfe .getStyleColors (_cfc );};if _eagg :=_ffd .Ln ;_eagg !=nil {if _eagg .NoFill !=nil {_bbdc ,_bfcd =nil ,0;}else {_bbdc ,_bfcd ,_bfbe =_gfe .getInfoFromLn (_eagg );if _bbdc ==nil {_bbdc =_ccf ;};};};if _ffd .NoFill !=nil {_eg ,_aba =nil ,0;}else if _aaa {_eg =_gfe ._fdfg ._gagc ;_aba =_gfe ._fdfg ._gfdf ;_cea =_gfe ._fdfg ._aefc ;}else if _fac :=_ffd .SolidFill ;_fac !=nil {_eg ,_aba =_gfe .getColorFromSolidFill (_fac );};var _bfg bool ;if _bffg :=_ffd .Xfrm ;_bffg !=nil {_age ,_bbd ,_eef ,_fcfc =_fg .GetDataFromXfrm (_bffg );_bfg =true ;};if _gffc :=_ffd .CustGeom ;_gffc !=nil {_ggd :=[]_bd .Point {};_bee ,_gag :=1.0,1.0;if _aebc :=_gffc .PathLst ;_aebc !=nil {for _ ,_gad :=range _aebc .Path {if _gad !=nil {if _cfd :=_gad .WAttr ;_cfd !=nil {_bee =_eef /_d .FromEMU (*_cfd );};if _bab :=_gad .HAttr ;_bab !=nil {_gag =_fcfc /_d .FromEMU (*_bab );};for _ ,_bcg :=range _gad .Close {if _bcg !=nil {};};for _ ,_edec :=range _gad .MoveTo {if _edec !=nil &&_edec .Pt !=nil {_cbe ,_cag :=_dac (_edec .Pt );_ggd =append (_ggd ,_bd .Point {X :_cbe *_bee +_age ,Y :_cag *_gag +_bbd });};};for _ ,_cafd :=range _gad .LnTo {if _cafd !=nil &&_cafd .Pt !=nil {_agf ,_bea :=_dac (_cafd .Pt );_ggd =append (_ggd ,_bd .Point {X :_agf *_bee +_age ,Y :_bea *_gag +_bbd });};};_aafe :=_gfe ._eceg .NewPolygon ([][]_bd .Point {_ggd });_aafe .SetFillColor (_eg );_aafe .SetFillOpacity (_aba );_aafe .SetBorderWidth (_bfcd );if _bbdc !=nil {_aafe .SetBorderColor (_bbdc );_aafe .SetBorderOpacity (_bfbe );};_eda =append (_eda ,_aafe );};};};};if _geb :=_ffd .PrstGeom ;_geb !=nil {switch _geb .PrstAttr {case _cd .ST_ShapeTypeRect :if _cea !=nil {_ddf :=_gfe .getShapeFromBlipFill (_cea ,_age ,_bbd ,_eef ,_fcfc );_eda =append (_eda ,_ddf );}else {_edd :=_gfe ._eceg .NewRectangle (_age ,_bbd ,_eef ,_fcfc );_edd .SetFillColor (_eg );_edd .SetFillOpacity (_aba );_edd .SetBorderWidth (_bfcd );if _bbdc !=nil {_edd .SetBorderColor (_bbdc );_edd .SetBorderOpacity (_bfbe );};_eda =append (_eda ,_edd );};case _cd .ST_ShapeTypeLine :_dccc :=_gfe ._eceg .NewLine (_age ,_bbd ,_age +_eef ,_bbd +_fcfc );_dccc .SetLineWidth (_bfcd );if _bbdc !=nil {_dccc .SetColor (_bbdc );};_eda =append (_eda ,_dccc );};};return _eda ,_age ,_bbd ,_eef ,_fcfc ,_ecf ,_bfg ;};func (_face *convertContext )makePdfBlockFromTxBody (_aegc *_cd .CT_TextBody ,_baf *_cd .CT_TextBodyProperties ,_bbg *_cd .CT_TextListStyle ,_eeb ,_dgf float64 ,_bbe _gg .Color ,_daff ,_fadd bool )(*_gg .Block ,error ){var _dfe *_cd .CT_TextParagraphProperties ;if _dcca :=_aegc .LstStyle ;_dcca !=nil {var _gfg *_cd .CT_TextParagraphProperties ;if _dcca .Lvl1pPr !=nil {_gfg =_dcca .Lvl1pPr ;};_dfe =_eecc (_gfg ,_dcca .DefPPr );};var _ddce *_cd .CT_TextParagraphProperties ;if _dfe !=nil {if _daff {_ddce =_face ._bed [0];}else if _fadd {_ddce =_face ._eggd [0];}else {_ddce =_face ._efcc [0];};if _bbg !=nil {_ddce =_eecc (_eecc (_bbg .Lvl1pPr ,_bbg .DefPPr ),_ddce );};_ddce =_eecc (_dfe ,_ddce );}else {if _daff {_ddce =_face ._gdga ;}else if _fadd {_ddce =_face ._gdd ;}else {_ddce =_face ._bcgc ;};};_beeg ,_cfe :=_daa (2.5),_daa (2.5);_aac ,_gdef :=_daa (1.3),_daa (1.3);_ebdb :=true ;_fee :=_cd .ST_TextAnchoringTypeT ;if _baf !=nil {if _ega :=_baf .AnchorAttr ;_ega !=_cd .ST_TextAnchoringTypeUnset {_fee =_ega ;};};if _cded :=_aegc .BodyPr ;_cded !=nil {if _agfc :=_cded .LInsAttr ;_agfc !=nil {_beeg =_d .FromEMU (_fg .FromSTCoordinate32 (*_agfc ));};if _afgb :=_cded .TInsAttr ;_afgb !=nil {_aac =_d .FromEMU (_fg .FromSTCoordinate32 (*_afgb ));};if _afge :=_cded .RInsAttr ;_afge !=nil {_cfe =_d .FromEMU (_fg .FromSTCoordinate32 (*_afge ));};if _fcd :=_cded .BInsAttr ;_fcd !=nil {_gdef =_d .FromEMU (_fg .FromSTCoordinate32 (*_fcd ));};_ebdb =_cded .WrapAttr !=_cd .ST_TextWrappingTypeNone ;if _cef :=_cded .AnchorAttr ;_cef !=_cd .ST_TextAnchoringTypeUnset {_fee =_cded .AnchorAttr ;};};_bcc :=_fg .MakeTempCreator (_eeb ,_dgf );_bcc .SetPageMargins (_beeg ,_cfe ,_aac ,_gdef );_dcbg :=&textboxContext {_deeg :_face ,_gccg :_ebdb ,_gffg :_eeb -_beeg -_cfe ,_fdca :_dgf -_aac -_gdef ,_gafa :_bcc ,_fgg :[]*paragraph {}};_efa :=1;for _ ,_ebcb :=range _aegc .P {if _ebcb !=nil {_dce :=_ebcb .PPr ;var _gba *prefixData ;if _dce !=nil &&_dce .BuNone ==nil {var _cfcb string ;var _dae bool ;if _ddd :=_dce .BuAutoNum ;_ddd !=nil {var _ggdc string ;if _dbb :=_ddd .StartAtAttr ;_dbb !=nil {_efa =int (*_dbb );};var _edb string ;switch _ddd .TypeAttr {case _cd .ST_TextAutonumberSchemeAlphaUcParenBoth ,_cd .ST_TextAutonumberSchemeAlphaUcParenR ,_cd .ST_TextAutonumberSchemeAlphaUcPeriod :_edb =_fggc (_efa ,true );case _cd .ST_TextAutonumberSchemeAlphaLcParenBoth ,_cd .ST_TextAutonumberSchemeAlphaLcParenR ,_cd .ST_TextAutonumberSchemeAlphaLcPeriod :_edb =_fggc (_efa ,false );case _cd .ST_TextAutonumberSchemeRomanUcParenBoth ,_cd .ST_TextAutonumberSchemeRomanUcParenR ,_cd .ST_TextAutonumberSchemeRomanUcPeriod :_edb =_dafff (_efa ,true );case _cd .ST_TextAutonumberSchemeRomanLcParenBoth ,_cd .ST_TextAutonumberSchemeRomanLcParenR ,_cd .ST_TextAutonumberSchemeRomanLcPeriod :_edb =_dafff (_efa ,false );default:_edb =_cbc .Itoa (_efa );};switch _ddd .TypeAttr {case _cd .ST_TextAutonumberSchemeAlphaLcPeriod ,_cd .ST_TextAutonumberSchemeAlphaUcPeriod ,_cd .ST_TextAutonumberSchemeArabicPeriod ,_cd .ST_TextAutonumberSchemeRomanLcPeriod ,_cd .ST_TextAutonumberSchemeRomanUcPeriod ,_cd .ST_TextAutonumberSchemeArabicDbPeriod ,_cd .ST_TextAutonumberSchemeEa1ChsPeriod ,_cd .ST_TextAutonumberSchemeEa1ChtPeriod ,_cd .ST_TextAutonumberSchemeEa1JpnChsDbPeriod ,_cd .ST_TextAutonumberSchemeEa1JpnKorPeriod ,_cd .ST_TextAutonumberSchemeThaiAlphaPeriod ,_cd .ST_TextAutonumberSchemeThaiNumPeriod ,_cd .ST_TextAutonumberSchemeHindiAlphaPeriod ,_cd .ST_TextAutonumberSchemeHindiNumPeriod ,_cd .ST_TextAutonumberSchemeHindiAlpha1Period :_ggdc ="\u002e";case _cd .ST_TextAutonumberSchemeAlphaLcParenR ,_cd .ST_TextAutonumberSchemeAlphaUcParenR ,_cd .ST_TextAutonumberSchemeArabicParenR ,_cd .ST_TextAutonumberSchemeRomanLcParenR ,_cd .ST_TextAutonumberSchemeRomanUcParenR ,_cd .ST_TextAutonumberSchemeThaiAlphaParenR ,_cd .ST_TextAutonumberSchemeThaiNumParenR ,_cd .ST_TextAutonumberSchemeHindiNumParenR :_ggdc ="\u0029";};_cfcb =_edb +_ggdc ;_efa ++;}else if _fdgf :=_dce .BuChar ;_fdgf !=nil {_cfde :=_fdgf .CharAttr ;if _bgb ,_eebe :=_fdae [_cfde ];_eebe {_cfde =string (rune (_bgb ));}else {_cfde ="\u2022";};_cfcb =_cfde ;_dae =true ;};if _cfcb !=""{var _cdg ,_gdcb float64 ;if _dce .MarLAttr !=nil {_cdg =_d .FromEMU (int64 (*_dce .MarLAttr ));};if _dce .IndentAttr !=nil {_gdcb =_d .FromEMU (int64 (*_dce .IndentAttr ));};_gba =&prefixData {_adcg :_cfcb ,_dbff :_dae ,_fdcg :_cdg ,_cfb :_gdcb };};};_dce =_eecc (_dce ,_ddce );_bebf :=_bfgc (_ebcb .EndParaRPr ,_dce .DefRPr );_dcbg .newParagraph ();_dcbg .assignPropsToCurrentParagraph (_dce );_dcbg .newLine ();_dcbg .newWord ();for _ccea ,_adee :=range _ebcb .EG_TextRun {_dcbg .addTextRun (_adee ,_bebf ,_bbe ,_gba );if _ccea > 0{_gba =nil ;};};_dcbg .addCurrentWordToParagraph ();};_dcbg .addCurrentParagraph ();};_dcbg .alignVertically (_fee );_dcbg .drawParagraphs ();return _fg .MakeBlockFromCreator (_bcc );};func (_dgg *convertContext )getStyleColors (_bdea *_cd .CT_ShapeStyle )(_gg .Color ,_gg .Color ,_gg .Color ){var _ddada ,_abce ,_accd _gg .Color ;if _gdfcb :=_bdea .LnRef ;_gdfcb !=nil {_abce =_dgg .getColorFromMatrixReference (_gdfcb );};if _fdcb :=_bdea .FillRef ;_fdcb !=nil {_accd =_dgg .getColorFromMatrixReference (_fdcb );};if _ecfea :=_bdea .FontRef ;_ecfea !=nil {_ddada =_dgg .getColorFromFontReference (_ecfea );};return _ddada ,_accd ,_abce ;};func (_facf *textboxContext )addTextRun (_ggdda *_cd .EG_TextRun ,_aae *_cd .CT_TextCharacterProperties ,_bba _gg .Color ,_fdb *prefixData ){if _abe :=_ggdda .Br ;_abe !=nil {_facf .addCurrentWordToParagraph ();_facf .newLine ();_facf .newWord ();}else if _ebac :=_ggdda .R ;_ebac !=nil {var _eege _gg .Color ;if _ebac .RPr .SolidFill !=nil {_eege ,_ =_facf ._deeg .getColorFromSolidFill (_ebac .RPr .SolidFill );}else if _bba !=nil {_eege =_bba ;}else if _aae .SolidFill !=nil {_eege ,_ =_facf ._deeg .getColorFromSolidFill (_aae .SolidFill );}else {_eege =_gg .ColorBlack ;};_gecae :=_bfgc (_ebac .RPr ,_aae );_deb ,_cgddc ,_gdac ,_fafcg :=_facf ._deeg .makeStyleFromRPr (_gecae );_deb .Color =_eege ;if _fdb !=nil {_facf .addPrefix (_fdb ,_deb );};_dcaae :=_ceg (_ebac .T );for _ ,_fdda :=range _dcaae {_fdda ._affc =_deb ;_fdda ._fdgb =_cgddc ;_fdda ._fda =_gdac ;_fdda ._fbb =_fafcg ;if _gecae .CapAttr ==_cd .ST_TextCapsTypeAll {_fdda ._gadc =_g .ToUpper (_fdda ._gadc );};_facf .addTextSymbol (_fdda );};};};func (_cggf *convertContext )renderPageWithDrawableToGoImage (_gacc _gg .Drawable )(_b .Image ,error ){_gddf :=_fg .MakeTempCreator (_cggf ._gca ,_cggf ._efff );_gddf .NewPage ();_gddf .Draw (_gacc );_afee ,_bfff :=_fg .GetPageFromCreator (_gddf );if _bfff !=nil {return nil ,_bfff ;};return _ceb .NewImageDevice ().Render (_afee );};func (_ggbd *textboxContext )addCurrentParagraph (){_ggbd ._gbc =_ggbd ._edce ._ggdd +_ggbd ._edce ._dda +_ggbd ._edce ._fba +_ggbd ._edce ._bac ;_ggbd ._fgg =append (_ggbd ._fgg ,_ggbd ._edce );_ggbd .alignParagraph ();};func (_dcd *convertContext )makeStyleFromRPr (_edf *_cd .CT_TextCharacterProperties )(*_gg .TextStyle ,bool ,bool ,bool ){var _gbab ,_gec ,_bbed bool ;_fcg :=_dcd ._eceg .NewTextStyle ();if _edf !=nil {_eec :=_fg .FontStyle_Regular ;_fgb :=_deegc (_edf .BAttr );_bbb :=_deegc (_edf .IAttr );if _fgb &&_bbb {_eec =_fg .FontStyle_BoldItalic ;}else if _fgb {_eec =_fg .FontStyle_Bold ;}else if _bbb {_eec =_fg .FontStyle_Italic ;};_bbed =_edf .UAttr !=_cd .ST_TextUnderlineTypeUnset &&_edf .UAttr !=_cd .ST_TextUnderlineTypeNone ;_cee :="\u0064e\u0066\u0061\u0075\u006c\u0074";if _eddb :=_edf .Latin ;_eddb !=nil {_cee =_eddb .TypefaceAttr ;}else if _ebg :=_edf .Ea ;_ebg !=nil {_cee =_ebg .TypefaceAttr ;}else if _ggf :=_edf .Cs ;_ggf !=nil {_cee =_ggf .TypefaceAttr ;}else if _gcdd :=_edf .Sym ;_gcdd !=nil {_cee =_gcdd .TypefaceAttr ;};if _bffe ,_edff :=_fg .StdFontsMap [_cee ];_edff {_fcg .Font =_fg .AssignStdFontByName (_fcg ,_bffe [_eec ]);}else if _cdc :=_fg .GetRegisteredFont (_cee ,_eec );_cdc !=nil {_fcg .Font =_cdc ;}else {_ba .Log .Debug ("\u0046\u006f\u006e\u0074\u0020\u0025\u0073\u0020\u0077\u0069\u0074h\u0020\u0073\u0074\u0079\u006c\u0065\u0020\u0025s\u0020i\u0073\u0020\u006e\u006f\u0074\u0020\u0066\u006f\u0075\u006e\u0064\u002c\u0020\u0072\u0065\u0073\u0065\u0074 \u0074\u006f\u0020\u0064\u0065\u0066\u0061\u0075\u006c\u0074\u002e",_cee ,_eec );_fcg .Font =_fg .AssignStdFontByName (_fcg ,_fg .StdFontsMap ["\u0064e\u0066\u0061\u0075\u006c\u0074"][_eec ]);};var _gafe float64 ;if _cba :=_edf .SzAttr ;_cba !=nil {_gafe =float64 (*_cba )/100;}else {_gafe =_fg .DefaultFontSize ;};if _gbe :=_edf .BaselineAttr ;_gbe !=nil {if _dafa :=_gbe .ST_PercentageDecimal ;_dafa !=nil {if *_dafa > 0{_gbab =true ;}else if *_dafa < 0{_gec =true ;};};};if _gbab ||_gec {_gafe *=0.64;};_fcg .FontSize =_gafe ;_ecee :=0.0;if _ceba :=_edf .SpcAttr ;_ceba !=nil {if _dbba :=_ceba .ST_TextPointUnqualified ;_dbba !=nil {_ecee =float64 (*_dbba )/100;};};_fcg .CharSpacing =_ecee ;};return &_fcg ,_gbab ,_gec ,_bbed ;};func (_ecd *textboxContext )addCurrentWordToParagraph (){if _ecd ._gccg &&_ecd ._gcbg ._caa +_ecd ._dga ._babf > _ecd ._gcbg ._edad {_ecd .newLine ();};if !_ecd ._dga ._ebaf ||len (_ecd ._gcbg ._beeb )> 0{_ecd ._dga ._gdfc =_ecd ._gcbg ._caa ;_ecd ._gcbg ._beeb =append (_ecd ._gcbg ._beeb ,_ecd ._dga );_ecd ._gcbg ._caa +=_ecd ._dga ._babf ;for _ ,_ecge :=range _ecd ._dga ._bgeg {_ecd .adjustHeights (_ecge ._dgbc );};};};type word struct{_bgeg []*symbol ;_gdfc float64 ;_babf float64 ;_ebaf bool ;};func _gbcac (_ebfbe ,_bcfd *_cd .CT_TablePartStyle )*_cd .CT_TablePartStyle {_dfb :=_cd .NewCT_TablePartStyle ();if _ebfbe !=nil {*_dfb =*_ebfbe ;};if _bcfd ==nil {return _dfb ;};if _dfb .TcTxStyle ==nil {_dfb .TcTxStyle =_bcfd .TcTxStyle ;}else {_dfb .TcTxStyle =_cagc (_dfb .TcTxStyle ,_bcfd .TcTxStyle );};if _dfb .TcStyle ==nil {_dfb .TcStyle =_bcfd .TcStyle ;}else {_dfb .TcStyle =_bdcc (_dfb .TcStyle ,_bcfd .TcStyle );};return _dfb ;};func (_ddad *textboxContext )assignPropsToCurrentParagraph (_bbcb *_cd .CT_TextParagraphProperties ){_bdgg :=12.4;if _bbcb ==nil {_ddad ._edce ._eac =_bdgg ;return ;};if _gge :=_bbcb .DefRPr ;_gge !=nil {_fcb :=_gge .SzAttr ;if _fcb !=nil {_cdga :=float64 (*_fcb )/1200;if _bdgg <=_cdga {_bdgg =_cdga ;};};};if _decb :=_bbcb .MarLAttr ;_decb !=nil {_ddad ._edce ._gea =_d .FromEMU (int64 (*_decb ));};_ddad ._edce ._afdd =_ddad ._gffg ;if _bdfa :=_bbcb .MarRAttr ;_bdfa !=nil {_ddad ._edce ._afdd -=_d .FromEMU (int64 (*_bdfa ));};if _gfdd :=_bbcb .IndentAttr ;_gfdd !=nil {_ddad ._edce ._gaa =_d .FromEMU (int64 (*_gfdd ));};if _cebfa :=_bbcb .LatinLnBrkAttr ;_cebfa !=nil {_ddad ._edce ._cgde =*_cebfa ;};if _ccba :=_bbcb .LnSpc ;_ccba !=nil {if _afgcd :=_ccba .SpcPct ;_afgcd !=nil {if _ace :=_afgcd .ValAttr .ST_TextSpacingPercent ;_ace !=nil {_bdgg =float64 (*_ace )/5000;};};};var _aadf float64 ;if _ggba :=_bbcb .SpcBef ;_ggba !=nil {if _cab :=_ggba .SpcPts ;_cab !=nil {_aadf =float64 (_cab .ValAttr )/100;};};_feea :=_ddad ._fgg ;if len (_feea )> 0{_aadf -=_feea [len (_feea )-1]._bac ;if _aadf < 0{_aadf =0;};};_ddad ._edce ._dda =_aadf ;if _bdfg :=_bbcb .SpcAft ;_bdfg !=nil {if _dbfa :=_bdfg .SpcPts ;_dbfa !=nil {_ddad ._edce ._bac =float64 (_dbfa .ValAttr )/100;};};_ddad ._edce ._eac =_bdgg ;_ddad ._edce ._fggd =_bbcb .AlgnAttr ;};var _ecae =[]romanMatch {romanMatch {1000,"\u006d"},romanMatch {900,"\u0063\u006d"},romanMatch {500,"\u0064"},romanMatch {400,"\u0063\u0064"},romanMatch {100,"\u0063"},romanMatch {90,"\u0078\u0063"},romanMatch {50,"\u006c"},romanMatch {40,"\u0078\u006c"},romanMatch {10,"\u0078"},romanMatch {9,"\u0069\u0078"},romanMatch {5,"\u0076"},romanMatch {4,"\u0069\u0076"},romanMatch {1,"\u0069"}};func _bdcc (_gecb ,_eeab *_cd .CT_TableStyleCellStyle )*_cd .CT_TableStyleCellStyle {_feg :=_cd .NewCT_TableStyleCellStyle ();if _gecb !=nil {*_feg =*_gecb ;};if _eeab ==nil {return _feg ;};if _feg .TcBdr ==nil {_feg .TcBdr =_eeab .TcBdr ;};if _feg .Fill ==nil {_feg .Fill =_eeab .Fill ;};if _feg .FillRef ==nil {_feg .FillRef =_eeab .FillRef ;};return _feg ;};func (_fdeg *line )moveRight (_gffa float64 ){for _ ,_edaf :=range _fdeg ._beeb {_edaf ._gdfc +=_gffa ;};};func (_bacf *convertContext )applyBlipEffectsOnImg (_adaa *_gg .Image ,_cedc ,_gffd float64 ,_dgcbb []*_cd .CT_BlipChoice )*_gg .Image {if len (_dgcbb )==0{return _adaa ;};_adaa .SetPos (_cedc ,_gffd );_ggfb ,_aedae :=_bacf .renderPageWithDrawableToGoImage (_adaa );if _aedae !=nil {_ba .Log .Debug ("\u0045\u0072\u0072\u006f\u0072\u0020\u0072\u0065\u006e\u0064\u0065\u0072\u0020a\u006e\u0020\u0069\u006d\u0061\u0067e\u0020\u0074\u006f\u0020\u0061\u0020\u0047\u006f\u0020\u0069\u006d\u0061\u0067e\u003a\u0020\u0025\u0073",_aedae );return _adaa ;};_gefg ,_aedae :=_bacf .renderCurrentStateToGoImage ();if _aedae !=nil {_ba .Log .Debug ("\u0045\u0072\u0072\u006f\u0072\u0020\u0072\u0065n\u0064\u0065\u0072 t\u0068\u0065\u0020\u0063\u0075\u0072r\u0065\u006e\u0074\u0020\u0073\u0074\u0061\u0074\u0065\u0020\u0074\u006f\u0020\u0061\u0020G\u006f\u0020\u0069\u006d\u0061\u0067\u0065\u003a \u0025\u0073",_aedae );return _adaa ;};_eaa :=_ggfb .Bounds ();_fcdb :=_b .NewRGBA (_eaa );_efffcd ,_gdace :=_adaa .Width (),_adaa .Height ();for _ ,_bcdg :=range _dgcbb {for _ ,_bfaf :=range _bcdg .AlphaModFix {if _ffc :=_bfaf .AmtAttr ;_ffc !=nil {if _fgc :=_ffc .ST_PositivePercentageDecimal ;_fgc !=nil {_cgcd :=uint8 (255*(*_fgc )/100000);_gbfa :=_b .NewUniform (_cb .Alpha {_cgcd });_a .Draw (_fcdb ,_eaa ,_gefg ,_b .Point {0,0},_a .Src );_a .DrawMask (_fcdb ,_eaa ,_ggfb ,_b .Point {0,0},_gbfa ,_b .Point {0,0},_a .Over );};};};};_afbc :=_b .Rect (int (_cedc ),int (_gffd ),int (_cedc +_efffcd )+1,int (_gffd +_gdace )+1);_ggbc :=_fg .CropImageByRect (_fcdb ,_afbc );_gcdf ,_aedae :=_bacf ._eceg .NewImageFromGoImage (_ggbc );if _aedae !=nil {_ba .Log .Debug ("\u0045\u0072\u0072\u006f\u0072\u0020\u0061\u006e\u0020\u0069\u006d\u0061\u0067\u0065\u0020t\u006f \u0061\u0020\u0047\u006f\u0020\u0069\u006d\u0061\u0067\u0065\u003a\u0020\u0025\u0073",_aedae );return _adaa ;};return _gcdf ;};func (_gaea *textboxContext )drawParagraphs (){_gaea ._gafa .NewPage ();for _ ,_eed :=range _gaea ._fgg {for _ ,_cdff :=range _eed ._fde {for _ ,_dfa :=range _cdff ._beeb {for _ ,_geadd :=range _dfa ._bgeg {_gcad :=_gaea ._gafa .NewStyledParagraph ();if _geadd ._fdgb {_geadd ._eca =0;}else if _geadd ._fda {_geadd ._eca =1.2*_cdff ._gbag -_geadd ._gfec ;};_cae :=_dfa ._gdfc +_geadd ._adg ;_dgea :=_eed ._ggdd +_cdff ._ebdd +_geadd ._eca ;_gcad .SetPos (_cae ,_dgea );_ebad :=_gcad .Append (_geadd ._gadc );if _geadd ._affc !=nil {_ebad .Style =*_geadd ._affc ;};_gaea ._gafa .Draw (_gcad );if _geadd ._fbb {_fddad :=_dgea +_geadd ._gfec +2;_fg .DrawLine (_gaea ._gafa ,_cae ,_fddad ,_cae +_geadd ._gead ,_fddad ,1,_geadd ._affc .Color );};};};};};};type romanMatch struct{_ebae int ;_agcd string ;};func (_fgba *textboxContext )alignParagraph (){_dgdg :=_fgba ._edce ;if _dgdg ._fggd ==_cd .ST_TextAlignTypeL {return ;};_adfe :=len (_dgdg ._fde )-1;for _dafe ,_adge :=range _dgdg ._fde {_egfb :=true ;_eega :=len (_adge ._beeb );_ggbbd :=0.0;for _gbca :=len (_adge ._beeb )-1;_gbca >=0;_gbca --{_ccbg :=_adge ._beeb [_gbca ];if _egfb &&_ccbg ._ebaf {_eega =_gbca ;}else {_egfb =false ;for _ ,_fec :=range _ccbg ._bgeg {_ggbbd +=_fec ._gead ;};};};_adge ._beeb =_adge ._beeb [:_eega ];_ccad :=_adge ._edad -_adge ._ebbbb -_ggbbd ;switch _dgdg ._fggd {case _cd .ST_TextAlignTypeR :_adge .moveRight (_ccad );case _cd .ST_TextAlignTypeCtr :_adge .moveRight (_ccad /2);case _cd .ST_TextAlignTypeJust :if _dafe !=_adfe {_bfeg :=[]*word {};for _ ,_dddc :=range _adge ._beeb {if _dddc ._ebaf {_bfeg =append (_bfeg ,_dddc );};};_aebf :=_ccad /float64 (len (_bfeg ));for _ ,_deda :=range _bfeg {_deda ._babf +=_aebf ;};var _aced *word ;for _ ,_fffa :=range _adge ._beeb {if _aced !=nil {_fffa ._gdfc =_aced ._gdfc +_aced ._babf ;};_aced =_fffa ;};};};};};func (_cdedc *convertContext )getColorFromFontReference (_ddb *_cd .CT_FontReference )_gg .Color {var _aega _gg .Color ;var _bdfb string ;if _gcgf :=_ddb .SrgbClr ;_gcgf !=nil {_bdfb =_gcgf .ValAttr ;}else if _ecgef :=_ddb .SchemeClr ;_ecgef !=nil {_bdfb =_fg .GetColorStringFromDmlColor (_cdedc ._aea .GetColorBySchemeColor (_ecgef .ValAttr ));_bdfb =_fg .AdjustColor (_bdfb ,_ecgef .EG_ColorTransform );};if _bdfb !=""{_aega =_gg .ColorRGBFromHex ("\u0023"+_bdfb );};return _aega ;};func (_gcde *textboxContext )addTextSymbol (_dccd *symbol ){_ecg :=_gg .New ();_eada :=_ecg .NewStyledParagraph ();_eada .SetMargins (0,0,0,0);_ggce :=_eada .Append (_dccd ._gadc );_ecfa :=0.0;if _dccd ._affc !=nil {_ggce .Style =*_dccd ._affc ;if _dccd ._affc .CharSpacing !=0{_ecfa =_dccd ._affc .CharSpacing ;};};_dccd ._gfec =_eada .Height ();_dccd ._dgbc =_eada .Height ()*1.2;if _dccd ._dgbc < _gcde ._edce ._eac {_dccd ._dgbc =_gcde ._edce ._eac ;};if _dccd ._gead ==0{_dccd ._gead =_eada .Width ()+_ecfa ;};if len (_gcde ._dga ._bgeg )> 0{_baa :=_gcde ._dga ._bgeg [len (_gcde ._dga ._bgeg )-1]._gadc ;if _gcde ._edce ._cgde ||_fg .IsNoSpaceLanguage (_baa )||(_baa =="\u0020")!=(_dccd ._gadc =="\u0020"){_gcde .addCurrentWordToParagraph ();_gcde .newWord ();};};_gcde ._dga ._bgeg =append (_gcde ._dga ._bgeg ,_dccd );_dccd ._adg =_gcde ._dga ._babf ;_gcde ._dga ._babf +=_dccd ._gead ;if _dccd ._gadc !="\u0020"{_gcde ._dga ._ebaf =false ;};};func _deegc (_gce *bool )bool {return _gce !=nil &&*_gce };func _afcf (_ebfd ,_efdee *_cd .CT_TextBodyProperties )*_cd .CT_TextBodyProperties {_gbff :=_cd .NewCT_TextBodyProperties ();if _ebfd !=nil {*_gbff =*_ebfd ;};if _efdee ==nil {return _gbff ;};if _gbff .RotAttr ==nil {_gbff .RotAttr =_efdee .RotAttr ;};if _gbff .SpcFirstLastParaAttr ==nil {_gbff .SpcFirstLastParaAttr =_efdee .SpcFirstLastParaAttr ;};if _gbff .VertOverflowAttr ==_cd .ST_TextVertOverflowTypeUnset {_gbff .VertOverflowAttr =_efdee .VertOverflowAttr ;};if _gbff .HorzOverflowAttr ==_cd .ST_TextHorzOverflowTypeUnset {_gbff .HorzOverflowAttr =_efdee .HorzOverflowAttr ;};if _gbff .VertAttr ==_cd .ST_TextVerticalTypeUnset {_gbff .VertAttr =_efdee .VertAttr ;};if _gbff .WrapAttr ==_cd .ST_TextWrappingTypeUnset {_gbff .WrapAttr =_efdee .WrapAttr ;};if _gbff .LInsAttr ==nil {_gbff .LInsAttr =_efdee .LInsAttr ;};if _gbff .TInsAttr ==nil {_gbff .TInsAttr =_efdee .TInsAttr ;};if _gbff .RInsAttr ==nil {_gbff .RInsAttr =_efdee .RInsAttr ;};if _gbff .BInsAttr ==nil {_gbff .BInsAttr =_efdee .BInsAttr ;};if _gbff .NumColAttr ==nil {_gbff .NumColAttr =_efdee .NumColAttr ;};if _gbff .SpcColAttr ==nil {_gbff .SpcColAttr =_efdee .SpcColAttr ;};if _gbff .RtlColAttr ==nil {_gbff .RtlColAttr =_efdee .RtlColAttr ;};if _gbff .AnchorAttr ==_cd .ST_TextAnchoringTypeUnset {_gbff .AnchorAttr =_efdee .AnchorAttr ;};if _gbff .AnchorCtrAttr ==nil {_gbff .AnchorCtrAttr =_efdee .AnchorCtrAttr ;};if _gbff .ForceAAAttr ==nil {_gbff .ForceAAAttr =_efdee .ForceAAAttr ;};if _gbff .UprightAttr ==nil {_gbff .UprightAttr =_efdee .UprightAttr ;};if _gbff .CompatLnSpcAttr ==nil {_gbff .CompatLnSpcAttr =_efdee .CompatLnSpcAttr ;};if _gbff .PrstTxWarp ==nil {_gbff .PrstTxWarp =_efdee .PrstTxWarp ;};if _gbff .NoAutofit ==nil {_gbff .NoAutofit =_efdee .NoAutofit ;};if _gbff .NormAutofit ==nil {_gbff .NormAutofit =_efdee .NormAutofit ;};if _gbff .SpAutoFit ==nil {_gbff .SpAutoFit =_efdee .SpAutoFit ;};if _gbff .Scene3d ==nil {_gbff .Scene3d =_efdee .Scene3d ;};if _gbff .Sp3d ==nil {_gbff .Sp3d =_efdee .Sp3d ;};if _gbff .FlatTx ==nil {_gbff .FlatTx =_efdee .FlatTx ;};if _gbff .ExtLst ==nil {_gbff .ExtLst =_efdee .ExtLst ;};return _gbff ;};func (_egf *convertContext )makePdfBlockFromTable (_dfec *_cd .Tbl ,_afab float64 )*_gg .Table {_fcge :=_dfec .TblGrid ;if _fcge ==nil {return nil ;};_dcbc :=len (_fcge .GridCol );if _dcbc ==0{return nil ;};_egc :=[]float64 {};_gda :=0.0;for _ ,_acc :=range _fcge .GridCol {_ecba :=_d .FromEMU (_fg .FromSTCoordinate (_acc .WAttr ));_egc =append (_egc ,_ecba );_gda +=_ecba ;};_gfef :=[]float64 {};for _cdee :=0;_cdee < _dcbc ;_cdee ++{_gfef =append (_gfef ,_egc [_cdee ]/_gda );};_dbbd :=_egf ._eceg .NewTable (_dcbc );_dbbd .SetColumnWidths (_gfef ...);_badf :=_dfec .TblPr ;var _cgab *_cd .CT_TableStyle ;if _bag :=_badf .Choice ;_bag !=nil {if _bag .TableStyle !=nil {_cgab =_bag .TableStyle ;}else if _bag .TableStyleId !=nil {_cgab =_egf ._aea .GetTableStyleById (*_bag .TableStyleId );};};_ceac :=_cd .NewCT_TablePartStyle ();_ceac .TcStyle =_cd .NewCT_TableStyleCellStyle ();_ceac .TcTxStyle =_cd .NewCT_TableStyleTextStyle ();if _cgab !=nil {if _cgab .WholeTbl !=nil {*_ceac =*_cgab .WholeTbl ;};if _cgab .TblBg !=nil {if _ceac .TcStyle .Fill ==nil {_ceac .TcStyle .Fill =_cgab .TblBg .Fill ;};};};if _ceac .TcStyle .Fill ==nil {_ceac .TcStyle .Fill =_cd .NewCT_FillProperties ();_ceac .TcStyle .Fill .NoFill =_badf .NoFill ;_ceac .TcStyle .Fill .SolidFill =_badf .SolidFill ;};_agc :=len (_dfec .Tr );for _fbc ,_ggbb :=range _dfec .Tr {_gfa :=_fbc ==0;_dbf :=_fbc ==_agc -1;_cgfc :=_fbc %2==0;_efae :=len (_ggbb .Tc );var _bdg *_cd .CT_TablePartStyle ;if _gfa {_bdg =_cgab .FirstRow ;}else if _cgfc {_bdg =_cgab .Band2H ;}else {_bdg =_cgab .Band1H ;};var _cge float64 ;for _egae ,_eegd :=range _ggbb .Tc {_bdb :=_egae ==0;_dbe :=_egae ==_efae -1;_fdfc :=_egae %2==0;var _edc *_cd .CT_TablePartStyle ;if _bdb {_edc =_cgab .FirstCol ;}else if _fdfc {_edc =_cgab .Band2V ;}else {_edc =_cgab .Band1V ;};_ebbb :=_gbcac (_gbcac (_edc ,_bdg ),_ceac );_bfgd :=_egf .addCellToTable (_dbbd ,_eegd ,_ebbb ,_afab *_gfef [_egae ],_gfa ,_dbf ,_bdb ,_dbe );if _bfgd > _cge {_cge =_bfgd ;};};_aee :=_d .FromEMU (_fg .FromSTCoordinate (_ggbb .HAttr ));if _aee < _cge {_aee =_cge ;};if _aee < _daa (4){_aee =_daa (4);};_dbbd .SetRowHeight (_dbbd .CurRow (),_aee );};return _dbbd ;};func (_fdg *convertContext )makeSlide (){_cc :=_fdg ._fada .X ().CSld ;if _cc ==nil {return ;};_aag :=&background {};if _gab :=_cc .Bg ;_gab !=nil {if _dee :=_gab .BgPr ;_dee !=nil {if _dee .NoFill ==nil {if _ade :=_dee .SolidFill ;_ade !=nil {_fea ,_afd :=_fdg .getColorFromSolidFill (_ade );if _fea !=nil {_aag ._gagc =_fea ;_aag ._gfdf =_afd ;};}else if _ebd :=_dee .BlipFill ;_ebd !=nil {_aag ._aefc =_ebd ;};};};};_fdg ._fdfg =_aag ;if _eea :=_cc .SpTree ;_eea !=nil {for _ ,_ebf :=range _eea .Choice {if _ebf !=nil {for _ ,_fef :=range _ebf .Sp {if _fef !=nil {_bf :=_fdg .getShapes (_fef );_fdg ._dgfd =append (_fdg ._dgfd ,_bf ...);};};for _ ,_bfc :=range _ebf .GraphicFrame {if _bfc !=nil {var _eba ,_acb ,_aca ,_ag float64 ;if _gabb :=_bfc .Xfrm ;_gabb !=nil {_eba ,_acb ,_aca ,_ag =_fg .GetDataFromXfrm (_gabb );};if _dc :=_bfc .Graphic ;_dc !=nil {if _ea :=_dc .GraphicData ;_ea !=nil {for _ ,_bad :=range _ea .Any {if _gf ,_ddg :=_bad .(*_ga .Chart );_ddg {_ge ,_bbc :=_fdg .makePdfBlockFromChart (_gf ,_aca ,_ag );if _bbc !=nil {_ba .Log .Debug ("C\u0061\u006e\u006e\u006ft \u0072e\u0061\u0064\u0020\u0062\u006co\u0063\u006b\u003a\u0020\u0025\u0073",_bbc );};if _ge !=nil {_ge .SetPos (_eba ,_acb );_fdg ._dgfd =append (_fdg ._dgfd ,_ge );};}else if _ccb ,_feaa :=_bad .(*_cd .Tbl );_feaa {_cbfb :=_fdg .makePdfBlockFromTable (_ccb ,_aca );if _cbfb !=nil {_ead :=_gg .NewBlock (_aca ,_ag );_ead .SetPos (_eba ,_acb );_ead .Draw (_cbfb );_fdg ._dgfd =append (_fdg ._dgfd ,_ead );};};};};};};};for _ ,_cg :=range _ebf .CxnSp {if _cg !=nil {_ecb :=_fdg .getConnectors (_cg );_fdg ._dgfd =append (_fdg ._dgfd ,_ecb ...);};};for _ ,_bde :=range _ebf .Pic {if _bde !=nil {var _ffe ,_faf ,_adf ,_dde float64 ;if _ada :=_bde .SpPr ;_ada !=nil {if _gc :=_ada .Xfrm ;_gc !=nil {_ffe ,_faf ,_adf ,_dde =_fg .GetDataFromXfrm (_gc );};};if _gff :=_bde .BlipFill ;_gff !=nil {_db :=_fdg .getShapeFromBlipFill (_gff ,_ffe ,_faf ,_adf ,_dde );_fdg ._dgfd =append (_fdg ._dgfd ,_db );};};};};};};};type prefixData struct{_adcg string ;_dbff bool ;_fdcg float64 ;_cfb float64 ;};func (_fbg *convertContext )drawSlide (){_fbg ._eceg .NewPage ();for _ ,_ddge :=range _fbg ._dgfd {if _ddge !=nil {_fbg ._eceg .MoveTo (0,0);_fbg ._eceg .Draw (_ddge );};};};func (_bdfaa *convertContext )getColorFromSolidFill (_aab *_cd .CT_SolidColorFillProperties )(_gg .Color ,float64 ){if _aab ==nil {return nil ,1;};var _dabg string ;_gddg :=1.0;if _ebgb :=_aab .SrgbClr ;_ebgb !=nil {_dabg =_ebgb .ValAttr ;_gddg =_fg .GetOpacityFromColorTransform (_ebgb .EG_ColorTransform );}else if _ecfe :=_aab .SchemeClr ;_ecfe !=nil {_dabg =_fg .GetColorStringFromDmlColor (_bdfaa ._fada .GetColorBySchemeColor (_ecfe .ValAttr ));_dabg =_fg .AdjustColor (_dabg ,_ecfe .EG_ColorTransform );_gddg =_fg .GetOpacityFromColorTransform (_ecfe .EG_ColorTransform );};if _dabg !=""{_ege :=_gg .ColorRGBFromHex ("\u0023"+_dabg );return _ege ,_gddg ;};return nil ,1;};var _ca =_daa (1.9);func (_cfbg *convertContext )getColorFromMatrixReference (_cbfbe *_cd .CT_StyleMatrixReference )_gg .Color {if _cbfbe ==nil {return nil ;};var _dcg _gg .Color ;var _fdde string ;if _cbcb :=_cbfbe .SrgbClr ;_cbcb !=nil {_fdde =_cbcb .ValAttr ;}else if _ggcc :=_cbfbe .SchemeClr ;_ggcc !=nil {_fdde =_fg .GetColorStringFromDmlColor (_cfbg ._aea .GetColorBySchemeColor (_ggcc .ValAttr ));_fdde =_fg .AdjustColor (_fdde ,_ggcc .EG_ColorTransform );};if _fdde !=""{_dcg =_gg .ColorRGBFromHex ("\u0023"+_fdde );};return _dcg ;};func _bce (_daae *_e .CT_Shape )(_e .ST_PlaceholderType ,*uint32 ){if _gfb :=_daae .NvSpPr ;_gfb !=nil {if _cec :=_gfb .NvPr ;_cec !=nil {if _gcgb :=_cec .Ph ;_gcgb !=nil {return _gcgb .TypeAttr ,_gcgb .IdxAttr ;};};};return _e .ST_PlaceholderTypeUnset ,nil ;};func _daa (_ecbg float64 )float64 {return _ecbg *_d .Millimeter };func (_gbad *textboxContext )adjustHeights (_bdee float64 ){if _gbad ._gcbg ._gbag < _bdee {_gbad ._edce ._fba +=(_bdee -_gbad ._gcbg ._gbag );_gbad ._gcbg ._gbag =_bdee ;};};func (_fbd *textboxContext )newParagraph (){_cegb :=&paragraph {};_cegb ._ggdd =_fbd ._gbc ;_fbd ._edce =_cegb ;};func (_dgb *convertContext )getConnectors (_aef *_e .CT_Connector )[]_gg .Drawable {_beb ,_ ,_ ,_ ,_ ,_ ,_ :=_dgb .getShapesFromSpPr (_aef .SpPr ,_aef .Style ,false );return _beb ;};func _fggc (_cgga int ,_ceea bool )string {_cbfbg :=(_cgga -1)/26+1;_bccf :=byte ((_cgga -1)%26);if _ceea {_bccf +=byte (65);}else {_bccf +=byte (97);};_gcba :=_fd .NewBuffer ([]byte {});for _abca :=0;_abca < _cbfbg ;_abca ++{_gcba .Write ([]byte {_bccf });};return _gcba .String ();};func _gceg (_geae *_cd .CT_TableCellProperties ,_aded *_cd .CT_TableStyleCellStyle ,_baef ,_ceee ,_dbgec ,_bfca bool )*_cd .CT_TableCellProperties {_gbda :=_cd .NewCT_TableCellProperties ();if _geae !=nil {*_gbda =*_geae ;};if _aded ==nil {return _gbda ;};if _gdeaf :=_aded .FillRef ;_gdeaf !=nil {_edeaf :=_cd .NewCT_SolidColorFillProperties ();_edeaf .ScrgbClr =_gdeaf .ScrgbClr ;_edeaf .SrgbClr =_gdeaf .SrgbClr ;_edeaf .HslClr =_gdeaf .HslClr ;_edeaf .SysClr =_gdeaf .SysClr ;_edeaf .SchemeClr =_gdeaf .SchemeClr ;_edeaf .PrstClr =_gdeaf .PrstClr ;_gbda .SolidFill =_edeaf ;};if _gbda .NoFill ==nil &&_gbda .SolidFill ==nil {if _bdbe :=_aded .Fill ;_bdbe !=nil {if _gbda .NoFill ==nil {_gbda .NoFill =_bdbe .NoFill ;};if _gbda .SolidFill ==nil {_gbda .SolidFill =_bdbe .SolidFill ;};};};if _ggcg :=_aded .TcBdr ;_ggcg !=nil {if _gbda .LnL ==nil {var _bdeb *_cd .CT_ThemeableLineStyle ;if _dbgec {_bdeb =_ggcg .Left ;}else {_bdeb =_ggcg .InsideV ;};if _bdeb !=nil {_gbda .LnL =_bdeb .Ln ;};};if _gbda .LnR ==nil {var _gefd *_cd .CT_ThemeableLineStyle ;if _bfca {_gefd =_ggcg .Right ;}else {_gefd =_ggcg .InsideV ;};if _gefd !=nil {_gbda .LnR =_gefd .Ln ;};};if _gbda .LnT ==nil {var _cffgc *_cd .CT_ThemeableLineStyle ;if _baef {_cffgc =_ggcg .Top ;}else {_cffgc =_ggcg .InsideH ;};if _cffgc !=nil {_gbda .LnT =_cffgc .Ln ;};};if _gbda .LnB ==nil {var _dgbg *_cd .CT_ThemeableLineStyle ;if _ceee {_dgbg =_ggcg .Bottom ;}else {_dgbg =_ggcg .InsideH ;};if _dgbg !=nil {_gbda .LnB =_dgbg .Ln ;};};};return _gbda ;};const (FontStyle_Regular FontStyle =0;FontStyle_Bold FontStyle =1;FontStyle_Italic FontStyle =2;FontStyle_BoldItalic FontStyle =3;);func (_bddc *convertContext )makePdfImageFromBlipFill (_cgc *_cd .CT_BlipFillProperties )(*_gg .Image ,[]*_cd .CT_BlipChoice ,error ){if _cgeb :=_cgc .Blip ;_cgeb !=nil {if _gdea :=_cgeb .EmbedAttr ;_gdea !=nil {_bfdb ,_ddbb :=_bddc ._fada .GetImageByRelID (*_gdea );if _ddbb {_beed ,_ggg :=_fdf .Open (_bfdb .Path ());if _ggg !=nil {_ba .Log .Debug ("\u0046\u0069\u006c\u0065 o\u0070\u0065\u006e\u0020\u0065\u0072\u0072\u006f\u0072\u003a\u0020\u0025\u0073",_ggg );return nil ,nil ,_ggg ;};defer _beed .Close ();_dafeg ,_ ,_ggg :=_b .Decode (_beed );if _ggg !=nil {_ba .Log .Debug ("\u0044\u0065\u0063\u006fde\u0020\u0069\u006d\u0061\u0067\u0065\u0020\u0065\u0072\u0072\u006f\u0072\u003a\u0020%\u0073",_ggg );return nil ,nil ,_ggg ;};if _eae :=_cgc .SrcRect ;_eae !=nil {_bca :=_dafeg .Bounds ().Size ();_gacg :=_bca .X ;_abec :=_bca .Y ;var _afba ,_aeed ,_adefb ,_gbef int ;var _ceff bool ;if _ecac :=_eae .LAttr ;_ecac !=nil {_afba =int (float64 (_gacg )*_fg .FromSTPercentage (_ecac ));_ceff =true ;}else {_afba =0;};if _fcda :=_eae .TAttr ;_fcda !=nil {_adefb =int (float64 (_abec )*_fg .FromSTPercentage (_fcda ));_ceff =true ;}else {_adefb =0;};if _fdba :=_eae .RAttr ;_fdba !=nil {_aeed =int (float64 (_gacg )*(1-_fg .FromSTPercentage (_fdba )));_ceff =true ;}else {_aeed =_gacg ;};if _ddcc :=_eae .BAttr ;_ddcc !=nil {_gbef =int (float64 (_abec )*(1-_fg .FromSTPercentage (_ddcc )));_ceff =true ;}else {_gbef =_abec ;};if _ceff {_dafeg =_fg .CropImageByRect (_dafeg ,_b .Rect (_afba ,_adefb ,_aeed +1,_gbef +1));};};_ggda ,_ggg :=_bddc ._eceg .NewImageFromGoImage (_dafeg );if _ggg !=nil {_ba .Log .Debug ("\u0043\u0061\u006e\u006e\u006ft\u0020\u0063\u0072\u0065\u0061\u0074\u0065\u0020\u0050\u0044\u0046\u0020\u0069m\u0061\u0067\u0065\u0020\u0066\u0072\u006f\u006d\u0020\u0047\u006f\u0020\u0069\u006d\u0061\u0067\u0065\u003a\u0020\u0025\u0073",_ggg );return nil ,nil ,_ggg ;};return _ggda ,_cgeb .Choice ,nil ;};};};return nil ,nil ,nil ;};func (_bc *convertContext )tileImage (_be *_gg .Image ,_efe *_cd .CT_TileInfoProperties ,_cga ,_fca float64 )*_gg .Image {_caf ,_bgf :=1.0,1.0;if _dcf :=_efe .SxAttr ;_dcf !=nil {_caf =_fg .FromSTPercentage (_dcf );};if _gbf :=_efe .SyAttr ;_gbf !=nil {_bgf =_fg .FromSTPercentage (_gbf );};_cde :=_fg .MakeTempCreator (_cga ,_fca );_be .Scale (_caf ,_bgf );_fafc ,_bfe :=_be .Width (),_be .Height ();var _afg ,_dg float64 ;if _dgd :=_efe .TxAttr ;_dgd !=nil {_afg =_d .FromEMU (_fg .FromSTCoordinate (*_dgd ));};if _adba :=_efe .TyAttr ;_adba !=nil {_dg =_d .FromEMU (_fg .FromSTCoordinate (*_adba ));};if _afg > 0{_afg -=_fafc ;};if _dg > 0{_dg -=_bfe ;};_bge :=_bc ._gca /_fafc +1;_ccg :=_bc ._efff /_bfe +1;for _dcb :=0.0;_dcb <=_bge ;_dcb ++{_afa :=_dcb *_fafc ;for _bfef :=0.0;_bfef <=_ccg ;_bfef ++{_ece :=_bfef *_bfe ;_be .SetPos (_afa +_afg ,_ece +_dg );_cde .Draw (_be );};};_gcc ,_gffb :=_fg .GetPageFromCreator (_cde );if _gffb !=nil {_ba .Log .Debug ("\u0043\u0061\u006e\u006e\u006f\u0074 \u0067\u0065\u0074\u0020\u0069\u006d\u0061\u0067\u0065\u0020\u0066\u0072\u006fm\u0020\u0063\u0072\u0065\u0061\u0074\u006fr\u003a\u0020\u0025\u0073",_gffb );return nil ;};_afb ,_gffb :=_ceb .NewImageDevice ().Render (_gcc );if _gffb !=nil {_ba .Log .Debug ("\u0043\u0061\u006eno\u0074\u0020\u0072\u0065\u006e\u0064\u0065\u0072\u0020\u0069\u006d\u0061\u0067\u0065\u003a\u0020\u0025\u0073",_gffb );return nil ;};_dca ,_gffb :=_bc ._eceg .NewImageFromGoImage (_afb );if _gffb !=nil {_ba .Log .Debug ("\u0043\u0061nn\u006f\u0074\u0020c\u0072\u0065\u0061\u0074e i\u006dag\u0065\u0020\u0066\u0072\u006f\u006d\u0020Go\u0049\u006d\u0061\u0067\u0065\u003a\u0020%\u0073",_gffb );return nil ;};return _dca ;};func (_bafc *textboxContext )alignParagraphsVertically (_fbf _cd .ST_TextAnchoringType ){if _fbf ==_cd .ST_TextAnchoringTypeT {return ;};_facd :=0.0;for _ ,_dcea :=range _bafc ._fgg {_facd +=_dcea ._dda +_dcea ._fba +_dcea ._bac ;};var _dbge float64 ;switch _fbf {case _cd .ST_TextAnchoringTypeCtr :_dbge =(_bafc ._fdca -_facd )/2;case _cd .ST_TextAnchoringTypeB :_dbge =_bafc ._fdca -_facd ;};for _ ,_fcaa :=range _bafc ._fgg {_fcaa ._ggdd +=_dbge ;};};type line struct{_ebdd float64 ;_ebbbb float64 ;_edad float64 ;_caa float64 ;_gbag float64 ;_beeb []*word ;};func (_cca *convertContext )stretchImage (_fbe *_gg .Image ,_aaf *_cd .CT_StretchInfoProperties ,_aec ,_bcf ,_cgd ,_fff float64 )(*_gg .Image ,float64 ,float64 ){_fge :=_aaf .FillRect ;if _fge ==nil {_gccc :=_fbe .Width ()/_fbe .Height ();_ggb :=_cgd /_fff ;var _cf ,_efg float64 ;if _gccc > _ggb {_efg =_fff ;_cf =_fff *_gccc ;}else {_cf =_cgd ;_efg =_cgd /_gccc ;};_fbe .Scale (_cf /_fbe .Width (),_efg /_fbe .Height ());return _fbe ,_aec ,_bcf ;};var _abc ,_acg ,_dbd ,_fae float64 ;if _eag :=_fge .LAttr ;_eag !=nil {_dbd =_fg .FromSTPercentage (_eag );};if _fcf :=_fge .TAttr ;_fcf !=nil {_abc =_fg .FromSTPercentage (_fcf );};if _bbcc :=_fge .RAttr ;_bbcc !=nil {_fae =_fg .FromSTPercentage (_bbcc );};if _bfd :=_fge .BAttr ;_bfd !=nil {_acg =_fg .FromSTPercentage (_bfd );};_ebb :=_cgd *(1-_dbd -_fae );_ede :=_fff *(1-_abc -_acg );_fbe .Scale (_ebb /_fbe .Width (),_ede /_fbe .Height ());return _fbe ,_aec +_dbd *_cgd ,_bcf +_abc *_fff ;};type symbol struct{_gadc string ;_adg float64 ;_dgbc float64 ;_gfec float64 ;_eca float64 ;_gead float64 ;_affc *_gg .TextStyle ;_afgc string ;_fdgb bool ;_fda bool ;_fbb bool ;};func (_fddg *convertContext )getShapeFromBlipFill (_cabc *_cd .CT_BlipFillProperties ,_ecbaa ,_ffg ,_bfde ,_fdcf float64 )_gg .Drawable {_cbeg ,_cggg ,_dbbab :=_fddg .makePdfImageFromBlipFill (_cabc );if _dbbab !=nil {_ba .Log .Debug ("\u0043\u0061\u006e\u006e\u006f\u0074\u0020\u006d\u0061\u006b\u0065\u0020\u0050D\u0046\u0020\u0069\u006d\u0061\u0067e\u0020\u0066\u0072\u006f\u006d\u0020\u0042\u006c\u0069\u0070\u0046\u0069\u006cl\u003a\u0020\u0025\u0073",_dbbab );return nil ;};if _cbeg ==nil {return nil ;};if _cgaf :=_cabc .Tile ;_cgaf !=nil {_cbeg =_fddg .tileImage (_cbeg ,_cabc .Tile ,_bfde ,_fdcf );};if _ebab :=_cabc .Stretch ;_ebab !=nil {_cbeg ,_ecbaa ,_ffg =_fddg .stretchImage (_cbeg ,_cabc .Stretch ,_ecbaa ,_ffg ,_bfde ,_fdcf );};if len (_cggg )==0{_cbeg .SetPos (_ecbaa ,_ffg );return _cbeg ;};_cbeg =_fddg .applyBlipEffectsOnImg (_cbeg ,_ecbaa ,_ffg ,_cggg );_cbeg .SetPos (_ecbaa ,_ffg );return _cbeg ;};func _gbeb (_ffdg ,_faeg *_cd .CT_TextBody )(*_cd .CT_TextBodyProperties ,*_cd .CT_TextListStyle ){if _ffdg ==nil &&_faeg ==nil {return nil ,nil ;};if _ffdg ==nil {return _faeg .BodyPr ,_faeg .LstStyle ;};if _faeg ==nil {return _ffdg .BodyPr ,_ffdg .LstStyle ;};_addf ,_ebdg :=_ffdg .BodyPr ,_ffdg .LstStyle ;_cacf ,_gacgb :=_faeg .BodyPr ,_faeg .LstStyle ;_gadg :=_afcf (_addf ,_cacf );_abb :=_dbgb (_ebdg ,_gacgb );return _gadg ,_abb ;};type convertContext struct{_eceg *_gg .Creator ;_ffea *_fg .Rectangle ;_aea *_ce .Presentation ;_fada *_ce .Slide ;_gbfe *_e .SldMaster ;_gdad *_e .SldLayout ;_efff float64 ;_gca float64 ;_dgfd []_gg .Drawable ;_fdfg *background ;_bcgc *_cd .CT_TextParagraphProperties ;_bfa *_cd .CT_TextCharacterProperties ;_gdga *_cd .CT_TextParagraphProperties ;_cbcf *_cd .CT_TextCharacterProperties ;_gdd *_cd .CT_TextParagraphProperties ;_befb *_cd .CT_TextCharacterProperties ;_efcc []*_cd .CT_TextParagraphProperties ;_bed []*_cd .CT_TextParagraphProperties ;_eggd []*_cd .CT_TextParagraphProperties ;_dcac *_cd .Theme ;_gaga *_cd .CT_ColorMappingOverride ;};

// RegisterFontsFromDirectory registers all fonts from the given directory automatically detecting font families and styles.
func RegisterFontsFromDirectory (dirName string )error {return _fg .RegisterFontsFromDirectory (dirName )};func _cagc (_gcbed ,_daad *_cd .CT_TableStyleTextStyle )*_cd .CT_TableStyleTextStyle {_faa :=_cd .NewCT_TableStyleTextStyle ();if _gcbed !=nil {*_faa =*_gcbed ;};if _daad ==nil {return _faa ;};if _faa .BAttr ==_cd .ST_OnOffStyleTypeUnset {_faa .BAttr =_daad .BAttr ;};if _faa .IAttr ==_cd .ST_OnOffStyleTypeUnset {_faa .IAttr =_daad .IAttr ;};if _faa .Font ==nil {_faa .Font =_daad .Font ;};if _faa .FontRef ==nil {_faa .FontRef =_daad .FontRef ;};if _faa .ScrgbClr ==nil {_faa .ScrgbClr =_daad .ScrgbClr ;};if _faa .SrgbClr ==nil {_faa .SrgbClr =_daad .SrgbClr ;};if _faa .HslClr ==nil {_faa .HslClr =_daad .HslClr ;};if _faa .SysClr ==nil {_faa .SysClr =_daad .SysClr ;};if _faa .SchemeClr ==nil {_faa .SchemeClr =_daad .SchemeClr ;};if _faa .PrstClr ==nil {_faa .PrstClr =_daad .PrstClr ;};return _faa ;};func (_cbb *textboxContext )newLine (){if _cbb ._edce ==nil {_cbb .newParagraph ();};_gdee :=_cbb ._edce ._fba +_cbb ._edce ._dda ;_cfbf :=&line {};_cfbf ._ebbbb =_cbb ._edce ._gea ;if len (_cbb ._edce ._fde )==0{_cfbf ._ebbbb +=_cbb ._edce ._gaa ;};_cfbf ._edad =_cbb ._edce ._afdd ;_cfbf ._caa =_cfbf ._ebbbb ;_cfbf ._ebdd =_gdee ;_cbb ._edce ._fde =append (_cbb ._edce ._fde ,_cfbf );_cbb ._gcbg =_cfbf ;};var _fdae =map[string ]int32 {"\u0076":9830,"\u00d8":8594,"\u00fc":8730};func (_faddc *textboxContext )addPrefix (_cffg *prefixData ,_edcf *_gg .TextStyle ){_fgdg :=_ceg (_cffg ._adcg );_edg :=*_edcf ;if _cffg ._dbff {_edg .Font =_fg .AssignStdFontByName (_edg ,"\u0053\u0079\u006d\u0062\u006f\u006c");};for _ ,_babc :=range _fgdg {_babc ._affc =&_edg ;_faddc .addTextSymbol (_babc );};_egb :=-(_cffg ._cfb +_faddc ._dga ._babf );if _egb < 0{_egb =0;};_ged :=&symbol {_gadc :"\u0020",_gead :_egb };_faddc .addTextSymbol (_ged );_faddc ._dga ._gdfc +=(_cffg ._cfb +_cffg ._fdcg );};

// ConvertToPdf converts a presentation to a PDF file. This package is beta, breaking changes can take place.
func ConvertToPdf (pr *_ce .Presentation )*_gg .Creator {_fc :=pr .X ().SldSz ;_eb :=_d .FromEMU (int64 (_fc .CxAttr ));_ebc :=_d .FromEMU (int64 (_fc .CyAttr ));_de :=_gg .PageSize {_eb ,_ebc };_efc :=_gg .New ();_efc .SetPageSize (_de );var _ed *_cd .Theme ;if len (pr .Themes ())> 0{_ed =pr .Themes ()[0];};for _ ,_dd :=range pr .Slides (){if _dd .X ()==nil {continue ;};_ad :=&convertContext {_eceg :_efc ,_fada :&_dd ,_gdad :_dd .GetSlideLayout (),_gbfe :pr .SlideMasters ()[0].X (),_aea :pr ,_dcac :_ed ,_gaga :_dd .X ().ClrMapOvr ,_efff :_de [1],_gca :_de [0]};_ad ._gdad =_dd .GetSlideLayout ();_ad .extractDefaultProperties ();_ad .makeSlide ();_ad .drawSlide ();};return _efc ;};func _dac (_gcadg *_cd .CT_AdjPoint2D )(float64 ,float64 ){var _gfaf ,_eebeb float64 ;_edgb ,_fdgd :=_gcadg .XAttr ,_gcadg .YAttr ;if _afgg :=_edgb .ST_Coordinate ;_afgg !=nil {_gfaf =_d .FromEMU (_fg .FromSTCoordinate (*_afgg ));};if _eegea :=_fdgd .ST_Coordinate ;_eegea !=nil {_eebeb =_d .FromEMU (_fg .FromSTCoordinate (*_eegea ));};return _gfaf ,_eebeb ;};func (_efaeb *convertContext )addCellToTable (_gccaa *_gg .Table ,_bbbc *_cd .CT_TableCell ,_add *_cd .CT_TablePartStyle ,_cdbb float64 ,_cac ,_eadg ,_gbac ,_geca bool )float64 {var _gdcc *_gg .TableCell ;_gdb :=1;if _bbbc .GridSpanAttr !=nil {_gdb =int (*_bbbc .GridSpanAttr );};_gdcc =_gccaa .MultiColCell (_gdb );_bbgc :=_bbbc .TcPr ;var _feaf *_cd .CT_TableStyleTextStyle ;if _add !=nil {_bbgc =_gceg (_bbgc ,_add .TcStyle ,_cac ,_eadg ,_gbac ,_geca );_feaf =_add .TcTxStyle ;};_bae :=_ca ;_abg :=_gg .CellVerticalAlignmentMiddle ;if _bbgc !=nil {if _egg :=_bbgc .LnL ;_egg !=nil {_aeda ,_efde ,_gcb :=_efaeb .getBorderStyle (_egg );_gdcc .SetBorder (_gg .CellBorderSideLeft ,_aeda ,_gcb );if _efde !=nil &&*_efde !=nil {_gdcc .SetSideBorderColor (_gg .CellBorderSideLeft ,*_efde );};};if _gdae :=_bbgc .LnT ;_gdae !=nil {_gfd ,_dedf ,_agcc :=_efaeb .getBorderStyle (_gdae );_gdcc .SetBorder (_gg .CellBorderSideTop ,_gfd ,_agcc );if _dedf !=nil &&*_dedf !=nil {_gdcc .SetSideBorderColor (_gg .CellBorderSideTop ,*_dedf );};};if _edea :=_bbgc .LnR ;_edea !=nil {_gdfa ,_faca ,_aefg :=_efaeb .getBorderStyle (_edea );_gdcc .SetBorder (_gg .CellBorderSideRight ,_gdfa ,_aefg );if _faca !=nil &&*_faca !=nil {_gdcc .SetSideBorderColor (_gg .CellBorderSideRight ,*_faca );};};if _aggg :=_bbgc .LnB ;_aggg !=nil {_cfa ,_bgc ,_cggb :=_efaeb .getBorderStyle (_aggg );_gdcc .SetBorder (_gg .CellBorderSideBottom ,_cfa ,_cggb );if _bgc !=nil &&*_bgc !=nil {_gdcc .SetSideBorderColor (_gg .CellBorderSideBottom ,*_bgc );};};if _gebc :=_bbgc .MarLAttr ;_gebc !=nil {_bae =float64 (_fg .FromSTCoordinate32 (*_gebc ));};switch _bbgc .AnchorAttr {case _cd .ST_TextAnchoringTypeT :_abg =_gg .CellVerticalAlignmentTop ;case _cd .ST_TextAnchoringTypeB :_abg =_gg .CellVerticalAlignmentBottom ;};if _bbgc .NoFill ==nil {if _adcf :=_bbgc .SolidFill ;_adcf !=nil {_bef ,_ :=_efaeb .getColorFromSolidFill (_adcf );_gdcc .SetBackgroundColor (_bef );};};};_gdcc .SetVerticalAlignment (_abg );_gdcc .SetIndent (_bae );var _gee float64 ;if _dgcb :=_bbbc .TxBody ;_dgcb !=nil {_afcb :=_efaeb .makePdfDivisionFromTxBody (_dgcb ,_cdbb ,_gee ,_feaf );_gee =_afcb .Height ();_gdcc .SetContent (_afcb );};return _gee ;};func (_dbde *textboxContext )alignVertically (_eddd _cd .ST_TextAnchoringType ){_dbde .alignParagraphsVertically (_eddd );_dbde .alignSymbolsVertically ();};func _ddfe (_fbab *_cd .CT_TextCharacterProperties ,_bfgaa *_cd .CT_TableStyleTextStyle )*_cd .CT_TextCharacterProperties {_ddca :=_cd .NewCT_TextCharacterProperties ();if _fbab !=nil {*_ddca =*_fbab ;};if _bfgaa ==nil {return _ddca ;};if _ddca .BAttr ==nil &&_bfgaa .BAttr !=_cd .ST_OnOffStyleTypeUnset {_fdgbf :=_bfgaa .BAttr ==_cd .ST_OnOffStyleTypeOn ;_ddca .BAttr =&_fdgbf ;};if _ddca .IAttr ==nil &&_bfgaa .IAttr !=_cd .ST_OnOffStyleTypeUnset {_gagcf :=_bfgaa .IAttr ==_cd .ST_OnOffStyleTypeOn ;_ddca .IAttr =&_gagcf ;};if _ddca .NoFill ==nil &&_ddca .SolidFill ==nil {_ddca .SolidFill =_cd .NewCT_SolidColorFillProperties ();_ddca .SolidFill .ScrgbClr =_bfgaa .ScrgbClr ;_ddca .SolidFill .SrgbClr =_bfgaa .SrgbClr ;_ddca .SolidFill .HslClr =_bfgaa .HslClr ;_ddca .SolidFill .SysClr =_bfgaa .SysClr ;_ddca .SolidFill .SchemeClr =_bfgaa .SchemeClr ;_ddca .SolidFill .PrstClr =_bfgaa .PrstClr ;};if _ffefc :=_bfgaa .Font ;_ffefc !=nil &&_ddca .Latin ==nil &&_ddca .Ea ==nil &&_ddca .Cs ==nil {_ddca .Latin =_ffefc .Latin ;_ddca .Ea =_ffefc .Ea ;_ddca .Cs =_ffefc .Cs ;};return _ddca ;};func (_ae *convertContext )extractDefaultProperties (){_ec :=_ae ._aea .X ();_ac :=_ec .DefaultTextStyle ;var _adc ,_ded ,_gaf ,_ff ,_dfc ,_acd ,_fgd ,_cdb ,_gb ,_dec *_cd .CT_TextParagraphProperties ;if _ac !=nil {_adc =_ac .DefPPr ;_ded =_eecc (_ac .Lvl1pPr ,_adc );_gaf =_eecc (_ac .Lvl2pPr ,_adc );_ff =_eecc (_ac .Lvl3pPr ,_adc );_dfc =_eecc (_ac .Lvl4pPr ,_adc );_acd =_eecc (_ac .Lvl5pPr ,_adc );_fgd =_eecc (_ac .Lvl6pPr ,_adc );_cdb =_eecc (_ac .Lvl7pPr ,_adc );_gb =_eecc (_ac .Lvl8pPr ,_adc );_dec =_eecc (_ac .Lvl9pPr ,_adc );_ae ._bcgc =_adc ;_ae ._bfa =_adc .DefRPr ;};_ae ._efcc =make ([]*_cd .CT_TextParagraphProperties ,9);_ae ._efcc [0]=_ded ;_ae ._efcc [1]=_gaf ;_ae ._efcc [2]=_ff ;_ae ._efcc [3]=_dfc ;_ae ._efcc [4]=_acd ;_ae ._efcc [5]=_fgd ;_ae ._efcc [6]=_cdb ;_ae ._efcc [7]=_gb ;_ae ._efcc [8]=_dec ;_bdd :=_ae ._aea .SlideMasters ()[0].X ();_gd :=_bdd .TxStyles ;_adb :=_gd .TitleStyle ;_ae ._gdga =_eecc (_adb .DefPPr ,_adc );_ae ._cbcf =_ae ._gdga .DefRPr ;_ae ._bed =make ([]*_cd .CT_TextParagraphProperties ,9);_ae ._bed [0]=_eecc (_adb .Lvl1pPr ,_ded );_ae ._bed [1]=_eecc (_adb .Lvl2pPr ,_gaf );_ae ._bed [2]=_eecc (_adb .Lvl3pPr ,_ff );_ae ._bed [3]=_eecc (_adb .Lvl4pPr ,_dfc );_ae ._bed [4]=_eecc (_adb .Lvl5pPr ,_acd );_ae ._bed [5]=_eecc (_adb .Lvl6pPr ,_fgd );_ae ._bed [6]=_eecc (_adb .Lvl7pPr ,_cdb );_ae ._bed [7]=_eecc (_adb .Lvl8pPr ,_gb );_ae ._bed [8]=_eecc (_adb .Lvl9pPr ,_dec );_cebf :=_gd .BodyStyle ;_ae ._gdd =_eecc (_cebf .DefPPr ,_adc );_ae ._befb =_ae ._gdd .DefRPr ;_ae ._eggd =make ([]*_cd .CT_TextParagraphProperties ,9);_ae ._eggd [0]=_eecc (_cebf .Lvl1pPr ,_ded );_ae ._eggd [1]=_eecc (_cebf .Lvl2pPr ,_gaf );_ae ._eggd [2]=_eecc (_cebf .Lvl3pPr ,_ff );_ae ._eggd [3]=_eecc (_cebf .Lvl4pPr ,_dfc );_ae ._eggd [4]=_eecc (_cebf .Lvl5pPr ,_acd );_ae ._eggd [5]=_eecc (_cebf .Lvl6pPr ,_fgd );_ae ._eggd [6]=_eecc (_cebf .Lvl7pPr ,_cdb );_ae ._eggd [7]=_eecc (_cebf .Lvl8pPr ,_gb );_ae ._eggd [8]=_eecc (_cebf .Lvl9pPr ,_dec );};func _dbgb (_dggd ,_dea *_cd .CT_TextListStyle )*_cd .CT_TextListStyle {_afgbb :=_cd .NewCT_TextListStyle ();if _dggd !=nil {*_afgbb =*_dggd ;};if _dea ==nil {return _afgbb ;};_afgbb .DefPPr =_eecc (_afgbb .DefPPr ,_dea .DefPPr );_afgbb .Lvl1pPr =_eecc (_afgbb .Lvl1pPr ,_dea .Lvl1pPr );_afgbb .Lvl2pPr =_eecc (_afgbb .Lvl2pPr ,_dea .Lvl2pPr );_afgbb .Lvl3pPr =_eecc (_afgbb .Lvl3pPr ,_dea .Lvl3pPr );_afgbb .Lvl4pPr =_eecc (_afgbb .Lvl4pPr ,_dea .Lvl4pPr );_afgbb .Lvl5pPr =_eecc (_afgbb .Lvl5pPr ,_dea .Lvl5pPr );_afgbb .Lvl6pPr =_eecc (_afgbb .Lvl6pPr ,_dea .Lvl6pPr );_afgbb .Lvl7pPr =_eecc (_afgbb .Lvl7pPr ,_dea .Lvl7pPr );_afgbb .Lvl8pPr =_eecc (_afgbb .Lvl8pPr ,_dea .Lvl8pPr );_afgbb .Lvl9pPr =_eecc (_afgbb .Lvl9pPr ,_dea .Lvl9pPr );return _afgbb ;};func _bfgc (_gbgg ,_edbd *_cd .CT_TextCharacterProperties )*_cd .CT_TextCharacterProperties {_adab :=_cd .NewCT_TextCharacterProperties ();if _gbgg !=nil {*_adab =*_gbgg ;};if _edbd ==nil {return _adab ;};if _adab .KumimojiAttr ==nil {_adab .KumimojiAttr =_edbd .KumimojiAttr ;};if _adab .LangAttr ==nil {_adab .LangAttr =_edbd .LangAttr ;};if _adab .AltLangAttr ==nil {_adab .AltLangAttr =_edbd .AltLangAttr ;};if _adab .SzAttr ==nil {_adab .SzAttr =_edbd .SzAttr ;};if _adab .BAttr ==nil {_adab .BAttr =_edbd .BAttr ;};if _adab .IAttr ==nil {_adab .IAttr =_edbd .IAttr ;};if _adab .UAttr ==_cd .ST_TextUnderlineTypeUnset {_adab .UAttr =_edbd .UAttr ;};if _adab .StrikeAttr ==_cd .ST_TextStrikeTypeUnset {_adab .StrikeAttr =_edbd .StrikeAttr ;};if _adab .KernAttr ==nil {_adab .KernAttr =_edbd .KernAttr ;};if _adab .CapAttr ==_cd .ST_TextCapsTypeUnset {_adab .CapAttr =_edbd .CapAttr ;};if _adab .SpcAttr ==nil {_adab .SpcAttr =_edbd .SpcAttr ;};if _adab .NormalizeHAttr ==nil {_adab .NormalizeHAttr =_edbd .NormalizeHAttr ;};if _adab .BaselineAttr ==nil {_adab .BaselineAttr =_edbd .BaselineAttr ;};if _adab .NoProofAttr ==nil {_adab .NoProofAttr =_edbd .NoProofAttr ;};if _adab .DirtyAttr ==nil {_adab .DirtyAttr =_edbd .DirtyAttr ;};if _adab .ErrAttr ==nil {_adab .ErrAttr =_edbd .ErrAttr ;};if _adab .SmtCleanAttr ==nil {_adab .SmtCleanAttr =_edbd .SmtCleanAttr ;};if _adab .SmtIdAttr ==nil {_adab .SmtIdAttr =_edbd .SmtIdAttr ;};if _adab .BmkAttr ==nil {_adab .BmkAttr =_edbd .BmkAttr ;};if _adab .Ln ==nil {_adab .Ln =_edbd .Ln ;};if _adab .NoFill ==nil {_adab .NoFill =_edbd .NoFill ;};if _adab .SolidFill ==nil {_adab .SolidFill =_edbd .SolidFill ;};if _adab .BlipFill ==nil {_adab .BlipFill =_edbd .BlipFill ;};if _adab .EffectLst ==nil {_adab .EffectLst =_edbd .EffectLst ;};if _adab .EffectDag ==nil {_adab .EffectDag =_edbd .EffectDag ;};if _adab .Highlight ==nil {_adab .Highlight =_edbd .Highlight ;};if _adab .ULnTx ==nil {_adab .ULnTx =_edbd .ULnTx ;};if _adab .ULn ==nil {_adab .ULn =_edbd .ULn ;};if _adab .UFillTx ==nil {_adab .UFillTx =_edbd .UFillTx ;};if _adab .UFill ==nil {_adab .UFill =_edbd .UFill ;};if _adab .Latin ==nil {_adab .Latin =_edbd .Latin ;};if _adab .Ea ==nil {_adab .Ea =_edbd .Ea ;};if _adab .Cs ==nil {_adab .Cs =_edbd .Cs ;};if _adab .Sym ==nil {_adab .Sym =_edbd .Sym ;};if _adab .Rtl ==nil {_adab .Rtl =_edbd .Rtl ;};return _adab ;};func (_abfb *convertContext )getInfoFromLn (_cfff *_cd .CT_LineProperties )(_gg .Color ,float64 ,float64 ){if _cfff ==nil ||_cfff .NoFill !=nil {return nil ,0,0;};var _facc float64 ;_dfg ,_dafea :=_abfb .getColorFromSolidFill (_cfff .SolidFill );if _dfcd :=_cfff .WAttr ;_dfcd !=nil {_facc =_d .FromEMU (int64 (*_dfcd ));}else {_facc =1;};return _dfg ,_facc ,_dafea ;};

// RegisterFont makes a PdfFont accessible for using in converting to PDF.
func RegisterFont (name string ,style FontStyle ,font *_bb .PdfFont ){_fg .RegisterFont (name ,style ,font );};func (_gef *textboxContext )newWord (){_gef ._dga =&word {_ebaf :true ,_gdfc :_gef ._gcbg ._caa }};

// FontStyle represents a kind of font styling. It can be FontStyle_Regular, FontStyle_Bold, FontStyle_Italic and FontStyle_BoldItalic.
type FontStyle =_fg .FontStyle ;func (_aeb *convertContext )getShapes (_gbd *_e .CT_Shape )[]_gg .Drawable {_bgfe :=[]_gg .Drawable {};_bcfb :=_gbd .SpPr ;if _bcfb ==nil {return _bgfe ;};var _dcc bool ;if _eced :=_gbd .UseBgFillAttr ;_eced !=nil {_dcc =*_eced ;};_dbg ,_fbeg ,_aed ,_gcca ,_afc ,_cce ,_dded :=_aeb .getShapesFromSpPr (_bcfb ,_gbd .Style ,_dcc );_bgfe =append (_bgfe ,_dbg ...);if _fdc :=_gbd .TxBody ;_fdc !=nil {_cad ,_bfb ,_efd ,_aafd ,_cadc :=_aeb .getPhData (_gbd );if _cad !=nil &&!_dded {_fbeg ,_aed ,_gcca ,_afc =_fg .GetDataFromXfrm (_cad );};_cgf ,_efgb :=_aeb .makePdfBlockFromTxBody (_fdc ,_bfb ,_efd ,_gcca ,_afc ,_cce ,_aafd ,_cadc );if _efgb !=nil {_ba .Log .Debug ("\u0043\u0061\u006e\u006e\u006f\u0074\u0020\u006d\u0061\u006b\u0065\u0020\u0050\u0044\u0046\u0020\u0062\u006c\u006f\u0063\u006b\u0020\u0066\u0072o\u006d\u0020\u0074\u0065\u0078t\u0062\u006fx\u003a\u0020\u0025\u0073",_efgb );}else if _cgf !=nil {_cgf .SetPos (_fbeg ,_aed );_bgfe =append (_bgfe ,_cgf );};};return _bgfe ;};func _fbgc (_fdgde *_e .CT_CommonSlideData ,_ebfb _e .ST_PlaceholderType ,_ffad *uint32 ,_ccfcb bool )(*_cd .CT_Transform2D ,*_cd .CT_TextBody ,*bool ,*bool ){if _fdgde !=nil &&(_ebfb !=_e .ST_PlaceholderTypeUnset ||!_ccfcb ){if _agee :=_fdgde .SpTree ;_agee !=nil {for _ ,_cega :=range _agee .Choice {if _cega !=nil {for _ ,_efffc :=range _cega .Sp {if _efffc !=nil {_eaee ,_gcbe :=_bce (_efffc );if _ebfb ==_eaee {if (_ccfcb &&_gcbe ==nil )||(!_ccfcb &&_gcbe !=nil &&*_gcbe ==*_ffad ){var _dceg *_cd .CT_Transform2D ;if _efffc .SpPr !=nil {_dceg =_efffc .SpPr .Xfrm ;};_adbd :=_ebfb ==_e .ST_PlaceholderTypeTitle ||_ebfb ==_e .ST_PlaceholderTypeCtrTitle ;_edge :=!_adbd &&_ebfb !=_e .ST_PlaceholderTypeUnset ;return _dceg ,_efffc .TxBody ,&_adbd ,&_edge ;};};};};};};};};return nil ,nil ,nil ,nil ;};