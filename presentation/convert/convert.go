//
// Copyright 2020 FoxyUtils ehf. All rights reserved.
//
// This is a commercial product and requires a license to operate.
// A trial license can be obtained at https://unidoc.io
//
// DO NOT EDIT: generated by unitwist Go source code obfuscator.
//
// Use of this source code is governed by the UniDoc End User License Agreement
// terms that can be accessed at https://unidoc.io/eula/

package convert ;import (_cb "bytes";_f "errors";_ae "github.com/unidoc/unioffice/common/logger";_de "github.com/unidoc/unioffice/common/tempstorage";_d "github.com/unidoc/unioffice/internal/convertutils";_e "github.com/unidoc/unioffice/measurement";_db "github.com/unidoc/unioffice/presentation";_aa "github.com/unidoc/unioffice/schema/soo/dml";_ag "github.com/unidoc/unioffice/schema/soo/dml/chart";_ffe "github.com/unidoc/unioffice/schema/soo/pml";_dea "github.com/unidoc/unipdf/v3/contentstream/draw";_cc "github.com/unidoc/unipdf/v3/creator";_dba "github.com/unidoc/unipdf/v3/model";_ff "github.com/unidoc/unipdf/v3/render";_g "image";_a "image/color";_ac "image/draw";_b "strconv";_gd "strings";);func (_ccge *textboxContext )newParagraph (){_gbff :=&paragraph {};_gbff ._geae =_ccge ._bae ;_ccge ._ccg =_gbff ;};

// FontStyle represents a kind of font styling. It can be FontStyle_Regular, FontStyle_Bold, FontStyle_Italic and FontStyle_BoldItalic.
type FontStyle =_d .FontStyle ;func (_bfac *convertContext )getColorFromMatrixReference (_fdgd *_aa .CT_StyleMatrixReference )_cc .Color {if _fdgd ==nil {return nil ;};var _cba _cc .Color ;var _acga string ;if _adgd :=_fdgd .SrgbClr ;_adgd !=nil {_acga =_adgd .ValAttr ;}else if _dfc :=_fdgd .SchemeClr ;_dfc !=nil {_acga =_d .GetColorStringFromDmlColor (_bfac ._acd .GetColorBySchemeColor (_dfc .ValAttr ));_acga =_d .AdjustColor (_acga ,_dfc .EG_ColorTransform );};if _acga !=""{_cba =_cc .ColorRGBFromHex ("\u0023"+_acga );};return _cba ;};func (_af *convertContext )extractDefaultProperties (){_gaa :=_af ._acd .X ();_ge :=_gaa .DefaultTextStyle ;var _df ,_bgc ,_fcc ,_gb ,_gg ,_ada ,_fe ,_cdf ,_ed ,_ec *_aa .CT_TextParagraphProperties ;if _ge !=nil {_df =_ge .DefPPr ;_bgc =_efeg (_ge .Lvl1pPr ,_df );_fcc =_efeg (_ge .Lvl2pPr ,_df );_gb =_efeg (_ge .Lvl3pPr ,_df );_gg =_efeg (_ge .Lvl4pPr ,_df );_ada =_efeg (_ge .Lvl5pPr ,_df );_fe =_efeg (_ge .Lvl6pPr ,_df );_cdf =_efeg (_ge .Lvl7pPr ,_df );_ed =_efeg (_ge .Lvl8pPr ,_df );_ec =_efeg (_ge .Lvl9pPr ,_df );_af ._cdce =_df ;_af ._aea =_df .DefRPr ;};_af ._ecd =make ([]*_aa .CT_TextParagraphProperties ,9);_af ._ecd [0]=_bgc ;_af ._ecd [1]=_fcc ;_af ._ecd [2]=_gb ;_af ._ecd [3]=_gg ;_af ._ecd [4]=_ada ;_af ._ecd [5]=_fe ;_af ._ecd [6]=_cdf ;_af ._ecd [7]=_ed ;_af ._ecd [8]=_ec ;_gda :=_af ._acd .SlideMasters ()[0].X ();_cce :=_gda .TxStyles ;_ggb :=_cce .TitleStyle ;_af ._fga =_efeg (_ggb .DefPPr ,_df );_af ._debc =_af ._fga .DefRPr ;_af ._fcb =make ([]*_aa .CT_TextParagraphProperties ,9);_af ._fcb [0]=_efeg (_ggb .Lvl1pPr ,_bgc );_af ._fcb [1]=_efeg (_ggb .Lvl2pPr ,_fcc );_af ._fcb [2]=_efeg (_ggb .Lvl3pPr ,_gb );_af ._fcb [3]=_efeg (_ggb .Lvl4pPr ,_gg );_af ._fcb [4]=_efeg (_ggb .Lvl5pPr ,_ada );_af ._fcb [5]=_efeg (_ggb .Lvl6pPr ,_fe );_af ._fcb [6]=_efeg (_ggb .Lvl7pPr ,_cdf );_af ._fcb [7]=_efeg (_ggb .Lvl8pPr ,_ed );_af ._fcb [8]=_efeg (_ggb .Lvl9pPr ,_ec );_dd :=_cce .BodyStyle ;_af ._dadb =_efeg (_dd .DefPPr ,_df );_af ._ggbd =_af ._dadb .DefRPr ;_af ._ccbe =make ([]*_aa .CT_TextParagraphProperties ,9);_af ._ccbe [0]=_efeg (_dd .Lvl1pPr ,_bgc );_af ._ccbe [1]=_efeg (_dd .Lvl2pPr ,_fcc );_af ._ccbe [2]=_efeg (_dd .Lvl3pPr ,_gb );_af ._ccbe [3]=_efeg (_dd .Lvl4pPr ,_gg );_af ._ccbe [4]=_efeg (_dd .Lvl5pPr ,_ada );_af ._ccbe [5]=_efeg (_dd .Lvl6pPr ,_fe );_af ._ccbe [6]=_efeg (_dd .Lvl7pPr ,_cdf );_af ._ccbe [7]=_efeg (_dd .Lvl8pPr ,_ed );_af ._ccbe [8]=_efeg (_dd .Lvl9pPr ,_ec );};func _agaf (_ddcc *_aa .CT_TextCharacterProperties ,_cbb *_aa .CT_TableStyleTextStyle )*_aa .CT_TextCharacterProperties {_fgac :=_aa .NewCT_TextCharacterProperties ();if _ddcc !=nil {*_fgac =*_ddcc ;};if _cbb ==nil {return _fgac ;};if _fgac .BAttr ==nil &&_cbb .BAttr !=_aa .ST_OnOffStyleTypeUnset {_acde :=_cbb .BAttr ==_aa .ST_OnOffStyleTypeOn ;_fgac .BAttr =&_acde ;};if _fgac .IAttr ==nil &&_cbb .IAttr !=_aa .ST_OnOffStyleTypeUnset {_fgda :=_cbb .IAttr ==_aa .ST_OnOffStyleTypeOn ;_fgac .IAttr =&_fgda ;};if _fgac .NoFill ==nil &&_fgac .SolidFill ==nil {_fgac .SolidFill =_aa .NewCT_SolidColorFillProperties ();_fgac .SolidFill .ScrgbClr =_cbb .ScrgbClr ;_fgac .SolidFill .SrgbClr =_cbb .SrgbClr ;_fgac .SolidFill .HslClr =_cbb .HslClr ;_fgac .SolidFill .SysClr =_cbb .SysClr ;_fgac .SolidFill .SchemeClr =_cbb .SchemeClr ;_fgac .SolidFill .PrstClr =_cbb .PrstClr ;};if _ggbg :=_cbb .Font ;_ggbg !=nil &&_fgac .Latin ==nil &&_fgac .Ea ==nil &&_fgac .Cs ==nil {_fgac .Latin =_ggbg .Latin ;_fgac .Ea =_ggbg .Ea ;_fgac .Cs =_ggbg .Cs ;};return _fgac ;};func (_dbba *convertContext )getStyleColors (_cfg *_aa .CT_ShapeStyle )(_cc .Color ,_cc .Color ,_cc .Color ){var _bdge ,_eggc ,_badc _cc .Color ;if _gcbb :=_cfg .LnRef ;_gcbb !=nil {_eggc =_dbba .getColorFromMatrixReference (_gcbb );};if _gfdd :=_cfg .FillRef ;_gfdd !=nil {_badc =_dbba .getColorFromMatrixReference (_gfdd );};if _dffd :=_cfg .FontRef ;_dffd !=nil {_bdge =_dbba .getColorFromFontReference (_dffd );};return _bdge ,_badc ,_eggc ;};func (_bge *convertContext )makePdfBlockFromTxBody (_dfa *_aa .CT_TextBody ,_caef *_aa .CT_TextBodyProperties ,_gddc *_aa .CT_TextListStyle ,_bfaa ,_ggf float64 ,_eaag _cc .Color ,_bged ,_bece bool )(*_cc .Block ,error ){var _feeb *_aa .CT_TextParagraphProperties ;if _agf :=_dfa .LstStyle ;_agf !=nil {var _ebg *_aa .CT_TextParagraphProperties ;if _agf .Lvl1pPr !=nil {_ebg =_agf .Lvl1pPr ;};_feeb =_efeg (_ebg ,_agf .DefPPr );};var _bcfg *_aa .CT_TextParagraphProperties ;if _feeb !=nil {if _bged {_bcfg =_bge ._fcb [0];}else if _bece {_bcfg =_bge ._ccbe [0];}else {_bcfg =_bge ._ecd [0];};if _gddc !=nil {_bcfg =_efeg (_efeg (_gddc .Lvl1pPr ,_gddc .DefPPr ),_bcfg );};_bcfg =_efeg (_feeb ,_bcfg );}else {if _bged {_bcfg =_bge ._fga ;}else if _bece {_bcfg =_bge ._dadb ;}else {_bcfg =_bge ._cdce ;};};_fbdc ,_bbac :=_edgc (2.5),_edgc (2.5);_dda ,_fba :=_edgc (1.3),_edgc (1.3);_abdc :=true ;_fbcb :=_aa .ST_TextAnchoringTypeT ;if _caef !=nil {if _ccc :=_caef .AnchorAttr ;_ccc !=_aa .ST_TextAnchoringTypeUnset {_fbcb =_ccc ;};};if _gea :=_dfa .BodyPr ;_gea !=nil {if _acag :=_gea .LInsAttr ;_acag !=nil {_fbdc =_e .FromEMU (_d .FromSTCoordinate32 (*_acag ));};if _fbf :=_gea .TInsAttr ;_fbf !=nil {_dda =_e .FromEMU (_d .FromSTCoordinate32 (*_fbf ));};if _bgec :=_gea .RInsAttr ;_bgec !=nil {_bbac =_e .FromEMU (_d .FromSTCoordinate32 (*_bgec ));};if _bbadc :=_gea .BInsAttr ;_bbadc !=nil {_fba =_e .FromEMU (_d .FromSTCoordinate32 (*_bbadc ));};_abdc =_gea .WrapAttr !=_aa .ST_TextWrappingTypeNone ;if _facg :=_gea .AnchorAttr ;_facg !=_aa .ST_TextAnchoringTypeUnset {_fbcb =_gea .AnchorAttr ;};};_aag :=_d .MakeTempCreator (_bfaa ,_ggf );_aag .SetPageMargins (_fbdc ,_bbac ,_dda ,_fba );_dga :=&textboxContext {_dfgb :_bge ,_gddd :_abdc ,_gggb :_bfaa -_fbdc -_bbac ,_gfgb :_ggf -_dda -_fba ,_bce :_aag ,_affa :[]*paragraph {}};_efad :=1;for _ ,_dec :=range _dfa .P {if _dec !=nil {_feg :=_dec .PPr ;var _fge *prefixData ;if _feg !=nil &&_feg .BuNone ==nil {var _gdb string ;var _dbea bool ;if _gad :=_feg .BuAutoNum ;_gad !=nil {var _bcd string ;if _eab :=_gad .StartAtAttr ;_eab !=nil {_efad =int (*_eab );};var _egg string ;switch _gad .TypeAttr {case _aa .ST_TextAutonumberSchemeAlphaUcParenBoth ,_aa .ST_TextAutonumberSchemeAlphaUcParenR ,_aa .ST_TextAutonumberSchemeAlphaUcPeriod :_egg =_cgae (_efad ,true );case _aa .ST_TextAutonumberSchemeAlphaLcParenBoth ,_aa .ST_TextAutonumberSchemeAlphaLcParenR ,_aa .ST_TextAutonumberSchemeAlphaLcPeriod :_egg =_cgae (_efad ,false );case _aa .ST_TextAutonumberSchemeRomanUcParenBoth ,_aa .ST_TextAutonumberSchemeRomanUcParenR ,_aa .ST_TextAutonumberSchemeRomanUcPeriod :_egg =_gbbg (_efad ,true );case _aa .ST_TextAutonumberSchemeRomanLcParenBoth ,_aa .ST_TextAutonumberSchemeRomanLcParenR ,_aa .ST_TextAutonumberSchemeRomanLcPeriod :_egg =_gbbg (_efad ,false );default:_egg =_b .Itoa (_efad );};switch _gad .TypeAttr {case _aa .ST_TextAutonumberSchemeAlphaLcPeriod ,_aa .ST_TextAutonumberSchemeAlphaUcPeriod ,_aa .ST_TextAutonumberSchemeArabicPeriod ,_aa .ST_TextAutonumberSchemeRomanLcPeriod ,_aa .ST_TextAutonumberSchemeRomanUcPeriod ,_aa .ST_TextAutonumberSchemeArabicDbPeriod ,_aa .ST_TextAutonumberSchemeEa1ChsPeriod ,_aa .ST_TextAutonumberSchemeEa1ChtPeriod ,_aa .ST_TextAutonumberSchemeEa1JpnChsDbPeriod ,_aa .ST_TextAutonumberSchemeEa1JpnKorPeriod ,_aa .ST_TextAutonumberSchemeThaiAlphaPeriod ,_aa .ST_TextAutonumberSchemeThaiNumPeriod ,_aa .ST_TextAutonumberSchemeHindiAlphaPeriod ,_aa .ST_TextAutonumberSchemeHindiNumPeriod ,_aa .ST_TextAutonumberSchemeHindiAlpha1Period :_bcd ="\u002e";case _aa .ST_TextAutonumberSchemeAlphaLcParenR ,_aa .ST_TextAutonumberSchemeAlphaUcParenR ,_aa .ST_TextAutonumberSchemeArabicParenR ,_aa .ST_TextAutonumberSchemeRomanLcParenR ,_aa .ST_TextAutonumberSchemeRomanUcParenR ,_aa .ST_TextAutonumberSchemeThaiAlphaParenR ,_aa .ST_TextAutonumberSchemeThaiNumParenR ,_aa .ST_TextAutonumberSchemeHindiNumParenR :_bcd ="\u0029";};_gdb =_egg +_bcd ;_efad ++;}else if _ecaa :=_feg .BuChar ;_ecaa !=nil {_bbg :=_ecaa .CharAttr ;if _ffc ,_deg :=_ced [_bbg ];_deg {_bbg =string (rune (_ffc ));}else {_bbg ="\u2022";};_gdb =_bbg ;_dbea =true ;};if _gdb !=""{var _fbbe ,_feda float64 ;if _feg .MarLAttr !=nil {_fbbe =_e .FromEMU (int64 (*_feg .MarLAttr ));};if _feg .IndentAttr !=nil {_feda =_e .FromEMU (int64 (*_feg .IndentAttr ));};_fge =&prefixData {_fcbd :_gdb ,_gcbf :_dbea ,_efe :_fbbe ,_cacb :_feda };};};_feg =_efeg (_feg ,_bcfg );_dbee :=_gggf (_dec .EndParaRPr ,_feg .DefRPr );_dga .newParagraph ();_dga .assignPropsToCurrentParagraph (_feg );_dga .newLine ();_dga .newWord ();for _ggfg ,_bccf :=range _dec .EG_TextRun {_dga .addTextRun (_bccf ,_dbee ,_eaag ,_fge );if _ggfg > 0{_fge =nil ;};};_dga .addCurrentWordToParagraph ();};_dga .addCurrentParagraph ();};_dga .alignVertically (_fbcb );_dga .drawParagraphs ();return _d .MakeBlockFromCreator (_aag );};var _ced =map[string ]int32 {"\u0076":9830,"\u00d8":8594,"\u00fc":8730};func _dfcd (_gbd *_aa .CT_AdjPoint2D )(float64 ,float64 ){var _gbaf ,_cgac float64 ;_afba ,_edae :=_gbd .XAttr ,_gbd .YAttr ;if _egaf :=_afba .ST_Coordinate ;_egaf !=nil {_gbaf =_e .FromEMU (_d .FromSTCoordinate (*_egaf ));};if _egga :=_edae .ST_Coordinate ;_egga !=nil {_cgac =_e .FromEMU (_d .FromSTCoordinate (*_egga ));};return _gbaf ,_cgac ;};type symbol struct{_cgd string ;_bfaac float64 ;_fdca float64 ;_ebc float64 ;_bgcg float64 ;_ggba float64 ;_baee *_cc .TextStyle ;_ffcb string ;_cecd bool ;_bac bool ;_cab bool ;};func (_edc *convertContext )drawSlide (){_edc ._bfge .NewPage ();for _ ,_edd :=range _edc ._dadf {if _edd !=nil {_edc ._bfge .MoveTo (0,0);_edc ._bfge .Draw (_edd );};};};type convertContext struct{_bfge *_cc .Creator ;_cdeg *_d .Rectangle ;_acd *_db .Presentation ;_fgd *_db .Slide ;_gage *_ffe .SldMaster ;_dcdc *_ffe .SldLayout ;_dcab float64 ;_gca float64 ;_dadf []_cc .Drawable ;_cfb *background ;_cdce *_aa .CT_TextParagraphProperties ;_aea *_aa .CT_TextCharacterProperties ;_fga *_aa .CT_TextParagraphProperties ;_debc *_aa .CT_TextCharacterProperties ;_dadb *_aa .CT_TextParagraphProperties ;_ggbd *_aa .CT_TextCharacterProperties ;_ecd []*_aa .CT_TextParagraphProperties ;_fcb []*_aa .CT_TextParagraphProperties ;_ccbe []*_aa .CT_TextParagraphProperties ;_dac *_aa .Theme ;_ceace *_aa .CT_ColorMappingOverride ;};func (_daeb *textboxContext )newWord (){_daeb ._fcce =&word {_dcfg :true ,_bdc :_daeb ._adcde ._bad }};type word struct{_gcb []*symbol ;_bdc float64 ;_dgbd float64 ;_dcfg bool ;};

// RegisterFontsFromDirectory registers all fonts from the given directory automatically detecting font families and styles.
func RegisterFontsFromDirectory (dirName string )error {return _d .RegisterFontsFromDirectory (dirName )};type textboxContext struct{_dfgb *convertContext ;_gggb float64 ;_gfgb float64 ;_bce *_cc .Creator ;_bae float64 ;_affa []*paragraph ;_ccg *paragraph ;_adcde *line ;_fcce *word ;_gddd bool ;};func _gggf (_aae ,_addb *_aa .CT_TextCharacterProperties )*_aa .CT_TextCharacterProperties {_cecdc :=_aa .NewCT_TextCharacterProperties ();if _aae !=nil {*_cecdc =*_aae ;};if _addb ==nil {return _cecdc ;};if _cecdc .KumimojiAttr ==nil {_cecdc .KumimojiAttr =_addb .KumimojiAttr ;};if _cecdc .LangAttr ==nil {_cecdc .LangAttr =_addb .LangAttr ;};if _cecdc .AltLangAttr ==nil {_cecdc .AltLangAttr =_addb .AltLangAttr ;};if _cecdc .SzAttr ==nil {_cecdc .SzAttr =_addb .SzAttr ;};if _cecdc .BAttr ==nil {_cecdc .BAttr =_addb .BAttr ;};if _cecdc .IAttr ==nil {_cecdc .IAttr =_addb .IAttr ;};if _cecdc .UAttr ==_aa .ST_TextUnderlineTypeUnset {_cecdc .UAttr =_addb .UAttr ;};if _cecdc .StrikeAttr ==_aa .ST_TextStrikeTypeUnset {_cecdc .StrikeAttr =_addb .StrikeAttr ;};if _cecdc .KernAttr ==nil {_cecdc .KernAttr =_addb .KernAttr ;};if _cecdc .CapAttr ==_aa .ST_TextCapsTypeUnset {_cecdc .CapAttr =_addb .CapAttr ;};if _cecdc .SpcAttr ==nil {_cecdc .SpcAttr =_addb .SpcAttr ;};if _cecdc .NormalizeHAttr ==nil {_cecdc .NormalizeHAttr =_addb .NormalizeHAttr ;};if _cecdc .BaselineAttr ==nil {_cecdc .BaselineAttr =_addb .BaselineAttr ;};if _cecdc .NoProofAttr ==nil {_cecdc .NoProofAttr =_addb .NoProofAttr ;};if _cecdc .DirtyAttr ==nil {_cecdc .DirtyAttr =_addb .DirtyAttr ;};if _cecdc .ErrAttr ==nil {_cecdc .ErrAttr =_addb .ErrAttr ;};if _cecdc .SmtCleanAttr ==nil {_cecdc .SmtCleanAttr =_addb .SmtCleanAttr ;};if _cecdc .SmtIdAttr ==nil {_cecdc .SmtIdAttr =_addb .SmtIdAttr ;};if _cecdc .BmkAttr ==nil {_cecdc .BmkAttr =_addb .BmkAttr ;};if _cecdc .Ln ==nil {_cecdc .Ln =_addb .Ln ;};if _cecdc .NoFill ==nil {_cecdc .NoFill =_addb .NoFill ;};if _cecdc .SolidFill ==nil {_cecdc .SolidFill =_addb .SolidFill ;};if _cecdc .BlipFill ==nil {_cecdc .BlipFill =_addb .BlipFill ;};if _cecdc .EffectLst ==nil {_cecdc .EffectLst =_addb .EffectLst ;};if _cecdc .EffectDag ==nil {_cecdc .EffectDag =_addb .EffectDag ;};if _cecdc .Highlight ==nil {_cecdc .Highlight =_addb .Highlight ;};if _cecdc .ULnTx ==nil {_cecdc .ULnTx =_addb .ULnTx ;};if _cecdc .ULn ==nil {_cecdc .ULn =_addb .ULn ;};if _cecdc .UFillTx ==nil {_cecdc .UFillTx =_addb .UFillTx ;};if _cecdc .UFill ==nil {_cecdc .UFill =_addb .UFill ;};if _cecdc .Latin ==nil {_cecdc .Latin =_addb .Latin ;};if _cecdc .Ea ==nil {_cecdc .Ea =_addb .Ea ;};if _cecdc .Cs ==nil {_cecdc .Cs =_addb .Cs ;};if _cecdc .Sym ==nil {_cecdc .Sym =_addb .Sym ;};if _cecdc .Rtl ==nil {_cecdc .Rtl =_addb .Rtl ;};return _cecdc ;};func (_cdc *convertContext )getShapesFromSpPr (_fdbf *_aa .CT_ShapeProperties ,_cea *_aa .CT_ShapeStyle ,_ceac bool )([]_cc .Drawable ,float64 ,float64 ,float64 ,float64 ,_cc .Color ,bool ){_gcdg :=[]_cc .Drawable {};var _gfge ,_fed ,_adc ,_egd ,_adcd float64 ;var _dbd ,_efgd ,_cgg ,_afb _cc .Color ;var _gdfa *_aa .CT_BlipFillProperties ;_aaac ,_aab :=1.0,1.0;if _cea !=nil {_dbd ,_efgd ,_afb =_cdc .getStyleColors (_cea );};if _gdd :=_fdbf .Ln ;_gdd !=nil {if _gdd .NoFill !=nil {_cgg ,_adcd =nil ,0;}else {_cgg ,_adcd ,_aaac =_cdc .getInfoFromLn (_gdd );if _cgg ==nil {_cgg =_afb ;};};};if _fdbf .NoFill !=nil {_efgd ,_aab =nil ,0;}else if _ceac {_efgd =_cdc ._cfb ._gagf ;_aab =_cdc ._cfb ._cbf ;_gdfa =_cdc ._cfb ._ggff ;}else if _fbg :=_fdbf .SolidFill ;_fbg !=nil {_efgd ,_aab =_cdc .getColorFromSolidFill (_fbg );};var _bee bool ;if _aebc :=_fdbf .Xfrm ;_aebc !=nil {_gfge ,_fed ,_adc ,_egd =_d .GetDataFromXfrm (_aebc );_bee =true ;};if _ffed :=_fdbf .CustGeom ;_ffed !=nil {_ede :=[]_dea .Point {};_gcf ,_ffec :=1.0,1.0;if _gbag :=_ffed .PathLst ;_gbag !=nil {for _ ,_acc :=range _gbag .Path {if _acc !=nil {if _ecaf :=_acc .WAttr ;_ecaf !=nil {_gcf =_adc /_e .FromEMU (*_ecaf );};if _ege :=_acc .HAttr ;_ege !=nil {_ffec =_egd /_e .FromEMU (*_ege );};for _ ,_fbdb :=range _acc .Close {if _fbdb !=nil {};};for _ ,_beg :=range _acc .MoveTo {if _beg !=nil &&_beg .Pt !=nil {_ceb ,_bbad :=_dfcd (_beg .Pt );_ede =append (_ede ,_dea .Point {X :_ceb *_gcf +_gfge ,Y :_bbad *_ffec +_fed });};};for _ ,_fgb :=range _acc .LnTo {if _fgb !=nil &&_fgb .Pt !=nil {_eea ,_ecea :=_dfcd (_fgb .Pt );_ede =append (_ede ,_dea .Point {X :_eea *_gcf +_gfge ,Y :_ecea *_ffec +_fed });};};_eba :=_cdc ._bfge .NewPolygon ([][]_dea .Point {_ede });_eba .SetFillColor (_efgd );_eba .SetFillOpacity (_aab );_eba .SetBorderWidth (_adcd );if _cgg !=nil {_eba .SetBorderColor (_cgg );_eba .SetBorderOpacity (_aaac );};_gcdg =append (_gcdg ,_eba );};};};};if _ceeg :=_fdbf .PrstGeom ;_ceeg !=nil {switch _ceeg .PrstAttr {case _aa .ST_ShapeTypeRect :if _gdfa !=nil {_ecba :=_cdc .getShapeFromBlipFill (_gdfa ,_gfge ,_fed ,_adc ,_egd );_gcdg =append (_gcdg ,_ecba );}else {_dfd :=_cdc ._bfge .NewRectangle (_gfge ,_fed ,_adc ,_egd );_dfd .SetFillColor (_efgd );_dfd .SetFillOpacity (_aab );_dfd .SetBorderWidth (_adcd );if _cgg !=nil {_dfd .SetBorderColor (_cgg );_dfd .SetBorderOpacity (_aaac );};_gcdg =append (_gcdg ,_dfd );};case _aa .ST_ShapeTypeLine :_ade :=_cdc ._bfge .NewLine (_gfge ,_fed ,_gfge +_adc ,_fed +_egd );_ade .SetLineWidth (_adcd );if _cgg !=nil {_ade .SetColor (_cgg );};_gcdg =append (_gcdg ,_ade );};};return _gcdg ,_gfge ,_fed ,_adc ,_egd ,_dbd ,_bee ;};func _gag (_bcb string )[]*symbol {_fged :=[]*symbol {};for _ ,_gdcg :=range _bcb {_fged =append (_fged ,&symbol {_cgd :string (_gdcg )});};return _fged ;};var _edga =[]romanMatch {romanMatch {1000,"\u006d"},romanMatch {900,"\u0063\u006d"},romanMatch {500,"\u0064"},romanMatch {400,"\u0063\u0064"},romanMatch {100,"\u0063"},romanMatch {90,"\u0078\u0063"},romanMatch {50,"\u006c"},romanMatch {40,"\u0078\u006c"},romanMatch {10,"\u0078"},romanMatch {9,"\u0069\u0078"},romanMatch {5,"\u0076"},romanMatch {4,"\u0069\u0076"},romanMatch {1,"\u0069"}};type symbolStyle struct{_dgbf *string ;_edcg *float64 ;_ebf *string ;_dadbg *bool ;_gde *bool ;_acff *bool ;_gadb *bool ;_fcfg *bool ;};func _edgc (_faeb float64 )float64 {return _faeb *_e .Millimeter };

// RegisterFont makes a PdfFont accessible for using in converting to PDF.
func RegisterFont (name string ,style FontStyle ,font *_dba .PdfFont ){_d .RegisterFont (name ,style ,font );};func (_cdgb *convertContext )getShapeFromBlipFill (_bdgf *_aa .CT_BlipFillProperties ,_ffgd ,_fdcae ,_aedg ,_agdf float64 )_cc .Drawable {_dfce ,_ffga ,_agbd :=_cdgb .makePdfImageFromBlipFill (_bdgf );if _agbd !=nil {_ae .Log .Debug ("\u0043\u0061\u006e\u006e\u006f\u0074\u0020\u006d\u0061\u006b\u0065\u0020\u0050D\u0046\u0020\u0069\u006d\u0061\u0067e\u0020\u0066\u0072\u006f\u006d\u0020\u0042\u006c\u0069\u0070\u0046\u0069\u006cl\u003a\u0020\u0025\u0073",_agbd );return nil ;};if _dfce ==nil {return nil ;};if _ffa :=_bdgf .Tile ;_ffa !=nil {_dfce =_cdgb .tileImage (_dfce ,_bdgf .Tile ,_aedg ,_agdf );};if _cbfc :=_bdgf .Stretch ;_cbfc !=nil {_dfce ,_ffgd ,_fdcae =_cdgb .stretchImage (_dfce ,_bdgf .Stretch ,_ffgd ,_fdcae ,_aedg ,_agdf );};if len (_ffga )==0{_dfce .SetPos (_ffgd ,_fdcae );return _dfce ;};_dfce =_cdgb .applyBlipEffectsOnImg (_dfce ,_ffgd ,_fdcae ,_ffga );_dfce .SetPos (_ffgd ,_fdcae );return _dfce ;};func (_ebdg *textboxContext )alignParagraph (){_gfae :=_ebdg ._ccg ;if _gfae ._aac ==_aa .ST_TextAlignTypeL {return ;};_edgf :=len (_gfae ._gfa )-1;for _ccdb ,_daca :=range _gfae ._gfa {_dbge :=true ;_geda :=len (_daca ._gfac );_efab :=0.0;for _egc :=len (_daca ._gfac )-1;_egc >=0;_egc --{_ebfc :=_daca ._gfac [_egc ];if _dbge &&_ebfc ._dcfg {_geda =_egc ;}else {_dbge =false ;for _ ,_bgfb :=range _ebfc ._gcb {_efab +=_bgfb ._ggba ;};};};_daca ._gfac =_daca ._gfac [:_geda ];_eag :=_daca ._gacf -_daca ._daeg -_efab ;switch _gfae ._aac {case _aa .ST_TextAlignTypeR :_daca .moveRight (_eag );case _aa .ST_TextAlignTypeCtr :_daca .moveRight (_eag /2);case _aa .ST_TextAlignTypeJust :if _ccdb !=_edgf {_bfee :=[]*word {};for _ ,_gbfg :=range _daca ._gfac {if _gbfg ._dcfg {_bfee =append (_bfee ,_gbfg );};};_afcb :=_eag /float64 (len (_bfee ));for _ ,_fcfba :=range _bfee {_fcfba ._dgbd +=_afcb ;};var _gfc *word ;for _ ,_ffcc :=range _daca ._gfac {if _gfc !=nil {_ffcc ._bdc =_gfc ._bdc +_gfc ._dgbd ;};_gfc =_ffcc ;};};};};};func (_gbgf *convertContext )makePdfDivisionFromTxBody (_fab *_aa .CT_TextBody ,_cbe ,_daf float64 ,_eef *_aa .CT_TableStyleTextStyle )*_cc .Division {_acb :=_gbgf ._bfge .NewDivision ();_gab :=_gbgf ._cdce ;_egfa :=_aa .ST_TextAnchoringTypeT ;if _bdb :=_fab .BodyPr ;_bdb !=nil {if _fbc :=_bdb .AnchorAttr ;_fbc !=_aa .ST_TextAnchoringTypeUnset {_egfa =_bdb .AnchorAttr ;};};if _fbgc :=_fab .LstStyle ;_fbgc !=nil {var _gabe *_aa .CT_TextParagraphProperties ;if _fbgc .Lvl1pPr !=nil {_gabe =_fbgc .Lvl1pPr ;}else {_gabe =_gbgf ._ecd [0];};_gab =_efeg (_gabe ,_efeg (_fbgc .DefPPr ,_gab ));};for _ ,_ged :=range _fab .P {if _ged !=nil {_aeg :=_gbgf ._bfge .NewStyledParagraph ();_fef :=_efeg (_ged .PPr ,_gab );_ecc :=_gggf (_ged .EndParaRPr ,_fef .DefRPr );if len (_ged .EG_TextRun )==0{_aeg .Append ("\u000a");_acb .Add (_aeg );continue ;};for _ ,_eaa :=range _ged .EG_TextRun {if _bcfa :=_eaa .Br ;_bcfa !=nil {_aeg .Append ("\u000a");}else if _cdfd :=_eaa .R ;_cdfd !=nil {_edb :=_agaf (_cdfd .RPr ,_eef );_edb =_gggf (_edb ,_ecc );var _cdg _cc .Color ;if _edb .SolidFill !=nil {_cdg ,_ =_gbgf .getColorFromSolidFill (_edb .SolidFill );}else {_cdg =_cc .ColorBlack ;};_bgf ,_eeb ,_cebf ,_ :=_gbgf .makeStyleFromRPr (_edb );_bgf .Color =_cdg ;if _eeb {_bgf .TextRise =0.5;}else if _cebf {_bgf .TextRise =-0.5;};_bbc :=_cdfd .T ;if _edb .CapAttr ==_aa .ST_TextCapsTypeAll {for _ ,_adf :=range _bbc {_adf =[]rune (_gd .ToUpper (string (_adf )))[0];};};_fca :=_aeg .Append (_bbc );_fca .Style =*_bgf ;};};_ =_egfa ;_acb .Add (_aeg );};};return _acb ;};type prefixData struct{_fcbd string ;_gcbf bool ;_efe float64 ;_cacb float64 ;};func (_fbd *convertContext )getShapes (_dgba *_ffe .CT_Shape )[]_cc .Drawable {_beae :=[]_cc .Drawable {};_bbd :=_dgba .SpPr ;if _bbd ==nil {return _beae ;};var _ecf bool ;if _bcgd :=_dgba .UseBgFillAttr ;_bcgd !=nil {_ecf =*_bcgd ;};_ebd ,_ccec ,_abcd ,_bba ,_dcb ,_ebb ,_ggg :=_fbd .getShapesFromSpPr (_bbd ,_dgba .Style ,_ecf );_beae =append (_beae ,_ebd ...);if _abcf :=_dgba .TxBody ;_abcf !=nil {_da ,_ebe ,_aeb ,_fdb ,_fccb :=_fbd .getPhData (_dgba );if _da !=nil &&!_ggg {_ccec ,_abcd ,_bba ,_dcb =_d .GetDataFromXfrm (_da );};_abdb ,_bdf :=_fbd .makePdfBlockFromTxBody (_abcf ,_ebe ,_aeb ,_bba ,_dcb ,_ebb ,_fdb ,_fccb );if _bdf !=nil {_ae .Log .Debug ("\u0043\u0061\u006e\u006e\u006f\u0074\u0020\u006d\u0061\u006b\u0065\u0020\u0050\u0044\u0046\u0020\u0062\u006c\u006f\u0063\u006b\u0020\u0066\u0072o\u006d\u0020\u0074\u0065\u0078t\u0062\u006fx\u003a\u0020\u0025\u0073",_bdf );}else if _abdb !=nil {_abdb .SetPos (_ccec ,_abcd );_beae =append (_beae ,_abdb );};};return _beae ;};func (_dcfc *textboxContext )addTextRun (_fefe *_aa .EG_TextRun ,_ffca *_aa .CT_TextCharacterProperties ,_bbgc _cc .Color ,_dcda *prefixData ){if _cgaee :=_fefe .Br ;_cgaee !=nil {_dcfc .addCurrentWordToParagraph ();_dcfc .newLine ();_dcfc .newWord ();}else if _bfe :=_fefe .R ;_bfe !=nil {var _dcbc _cc .Color ;if _bfe .RPr .SolidFill !=nil {_dcbc ,_ =_dcfc ._dfgb .getColorFromSolidFill (_bfe .RPr .SolidFill );}else if _bbgc !=nil {_dcbc =_bbgc ;}else if _ffca .SolidFill !=nil {_dcbc ,_ =_dcfc ._dfgb .getColorFromSolidFill (_ffca .SolidFill );}else {_dcbc =_cc .ColorBlack ;};_gdfad :=_gggf (_bfe .RPr ,_ffca );_dbdd ,_ebea ,_def ,_dgf :=_dcfc ._dfgb .makeStyleFromRPr (_gdfad );_dbdd .Color =_dcbc ;if _dcda !=nil {_dcfc .addPrefix (_dcda ,_dbdd );};_cabf :=_gag (_bfe .T );for _ ,_cgdc :=range _cabf {_cgdc ._baee =_dbdd ;_cgdc ._cecd =_ebea ;_cgdc ._bac =_def ;_cgdc ._cab =_dgf ;if _gdfad .CapAttr ==_aa .ST_TextCapsTypeAll {_cgdc ._cgd =_gd .ToUpper (_cgdc ._cgd );};_dcfc .addTextSymbol (_cgdc );};};};func _dbga (_egfg ,_abab *_aa .CT_TableStyleTextStyle )*_aa .CT_TableStyleTextStyle {_dbeg :=_aa .NewCT_TableStyleTextStyle ();if _egfg !=nil {*_dbeg =*_egfg ;};if _abab ==nil {return _dbeg ;};if _dbeg .BAttr ==_aa .ST_OnOffStyleTypeUnset {_dbeg .BAttr =_abab .BAttr ;};if _dbeg .IAttr ==_aa .ST_OnOffStyleTypeUnset {_dbeg .IAttr =_abab .IAttr ;};if _dbeg .Font ==nil {_dbeg .Font =_abab .Font ;};if _dbeg .FontRef ==nil {_dbeg .FontRef =_abab .FontRef ;};if _dbeg .ScrgbClr ==nil {_dbeg .ScrgbClr =_abab .ScrgbClr ;};if _dbeg .SrgbClr ==nil {_dbeg .SrgbClr =_abab .SrgbClr ;};if _dbeg .HslClr ==nil {_dbeg .HslClr =_abab .HslClr ;};if _dbeg .SysClr ==nil {_dbeg .SysClr =_abab .SysClr ;};if _dbeg .SchemeClr ==nil {_dbeg .SchemeClr =_abab .SchemeClr ;};if _dbeg .PrstClr ==nil {_dbeg .PrstClr =_abab .PrstClr ;};return _dbeg ;};func (_fffd *textboxContext )addCurrentWordToParagraph (){if _fffd ._gddd &&_fffd ._adcde ._bad +_fffd ._fcce ._dgbd > _fffd ._adcde ._gacf {_fffd .newLine ();};if !_fffd ._fcce ._dcfg ||len (_fffd ._adcde ._gfac )> 0{_fffd ._fcce ._bdc =_fffd ._adcde ._bad ;_fffd ._adcde ._gfac =append (_fffd ._adcde ._gfac ,_fffd ._fcce );_fffd ._adcde ._bad +=_fffd ._fcce ._dgbd ;for _ ,_eec :=range _fffd ._fcce ._gcb {_fffd .adjustHeights (_eec ._fdca );};};};var _cf =_edgc (1.9);func (_bfd *convertContext )addCellToTable (_abg *_cc .Table ,_adbb *_aa .CT_TableCell ,_bbacd *_aa .CT_TablePartStyle ,_ceec float64 ,_caea ,_cgb ,_afa ,_deab bool )float64 {var _dfdf *_cc .TableCell ;_dbfc :=1;if _adbb .GridSpanAttr !=nil {_dbfc =int (*_adbb .GridSpanAttr );};_dfdf =_abg .MultiColCell (_dbfc );_dad :=_adbb .TcPr ;var _fgff *_aa .CT_TableStyleTextStyle ;if _bbacd !=nil {_dad =_ddg (_dad ,_bbacd .TcStyle ,_caea ,_cgb ,_afa ,_deab );_fgff =_bbacd .TcTxStyle ;};_fgee :=_cf ;_fecd :=_cc .CellVerticalAlignmentMiddle ;if _dad !=nil {if _cbc :=_dad .LnL ;_cbc !=nil {_fffca ,_feb ,_fegg :=_bfd .getBorderStyle (_cbc );_dfdf .SetBorder (_cc .CellBorderSideLeft ,_fffca ,_fegg );if _feb !=nil &&*_feb !=nil {_dfdf .SetSideBorderColor (_cc .CellBorderSideLeft ,*_feb );};};if _bca :=_dad .LnT ;_bca !=nil {_acg ,_acf ,_gcda :=_bfd .getBorderStyle (_bca );_dfdf .SetBorder (_cc .CellBorderSideTop ,_acg ,_gcda );if _acf !=nil &&*_acf !=nil {_dfdf .SetSideBorderColor (_cc .CellBorderSideTop ,*_acf );};};if _ddc :=_dad .LnR ;_ddc !=nil {_fae ,_dbab ,_gefe :=_bfd .getBorderStyle (_ddc );_dfdf .SetBorder (_cc .CellBorderSideRight ,_fae ,_gefe );if _dbab !=nil &&*_dbab !=nil {_dfdf .SetSideBorderColor (_cc .CellBorderSideRight ,*_dbab );};};if _dae :=_dad .LnB ;_dae !=nil {_gff ,_bbag ,_fffee :=_bfd .getBorderStyle (_dae );_dfdf .SetBorder (_cc .CellBorderSideBottom ,_gff ,_fffee );if _bbag !=nil &&*_bbag !=nil {_dfdf .SetSideBorderColor (_cc .CellBorderSideBottom ,*_bbag );};};if _cfd :=_dad .MarLAttr ;_cfd !=nil {_fgee =float64 (_d .FromSTCoordinate32 (*_cfd ));};switch _dad .AnchorAttr {case _aa .ST_TextAnchoringTypeT :_fecd =_cc .CellVerticalAlignmentTop ;case _aa .ST_TextAnchoringTypeB :_fecd =_cc .CellVerticalAlignmentBottom ;};if _dad .NoFill ==nil {if _ceg :=_dad .SolidFill ;_ceg !=nil {_ffg ,_ :=_bfd .getColorFromSolidFill (_ceg );_dfdf .SetBackgroundColor (_ffg );};};};_dfdf .SetVerticalAlignment (_fecd );_dfdf .SetIndent (_fgee );var _cfa float64 ;if _abcfa :=_adbb .TxBody ;_abcfa !=nil {_efbe :=_bfd .makePdfDivisionFromTxBody (_abcfa ,_ceec ,_cfa ,_fgff );_cfa =_efbe .Height ();_dfdf .SetContent (_efbe );};return _cfa ;};func _dgaa (_deba ,_cgde *_aa .CT_TableStyleCellStyle )*_aa .CT_TableStyleCellStyle {_bcaa :=_aa .NewCT_TableStyleCellStyle ();if _deba !=nil {*_bcaa =*_deba ;};if _cgde ==nil {return _bcaa ;};if _bcaa .TcBdr ==nil {_bcaa .TcBdr =_cgde .TcBdr ;};if _bcaa .Fill ==nil {_bcaa .Fill =_cgde .Fill ;};if _bcaa .FillRef ==nil {_bcaa .FillRef =_cgde .FillRef ;};return _bcaa ;};func (_dbgg *convertContext )getColorFromSolidFill (_geg *_aa .CT_SolidColorFillProperties )(_cc .Color ,float64 ){if _geg ==nil {return nil ,1;};var _gabb string ;_cdd :=1.0;if _febd :=_geg .SrgbClr ;_febd !=nil {_gabb =_febd .ValAttr ;_cdd =_d .GetOpacityFromColorTransform (_febd .EG_ColorTransform );}else if _dbde :=_geg .SchemeClr ;_dbde !=nil {_gabb =_d .GetColorStringFromDmlColor (_dbgg ._fgd .GetColorBySchemeColor (_dbde .ValAttr ));_gabb =_d .AdjustColor (_gabb ,_dbde .EG_ColorTransform );_cdd =_d .GetOpacityFromColorTransform (_dbde .EG_ColorTransform );};if _gabb !=""{_aagc :=_cc .ColorRGBFromHex ("\u0023"+_gabb );return _aagc ,_cdd ;};return nil ,1;};func (_baf *textboxContext )addTextSymbol (_efd *symbol ){_gfe :=_cc .New ();_caec :=_gfe .NewStyledParagraph ();_caec .SetMargins (0,0,0,0);_bgd :=_caec .Append (_efd ._cgd );_ffdd :=0.0;if _efd ._baee !=nil {_bgd .Style =*_efd ._baee ;if _efd ._baee .CharSpacing !=0{_ffdd =_efd ._baee .CharSpacing ;};};_efd ._ebc =_caec .Height ();_efd ._fdca =_caec .Height ()*1.2;if _efd ._fdca < _baf ._ccg ._bfbe {_efd ._fdca =_baf ._ccg ._bfbe ;};if _efd ._ggba ==0{_efd ._ggba =_caec .Width ()+_ffdd ;};if len (_baf ._fcce ._gcb )> 0{_beaec :=_baf ._fcce ._gcb [len (_baf ._fcce ._gcb )-1]._cgd ;if _baf ._ccg ._fdbc ||_d .IsNoSpaceLanguage (_beaec )||(_beaec =="\u0020")!=(_efd ._cgd =="\u0020"){_baf .addCurrentWordToParagraph ();_baf .newWord ();};};_baf ._fcce ._gcb =append (_baf ._fcce ._gcb ,_efd );_efd ._bfaac =_baf ._fcce ._dgbd ;_baf ._fcce ._dgbd +=_efd ._ggba ;if _efd ._cgd !="\u0020"{_baf ._fcce ._dcfg =false ;};};func (_aed *textboxContext )alignParagraphsVertically (_gge _aa .ST_TextAnchoringType ){if _gge ==_aa .ST_TextAnchoringTypeT {return ;};_cagd :=0.0;for _ ,_geaa :=range _aed ._affa {_cagd +=_geaa ._aga +_geaa ._bddb +_geaa ._gbcb ;};var _fagg float64 ;switch _gge {case _aa .ST_TextAnchoringTypeCtr :_fagg =(_aed ._gfgb -_cagd )/2;case _aa .ST_TextAnchoringTypeB :_fagg =_aed ._gfgb -_cagd ;};for _ ,_acba :=range _aed ._affa {_acba ._geae +=_fagg ;};};func (_adea *convertContext )getBorderStyle (_gedf *_aa .CT_LineProperties )(_cc .CellBorderStyle ,*_cc .Color ,float64 ){if _gedf ==nil ||_gedf .NoFill !=nil {return _cc .CellBorderStyleNone ,nil ,0;};var _cde _cc .Color ;if _gadg :=_gedf .SolidFill ;_gadg !=nil {_cde ,_ =_adea .getColorFromSolidFill (_gadg );};_bbb :=0.0;if _cga :=_gedf .WAttr ;_cga !=nil {_bbb =_e .FromEMU (int64 (*_cga ));};return _cc .CellBorderStyleSingle ,&_cde ,_bbb ;};func (_bdda *textboxContext )addPrefix (_adge *prefixData ,_fgea *_cc .TextStyle ){_acaf :=_gag (_adge ._fcbd );_fbdcb :=*_fgea ;if _adge ._gcbf {_fbdcb .Font =_d .AssignStdFontByName (_fbdcb ,"\u0053\u0079\u006d\u0062\u006f\u006c");};for _ ,_geff :=range _acaf {_geff ._baee =&_fbdcb ;_bdda .addTextSymbol (_geff );};_gbe :=-(_adge ._cacb +_bdda ._fcce ._dgbd );if _gbe < 0{_gbe =0;};_effd :=&symbol {_cgd :"\u0020",_ggba :_gbe };_bdda .addTextSymbol (_effd );_bdda ._fcce ._bdc +=(_adge ._cacb +_adge ._efe );};func (_eda *textboxContext )newLine (){if _eda ._ccg ==nil {_eda .newParagraph ();};_cgf :=_eda ._ccg ._bddb +_eda ._ccg ._aga ;_afdg :=&line {};_afdg ._daeg =_eda ._ccg ._edca ;if len (_eda ._ccg ._gfa )==0{_afdg ._daeg +=_eda ._ccg ._dcf ;};_afdg ._gacf =_eda ._ccg ._eaac ;_afdg ._bad =_afdg ._daeg ;_afdg ._agdd =_cgf ;_eda ._ccg ._gfa =append (_eda ._ccg ._gfa ,_afdg );_eda ._adcde =_afdg ;};func _fccf (_bbbf *_ffe .CT_Shape )(_ffe .ST_PlaceholderType ,*uint32 ){if _aaad :=_bbbf .NvSpPr ;_aaad !=nil {if _befb :=_aaad .NvPr ;_befb !=nil {if _dbbe :=_befb .Ph ;_dbbe !=nil {return _dbbe .TypeAttr ,_dbbe .IdxAttr ;};};};return _ffe .ST_PlaceholderTypeUnset ,nil ;};func (_accf *textboxContext )addCurrentParagraph (){_accf ._bae =_accf ._ccg ._geae +_accf ._ccg ._aga +_accf ._ccg ._bddb +_accf ._ccg ._gbcb ;_accf ._affa =append (_accf ._affa ,_accf ._ccg );_accf .alignParagraph ();};func (_eccf *line )moveRight (_aegf float64 ){for _ ,_eceaf :=range _eccf ._gfac {_eceaf ._bdc +=_aegf ;};};func (_ad *convertContext )makePdfBlockFromChart (_ded *_ag .Chart ,_adg ,_ab float64 )(*_cc .Block ,error ){_fa :=_ded .CT_RelId .IdAttr ;_bg :=_ad ._fgd .GetChartSpaceByRelId (_fa );if _bg ==nil {return nil ,_f .New ("\u004e\u006f\u0020\u0063\u0068\u0061\u0072\u0074\u0073\u0070\u0061\u0063\u0065");};var _ga *_aa .Theme ;_ce :=_ad ._acd .Themes ();if len (_ce )> 0{_ga =_ce [0];};return _d .MakeBlockFromChartSpace (_bg ,_adg ,_ab ,_ga );};const (FontStyle_Regular FontStyle =0;FontStyle_Bold FontStyle =1;FontStyle_Italic FontStyle =2;FontStyle_BoldItalic FontStyle =3;);func (_gabed *textboxContext )alignVertically (_bfdd _aa .ST_TextAnchoringType ){_gabed .alignParagraphsVertically (_bfdd );_gabed .alignSymbolsVertically ();};func _ffee (_gcfa ,_gfff *_aa .CT_TextBody )(*_aa .CT_TextBodyProperties ,*_aa .CT_TextListStyle ){if _gcfa ==nil &&_gfff ==nil {return nil ,nil ;};if _gcfa ==nil {return _gfff .BodyPr ,_gfff .LstStyle ;};if _gfff ==nil {return _gcfa .BodyPr ,_gcfa .LstStyle ;};_agddf ,_fcee :=_gcfa .BodyPr ,_gcfa .LstStyle ;_gdeg ,_egcc :=_gfff .BodyPr ,_gfff .LstStyle ;_faa :=_beca (_agddf ,_gdeg );_acbab :=_abbd (_fcee ,_egcc );return _faa ,_acbab ;};func _bfag (_cegg ,_gdea *_aa .CT_TablePartStyle )*_aa .CT_TablePartStyle {_dcbcb :=_aa .NewCT_TablePartStyle ();if _cegg !=nil {*_dcbcb =*_cegg ;};if _gdea ==nil {return _dcbcb ;};if _dcbcb .TcTxStyle ==nil {_dcbcb .TcTxStyle =_gdea .TcTxStyle ;}else {_dcbcb .TcTxStyle =_dbga (_dcbcb .TcTxStyle ,_gdea .TcTxStyle );};if _dcbcb .TcStyle ==nil {_dcbcb .TcStyle =_gdea .TcStyle ;}else {_dcbcb .TcStyle =_dgaa (_dcbcb .TcStyle ,_gdea .TcStyle );};return _dcbcb ;};func (_gggc *convertContext )getPhData (_fagf *_ffe .CT_Shape )(*_aa .CT_Transform2D ,*_aa .CT_TextBodyProperties ,*_aa .CT_TextListStyle ,bool ,bool ){_fde ,_aeeg :=_fccf (_fagf );_edee :=_aeeg ==nil ;_bcgf ,_bfcb ,_bggg ,_aaag :=_bead (_gggc ._gage .CSld ,_fde ,_aeeg ,_edee );_afaf ,_bbdg ,_gcba ,_bbf :=_bead (_gggc ._dcdc .CSld ,_fde ,_aeeg ,_edee );if _afaf ==nil {_afaf =_bcgf ;};_eegf ,_decd :=_ffee (_bbdg ,_bfcb );var _ccbef ,_deee bool ;if _gcba ==nil {if _bggg !=nil {_ccbef =*_bggg ;};}else {_ccbef =*_gcba ;};if _bbf ==nil {if _aaag !=nil {_deee =*_aaag ;};}else {_deee =*_bbf ;};return _afaf ,_eegf ,_decd ,_ccbef ,_deee ;};func (_gfbg *convertContext )applyBlipEffectsOnImg (_dbdec *_cc .Image ,_ddfca ,_cbfge float64 ,_ceed []*_aa .CT_BlipChoice )*_cc .Image {if len (_ceed )==0{return _dbdec ;};_dbdec .SetPos (_ddfca ,_cbfge );_bcdg ,_baa :=_gfbg .renderPageWithDrawableToGoImage (_dbdec );if _baa !=nil {_ae .Log .Debug ("\u0045\u0072\u0072\u006f\u0072\u0020\u0072\u0065\u006e\u0064\u0065\u0072\u0020a\u006e\u0020\u0069\u006d\u0061\u0067e\u0020\u0074\u006f\u0020\u0061\u0020\u0047\u006f\u0020\u0069\u006d\u0061\u0067e\u003a\u0020\u0025\u0073",_baa );return _dbdec ;};_gadeb ,_baa :=_gfbg .renderCurrentStateToGoImage ();if _baa !=nil {_ae .Log .Debug ("\u0045\u0072\u0072\u006f\u0072\u0020\u0072\u0065n\u0064\u0065\u0072 t\u0068\u0065\u0020\u0063\u0075\u0072r\u0065\u006e\u0074\u0020\u0073\u0074\u0061\u0074\u0065\u0020\u0074\u006f\u0020\u0061\u0020G\u006f\u0020\u0069\u006d\u0061\u0067\u0065\u003a \u0025\u0073",_baa );return _dbdec ;};_fegd :=_bcdg .Bounds ();_ebdgb :=_g .NewRGBA (_fegd );_cdbg ,_dcgd :=_dbdec .Width (),_dbdec .Height ();for _ ,_gagfc :=range _ceed {for _ ,_aegb :=range _gagfc .AlphaModFix {if _effad :=_aegb .AmtAttr ;_effad !=nil {if _caeb :=_effad .ST_PositivePercentageDecimal ;_caeb !=nil {_adae :=uint8 (255*(*_caeb )/100000);_gcfg :=_g .NewUniform (_a .Alpha {_adae });_ac .Draw (_ebdgb ,_fegd ,_gadeb ,_g .Point {0,0},_ac .Src );_ac .DrawMask (_ebdgb ,_fegd ,_bcdg ,_g .Point {0,0},_gcfg ,_g .Point {0,0},_ac .Over );};};};};_febf :=_g .Rect (int (_ddfca ),int (_cbfge ),int (_ddfca +_cdbg )+1,int (_cbfge +_dcgd )+1);_effadc :=_d .CropImageByRect (_ebdgb ,_febf );_gbda ,_baa :=_gfbg ._bfge .NewImageFromGoImage (_effadc );if _baa !=nil {_ae .Log .Debug ("\u0045\u0072\u0072\u006f\u0072\u0020\u0061\u006e\u0020\u0069\u006d\u0061\u0067\u0065\u0020t\u006f \u0061\u0020\u0047\u006f\u0020\u0069\u006d\u0061\u0067\u0065\u003a\u0020\u0025\u0073",_baa );return _dbdec ;};return _gbda ;};type line struct{_agdd float64 ;_daeg float64 ;_gacf float64 ;_bad float64 ;_cbdg float64 ;_gfac []*word ;};func (_be *convertContext )makeSlide (){_ea :=_be ._fgd .X ().CSld ;if _ea ==nil {return ;};_ecb :=&background {};if _cceb :=_ea .Bg ;_cceb !=nil {if _ecbc :=_cceb .BgPr ;_ecbc !=nil {if _ecbc .NoFill ==nil {if _fff :=_ecbc .SolidFill ;_fff !=nil {_fd ,_dg :=_be .getColorFromSolidFill (_fff );if _fd !=nil {_ecb ._gagf =_fd ;_ecb ._cbf =_dg ;};}else if _abc :=_ecbc .BlipFill ;_abc !=nil {_ecb ._ggff =_abc ;};};};};_be ._cfb =_ecb ;if _bea :=_ea .SpTree ;_bea !=nil {for _ ,_gf :=range _bea .Choice {if _gf !=nil {for _ ,_eg :=range _gf .Sp {if _eg !=nil {_afc :=_be .getShapes (_eg );_be ._dadf =append (_be ._dadf ,_afc ...);};};for _ ,_edg :=range _gf .GraphicFrame {if _edg !=nil {var _gdaa ,_ef ,_afd ,_fce float64 ;if _bc :=_edg .Xfrm ;_bc !=nil {_gdaa ,_ef ,_afd ,_fce =_d .GetDataFromXfrm (_bc );};if _gae :=_edg .Graphic ;_gae !=nil {if _bf :=_gae .GraphicData ;_bf !=nil {for _ ,_afe :=range _bf .Any {if _aaa ,_bcf :=_afe .(*_ag .Chart );_bcf {_gbg ,_abd :=_be .makePdfBlockFromChart (_aaa ,_afd ,_fce );if _abd !=nil {_ae .Log .Debug ("C\u0061\u006e\u006e\u006ft \u0072e\u0061\u0064\u0020\u0062\u006co\u0063\u006b\u003a\u0020\u0025\u0073",_abd );};if _gbg !=nil {_gbg .SetPos (_gdaa ,_ef );_be ._dadf =append (_be ._dadf ,_gbg );};}else if _gbf ,_ee :=_afe .(*_aa .Tbl );_ee {_eff :=_be .makePdfBlockFromTable (_gbf ,_afd );if _eff !=nil {_dbf :=_cc .NewBlock (_afd ,_fce );_dbf .SetPos (_gdaa ,_ef );_dbf .Draw (_eff );_be ._dadf =append (_be ._dadf ,_dbf );};};};};};};};for _ ,_ece :=range _gf .CxnSp {if _ece !=nil {_gba :=_be .getConnectors (_ece );_be ._dadf =append (_be ._dadf ,_gba ...);};};for _ ,_bb :=range _gf .Pic {if _bb !=nil {var _fcg ,_cdb ,_bgg ,_fffe float64 ;if _gcd :=_bb .SpPr ;_gcd !=nil {if _dgb :=_gcd .Xfrm ;_dgb !=nil {_fcg ,_cdb ,_bgg ,_fffe =_d .GetDataFromXfrm (_dgb );};};if _dc :=_bb .BlipFill ;_dc !=nil {_ca :=_be .getShapeFromBlipFill (_dc ,_fcg ,_cdb ,_bgg ,_fffe );_be ._dadf =append (_be ._dadf ,_ca );};};};};};};};func _acbd (_edbee *bool )bool {return _edbee !=nil &&*_edbee };func _efeg (_dgg ,_aggc *_aa .CT_TextParagraphProperties )*_aa .CT_TextParagraphProperties {_bgfg :=_aa .NewCT_TextParagraphProperties ();if _dgg !=nil {*_bgfg =*_dgg ;};if _aggc ==nil {return _bgfg ;};if _bgfg .MarLAttr ==nil {_bgfg .MarLAttr =_aggc .MarLAttr ;};if _bgfg .MarRAttr ==nil {_bgfg .MarRAttr =_aggc .MarRAttr ;};if _bgfg .LvlAttr ==nil {_bgfg .LvlAttr =_aggc .LvlAttr ;};if _bgfg .IndentAttr ==nil {_bgfg .IndentAttr =_aggc .IndentAttr ;};if _bgfg .AlgnAttr ==_aa .ST_TextAlignTypeUnset {_bgfg .AlgnAttr =_aggc .AlgnAttr ;};if _bgfg .DefTabSzAttr ==nil {_bgfg .DefTabSzAttr =_aggc .DefTabSzAttr ;};if _bgfg .RtlAttr ==nil {_bgfg .RtlAttr =_aggc .RtlAttr ;};if _bgfg .EaLnBrkAttr ==nil {_bgfg .EaLnBrkAttr =_aggc .EaLnBrkAttr ;};if _bgfg .FontAlgnAttr ==_aa .ST_TextFontAlignTypeUnset {_bgfg .FontAlgnAttr =_aggc .FontAlgnAttr ;};if _bgfg .LatinLnBrkAttr ==nil {_bgfg .LatinLnBrkAttr =_aggc .LatinLnBrkAttr ;};if _bgfg .HangingPunctAttr ==nil {_bgfg .HangingPunctAttr =_aggc .HangingPunctAttr ;};if _bgfg .LnSpc ==nil {_bgfg .LnSpc =_aggc .LnSpc ;};if _bgfg .SpcBef ==nil {_bgfg .SpcBef =_aggc .SpcBef ;};if _bgfg .SpcAft ==nil {_bgfg .SpcAft =_aggc .SpcAft ;};if _bgfg .BuClrTx ==nil {_bgfg .BuClrTx =_aggc .BuClrTx ;};if _bgfg .BuClr ==nil {_bgfg .BuClr =_aggc .BuClr ;};if _bgfg .BuSzTx ==nil {_bgfg .BuSzTx =_aggc .BuSzTx ;};if _bgfg .BuSzPct ==nil {_bgfg .BuSzPct =_aggc .BuSzPct ;};if _bgfg .BuSzPts ==nil {_bgfg .BuSzPts =_aggc .BuSzPts ;};if _bgfg .BuFontTx ==nil {_bgfg .BuFontTx =_aggc .BuFontTx ;};if _bgfg .BuFont ==nil {_bgfg .BuFont =_aggc .BuFont ;};if _bgfg .BuNone ==nil {_bgfg .BuNone =_aggc .BuNone ;};if _bgfg .BuAutoNum ==nil {_bgfg .BuAutoNum =_aggc .BuAutoNum ;};if _bgfg .BuChar ==nil {_bgfg .BuChar =_aggc .BuChar ;};if _bgfg .BuBlip ==nil {_bgfg .BuBlip =_aggc .BuBlip ;};if _bgfg .TabLst ==nil {_bgfg .TabLst =_aggc .TabLst ;};if _bgfg .ExtLst ==nil {_bgfg .ExtLst =_aggc .ExtLst ;};_bgfg .DefRPr =_gggf (_bgfg .DefRPr ,_aggc .DefRPr );return _bgfg ;};type paragraph struct{_cac float64 ;_aga float64 ;_gbcb float64 ;_dcf float64 ;_edca float64 ;_eaac float64 ;_geae float64 ;_bddb float64 ;_aac _aa .ST_TextAlignType ;_bfbe float64 ;_fdbc bool ;_gfa []*line ;};func (_bgad *convertContext )getInfoFromLn (_bbdb *_aa .CT_LineProperties )(_cc .Color ,float64 ,float64 ){if _bbdb ==nil ||_bbdb .NoFill !=nil {return nil ,0,0;};var _begd float64 ;_cgca ,_cdee :=_bgad .getColorFromSolidFill (_bbdb .SolidFill );if _ebge :=_bbdb .WAttr ;_ebge !=nil {_begd =_e .FromEMU (int64 (*_ebge ));}else {_begd =1;};return _cgca ,_begd ,_cdee ;};func _ddg (_fgdb *_aa .CT_TableCellProperties ,_adfd *_aa .CT_TableStyleCellStyle ,_gbeg ,_cgfe ,_dfca ,_gdbg bool )*_aa .CT_TableCellProperties {_abega :=_aa .NewCT_TableCellProperties ();if _fgdb !=nil {*_abega =*_fgdb ;};if _adfd ==nil {return _abega ;};if _dfgc :=_adfd .FillRef ;_dfgc !=nil {_ebag :=_aa .NewCT_SolidColorFillProperties ();_ebag .ScrgbClr =_dfgc .ScrgbClr ;_ebag .SrgbClr =_dfgc .SrgbClr ;_ebag .HslClr =_dfgc .HslClr ;_ebag .SysClr =_dfgc .SysClr ;_ebag .SchemeClr =_dfgc .SchemeClr ;_ebag .PrstClr =_dfgc .PrstClr ;_abega .SolidFill =_ebag ;};if _abega .NoFill ==nil &&_abega .SolidFill ==nil {if _eaff :=_adfd .Fill ;_eaff !=nil {if _abega .NoFill ==nil {_abega .NoFill =_eaff .NoFill ;};if _abega .SolidFill ==nil {_abega .SolidFill =_eaff .SolidFill ;};};};if _cacbd :=_adfd .TcBdr ;_cacbd !=nil {if _abega .LnL ==nil {var _eceb *_aa .CT_ThemeableLineStyle ;if _dfca {_eceb =_cacbd .Left ;}else {_eceb =_cacbd .InsideV ;};if _eceb !=nil {_abega .LnL =_eceb .Ln ;};};if _abega .LnR ==nil {var _fccbc *_aa .CT_ThemeableLineStyle ;if _gdbg {_fccbc =_cacbd .Right ;}else {_fccbc =_cacbd .InsideV ;};if _fccbc !=nil {_abega .LnR =_fccbc .Ln ;};};if _abega .LnT ==nil {var _dbed *_aa .CT_ThemeableLineStyle ;if _gbeg {_dbed =_cacbd .Top ;}else {_dbed =_cacbd .InsideH ;};if _dbed !=nil {_abega .LnT =_dbed .Ln ;};};if _abega .LnB ==nil {var _bab *_aa .CT_ThemeableLineStyle ;if _cgfe {_bab =_cacbd .Bottom ;}else {_bab =_cacbd .InsideH ;};if _bab !=nil {_abega .LnB =_bab .Ln ;};};};return _abega ;};func (_ffeg *convertContext )renderPageWithDrawableToGoImage (_fbba _cc .Drawable )(_g .Image ,error ){_daeba :=_d .MakeTempCreator (_ffeg ._gca ,_ffeg ._dcab );_daeba .NewPage ();_daeba .Draw (_fbba );_cgdg ,_bcbc :=_d .GetPageFromCreator (_daeba );if _bcbc !=nil {return nil ,_bcbc ;};return _ff .NewImageDevice ().Render (_cgdg );};func _beca (_aggca ,_gcdgd *_aa .CT_TextBodyProperties )*_aa .CT_TextBodyProperties {_cecdb :=_aa .NewCT_TextBodyProperties ();if _aggca !=nil {*_cecdb =*_aggca ;};if _gcdgd ==nil {return _cecdb ;};if _cecdb .RotAttr ==nil {_cecdb .RotAttr =_gcdgd .RotAttr ;};if _cecdb .SpcFirstLastParaAttr ==nil {_cecdb .SpcFirstLastParaAttr =_gcdgd .SpcFirstLastParaAttr ;};if _cecdb .VertOverflowAttr ==_aa .ST_TextVertOverflowTypeUnset {_cecdb .VertOverflowAttr =_gcdgd .VertOverflowAttr ;};if _cecdb .HorzOverflowAttr ==_aa .ST_TextHorzOverflowTypeUnset {_cecdb .HorzOverflowAttr =_gcdgd .HorzOverflowAttr ;};if _cecdb .VertAttr ==_aa .ST_TextVerticalTypeUnset {_cecdb .VertAttr =_gcdgd .VertAttr ;};if _cecdb .WrapAttr ==_aa .ST_TextWrappingTypeUnset {_cecdb .WrapAttr =_gcdgd .WrapAttr ;};if _cecdb .LInsAttr ==nil {_cecdb .LInsAttr =_gcdgd .LInsAttr ;};if _cecdb .TInsAttr ==nil {_cecdb .TInsAttr =_gcdgd .TInsAttr ;};if _cecdb .RInsAttr ==nil {_cecdb .RInsAttr =_gcdgd .RInsAttr ;};if _cecdb .BInsAttr ==nil {_cecdb .BInsAttr =_gcdgd .BInsAttr ;};if _cecdb .NumColAttr ==nil {_cecdb .NumColAttr =_gcdgd .NumColAttr ;};if _cecdb .SpcColAttr ==nil {_cecdb .SpcColAttr =_gcdgd .SpcColAttr ;};if _cecdb .RtlColAttr ==nil {_cecdb .RtlColAttr =_gcdgd .RtlColAttr ;};if _cecdb .AnchorAttr ==_aa .ST_TextAnchoringTypeUnset {_cecdb .AnchorAttr =_gcdgd .AnchorAttr ;};if _cecdb .AnchorCtrAttr ==nil {_cecdb .AnchorCtrAttr =_gcdgd .AnchorCtrAttr ;};if _cecdb .ForceAAAttr ==nil {_cecdb .ForceAAAttr =_gcdgd .ForceAAAttr ;};if _cecdb .UprightAttr ==nil {_cecdb .UprightAttr =_gcdgd .UprightAttr ;};if _cecdb .CompatLnSpcAttr ==nil {_cecdb .CompatLnSpcAttr =_gcdgd .CompatLnSpcAttr ;};if _cecdb .PrstTxWarp ==nil {_cecdb .PrstTxWarp =_gcdgd .PrstTxWarp ;};if _cecdb .NoAutofit ==nil {_cecdb .NoAutofit =_gcdgd .NoAutofit ;};if _cecdb .NormAutofit ==nil {_cecdb .NormAutofit =_gcdgd .NormAutofit ;};if _cecdb .SpAutoFit ==nil {_cecdb .SpAutoFit =_gcdgd .SpAutoFit ;};if _cecdb .Scene3d ==nil {_cecdb .Scene3d =_gcdgd .Scene3d ;};if _cecdb .Sp3d ==nil {_cecdb .Sp3d =_gcdgd .Sp3d ;};if _cecdb .FlatTx ==nil {_cecdb .FlatTx =_gcdgd .FlatTx ;};if _cecdb .ExtLst ==nil {_cecdb .ExtLst =_gcdgd .ExtLst ;};return _cecdb ;};func (_edbe *convertContext )makePdfBlockFromTable (_ace *_aa .Tbl ,_ba float64 )*_cc .Table {_aba :=_ace .TblGrid ;if _aba ==nil {return nil ;};_ebda :=len (_aba .GridCol );if _ebda ==0{return nil ;};_abe :=[]float64 {};_cbd :=0.0;for _ ,_dag :=range _aba .GridCol {_fddg :=_e .FromEMU (_d .FromSTCoordinate (_dag .WAttr ));_abe =append (_abe ,_fddg );_cbd +=_fddg ;};_fda :=[]float64 {};for _ccb :=0;_ccb < _ebda ;_ccb ++{_fda =append (_fda ,_abe [_ccb ]/_cbd );};_adbg :=_edbe ._bfge .NewTable (_ebda );_adbg .SetColumnWidths (_fda ...);_eccg :=_ace .TblPr ;var _daff *_aa .CT_TableStyle ;if _fcca :=_eccg .Choice ;_fcca !=nil {if _fcca .TableStyle !=nil {_daff =_fcca .TableStyle ;}else if _fcca .TableStyleId !=nil {_daff =_edbe ._acd .GetTableStyleById (*_fcca .TableStyleId );};};_bdg :=_aa .NewCT_TablePartStyle ();_bdg .TcStyle =_aa .NewCT_TableStyleCellStyle ();_bdg .TcTxStyle =_aa .NewCT_TableStyleTextStyle ();if _daff !=nil {if _daff .WholeTbl !=nil {*_bdg =*_daff .WholeTbl ;};if _daff .TblBg !=nil {if _bdg .TcStyle .Fill ==nil {_bdg .TcStyle .Fill =_daff .TblBg .Fill ;};};};if _bdg .TcStyle .Fill ==nil {_bdg .TcStyle .Fill =_aa .NewCT_FillProperties ();_bdg .TcStyle .Fill .NoFill =_eccg .NoFill ;_bdg .TcStyle .Fill .SolidFill =_eccg .SolidFill ;};_bcce :=len (_ace .Tr );for _adeg ,_abeg :=range _ace .Tr {_abb :=_adeg ==0;_gga :=_adeg ==_bcce -1;_edcb :=_adeg %2==0;_abdd :=len (_abeg .Tc );var _fag *_aa .CT_TablePartStyle ;if _abb {_fag =_daff .FirstRow ;}else if _edcb {_fag =_daff .Band2H ;}else {_fag =_daff .Band1H ;};var _acbe float64 ;for _gbb ,_bgb :=range _abeg .Tc {_gdda :=_gbb ==0;_cebc :=_gbb ==_abdd -1;_eege :=_gbb %2==0;var _gabg *_aa .CT_TablePartStyle ;if _gdda {_gabg =_daff .FirstCol ;}else if _eege {_gabg =_daff .Band2V ;}else {_gabg =_daff .Band1V ;};_fcf :=_bfag (_bfag (_gabg ,_fag ),_bdg );_fffc :=_edbe .addCellToTable (_adbg ,_bgb ,_fcf ,_ba *_fda [_gbb ],_abb ,_gga ,_gdda ,_cebc );if _fffc > _acbe {_acbe =_fffc ;};};_ccf :=_e .FromEMU (_d .FromSTCoordinate (_abeg .HAttr ));if _ccf < _acbe {_ccf =_acbe ;};if _ccf < _edgc (4){_ccf =_edgc (4);};_adbg .SetRowHeight (_adbg .CurRow (),_ccf );};return _adbg ;};func _bead (_dcc *_ffe .CT_CommonSlideData ,_cbg _ffe .ST_PlaceholderType ,_dfda *uint32 ,_defef bool )(*_aa .CT_Transform2D ,*_aa .CT_TextBody ,*bool ,*bool ){if _dcc !=nil &&(_cbg !=_ffe .ST_PlaceholderTypeUnset ||!_defef ){if _fbe :=_dcc .SpTree ;_fbe !=nil {for _ ,_gegb :=range _fbe .Choice {if _gegb !=nil {for _ ,_dceg :=range _gegb .Sp {if _dceg !=nil {_gaee ,_aacf :=_fccf (_dceg );if _cbg ==_gaee {if (_defef &&_aacf ==nil )||(!_defef &&_aacf !=nil &&*_aacf ==*_dfda ){var _baca *_aa .CT_Transform2D ;if _dceg .SpPr !=nil {_baca =_dceg .SpPr .Xfrm ;};_accb :=_cbg ==_ffe .ST_PlaceholderTypeTitle ||_cbg ==_ffe .ST_PlaceholderTypeCtrTitle ;_affeb :=!_accb &&_cbg !=_ffe .ST_PlaceholderTypeUnset ;return _baca ,_dceg .TxBody ,&_accb ,&_affeb ;};};};};};};};};return nil ,nil ,nil ,nil ;};func (_dbdea *convertContext )renderCurrentStateToGoImage ()(_g .Image ,error ){_agbce :=_d .MakeTempCreator (_dbdea ._gca ,_dbdea ._dcab );_agbce .NewPage ();for _ ,_bbaca :=range _dbdea ._dadf {if _bbaca !=nil {_agbce .MoveTo (0,0);_agbce .Draw (_bbaca );};};_agcf ,_dbgb :=_d .GetPageFromCreator (_agbce );if _dbgb !=nil {return nil ,_dbgb ;};return _ff .NewImageDevice ().Render (_agcf );};type romanMatch struct{_bddd int ;_eaf string ;};func (_bbacf *textboxContext )alignSymbolsVertically (){for _ ,_efec :=range _bbacf ._affa {for _ ,_fdce :=range _efec ._gfa {_fdda :=0.0;for _ ,_abeb :=range _fdce ._gfac {for _ ,_bbgcc :=range _abeb ._gcb {if _bbgcc ._fdca > _fdda {_fdda =_bbgcc ._fdca ;};};};for _ ,_aee :=range _fdce ._gfac {for _ ,_aad :=range _aee ._gcb {if _aad ._ebc < _fdda {_aad ._bgcg =_fdda -_aad ._ebc ;};};};};};};func (_bfcf *textboxContext )assignPropsToCurrentParagraph (_fbfd *_aa .CT_TextParagraphProperties ){_gcdf :=12.4;if _fbfd ==nil {_bfcf ._ccg ._bfbe =_gcdf ;return ;};if _cbfg :=_fbfd .DefRPr ;_cbfg !=nil {_ecfb :=_cbfg .SzAttr ;if _ecfb !=nil {_cgc :=float64 (*_ecfb )/1200;if _gcdf <=_cgc {_gcdf =_cgc ;};};};if _fdbaa :=_fbfd .MarLAttr ;_fdbaa !=nil {_bfcf ._ccg ._edca =_e .FromEMU (int64 (*_fdbaa ));};_bfcf ._ccg ._eaac =_bfcf ._gggb ;if _gade :=_fbfd .MarRAttr ;_gade !=nil {_bfcf ._ccg ._eaac -=_e .FromEMU (int64 (*_gade ));};if _bgcc :=_fbfd .IndentAttr ;_bgcc !=nil {_bfcf ._ccg ._dcf =_e .FromEMU (int64 (*_bgcc ));};if _agbf :=_fbfd .LatinLnBrkAttr ;_agbf !=nil {_bfcf ._ccg ._fdbc =*_agbf ;};if _dedc :=_fbfd .LnSpc ;_dedc !=nil {if _fea :=_dedc .SpcPct ;_fea !=nil {if _fccab :=_fea .ValAttr .ST_TextSpacingPercent ;_fccab !=nil {_gcdf =float64 (*_fccab )/5000;};};};var _aafe float64 ;if _bga :=_fbfd .SpcBef ;_bga !=nil {if _eebff :=_bga .SpcPts ;_eebff !=nil {_aafe =float64 (_eebff .ValAttr )/100;};};_eccb :=_bfcf ._affa ;if len (_eccb )> 0{_aafe -=_eccb [len (_eccb )-1]._gbcb ;if _aafe < 0{_aafe =0;};};_bfcf ._ccg ._aga =_aafe ;if _gffd :=_fbfd .SpcAft ;_gffd !=nil {if _dff :=_gffd .SpcPts ;_dff !=nil {_bfcf ._ccg ._gbcb =float64 (_dff .ValAttr )/100;};};_bfcf ._ccg ._bfbe =_gcdf ;_bfcf ._ccg ._aac =_fbfd .AlgnAttr ;};func (_cecda *textboxContext )drawParagraphs (){_cecda ._bce .NewPage ();for _ ,_beaeb :=range _cecda ._affa {for _ ,_caed :=range _beaeb ._gfa {for _ ,_abee :=range _caed ._gfac {for _ ,_gdcc :=range _abee ._gcb {_bcgdd :=_cecda ._bce .NewStyledParagraph ();if _gdcc ._cecd {_gdcc ._bgcg =0;}else if _gdcc ._bac {_gdcc ._bgcg =1.2*_caed ._cbdg -_gdcc ._ebc ;};_aage :=_abee ._bdc +_gdcc ._bfaac ;_caf :=_beaeb ._geae +_caed ._agdd +_gdcc ._bgcg ;_bcgdd .SetPos (_aage ,_caf );_defe :=_bcgdd .Append (_gdcc ._cgd );if _gdcc ._baee !=nil {_defe .Style =*_gdcc ._baee ;};_cecda ._bce .Draw (_bcgdd );if _gdcc ._cab {_deaa :=_caf +_gdcc ._ebc +2;_d .DrawLine (_cecda ._bce ,_aage ,_deaa ,_aage +_gdcc ._ggba ,_deaa ,1,_gdcc ._baee .Color );};};};};};};func (_gfg *convertContext )tileImage (_agb *_cc .Image ,_dca *_aa .CT_TileInfoProperties ,_efa ,_afcd float64 )*_cc .Image {_dge ,_beb :=1.0,1.0;if _agg :=_dca .SxAttr ;_agg !=nil {_dge =_d .FromSTPercentage (_agg );};if _dbb :=_dca .SyAttr ;_dbb !=nil {_beb =_d .FromSTPercentage (_dbb );};_gbc :=_d .MakeTempCreator (_efa ,_afcd );_agb .Scale (_dge ,_beb );_afcde ,_gef :=_agb .Width (),_agb .Height ();var _cag ,_egf float64 ;if _fac :=_dca .TxAttr ;_fac !=nil {_cag =_e .FromEMU (_d .FromSTCoordinate (*_fac ));};if _eb :=_dca .TyAttr ;_eb !=nil {_egf =_e .FromEMU (_d .FromSTCoordinate (*_eb ));};if _cag > 0{_cag -=_afcde ;};if _egf > 0{_egf -=_gef ;};_dgd :=_gfg ._gca /_afcde +1;_add :=_gfg ._dcab /_gef +1;for _efc :=0.0;_efc <=_dgd ;_efc ++{_dcg :=_efc *_afcde ;for _ccd :=0.0;_ccd <=_add ;_ccd ++{_gfb :=_ccd *_gef ;_agb .SetPos (_dcg +_cag ,_gfb +_egf );_gbc .Draw (_agb );};};_agd ,_eeg :=_d .GetPageFromCreator (_gbc );if _eeg !=nil {_ae .Log .Debug ("\u0043\u0061\u006e\u006e\u006f\u0074 \u0067\u0065\u0074\u0020\u0069\u006d\u0061\u0067\u0065\u0020\u0066\u0072\u006fm\u0020\u0063\u0072\u0065\u0061\u0074\u006fr\u003a\u0020\u0025\u0073",_eeg );return nil ;};_gdad ,_eeg :=_ff .NewImageDevice ().Render (_agd );if _eeg !=nil {_ae .Log .Debug ("\u0043\u0061\u006eno\u0074\u0020\u0072\u0065\u006e\u0064\u0065\u0072\u0020\u0069\u006d\u0061\u0067\u0065\u003a\u0020\u0025\u0073",_eeg );return nil ;};_fec ,_eeg :=_gfg ._bfge .NewImageFromGoImage (_gdad );if _eeg !=nil {_ae .Log .Debug ("\u0043\u0061nn\u006f\u0074\u0020c\u0072\u0065\u0061\u0074e i\u006dag\u0065\u0020\u0066\u0072\u006f\u006d\u0020Go\u0049\u006d\u0061\u0067\u0065\u003a\u0020%\u0073",_eeg );return nil ;};return _fec ;};

// ConvertToPdf converts a presentation to a PDF file. This package is beta, breaking changes can take place.
func ConvertToPdf (pr *_db .Presentation )*_cc .Creator {_aca :=pr .X ().SldSz ;_dbg :=_e .FromEMU (int64 (_aca .CxAttr ));_cff :=_e .FromEMU (int64 (_aca .CyAttr ));_bd :=_cc .PageSize {_dbg ,_cff };_cec :=_cc .New ();_cec .SetPageSize (_bd );var _gc *_aa .Theme ;if len (pr .Themes ())> 0{_gc =pr .Themes ()[0];};for _ ,_fc :=range pr .Slides (){if _fc .X ()==nil {continue ;};_ffd :=&convertContext {_bfge :_cec ,_fgd :&_fc ,_dcdc :_fc .GetSlideLayout (),_gage :pr .SlideMasters ()[0].X (),_acd :pr ,_dac :_gc ,_ceace :_fc .X ().ClrMapOvr ,_dcab :_bd [1],_gca :_bd [0]};_ffd ._dcdc =_fc .GetSlideLayout ();_ffd .extractDefaultProperties ();_ffd .makeSlide ();_ffd .drawSlide ();};return _cec ;};func _abbd (_eee ,_bff *_aa .CT_TextListStyle )*_aa .CT_TextListStyle {_debcb :=_aa .NewCT_TextListStyle ();if _eee !=nil {*_debcb =*_eee ;};if _bff ==nil {return _debcb ;};_debcb .DefPPr =_efeg (_debcb .DefPPr ,_bff .DefPPr );_debcb .Lvl1pPr =_efeg (_debcb .Lvl1pPr ,_bff .Lvl1pPr );_debcb .Lvl2pPr =_efeg (_debcb .Lvl2pPr ,_bff .Lvl2pPr );_debcb .Lvl3pPr =_efeg (_debcb .Lvl3pPr ,_bff .Lvl3pPr );_debcb .Lvl4pPr =_efeg (_debcb .Lvl4pPr ,_bff .Lvl4pPr );_debcb .Lvl5pPr =_efeg (_debcb .Lvl5pPr ,_bff .Lvl5pPr );_debcb .Lvl6pPr =_efeg (_debcb .Lvl6pPr ,_bff .Lvl6pPr );_debcb .Lvl7pPr =_efeg (_debcb .Lvl7pPr ,_bff .Lvl7pPr );_debcb .Lvl8pPr =_efeg (_debcb .Lvl8pPr ,_bff .Lvl8pPr );_debcb .Lvl9pPr =_efeg (_debcb .Lvl9pPr ,_bff .Lvl9pPr );return _debcb ;};func (_egb *convertContext )getColorFromFontReference (_bgbc *_aa .CT_FontReference )_cc .Color {var _bcdb _cc .Color ;var _afed string ;if _ggffc :=_bgbc .SrgbClr ;_ggffc !=nil {_afed =_ggffc .ValAttr ;}else if _dcfd :=_bgbc .SchemeClr ;_dcfd !=nil {_afed =_d .GetColorStringFromDmlColor (_egb ._acd .GetColorBySchemeColor (_dcfd .ValAttr ));_afed =_d .AdjustColor (_afed ,_dcfd .EG_ColorTransform );};if _afed !=""{_bcdb =_cc .ColorRGBFromHex ("\u0023"+_afed );};return _bcdb ;};type background struct{_gagf _cc .Color ;_cbf float64 ;_ggff *_aa .CT_BlipFillProperties ;};func _cgae (_acfd int ,_gec bool )string {_dgbb :=(_acfd -1)/26+1;_dgdg :=byte ((_acfd -1)%26);if _gec {_dgdg +=byte (65);}else {_dgdg +=byte (97);};_bcag :=_cb .NewBuffer ([]byte {});for _bgecc :=0;_bgecc < _dgbb ;_bgecc ++{_bcag .Write ([]byte {_dgdg });};return _bcag .String ();};func (_bgbg *convertContext )makePdfImageFromBlipFill (_fbbeg *_aa .CT_BlipFillProperties )(*_cc .Image ,[]*_aa .CT_BlipChoice ,error ){if _fcac :=_fbbeg .Blip ;_fcac !=nil {if _bbda :=_fcac .EmbedAttr ;_bbda !=nil {_affe ,_adgee :=_bgbg ._fgd .GetImageByRelID (*_bbda );if _adgee {_gegf ,_effa :=_de .Open (_affe .Path ());if _effa !=nil {_ae .Log .Debug ("\u0046\u0069\u006c\u0065 o\u0070\u0065\u006e\u0020\u0065\u0072\u0072\u006f\u0072\u003a\u0020\u0025\u0073",_effa );return nil ,nil ,_effa ;};defer _gegf .Close ();_dade ,_ ,_effa :=_g .Decode (_gegf );if _effa !=nil {_ae .Log .Debug ("\u0044\u0065\u0063\u006fde\u0020\u0069\u006d\u0061\u0067\u0065\u0020\u0065\u0072\u0072\u006f\u0072\u003a\u0020%\u0073",_effa );return nil ,nil ,_effa ;};if _eabc :=_fbbeg .SrcRect ;_eabc !=nil {_ebba :=_dade .Bounds ().Size ();_fgc :=_ebba .X ;_adfb :=_ebba .Y ;var _baeee ,_dde ,_dgae ,_gace int ;var _dfe bool ;if _dada :=_eabc .LAttr ;_dada !=nil {_baeee =int (float64 (_fgc )*_d .FromSTPercentage (_dada ));_dfe =true ;}else {_baeee =0;};if _dee :=_eabc .TAttr ;_dee !=nil {_dgae =int (float64 (_adfb )*_d .FromSTPercentage (_dee ));_dfe =true ;}else {_dgae =0;};if _fbdg :=_eabc .RAttr ;_fbdg !=nil {_dde =int (float64 (_fgc )*(1-_d .FromSTPercentage (_fbdg )));_dfe =true ;}else {_dde =_fgc ;};if _cgaba :=_eabc .BAttr ;_cgaba !=nil {_gace =int (float64 (_adfb )*(1-_d .FromSTPercentage (_cgaba )));_dfe =true ;}else {_gace =_adfb ;};if _dfe {_dade =_d .CropImageByRect (_dade ,_g .Rect (_baeee ,_dgae ,_dde +1,_gace +1));};};_fcaa ,_effa :=_bgbg ._bfge .NewImageFromGoImage (_dade );if _effa !=nil {_ae .Log .Debug ("\u0043\u0061\u006e\u006e\u006ft\u0020\u0063\u0072\u0065\u0061\u0074\u0065\u0020\u0050\u0044\u0046\u0020\u0069m\u0061\u0067\u0065\u0020\u0066\u0072\u006f\u006d\u0020\u0047\u006f\u0020\u0069\u006d\u0061\u0067\u0065\u003a\u0020\u0025\u0073",_effa );return nil ,nil ,_effa ;};return _fcaa ,_fcac .Choice ,nil ;};};};return nil ,nil ,nil ;};func (_adba *convertContext )makeStyleFromRPr (_bcff *_aa .CT_TextCharacterProperties )(*_cc .TextStyle ,bool ,bool ,bool ){var _fdba ,_dce ,_ead bool ;_gdc :=_adba ._bfge .NewTextStyle ();if _bcff !=nil {_gfd :=_d .FontStyle_Regular ;_cbed :=_acbd (_bcff .BAttr );_bcdd :=_acbd (_bcff .IAttr );if _cbed &&_bcdd {_gfd =_d .FontStyle_BoldItalic ;}else if _cbed {_gfd =_d .FontStyle_Bold ;}else if _bcdd {_gfd =_d .FontStyle_Italic ;};_ead =_bcff .UAttr !=_aa .ST_TextUnderlineTypeUnset &&_bcff .UAttr !=_aa .ST_TextUnderlineTypeNone ;_eebf :="\u0064e\u0066\u0061\u0075\u006c\u0074";if _aff :=_bcff .Latin ;_aff !=nil {_eebf =_aff .TypefaceAttr ;}else if _cecb :=_bcff .Ea ;_cecb !=nil {_eebf =_cecb .TypefaceAttr ;}else if _fffa :=_bcff .Cs ;_fffa !=nil {_eebf =_fffa .TypefaceAttr ;}else if _bdd :=_bcff .Sym ;_bdd !=nil {_eebf =_bdd .TypefaceAttr ;};if _gee ,_acaga :=_d .StdFontsMap [_eebf ];_acaga {_gdc .Font =_d .AssignStdFontByName (_gdc ,_gee [_gfd ]);}else if _adca :=_d .GetRegisteredFont (_eebf ,_gfd );_adca !=nil {_gdc .Font =_adca ;}else {_ae .Log .Debug ("\u0046\u006f\u006e\u0074\u0020\u0025\u0073\u0020\u0077\u0069\u0074h\u0020\u0073\u0074\u0079\u006c\u0065\u0020\u0025s\u0020i\u0073\u0020\u006e\u006f\u0074\u0020\u0066\u006f\u0075\u006e\u0064\u002c\u0020\u0072\u0065\u0073\u0065\u0074 \u0074\u006f\u0020\u0064\u0065\u0066\u0061\u0075\u006c\u0074\u002e",_eebf ,_gfd );_gdc .Font =_d .AssignStdFontByName (_gdc ,_d .StdFontsMap ["\u0064e\u0066\u0061\u0075\u006c\u0074"][_gfd ]);};var _fgbc float64 ;if _ega :=_bcff .SzAttr ;_ega !=nil {_fgbc =float64 (*_ega )/100;}else {_fgbc =_d .DefaultFontSize ;};if _becb :=_bcff .BaselineAttr ;_becb !=nil {if _eaaf :=_becb .ST_PercentageDecimal ;_eaaf !=nil {if *_eaaf > 0{_fdba =true ;}else if *_eaaf < 0{_dce =true ;};};};if _fdba ||_dce {_fgbc *=0.64;};_gdc .FontSize =_fgbc ;_ebae :=0.0;if _degd :=_bcff .SpcAttr ;_degd !=nil {if _beef :=_degd .ST_TextPointUnqualified ;_beef !=nil {_ebae =float64 (*_beef )/100;};};_gdc .CharSpacing =_ebae ;};return &_gdc ,_fdba ,_dce ,_ead ;};func _gbbg (_eddg int ,_agdc bool )string {_cdfa :=_cb .NewBuffer ([]byte {});for _ ,_eadb :=range _edga {for {if _eddg < _eadb ._bddd {break ;};_cdfa .WriteString (_eadb ._eaf );_eddg -=_eadb ._bddd ;};};_ebdc :=_cdfa .String ();if _agdc {_ebdc =_gd .ToUpper (_ebdc );};return _ebdc ;};func (_gaba *textboxContext )adjustHeights (_efadf float64 ){if _gaba ._adcde ._cbdg < _efadf {_gaba ._ccg ._bddb +=(_efadf -_gaba ._adcde ._cbdg );_gaba ._adcde ._cbdg =_efadf ;};};func (_bbe *convertContext )stretchImage (_cg *_cc .Image ,_bcg *_aa .CT_StretchInfoProperties ,_fee ,_bec ,_fffb ,_age float64 )(*_cc .Image ,float64 ,float64 ){_cae :=_bcg .FillRect ;if _cae ==nil {_efb :=_cg .Width ()/_cg .Height ();_bfa :=_fffb /_age ;var _efg ,_ddf float64 ;if _efb > _bfa {_ddf =_age ;_efg =_age *_efb ;}else {_efg =_fffb ;_ddf =_fffb /_efb ;};_cg .Scale (_efg /_cg .Width (),_ddf /_cg .Height ());return _cg ,_fee ,_bec ;};var _fb ,_dcd ,_cca ,_befe float64 ;if _bfg :=_cae .LAttr ;_bfg !=nil {_cca =_d .FromSTPercentage (_bfg );};if _bcc :=_cae .TAttr ;_bcc !=nil {_fb =_d .FromSTPercentage (_bcc );};if _eae :=_cae .RAttr ;_eae !=nil {_befe =_d .FromSTPercentage (_eae );};if _dbe :=_cae .BAttr ;_dbe !=nil {_dcd =_d .FromSTPercentage (_dbe );};_fdd :=_fffb *(1-_cca -_befe );_dbc :=_age *(1-_fb -_dcd );_cg .Scale (_fdd /_cg .Width (),_dbc /_cg .Height ());return _cg ,_fee +_cca *_fffb ,_bec +_fb *_age ;};func (_fg *convertContext )getConnectors (_dcgg *_ffe .CT_Connector )[]_cc .Drawable {_ddfc ,_ ,_ ,_ ,_ ,_ ,_ :=_fg .getShapesFromSpPr (_dcgg .SpPr ,_dcgg .Style ,false );return _ddfc ;};