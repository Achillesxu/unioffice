//
// Copyright 2020 FoxyUtils ehf. All rights reserved.
//
// This is a commercial product and requires a license to operate.
// A trial license can be obtained at https://unidoc.io
//
// DO NOT EDIT: generated by unitwist Go source code obfuscator.
//
// Use of this source code is governed by the UniDoc End User License Agreement
// terms that can be accessed at https://unidoc.io/eula/

package convert ;import (_b "bytes";_c "errors";_ga "github.com/unidoc/unioffice/common";_ad "github.com/unidoc/unioffice/common/logger";_ee "github.com/unidoc/unioffice/common/tempstorage";_gf "github.com/unidoc/unioffice/internal/convertutils";_fc "github.com/unidoc/unioffice/measurement";
_f "github.com/unidoc/unioffice/presentation";_aa "github.com/unidoc/unioffice/schema/soo/dml";_d "github.com/unidoc/unioffice/schema/soo/dml/chart";_efg "github.com/unidoc/unioffice/schema/soo/pml";_ac "github.com/unidoc/unipdf/v3/contentstream/draw";
_ag "github.com/unidoc/unipdf/v3/core";_ae "github.com/unidoc/unipdf/v3/creator";_fg "github.com/unidoc/unipdf/v3/model";_fe "github.com/unidoc/unipdf/v3/render";_g "image";_e "image/color";_ef "image/draw";_eb "strconv";_ce "strings";);func (_adef *convertContext )extractDefaultProperties (){_cd :=_adef ._bca .X ();
_be :=_cd .DefaultTextStyle ;var _fbd ,_da ,_fbe ,_bed ,_fbb ,_bg ,_gfe ,_aef ,_dd ,_cgf *_aa .CT_TextParagraphProperties ;if _be !=nil {_fbd =_be .DefPPr ;_da =_fded (_be .Lvl1pPr ,_fbd );_fbe =_fded (_be .Lvl2pPr ,_fbd );_bed =_fded (_be .Lvl3pPr ,_fbd );
_fbb =_fded (_be .Lvl4pPr ,_fbd );_bg =_fded (_be .Lvl5pPr ,_fbd );_gfe =_fded (_be .Lvl6pPr ,_fbd );_aef =_fded (_be .Lvl7pPr ,_fbd );_dd =_fded (_be .Lvl8pPr ,_fbd );_cgf =_fded (_be .Lvl9pPr ,_fbd );_adef ._agfe =_fbd ;_adef ._fddf =_fbd .DefRPr ;};
_adef ._fgada =make ([]*_aa .CT_TextParagraphProperties ,9);_adef ._fgada [0]=_da ;_adef ._fgada [1]=_fbe ;_adef ._fgada [2]=_bed ;_adef ._fgada [3]=_fbb ;_adef ._fgada [4]=_bg ;_adef ._fgada [5]=_gfe ;_adef ._fgada [6]=_aef ;_adef ._fgada [7]=_dd ;_adef ._fgada [8]=_cgf ;
_db :=_adef ._bca .SlideMasters ()[0].X ();_daf :=_db .TxStyles ;_ece :=_daf .TitleStyle ;_adef ._efafe =_fded (_ece .DefPPr ,_fbd );_adef ._bcb =_adef ._efafe .DefRPr ;_adef ._cab =make ([]*_aa .CT_TextParagraphProperties ,9);_adef ._cab [0]=_fded (_ece .Lvl1pPr ,_da );
_adef ._cab [1]=_fded (_ece .Lvl2pPr ,_fbe );_adef ._cab [2]=_fded (_ece .Lvl3pPr ,_bed );_adef ._cab [3]=_fded (_ece .Lvl4pPr ,_fbb );_adef ._cab [4]=_fded (_ece .Lvl5pPr ,_bg );_adef ._cab [5]=_fded (_ece .Lvl6pPr ,_gfe );_adef ._cab [6]=_fded (_ece .Lvl7pPr ,_aef );
_adef ._cab [7]=_fded (_ece .Lvl8pPr ,_dd );_adef ._cab [8]=_fded (_ece .Lvl9pPr ,_cgf );_ca :=_daf .BodyStyle ;_adef ._gdbb =_fded (_ca .DefPPr ,_fbd );_adef ._cbed =_adef ._gdbb .DefRPr ;_adef ._acbgd =make ([]*_aa .CT_TextParagraphProperties ,9);_adef ._acbgd [0]=_fded (_ca .Lvl1pPr ,_da );
_adef ._acbgd [1]=_fded (_ca .Lvl2pPr ,_fbe );_adef ._acbgd [2]=_fded (_ca .Lvl3pPr ,_bed );_adef ._acbgd [3]=_fded (_ca .Lvl4pPr ,_fbb );_adef ._acbgd [4]=_fded (_ca .Lvl5pPr ,_bg );_adef ._acbgd [5]=_fded (_ca .Lvl6pPr ,_gfe );_adef ._acbgd [6]=_fded (_ca .Lvl7pPr ,_aef );
_adef ._acbgd [7]=_fded (_ca .Lvl8pPr ,_dd );_adef ._acbgd [8]=_fded (_ca .Lvl9pPr ,_cgf );};type textboxContext struct{_agff *convertContext ;_bcec float64 ;_fff float64 ;_adcgf *_ae .Creator ;_gbe float64 ;_ccdad []*paragraph ;_eeec *paragraph ;_fcda *line ;
_eafad *word ;_eggd bool ;};func (_dfeae *textboxContext )adjustHeights (_dbgf float64 ){if _dfeae ._fcda ._ccbd < _dbgf {_dfeae ._eeec ._ced +=(_dbgf -_dfeae ._fcda ._ccbd );_dfeae ._fcda ._ccbd =_dbgf ;};};func _fcdg (_cbge *_aa .CT_AdjPoint2D )(float64 ,float64 ){var _gbdg ,_degc float64 ;
_fcfd ,_aacf :=_cbge .XAttr ,_cbge .YAttr ;if _baaca :=_fcfd .ST_Coordinate ;_baaca !=nil {_gbdg =_fc .FromEMU (_gf .FromSTCoordinate (*_baaca ));};if _gdf :=_aacf .ST_Coordinate ;_gdf !=nil {_degc =_fc .FromEMU (_gf .FromSTCoordinate (*_gdf ));};return _gbdg ,_degc ;
};func (_acdg *convertContext )tileImage (_bgb *_ae .Image ,_gad *_aa .CT_TileInfoProperties ,_bfc ,_aeg float64 )*_ae .Image {_bfe ,_ecc :=1.0,1.0;if _aea :=_gad .SxAttr ;_aea !=nil {_bfe =_gf .FromSTPercentage (_aea );};if _bedf :=_gad .SyAttr ;_bedf !=nil {_ecc =_gf .FromSTPercentage (_bedf );
};_bafc :=_gf .MakeTempCreator (_bfc ,_aeg );_bgb .Scale (_bfe ,_ecc );_age ,_gae :=_bgb .Width (),_bgb .Height ();var _eg ,_acgc float64 ;if _cda :=_gad .TxAttr ;_cda !=nil {_eg =_fc .FromEMU (_gf .FromSTCoordinate (*_cda ));};if _fad :=_gad .TyAttr ;
_fad !=nil {_acgc =_fc .FromEMU (_gf .FromSTCoordinate (*_fad ));};if _eg > 0{_eg -=_age ;};if _acgc > 0{_acgc -=_gae ;};_dfbe :=_acdg ._fdf /_age +1;_acdga :=_acdg ._gbac /_gae +1;for _abf :=0.0;_abf <=_dfbe ;_abf ++{_fae :=_abf *_age ;for _cgd :=0.0;
_cgd <=_acdga ;_cgd ++{_fee :=_cgd *_gae ;_bgb .SetPos (_fae +_eg ,_fee +_acgc );_bafc .Draw (_bgb );};};_ccf ,_cgc :=_gf .GetPageFromCreator (_bafc );if _cgc !=nil {_ad .Log .Debug ("\u0043\u0061\u006e\u006e\u006f\u0074 \u0067\u0065\u0074\u0020\u0069\u006d\u0061\u0067\u0065\u0020\u0066\u0072\u006fm\u0020\u0063\u0072\u0065\u0061\u0074\u006fr\u003a\u0020\u0025\u0073",_cgc );
return nil ;};_caf ,_cgc :=_fe .NewImageDevice ().Render (_ccf );if _cgc !=nil {_ad .Log .Debug ("\u0043\u0061\u006eno\u0074\u0020\u0072\u0065\u006e\u0064\u0065\u0072\u0020\u0069\u006d\u0061\u0067\u0065\u003a\u0020\u0025\u0073",_cgc );return nil ;};_cdaa ,_cgc :=_acdg ._ceaf .NewImageFromGoImage (_caf );
if _cgc !=nil {_ad .Log .Debug ("\u0043\u0061nn\u006f\u0074\u0020c\u0072\u0065\u0061\u0074e i\u006dag\u0065\u0020\u0066\u0072\u006f\u006d\u0020Go\u0049\u006d\u0061\u0067\u0065\u003a\u0020%\u0073",_cgc );return nil ;};return _cdaa ;};func (_gdad *convertContext )makePdfDivisionFromTxBody (_efeg *_aa .CT_TextBody ,_egb ,_aafc float64 ,_cca *_aa .CT_TableStyleTextStyle )*_ae .Division {_fdd :=_gdad ._ceaf .NewDivision ();
_abe :=_gdad ._agfe ;_ecea :=_aa .ST_TextAnchoringTypeT ;if _bee :=_efeg .BodyPr ;_bee !=nil {if _bde :=_bee .AnchorAttr ;_bde !=_aa .ST_TextAnchoringTypeUnset {_ecea =_bee .AnchorAttr ;};};if _bbd :=_efeg .LstStyle ;_bbd !=nil {var _bag *_aa .CT_TextParagraphProperties ;
if _bbd .Lvl1pPr !=nil {_bag =_bbd .Lvl1pPr ;}else {_bag =_gdad ._fgada [0];};_abe =_fded (_bag ,_fded (_bbd .DefPPr ,_abe ));};for _ ,_cdac :=range _efeg .P {if _cdac !=nil {_bae :=_gdad ._ceaf .NewStyledParagraph ();_gdg :=_fded (_cdac .PPr ,_abe );_acgb :=_ggd (_cdac .EndParaRPr ,_gdg .DefRPr );
if len (_cdac .EG_TextRun )==0{_bae .Append ("\u000a");_fdd .Add (_bae );continue ;};for _ ,_ffdg :=range _cdac .EG_TextRun {if _cdcd :=_ffdg .Br ;_cdcd !=nil {_bae .Append ("\u000a");}else if _ged :=_ffdg .R ;_ged !=nil {_gdd :=_fcae (_ged .RPr ,_cca );
_gdd =_ggd (_gdd ,_acgb );var _ecf _ae .Color ;if _gdd .SolidFill !=nil {_ecf ,_ =_gdad .getColorFromSolidFill (_gdd .SolidFill );}else {_ecf =_ae .ColorBlack ;};_dbbf ,_gfg ,_ada ,_ :=_gdad .makeStyleFromRPr (_gdd );_dbbf .Color =_ecf ;if _gfg {_dbbf .TextRise =0.5;
}else if _ada {_dbbf .TextRise =-0.5;};_aca :=_ged .T ;if _gdd .CapAttr ==_aa .ST_TextCapsTypeAll {for _ ,_efd :=range _aca {_efd =[]rune (_ce .ToUpper (string (_efd )))[0];};};_bff :=_bae .Append (_aca );_bff .Style =*_dbbf ;};};_ =_ecea ;_fdd .Add (_bae );
};};return _fdd ;};func _faffc (_fcbdc ,_eadf *_aa .CT_TextBodyProperties )*_aa .CT_TextBodyProperties {_fdfc :=_aa .NewCT_TextBodyProperties ();if _fcbdc !=nil {*_fdfc =*_fcbdc ;};if _eadf ==nil {return _fdfc ;};if _fdfc .RotAttr ==nil {_fdfc .RotAttr =_eadf .RotAttr ;
};if _fdfc .SpcFirstLastParaAttr ==nil {_fdfc .SpcFirstLastParaAttr =_eadf .SpcFirstLastParaAttr ;};if _fdfc .VertOverflowAttr ==_aa .ST_TextVertOverflowTypeUnset {_fdfc .VertOverflowAttr =_eadf .VertOverflowAttr ;};if _fdfc .HorzOverflowAttr ==_aa .ST_TextHorzOverflowTypeUnset {_fdfc .HorzOverflowAttr =_eadf .HorzOverflowAttr ;
};if _fdfc .VertAttr ==_aa .ST_TextVerticalTypeUnset {_fdfc .VertAttr =_eadf .VertAttr ;};if _fdfc .WrapAttr ==_aa .ST_TextWrappingTypeUnset {_fdfc .WrapAttr =_eadf .WrapAttr ;};if _fdfc .LInsAttr ==nil {_fdfc .LInsAttr =_eadf .LInsAttr ;};if _fdfc .TInsAttr ==nil {_fdfc .TInsAttr =_eadf .TInsAttr ;
};if _fdfc .RInsAttr ==nil {_fdfc .RInsAttr =_eadf .RInsAttr ;};if _fdfc .BInsAttr ==nil {_fdfc .BInsAttr =_eadf .BInsAttr ;};if _fdfc .NumColAttr ==nil {_fdfc .NumColAttr =_eadf .NumColAttr ;};if _fdfc .SpcColAttr ==nil {_fdfc .SpcColAttr =_eadf .SpcColAttr ;
};if _fdfc .RtlColAttr ==nil {_fdfc .RtlColAttr =_eadf .RtlColAttr ;};if _fdfc .AnchorAttr ==_aa .ST_TextAnchoringTypeUnset {_fdfc .AnchorAttr =_eadf .AnchorAttr ;};if _fdfc .AnchorCtrAttr ==nil {_fdfc .AnchorCtrAttr =_eadf .AnchorCtrAttr ;};if _fdfc .ForceAAAttr ==nil {_fdfc .ForceAAAttr =_eadf .ForceAAAttr ;
};if _fdfc .UprightAttr ==nil {_fdfc .UprightAttr =_eadf .UprightAttr ;};if _fdfc .CompatLnSpcAttr ==nil {_fdfc .CompatLnSpcAttr =_eadf .CompatLnSpcAttr ;};if _fdfc .PrstTxWarp ==nil {_fdfc .PrstTxWarp =_eadf .PrstTxWarp ;};if _fdfc .NoAutofit ==nil {_fdfc .NoAutofit =_eadf .NoAutofit ;
};if _fdfc .NormAutofit ==nil {_fdfc .NormAutofit =_eadf .NormAutofit ;};if _fdfc .SpAutoFit ==nil {_fdfc .SpAutoFit =_eadf .SpAutoFit ;};if _fdfc .Scene3d ==nil {_fdfc .Scene3d =_eadf .Scene3d ;};if _fdfc .Sp3d ==nil {_fdfc .Sp3d =_eadf .Sp3d ;};if _fdfc .FlatTx ==nil {_fdfc .FlatTx =_eadf .FlatTx ;
};if _fdfc .ExtLst ==nil {_fdfc .ExtLst =_eadf .ExtLst ;};return _fdfc ;};func (_gbad *textboxContext )addPrefix (_gaag *prefixData ,_bbc *_ae .TextStyle ){_dfgg :=_gfgge (_gaag ._aadf );_dee :=*_bbc ;if _gaag ._cgda {_dee .Font =_gf .AssignStdFontByName (_dee ,"\u0053\u0079\u006d\u0062\u006f\u006c");
};for _ ,_adec :=range _dfgg {_adec ._adcc =&_dee ;_gbad .addTextSymbol (_adec );};_cbae :=-(_gaag ._dgff +_gbad ._eafad ._ffad );if _cbae < 0{_cbae =0;};_fef :=&symbol {_cfaf :"\u0020",_ccbf :_cbae };_gbad .addTextSymbol (_fef );_gbad ._eafad ._fddfg +=(_gaag ._dgff +_gaag ._bdfd );
};func _fded (_aace ,_eadb *_aa .CT_TextParagraphProperties )*_aa .CT_TextParagraphProperties {_fcge :=_aa .NewCT_TextParagraphProperties ();if _aace !=nil {*_fcge =*_aace ;};if _eadb ==nil {return _fcge ;};if _fcge .MarLAttr ==nil {_fcge .MarLAttr =_eadb .MarLAttr ;
};if _fcge .MarRAttr ==nil {_fcge .MarRAttr =_eadb .MarRAttr ;};if _fcge .LvlAttr ==nil {_fcge .LvlAttr =_eadb .LvlAttr ;};if _fcge .IndentAttr ==nil {_fcge .IndentAttr =_eadb .IndentAttr ;};if _fcge .AlgnAttr ==_aa .ST_TextAlignTypeUnset {_fcge .AlgnAttr =_eadb .AlgnAttr ;
};if _fcge .DefTabSzAttr ==nil {_fcge .DefTabSzAttr =_eadb .DefTabSzAttr ;};if _fcge .RtlAttr ==nil {_fcge .RtlAttr =_eadb .RtlAttr ;};if _fcge .EaLnBrkAttr ==nil {_fcge .EaLnBrkAttr =_eadb .EaLnBrkAttr ;};if _fcge .FontAlgnAttr ==_aa .ST_TextFontAlignTypeUnset {_fcge .FontAlgnAttr =_eadb .FontAlgnAttr ;
};if _fcge .LatinLnBrkAttr ==nil {_fcge .LatinLnBrkAttr =_eadb .LatinLnBrkAttr ;};if _fcge .HangingPunctAttr ==nil {_fcge .HangingPunctAttr =_eadb .HangingPunctAttr ;};if _fcge .LnSpc ==nil {_fcge .LnSpc =_eadb .LnSpc ;};if _fcge .SpcBef ==nil {_fcge .SpcBef =_eadb .SpcBef ;
};if _fcge .SpcAft ==nil {_fcge .SpcAft =_eadb .SpcAft ;};if _fcge .BuClrTx ==nil {_fcge .BuClrTx =_eadb .BuClrTx ;};if _fcge .BuClr ==nil {_fcge .BuClr =_eadb .BuClr ;};if _fcge .BuSzTx ==nil {_fcge .BuSzTx =_eadb .BuSzTx ;};if _fcge .BuSzPct ==nil {_fcge .BuSzPct =_eadb .BuSzPct ;
};if _fcge .BuSzPts ==nil {_fcge .BuSzPts =_eadb .BuSzPts ;};if _fcge .BuFontTx ==nil {_fcge .BuFontTx =_eadb .BuFontTx ;};if _fcge .BuFont ==nil {_fcge .BuFont =_eadb .BuFont ;};if _fcge .BuNone ==nil {_fcge .BuNone =_eadb .BuNone ;};if _fcge .BuAutoNum ==nil {_fcge .BuAutoNum =_eadb .BuAutoNum ;
};if _fcge .BuChar ==nil {_fcge .BuChar =_eadb .BuChar ;};if _fcge .BuBlip ==nil {_fcge .BuBlip =_eadb .BuBlip ;};if _fcge .TabLst ==nil {_fcge .TabLst =_eadb .TabLst ;};if _fcge .ExtLst ==nil {_fcge .ExtLst =_eadb .ExtLst ;};_fcge .DefRPr =_ggd (_fcge .DefRPr ,_eadb .DefRPr );
return _fcge ;};const (FontStyle_Regular FontStyle =0;FontStyle_Bold FontStyle =1;FontStyle_Italic FontStyle =2;FontStyle_BoldItalic FontStyle =3;);func (_fcgd *convertContext )makePdfImageFromBlipFill (_cebf *_aa .CT_BlipFillProperties ,_febb bool )(*_ae .Image ,[]*_aa .CT_BlipChoice ,error ){if _abbea :=_cebf .Blip ;
_abbea !=nil {if _ggcc :=_abbea .EmbedAttr ;_ggcc !=nil {var _bda _ga .ImageRef ;var _ebed bool ;if _febb {_bda ,_ebed =_fcgd ._gcgf .GetLayoutImageByRelID (*_ggcc );}else {_bda ,_ebed =_fcgd ._gcgf .GetImageByRelID (*_ggcc );};if _ebed {_aba ,_aaae :=_ee .Open (_bda .Path ());
if _aaae !=nil {_ad .Log .Debug ("\u0046\u0069\u006c\u0065 o\u0070\u0065\u006e\u0020\u0065\u0072\u0072\u006f\u0072\u003a\u0020\u0025\u0073",_aaae );return nil ,nil ,_aaae ;};defer _aba .Close ();_dfde ,_ ,_aaae :=_g .Decode (_aba );if _aaae !=nil {_ad .Log .Debug ("\u0044\u0065\u0063\u006fde\u0020\u0069\u006d\u0061\u0067\u0065\u0020\u0065\u0072\u0072\u006f\u0072\u003a\u0020%\u0073",_aaae );
return nil ,nil ,_aaae ;};if _edca :=_cebf .SrcRect ;_edca !=nil {_gefb :=_dfde .Bounds ().Size ();_abgd :=_gefb .X ;_cac :=_gefb .Y ;var _baba ,_cfef ,_dcba ,_fbgf int ;var _gedb bool ;if _fadb :=_edca .LAttr ;_fadb !=nil {_baba =int (float64 (_abgd )*_gf .FromSTPercentage (_fadb ));
_gedb =true ;}else {_baba =0;};if _adcgc :=_edca .TAttr ;_adcgc !=nil {_dcba =int (float64 (_cac )*_gf .FromSTPercentage (_adcgc ));_gedb =true ;}else {_dcba =0;};if _bdef :=_edca .RAttr ;_bdef !=nil {_cfef =int (float64 (_abgd )*(1-_gf .FromSTPercentage (_bdef )));
_gedb =true ;}else {_cfef =_abgd ;};if _cddg :=_edca .BAttr ;_cddg !=nil {_fbgf =int (float64 (_cac )*(1-_gf .FromSTPercentage (_cddg )));_gedb =true ;}else {_fbgf =_cac ;};if _gedb {_dfde =_gf .CropImageByRect (_dfde ,_g .Rect (_baba ,_dcba ,_cfef +1,_fbgf +1));
};};_cded ,_aaae :=_fcgd ._ceaf .NewImageFromGoImage (_dfde );_cded .SetEncoder (_ag .NewFlateEncoder ());if _aaae !=nil {_ad .Log .Debug ("\u0043\u0061\u006e\u006e\u006ft\u0020\u0063\u0072\u0065\u0061\u0074\u0065\u0020\u0050\u0044\u0046\u0020\u0069m\u0061\u0067\u0065\u0020\u0066\u0072\u006f\u006d\u0020\u0047\u006f\u0020\u0069\u006d\u0061\u0067\u0065\u003a\u0020\u0025\u0073",_aaae );
return nil ,nil ,_aaae ;};return _cded ,_abbea .Choice ,nil ;};};};return nil ,nil ,nil ;};type prefixData struct{_aadf string ;_cgda bool ;_bdfd float64 ;_dgff float64 ;};func (_bgg *convertContext )makePdfBlockFromTxBody (_gaff *_aa .CT_TextBody ,_gfea *_aa .CT_TextBodyProperties ,_gdc *_aa .CT_TextListStyle ,_cebad ,_gca float64 ,_fgba _ae .Color ,_gfgg ,_agb bool )(*_ae .Block ,error ){var _bac *_aa .CT_TextParagraphProperties ;
if _ege :=_gaff .LstStyle ;_ege !=nil {var _bcgb *_aa .CT_TextParagraphProperties ;if _ege .Lvl1pPr !=nil {_bcgb =_ege .Lvl1pPr ;};_bac =_fded (_bcgb ,_ege .DefPPr );};var _dedaf *_aa .CT_TextParagraphProperties ;if _bac !=nil {if _gfgg {_dedaf =_bgg ._cab [0];
}else if _agb {_dedaf =_bgg ._acbgd [0];}else {_dedaf =_bgg ._fgada [0];};if _gdc !=nil {_dedaf =_fded (_fded (_gdc .Lvl1pPr ,_gdc .DefPPr ),_dedaf );};_dedaf =_fded (_bac ,_dedaf );}else {if _gfgg {_dedaf =_bgg ._efafe ;}else if _agb {_dedaf =_bgg ._gdbb ;
}else {_dedaf =_bgg ._agfe ;};};_ccg ,_ddd :=_egda (2.5),_egda (2.5);_agd ,_gfad :=_egda (1.3),_egda (1.3);_efa :=true ;_abde :=_aa .ST_TextAnchoringTypeT ;if _gfea !=nil {if _cebg :=_gfea .AnchorAttr ;_cebg !=_aa .ST_TextAnchoringTypeUnset {_abde =_cebg ;
};};if _gdab :=_gaff .BodyPr ;_gdab !=nil {if _feed :=_gdab .LInsAttr ;_feed !=nil {_ccg =_fc .FromEMU (_gf .FromSTCoordinate32 (*_feed ));};if _gcaa :=_gdab .TInsAttr ;_gcaa !=nil {_agd =_fc .FromEMU (_gf .FromSTCoordinate32 (*_gcaa ));};if _ffa :=_gdab .RInsAttr ;
_ffa !=nil {_ddd =_fc .FromEMU (_gf .FromSTCoordinate32 (*_ffa ));};if _gdabd :=_gdab .BInsAttr ;_gdabd !=nil {_gfad =_fc .FromEMU (_gf .FromSTCoordinate32 (*_gdabd ));};_efa =_gdab .WrapAttr !=_aa .ST_TextWrappingTypeNone ;if _ebg :=_gdab .AnchorAttr ;
_ebg !=_aa .ST_TextAnchoringTypeUnset {_abde =_gdab .AnchorAttr ;};};_gbgc :=_gf .MakeTempCreator (_cebad ,_gca );_gbgc .SetPageMargins (_ccg ,_ddd ,_agd ,_gfad );_bbdf :=&textboxContext {_agff :_bgg ,_eggd :_efa ,_bcec :_cebad -_ccg -_ddd ,_fff :_gca -_agd -_gfad ,_adcgf :_gbgc ,_ccdad :[]*paragraph {}};
_eea :=1;for _ ,_cgga :=range _gaff .P {if _cgga !=nil {_acc :=_cgga .PPr ;var _gafff *prefixData ;if _acc !=nil &&_acc .BuNone ==nil {var _ebdd string ;var _eff bool ;if _aec :=_acc .BuAutoNum ;_aec !=nil {var _adefa string ;if _dac :=_aec .StartAtAttr ;
_dac !=nil {_eea =int (*_dac );};var _beg string ;switch _aec .TypeAttr {case _aa .ST_TextAutonumberSchemeAlphaUcParenBoth ,_aa .ST_TextAutonumberSchemeAlphaUcParenR ,_aa .ST_TextAutonumberSchemeAlphaUcPeriod :_beg =_efec (_eea ,true );case _aa .ST_TextAutonumberSchemeAlphaLcParenBoth ,_aa .ST_TextAutonumberSchemeAlphaLcParenR ,_aa .ST_TextAutonumberSchemeAlphaLcPeriod :_beg =_efec (_eea ,false );
case _aa .ST_TextAutonumberSchemeRomanUcParenBoth ,_aa .ST_TextAutonumberSchemeRomanUcParenR ,_aa .ST_TextAutonumberSchemeRomanUcPeriod :_beg =_eaa (_eea ,true );case _aa .ST_TextAutonumberSchemeRomanLcParenBoth ,_aa .ST_TextAutonumberSchemeRomanLcParenR ,_aa .ST_TextAutonumberSchemeRomanLcPeriod :_beg =_eaa (_eea ,false );
default:_beg =_eb .Itoa (_eea );};switch _aec .TypeAttr {case _aa .ST_TextAutonumberSchemeAlphaLcPeriod ,_aa .ST_TextAutonumberSchemeAlphaUcPeriod ,_aa .ST_TextAutonumberSchemeArabicPeriod ,_aa .ST_TextAutonumberSchemeRomanLcPeriod ,_aa .ST_TextAutonumberSchemeRomanUcPeriod ,_aa .ST_TextAutonumberSchemeArabicDbPeriod ,_aa .ST_TextAutonumberSchemeEa1ChsPeriod ,_aa .ST_TextAutonumberSchemeEa1ChtPeriod ,_aa .ST_TextAutonumberSchemeEa1JpnChsDbPeriod ,_aa .ST_TextAutonumberSchemeEa1JpnKorPeriod ,_aa .ST_TextAutonumberSchemeThaiAlphaPeriod ,_aa .ST_TextAutonumberSchemeThaiNumPeriod ,_aa .ST_TextAutonumberSchemeHindiAlphaPeriod ,_aa .ST_TextAutonumberSchemeHindiNumPeriod ,_aa .ST_TextAutonumberSchemeHindiAlpha1Period :_adefa ="\u002e";
case _aa .ST_TextAutonumberSchemeAlphaLcParenR ,_aa .ST_TextAutonumberSchemeAlphaUcParenR ,_aa .ST_TextAutonumberSchemeArabicParenR ,_aa .ST_TextAutonumberSchemeRomanLcParenR ,_aa .ST_TextAutonumberSchemeRomanUcParenR ,_aa .ST_TextAutonumberSchemeThaiAlphaParenR ,_aa .ST_TextAutonumberSchemeThaiNumParenR ,_aa .ST_TextAutonumberSchemeHindiNumParenR :_adefa ="\u0029";
};_ebdd =_beg +_adefa ;_eea ++;}else if _bgf :=_acc .BuChar ;_bgf !=nil {_adg :=_bgf .CharAttr ;if _bge ,_gfdc :=_abca [_adg ];_gfdc {_adg =string (rune (_bge ));}else {_adg ="\u2022";};_ebdd =_adg ;_eff =true ;};if _ebdd !=""{var _caa ,_gce float64 ;if _acc .MarLAttr !=nil {_caa =_fc .FromEMU (int64 (*_acc .MarLAttr ));
};if _acc .IndentAttr !=nil {_gce =_fc .FromEMU (int64 (*_acc .IndentAttr ));};_gafff =&prefixData {_aadf :_ebdd ,_cgda :_eff ,_bdfd :_caa ,_dgff :_gce };};};_acc =_fded (_acc ,_dedaf );_bce :=_ggd (_cgga .EndParaRPr ,_acc .DefRPr );_bbdf .newParagraph ();
_bbdf .assignPropsToCurrentParagraph (_acc );_bbdf .newLine ();_bbdf .newWord ();for _ebc ,_adcg :=range _cgga .EG_TextRun {_bbdf .addTextRun (_adcg ,_bce ,_fgba ,_gafff );if _ebc > 0{_gafff =nil ;};};_bbdf .addCurrentWordToParagraph ();};_bbdf .addCurrentParagraph ();
};_bbdf .alignVertically (_abde );_bbdf .drawParagraphs ();return _gf .MakeBlockFromCreator (_gbgc );};func _dab (_gace *_efg .CT_Shape )(_efg .ST_PlaceholderType ,*uint32 ){if _agbg :=_gace .NvSpPr ;_agbg !=nil {if _cged :=_agbg .NvPr ;_cged !=nil {if _beae :=_cged .Ph ;
_beae !=nil {return _beae .TypeAttr ,_beae .IdxAttr ;};};};return _efg .ST_PlaceholderTypeUnset ,nil ;};func (_bgedd *convertContext )getColorFromSolidFill (_gbfa *_aa .CT_SolidColorFillProperties )(_ae .Color ,float64 ){if _gbfa ==nil {return nil ,1;};
var _ecfg string ;_baac :=1.0;if _dfaf :=_gbfa .SrgbClr ;_dfaf !=nil {_ecfg =_dfaf .ValAttr ;_baac =_gf .GetOpacityFromColorTransform (_dfaf .EG_ColorTransform );}else if _dgg :=_gbfa .SchemeClr ;_dgg !=nil {_ecfg =_gf .GetColorStringFromDmlColor (_bgedd ._gcgf .GetColorBySchemeColor (_dgg .ValAttr ));
_ecfg =_gf .AdjustColor (_ecfg ,_dgg .EG_ColorTransform );_baac =_gf .GetOpacityFromColorTransform (_dgg .EG_ColorTransform );};if _ecfg !=""{_aag :=_ae .ColorRGBFromHex ("\u0023"+_ecfg );return _aag ,_baac ;};return nil ,1;};func (_edge *textboxContext )addTextSymbol (_bfec *symbol ){_ebea :=_ae .New ();
_dfdg :=_ebea .NewStyledParagraph ();_dfdg .SetMargins (0,0,0,0);_bbf :=_dfdg .Append (_bfec ._cfaf );_aeb :=0.0;if _bfec ._adcc !=nil {_bbf .Style =*_bfec ._adcc ;if _bfec ._adcc .CharSpacing !=0{_aeb =_bfec ._adcc .CharSpacing ;};};_bfec ._ddb =_dfdg .Height ();
_bfec ._dgbg =_dfdg .Height ()*1.2;if _bfec ._dgbg < _edge ._eeec ._egc {_bfec ._dgbg =_edge ._eeec ._egc ;};if _bfec ._ccbf ==0{_bfec ._ccbf =_dfdg .Width ()+_aeb ;};if len (_edge ._eafad ._ddfc )> 0{_cggb :=_edge ._eafad ._ddfc [len (_edge ._eafad ._ddfc )-1]._cfaf ;
if _edge ._eeec ._cbd ||_gf .IsNoSpaceLanguage (_cggb )||(_cggb =="\u0020")!=(_bfec ._cfaf =="\u0020"){_edge .addCurrentWordToParagraph ();_edge .newWord ();};};_edge ._eafad ._ddfc =append (_edge ._eafad ._ddfc ,_bfec );_bfec ._gff =_edge ._eafad ._ffad ;
_edge ._eafad ._ffad +=_bfec ._ccbf ;if _bfec ._cfaf !="\u0020"{_edge ._eafad ._cbaf =false ;};};type romanMatch struct{_abbe int ;_aedc string ;};var _cfe =[]romanMatch {romanMatch {1000,"\u006d"},romanMatch {900,"\u0063\u006d"},romanMatch {500,"\u0064"},romanMatch {400,"\u0063\u0064"},romanMatch {100,"\u0063"},romanMatch {90,"\u0078\u0063"},romanMatch {50,"\u006c"},romanMatch {40,"\u0078\u006c"},romanMatch {10,"\u0078"},romanMatch {9,"\u0069\u0078"},romanMatch {5,"\u0076"},romanMatch {4,"\u0069\u0076"},romanMatch {1,"\u0069"}};


// RegisterFont makes a PdfFont accessible for using in converting to PDF.
func RegisterFont (name string ,style FontStyle ,font *_fg .PdfFont ){_gf .RegisterFont (name ,style ,font );};type symbolStyle struct{_ddagc *string ;_adda *float64 ;_ebcc *string ;_eacb *bool ;_bad *bool ;_eeac *bool ;_cgcg *bool ;_fbbe *bool ;};func (_gaec *line )moveRight (_ecd float64 ){for _ ,_badg :=range _gaec ._fbbb {_badg ._fddfg +=_ecd ;
};};type line struct{_edg float64 ;_efcc float64 ;_bagb float64 ;_dcde float64 ;_ccbd float64 ;_fbbb []*word ;};func _edcaa (_aabe ,_dcc *_aa .CT_TableStyleTextStyle )*_aa .CT_TableStyleTextStyle {_aafg :=_aa .NewCT_TableStyleTextStyle ();if _aabe !=nil {*_aafg =*_aabe ;
};if _dcc ==nil {return _aafg ;};if _aafg .BAttr ==_aa .ST_OnOffStyleTypeUnset {_aafg .BAttr =_dcc .BAttr ;};if _aafg .IAttr ==_aa .ST_OnOffStyleTypeUnset {_aafg .IAttr =_dcc .IAttr ;};if _aafg .Font ==nil {_aafg .Font =_dcc .Font ;};if _aafg .FontRef ==nil {_aafg .FontRef =_dcc .FontRef ;
};if _aafg .ScrgbClr ==nil {_aafg .ScrgbClr =_dcc .ScrgbClr ;};if _aafg .SrgbClr ==nil {_aafg .SrgbClr =_dcc .SrgbClr ;};if _aafg .HslClr ==nil {_aafg .HslClr =_dcc .HslClr ;};if _aafg .SysClr ==nil {_aafg .SysClr =_dcc .SysClr ;};if _aafg .SchemeClr ==nil {_aafg .SchemeClr =_dcc .SchemeClr ;
};if _aafg .PrstClr ==nil {_aafg .PrstClr =_dcc .PrstClr ;};return _aafg ;};func (_efda *convertContext )getColorFromMatrixReference (_cffc *_aa .CT_StyleMatrixReference )_ae .Color {if _cffc ==nil {return nil ;};var _affe _ae .Color ;var _faef string ;
if _egd :=_cffc .SrgbClr ;_egd !=nil {_faef =_egd .ValAttr ;}else if _fbfb :=_cffc .SchemeClr ;_fbfb !=nil {_faef =_gf .GetColorStringFromDmlColor (_efda ._bca .GetColorBySchemeColor (_fbfb .ValAttr ));_faef =_gf .AdjustColor (_faef ,_fbfb .EG_ColorTransform );
};if _faef !=""{_affe =_ae .ColorRGBFromHex ("\u0023"+_faef );};return _affe ;};func (_ccba *convertContext )getStyleColors (_eddg *_aa .CT_ShapeStyle )(_ae .Color ,_ae .Color ,_ae .Color ){var _eaad ,_cgfg ,_bage _ae .Color ;if _gdfd :=_eddg .LnRef ;_gdfd !=nil {_cgfg =_ccba .getColorFromMatrixReference (_gdfd );
};if _ccbg :=_eddg .FillRef ;_ccbg !=nil {_bage =_ccba .getColorFromMatrixReference (_ccbg );};if _cege :=_eddg .FontRef ;_cege !=nil {_eaad =_ccba .getColorFromFontReference (_cege );};return _eaad ,_bage ,_cgfg ;};func (_dcf *textboxContext )assignPropsToCurrentParagraph (_efed *_aa .CT_TextParagraphProperties ){_gbddf :=12.4;
if _efed ==nil {_dcf ._eeec ._egc =_gbddf ;return ;};if _aaaf :=_efed .DefRPr ;_aaaf !=nil {_ebde :=_aaaf .SzAttr ;if _ebde !=nil {_ddcce :=float64 (*_ebde )/1200;if _gbddf <=_ddcce {_gbddf =_ddcce ;};};};if _ccde :=_efed .MarLAttr ;_ccde !=nil {_dcf ._eeec ._gee =_fc .FromEMU (int64 (*_ccde ));
};_dcf ._eeec ._fdfd =_dcf ._bcec ;if _eeb :=_efed .MarRAttr ;_eeb !=nil {_dcf ._eeec ._fdfd -=_fc .FromEMU (int64 (*_eeb ));};if _gcf :=_efed .IndentAttr ;_gcf !=nil {_dcf ._eeec ._cgb =_fc .FromEMU (int64 (*_gcf ));};if _geda :=_efed .LatinLnBrkAttr ;
_geda !=nil {_dcf ._eeec ._cbd =*_geda ;};if _bfaf :=_efed .LnSpc ;_bfaf !=nil {if _eba :=_bfaf .SpcPct ;_eba !=nil {if _eage :=_eba .ValAttr .ST_TextSpacingPercent ;_eage !=nil {_gbddf =float64 (*_eage )/5000;};};};var _aga float64 ;if _eed :=_efed .SpcBef ;
_eed !=nil {if _bgbg :=_eed .SpcPts ;_bgbg !=nil {_aga =float64 (_bgbg .ValAttr )/100;};};_fddc :=_dcf ._ccdad ;if len (_fddc )> 0{_aga -=_fddc [len (_fddc )-1]._efc ;if _aga < 0{_aga =0;};};_dcf ._eeec ._cgcf =_aga ;if _cdgg :=_efed .SpcAft ;_cdgg !=nil {if _aege :=_cdgg .SpcPts ;
_aege !=nil {_dcf ._eeec ._efc =float64 (_aege .ValAttr )/100;};};_dcf ._eeec ._egc =_gbddf ;_dcf ._eeec ._gfed =_efed .AlgnAttr ;};func (_dca *convertContext )getShapes (_ecef *_efg .CT_Shape )[]_ae .Drawable {_bcf :=[]_ae .Drawable {};_cce :=_ecef .SpPr ;
if _cce ==nil {return _bcf ;};var _bdf bool ;if _fda :=_ecef .UseBgFillAttr ;_fda !=nil {_bdf =*_fda ;};_bdg ,_fbec ,_cead ,_eag ,_agg ,_fca ,_dfe :=_dca .getShapesFromSpPr (_cce ,_ecef .Style ,_bdf );_bcf =append (_bcf ,_bdg ...);if _bcg :=_ecef .TxBody ;
_bcg !=nil {_fgfg ,_ceaa ,_bea ,_dfd ,_cbgc :=_dca .getPhData (_ecef );if _fgfg !=nil &&!_dfe {_fbec ,_cead ,_eag ,_agg =_gf .GetDataFromXfrm (_fgfg );};_ebd ,_gafc :=_dca .makePdfBlockFromTxBody (_bcg ,_ceaa ,_bea ,_eag ,_agg ,_fca ,_dfd ,_cbgc );if _gafc !=nil {_ad .Log .Debug ("\u0043\u0061\u006e\u006e\u006f\u0074\u0020\u006d\u0061\u006b\u0065\u0020\u0050\u0044\u0046\u0020\u0062\u006c\u006f\u0063\u006b\u0020\u0066\u0072o\u006d\u0020\u0074\u0065\u0078t\u0062\u006fx\u003a\u0020\u0025\u0073",_gafc );
}else if _ebd !=nil {_ebd .SetPos (_fbec ,_cead );_bcf =append (_bcf ,_ebd );};};return _bcf ;};func (_cfc *convertContext )drawSlide (){_cfc ._ceaf .NewPage ();for _ ,_acg :=range _cfc ._aega {if _acg !=nil {_cfc ._ceaf .MoveTo (0,0);_cfc ._ceaf .Draw (_acg );
};};};type background struct{_bfga _ae .Color ;_ebcg float64 ;_gaeg *_aa .CT_BlipFillProperties ;};

// ConvertToPdf converts a presentation to a PDF file. This package is beta, breaking changes can take place.
func ConvertToPdf (pr *_f .Presentation )*_ae .Creator {_af :=pr .X ().SldSz ;_ccd :=_fc .FromEMU (int64 (_af .CxAttr ));_ade :=_fc .FromEMU (int64 (_af .CyAttr ));_bb :=_ae .PageSize {_ccd ,_ade };_fb :=_ae .New ();_fb .SetPageSize (_bb );var _gd *_aa .Theme ;
if len (pr .Themes ())> 0{_gd =pr .Themes ()[0];};for _ ,_fcd :=range pr .Slides (){if _fcd .X ()==nil {continue ;};_ec :=&convertContext {_ceaf :_fb ,_gcgf :&_fcd ,_cfb :_fcd .GetSlideLayout (),_afa :pr .SlideMasters ()[0].X (),_bca :pr ,_fcfa :_gd ,_ccag :_fcd .X ().ClrMapOvr ,_gbac :_bb [1],_fdf :_bb [0]};
_ec .extractDefaultProperties ();_ec .makeSlide ();_ec .drawSlide ();};return _fb ;};func (_feg *convertContext )getShapeFromBlipFill (_afec *_aa .CT_BlipFillProperties ,_cgfb ,_bgeg ,_dege ,_bdbfd float64 ,_bfda bool )_ae .Drawable {_gcad ,_ccdb ,_caafe :=_feg .makePdfImageFromBlipFill (_afec ,_bfda );
if _caafe !=nil {_ad .Log .Debug ("\u0043\u0061\u006e\u006e\u006f\u0074\u0020\u006d\u0061\u006b\u0065\u0020\u0050D\u0046\u0020\u0069\u006d\u0061\u0067e\u0020\u0066\u0072\u006f\u006d\u0020\u0042\u006c\u0069\u0070\u0046\u0069\u006cl\u003a\u0020\u0025\u0073",_caafe );
return nil ;};if _gcad ==nil {return nil ;};if _ceg :=_afec .Tile ;_ceg !=nil {_gcad =_feg .tileImage (_gcad ,_afec .Tile ,_dege ,_bdbfd );};if _deac :=_afec .Stretch ;_deac !=nil {_gcad ,_cgfb ,_bgeg =_feg .stretchImage (_gcad ,_afec .Stretch ,_cgfb ,_bgeg ,_dege ,_bdbfd );
};if len (_ccdb )==0{_gcad .SetPos (_cgfb ,_bgeg );return _gcad ;};_gcad =_feg .applyBlipEffectsOnImg (_gcad ,_cgfb ,_bgeg ,_ccdb );_gcad .SetPos (_cgfb ,_bgeg );return _gcad ;};func (_fffe *textboxContext )drawParagraphs (){_fffe ._adcgf .NewPage ();for _ ,_aae :=range _fffe ._ccdad {for _ ,_ecgc :=range _aae ._ccaf {for _ ,_dadg :=range _ecgc ._fbbb {for _ ,_adfd :=range _dadg ._ddfc {_badd :=_fffe ._adcgf .NewStyledParagraph ();
if _adfd ._caaf {_adfd ._bbgb =0;}else if _adfd ._eadc {_adfd ._bbgb =1.2*_ecgc ._ccbd -_adfd ._ddb ;};_fafe :=_dadg ._fddfg +_adfd ._gff ;_dgac :=_aae ._debbe +_ecgc ._edg +_adfd ._bbgb ;_badd .SetPos (_fafe ,_dgac );_ebga :=_badd .Append (_adfd ._cfaf );
if _adfd ._adcc !=nil {_ebga .Style =*_adfd ._adcc ;};_fffe ._adcgf .Draw (_badd );if _adfd ._eeee {_fde :=_dgac +_adfd ._ddb +2;_gf .DrawLine (_fffe ._adcgf ,_fafe ,_fde ,_fafe +_adfd ._ccbf ,_fde ,1,_adfd ._adcc .Color );};};};};};};func (_fbbbd *convertContext )applyBlipEffectsOnImg (_agde *_ae .Image ,_cga ,_gbgg float64 ,_aee []*_aa .CT_BlipChoice )*_ae .Image {if len (_aee )==0{return _agde ;
};_agde .SetPos (_cga ,_gbgg );_cbee ,_fecb :=_fbbbd .renderPageWithDrawableToGoImage (_agde );if _fecb !=nil {_ad .Log .Debug ("\u0045\u0072\u0072\u006f\u0072\u0020\u0072\u0065\u006e\u0064\u0065\u0072\u0020a\u006e\u0020\u0069\u006d\u0061\u0067e\u0020\u0074\u006f\u0020\u0061\u0020\u0047\u006f\u0020\u0069\u006d\u0061\u0067e\u003a\u0020\u0025\u0073",_fecb );
return _agde ;};_adce ,_fecb :=_fbbbd .renderCurrentStateToGoImage ();if _fecb !=nil {_ad .Log .Debug ("\u0045\u0072\u0072\u006f\u0072\u0020\u0072\u0065n\u0064\u0065\u0072 t\u0068\u0065\u0020\u0063\u0075\u0072r\u0065\u006e\u0074\u0020\u0073\u0074\u0061\u0074\u0065\u0020\u0074\u006f\u0020\u0061\u0020G\u006f\u0020\u0069\u006d\u0061\u0067\u0065\u003a \u0025\u0073",_fecb );
return _agde ;};_efaa :=_cbee .Bounds ();_geeb :=_g .NewRGBA (_efaa );_eafab ,_ddgb :=_agde .Width (),_agde .Height ();for _ ,_beaag :=range _aee {for _ ,_cdeb :=range _beaag .AlphaModFix {if _fbbf :=_cdeb .AmtAttr ;_fbbf !=nil {if _edag :=_fbbf .ST_PositivePercentageDecimal ;
_edag !=nil {_afba :=uint8 (255*(*_edag )/100000);_ebaa :=_g .NewUniform (_e .Alpha {_afba });_ef .Draw (_geeb ,_efaa ,_adce ,_g .Point {0,0},_ef .Src );_ef .DrawMask (_geeb ,_efaa ,_cbee ,_g .Point {0,0},_ebaa ,_g .Point {0,0},_ef .Over );};};};};_ebce :=_g .Rect (int (_cga ),int (_gbgg ),int (_cga +_eafab )+1,int (_gbgg +_ddgb )+1);
_eddc :=_gf .CropImageByRect (_geeb ,_ebce );_gbec ,_fecb :=_fbbbd ._ceaf .NewImageFromGoImage (_eddc );if _fecb !=nil {_ad .Log .Debug ("\u0045\u0072\u0072\u006f\u0072\u0020\u0061\u006e\u0020\u0069\u006d\u0061\u0067\u0065\u0020t\u006f \u0061\u0020\u0047\u006f\u0020\u0069\u006d\u0061\u0067\u0065\u003a\u0020\u0025\u0073",_fecb );
return _agde ;};return _gbec ;};func (_bgbd *textboxContext )newLine (){if _bgbd ._eeec ==nil {_bgbd .newParagraph ();};_bbdg :=_bgbd ._eeec ._ced +_bgbd ._eeec ._cgcf ;_eaff :=&line {};_eaff ._efcc =_bgbd ._eeec ._gee ;if len (_bgbd ._eeec ._ccaf )==0{_eaff ._efcc +=_bgbd ._eeec ._cgb ;
};_eaff ._bagb =_bgbd ._eeec ._fdfd ;_eaff ._dcde =_eaff ._efcc ;_eaff ._edg =_bbdg ;_bgbd ._eeec ._ccaf =append (_bgbd ._eeec ._ccaf ,_eaff );_bgbd ._fcda =_eaff ;};func (_gbff *textboxContext )alignVertically (_bdb _aa .ST_TextAnchoringType ){_gbff .alignParagraphsVertically (_bdb );
_gbff .alignSymbolsVertically ();};type paragraph struct{_caff float64 ;_cgcf float64 ;_efc float64 ;_cgb float64 ;_gee float64 ;_fdfd float64 ;_debbe float64 ;_ced float64 ;_gfed _aa .ST_TextAlignType ;_egc float64 ;_cbd bool ;_ccaf []*line ;};func (_cggg *textboxContext )newParagraph (){_fada :=&paragraph {};
_fada ._debbe =_cggg ._gbe ;_cggg ._eeec =_fada ;};func _dbge (_ageb ,_bbfe *_aa .CT_TextListStyle )*_aa .CT_TextListStyle {_egad :=_aa .NewCT_TextListStyle ();if _ageb !=nil {*_egad =*_ageb ;};if _bbfe ==nil {return _egad ;};_egad .DefPPr =_fded (_egad .DefPPr ,_bbfe .DefPPr );
_egad .Lvl1pPr =_fded (_egad .Lvl1pPr ,_bbfe .Lvl1pPr );_egad .Lvl2pPr =_fded (_egad .Lvl2pPr ,_bbfe .Lvl2pPr );_egad .Lvl3pPr =_fded (_egad .Lvl3pPr ,_bbfe .Lvl3pPr );_egad .Lvl4pPr =_fded (_egad .Lvl4pPr ,_bbfe .Lvl4pPr );_egad .Lvl5pPr =_fded (_egad .Lvl5pPr ,_bbfe .Lvl5pPr );
_egad .Lvl6pPr =_fded (_egad .Lvl6pPr ,_bbfe .Lvl6pPr );_egad .Lvl7pPr =_fded (_egad .Lvl7pPr ,_bbfe .Lvl7pPr );_egad .Lvl8pPr =_fded (_egad .Lvl8pPr ,_bbfe .Lvl8pPr );_egad .Lvl9pPr =_fded (_egad .Lvl9pPr ,_bbfe .Lvl9pPr );return _egad ;};func _fcae (_ggdf *_aa .CT_TextCharacterProperties ,_ceff *_aa .CT_TableStyleTextStyle )*_aa .CT_TextCharacterProperties {_dfca :=_aa .NewCT_TextCharacterProperties ();
if _ggdf !=nil {*_dfca =*_ggdf ;};if _ceff ==nil {return _dfca ;};if _dfca .BAttr ==nil &&_ceff .BAttr !=_aa .ST_OnOffStyleTypeUnset {_ace :=_ceff .BAttr ==_aa .ST_OnOffStyleTypeOn ;_dfca .BAttr =&_ace ;};if _dfca .IAttr ==nil &&_ceff .IAttr !=_aa .ST_OnOffStyleTypeUnset {_bdgd :=_ceff .IAttr ==_aa .ST_OnOffStyleTypeOn ;
_dfca .IAttr =&_bdgd ;};if _dfca .NoFill ==nil &&_dfca .SolidFill ==nil {_dfca .SolidFill =_aa .NewCT_SolidColorFillProperties ();_dfca .SolidFill .ScrgbClr =_ceff .ScrgbClr ;_dfca .SolidFill .SrgbClr =_ceff .SrgbClr ;_dfca .SolidFill .HslClr =_ceff .HslClr ;
_dfca .SolidFill .SysClr =_ceff .SysClr ;_dfca .SolidFill .SchemeClr =_ceff .SchemeClr ;_dfca .SolidFill .PrstClr =_ceff .PrstClr ;};if _fgga :=_ceff .Font ;_fgga !=nil &&_dfca .Latin ==nil &&_dfca .Ea ==nil &&_dfca .Cs ==nil {_dfca .Latin =_fgga .Latin ;
_dfca .Ea =_fgga .Ea ;_dfca .Cs =_fgga .Cs ;};return _dfca ;};func (_gbf *convertContext )addCellToTable (_dffa *_ae .Table ,_bec *_aa .CT_TableCell ,_dec *_aa .CT_TablePartStyle ,_eeg float64 ,_bcef ,_daec ,_gde ,_gbdd bool )float64 {var _cbad *_ae .TableCell ;
_gab :=1;if _bec .GridSpanAttr !=nil {_gab =int (*_bec .GridSpanAttr );};_cbad =_dffa .MultiColCell (_gab );_ccc :=_bec .TcPr ;var _becd *_aa .CT_TableStyleTextStyle ;if _dec !=nil {_ccc =_edga (_ccc ,_dec .TcStyle ,_bcef ,_daec ,_gde ,_gbdd );_becd =_dec .TcTxStyle ;
};_deg :=_gg ;_gdef :=_ae .CellVerticalAlignmentMiddle ;if _ccc !=nil {if _gba :=_ccc .LnL ;_gba !=nil {_gbge ,_ebcf ,_acbg :=_gbf .getBorderStyle (_gba );_cbad .SetBorder (_ae .CellBorderSideLeft ,_gbge ,_acbg );if _ebcf !=nil &&*_ebcf !=nil {_cbad .SetSideBorderColor (_ae .CellBorderSideLeft ,*_ebcf );
};};if _fdb :=_ccc .LnT ;_fdb !=nil {_face ,_fbf ,_gagd :=_gbf .getBorderStyle (_fdb );_cbad .SetBorder (_ae .CellBorderSideTop ,_face ,_gagd );if _fbf !=nil &&*_fbf !=nil {_cbad .SetSideBorderColor (_ae .CellBorderSideTop ,*_fbf );};};if _gcd :=_ccc .LnR ;
_gcd !=nil {_fec ,_bgc ,_fcf :=_gbf .getBorderStyle (_gcd );_cbad .SetBorder (_ae .CellBorderSideRight ,_fec ,_fcf );if _bgc !=nil &&*_bgc !=nil {_cbad .SetSideBorderColor (_ae .CellBorderSideRight ,*_bgc );};};if _cfg :=_ccc .LnB ;_cfg !=nil {_cddd ,_cfdd ,_adff :=_gbf .getBorderStyle (_cfg );
_cbad .SetBorder (_ae .CellBorderSideBottom ,_cddd ,_adff );if _cfdd !=nil &&*_cfdd !=nil {_cbad .SetSideBorderColor (_ae .CellBorderSideBottom ,*_cfdd );};};if _ffg :=_ccc .MarLAttr ;_ffg !=nil {_deg =float64 (_gf .FromSTCoordinate32 (*_ffg ));};switch _ccc .AnchorAttr {case _aa .ST_TextAnchoringTypeT :_gdef =_ae .CellVerticalAlignmentTop ;
case _aa .ST_TextAnchoringTypeB :_gdef =_ae .CellVerticalAlignmentBottom ;};if _ccc .NoFill ==nil {if _cbfe :=_ccc .SolidFill ;_cbfe !=nil {_cgdg ,_ :=_gbf .getColorFromSolidFill (_cbfe );_cbad .SetBackgroundColor (_cgdg );};};};_cbad .SetVerticalAlignment (_gdef );
_cbad .SetIndent (_deg );var _ddcc float64 ;if _gada :=_bec .TxBody ;_gada !=nil {_dbf :=_gbf .makePdfDivisionFromTxBody (_gada ,_eeg ,_ddcc ,_becd );_ddcc =_dbf .Height ();_cbad .SetContent (_dbf );};return _ddcc ;};func (_cc *convertContext )makePdfBlockFromChart (_de *_d .Chart ,_aab ,_ea float64 )(*_ae .Block ,error ){_dg :=_de .CT_RelId .IdAttr ;
_cg :=_cc ._gcgf .GetChartSpaceByRelId (_dg );if _cg ==nil {return nil ,_c .New ("\u004e\u006f\u0020\u0063\u0068\u0061\u0072\u0074\u0073\u0070\u0061\u0063\u0065");};var _ed *_aa .Theme ;_ceb :=_cc ._bca .Themes ();if len (_ceb )> 0{_ed =_ceb [0];};return _gf .MakeBlockFromChartSpace (_cg ,_aab ,_ea ,_ed );
};func (_geg *convertContext )getConnectors (_ff *_efg .CT_Connector )[]_ae .Drawable {_gbg ,_ ,_ ,_ ,_ ,_ ,_ :=_geg .getShapesFromSpPr (_ff .SpPr ,_ff .Style ,false );return _gbg ;};func (_gfgf *convertContext )renderCurrentStateToGoImage ()(_g .Image ,error ){_bcge :=_gf .MakeTempCreator (_gfgf ._fdf ,_gfgf ._gbac );
_bcge .NewPage ();for _ ,_fed :=range _gfgf ._aega {if _fed !=nil {_bcge .MoveTo (0,0);_bcge .Draw (_fed );};};_eagd ,_adfde :=_gf .GetPageFromCreator (_bcge );if _adfde !=nil {return nil ,_adfde ;};return _fe .NewImageDevice ().Render (_eagd );};func _egda (_cdcde float64 )float64 {return _cdcde *_fc .Millimeter };
func (_edad *textboxContext )alignSymbolsVertically (){for _ ,_dcgf :=range _edad ._ccdad {for _ ,_edac :=range _dcgf ._ccaf {_eada :=0.0;for _ ,_dcee :=range _edac ._fbbb {for _ ,_fgdg :=range _dcee ._ddfc {if _fgdg ._dgbg > _eada {_eada =_fgdg ._dgbg ;
};};};for _ ,_dfdc :=range _edac ._fbbb {for _ ,_eeeb :=range _dfdc ._ddfc {if _eeeb ._ddb < _eada {_eeeb ._bbgb =_eada -_eeeb ._ddb ;};};};};};};func _bba (_fbfa ,_gcaga *_aa .CT_TableStyleCellStyle )*_aa .CT_TableStyleCellStyle {_dgdg :=_aa .NewCT_TableStyleCellStyle ();
if _fbfa !=nil {*_dgdg =*_fbfa ;};if _gcaga ==nil {return _dgdg ;};if _dgdg .TcBdr ==nil {_dgdg .TcBdr =_gcaga .TcBdr ;};if _dgdg .Fill ==nil {_dgdg .Fill =_gcaga .Fill ;};if _dgdg .FillRef ==nil {_dgdg .FillRef =_gcaga .FillRef ;};return _dgdg ;};type symbol struct{_cfaf string ;
_gff float64 ;_dgbg float64 ;_ddb float64 ;_bbgb float64 ;_ccbf float64 ;_adcc *_ae .TextStyle ;_eccg string ;_caaf bool ;_eadc bool ;_eeee bool ;};func (_ddc *convertContext )getShapesFromSpPr (_bccf *_aa .CT_ShapeProperties ,_daed *_aa .CT_ShapeStyle ,_cba bool )([]_ae .Drawable ,float64 ,float64 ,float64 ,float64 ,_ae .Color ,bool ){_ebda :=[]_ae .Drawable {};
var _cfd ,_debb ,_abd ,_dfea ,_gbb float64 ;var _ddf ,_aaf ,_bfg ,_dagd _ae .Color ;var _fgad *_aa .CT_BlipFillProperties ;_gdb ,_abg :=1.0,1.0;if _daed !=nil {_ddf ,_aaf ,_dagd =_ddc .getStyleColors (_daed );};if _aac :=_bccf .Ln ;_aac !=nil {if _aac .NoFill !=nil {_bfg ,_gbb =nil ,0;
}else {_bfg ,_gbb ,_gdb =_ddc .getInfoFromLn (_aac );if _bfg ==nil {_bfg =_dagd ;};};};if _bccf .NoFill !=nil {_aaf ,_abg =nil ,0;}else if _cba {_aaf =_ddc ._dcgg ._bfga ;_abg =_ddc ._dcgg ._ebcg ;_fgad =_ddc ._dcgg ._gaeg ;}else if _daff :=_bccf .SolidFill ;
_daff !=nil {_aaf ,_abg =_ddc .getColorFromSolidFill (_daff );};var _aad bool ;if _ffd :=_bccf .Xfrm ;_ffd !=nil {_cfd ,_debb ,_abd ,_dfea =_gf .GetDataFromXfrm (_ffd );_aad =true ;};if _dda :=_bccf .CustGeom ;_dda !=nil {_cbc :=[]_ac .Point {};_eafa ,_gcge :=1.0,1.0;
if _bafe :=_dda .PathLst ;_bafe !=nil {for _ ,_dcdf :=range _bafe .Path {if _dcdf !=nil {if _ded :=_dcdf .WAttr ;_ded !=nil {_eafa =_abd /_fc .FromEMU (*_ded );};if _adb :=_dcdf .HAttr ;_adb !=nil {_gcge =_dfea /_fc .FromEMU (*_adb );};for _ ,_abb :=range _dcdf .Close {if _abb !=nil {};
};for _ ,_gbd :=range _dcdf .MoveTo {if _gbd !=nil &&_gbd .Pt !=nil {_cec ,_fbed :=_fcdg (_gbd .Pt );_cbc =append (_cbc ,_ac .Point {X :_cec *_eafa +_cfd ,Y :_fbed *_gcge +_debb });};};for _ ,_cgfeg :=range _dcdf .LnTo {if _cgfeg !=nil &&_cgfeg .Pt !=nil {_dfc ,_cdg :=_fcdg (_cgfeg .Pt );
_cbc =append (_cbc ,_ac .Point {X :_dfc *_eafa +_cfd ,Y :_cdg *_gcge +_debb });};};_agcc :=_ddc ._ceaf .NewPolygon ([][]_ac .Point {_cbc });_agcc .SetFillColor (_aaf );_agcc .SetFillOpacity (_abg );_agcc .SetBorderWidth (_gbb );if _bfg !=nil {_agcc .SetBorderColor (_bfg );
_agcc .SetBorderOpacity (_gdb );};_ebda =append (_ebda ,_agcc );};};};};if _ega :=_bccf .PrstGeom ;_ega !=nil {switch _ega .PrstAttr {case _aa .ST_ShapeTypeRect :if _fgad !=nil {_cfa :=_ddc .getShapeFromBlipFill (_fgad ,_cfd ,_debb ,_abd ,_dfea ,false );
_ebda =append (_ebda ,_cfa );}else {_bfea :=_ddc ._ceaf .NewRectangle (_cfd ,_debb ,_abd ,_dfea );_ccdaf :=_aaf !=nil &&_abg > 0;if _ccdaf {_bfea .SetFillColor (_aaf );_bfea .SetFillOpacity (_abg );};_ccdf :=_bfg !=nil &&_gdb > 0&&_gbb > 0;if _ccdf {_bfea .SetBorderWidth (_gbb );
_bfea .SetBorderColor (_bfg );_bfea .SetBorderOpacity (_gdb );};if _ccdaf ||_ccdf {_ebda =append (_ebda ,_bfea );};};case _aa .ST_ShapeTypeLine :_cgcd :=_ddc ._ceaf .NewLine (_cfd ,_debb ,_cfd +_abd ,_debb +_dfea );_cgcd .SetLineWidth (_gbb );if _bfg !=nil {_cgcd .SetColor (_bfg );
};_ebda =append (_ebda ,_cgcd );};};return _ebda ,_cfd ,_debb ,_abd ,_dfea ,_ddf ,_aad ;};

// FontStyle represents a kind of font styling. It can be FontStyle_Regular, FontStyle_Bold, FontStyle_Italic and FontStyle_BoldItalic.
type FontStyle =_gf .FontStyle ;func (_abfg *textboxContext )addCurrentWordToParagraph (){if _abfg ._eggd &&_abfg ._fcda ._dcde +_abfg ._eafad ._ffad > _abfg ._fcda ._bagb {_abfg .newLine ();};if !_abfg ._eafad ._cbaf ||len (_abfg ._fcda ._fbbb )> 0{_abfg ._eafad ._fddfg =_abfg ._fcda ._dcde ;
_abfg ._fcda ._fbbb =append (_abfg ._fcda ._fbbb ,_abfg ._eafad );_abfg ._fcda ._dcde +=_abfg ._eafad ._ffad ;for _ ,_fdfdf :=range _abfg ._eafad ._ddfc {_abfg .adjustHeights (_fdfdf ._dgbg );};};};func _eecd (_ffdd ,_caed *_aa .CT_TextBody )(*_aa .CT_TextBodyProperties ,*_aa .CT_TextListStyle ){if _ffdd ==nil &&_caed ==nil {return nil ,nil ;
};if _ffdd ==nil {return _caed .BodyPr ,_caed .LstStyle ;};if _caed ==nil {return _ffdd .BodyPr ,_ffdd .LstStyle ;};_gbdc ,_afeg :=_ffdd .BodyPr ,_ffdd .LstStyle ;_acba ,_gaae :=_caed .BodyPr ,_caed .LstStyle ;_eecg :=_faffc (_gbdc ,_acba );_def :=_dbge (_afeg ,_gaae );
return _eecg ,_def ;};func _dfcc (_dcea *_efg .CT_CommonSlideData ,_bdaf _efg .ST_PlaceholderType ,_gdgf *uint32 ,_ebfa bool )(*_aa .CT_Transform2D ,*_aa .CT_TextBody ,*bool ,*bool ){if _dcea !=nil &&(_bdaf !=_efg .ST_PlaceholderTypeUnset ||!_ebfa ){if _ebff :=_dcea .SpTree ;
_ebff !=nil {for _ ,_egbb :=range _ebff .Choice {if _egbb !=nil {for _ ,_dfdce :=range _egbb .Sp {if _dfdce !=nil {_facb ,_gfdf :=_dab (_dfdce );if _bdaf ==_facb {if (_ebfa &&_gfdf ==nil )||(!_ebfa &&_gfdf !=nil &&*_gfdf ==*_gdgf ){var _abfc *_aa .CT_Transform2D ;
if _dfdce .SpPr !=nil {_abfc =_dfdce .SpPr .Xfrm ;};_aggf :=_bdaf ==_efg .ST_PlaceholderTypeTitle ||_bdaf ==_efg .ST_PlaceholderTypeCtrTitle ;_gbc :=!_aggf &&_bdaf !=_efg .ST_PlaceholderTypeUnset ;return _abfc ,_dfdce .TxBody ,&_aggf ,&_gbc ;};};};};};
};};};return nil ,nil ,nil ,nil ;};func (_eaf *convertContext )stretchImage (_edd *_ae .Image ,_dcb *_aa .CT_StretchInfoProperties ,_bc ,_aff ,_egf ,_agc float64 )(*_ae .Image ,float64 ,float64 ){_fd :=_dcb .FillRect ;if _fd ==nil {_cbg :=_edd .Width ()/_edd .Height ();
_ggcd :=_egf /_agc ;var _babf ,_gag float64 ;if _cbg > _ggcd {_gag =_agc ;_babf =_agc *_cbg ;}else {_babf =_egf ;_gag =_egf /_cbg ;};_edd .Scale (_babf /_edd .Width (),_gag /_edd .Height ());return _edd ,_bc ,_aff ;};var _agee ,_gcg ,_acge ,_bbg float64 ;
if _fea :=_fd .LAttr ;_fea !=nil {_acge =_gf .FromSTPercentage (_fea );};if _fcg :=_fd .TAttr ;_fcg !=nil {_agee =_gf .FromSTPercentage (_fcg );};if _dcg :=_fd .RAttr ;_dcg !=nil {_bbg =_gf .FromSTPercentage (_dcg );};if _dfa :=_fd .BAttr ;_dfa !=nil {_gcg =_gf .FromSTPercentage (_dfa );
};_bcc :=_egf *(1-_acge -_bbg );_fga :=_agc *(1-_agee -_gcg );_edd .Scale (_bcc /_edd .Width (),_fga /_edd .Height ());return _edd ,_bc +_acge *_egf ,_aff +_agee *_agc ;};func (_dc *convertContext )makeSlide (){_ede :=_dc ._gcgf .GetSlideLayout ().CSld ;
if _ede !=nil {if _fa :=_ede .SpTree ;_fa !=nil {for _ ,_cdf :=range _fa .Choice {if _cdf !=nil {for _ ,_bef :=range _cdf .Pic {if _bef !=nil {var _cf ,_cgg ,_fcb ,_ge float64 ;if _ebe :=_bef .SpPr ;_ebe !=nil {if _add :=_ebe .Xfrm ;_add !=nil {_cf ,_cgg ,_fcb ,_ge =_gf .GetDataFromXfrm (_add );
};};if _ead :=_bef .BlipFill ;_ead !=nil {_cgfe :=_dc .getShapeFromBlipFill (_ead ,_cf ,_cgg ,_fcb ,_ge ,true );_dc ._aega =append (_dc ._aega ,_cgfe );};};};};};};};_ede =_dc ._gcgf .X ().CSld ;if _ede ==nil {return ;};_gb :=&background {};if _ba :=_ede .Bg ;
_ba !=nil {if _gfa :=_ba .BgPr ;_gfa !=nil {if _gfa .NoFill ==nil {if _baf :=_gfa .SolidFill ;_baf !=nil {_befd ,_fcc :=_dc .getColorFromSolidFill (_baf );if _befd !=nil {_gb ._bfga =_befd ;_gb ._ebcg =_fcc ;};}else if _bd :=_gfa .BlipFill ;_bd !=nil {_gb ._gaeg =_bd ;
};};};};_dc ._dcgg =_gb ;if _cef :=_ede .SpTree ;_cef !=nil {for _ ,_efe :=range _cef .Choice {if _efe !=nil {for _ ,_gc :=range _efe .Sp {if _gc !=nil {_gaf :=_dc .getShapes (_gc );_dc ._aega =append (_dc ._aega ,_gaf ...);};};for _ ,_df :=range _efe .GraphicFrame {if _df !=nil {var _dfb ,_ab ,_cae ,_eec float64 ;
if _eee :=_df .Xfrm ;_eee !=nil {_dfb ,_ab ,_cae ,_eec =_gf .GetDataFromXfrm (_eee );};if _cae ==0&&_eec ==0{_cae =_dc ._fdf ;_eec =_dc ._gbac ;};if _dbbg :=_df .Graphic ;_dbbg !=nil {if _fgf :=_dbbg .GraphicData ;_fgf !=nil {for _ ,_cea :=range _fgf .Any {if _fgd ,_dae :=_cea .(*_d .Chart );
_dae {_gaa ,_bf :=_dc .makePdfBlockFromChart (_fgd ,_cae ,_eec );if _bf !=nil {_ad .Log .Debug ("C\u0061\u006e\u006e\u006ft \u0072e\u0061\u0064\u0020\u0062\u006co\u0063\u006b\u003a\u0020\u0025\u0073",_bf );};if _gaa !=nil {_gaa .SetPos (_dfb ,_ab );_dc ._aega =append (_dc ._aega ,_gaa );
};}else if _eca ,_agf :=_cea .(*_aa .Tbl );_agf {_cdd :=_dc .makePdfBlockFromTable (_eca ,_cae );if _cdd !=nil {_eac :=_ae .NewBlock (_cae ,_eec );_eac .SetPos (_dfb ,_ab );_eac .Draw (_cdd );_dc ._aega =append (_dc ._aega ,_eac );};};};};};};};for _ ,_dag :=range _efe .CxnSp {if _dag !=nil {_dde :=_dc .getConnectors (_dag );
_dc ._aega =append (_dc ._aega ,_dde ...);};};for _ ,_fce :=range _efe .Pic {if _fce !=nil {var _dfg ,_ggc ,_gacb ,_acd float64 ;if _dgd :=_fce .SpPr ;_dgd !=nil {if _cb :=_dgd .Xfrm ;_cb !=nil {_dfg ,_ggc ,_gacb ,_acd =_gf .GetDataFromXfrm (_cb );};};
if _dad :=_fce .BlipFill ;_dad !=nil {_aefe :=_dc .getShapeFromBlipFill (_dad ,_dfg ,_ggc ,_gacb ,_acd ,false );_dc ._aega =append (_dc ._aega ,_aefe );};};};};};};};func (_fac *convertContext )makePdfBlockFromTable (_eead *_aa .Tbl ,_bcff float64 )*_ae .Table {_egbe :=_eead .TblGrid ;
if _egbe ==nil {return nil ;};_cde :=len (_egbe .GridCol );if _cde ==0{return nil ;};_bacb :=[]float64 {};_bbde :=0.0;for _ ,_fcbd :=range _egbe .GridCol {_bdee :=_fc .FromEMU (_gf .FromSTCoordinate (_fcbd .WAttr ));_bacb =append (_bacb ,_bdee );_bbde +=_bdee ;
};_dagg :=[]float64 {};for _ecg :=0;_ecg < _cde ;_ecg ++{_dagg =append (_dagg ,_bacb [_ecg ]/_bbde );};_gdbc :=_fac ._ceaf .NewTable (_cde );_gdbc .SetColumnWidths (_dagg ...);_ebdg :=_eead .TblPr ;var _dff *_aa .CT_TableStyle ;if _adf :=_ebdg .Choice ;
_adf !=nil {if _adf .TableStyle !=nil {_dff =_adf .TableStyle ;}else if _adf .TableStyleId !=nil {_dff =_fac ._bca .GetTableStyleById (*_adf .TableStyleId );};};_egg :=_aa .NewCT_TablePartStyle ();_egg .TcStyle =_aa .NewCT_TableStyleCellStyle ();_egg .TcTxStyle =_aa .NewCT_TableStyleTextStyle ();
if _dff !=nil {if _dff .WholeTbl !=nil {*_egg =*_dff .WholeTbl ;};if _dff .TblBg !=nil {if _egg .TcStyle .Fill ==nil {_egg .TcStyle .Fill =_dff .TblBg .Fill ;};};};if _egg .TcStyle .Fill ==nil {_egg .TcStyle .Fill =_aa .NewCT_FillProperties ();_egg .TcStyle .Fill .NoFill =_ebdg .NoFill ;
_egg .TcStyle .Fill .SolidFill =_ebdg .SolidFill ;};_acb :=len (_eead .Tr );for _dbg ,_ffc :=range _eead .Tr {_ccbe :=_dbg ==0;_egeg :=_dbg ==_acb -1;_efdd :=_dbg %2==0;_eggg :=len (_ffc .Tc );var _gef *_aa .CT_TablePartStyle ;if _ccbe {_gef =_dff .FirstRow ;
}else if _efdd {_gef =_dff .Band2H ;}else {_gef =_dff .Band1H ;};var _gfb float64 ;for _bged ,_gaac :=range _ffc .Tc {_acdd :=_bged ==0;_daeb :=_bged ==_eggg -1;_gadg :=_bged %2==0;var _bedb *_aa .CT_TablePartStyle ;if _acdd {_bedb =_dff .FirstCol ;}else if _gadg {_bedb =_dff .Band2V ;
}else {_bedb =_dff .Band1V ;};_aed :=_cfbe (_cfbe (_bedb ,_gef ),_egg );_aggg :=_fac .addCellToTable (_gdbc ,_gaac ,_aed ,_bcff *_dagg [_bged ],_ccbe ,_egeg ,_acdd ,_daeb );if _aggg > _gfb {_gfb =_aggg ;};};_begg :=_fc .FromEMU (_gf .FromSTCoordinate (_ffc .HAttr ));
if _begg < _gfb {_begg =_gfb ;};if _begg < _egda (4){_begg =_egda (4);};_gdbc .SetRowHeight (_gdbc .CurRow (),_begg );};return _gdbc ;};func (_cff *textboxContext )newWord (){_cff ._eafad =&word {_cbaf :true ,_fddfg :_cff ._fcda ._dcde }};func _edga (_ecaf *_aa .CT_TableCellProperties ,_eafb *_aa .CT_TableStyleCellStyle ,_feee ,_acde ,_aaec ,_bageg bool )*_aa .CT_TableCellProperties {_fdee :=_aa .NewCT_TableCellProperties ();
if _ecaf !=nil {*_fdee =*_ecaf ;};if _eafb ==nil {return _fdee ;};if _fgfe :=_eafb .FillRef ;_fgfe !=nil {_caeba :=_aa .NewCT_SolidColorFillProperties ();_caeba .ScrgbClr =_fgfe .ScrgbClr ;_caeba .SrgbClr =_fgfe .SrgbClr ;_caeba .HslClr =_fgfe .HslClr ;
_caeba .SysClr =_fgfe .SysClr ;_caeba .SchemeClr =_fgfe .SchemeClr ;_caeba .PrstClr =_fgfe .PrstClr ;_fdee .SolidFill =_caeba ;};if _fdee .NoFill ==nil &&_fdee .SolidFill ==nil {if _dfgc :=_eafb .Fill ;_dfgc !=nil {if _fdee .NoFill ==nil {_fdee .NoFill =_dfgc .NoFill ;
};if _fdee .SolidFill ==nil {_fdee .SolidFill =_dfgc .SolidFill ;};};};if _ddbb :=_eafb .TcBdr ;_ddbb !=nil {if _fdee .LnL ==nil {var _gcb *_aa .CT_ThemeableLineStyle ;if _aaec {_gcb =_ddbb .Left ;}else {_gcb =_ddbb .InsideV ;};if _gcb !=nil {_fdee .LnL =_gcb .Ln ;
};};if _fdee .LnR ==nil {var _ffca *_aa .CT_ThemeableLineStyle ;if _bageg {_ffca =_ddbb .Right ;}else {_ffca =_ddbb .InsideV ;};if _ffca !=nil {_fdee .LnR =_ffca .Ln ;};};if _fdee .LnT ==nil {var _gdgc *_aa .CT_ThemeableLineStyle ;if _feee {_gdgc =_ddbb .Top ;
}else {_gdgc =_ddbb .InsideH ;};if _gdgc !=nil {_fdee .LnT =_gdgc .Ln ;};};if _fdee .LnB ==nil {var _ebca *_aa .CT_ThemeableLineStyle ;if _acde {_ebca =_ddbb .Bottom ;}else {_ebca =_ddbb .InsideH ;};if _ebca !=nil {_fdee .LnB =_ebca .Ln ;};};};return _fdee ;
};func (_egbc *textboxContext )alignParagraph (){_bfaa :=_egbc ._eeec ;if _bfaa ._gfed ==_aa .ST_TextAlignTypeL {return ;};_fcbc :=len (_bfaa ._ccaf )-1;for _agge ,_ddaa :=range _bfaa ._ccaf {_ffgc :=true ;_baea :=len (_ddaa ._fbbb );_abdc :=0.0;for _acda :=len (_ddaa ._fbbb )-1;
_acda >=0;_acda --{_eccc :=_ddaa ._fbbb [_acda ];if _ffgc &&_eccc ._cbaf {_baea =_acda ;}else {_ffgc =false ;for _ ,_fcgb :=range _eccc ._ddfc {_abdc +=_fcgb ._ccbf ;};};};_ddaa ._fbbb =_ddaa ._fbbb [:_baea ];_aaag :=_ddaa ._bagb -_ddaa ._efcc -_abdc ;
switch _bfaa ._gfed {case _aa .ST_TextAlignTypeR :_ddaa .moveRight (_aaag );case _aa .ST_TextAlignTypeCtr :_ddaa .moveRight (_aaag /2);case _aa .ST_TextAlignTypeJust :if _agge !=_fcbc {_efcb :=[]*word {};for _ ,_adfe :=range _ddaa ._fbbb {if _adfe ._cbaf {_efcb =append (_efcb ,_adfe );
};};_efca :=_aaag /float64 (len (_efcb ));for _ ,_dacc :=range _efcb {_dacc ._ffad +=_efca ;};var _ceef *word ;for _ ,_beee :=range _ddaa ._fbbb {if _ceef !=nil {_beee ._fddfg =_ceef ._fddfg +_ceef ._ffad ;};_ceef =_beee ;};};};};};type convertContext struct{_ceaf *_ae .Creator ;
_eeae *_gf .Rectangle ;_bca *_f .Presentation ;_gcgf *_f .Slide ;_afa *_efg .SldMaster ;_cfb *_efg .SldLayout ;_gbac float64 ;_fdf float64 ;_aega []_ae .Drawable ;_dcgg *background ;_agfe *_aa .CT_TextParagraphProperties ;_fddf *_aa .CT_TextCharacterProperties ;
_efafe *_aa .CT_TextParagraphProperties ;_bcb *_aa .CT_TextCharacterProperties ;_gdbb *_aa .CT_TextParagraphProperties ;_cbed *_aa .CT_TextCharacterProperties ;_fgada []*_aa .CT_TextParagraphProperties ;_cab []*_aa .CT_TextParagraphProperties ;_acbgd []*_aa .CT_TextParagraphProperties ;
_fcfa *_aa .Theme ;_ccag *_aa .CT_ColorMappingOverride ;};func _ggd (_adgd ,_aeag *_aa .CT_TextCharacterProperties )*_aa .CT_TextCharacterProperties {_cacg :=_aa .NewCT_TextCharacterProperties ();if _adgd !=nil {*_cacg =*_adgd ;};if _aeag ==nil {return _cacg ;
};if _cacg .KumimojiAttr ==nil {_cacg .KumimojiAttr =_aeag .KumimojiAttr ;};if _cacg .LangAttr ==nil {_cacg .LangAttr =_aeag .LangAttr ;};if _cacg .AltLangAttr ==nil {_cacg .AltLangAttr =_aeag .AltLangAttr ;};if _cacg .SzAttr ==nil {_cacg .SzAttr =_aeag .SzAttr ;
};if _cacg .BAttr ==nil {_cacg .BAttr =_aeag .BAttr ;};if _cacg .IAttr ==nil {_cacg .IAttr =_aeag .IAttr ;};if _cacg .UAttr ==_aa .ST_TextUnderlineTypeUnset {_cacg .UAttr =_aeag .UAttr ;};if _cacg .StrikeAttr ==_aa .ST_TextStrikeTypeUnset {_cacg .StrikeAttr =_aeag .StrikeAttr ;
};if _cacg .KernAttr ==nil {_cacg .KernAttr =_aeag .KernAttr ;};if _cacg .CapAttr ==_aa .ST_TextCapsTypeUnset {_cacg .CapAttr =_aeag .CapAttr ;};if _cacg .SpcAttr ==nil {_cacg .SpcAttr =_aeag .SpcAttr ;};if _cacg .NormalizeHAttr ==nil {_cacg .NormalizeHAttr =_aeag .NormalizeHAttr ;
};if _cacg .BaselineAttr ==nil {_cacg .BaselineAttr =_aeag .BaselineAttr ;};if _cacg .NoProofAttr ==nil {_cacg .NoProofAttr =_aeag .NoProofAttr ;};if _cacg .DirtyAttr ==nil {_cacg .DirtyAttr =_aeag .DirtyAttr ;};if _cacg .ErrAttr ==nil {_cacg .ErrAttr =_aeag .ErrAttr ;
};if _cacg .SmtCleanAttr ==nil {_cacg .SmtCleanAttr =_aeag .SmtCleanAttr ;};if _cacg .SmtIdAttr ==nil {_cacg .SmtIdAttr =_aeag .SmtIdAttr ;};if _cacg .BmkAttr ==nil {_cacg .BmkAttr =_aeag .BmkAttr ;};if _cacg .Ln ==nil {_cacg .Ln =_aeag .Ln ;};if _cacg .NoFill ==nil {_cacg .NoFill =_aeag .NoFill ;
};if _cacg .SolidFill ==nil {_cacg .SolidFill =_aeag .SolidFill ;};if _cacg .BlipFill ==nil {_cacg .BlipFill =_aeag .BlipFill ;};if _cacg .EffectLst ==nil {_cacg .EffectLst =_aeag .EffectLst ;};if _cacg .EffectDag ==nil {_cacg .EffectDag =_aeag .EffectDag ;
};if _cacg .Highlight ==nil {_cacg .Highlight =_aeag .Highlight ;};if _cacg .ULnTx ==nil {_cacg .ULnTx =_aeag .ULnTx ;};if _cacg .ULn ==nil {_cacg .ULn =_aeag .ULn ;};if _cacg .UFillTx ==nil {_cacg .UFillTx =_aeag .UFillTx ;};if _cacg .UFill ==nil {_cacg .UFill =_aeag .UFill ;
};if _cacg .Latin ==nil {_cacg .Latin =_aeag .Latin ;};if _cacg .Ea ==nil {_cacg .Ea =_aeag .Ea ;};if _cacg .Cs ==nil {_cacg .Cs =_aeag .Cs ;};if _cacg .Sym ==nil {_cacg .Sym =_aeag .Sym ;};if _cacg .Rtl ==nil {_cacg .Rtl =_aeag .Rtl ;};return _cacg ;};
func (_afe *convertContext )makeStyleFromRPr (_bfed *_aa .CT_TextCharacterProperties )(*_ae .TextStyle ,bool ,bool ,bool ){var _bfef ,_afb ,_dgf bool ;_gddd :=_afe ._ceaf .NewTextStyle ();if _bfed !=nil {_cafb :=_gf .FontStyle_Regular ;_dce :=_fgg (_bfed .BAttr );
_feag :=_fgg (_bfed .IAttr );if _dce &&_feag {_cafb =_gf .FontStyle_BoldItalic ;}else if _dce {_cafb =_gf .FontStyle_Bold ;}else if _feag {_cafb =_gf .FontStyle_Italic ;};_dgf =_bfed .UAttr !=_aa .ST_TextUnderlineTypeUnset &&_bfed .UAttr !=_aa .ST_TextUnderlineTypeNone ;
_faf :="\u0064e\u0066\u0061\u0075\u006c\u0074";if _adba :=_bfed .Latin ;_adba !=nil {_faf =_adba .TypefaceAttr ;}else if _ccb :=_bfed .Ea ;_ccb !=nil {_faf =_ccb .TypefaceAttr ;}else if _eda :=_bfed .Cs ;_eda !=nil {_faf =_eda .TypefaceAttr ;}else if _fab :=_bfed .Sym ;
_fab !=nil {_faf =_fab .TypefaceAttr ;};if _cfce ,_bfd :=_gf .StdFontsMap [_faf ];_bfd {_gddd .Font =_gf .AssignStdFontByName (_gddd ,_cfce [_cafb ]);}else if _cbe :=_gf .GetRegisteredFont (_faf ,_cafb );_cbe !=nil {_gddd .Font =_cbe ;}else {_ad .Log .Debug ("\u0046\u006f\u006e\u0074\u0020\u0025\u0073\u0020\u0077\u0069\u0074h\u0020\u0073\u0074\u0079\u006c\u0065\u0020\u0025s\u0020i\u0073\u0020\u006e\u006f\u0074\u0020\u0066\u006f\u0075\u006e\u0064\u002c\u0020\u0072\u0065\u0073\u0065\u0074 \u0074\u006f\u0020\u0064\u0065\u0066\u0061\u0075\u006c\u0074\u002e",_faf ,_cafb );
_gddd .Font =_gf .AssignStdFontByName (_gddd ,_gf .StdFontsMap ["\u0064e\u0066\u0061\u0075\u006c\u0074"][_cafb ]);};var _cdb float64 ;if _ddag :=_bfed .SzAttr ;_ddag !=nil {_cdb =float64 (*_ddag )/100;}else {_cdb =_gf .DefaultFontSize ;};if _gcgb :=_bfed .BaselineAttr ;
_gcgb !=nil {if _dgbf :=_gcgb .ST_PercentageDecimal ;_dgbf !=nil {if *_dgbf > 0{_bfef =true ;}else if *_dgbf < 0{_afb =true ;};};};if _bfef ||_afb {_cdb *=0.64;};_gddd .FontSize =_cdb ;_gec :=0.0;if _aaa :=_bfed .SpcAttr ;_aaa !=nil {if _cdaf :=_aaa .ST_TextPointUnqualified ;
_cdaf !=nil {_gec =float64 (*_cdaf )/100;};};_gddd .CharSpacing =_gec ;};return &_gddd ,_bfef ,_afb ,_dgf ;};func (_bbb *convertContext )getPhData (_agba *_efg .CT_Shape )(*_aa .CT_Transform2D ,*_aa .CT_TextBodyProperties ,*_aa .CT_TextListStyle ,bool ,bool ){_acf ,_cbaef :=_dab (_agba );
_aggd :=_cbaef ==nil ;_ddaaa ,_gfc ,_gbga ,_cdca :=_dfcc (_bbb ._afa .CSld ,_acf ,_cbaef ,_aggd );_dgc ,_ebcd ,_edf ,_bcee :=_dfcc (_bbb ._cfb .CSld ,_acf ,_cbaef ,_aggd );if _dgc ==nil {_dgc =_ddaaa ;};_afegd ,_gbbf :=_eecd (_ebcd ,_gfc );var _babc ,_bfb bool ;
if _edf ==nil {if _gbga !=nil {_babc =*_gbga ;};}else {_babc =*_edf ;};if _bcee ==nil {if _cdca !=nil {_bfb =*_cdca ;};}else {_bfb =*_bcee ;};return _dgc ,_afegd ,_gbbf ,_babc ,_bfb ;};func _gfgge (_efaf string )[]*symbol {_cbf :=[]*symbol {};for _ ,_bfgb :=range _efaf {_cbf =append (_cbf ,&symbol {_cfaf :string (_bfgb )});
};return _cbf ;};var _gg =_egda (1.9);type word struct{_ddfc []*symbol ;_fddfg float64 ;_ffad float64 ;_cbaf bool ;};func _efec (_adffb int ,_gafb bool )string {_bfcg :=(_adffb -1)/26+1;_eae :=byte ((_adffb -1)%26);if _gafb {_eae +=byte (65);}else {_eae +=byte (97);
};_ddg :=_b .NewBuffer ([]byte {});for _agca :=0;_agca < _bfcg ;_agca ++{_ddg .Write ([]byte {_eae });};return _ddg .String ();};func (_dfeaf *textboxContext )addCurrentParagraph (){_dfeaf ._gbe =_dfeaf ._eeec ._debbe +_dfeaf ._eeec ._cgcf +_dfeaf ._eeec ._ced +_dfeaf ._eeec ._efc ;
_dfeaf ._ccdad =append (_dfeaf ._ccdad ,_dfeaf ._eeec );_dfeaf .alignParagraph ();};func _eaa (_fdg int ,_cbda bool )string {_bgedc :=_b .NewBuffer ([]byte {});for _ ,_cgcb :=range _cfe {for {if _fdg < _cgcb ._abbe {break ;};_bgedc .WriteString (_cgcb ._aedc );
_fdg -=_cgcb ._abbe ;};};_afbe :=_bgedc .String ();if _cbda {_afbe =_ce .ToUpper (_afbe );};return _afbe ;};func (_edc *textboxContext )addTextRun (_egfc *_aa .EG_TextRun ,_dafg *_aa .CT_TextCharacterProperties ,_fbbbf _ae .Color ,_eade *prefixData ){if _agfb :=_egfc .Br ;
_agfb !=nil {_edc .addCurrentWordToParagraph ();_edc .newLine ();_edc .newWord ();}else if _gdac :=_egfc .R ;_gdac !=nil {var _ddfa _ae .Color ;if _gdac .RPr !=nil &&_gdac .RPr .SolidFill !=nil {_ddfa ,_ =_edc ._agff .getColorFromSolidFill (_gdac .RPr .SolidFill );
}else if _fbbbf !=nil {_ddfa =_fbbbf ;}else if _dafg .SolidFill !=nil {_ddfa ,_ =_edc ._agff .getColorFromSolidFill (_dafg .SolidFill );}else {_ddfa =_ae .ColorBlack ;};_aegd :=_ggd (_gdac .RPr ,_dafg );_beaf ,_ecac ,_bdfa ,_acgg :=_edc ._agff .makeStyleFromRPr (_aegd );
_beaf .Color =_ddfa ;if _eade !=nil {_edc .addPrefix (_eade ,_beaf );};_dcbe :=_gfgge (_gdac .T );for _ ,_dba :=range _dcbe {_dba ._adcc =_beaf ;_dba ._caaf =_ecac ;_dba ._eadc =_bdfa ;_dba ._eeee =_acgg ;if _aegd .CapAttr ==_aa .ST_TextCapsTypeAll {_dba ._cfaf =_ce .ToUpper (_dba ._cfaf );
};_edc .addTextSymbol (_dba );};};};func (_ebae *convertContext )renderPageWithDrawableToGoImage (_gcc _ae .Drawable )(_g .Image ,error ){_agccb :=_gf .MakeTempCreator (_ebae ._fdf ,_ebae ._gbac );_agccb .NewPage ();_agccb .Draw (_gcc );_feaf ,_cggf :=_gf .GetPageFromCreator (_agccb );
if _cggf !=nil {return nil ,_cggf ;};return _fe .NewImageDevice ().Render (_feaf );};func (_fdgb *convertContext )getInfoFromLn (_addae *_aa .CT_LineProperties )(_ae .Color ,float64 ,float64 ){if _addae ==nil ||_addae .NoFill !=nil {return nil ,0,0;};var _dgfe float64 ;
_gcag ,_beaa :=_fdgb .getColorFromSolidFill (_addae .SolidFill );if _daggg :=_addae .WAttr ;_daggg !=nil {_dgfe =_fc .FromEMU (int64 (*_daggg ));}else {_dgfe =1;};return _gcag ,_dgfe ,_beaa ;};var _abca =map[string ]int32 {"\u0076":9830,"\u00d8":8594,"\u00fc":8730};
func _cfbe (_cfeb ,_ddab *_aa .CT_TablePartStyle )*_aa .CT_TablePartStyle {_caag :=_aa .NewCT_TablePartStyle ();if _cfeb !=nil {*_caag =*_cfeb ;};if _ddab ==nil {return _caag ;};if _caag .TcTxStyle ==nil {_caag .TcTxStyle =_ddab .TcTxStyle ;}else {_caag .TcTxStyle =_edcaa (_caag .TcTxStyle ,_ddab .TcTxStyle );
};if _caag .TcStyle ==nil {_caag .TcStyle =_ddab .TcStyle ;}else {_caag .TcStyle =_bba (_caag .TcStyle ,_ddab .TcStyle );};return _caag ;};func (_gbadb *textboxContext )alignParagraphsVertically (_faff _aa .ST_TextAnchoringType ){if _faff ==_aa .ST_TextAnchoringTypeT {return ;
};_cecf :=0.0;for _ ,_gefc :=range _gbadb ._ccdad {_cecf +=_gefc ._cgcf +_gefc ._ced +_gefc ._efc ;};var _eacd float64 ;switch _faff {case _aa .ST_TextAnchoringTypeCtr :_eacd =(_gbadb ._fff -_cecf )/2;case _aa .ST_TextAnchoringTypeB :_eacd =_gbadb ._fff -_cecf ;
};for _ ,_beb :=range _gbadb ._ccdad {_beb ._debbe +=_eacd ;};};func (_abbd *convertContext )getColorFromFontReference (_aagf *_aa .CT_FontReference )_ae .Color {var _bcfg _ae .Color ;var _fbfd string ;if _febd :=_aagf .SrgbClr ;_febd !=nil {_fbfd =_febd .ValAttr ;
}else if _acbb :=_aagf .SchemeClr ;_acbb !=nil {_fbfd =_gf .GetColorStringFromDmlColor (_abbd ._bca .GetColorBySchemeColor (_acbb .ValAttr ));_fbfd =_gf .AdjustColor (_fbfd ,_acbb .EG_ColorTransform );};if _fbfd !=""{_bcfg =_ae .ColorRGBFromHex ("\u0023"+_fbfd );
};return _bcfg ;};func (_gdda *convertContext )getBorderStyle (_cdfa *_aa .CT_LineProperties )(_ae .CellBorderStyle ,*_ae .Color ,float64 ){if _cdfa ==nil ||_cdfa .NoFill !=nil {return _ae .CellBorderStyleNone ,nil ,0;};var _ggb _ae .Color ;if _baa :=_cdfa .SolidFill ;
_baa !=nil {_ggb ,_ =_gdda .getColorFromSolidFill (_baa );};_adac :=0.0;if _fcdd :=_cdfa .WAttr ;_fcdd !=nil {_adac =_fc .FromEMU (int64 (*_fcdd ));};return _ae .CellBorderStyleSingle ,&_ggb ,_adac ;};

// RegisterFontsFromDirectory registers all fonts from the given directory automatically detecting font families and styles.
func RegisterFontsFromDirectory (dirName string )error {return _gf .RegisterFontsFromDirectory (dirName )};func _fgg (_dbc *bool )bool {return _dbc !=nil &&*_dbc };