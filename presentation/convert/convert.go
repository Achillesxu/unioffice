//
// Copyright 2020 FoxyUtils ehf. All rights reserved.
//
// This is a commercial product and requires a license to operate.
// A trial license can be obtained at https://unidoc.io
//
// DO NOT EDIT: generated by unitwist Go source code obfuscator.
//
// Use of this source code is governed by the UniDoc End User License Agreement
// terms that can be accessed at https://unidoc.io/eula/

package convert ;import (_ea "bytes";_b "errors";_gd "github.com/unidoc/unioffice/common/logger";_cf "github.com/unidoc/unioffice/common/tempstorage";_eea "github.com/unidoc/unioffice/internal/convertutils";_bc "github.com/unidoc/unioffice/measurement";_d "github.com/unidoc/unioffice/presentation";_a "github.com/unidoc/unioffice/schema/soo/dml";_cb "github.com/unidoc/unioffice/schema/soo/dml/chart";_dg "github.com/unidoc/unioffice/schema/soo/pml";_bf "github.com/unidoc/unipdf/v3/contentstream/draw";_cd "github.com/unidoc/unipdf/v3/creator";_fa "github.com/unidoc/unipdf/v3/model";_ed "github.com/unidoc/unipdf/v3/render";_ee "image";_e "image/color";_f "image/draw";_ba "strconv";_g "strings";);func (_gcea *convertContext )stretchImage (_geb *_cd .Image ,_ebb *_a .CT_StretchInfoProperties ,_gcb ,_cda ,_gcf ,_ggf float64 )(*_cd .Image ,float64 ,float64 ){_acf :=_ebb .FillRect ;if _acf ==nil {_aac :=_geb .Width ()/_geb .Height ();_gaea :=_gcf /_ggf ;var _bag ,_faa float64 ;if _aac > _gaea {_faa =_ggf ;_bag =_ggf *_aac ;}else {_bag =_gcf ;_faa =_gcf /_aac ;};_geb .Scale (_bag /_geb .Width (),_faa /_geb .Height ());return _geb ,_gcb ,_cda ;};var _gbg ,_acg ,_cge ,_ecaf float64 ;if _cgb :=_acf .LAttr ;_cgb !=nil {_cge =_eea .FromSTPercentage (_cgb );};if _db :=_acf .TAttr ;_db !=nil {_gbg =_eea .FromSTPercentage (_db );};if _geg :=_acf .RAttr ;_geg !=nil {_ecaf =_eea .FromSTPercentage (_geg );};if _ccb :=_acf .BAttr ;_ccb !=nil {_acg =_eea .FromSTPercentage (_ccb );};_dgbg :=_gcf *(1-_cge -_ecaf );_baeb :=_ggf *(1-_gbg -_acg );_geb .Scale (_dgbg /_geb .Width (),_baeb /_geb .Height ());return _geb ,_gcb +_cge *_gcf ,_cda +_gbg *_ggf ;};func (_aeec *convertContext )getColorFromSolidFill (_cgcb *_a .CT_SolidColorFillProperties )(_cd .Color ,float64 ){if _cgcb ==nil {return nil ,1;};var _eecea string ;_gebe :=1.0;if _eagf :=_cgcb .SrgbClr ;_eagf !=nil {_eecea =_eagf .ValAttr ;_gebe =_eea .GetOpacityFromColorTransform (_eagf .EG_ColorTransform );}else if _gcc :=_cgcb .SchemeClr ;_gcc !=nil {_eecea =_eea .GetColorStringFromDmlColor (_aeec ._bfda .GetColorBySchemeColor (_gcc .ValAttr ));_eecea =_eea .AdjustColor (_eecea ,_gcc .EG_ColorTransform );_gebe =_eea .GetOpacityFromColorTransform (_gcc .EG_ColorTransform );};if _eecea !=""{_ccdd :=_cd .ColorRGBFromHex ("\u0023"+_eecea );return _ccdd ,_gebe ;};return nil ,1;};func (_gdcgb *convertContext )getInfoFromLn (_dgef *_a .CT_LineProperties )(_cd .Color ,float64 ,float64 ){if _dgef ==nil ||_dgef .NoFill !=nil {return nil ,0,0;};var _dcbg float64 ;_eeag ,_aegd :=_gdcgb .getColorFromSolidFill (_dgef .SolidFill );if _gaff :=_dgef .WAttr ;_gaff !=nil {_dcbg =_bc .FromEMU (int64 (*_gaff ));}else {_dcbg =1;};return _eeag ,_dcbg ,_aegd ;};func (_bac *convertContext )getShapes (_cade *_dg .CT_Shape )[]_cd .Drawable {_fgd :=[]_cd .Drawable {};_ebee :=_cade .SpPr ;if _ebee ==nil {return _fgd ;};var _gcbe bool ;if _cce :=_cade .UseBgFillAttr ;_cce !=nil {_gcbe =*_cce ;};_eaa ,_dea ,_bef ,_cag ,_ffd ,_ggb ,_bgaf :=_bac .getShapesFromSpPr (_ebee ,_cade .Style ,_gcbe );_fgd =append (_fgd ,_eaa ...);if _ceb :=_cade .TxBody ;_ceb !=nil {_cbe ,_eaab ,_fee ,_cfc ,_dbf :=_bac .getPhData (_cade );if _cbe !=nil &&!_bgaf {_dea ,_bef ,_cag ,_ffd =_eea .GetDataFromXfrm (_cbe );};_fba ,_ddc :=_bac .makePdfBlockFromTxBody (_ceb ,_eaab ,_fee ,_cag ,_ffd ,_ggb ,_cfc ,_dbf );if _ddc !=nil {_gd .Log .Debug ("\u0043\u0061\u006e\u006e\u006f\u0074\u0020\u006d\u0061\u006b\u0065\u0020\u0050\u0044\u0046\u0020\u0062\u006c\u006f\u0063\u006b\u0020\u0066\u0072o\u006d\u0020\u0074\u0065\u0078t\u0062\u006fx\u003a\u0020\u0025\u0073",_ddc );}else if _fba !=nil {_fba .SetPos (_dea ,_bef );_fgd =append (_fgd ,_fba );};};return _fgd ;};func (_ag *convertContext )makePdfBlockFromChart (_eb *_cb .Chart ,_dga ,_fd float64 )(*_cd .Block ,error ){_fad :=_eb .CT_RelId .IdAttr ;_ge :=_ag ._bfda .GetChartSpaceByRelId (_fad );if _ge ==nil {return nil ,_b .New ("\u004e\u006f\u0020\u0063\u0068\u0061\u0072\u0074\u0073\u0070\u0061\u0063\u0065");};var _dc *_a .Theme ;_af :=_ag ._ggaa .Themes ();if len (_af )> 0{_dc =_af [0];};return _eea .MakeBlockFromChartSpace (_ge ,_dga ,_fd ,_dc );};type background struct{_dbfg _cd .Color ;_ebg float64 ;_fged *_a .CT_BlipFillProperties ;};func (_cad *convertContext )makeSlide (){_age :=_cad ._bfda .X ().CSld ;if _age ==nil {return ;};_afg :=&background {};if _ecg :=_age .Bg ;_ecg !=nil {if _aec :=_ecg .BgPr ;_aec !=nil {if _aec .NoFill ==nil {if _fdc :=_aec .SolidFill ;_fdc !=nil {_ff ,_ab :=_cad .getColorFromSolidFill (_fdc );if _ff !=nil {_afg ._dbfg =_ff ;_afg ._ebg =_ab ;};}else if _cbc :=_aec .BlipFill ;_cbc !=nil {_afg ._fged =_cbc ;};};};};_cad ._dbc =_afg ;if _agc :=_age .SpTree ;_agc !=nil {for _ ,_fac :=range _agc .Choice {if _fac !=nil {for _ ,_dce :=range _fac .Sp {if _dce !=nil {_aga :=_cad .getShapes (_dce );_cad ._bbe =append (_cad ._bbe ,_aga ...);};};for _ ,_agce :=range _fac .GraphicFrame {if _agce !=nil {var _gdg ,_bb ,_da ,_cec float64 ;if _dd :=_agce .Xfrm ;_dd !=nil {_gdg ,_bb ,_da ,_cec =_eea .GetDataFromXfrm (_dd );};if _fb :=_agce .Graphic ;_fb !=nil {if _fcc :=_fb .GraphicData ;_fcc !=nil {for _ ,_ecac :=range _fcc .Any {if _dcd ,_eeb :=_ecac .(*_cb .Chart );_eeb {_fg ,_gg :=_cad .makePdfBlockFromChart (_dcd ,_da ,_cec );if _gg !=nil {_gd .Log .Debug ("C\u0061\u006e\u006e\u006ft \u0072e\u0061\u0064\u0020\u0062\u006co\u0063\u006b\u003a\u0020\u0025\u0073",_gg );};if _fg !=nil {_fg .SetPos (_gdg ,_bb );_cad ._bbe =append (_cad ._bbe ,_fg );};}else if _gae ,_gc :=_ecac .(*_a .Tbl );_gc {_bga :=_cad .makePdfBlockFromTable (_gae ,_da );if _bga !=nil {_fge :=_cd .NewBlock (_da ,_cec );_fge .SetPos (_gdg ,_bb );_fge .Draw (_bga );_cad ._bbe =append (_cad ._bbe ,_fge );};};};};};};};for _ ,_gag :=range _fac .CxnSp {if _gag !=nil {_aece :=_cad .getConnectors (_gag );_cad ._bbe =append (_cad ._bbe ,_aece ...);};};for _ ,_dca :=range _fac .Pic {if _dca !=nil {var _cc ,_aef ,_ece ,_be float64 ;if _dgb :=_dca .SpPr ;_dgb !=nil {if _ebe :=_dgb .Xfrm ;_ebe !=nil {_cc ,_aef ,_ece ,_be =_eea .GetDataFromXfrm (_ebe );};};if _eae :=_dca .BlipFill ;_eae !=nil {_eaea :=_cad .getShapeFromBlipFill (_eae ,_cc ,_aef ,_ece ,_be );_cad ._bbe =append (_cad ._bbe ,_eaea );};};};};};};};func _efac (_eegd int ,_gbae bool )string {_dafg :=(_eegd -1)/26+1;_bgcab :=byte ((_eegd -1)%26);if _gbae {_bgcab +=byte (65);}else {_bgcab +=byte (97);};_ebf :=_ea .NewBuffer ([]byte {});for _agdge :=0;_agdge < _dafg ;_agdge ++{_ebf .Write ([]byte {_bgcab });};return _ebf .String ();};func _agcf (_dgdg *_a .CT_AdjPoint2D )(float64 ,float64 ){var _dbcb ,_ddg float64 ;_ffcb ,_bcb :=_dgdg .XAttr ,_dgdg .YAttr ;if _dgbc :=_ffcb .ST_Coordinate ;_dgbc !=nil {_dbcb =_bc .FromEMU (_eea .FromSTCoordinate (*_dgbc ));};if _eeed :=_bcb .ST_Coordinate ;_eeed !=nil {_ddg =_bc .FromEMU (_eea .FromSTCoordinate (*_eeed ));};return _dbcb ,_ddg ;};var _eggc =[]romanMatch {romanMatch {1000,"\u006d"},romanMatch {900,"\u0063\u006d"},romanMatch {500,"\u0064"},romanMatch {400,"\u0063\u0064"},romanMatch {100,"\u0063"},romanMatch {90,"\u0078\u0063"},romanMatch {50,"\u006c"},romanMatch {40,"\u0078\u006c"},romanMatch {10,"\u0078"},romanMatch {9,"\u0069\u0078"},romanMatch {5,"\u0076"},romanMatch {4,"\u0069\u0076"},romanMatch {1,"\u0069"}};func (_fdac *textboxContext )alignParagraph (){_abcb :=_fdac ._gefd ;if _abcb ._dac ==_a .ST_TextAlignTypeL {return ;};_aad :=len (_abcb ._cbcc )-1;for _eabag ,_cba :=range _abcb ._cbcc {_bcdee :=true ;_dceda :=len (_cba ._egb );_edbc :=0.0;for _deadf :=len (_cba ._egb )-1;_deadf >=0;_deadf --{_bdbb :=_cba ._egb [_deadf ];if _bcdee &&_bdbb ._gcgb {_dceda =_deadf ;}else {_bcdee =false ;for _ ,_dbea :=range _bdbb ._cacd {_edbc +=_dbea ._cgfb ;};};};_cba ._egb =_cba ._egb [:_dceda ];_gbdf :=_cba ._ddfg -_cba ._eaba -_edbc ;switch _abcb ._dac {case _a .ST_TextAlignTypeR :_cba .moveRight (_gbdf );case _a .ST_TextAlignTypeCtr :_cba .moveRight (_gbdf /2);case _a .ST_TextAlignTypeJust :if _eabag !=_aad {_edced :=[]*word {};for _ ,_efc :=range _cba ._egb {if _efc ._gcgb {_edced =append (_edced ,_efc );};};_cdfc :=_gbdf /float64 (len (_edced ));for _ ,_bbcd :=range _edced {_bbcd ._bgdc +=_cdfc ;};var _fbaf *word ;for _ ,_ebdf :=range _cba ._egb {if _fbaf !=nil {_ebdf ._eeec =_fbaf ._eeec +_fbaf ._bgdc ;};_fbaf =_ebdf ;};};};};};func _abfb (_baec *bool )bool {return _baec !=nil &&*_baec };var _eggcc =map[string ]int32 {"\u0076":9830,"\u00d8":8594,"\u00fc":8730};type line struct{_ccgf float64 ;_eaba float64 ;_ddfg float64 ;_adb float64 ;_cgcf float64 ;_egb []*word ;};func (_deea *convertContext )makeStyleFromRPr (_agd *_a .CT_TextCharacterProperties )(*_cd .TextStyle ,bool ,bool ,bool ){var _cced ,_dfb ,_ebbd bool ;_fbfa :=_deea ._cbb .NewTextStyle ();if _agd !=nil {_fgga :=_eea .FontStyle_Regular ;_cdg :=_abfb (_agd .BAttr );_gdee :=_abfb (_agd .IAttr );if _cdg &&_gdee {_fgga =_eea .FontStyle_BoldItalic ;}else if _cdg {_fgga =_eea .FontStyle_Bold ;}else if _gdee {_fgga =_eea .FontStyle_Italic ;};_ebbd =_agd .UAttr !=_a .ST_TextUnderlineTypeUnset &&_agd .UAttr !=_a .ST_TextUnderlineTypeNone ;_fgag :="\u0064e\u0066\u0061\u0075\u006c\u0074";if _bbb :=_agd .Latin ;_bbb !=nil {_fgag =_bbb .TypefaceAttr ;}else if _ecde :=_agd .Ea ;_ecde !=nil {_fgag =_ecde .TypefaceAttr ;}else if _dbb :=_agd .Cs ;_dbb !=nil {_fgag =_dbb .TypefaceAttr ;}else if _fdd :=_agd .Sym ;_fdd !=nil {_fgag =_fdd .TypefaceAttr ;};if _adfc ,_baa :=_eea .StdFontsMap [_fgag ];_baa {_fbfa .Font =_eea .AssignStdFontByName (_fbfa ,_adfc [_fgga ]);}else if _agdg :=_eea .GetRegisteredFont (_fgag ,_fgga );_agdg !=nil {_fbfa .Font =_agdg ;}else {_gd .Log .Debug ("\u0046\u006f\u006e\u0074\u0020\u0025\u0073\u0020\u0077\u0069\u0074h\u0020\u0073\u0074\u0079\u006c\u0065\u0020\u0025s\u0020i\u0073\u0020\u006e\u006f\u0074\u0020\u0066\u006f\u0075\u006e\u0064\u002c\u0020\u0072\u0065\u0073\u0065\u0074 \u0074\u006f\u0020\u0064\u0065\u0066\u0061\u0075\u006c\u0074\u002e",_fgag ,_fgga );_fbfa .Font =_eea .AssignStdFontByName (_fbfa ,_eea .StdFontsMap ["\u0064e\u0066\u0061\u0075\u006c\u0074"][_fgga ]);};var _bggf float64 ;if _bge :=_agd .SzAttr ;_bge !=nil {_bggf =float64 (*_bge )/100;}else {_bggf =_eea .DefaultFontSize ;};if _efgg :=_agd .BaselineAttr ;_efgg !=nil {if _fbd :=_efgg .ST_PercentageDecimal ;_fbd !=nil {if *_fbd > 0{_cced =true ;}else if *_fbd < 0{_dfb =true ;};};};if _cced ||_dfb {_bggf *=0.64;};_fbfa .FontSize =_bggf ;_ega :=0.0;if _febc :=_agd .SpcAttr ;_febc !=nil {if _geeg :=_febc .ST_TextPointUnqualified ;_geeg !=nil {_ega =float64 (*_geeg )/100;};};_fbfa .CharSpacing =_ega ;};return &_fbfa ,_cced ,_dfb ,_ebbd ;};func (_dgfg *textboxContext )alignVertically (_dfa _a .ST_TextAnchoringType ){_dgfg .alignParagraphsVertically (_dfa );_dgfg .alignSymbolsVertically ();};

// RegisterFont makes a PdfFont accessible for using in converting to PDF.
func RegisterFont (name string ,style FontStyle ,font *_fa .PdfFont ){_eea .RegisterFont (name ,style ,font );};func _ebcg (_daed *_a .CT_TableCellProperties ,_baed *_a .CT_TableStyleCellStyle ,_bgbf ,_edda ,_ffdf ,_eedf bool )*_a .CT_TableCellProperties {_dfefe :=_a .NewCT_TableCellProperties ();if _daed !=nil {*_dfefe =*_daed ;};if _baed ==nil {return _dfefe ;};if _daaf :=_baed .FillRef ;_daaf !=nil {_edgf :=_a .NewCT_SolidColorFillProperties ();_edgf .ScrgbClr =_daaf .ScrgbClr ;_edgf .SrgbClr =_daaf .SrgbClr ;_edgf .HslClr =_daaf .HslClr ;_edgf .SysClr =_daaf .SysClr ;_edgf .SchemeClr =_daaf .SchemeClr ;_edgf .PrstClr =_daaf .PrstClr ;_dfefe .SolidFill =_edgf ;};if _dfefe .NoFill ==nil &&_dfefe .SolidFill ==nil {if _baecf :=_baed .Fill ;_baecf !=nil {if _dfefe .NoFill ==nil {_dfefe .NoFill =_baecf .NoFill ;};if _dfefe .SolidFill ==nil {_dfefe .SolidFill =_baecf .SolidFill ;};};};if _eded :=_baed .TcBdr ;_eded !=nil {if _dfefe .LnL ==nil {var _cgcg *_a .CT_ThemeableLineStyle ;if _ffdf {_cgcg =_eded .Left ;}else {_cgcg =_eded .InsideV ;};if _cgcg !=nil {_dfefe .LnL =_cgcg .Ln ;};};if _dfefe .LnR ==nil {var _daaff *_a .CT_ThemeableLineStyle ;if _eedf {_daaff =_eded .Right ;}else {_daaff =_eded .InsideV ;};if _daaff !=nil {_dfefe .LnR =_daaff .Ln ;};};if _dfefe .LnT ==nil {var _bbfe *_a .CT_ThemeableLineStyle ;if _bgbf {_bbfe =_eded .Top ;}else {_bbfe =_eded .InsideH ;};if _bbfe !=nil {_dfefe .LnT =_bbfe .Ln ;};};if _dfefe .LnB ==nil {var _acgbc *_a .CT_ThemeableLineStyle ;if _edda {_acgbc =_eded .Bottom ;}else {_acgbc =_eded .InsideH ;};if _acgbc !=nil {_dfefe .LnB =_acgbc .Ln ;};};};return _dfefe ;};func _ead (_fag *_dg .CT_Shape )(_dg .ST_PlaceholderType ,*uint32 ){if _aafg :=_fag .NvSpPr ;_aafg !=nil {if _ggdd :=_aafg .NvPr ;_ggdd !=nil {if _bade :=_ggdd .Ph ;_bade !=nil {return _bade .TypeAttr ,_bade .IdxAttr ;};};};return _dg .ST_PlaceholderTypeUnset ,nil ;};func (_bbd *textboxContext )drawParagraphs (){_bbd ._fdg .NewPage ();for _ ,_fgb :=range _bbd ._ddfe {for _ ,_bcde :=range _fgb ._cbcc {for _ ,_cfgg :=range _bcde ._egb {for _ ,_dbe :=range _cfgg ._cacd {_fddc :=_bbd ._fdg .NewStyledParagraph ();if _dbe ._dgde {_dbe ._ccbe =0;}else if _dbe ._edg {_dbe ._ccbe =1.2*_bcde ._cgcf -_dbe ._egefb ;};_edce :=_cfgg ._eeec +_dbe ._ccea ;_baab :=_fgb ._ccf +_bcde ._ccgf +_dbe ._ccbe ;_fddc .SetPos (_edce ,_baab );_deg :=_fddc .Append (_dbe ._gaf );if _dbe ._eddgb !=nil {_deg .Style =*_dbe ._eddgb ;};_bbd ._fdg .Draw (_fddc );if _dbe ._ffc {_cbg :=_baab +_dbe ._egefb +2;_eea .DrawLine (_bbd ._fdg ,_edce ,_cbg ,_edce +_dbe ._cgfb ,_cbg ,1,_dbe ._eddgb .Color );};};};};};};func (_fae *convertContext )extractDefaultProperties (){_dge :=_fae ._ggaa .X ();_ac :=_dge .DefaultTextStyle ;var _bg ,_ca ,_fe ,_de ,_fea ,_bae ,_bd ,_afa ,_ae ,_cfe *_a .CT_TextParagraphProperties ;if _ac !=nil {_bg =_ac .DefPPr ;_ca =_eagcb (_ac .Lvl1pPr ,_bg );_fe =_eagcb (_ac .Lvl2pPr ,_bg );_de =_eagcb (_ac .Lvl3pPr ,_bg );_fea =_eagcb (_ac .Lvl4pPr ,_bg );_bae =_eagcb (_ac .Lvl5pPr ,_bg );_bd =_eagcb (_ac .Lvl6pPr ,_bg );_afa =_eagcb (_ac .Lvl7pPr ,_bg );_ae =_eagcb (_ac .Lvl8pPr ,_bg );_cfe =_eagcb (_ac .Lvl9pPr ,_bg );_fae ._bfc =_bg ;_fae ._ded =_bg .DefRPr ;};_fae ._fddf =make ([]*_a .CT_TextParagraphProperties ,9);_fae ._fddf [0]=_ca ;_fae ._fddf [1]=_fe ;_fae ._fddf [2]=_de ;_fae ._fddf [3]=_fea ;_fae ._fddf [4]=_bae ;_fae ._fddf [5]=_bd ;_fae ._fddf [6]=_afa ;_fae ._fddf [7]=_ae ;_fae ._fddf [8]=_cfe ;_aa :=_fae ._ggaa .SlideMasters ()[0].X ();_fc :=_aa .TxStyles ;_aaa :=_fc .TitleStyle ;_fae ._dae =_eagcb (_aaa .DefPPr ,_bg );_fae ._afaa =_fae ._dae .DefRPr ;_fae ._ebcd =make ([]*_a .CT_TextParagraphProperties ,9);_fae ._ebcd [0]=_eagcb (_aaa .Lvl1pPr ,_ca );_fae ._ebcd [1]=_eagcb (_aaa .Lvl2pPr ,_fe );_fae ._ebcd [2]=_eagcb (_aaa .Lvl3pPr ,_de );_fae ._ebcd [3]=_eagcb (_aaa .Lvl4pPr ,_fea );_fae ._ebcd [4]=_eagcb (_aaa .Lvl5pPr ,_bae );_fae ._ebcd [5]=_eagcb (_aaa .Lvl6pPr ,_bd );_fae ._ebcd [6]=_eagcb (_aaa .Lvl7pPr ,_afa );_fae ._ebcd [7]=_eagcb (_aaa .Lvl8pPr ,_ae );_fae ._ebcd [8]=_eagcb (_aaa .Lvl9pPr ,_cfe );_eca :=_fc .BodyStyle ;_fae ._bfdbf =_eagcb (_eca .DefPPr ,_bg );_fae ._fbb =_fae ._bfdbf .DefRPr ;_fae ._bfb =make ([]*_a .CT_TextParagraphProperties ,9);_fae ._bfb [0]=_eagcb (_eca .Lvl1pPr ,_ca );_fae ._bfb [1]=_eagcb (_eca .Lvl2pPr ,_fe );_fae ._bfb [2]=_eagcb (_eca .Lvl3pPr ,_de );_fae ._bfb [3]=_eagcb (_eca .Lvl4pPr ,_fea );_fae ._bfb [4]=_eagcb (_eca .Lvl5pPr ,_bae );_fae ._bfb [5]=_eagcb (_eca .Lvl6pPr ,_bd );_fae ._bfb [6]=_eagcb (_eca .Lvl7pPr ,_afa );_fae ._bfb [7]=_eagcb (_eca .Lvl8pPr ,_ae );_fae ._bfb [8]=_eagcb (_eca .Lvl9pPr ,_cfe );};func (_ada *convertContext )drawSlide (){_ada ._cbb .NewPage ();for _ ,_cfg :=range _ada ._bbe {if _cfg !=nil {_ada ._cbb .MoveTo (0,0);_ada ._cbb .Draw (_cfg );};};};func (_deed *convertContext )getColorFromFontReference (_ebab *_a .CT_FontReference )_cd .Color {var _aeg _cd .Color ;var _dcf string ;if _bafb :=_ebab .SrgbClr ;_bafb !=nil {_dcf =_bafb .ValAttr ;}else if _fbef :=_ebab .SchemeClr ;_fbef !=nil {_dcf =_eea .GetColorStringFromDmlColor (_deed ._ggaa .GetColorBySchemeColor (_fbef .ValAttr ));_dcf =_eea .AdjustColor (_dcf ,_fbef .EG_ColorTransform );};if _dcf !=""{_aeg =_cd .ColorRGBFromHex ("\u0023"+_dcf );};return _aeg ;};func _daff (_gafa *_dg .CT_CommonSlideData ,_fcde _dg .ST_PlaceholderType ,_fgeda *uint32 ,_adef bool )(*_a .CT_Transform2D ,*_a .CT_TextBody ,*bool ,*bool ){if _gafa !=nil &&(_fcde !=_dg .ST_PlaceholderTypeUnset ||!_adef ){if _gcfg :=_gafa .SpTree ;_gcfg !=nil {for _ ,_gaae :=range _gcfg .Choice {if _gaae !=nil {for _ ,_becg :=range _gaae .Sp {if _becg !=nil {_ddea ,_fccd :=_ead (_becg );if _fcde ==_ddea {if (_adef &&_fccd ==nil )||(!_adef &&_fccd !=nil &&*_fccd ==*_fgeda ){var _cfgd *_a .CT_Transform2D ;if _becg .SpPr !=nil {_cfgd =_becg .SpPr .Xfrm ;};_eaag :=_fcde ==_dg .ST_PlaceholderTypeTitle ||_fcde ==_dg .ST_PlaceholderTypeCtrTitle ;_gegd :=!_eaag &&_fcde !=_dg .ST_PlaceholderTypeUnset ;return _cfgd ,_becg .TxBody ,&_eaag ,&_gegd ;};};};};};};};};return nil ,nil ,nil ,nil ;};func (_edfg *textboxContext )assignPropsToCurrentParagraph (_gcfc *_a .CT_TextParagraphProperties ){_bdac :=12.4;if _gcfc ==nil {_edfg ._gefd ._afeaa =_bdac ;return ;};if _bcg :=_gcfc .DefRPr ;_bcg !=nil {_aaaa :=_bcg .SzAttr ;if _aaaa !=nil {_eed :=float64 (*_aaaa )/1200;if _bdac <=_eed {_bdac =_eed ;};};};if _gecd :=_gcfc .MarLAttr ;_gecd !=nil {_edfg ._gefd ._edaf =_bc .FromEMU (int64 (*_gecd ));};_edfg ._gefd ._agfb =_edfg ._faf ;if _befa :=_gcfc .MarRAttr ;_befa !=nil {_edfg ._gefd ._agfb -=_bc .FromEMU (int64 (*_befa ));};if _cdb :=_gcfc .IndentAttr ;_cdb !=nil {_edfg ._gefd ._cgeg =_bc .FromEMU (int64 (*_cdb ));};if _edgc :=_gcfc .LatinLnBrkAttr ;_edgc !=nil {_edfg ._gefd ._gfg =*_edgc ;};if _fcf :=_gcfc .LnSpc ;_fcf !=nil {if _dbbc :=_fcf .SpcPct ;_dbbc !=nil {if _fcfg :=_dbbc .ValAttr .ST_TextSpacingPercent ;_fcfg !=nil {_bdac =float64 (*_fcfg )/5000;};};};var _cfa float64 ;if _fdgd :=_gcfc .SpcBef ;_fdgd !=nil {if _efgb :=_fdgd .SpcPts ;_efgb !=nil {_cfa =float64 (_efgb .ValAttr )/100;};};_becd :=_edfg ._ddfe ;if len (_becd )> 0{_cfa -=_becd [len (_becd )-1]._ccbf ;if _cfa < 0{_cfa =0;};};_edfg ._gefd ._abge =_cfa ;if _dgcc :=_gcfc .SpcAft ;_dgcc !=nil {if _cfd :=_dgcc .SpcPts ;_cfd !=nil {_edfg ._gefd ._ccbf =float64 (_cfd .ValAttr )/100;};};_edfg ._gefd ._afeaa =_bdac ;_edfg ._gefd ._dac =_gcfc .AlgnAttr ;};func (_cafg *textboxContext )newWord (){_cafg ._cdac =&word {_gcgb :true ,_eeec :_cafg ._gbb ._adb }};type prefixData struct{_gadc string ;_aebf bool ;_gea float64 ;_acad float64 ;};func (_cdffa *textboxContext )addTextRun (_gaeg *_a .EG_TextRun ,_fddae *_a .CT_TextCharacterProperties ,_egbf _cd .Color ,_fdb *prefixData ){if _dcb :=_gaeg .Br ;_dcb !=nil {_cdffa .addCurrentWordToParagraph ();_cdffa .newLine ();_cdffa .newWord ();}else if _fdbc :=_gaeg .R ;_fdbc !=nil {var _febf _cd .Color ;if _fdbc .RPr .SolidFill !=nil {_febf ,_ =_cdffa ._cffc .getColorFromSolidFill (_fdbc .RPr .SolidFill );}else if _egbf !=nil {_febf =_egbf ;}else if _fddae .SolidFill !=nil {_febf ,_ =_cdffa ._cffc .getColorFromSolidFill (_fddae .SolidFill );}else {_febf =_cd .ColorBlack ;};_ddaga :=_febe (_fdbc .RPr ,_fddae );_gfgc ,_fccb ,_aacc ,_fdca :=_cdffa ._cffc .makeStyleFromRPr (_ddaga );_gfgc .Color =_febf ;if _fdb !=nil {_cdffa .addPrefix (_fdb ,_gfgc );};_ffga :=_acge (_fdbc .T );for _ ,_fcfc :=range _ffga {_fcfc ._eddgb =_gfgc ;_fcfc ._dgde =_fccb ;_fcfc ._edg =_aacc ;_fcfc ._ffc =_fdca ;if _ddaga .CapAttr ==_a .ST_TextCapsTypeAll {_fcfc ._gaf =_g .ToUpper (_fcfc ._gaf );};_cdffa .addTextSymbol (_fcfc );};};};func (_adf *convertContext )makePdfDivisionFromTxBody (_cdff *_a .CT_TextBody ,_ede ,_agaf float64 ,_gbc *_a .CT_TableStyleTextStyle )*_cd .Division {_gba :=_adf ._cbb .NewDivision ();_agg :=_adf ._bfc ;_feg :=_a .ST_TextAnchoringTypeT ;if _eeg :=_cdff .BodyPr ;_eeg !=nil {if _geee :=_eeg .AnchorAttr ;_geee !=_a .ST_TextAnchoringTypeUnset {_feg =_eeg .AnchorAttr ;};};if _ecb :=_cdff .LstStyle ;_ecb !=nil {var _bbgf *_a .CT_TextParagraphProperties ;if _ecb .Lvl1pPr !=nil {_bbgf =_ecb .Lvl1pPr ;}else {_bbgf =_adf ._fddf [0];};_agg =_eagcb (_bbgf ,_eagcb (_ecb .DefPPr ,_agg ));};for _ ,_dcag :=range _cdff .P {if _dcag !=nil {_efg :=_adf ._cbb .NewStyledParagraph ();_fda :=_eagcb (_dcag .PPr ,_agg );_gfd :=_febe (_dcag .EndParaRPr ,_fda .DefRPr );if len (_dcag .EG_TextRun )==0{_efg .Append ("\u000a");_gba .Add (_efg );continue ;};for _ ,_gfea :=range _dcag .EG_TextRun {if _cdfe :=_gfea .Br ;_cdfe !=nil {_efg .Append ("\u000a");}else if _agga :=_gfea .R ;_agga !=nil {_dfd :=_fdbf (_agga .RPr ,_gbc );_dfd =_febe (_dfd ,_gfd );var _feb _cd .Color ;if _dfd .SolidFill !=nil {_feb ,_ =_adf .getColorFromSolidFill (_dfd .SolidFill );}else {_feb =_cd .ColorBlack ;};_fga ,_gad ,_gec ,_ :=_adf .makeStyleFromRPr (_dfd );_fga .Color =_feb ;if _gad {_fga .TextRise =0.5;}else if _gec {_fga .TextRise =-0.5;};_facc :=_agga .T ;if _dfd .CapAttr ==_a .ST_TextCapsTypeAll {for _ ,_gde :=range _facc {_gde =[]rune (_g .ToUpper (string (_gde )))[0];};};_eag :=_efg .Append (_facc );_eag .Style =*_fga ;};};_ =_feg ;_gba .Add (_efg );};};return _gba ;};func _acge (_gcag string )[]*symbol {_cgfg :=[]*symbol {};for _ ,_gdd :=range _gcag {_cgfg =append (_cgfg ,&symbol {_gaf :string (_gdd )});};return _cgfg ;};type textboxContext struct{_cffc *convertContext ;_faf float64 ;_dgbe float64 ;_fdg *_cd .Creator ;_ebeb float64 ;_ddfe []*paragraph ;_gefd *paragraph ;_gbb *line ;_cdac *word ;_bfca bool ;};var _cdc =_fbgd (1.9);func (_bgc *convertContext )makePdfBlockFromTxBody (_ecafd *_a .CT_TextBody ,_eaae *_a .CT_TextBodyProperties ,_deb *_a .CT_TextListStyle ,_dgf ,_aaaf float64 ,_afe _cd .Color ,_aaca ,_cadf bool )(*_cd .Block ,error ){var _afd *_a .CT_TextParagraphProperties ;if _ade :=_ecafd .LstStyle ;_ade !=nil {var _gbgf *_a .CT_TextParagraphProperties ;if _ade .Lvl1pPr !=nil {_gbgf =_ade .Lvl1pPr ;};_afd =_eagcb (_gbgf ,_ade .DefPPr );};var _edeb *_a .CT_TextParagraphProperties ;if _afd !=nil {if _aaca {_edeb =_bgc ._ebcd [0];}else if _cadf {_edeb =_bgc ._bfb [0];}else {_edeb =_bgc ._fddf [0];};if _deb !=nil {_edeb =_eagcb (_eagcb (_deb .Lvl1pPr ,_deb .DefPPr ),_edeb );};_edeb =_eagcb (_afd ,_edeb );}else {if _aaca {_edeb =_bgc ._dae ;}else if _cadf {_edeb =_bgc ._bfdbf ;}else {_edeb =_bgc ._bfc ;};};_aee ,_afea :=_fbgd (2.5),_fbgd (2.5);_dgea ,_cgf :=_fbgd (1.3),_fbgd (1.3);_ggfd :=true ;_dee :=_a .ST_TextAnchoringTypeT ;if _eaae !=nil {if _cebg :=_eaae .AnchorAttr ;_cebg !=_a .ST_TextAnchoringTypeUnset {_dee =_cebg ;};};if _bbff :=_ecafd .BodyPr ;_bbff !=nil {if _fca :=_bbff .LInsAttr ;_fca !=nil {_aee =_bc .FromEMU (_eea .FromSTCoordinate32 (*_fca ));};if _facb :=_bbff .TInsAttr ;_facb !=nil {_dgea =_bc .FromEMU (_eea .FromSTCoordinate32 (*_facb ));};if _dff :=_bbff .RInsAttr ;_dff !=nil {_afea =_bc .FromEMU (_eea .FromSTCoordinate32 (*_dff ));};if _eagc :=_bbff .BInsAttr ;_eagc !=nil {_cgf =_bc .FromEMU (_eea .FromSTCoordinate32 (*_eagc ));};_ggfd =_bbff .WrapAttr !=_a .ST_TextWrappingTypeNone ;if _bda :=_bbff .AnchorAttr ;_bda !=_a .ST_TextAnchoringTypeUnset {_dee =_bbff .AnchorAttr ;};};_ccg :=_eea .MakeTempCreator (_dgf ,_aaaf );_ccg .SetPageMargins (_aee ,_afea ,_dgea ,_cgf );_fbaa :=&textboxContext {_cffc :_bgc ,_bfca :_ggfd ,_faf :_dgf -_aee -_afea ,_dgbe :_aaaf -_dgea -_cgf ,_fdg :_ccg ,_ddfe :[]*paragraph {}};_bba :=1;for _ ,_gebf :=range _ecafd .P {if _gebf !=nil {_dgd :=_gebf .PPr ;var _ceg *prefixData ;if _dgd !=nil &&_dgd .BuNone ==nil {var _efa string ;var _edc bool ;if _bdg :=_dgd .BuAutoNum ;_bdg !=nil {var _cdcdb string ;if _dgda :=_bdg .StartAtAttr ;_dgda !=nil {_bba =int (*_dgda );};var _add string ;switch _bdg .TypeAttr {case _a .ST_TextAutonumberSchemeAlphaUcParenBoth ,_a .ST_TextAutonumberSchemeAlphaUcParenR ,_a .ST_TextAutonumberSchemeAlphaUcPeriod :_add =_efac (_bba ,true );case _a .ST_TextAutonumberSchemeAlphaLcParenBoth ,_a .ST_TextAutonumberSchemeAlphaLcParenR ,_a .ST_TextAutonumberSchemeAlphaLcPeriod :_add =_efac (_bba ,false );case _a .ST_TextAutonumberSchemeRomanUcParenBoth ,_a .ST_TextAutonumberSchemeRomanUcParenR ,_a .ST_TextAutonumberSchemeRomanUcPeriod :_add =_aag (_bba ,true );case _a .ST_TextAutonumberSchemeRomanLcParenBoth ,_a .ST_TextAutonumberSchemeRomanLcParenR ,_a .ST_TextAutonumberSchemeRomanLcPeriod :_add =_aag (_bba ,false );default:_add =_ba .Itoa (_bba );};switch _bdg .TypeAttr {case _a .ST_TextAutonumberSchemeAlphaLcPeriod ,_a .ST_TextAutonumberSchemeAlphaUcPeriod ,_a .ST_TextAutonumberSchemeArabicPeriod ,_a .ST_TextAutonumberSchemeRomanLcPeriod ,_a .ST_TextAutonumberSchemeRomanUcPeriod ,_a .ST_TextAutonumberSchemeArabicDbPeriod ,_a .ST_TextAutonumberSchemeEa1ChsPeriod ,_a .ST_TextAutonumberSchemeEa1ChtPeriod ,_a .ST_TextAutonumberSchemeEa1JpnChsDbPeriod ,_a .ST_TextAutonumberSchemeEa1JpnKorPeriod ,_a .ST_TextAutonumberSchemeThaiAlphaPeriod ,_a .ST_TextAutonumberSchemeThaiNumPeriod ,_a .ST_TextAutonumberSchemeHindiAlphaPeriod ,_a .ST_TextAutonumberSchemeHindiNumPeriod ,_a .ST_TextAutonumberSchemeHindiAlpha1Period :_cdcdb ="\u002e";case _a .ST_TextAutonumberSchemeAlphaLcParenR ,_a .ST_TextAutonumberSchemeAlphaUcParenR ,_a .ST_TextAutonumberSchemeArabicParenR ,_a .ST_TextAutonumberSchemeRomanLcParenR ,_a .ST_TextAutonumberSchemeRomanUcParenR ,_a .ST_TextAutonumberSchemeThaiAlphaParenR ,_a .ST_TextAutonumberSchemeThaiNumParenR ,_a .ST_TextAutonumberSchemeHindiNumParenR :_cdcdb ="\u0029";};_efa =_add +_cdcdb ;_bba ++;}else if _dfe :=_dgd .BuChar ;_dfe !=nil {_ddb :=_dfe .CharAttr ;if _affd ,_egg :=_eggcc [_ddb ];_egg {_ddb =string (rune (_affd ));}else {_ddb ="\u2022";};_efa =_ddb ;_edc =true ;};if _efa !=""{var _bfdb ,_gfc float64 ;if _dgd .MarLAttr !=nil {_bfdb =_bc .FromEMU (int64 (*_dgd .MarLAttr ));};if _dgd .IndentAttr !=nil {_gfc =_bc .FromEMU (int64 (*_dgd .IndentAttr ));};_ceg =&prefixData {_gadc :_efa ,_aebf :_edc ,_gea :_bfdb ,_acad :_gfc };};};_dgd =_eagcb (_dgd ,_edeb );_bbgff :=_febe (_gebf .EndParaRPr ,_dgd .DefRPr );_fbaa .newParagraph ();_fbaa .assignPropsToCurrentParagraph (_dgd );_fbaa .newLine ();_fbaa .newWord ();for _gac ,_cff :=range _gebf .EG_TextRun {_fbaa .addTextRun (_cff ,_bbgff ,_afe ,_ceg );if _gac > 0{_ceg =nil ;};};_fbaa .addCurrentWordToParagraph ();};_fbaa .addCurrentParagraph ();};_fbaa .alignVertically (_dee );_fbaa .drawParagraphs ();return _eea .MakeBlockFromCreator (_ccg );};func _febe (_egegf ,_aafd *_a .CT_TextCharacterProperties )*_a .CT_TextCharacterProperties {_agdf :=_a .NewCT_TextCharacterProperties ();if _egegf !=nil {*_agdf =*_egegf ;};if _aafd ==nil {return _agdf ;};if _agdf .KumimojiAttr ==nil {_agdf .KumimojiAttr =_aafd .KumimojiAttr ;};if _agdf .LangAttr ==nil {_agdf .LangAttr =_aafd .LangAttr ;};if _agdf .AltLangAttr ==nil {_agdf .AltLangAttr =_aafd .AltLangAttr ;};if _agdf .SzAttr ==nil {_agdf .SzAttr =_aafd .SzAttr ;};if _agdf .BAttr ==nil {_agdf .BAttr =_aafd .BAttr ;};if _agdf .IAttr ==nil {_agdf .IAttr =_aafd .IAttr ;};if _agdf .UAttr ==_a .ST_TextUnderlineTypeUnset {_agdf .UAttr =_aafd .UAttr ;};if _agdf .StrikeAttr ==_a .ST_TextStrikeTypeUnset {_agdf .StrikeAttr =_aafd .StrikeAttr ;};if _agdf .KernAttr ==nil {_agdf .KernAttr =_aafd .KernAttr ;};if _agdf .CapAttr ==_a .ST_TextCapsTypeUnset {_agdf .CapAttr =_aafd .CapAttr ;};if _agdf .SpcAttr ==nil {_agdf .SpcAttr =_aafd .SpcAttr ;};if _agdf .NormalizeHAttr ==nil {_agdf .NormalizeHAttr =_aafd .NormalizeHAttr ;};if _agdf .BaselineAttr ==nil {_agdf .BaselineAttr =_aafd .BaselineAttr ;};if _agdf .NoProofAttr ==nil {_agdf .NoProofAttr =_aafd .NoProofAttr ;};if _agdf .DirtyAttr ==nil {_agdf .DirtyAttr =_aafd .DirtyAttr ;};if _agdf .ErrAttr ==nil {_agdf .ErrAttr =_aafd .ErrAttr ;};if _agdf .SmtCleanAttr ==nil {_agdf .SmtCleanAttr =_aafd .SmtCleanAttr ;};if _agdf .SmtIdAttr ==nil {_agdf .SmtIdAttr =_aafd .SmtIdAttr ;};if _agdf .BmkAttr ==nil {_agdf .BmkAttr =_aafd .BmkAttr ;};if _agdf .Ln ==nil {_agdf .Ln =_aafd .Ln ;};if _agdf .NoFill ==nil {_agdf .NoFill =_aafd .NoFill ;};if _agdf .SolidFill ==nil {_agdf .SolidFill =_aafd .SolidFill ;};if _agdf .BlipFill ==nil {_agdf .BlipFill =_aafd .BlipFill ;};if _agdf .EffectLst ==nil {_agdf .EffectLst =_aafd .EffectLst ;};if _agdf .EffectDag ==nil {_agdf .EffectDag =_aafd .EffectDag ;};if _agdf .Highlight ==nil {_agdf .Highlight =_aafd .Highlight ;};if _agdf .ULnTx ==nil {_agdf .ULnTx =_aafd .ULnTx ;};if _agdf .ULn ==nil {_agdf .ULn =_aafd .ULn ;};if _agdf .UFillTx ==nil {_agdf .UFillTx =_aafd .UFillTx ;};if _agdf .UFill ==nil {_agdf .UFill =_aafd .UFill ;};if _agdf .Latin ==nil {_agdf .Latin =_aafd .Latin ;};if _agdf .Ea ==nil {_agdf .Ea =_aafd .Ea ;};if _agdf .Cs ==nil {_agdf .Cs =_aafd .Cs ;};if _agdf .Sym ==nil {_agdf .Sym =_aafd .Sym ;};if _agdf .Rtl ==nil {_agdf .Rtl =_aafd .Rtl ;};return _agdf ;};func (_dbab *line )moveRight (_bfce float64 ){for _ ,_ggg :=range _dbab ._egb {_ggg ._eeec +=_bfce ;};};func (_cggb *textboxContext )addPrefix (_acd *prefixData ,_gddg *_cd .TextStyle ){_ecf :=_acge (_acd ._gadc );_cegb :=*_gddg ;if _acd ._aebf {_cegb .Font =_eea .AssignStdFontByName (_cegb ,"\u0053\u0079\u006d\u0062\u006f\u006c");};for _ ,_cgd :=range _ecf {_cgd ._eddgb =&_cegb ;_cggb .addTextSymbol (_cgd );};_acaa :=-(_acd ._acad +_cggb ._cdac ._bgdc );if _acaa < 0{_acaa =0;};_begc :=&symbol {_gaf :"\u0020",_cgfb :_acaa };_cggb .addTextSymbol (_begc );_cggb ._cdac ._eeec +=(_acd ._acad +_acd ._gea );};func _eagcb (_bbda ,_fadc *_a .CT_TextParagraphProperties )*_a .CT_TextParagraphProperties {_ggef :=_a .NewCT_TextParagraphProperties ();if _bbda !=nil {*_ggef =*_bbda ;};if _fadc ==nil {return _ggef ;};if _ggef .MarLAttr ==nil {_ggef .MarLAttr =_fadc .MarLAttr ;};if _ggef .MarRAttr ==nil {_ggef .MarRAttr =_fadc .MarRAttr ;};if _ggef .LvlAttr ==nil {_ggef .LvlAttr =_fadc .LvlAttr ;};if _ggef .IndentAttr ==nil {_ggef .IndentAttr =_fadc .IndentAttr ;};if _ggef .AlgnAttr ==_a .ST_TextAlignTypeUnset {_ggef .AlgnAttr =_fadc .AlgnAttr ;};if _ggef .DefTabSzAttr ==nil {_ggef .DefTabSzAttr =_fadc .DefTabSzAttr ;};if _ggef .RtlAttr ==nil {_ggef .RtlAttr =_fadc .RtlAttr ;};if _ggef .EaLnBrkAttr ==nil {_ggef .EaLnBrkAttr =_fadc .EaLnBrkAttr ;};if _ggef .FontAlgnAttr ==_a .ST_TextFontAlignTypeUnset {_ggef .FontAlgnAttr =_fadc .FontAlgnAttr ;};if _ggef .LatinLnBrkAttr ==nil {_ggef .LatinLnBrkAttr =_fadc .LatinLnBrkAttr ;};if _ggef .HangingPunctAttr ==nil {_ggef .HangingPunctAttr =_fadc .HangingPunctAttr ;};if _ggef .LnSpc ==nil {_ggef .LnSpc =_fadc .LnSpc ;};if _ggef .SpcBef ==nil {_ggef .SpcBef =_fadc .SpcBef ;};if _ggef .SpcAft ==nil {_ggef .SpcAft =_fadc .SpcAft ;};if _ggef .BuClrTx ==nil {_ggef .BuClrTx =_fadc .BuClrTx ;};if _ggef .BuClr ==nil {_ggef .BuClr =_fadc .BuClr ;};if _ggef .BuSzTx ==nil {_ggef .BuSzTx =_fadc .BuSzTx ;};if _ggef .BuSzPct ==nil {_ggef .BuSzPct =_fadc .BuSzPct ;};if _ggef .BuSzPts ==nil {_ggef .BuSzPts =_fadc .BuSzPts ;};if _ggef .BuFontTx ==nil {_ggef .BuFontTx =_fadc .BuFontTx ;};if _ggef .BuFont ==nil {_ggef .BuFont =_fadc .BuFont ;};if _ggef .BuNone ==nil {_ggef .BuNone =_fadc .BuNone ;};if _ggef .BuAutoNum ==nil {_ggef .BuAutoNum =_fadc .BuAutoNum ;};if _ggef .BuChar ==nil {_ggef .BuChar =_fadc .BuChar ;};if _ggef .BuBlip ==nil {_ggef .BuBlip =_fadc .BuBlip ;};if _ggef .TabLst ==nil {_ggef .TabLst =_fadc .TabLst ;};if _ggef .ExtLst ==nil {_ggef .ExtLst =_fadc .ExtLst ;};_ggef .DefRPr =_febe (_ggef .DefRPr ,_fadc .DefRPr );return _ggef ;};

// ConvertToPdf converts a presentation to a PDF file. This package is beta, breaking changes can take place.
func ConvertToPdf (pr *_d .Presentation )*_cd .Creator {_ad :=pr .X ().SldSz ;_eda :=_bc .FromEMU (int64 (_ad .CxAttr ));_gf :=_bc .FromEMU (int64 (_ad .CyAttr ));_ec :=_cd .PageSize {_eda ,_gf };_edac :=_cd .New ();_edac .SetPageSize (_ec );var _ged *_a .Theme ;if len (pr .Themes ())> 0{_ged =pr .Themes ()[0];};for _ ,_ga :=range pr .Slides (){if _ga .X ()==nil {continue ;};_ce :=&convertContext {_cbb :_edac ,_bfda :&_ga ,_gbd :_ga .GetSlideLayout (),_daf :pr .SlideMasters ()[0].X (),_ggaa :pr ,_feec :_ged ,_cbbb :_ga .X ().ClrMapOvr ,_abg :_ec [1],_cae :_ec [0]};_ce ._gbd =_ga .GetSlideLayout ();_ce .extractDefaultProperties ();_ce .makeSlide ();_ce .drawSlide ();};return _edac ;};func _fdbf (_adge *_a .CT_TextCharacterProperties ,_fgdg *_a .CT_TableStyleTextStyle )*_a .CT_TextCharacterProperties {_fgfdcd :=_a .NewCT_TextCharacterProperties ();if _adge !=nil {*_fgfdcd =*_adge ;};if _fgdg ==nil {return _fgfdcd ;};if _fgfdcd .BAttr ==nil &&_fgdg .BAttr !=_a .ST_OnOffStyleTypeUnset {_eage :=_fgdg .BAttr ==_a .ST_OnOffStyleTypeOn ;_fgfdcd .BAttr =&_eage ;};if _fgfdcd .IAttr ==nil &&_fgdg .IAttr !=_a .ST_OnOffStyleTypeUnset {_aaccg :=_fgdg .IAttr ==_a .ST_OnOffStyleTypeOn ;_fgfdcd .IAttr =&_aaccg ;};if _fgfdcd .NoFill ==nil &&_fgfdcd .SolidFill ==nil {_fgfdcd .SolidFill =_a .NewCT_SolidColorFillProperties ();_fgfdcd .SolidFill .ScrgbClr =_fgdg .ScrgbClr ;_fgfdcd .SolidFill .SrgbClr =_fgdg .SrgbClr ;_fgfdcd .SolidFill .HslClr =_fgdg .HslClr ;_fgfdcd .SolidFill .SysClr =_fgdg .SysClr ;_fgfdcd .SolidFill .SchemeClr =_fgdg .SchemeClr ;_fgfdcd .SolidFill .PrstClr =_fgdg .PrstClr ;};if _gcga :=_fgdg .Font ;_gcga !=nil &&_fgfdcd .Latin ==nil &&_fgfdcd .Ea ==nil &&_fgfdcd .Cs ==nil {_fgfdcd .Latin =_gcga .Latin ;_fgfdcd .Ea =_gcga .Ea ;_fgfdcd .Cs =_gcga .Cs ;};return _fgfdcd ;};func _aag (_bbbe int ,_fde bool )string {_fgea :=_ea .NewBuffer ([]byte {});for _ ,_cde :=range _eggc {for {if _bbbe < _cde ._cgce {break ;};_fgea .WriteString (_cde ._cccb );_bbbe -=_cde ._cgce ;};};_feeb :=_fgea .String ();if _fde {_feeb =_g .ToUpper (_feeb );};return _feeb ;};func (_dgab *textboxContext )newParagraph (){_agb :=&paragraph {};_agb ._ccf =_dgab ._ebeb ;_dgab ._gefd =_agb ;};func _abfg (_abcf ,_fbeff *_a .CT_TablePartStyle )*_a .CT_TablePartStyle {_caeb :=_a .NewCT_TablePartStyle ();if _abcf !=nil {*_caeb =*_abcf ;};if _fbeff ==nil {return _caeb ;};if _caeb .TcTxStyle ==nil {_caeb .TcTxStyle =_fbeff .TcTxStyle ;}else {_caeb .TcTxStyle =_bage (_caeb .TcTxStyle ,_fbeff .TcTxStyle );};if _caeb .TcStyle ==nil {_caeb .TcStyle =_fbeff .TcStyle ;}else {_caeb .TcStyle =_dffa (_caeb .TcStyle ,_fbeff .TcStyle );};return _caeb ;};func (_dcgb *convertContext )getColorFromMatrixReference (_cdbc *_a .CT_StyleMatrixReference )_cd .Color {if _cdbc ==nil {return nil ;};var _bab _cd .Color ;var _gefdg string ;if _dede :=_cdbc .SrgbClr ;_dede !=nil {_gefdg =_dede .ValAttr ;}else if _cfaa :=_cdbc .SchemeClr ;_cfaa !=nil {_gefdg =_eea .GetColorStringFromDmlColor (_dcgb ._ggaa .GetColorBySchemeColor (_cfaa .ValAttr ));_gefdg =_eea .AdjustColor (_gefdg ,_cfaa .EG_ColorTransform );};if _gefdg !=""{_bab =_cd .ColorRGBFromHex ("\u0023"+_gefdg );};return _bab ;};type convertContext struct{_cbb *_cd .Creator ;_cef *_eea .Rectangle ;_ggaa *_d .Presentation ;_bfda *_d .Slide ;_daf *_dg .SldMaster ;_gbd *_dg .SldLayout ;_abg float64 ;_cae float64 ;_bbe []_cd .Drawable ;_dbc *background ;_bfc *_a .CT_TextParagraphProperties ;_ded *_a .CT_TextCharacterProperties ;_dae *_a .CT_TextParagraphProperties ;_afaa *_a .CT_TextCharacterProperties ;_bfdbf *_a .CT_TextParagraphProperties ;_fbb *_a .CT_TextCharacterProperties ;_fddf []*_a .CT_TextParagraphProperties ;_ebcd []*_a .CT_TextParagraphProperties ;_bfb []*_a .CT_TextParagraphProperties ;_feec *_a .Theme ;_cbbb *_a .CT_ColorMappingOverride ;};func (_ced *convertContext )addCellToTable (_daab *_cd .Table ,_cac *_a .CT_TableCell ,_fab *_a .CT_TablePartStyle ,_fce float64 ,_bbgb ,_aacb ,_cgfga ,_eeee bool )float64 {var _cbd *_cd .TableCell ;_fega :=1;if _cac .GridSpanAttr !=nil {_fega =int (*_cac .GridSpanAttr );};_cbd =_daab .MultiColCell (_fega );_bgca :=_cac .TcPr ;var _gada *_a .CT_TableStyleTextStyle ;if _fab !=nil {_bgca =_ebcg (_bgca ,_fab .TcStyle ,_bbgb ,_aacb ,_cgfga ,_eeee );_gada =_fab .TcTxStyle ;};_baf :=_cdc ;_egef :=_cd .CellVerticalAlignmentMiddle ;if _bgca !=nil {if _gga :=_bgca .LnL ;_gga !=nil {_eeca ,_adg ,_gbac :=_ced .getBorderStyle (_gga );_cbd .SetBorder (_cd .CellBorderSideLeft ,_eeca ,_gbac );if _adg !=nil &&*_adg !=nil {_cbd .SetSideBorderColor (_cd .CellBorderSideLeft ,*_adg );};};if _bfa :=_bgca .LnT ;_bfa !=nil {_fef ,_cgc ,_eddg :=_ced .getBorderStyle (_bfa );_cbd .SetBorder (_cd .CellBorderSideTop ,_fef ,_eddg );if _cgc !=nil &&*_cgc !=nil {_cbd .SetSideBorderColor (_cd .CellBorderSideTop ,*_cgc );};};if _ddag :=_bgca .LnR ;_ddag !=nil {_affg ,_gdc ,_bca :=_ced .getBorderStyle (_ddag );_cbd .SetBorder (_cd .CellBorderSideRight ,_affg ,_bca );if _gdc !=nil &&*_gdc !=nil {_cbd .SetSideBorderColor (_cd .CellBorderSideRight ,*_gdc );};};if _aaed :=_bgca .LnB ;_aaed !=nil {_afb ,_eagd ,_abc :=_ced .getBorderStyle (_aaed );_cbd .SetBorder (_cd .CellBorderSideBottom ,_afb ,_abc );if _eagd !=nil &&*_eagd !=nil {_cbd .SetSideBorderColor (_cd .CellBorderSideBottom ,*_eagd );};};if _acgc :=_bgca .MarLAttr ;_acgc !=nil {_baf =float64 (_eea .FromSTCoordinate32 (*_acgc ));};switch _bgca .AnchorAttr {case _a .ST_TextAnchoringTypeT :_egef =_cd .CellVerticalAlignmentTop ;case _a .ST_TextAnchoringTypeB :_egef =_cd .CellVerticalAlignmentBottom ;};if _bgca .NoFill ==nil {if _cea :=_bgca .SolidFill ;_cea !=nil {_cece ,_ :=_ced .getColorFromSolidFill (_cea );_cbd .SetBackgroundColor (_cece );};};};_cbd .SetVerticalAlignment (_egef );_cbd .SetIndent (_baf );var _aba float64 ;if _bed :=_cac .TxBody ;_bed !=nil {_dced :=_ced .makePdfDivisionFromTxBody (_bed ,_fce ,_aba ,_gada );_aba =_dced .Height ();_cbd .SetContent (_dced );};return _aba ;};func (_acgce *textboxContext )adjustHeights (_edbe float64 ){if _acgce ._gbb ._cgcf < _edbe {_acgce ._gefd ._ffa +=(_edbe -_acgce ._gbb ._cgcf );_acgce ._gbb ._cgcf =_edbe ;};};

// RegisterFontsFromDirectory registers all fonts from the given directory automatically detecting font families and styles.
func RegisterFontsFromDirectory (dirName string )error {return _eea .RegisterFontsFromDirectory (dirName );};func (_egeg *convertContext )getBorderStyle (_fabg *_a .CT_LineProperties )(_cd .CellBorderStyle ,*_cd .Color ,float64 ){if _fabg ==nil ||_fabg .NoFill !=nil {return _cd .CellBorderStyleNone ,nil ,0;};var _aabc _cd .Color ;if _ecba :=_fabg .SolidFill ;_ecba !=nil {_aabc ,_ =_egeg .getColorFromSolidFill (_ecba );};_aaeb :=0.0;if _bdc :=_fabg .WAttr ;_bdc !=nil {_aaeb =_bc .FromEMU (int64 (*_bdc ));};return _cd .CellBorderStyleSingle ,&_aabc ,_aaeb ;};func (_cacb *textboxContext )addCurrentParagraph (){_cacb ._ebeb =_cacb ._gefd ._ccf +_cacb ._gefd ._abge +_cacb ._gefd ._ffa +_cacb ._gefd ._ccbf ;_cacb ._ddfe =append (_cacb ._ddfe ,_cacb ._gefd );_cacb .alignParagraph ();};func (_adaa *convertContext )getShapesFromSpPr (_aea *_a .CT_ShapeProperties ,_fead *_a .CT_ShapeStyle ,_ace bool )([]_cd .Drawable ,float64 ,float64 ,float64 ,float64 ,_cd .Color ,bool ){_bgge :=[]_cd .Drawable {};var _befg ,_dagb ,_fec ,_bff ,_aebb float64 ;var _ecae ,_gege ,_ggff ,_cfb _cd .Color ;var _ddf *_a .CT_BlipFillProperties ;_cdf ,_ebef :=1.0,1.0;if _fead !=nil {_ecae ,_gege ,_cfb =_adaa .getStyleColors (_fead );};if _dgad :=_aea .Ln ;_dgad !=nil {if _dgad .NoFill !=nil {_ggff ,_aebb =nil ,0;}else {_ggff ,_aebb ,_cdf =_adaa .getInfoFromLn (_dgad );if _ggff ==nil {_ggff =_cfb ;};};};if _aea .NoFill !=nil {_gege ,_ebef =nil ,0;}else if _ace {_gege =_adaa ._dbc ._dbfg ;_ebef =_adaa ._dbc ._ebg ;_ddf =_adaa ._dbc ._fged ;}else if _adc :=_aea .SolidFill ;_adc !=nil {_gege ,_ebef =_adaa .getColorFromSolidFill (_adc );};var _fdf bool ;if _bgd :=_aea .Xfrm ;_bgd !=nil {_befg ,_dagb ,_fec ,_bff =_eea .GetDataFromXfrm (_bgd );_fdf =true ;};if _eab :=_aea .CustGeom ;_eab !=nil {_ggbg :=[]_bf .Point {};_dead ,_bbg :=1.0,1.0;if _ecd :=_eab .PathLst ;_ecd !=nil {for _ ,_eddc :=range _ecd .Path {if _eddc !=nil {if _fgc :=_eddc .WAttr ;_fgc !=nil {_dead =_fec /_bc .FromEMU (*_fgc );};if _eecb :=_eddc .HAttr ;_eecb !=nil {_bbg =_bff /_bc .FromEMU (*_eecb );};for _ ,_ebc :=range _eddc .Close {if _ebc !=nil {};};for _ ,_befb :=range _eddc .MoveTo {if _befb !=nil &&_befb .Pt !=nil {_gef ,_gca :=_agcf (_befb .Pt );_ggbg =append (_ggbg ,_bf .Point {X :_gef *_dead +_befg ,Y :_gca *_bbg +_dagb });};};for _ ,_fgg :=range _eddc .LnTo {if _fgg !=nil &&_fgg .Pt !=nil {_ggd ,_cgg :=_agcf (_fgg .Pt );_ggbg =append (_ggbg ,_bf .Point {X :_ggd *_dead +_befg ,Y :_cgg *_bbg +_dagb });};};_cdd :=_adaa ._cbb .NewPolygon ([][]_bf .Point {_ggbg });_cdd .SetFillColor (_gege );_cdd .SetFillOpacity (_ebef );_cdd .SetBorderWidth (_aebb );if _ggff !=nil {_cdd .SetBorderColor (_ggff );_cdd .SetBorderOpacity (_cdf );};_bgge =append (_bgge ,_cdd );};};};};if _ef :=_aea .PrstGeom ;_ef !=nil {switch _ef .PrstAttr {case _a .ST_ShapeTypeRect :if _ddf !=nil {_ecc :=_adaa .getShapeFromBlipFill (_ddf ,_befg ,_dagb ,_fec ,_bff );_bgge =append (_bgge ,_ecc );}else {_ffb :=_adaa ._cbb .NewRectangle (_befg ,_dagb ,_fec ,_bff );_ffb .SetFillColor (_gege );_ffb .SetFillOpacity (_ebef );_ffb .SetBorderWidth (_aebb );if _ggff !=nil {_ffb .SetBorderColor (_ggff );_ffb .SetBorderOpacity (_cdf );};_bgge =append (_bgge ,_ffb );};case _a .ST_ShapeTypeLine :_dbdg :=_adaa ._cbb .NewLine (_befg ,_dagb ,_befg +_fec ,_dagb +_bff );_dbdg .SetLineWidth (_aebb );if _ggff !=nil {_dbdg .SetColor (_ggff );};_bgge =append (_bgge ,_dbdg );};};return _bgge ,_befg ,_dagb ,_fec ,_bff ,_ecae ,_fdf ;};func _fbgd (_fdcb float64 )float64 {return _fdcb *_bc .Millimeter };type romanMatch struct{_cgce int ;_cccb string ;};func _dffa (_gegdc ,_cegce *_a .CT_TableStyleCellStyle )*_a .CT_TableStyleCellStyle {_ccba :=_a .NewCT_TableStyleCellStyle ();if _gegdc !=nil {*_ccba =*_gegdc ;};if _cegce ==nil {return _ccba ;};if _ccba .TcBdr ==nil {_ccba .TcBdr =_cegce .TcBdr ;};if _ccba .Fill ==nil {_ccba .Fill =_cegce .Fill ;};if _ccba .FillRef ==nil {_ccba .FillRef =_cegce .FillRef ;};return _ccba ;};func (_bcc *convertContext )tileImage (_bgg *_cd .Image ,_dgc *_a .CT_TileInfoProperties ,_eee ,_cbcd float64 )*_cd .Image {_fbf ,_ccc :=1.0,1.0;if _df :=_dgc .SxAttr ;_df !=nil {_fbf =_eea .FromSTPercentage (_df );};if _aebe :=_dgc .SyAttr ;_aebe !=nil {_ccc =_eea .FromSTPercentage (_aebe );};_gb :=_eea .MakeTempCreator (_eee ,_cbcd );_bgg .Scale (_fbf ,_ccc );_bgb ,_daa :=_bgg .Width (),_bgg .Height ();var _dfg ,_dag float64 ;if _aff :=_dgc .TxAttr ;_aff !=nil {_dfg =_bc .FromEMU (_eea .FromSTCoordinate (*_aff ));};if _dcg :=_dgc .TyAttr ;_dcg !=nil {_dag =_bc .FromEMU (_eea .FromSTCoordinate (*_dcg ));};if _dfg > 0{_dfg -=_bgb ;};if _dag > 0{_dag -=_daa ;};_fgf :=_bcc ._cae /_bgb +1;_cfeg :=_bcc ._abg /_daa +1;for _bbf :=0.0;_bbf <=_fgf ;_bbf ++{_dad :=_bbf *_bgb ;for _beg :=0.0;_beg <=_cfeg ;_beg ++{_cg :=_beg *_daa ;_bgg .SetPos (_dad +_dfg ,_cg +_dag );_gb .Draw (_bgg );};};_bfd ,_bccg :=_eea .GetPageFromCreator (_gb );if _bccg !=nil {_gd .Log .Debug ("\u0043\u0061\u006e\u006e\u006f\u0074 \u0067\u0065\u0074\u0020\u0069\u006d\u0061\u0067\u0065\u0020\u0066\u0072\u006fm\u0020\u0063\u0072\u0065\u0061\u0074\u006fr\u003a\u0020\u0025\u0073",_bccg );return nil ;};_abe ,_bccg :=_ed .NewImageDevice ().Render (_bfd );if _bccg !=nil {_gd .Log .Debug ("\u0043\u0061\u006eno\u0074\u0020\u0072\u0065\u006e\u0064\u0065\u0072\u0020\u0069\u006d\u0061\u0067\u0065\u003a\u0020\u0025\u0073",_bccg );return nil ;};_gge ,_bccg :=_bcc ._cbb .NewImageFromGoImage (_abe );if _bccg !=nil {_gd .Log .Debug ("\u0043\u0061nn\u006f\u0074\u0020c\u0072\u0065\u0061\u0074e i\u006dag\u0065\u0020\u0066\u0072\u006f\u006d\u0020Go\u0049\u006d\u0061\u0067\u0065\u003a\u0020%\u0073",_bccg );return nil ;};return _gge ;};const (FontStyle_Regular FontStyle =0;FontStyle_Bold FontStyle =1;FontStyle_Italic FontStyle =2;FontStyle_BoldItalic FontStyle =3;);func (_aabcb *convertContext )getPhData (_gfee *_dg .CT_Shape )(*_a .CT_Transform2D ,*_a .CT_TextBodyProperties ,*_a .CT_TextListStyle ,bool ,bool ){_dacba ,_acff :=_ead (_gfee );_bce :=_acff ==nil ;_ffgg ,_gcd ,_gab ,_gafc :=_daff (_aabcb ._daf .CSld ,_dacba ,_acff ,_bce );_befd ,_gbgg ,_ebea ,_ddcb :=_daff (_aabcb ._gbd .CSld ,_dacba ,_acff ,_bce );if _befd ==nil {_befd =_ffgg ;};_fefa ,_ecag :=_cdcb (_gbgg ,_gcd );var _cfbb ,_ffdd bool ;if _ebea ==nil {if _gab !=nil {_cfbb =*_gab ;};}else {_cfbb =*_ebea ;};if _ddcb ==nil {if _gafc !=nil {_ffdd =*_gafc ;};}else {_ffdd =*_ddcb ;};return _befd ,_fefa ,_ecag ,_cfbb ,_ffdd ;};type word struct{_cacd []*symbol ;_eeec float64 ;_bgdc float64 ;_gcgb bool ;};func (_gbgge *convertContext )renderPageWithDrawableToGoImage (_fbefg _cd .Drawable )(_ee .Image ,error ){_gegff :=_eea .MakeTempCreator (_gbgge ._cae ,_gbgge ._abg );_gegff .NewPage ();_gegff .Draw (_fbefg );_cecf ,_edcd :=_eea .GetPageFromCreator (_gegff );if _edcd !=nil {return nil ,_edcd ;};return _ed .NewImageDevice ().Render (_cecf );};func (_gded *textboxContext )alignSymbolsVertically (){for _ ,_gaa :=range _gded ._ddfe {for _ ,_gacb :=range _gaa ._cbcc {_fed :=0.0;for _ ,_bgef :=range _gacb ._egb {for _ ,_fcda :=range _bgef ._cacd {if _fcda ._cddg > _fed {_fed =_fcda ._cddg ;};};};for _ ,_bafd :=range _gacb ._egb {for _ ,_cegc :=range _bafd ._cacd {if _cegc ._egefb < _fed {_cegc ._ccbe =_fed -_cegc ._egefb ;};};};};};};func _ecfa (_cbdf ,_egfd *_a .CT_TextListStyle )*_a .CT_TextListStyle {_gfdb :=_a .NewCT_TextListStyle ();if _cbdf !=nil {*_gfdb =*_cbdf ;};if _egfd ==nil {return _gfdb ;};_gfdb .DefPPr =_eagcb (_gfdb .DefPPr ,_egfd .DefPPr );_gfdb .Lvl1pPr =_eagcb (_gfdb .Lvl1pPr ,_egfd .Lvl1pPr );_gfdb .Lvl2pPr =_eagcb (_gfdb .Lvl2pPr ,_egfd .Lvl2pPr );_gfdb .Lvl3pPr =_eagcb (_gfdb .Lvl3pPr ,_egfd .Lvl3pPr );_gfdb .Lvl4pPr =_eagcb (_gfdb .Lvl4pPr ,_egfd .Lvl4pPr );_gfdb .Lvl5pPr =_eagcb (_gfdb .Lvl5pPr ,_egfd .Lvl5pPr );_gfdb .Lvl6pPr =_eagcb (_gfdb .Lvl6pPr ,_egfd .Lvl6pPr );_gfdb .Lvl7pPr =_eagcb (_gfdb .Lvl7pPr ,_egfd .Lvl7pPr );_gfdb .Lvl8pPr =_eagcb (_gfdb .Lvl8pPr ,_egfd .Lvl8pPr );_gfdb .Lvl9pPr =_eagcb (_gfdb .Lvl9pPr ,_egfd .Lvl9pPr );return _gfdb ;};type symbol struct{_gaf string ;_ccea float64 ;_cddg float64 ;_egefb float64 ;_ccbe float64 ;_cgfb float64 ;_eddgb *_cd .TextStyle ;_deac string ;_dgde bool ;_edg bool ;_ffc bool ;};func (_efe *convertContext )makePdfBlockFromTable (_bec *_a .Tbl ,_bgf float64 )*_cd .Table {_edf :=_bec .TblGrid ;if _edf ==nil {return nil ;};_dba :=len (_edf .GridCol );if _dba ==0{return nil ;};_bdgb :=[]float64 {};_aaeg :=0.0;for _ ,_ccd :=range _edf .GridCol {_ebbe :=_bc .FromEMU (_eea .FromSTCoordinate (_ccd .WAttr ));_bdgb =append (_bdgb ,_ebbe );_aaeg +=_ebbe ;};_acb :=[]float64 {};for _gbcc :=0;_gbcc < _dba ;_gbcc ++{_acb =append (_acb ,_bdgb [_gbcc ]/_aaeg );};_afae :=_efe ._cbb .NewTable (_dba );_afae .SetColumnWidths (_acb ...);_dcab :=_bec .TblPr ;var _caf *_a .CT_TableStyle ;if _afgb :=_dcab .Choice ;_afgb !=nil {if _afgb .TableStyle !=nil {_caf =_afgb .TableStyle ;}else if _afgb .TableStyleId !=nil {_caf =_efe ._ggaa .GetTableStyleById (*_afgb .TableStyleId );};};_dgac :=_a .NewCT_TablePartStyle ();_dgac .TcStyle =_a .NewCT_TableStyleCellStyle ();_dgac .TcTxStyle =_a .NewCT_TableStyleTextStyle ();if _caf !=nil {if _caf .WholeTbl !=nil {*_dgac =*_caf .WholeTbl ;};if _caf .TblBg !=nil {if _dgac .TcStyle .Fill ==nil {_dgac .TcStyle .Fill =_caf .TblBg .Fill ;};};};if _dgac .TcStyle .Fill ==nil {_dgac .TcStyle .Fill =_a .NewCT_FillProperties ();_dgac .TcStyle .Fill .NoFill =_dcab .NoFill ;_dgac .TcStyle .Fill .SolidFill =_dcab .SolidFill ;};_dbbb :=len (_bec .Tr );for _acgb ,_fbe :=range _bec .Tr {_gcg :=_acgb ==0;_dda :=_acgb ==_dbbb -1;_fdda :=_acgb %2==0;_fcg :=len (_fbe .Tc );var _aefe *_a .CT_TablePartStyle ;if _gcg {_aefe =_caf .FirstRow ;}else if _fdda {_aefe =_caf .Band2H ;}else {_aefe =_caf .Band1H ;};var _aab float64 ;for _ege ,_fcd :=range _fbe .Tc {_gced :=_ege ==0;_eba :=_ege ==_fcg -1;_dagc :=_ege %2==0;var _deae *_a .CT_TablePartStyle ;if _gced {_deae =_caf .FirstCol ;}else if _dagc {_deae =_caf .Band2V ;}else {_deae =_caf .Band1V ;};_aca :=_abfg (_abfg (_deae ,_aefe ),_dgac );_ddd :=_efe .addCellToTable (_afae ,_fcd ,_aca ,_bgf *_acb [_ege ],_gcg ,_dda ,_gced ,_eba );if _ddd > _aab {_aab =_ddd ;};};_eggd :=_bc .FromEMU (_eea .FromSTCoordinate (_fbe .HAttr ));if _eggd < _aab {_eggd =_aab ;};if _eggd < _fbgd (4){_eggd =_fbgd (4);};_afae .SetRowHeight (_afae .CurRow (),_eggd );};return _afae ;};func (_cdgd *textboxContext )alignParagraphsVertically (_daabd _a .ST_TextAnchoringType ){if _daabd ==_a .ST_TextAnchoringTypeT {return ;};_gbgc :=0.0;for _ ,_gcfa :=range _cdgd ._ddfe {_gbgc +=_gcfa ._abge +_gcfa ._ffa +_gcfa ._ccbf ;};var _fdfe float64 ;switch _daabd {case _a .ST_TextAnchoringTypeCtr :_fdfe =(_cdgd ._dgbe -_gbgc )/2;case _a .ST_TextAnchoringTypeB :_fdfe =_cdgd ._dgbe -_gbgc ;};for _ ,_dfba :=range _cdgd ._ddfe {_dfba ._ccf +=_fdfe ;};};func (_gaga *textboxContext )addTextSymbol (_gdcg *symbol ){_fbg :=_cd .New ();_dgccb :=_fbg .NewStyledParagraph ();_dgccb .SetMargins (0,0,0,0);_cfgb :=_dgccb .Append (_gdcg ._gaf );_baff :=0.0;if _gdcg ._eddgb !=nil {_cfgb .Style =*_gdcg ._eddgb ;if _gdcg ._eddgb .CharSpacing !=0{_baff =_gdcg ._eddgb .CharSpacing ;};};_gdcg ._egefb =_dgccb .Height ();_gdcg ._cddg =_dgccb .Height ()*1.2;if _gdcg ._cddg < _gaga ._gefd ._afeaa {_gdcg ._cddg =_gaga ._gefd ._afeaa ;};if _gdcg ._cgfb ==0{_gdcg ._cgfb =_dgccb .Width ()+_baff ;};if len (_gaga ._cdac ._cacd )> 0{_fadd :=_gaga ._cdac ._cacd [len (_gaga ._cdac ._cacd )-1]._gaf ;if _gaga ._gefd ._gfg ||_eea .IsNoSpaceLanguage (_fadd )||(_fadd =="\u0020")!=(_gdcg ._gaf =="\u0020"){_gaga .addCurrentWordToParagraph ();_gaga .newWord ();};};_gaga ._cdac ._cacd =append (_gaga ._cdac ._cacd ,_gdcg );_gdcg ._ccea =_gaga ._cdac ._bgdc ;_gaga ._cdac ._bgdc +=_gdcg ._cgfb ;if _gdcg ._gaf !="\u0020"{_gaga ._cdac ._gcgb =false ;};};func (_dgfc *convertContext )getStyleColors (_dddg *_a .CT_ShapeStyle )(_cd .Color ,_cd .Color ,_cd .Color ){var _dafa ,_agdb ,_bffd _cd .Color ;if _geaf :=_dddg .LnRef ;_geaf !=nil {_agdb =_dgfc .getColorFromMatrixReference (_geaf );};if _gbf :=_dddg .FillRef ;_gbf !=nil {_bffd =_dgfc .getColorFromMatrixReference (_gbf );};if _edad :=_dddg .FontRef ;_edad !=nil {_dafa =_dgfc .getColorFromFontReference (_edad );};return _dafa ,_bffd ,_agdb ;};func (_abgg *convertContext )applyBlipEffectsOnImg (_cgfa *_cd .Image ,_def ,_cfba float64 ,_gcab []*_a .CT_BlipChoice )*_cd .Image {if len (_gcab )==0{return _cgfa ;};_cgfa .SetPos (_def ,_cfba );_dacd ,_bcae :=_abgg .renderPageWithDrawableToGoImage (_cgfa );if _bcae !=nil {_gd .Log .Debug ("\u0045\u0072\u0072\u006f\u0072\u0020\u0072\u0065\u006e\u0064\u0065\u0072\u0020a\u006e\u0020\u0069\u006d\u0061\u0067e\u0020\u0074\u006f\u0020\u0061\u0020\u0047\u006f\u0020\u0069\u006d\u0061\u0067e\u003a\u0020\u0025\u0073",_bcae );return _cgfa ;};_bcdd ,_bcae :=_abgg .renderCurrentStateToGoImage ();if _bcae !=nil {_gd .Log .Debug ("\u0045\u0072\u0072\u006f\u0072\u0020\u0072\u0065n\u0064\u0065\u0072 t\u0068\u0065\u0020\u0063\u0075\u0072r\u0065\u006e\u0074\u0020\u0073\u0074\u0061\u0074\u0065\u0020\u0074\u006f\u0020\u0061\u0020G\u006f\u0020\u0069\u006d\u0061\u0067\u0065\u003a \u0025\u0073",_bcae );return _cgfa ;};_aaebf :=_dacd .Bounds ();_becb :=_ee .NewRGBA (_aaebf );_abab ,_gdgg :=_cgfa .Width (),_cgfa .Height ();for _ ,_eeac :=range _gcab {for _ ,_cbab :=range _eeac .AlphaModFix {if _dbgc :=_cbab .AmtAttr ;_dbgc !=nil {if _gecf :=_dbgc .ST_PositivePercentageDecimal ;_gecf !=nil {_bcfc :=uint8 (255*(*_gecf )/100000);_ecca :=_ee .NewUniform (_e .Alpha {_bcfc });_f .Draw (_becb ,_aaebf ,_bcdd ,_ee .Point {0,0},_f .Src );_f .DrawMask (_becb ,_aaebf ,_dacd ,_ee .Point {0,0},_ecca ,_ee .Point {0,0},_f .Over );};};};};_fabgc :=_ee .Rect (int (_def ),int (_cfba ),int (_def +_abab )+1,int (_cfba +_gdgg )+1);_gabe :=_eea .CropImageByRect (_becb ,_fabgc );_caca ,_bcae :=_abgg ._cbb .NewImageFromGoImage (_gabe );if _bcae !=nil {_gd .Log .Debug ("\u0045\u0072\u0072\u006f\u0072\u0020\u0061\u006e\u0020\u0069\u006d\u0061\u0067\u0065\u0020t\u006f \u0061\u0020\u0047\u006f\u0020\u0069\u006d\u0061\u0067\u0065\u003a\u0020\u0025\u0073",_bcae );return _cgfa ;};return _caca ;};func (_facbd *convertContext )renderCurrentStateToGoImage ()(_ee .Image ,error ){_gceg :=_eea .MakeTempCreator (_facbd ._cae ,_facbd ._abg );_gceg .NewPage ();for _ ,_gcff :=range _facbd ._bbe {if _gcff !=nil {_gceg .MoveTo (0,0);_gceg .Draw (_gcff );};};_gegf ,_gcdg :=_eea .GetPageFromCreator (_gceg );if _gcdg !=nil {return nil ,_gcdg ;};return _ed .NewImageDevice ().Render (_gegf );};func (_feae *convertContext )getConnectors (_bdb *_dg .CT_Connector )[]_cd .Drawable {_cdcd ,_ ,_ ,_ ,_ ,_ ,_ :=_feae .getShapesFromSpPr (_bdb .SpPr ,_bdb .Style ,false );return _cdcd ;};func _cdcb (_cbcdb ,_dagcc *_a .CT_TextBody )(*_a .CT_TextBodyProperties ,*_a .CT_TextListStyle ){if _cbcdb ==nil &&_dagcc ==nil {return nil ,nil ;};if _cbcdb ==nil {return _dagcc .BodyPr ,_dagcc .LstStyle ;};if _dagcc ==nil {return _cbcdb .BodyPr ,_cbcdb .LstStyle ;};_bbaa ,_geafb :=_cbcdb .BodyPr ,_cbcdb .LstStyle ;_egd ,_edfc :=_dagcc .BodyPr ,_dagcc .LstStyle ;_cdea :=_dbg (_bbaa ,_egd );_fafe :=_ecfa (_geafb ,_edfc );return _cdea ,_fafe ;};func _bage (_bbcg ,_fdce *_a .CT_TableStyleTextStyle )*_a .CT_TableStyleTextStyle {_aadc :=_a .NewCT_TableStyleTextStyle ();if _bbcg !=nil {*_aadc =*_bbcg ;};if _fdce ==nil {return _aadc ;};if _aadc .BAttr ==_a .ST_OnOffStyleTypeUnset {_aadc .BAttr =_fdce .BAttr ;};if _aadc .IAttr ==_a .ST_OnOffStyleTypeUnset {_aadc .IAttr =_fdce .IAttr ;};if _aadc .Font ==nil {_aadc .Font =_fdce .Font ;};if _aadc .FontRef ==nil {_aadc .FontRef =_fdce .FontRef ;};if _aadc .ScrgbClr ==nil {_aadc .ScrgbClr =_fdce .ScrgbClr ;};if _aadc .SrgbClr ==nil {_aadc .SrgbClr =_fdce .SrgbClr ;};if _aadc .HslClr ==nil {_aadc .HslClr =_fdce .HslClr ;};if _aadc .SysClr ==nil {_aadc .SysClr =_fdce .SysClr ;};if _aadc .SchemeClr ==nil {_aadc .SchemeClr =_fdce .SchemeClr ;};if _aadc .PrstClr ==nil {_aadc .PrstClr =_fdce .PrstClr ;};return _aadc ;};func (_gfa *convertContext )makePdfImageFromBlipFill (_fbgdb *_a .CT_BlipFillProperties )(*_cd .Image ,[]*_a .CT_BlipChoice ,error ){if _fbgde :=_fbgdb .Blip ;_fbgde !=nil {if _aace :=_fbgde .EmbedAttr ;_aace !=nil {_adab ,_afdc :=_gfa ._bfda .GetImageByRelID (*_aace );if _afdc {_fbbd ,_dgeg :=_cf .Open (_adab .Path ());if _dgeg !=nil {_gd .Log .Debug ("\u0046\u0069\u006c\u0065 o\u0070\u0065\u006e\u0020\u0065\u0072\u0072\u006f\u0072\u003a\u0020\u0025\u0073",_dgeg );return nil ,nil ,_dgeg ;};defer _fbbd .Close ();_abcg ,_ ,_dgeg :=_ee .Decode (_fbbd );if _dgeg !=nil {_gd .Log .Debug ("\u0044\u0065\u0063\u006fde\u0020\u0069\u006d\u0061\u0067\u0065\u0020\u0065\u0072\u0072\u006f\u0072\u003a\u0020%\u0073",_dgeg );return nil ,nil ,_dgeg ;};if _beff :=_fbgdb .SrcRect ;_beff !=nil {_fabc :=_abcg .Bounds ().Size ();_cedf :=_fabc .X ;_cggg :=_fabc .Y ;var _cdbd ,_eeeec ,_bfg ,_egag int ;var _cccg bool ;if _cebe :=_beff .LAttr ;_cebe !=nil {_cdbd =int (float64 (_cedf )*_eea .FromSTPercentage (_cebe ));_cccg =true ;}else {_cdbd =0;};if _bagd :=_beff .TAttr ;_bagd !=nil {_bfg =int (float64 (_cggg )*_eea .FromSTPercentage (_bagd ));_cccg =true ;}else {_bfg =0;};if _dbeg :=_beff .RAttr ;_dbeg !=nil {_eeeec =int (float64 (_cedf )*(1-_eea .FromSTPercentage (_dbeg )));_cccg =true ;}else {_eeeec =_cedf ;};if _bcag :=_beff .BAttr ;_bcag !=nil {_egag =int (float64 (_cggg )*(1-_eea .FromSTPercentage (_bcag )));_cccg =true ;}else {_egag =_cggg ;};if _cccg {_abcg =_eea .CropImageByRect (_abcg ,_ee .Rect (_cdbd ,_bfg ,_eeeec +1,_egag +1));};};_ddfgg ,_dgeg :=_gfa ._cbb .NewImageFromGoImage (_abcg );if _dgeg !=nil {_gd .Log .Debug ("\u0043\u0061\u006e\u006e\u006ft\u0020\u0063\u0072\u0065\u0061\u0074\u0065\u0020\u0050\u0044\u0046\u0020\u0069m\u0061\u0067\u0065\u0020\u0066\u0072\u006f\u006d\u0020\u0047\u006f\u0020\u0069\u006d\u0061\u0067\u0065\u003a\u0020\u0025\u0073",_dgeg );return nil ,nil ,_dgeg ;};return _ddfgg ,_fbgde .Choice ,nil ;};};};return nil ,nil ,nil ;};func _dbg (_egf ,_fgfdc *_a .CT_TextBodyProperties )*_a .CT_TextBodyProperties {_aedb :=_a .NewCT_TextBodyProperties ();if _egf !=nil {*_aedb =*_egf ;};if _fgfdc ==nil {return _aedb ;};if _aedb .RotAttr ==nil {_aedb .RotAttr =_fgfdc .RotAttr ;};if _aedb .SpcFirstLastParaAttr ==nil {_aedb .SpcFirstLastParaAttr =_fgfdc .SpcFirstLastParaAttr ;};if _aedb .VertOverflowAttr ==_a .ST_TextVertOverflowTypeUnset {_aedb .VertOverflowAttr =_fgfdc .VertOverflowAttr ;};if _aedb .HorzOverflowAttr ==_a .ST_TextHorzOverflowTypeUnset {_aedb .HorzOverflowAttr =_fgfdc .HorzOverflowAttr ;};if _aedb .VertAttr ==_a .ST_TextVerticalTypeUnset {_aedb .VertAttr =_fgfdc .VertAttr ;};if _aedb .WrapAttr ==_a .ST_TextWrappingTypeUnset {_aedb .WrapAttr =_fgfdc .WrapAttr ;};if _aedb .LInsAttr ==nil {_aedb .LInsAttr =_fgfdc .LInsAttr ;};if _aedb .TInsAttr ==nil {_aedb .TInsAttr =_fgfdc .TInsAttr ;};if _aedb .RInsAttr ==nil {_aedb .RInsAttr =_fgfdc .RInsAttr ;};if _aedb .BInsAttr ==nil {_aedb .BInsAttr =_fgfdc .BInsAttr ;};if _aedb .NumColAttr ==nil {_aedb .NumColAttr =_fgfdc .NumColAttr ;};if _aedb .SpcColAttr ==nil {_aedb .SpcColAttr =_fgfdc .SpcColAttr ;};if _aedb .RtlColAttr ==nil {_aedb .RtlColAttr =_fgfdc .RtlColAttr ;};if _aedb .AnchorAttr ==_a .ST_TextAnchoringTypeUnset {_aedb .AnchorAttr =_fgfdc .AnchorAttr ;};if _aedb .AnchorCtrAttr ==nil {_aedb .AnchorCtrAttr =_fgfdc .AnchorCtrAttr ;};if _aedb .ForceAAAttr ==nil {_aedb .ForceAAAttr =_fgfdc .ForceAAAttr ;};if _aedb .UprightAttr ==nil {_aedb .UprightAttr =_fgfdc .UprightAttr ;};if _aedb .CompatLnSpcAttr ==nil {_aedb .CompatLnSpcAttr =_fgfdc .CompatLnSpcAttr ;};if _aedb .PrstTxWarp ==nil {_aedb .PrstTxWarp =_fgfdc .PrstTxWarp ;};if _aedb .NoAutofit ==nil {_aedb .NoAutofit =_fgfdc .NoAutofit ;};if _aedb .NormAutofit ==nil {_aedb .NormAutofit =_fgfdc .NormAutofit ;};if _aedb .SpAutoFit ==nil {_aedb .SpAutoFit =_fgfdc .SpAutoFit ;};if _aedb .Scene3d ==nil {_aedb .Scene3d =_fgfdc .Scene3d ;};if _aedb .Sp3d ==nil {_aedb .Sp3d =_fgfdc .Sp3d ;};if _aedb .FlatTx ==nil {_aedb .FlatTx =_fgfdc .FlatTx ;};if _aedb .ExtLst ==nil {_aedb .ExtLst =_fgfdc .ExtLst ;};return _aedb ;};func (_agbc *convertContext )getShapeFromBlipFill (_acfb *_a .CT_BlipFillProperties ,_gdcd ,_agfa ,_bbgc ,_efb float64 )_cd .Drawable {_dfda ,_eac ,_bcge :=_agbc .makePdfImageFromBlipFill (_acfb );if _bcge !=nil {_gd .Log .Debug ("\u0043\u0061\u006e\u006e\u006f\u0074\u0020\u006d\u0061\u006b\u0065\u0020\u0050D\u0046\u0020\u0069\u006d\u0061\u0067e\u0020\u0066\u0072\u006f\u006d\u0020\u0042\u006c\u0069\u0070\u0046\u0069\u006cl\u003a\u0020\u0025\u0073",_bcge );return nil ;};if _dfda ==nil {return nil ;};if _dacb :=_acfb .Tile ;_dacb !=nil {_dfda =_agbc .tileImage (_dfda ,_acfb .Tile ,_bbgc ,_efb );};if _bbcf :=_acfb .Stretch ;_bbcf !=nil {_dfda ,_gdcd ,_agfa =_agbc .stretchImage (_dfda ,_acfb .Stretch ,_gdcd ,_agfa ,_bbgc ,_efb );};if len (_eac )==0{_dfda .SetPos (_gdcd ,_agfa );return _dfda ;};_dfda =_agbc .applyBlipEffectsOnImg (_dfda ,_gdcd ,_agfa ,_eac );_dfda .SetPos (_gdcd ,_agfa );return _dfda ;};type symbolStyle struct{_agef *string ;_bdcc *float64 ;_abd *string ;_afdd *bool ;_bdd *bool ;_eff *bool ;_abdb *bool ;_afdf *bool ;};

// FontStyle represents a kind of font styling. It can be FontStyle_Regular, FontStyle_Bold, FontStyle_Italic and FontStyle_BoldItalic.
type FontStyle =_eea .FontStyle ;func (_cddf *textboxContext )addCurrentWordToParagraph (){if _cddf ._bfca &&_cddf ._gbb ._adb +_cddf ._cdac ._bgdc > _cddf ._gbb ._ddfg {_cddf .newLine ();};if !_cddf ._cdac ._gcgb ||len (_cddf ._gbb ._egb )> 0{_cddf ._cdac ._eeec =_cddf ._gbb ._adb ;_cddf ._gbb ._egb =append (_cddf ._gbb ._egb ,_cddf ._cdac );_cddf ._gbb ._adb +=_cddf ._cdac ._bgdc ;for _ ,_gfb :=range _cddf ._cdac ._cacd {_cddf .adjustHeights (_gfb ._cddg );};};};func (_bde *textboxContext )newLine (){if _bde ._gefd ==nil {_bde .newParagraph ();};_cagb :=_bde ._gefd ._ffa +_bde ._gefd ._abge ;_bedg :=&line {};_bedg ._eaba =_bde ._gefd ._edaf ;if len (_bde ._gefd ._cbcc )==0{_bedg ._eaba +=_bde ._gefd ._cgeg ;};_bedg ._ddfg =_bde ._gefd ._agfb ;_bedg ._adb =_bedg ._eaba ;_bedg ._ccgf =_cagb ;_bde ._gefd ._cbcc =append (_bde ._gefd ._cbcc ,_bedg );_bde ._gbb =_bedg ;};type paragraph struct{_efd float64 ;_abge float64 ;_ccbf float64 ;_cgeg float64 ;_edaf float64 ;_agfb float64 ;_ccf float64 ;_ffa float64 ;_dac _a .ST_TextAlignType ;_afeaa float64 ;_gfg bool ;_cbcc []*line ;};