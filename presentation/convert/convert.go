//
// Copyright 2020 FoxyUtils ehf. All rights reserved.
//
// This is a commercial product and requires a license to operate.
// A trial license can be obtained at https://unidoc.io
//
// DO NOT EDIT: generated by unitwist Go source code obfuscator.
//
// Use of this source code is governed by the UniDoc End User License Agreement
// terms that can be accessed at https://unidoc.io/eula/

package convert ;import (_g "bytes";_a "errors";_af "github.com/unidoc/unioffice/common";_cf "github.com/unidoc/unioffice/common/logger";_fa "github.com/unidoc/unioffice/common/tempstorage";_f "github.com/unidoc/unioffice/internal/convertutils";_aa "github.com/unidoc/unioffice/measurement";
_be "github.com/unidoc/unioffice/presentation";_gaa "github.com/unidoc/unioffice/schema/soo/dml";_bbb "github.com/unidoc/unioffice/schema/soo/dml/chart";_aac "github.com/unidoc/unioffice/schema/soo/pml";_fb "github.com/unidoc/unipdf/v3/contentstream/draw";
_d "github.com/unidoc/unipdf/v3/core";_bg "github.com/unidoc/unipdf/v3/creator";_gf "github.com/unidoc/unipdf/v3/model";_e "github.com/unidoc/unipdf/v3/render";_bb "image";_bf "image/color";_c "image/draw";_ca "strconv";_ga "strings";);func (_bgc *convertContext )getShapesFromSpPr (_cag *_gaa .CT_ShapeProperties ,_bgge *_gaa .CT_ShapeStyle ,_bcbe bool )([]_bg .Drawable ,float64 ,float64 ,float64 ,float64 ,_bg .Color ,bool ){_dcc :=[]_bg .Drawable {};
var _ffa ,_eag ,_aaa ,_bfb ,_dda float64 ;var _fdag ,_fdd ,_cac ,_age _bg .Color ;var _eba *_gaa .CT_BlipFillProperties ;_eeg ,_ad :=1.0,1.0;if _bgge !=nil {_fdag ,_fdd ,_age =_bgc .getStyleColors (_bgge );};if _fbaa :=_cag .Ln ;_fbaa !=nil {if _fbaa .NoFill !=nil {_cac ,_dda =nil ,0;
}else {_cac ,_dda ,_eeg =_bgc .getInfoFromLn (_fbaa );if _cac ==nil {_cac =_age ;};};};if _cag .NoFill !=nil {_fdd ,_ad =nil ,0;}else if _bcbe {_fdd =_bgc ._eafeg ._aae ;_ad =_bgc ._eafeg ._fada ;_eba =_bgc ._eafeg ._dgac ;}else if _dbbf :=_cag .SolidFill ;
_dbbf !=nil {_fdd ,_ad =_bgc .getColorFromSolidFill (_dbbf );};var _ega bool ;if _dae :=_cag .Xfrm ;_dae !=nil {_ffa ,_eag ,_aaa ,_bfb =_f .GetDataFromXfrm (_dae );_ega =true ;};if _cdcf :=_cag .CustGeom ;_cdcf !=nil {_dbf :=[]_fb .Point {};_ecc ,_bfg :=1.0,1.0;
if _daf :=_cdcf .PathLst ;_daf !=nil {for _ ,_fbd :=range _daf .Path {if _fbd !=nil {if _gbd :=_fbd .WAttr ;_gbd !=nil {_ecc =_aaa /_aa .FromEMU (*_gbd );};if _bfae :=_fbd .HAttr ;_bfae !=nil {_bfg =_bfb /_aa .FromEMU (*_bfae );};for _ ,_fgc :=range _fbd .Close {if _fgc !=nil {};
};for _ ,_egb :=range _fbd .MoveTo {if _egb !=nil &&_egb .Pt !=nil {_bbab ,_eec :=_fcga (_egb .Pt );_dbf =append (_dbf ,_fb .Point {X :_bbab *_ecc +_ffa ,Y :_eec *_bfg +_eag });};};for _ ,_caea :=range _fbd .LnTo {if _caea !=nil &&_caea .Pt !=nil {_fae ,_dca :=_fcga (_caea .Pt );
_dbf =append (_dbf ,_fb .Point {X :_fae *_ecc +_ffa ,Y :_dca *_bfg +_eag });};};_cggd :=_bgc ._dga .NewPolygon ([][]_fb .Point {_dbf });_cggd .SetFillColor (_fdd );_cggd .SetFillOpacity (_ad );_cggd .SetBorderWidth (_dda );if _cac !=nil {_cggd .SetBorderColor (_cac );
_cggd .SetBorderOpacity (_eeg );};_dcc =append (_dcc ,_cggd );};};};};if _gae :=_cag .PrstGeom ;_gae !=nil {switch _gae .PrstAttr {case _gaa .ST_ShapeTypeRect :if _eba !=nil {_fbeb :=_bgc .getShapeFromBlipFill (_eba ,_ffa ,_eag ,_aaa ,_bfb ,false );_dcc =append (_dcc ,_fbeb );
}else {_gcbc :=_bgc ._dga .NewRectangle (_ffa ,_eag ,_aaa ,_bfb );_edf :=_fdd !=nil &&_ad > 0;if _edf {_gcbc .SetFillColor (_fdd );_gcbc .SetFillOpacity (_ad );};_aeac :=_cac !=nil &&_eeg > 0&&_dda > 0;if _aeac {_gcbc .SetBorderWidth (_dda );_gcbc .SetBorderColor (_cac );
_gcbc .SetBorderOpacity (_eeg );};if _edf ||_aeac {_dcc =append (_dcc ,_gcbc );};};case _gaa .ST_ShapeTypeLine :_bbed :=_bgc ._dga .NewLine (_ffa ,_eag ,_ffa +_aaa ,_eag +_bfb );_bbed .SetLineWidth (_dda );if _cac !=nil {_bbed .SetColor (_cac );};_dcc =append (_dcc ,_bbed );
};};return _dcc ,_ffa ,_eag ,_aaa ,_bfb ,_fdag ,_ega ;};func (_eaef *textboxContext )newLine (){if _eaef ._fff ==nil {_eaef .newParagraph ();};_fcd :=_eaef ._fff ._edbc +_eaef ._fff ._afcg ;_badf :=&line {};_badf ._cdgf =_eaef ._fff ._dgde ;if len (_eaef ._fff ._gdf )==0{_badf ._cdgf +=_eaef ._fff ._ecgd ;
};_badf ._adgf =_eaef ._fff ._dgdf ;_badf ._eab =_badf ._cdgf ;_badf ._affd =_fcd ;_eaef ._fff ._gdf =append (_eaef ._fff ._gdf ,_badf );_eaef ._dfg =_badf ;};func (_fdgb *textboxContext )assignPropsToCurrentParagraph (_bcce *_gaa .CT_TextParagraphProperties ){_gafdf :=12.4;
if _bcce ==nil {_fdgb ._fff ._eecg =_gafdf ;return ;};if _cbb :=_bcce .DefRPr ;_cbb !=nil {_gee :=_cbb .SzAttr ;if _gee !=nil {_bdf :=float64 (*_gee )/1200;if _gafdf <=_bdf {_gafdf =_bdf ;};};};if _baeb :=_bcce .MarLAttr ;_baeb !=nil {_fdgb ._fff ._dgde =_aa .FromEMU (int64 (*_baeb ));
};_fdgb ._fff ._dgdf =_fdgb ._deae ;if _afad :=_bcce .MarRAttr ;_afad !=nil {_fdgb ._fff ._dgdf -=_aa .FromEMU (int64 (*_afad ));};if _cdee :=_bcce .IndentAttr ;_cdee !=nil {_fdgb ._fff ._ecgd =_aa .FromEMU (int64 (*_cdee ));};if _dcd :=_bcce .LatinLnBrkAttr ;
_dcd !=nil {_fdgb ._fff ._cbe =*_dcd ;};if _ccec :=_bcce .LnSpc ;_ccec !=nil {if _abdc :=_ccec .SpcPct ;_abdc !=nil {if _cgae :=_abdc .ValAttr .ST_TextSpacingPercent ;_cgae !=nil {_gafdf =float64 (*_cgae )/5000;};};};var _gfee float64 ;if _feee :=_bcce .SpcBef ;
_feee !=nil {if _eafb :=_feee .SpcPts ;_eafb !=nil {_gfee =float64 (_eafb .ValAttr )/100;};};_eddg :=_fdgb ._gbdbg ;if len (_eddg )> 0{_gfee -=_eddg [len (_eddg )-1]._dddc ;if _gfee < 0{_gfee =0;};};_fdgb ._fff ._afcg =_gfee ;if _gcba :=_bcce .SpcAft ;
_gcba !=nil {if _feec :=_gcba .SpcPts ;_feec !=nil {_fdgb ._fff ._dddc =float64 (_feec .ValAttr )/100;};};_fdgb ._fff ._eecg =_gafdf ;_fdgb ._fff ._faeb =_bcce .AlgnAttr ;};const (FontStyle_Regular FontStyle =0;FontStyle_Bold FontStyle =1;FontStyle_Italic FontStyle =2;
FontStyle_BoldItalic FontStyle =3;);

// ConvertToPdf converts a presentation to a PDF file. This package is beta, breaking changes can take place.
func ConvertToPdf (pr *_be .Presentation )*_bg .Creator {_dd :=pr .X ().SldSz ;_fg :=_aa .FromEMU (int64 (_dd .CxAttr ));_ff :=_aa .FromEMU (int64 (_dd .CyAttr ));_fd :=_bg .PageSize {_fg ,_ff };_ec :=_bg .New ();_ec .SetPageSize (_fd );var _eb *_gaa .Theme ;
if len (pr .Themes ())> 0{_eb =pr .Themes ()[0];};for _ ,_dg :=range pr .Slides (){if _dg .X ()==nil {continue ;};_bfa :=&convertContext {_dga :_ec ,_bbfb :&_dg ,_adac :_dg .GetSlideLayout (),_dcfb :pr .SlideMasters ()[0].X (),_dbbg :pr ,_gbdf :_eb ,_adc :_dg .X ().ClrMapOvr ,_daa :_fd [1],_agdec :_fd [0]};
_bfa .extractDefaultProperties ();_bfa .makeSlide ();_bfa .drawSlide ();};return _ec ;};func _gdb (_aec ,_cggdg *_gaa .CT_TableStyleTextStyle )*_gaa .CT_TableStyleTextStyle {_bagf :=_gaa .NewCT_TableStyleTextStyle ();if _aec !=nil {*_bagf =*_aec ;};if _cggdg ==nil {return _bagf ;
};if _bagf .BAttr ==_gaa .ST_OnOffStyleTypeUnset {_bagf .BAttr =_cggdg .BAttr ;};if _bagf .IAttr ==_gaa .ST_OnOffStyleTypeUnset {_bagf .IAttr =_cggdg .IAttr ;};if _bagf .Font ==nil {_bagf .Font =_cggdg .Font ;};if _bagf .FontRef ==nil {_bagf .FontRef =_cggdg .FontRef ;
};if _bagf .ScrgbClr ==nil {_bagf .ScrgbClr =_cggdg .ScrgbClr ;};if _bagf .SrgbClr ==nil {_bagf .SrgbClr =_cggdg .SrgbClr ;};if _bagf .HslClr ==nil {_bagf .HslClr =_cggdg .HslClr ;};if _bagf .SysClr ==nil {_bagf .SysClr =_cggdg .SysClr ;};if _bagf .SchemeClr ==nil {_bagf .SchemeClr =_cggdg .SchemeClr ;
};if _bagf .PrstClr ==nil {_bagf .PrstClr =_cggdg .PrstClr ;};return _bagf ;};func _agea (_eecb *_aac .CT_Shape )(_aac .ST_PlaceholderType ,*uint32 ){if _bga :=_eecb .NvSpPr ;_bga !=nil {if _fgcd :=_bga .NvPr ;_fgcd !=nil {if _ccbf :=_fgcd .Ph ;_ccbf !=nil {return _ccbf .TypeAttr ,_ccbf .IdxAttr ;
};};};return _aac .ST_PlaceholderTypeUnset ,nil ;};func (_fde *convertContext )makeSlide (){_ecg :=_fde ._bbfb .GetSlideLayout ().CSld ;if _ecg !=nil {if _fbg :=_ecg .SpTree ;_fbg !=nil {for _ ,_aad :=range _fbg .Choice {if _aad !=nil {for _ ,_cfa :=range _aad .Pic {if _cfa !=nil {var _cb ,_gag ,_bbc ,_df float64 ;
if _bcc :=_cfa .SpPr ;_bcc !=nil {if _dff :=_bcc .Xfrm ;_dff !=nil {_cb ,_gag ,_bbc ,_df =_f .GetDataFromXfrm (_dff );};};if _eeb :=_cfa .BlipFill ;_eeb !=nil {_fed :=_fde .getShapeFromBlipFill (_eeb ,_cb ,_gag ,_bbc ,_df ,true );_fde ._abgg =append (_fde ._abgg ,_fed );
};};};};};};};_ecg =_fde ._bbfb .X ().CSld ;if _ecg ==nil {return ;};_ge :=&background {};if _ae :=_ecg .Bg ;_ae !=nil {if _bgb :=_ae .BgPr ;_bgb !=nil {if _bgb .NoFill ==nil {if _eea :=_bgb .SolidFill ;_eea !=nil {_ged ,_ab :=_fde .getColorFromSolidFill (_eea );
if _ged !=nil {_ge ._aae =_ged ;_ge ._fada =_ab ;};}else if _fdc :=_bgb .BlipFill ;_fdc !=nil {_ge ._dgac =_fdc ;};};};};_fde ._eafeg =_ge ;if _gd :=_ecg .SpTree ;_gd !=nil {for _ ,_aadg :=range _gd .Choice {if _aadg !=nil {for _ ,_bag :=range _aadg .Sp {if _bag !=nil {_aab :=_fde .getShapes (_bag );
_fde ._abgg =append (_fde ._abgg ,_aab ...);};};for _ ,_abg :=range _aadg .GraphicFrame {if _abg !=nil {var _dbb ,_ac ,_bbe ,_cedf float64 ;if _ceb :=_abg .Xfrm ;_ceb !=nil {_dbb ,_ac ,_bbe ,_cedf =_f .GetDataFromXfrm (_ceb );};if _bbe ==0&&_cedf ==0{_bbe =_fde ._agdec ;
_cedf =_fde ._daa ;};if _da :=_abg .Graphic ;_da !=nil {if _bbg :=_da .GraphicData ;_bbg !=nil {for _ ,_fda :=range _bbg .Any {if _gac ,_afeg :=_fda .(*_bbb .Chart );_afeg {_fc ,_fbe :=_fde .makePdfBlockFromChart (_gac ,_bbe ,_cedf );if _fbe !=nil {_cf .Log .Debug ("C\u0061\u006e\u006e\u006ft \u0072e\u0061\u0064\u0020\u0062\u006co\u0063\u006b\u003a\u0020\u0025\u0073",_fbe );
};if _fc !=nil {_fc .SetPos (_dbb ,_ac );_fde ._abgg =append (_fde ._abgg ,_fc );};}else if _feb ,_aed :=_fda .(*_gaa .Tbl );_aed {_fea :=_fde .makePdfBlockFromTable (_feb ,_bbe );if _fea !=nil {_cc :=_bg .NewBlock (_bbe ,_cedf );_cc .SetPos (_dbb ,_ac );
_cc .Draw (_fea );_fde ._abgg =append (_fde ._abgg ,_cc );};};};};};};};for _ ,_ag :=range _aadg .CxnSp {if _ag !=nil {_cca :=_fde .getConnectors (_ag );_fde ._abgg =append (_fde ._abgg ,_cca ...);};};for _ ,_ecf :=range _aadg .Pic {if _ecf !=nil {var _dgd ,_cfd ,_cee ,_cg float64 ;
if _gff :=_ecf .SpPr ;_gff !=nil {if _cbd :=_gff .Xfrm ;_cbd !=nil {_dgd ,_cfd ,_cee ,_cg =_f .GetDataFromXfrm (_cbd );};};if _ffb :=_ecf .BlipFill ;_ffb !=nil {_gc :=_fde .getShapeFromBlipFill (_ffb ,_dgd ,_cfd ,_cee ,_cg ,false );_fde ._abgg =append (_fde ._abgg ,_gc );
};};};};};};};func (_bcf *textboxContext )addCurrentWordToParagraph (){if _bcf ._aadgd &&_bcf ._dfg ._eab +_bcf ._aefe ._dfed > _bcf ._dfg ._adgf {_bcf .newLine ();};if !_bcf ._aefe ._fac ||len (_bcf ._dfg ._cbeg )> 0{_bcf ._aefe ._agac =_bcf ._dfg ._eab ;
_bcf ._dfg ._cbeg =append (_bcf ._dfg ._cbeg ,_bcf ._aefe );_bcf ._dfg ._eab +=_bcf ._aefe ._dfed ;for _ ,_bgca :=range _bcf ._aefe ._ggd {_bcf .adjustHeights (_bgca ._caag );};};};func (_efa *textboxContext )alignVertically (_fedc _gaa .ST_TextAnchoringType ){_efa .alignParagraphsVertically (_fedc );
_efa .alignSymbolsVertically ();};type background struct{_aae _bg .Color ;_fada float64 ;_dgac *_gaa .CT_BlipFillProperties ;};var _faee =[]romanMatch {romanMatch {1000,"\u006d"},romanMatch {900,"\u0063\u006d"},romanMatch {500,"\u0064"},romanMatch {400,"\u0063\u0064"},romanMatch {100,"\u0063"},romanMatch {90,"\u0078\u0063"},romanMatch {50,"\u006c"},romanMatch {40,"\u0078\u006c"},romanMatch {10,"\u0078"},romanMatch {9,"\u0069\u0078"},romanMatch {5,"\u0076"},romanMatch {4,"\u0069\u0076"},romanMatch {1,"\u0069"}};
func (_egbc *textboxContext )adjustHeights (_bbedc float64 ){if _egbc ._dfg ._cegc < _bbedc {_egbc ._fff ._edbc +=(_bbedc -_egbc ._dfg ._cegc );_egbc ._dfg ._cegc =_bbedc ;};};func (_eacf *textboxContext )addTextRun (_dgge *_gaa .EG_TextRun ,_afge *_gaa .CT_TextCharacterProperties ,_fdad _bg .Color ,_afd *prefixData ){if _gaaee :=_dgge .Br ;
_gaaee !=nil {_eacf .addCurrentWordToParagraph ();_eacf .newLine ();_eacf .newWord ();}else if _ccde :=_dgge .R ;_ccde !=nil {var _bda _bg .Color ;if _ccde .RPr !=nil &&_ccde .RPr .SolidFill !=nil {_bda ,_ =_eacf ._dcg .getColorFromSolidFill (_ccde .RPr .SolidFill );
}else if _fdad !=nil {_bda =_fdad ;}else if _afge .SolidFill !=nil {_bda ,_ =_eacf ._dcg .getColorFromSolidFill (_afge .SolidFill );}else {_bda =_bg .ColorBlack ;};_dbae :=_gefb (_ccde .RPr ,_afge );_fbfc ,_caca ,_dcfg ,_ecgg :=_eacf ._dcg .makeStyleFromRPr (_dbae );
_fbfc .Color =_bda ;if _afd !=nil {_eacf .addPrefix (_afd ,_fbfc );};_cfae :=_gca (_ccde .T );for _ ,_eecd :=range _cfae {_eecd ._bfba =_fbfc ;_eecd ._ebac =_caca ;_eecd ._edaa =_dcfg ;_eecd ._eeee =_ecgg ;if _dbae .CapAttr ==_gaa .ST_TextCapsTypeAll {_eecd ._bebd =_ga .ToUpper (_eecd ._bebd );
};_eacf .addTextSymbol (_eecd );};};};type symbol struct{_bebd string ;_gea float64 ;_caag float64 ;_eefe float64 ;_afed float64 ;_gcc float64 ;_bfba *_bg .TextStyle ;_cgf string ;_ebac bool ;_edaa bool ;_eeee bool ;};func _ccae (_ebaf ,_cdgb *_gaa .CT_TextBodyProperties )*_gaa .CT_TextBodyProperties {_ccdb :=_gaa .NewCT_TextBodyProperties ();
if _ebaf !=nil {*_ccdb =*_ebaf ;};if _cdgb ==nil {return _ccdb ;};if _ccdb .RotAttr ==nil {_ccdb .RotAttr =_cdgb .RotAttr ;};if _ccdb .SpcFirstLastParaAttr ==nil {_ccdb .SpcFirstLastParaAttr =_cdgb .SpcFirstLastParaAttr ;};if _ccdb .VertOverflowAttr ==_gaa .ST_TextVertOverflowTypeUnset {_ccdb .VertOverflowAttr =_cdgb .VertOverflowAttr ;
};if _ccdb .HorzOverflowAttr ==_gaa .ST_TextHorzOverflowTypeUnset {_ccdb .HorzOverflowAttr =_cdgb .HorzOverflowAttr ;};if _ccdb .VertAttr ==_gaa .ST_TextVerticalTypeUnset {_ccdb .VertAttr =_cdgb .VertAttr ;};if _ccdb .WrapAttr ==_gaa .ST_TextWrappingTypeUnset {_ccdb .WrapAttr =_cdgb .WrapAttr ;
};if _ccdb .LInsAttr ==nil {_ccdb .LInsAttr =_cdgb .LInsAttr ;};if _ccdb .TInsAttr ==nil {_ccdb .TInsAttr =_cdgb .TInsAttr ;};if _ccdb .RInsAttr ==nil {_ccdb .RInsAttr =_cdgb .RInsAttr ;};if _ccdb .BInsAttr ==nil {_ccdb .BInsAttr =_cdgb .BInsAttr ;};if _ccdb .NumColAttr ==nil {_ccdb .NumColAttr =_cdgb .NumColAttr ;
};if _ccdb .SpcColAttr ==nil {_ccdb .SpcColAttr =_cdgb .SpcColAttr ;};if _ccdb .RtlColAttr ==nil {_ccdb .RtlColAttr =_cdgb .RtlColAttr ;};if _ccdb .AnchorAttr ==_gaa .ST_TextAnchoringTypeUnset {_ccdb .AnchorAttr =_cdgb .AnchorAttr ;};if _ccdb .AnchorCtrAttr ==nil {_ccdb .AnchorCtrAttr =_cdgb .AnchorCtrAttr ;
};if _ccdb .ForceAAAttr ==nil {_ccdb .ForceAAAttr =_cdgb .ForceAAAttr ;};if _ccdb .UprightAttr ==nil {_ccdb .UprightAttr =_cdgb .UprightAttr ;};if _ccdb .CompatLnSpcAttr ==nil {_ccdb .CompatLnSpcAttr =_cdgb .CompatLnSpcAttr ;};if _ccdb .PrstTxWarp ==nil {_ccdb .PrstTxWarp =_cdgb .PrstTxWarp ;
};if _ccdb .NoAutofit ==nil {_ccdb .NoAutofit =_cdgb .NoAutofit ;};if _ccdb .NormAutofit ==nil {_ccdb .NormAutofit =_cdgb .NormAutofit ;};if _ccdb .SpAutoFit ==nil {_ccdb .SpAutoFit =_cdgb .SpAutoFit ;};if _ccdb .Scene3d ==nil {_ccdb .Scene3d =_cdgb .Scene3d ;
};if _ccdb .Sp3d ==nil {_ccdb .Sp3d =_cdgb .Sp3d ;};if _ccdb .FlatTx ==nil {_ccdb .FlatTx =_cdgb .FlatTx ;};if _ccdb .ExtLst ==nil {_ccdb .ExtLst =_cdgb .ExtLst ;};return _ccdb ;};func (_faf *convertContext )stretchImage (_cbf *_bg .Image ,_aacg *_gaa .CT_StretchInfoProperties ,_dgg ,_ebfe ,_cgc ,_ffg float64 )(*_bg .Image ,float64 ,float64 ){_fbc :=_aacg .FillRect ;
if _fbc ==nil {_baad :=_cbf .Width ()/_cbf .Height ();_cda :=_cgc /_ffg ;var _gfe ,_bge float64 ;if _baad > _cda {_bge =_ffg ;_gfe =_ffg *_baad ;}else {_gfe =_cgc ;_bge =_cgc /_baad ;};_cbf .Scale (_gfe /_cbf .Width (),_bge /_cbf .Height ());return _cbf ,_dgg ,_ebfe ;
};var _fcf ,_ebg ,_aee ,_gga float64 ;if _aff :=_fbc .LAttr ;_aff !=nil {_aee =_f .FromSTPercentage (_aff );};if _egd :=_fbc .TAttr ;_egd !=nil {_fcf =_f .FromSTPercentage (_egd );};if _fgg :=_fbc .RAttr ;_fgg !=nil {_gga =_f .FromSTPercentage (_fgg );
};if _bad :=_fbc .BAttr ;_bad !=nil {_ebg =_f .FromSTPercentage (_bad );};_efc :=_cgc *(1-_aee -_gga );_caa :=_ffg *(1-_fcf -_ebg );_cbf .Scale (_efc /_cbf .Width (),_caa /_cbf .Height ());return _cbf ,_dgg +_aee *_cgc ,_ebfe +_fcf *_ffg ;};func (_cab *convertContext )makePdfImageFromBlipFill (_fgdf *_gaa .CT_BlipFillProperties ,_gcd bool )(*_bg .Image ,[]*_gaa .CT_BlipChoice ,error ){if _dcbb :=_fgdf .Blip ;
_dcbb !=nil {if _ccff :=_dcbb .EmbedAttr ;_ccff !=nil {var _ddbee _af .ImageRef ;var _bfbgc bool ;if _gcd {_ddbee ,_bfbgc =_cab ._bbfb .GetLayoutImageByRelID (*_ccff );}else {_ddbee ,_bfbgc =_cab ._bbfb .GetImageByRelID (*_ccff );};if _bfbgc {_bed ,_dec :=_fa .Open (_ddbee .Path ());
if _dec !=nil {_cf .Log .Debug ("\u0046\u0069\u006c\u0065 o\u0070\u0065\u006e\u0020\u0065\u0072\u0072\u006f\u0072\u003a\u0020\u0025\u0073",_dec );return nil ,nil ,_dec ;};defer _bed .Close ();_gacb ,_ ,_dec :=_bb .Decode (_bed );if _dec !=nil {_cf .Log .Debug ("\u0044\u0065\u0063\u006fde\u0020\u0069\u006d\u0061\u0067\u0065\u0020\u0065\u0072\u0072\u006f\u0072\u003a\u0020%\u0073",_dec );
return nil ,nil ,_dec ;};if _dfgd :=_fgdf .SrcRect ;_dfgd !=nil {_bdad :=_gacb .Bounds ().Size ();_egg :=_bdad .X ;_fbbd :=_bdad .Y ;var _fdae ,_efgc ,_cdbc ,_ege int ;var _ceade bool ;if _egea :=_dfgd .LAttr ;_egea !=nil {_fdae =int (float64 (_egg )*_f .FromSTPercentage (_egea ));
_ceade =true ;}else {_fdae =0;};if _dadf :=_dfgd .TAttr ;_dadf !=nil {_cdbc =int (float64 (_fbbd )*_f .FromSTPercentage (_dadf ));_ceade =true ;}else {_cdbc =0;};if _ebcf :=_dfgd .RAttr ;_ebcf !=nil {_efgc =int (float64 (_egg )*(1-_f .FromSTPercentage (_ebcf )));
_ceade =true ;}else {_efgc =_egg ;};if _aeee :=_dfgd .BAttr ;_aeee !=nil {_ege =int (float64 (_fbbd )*(1-_f .FromSTPercentage (_aeee )));_ceade =true ;}else {_ege =_fbbd ;};if _ceade {_gacb =_f .CropImageByRect (_gacb ,_bb .Rect (_fdae ,_cdbc ,_efgc +1,_ege +1));
};};_baf ,_dec :=_cab ._dga .NewImageFromGoImage (_gacb );_baf .SetEncoder (_d .NewFlateEncoder ());if _dec !=nil {_cf .Log .Debug ("\u0043\u0061\u006e\u006e\u006ft\u0020\u0063\u0072\u0065\u0061\u0074\u0065\u0020\u0050\u0044\u0046\u0020\u0069m\u0061\u0067\u0065\u0020\u0066\u0072\u006f\u006d\u0020\u0047\u006f\u0020\u0069\u006d\u0061\u0067\u0065\u003a\u0020\u0025\u0073",_dec );
return nil ,nil ,_dec ;};return _baf ,_dcbb .Choice ,nil ;};};};return nil ,nil ,nil ;};func _baed (_agcd int ,_bea bool )string {_edbb :=_g .NewBuffer ([]byte {});for _ ,_cbdf :=range _faee {for {if _agcd < _cbdf ._ebe {break ;};_edbb .WriteString (_cbdf ._agdb );
_agcd -=_cbdf ._ebe ;};};_fca :=_edbb .String ();if _bea {_fca =_ga .ToUpper (_fca );};return _fca ;};func _gefb (_bgfb ,_ebgd *_gaa .CT_TextCharacterProperties )*_gaa .CT_TextCharacterProperties {_aeba :=_gaa .NewCT_TextCharacterProperties ();if _bgfb !=nil {*_aeba =*_bgfb ;
};if _ebgd ==nil {return _aeba ;};if _aeba .KumimojiAttr ==nil {_aeba .KumimojiAttr =_ebgd .KumimojiAttr ;};if _aeba .LangAttr ==nil {_aeba .LangAttr =_ebgd .LangAttr ;};if _aeba .AltLangAttr ==nil {_aeba .AltLangAttr =_ebgd .AltLangAttr ;};if _aeba .SzAttr ==nil {_aeba .SzAttr =_ebgd .SzAttr ;
};if _aeba .BAttr ==nil {_aeba .BAttr =_ebgd .BAttr ;};if _aeba .IAttr ==nil {_aeba .IAttr =_ebgd .IAttr ;};if _aeba .UAttr ==_gaa .ST_TextUnderlineTypeUnset {_aeba .UAttr =_ebgd .UAttr ;};if _aeba .StrikeAttr ==_gaa .ST_TextStrikeTypeUnset {_aeba .StrikeAttr =_ebgd .StrikeAttr ;
};if _aeba .KernAttr ==nil {_aeba .KernAttr =_ebgd .KernAttr ;};if _aeba .CapAttr ==_gaa .ST_TextCapsTypeUnset {_aeba .CapAttr =_ebgd .CapAttr ;};if _aeba .SpcAttr ==nil {_aeba .SpcAttr =_ebgd .SpcAttr ;};if _aeba .NormalizeHAttr ==nil {_aeba .NormalizeHAttr =_ebgd .NormalizeHAttr ;
};if _aeba .BaselineAttr ==nil {_aeba .BaselineAttr =_ebgd .BaselineAttr ;};if _aeba .NoProofAttr ==nil {_aeba .NoProofAttr =_ebgd .NoProofAttr ;};if _aeba .DirtyAttr ==nil {_aeba .DirtyAttr =_ebgd .DirtyAttr ;};if _aeba .ErrAttr ==nil {_aeba .ErrAttr =_ebgd .ErrAttr ;
};if _aeba .SmtCleanAttr ==nil {_aeba .SmtCleanAttr =_ebgd .SmtCleanAttr ;};if _aeba .SmtIdAttr ==nil {_aeba .SmtIdAttr =_ebgd .SmtIdAttr ;};if _aeba .BmkAttr ==nil {_aeba .BmkAttr =_ebgd .BmkAttr ;};if _aeba .Ln ==nil {_aeba .Ln =_ebgd .Ln ;};if _aeba .NoFill ==nil {_aeba .NoFill =_ebgd .NoFill ;
};if _aeba .SolidFill ==nil {_aeba .SolidFill =_ebgd .SolidFill ;};if _aeba .BlipFill ==nil {_aeba .BlipFill =_ebgd .BlipFill ;};if _aeba .EffectLst ==nil {_aeba .EffectLst =_ebgd .EffectLst ;};if _aeba .EffectDag ==nil {_aeba .EffectDag =_ebgd .EffectDag ;
};if _aeba .Highlight ==nil {_aeba .Highlight =_ebgd .Highlight ;};if _aeba .ULnTx ==nil {_aeba .ULnTx =_ebgd .ULnTx ;};if _aeba .ULn ==nil {_aeba .ULn =_ebgd .ULn ;};if _aeba .UFillTx ==nil {_aeba .UFillTx =_ebgd .UFillTx ;};if _aeba .UFill ==nil {_aeba .UFill =_ebgd .UFill ;
};if _aeba .Latin ==nil {_aeba .Latin =_ebgd .Latin ;};if _aeba .Ea ==nil {_aeba .Ea =_ebgd .Ea ;};if _aeba .Cs ==nil {_aeba .Cs =_ebgd .Cs ;};if _aeba .Sym ==nil {_aeba .Sym =_ebgd .Sym ;};if _aeba .Rtl ==nil {_aeba .Rtl =_ebgd .Rtl ;};return _aeba ;};
func (_agcc *convertContext )renderCurrentStateToGoImage ()(_bb .Image ,error ){_feeca :=_f .MakeTempCreator (_agcc ._agdec ,_agcc ._daa );_feeca .NewPage ();for _ ,_ggee :=range _agcc ._abgg {if _ggee !=nil {_feeca .MoveTo (0,0);_feeca .Draw (_ggee );
};};_cgaf ,_cgggd :=_f .GetPageFromCreator (_feeca );if _cgggd !=nil {return nil ,_cgggd ;};return _e .NewImageDevice ().Render (_cgaf );};type paragraph struct{_cede float64 ;_afcg float64 ;_dddc float64 ;_ecgd float64 ;_dgde float64 ;_dgdf float64 ;_ebde float64 ;
_edbc float64 ;_faeb _gaa .ST_TextAlignType ;_eecg float64 ;_cbe bool ;_gdf []*line ;};func (_ceea *textboxContext )alignSymbolsVertically (){for _ ,_faa :=range _ceea ._gbdbg {for _ ,_ecaab :=range _faa ._gdf {_efga :=0.0;for _ ,_baac :=range _ecaab ._cbeg {for _ ,_bdg :=range _baac ._ggd {if _bdg ._caag > _efga {_efga =_bdg ._caag ;
};};};for _ ,_ecfc :=range _ecaab ._cbeg {for _ ,_eceb :=range _ecfc ._ggd {if _eceb ._eefe < _efga {_eceb ._afed =_efga -_eceb ._eefe ;};};};};};};func (_baag *convertContext )getColorFromMatrixReference (_bebdb *_gaa .CT_StyleMatrixReference )_bg .Color {if _bebdb ==nil {return nil ;
};var _gdgg _bg .Color ;var _eacb string ;if _ebab :=_bebdb .SrgbClr ;_ebab !=nil {_eacb =_ebab .ValAttr ;}else if _efbf :=_bebdb .SchemeClr ;_efbf !=nil {_eacb =_f .GetColorStringFromDmlColor (_baag ._dbbg .GetColorBySchemeColor (_efbf .ValAttr ));_eacb =_f .AdjustColor (_eacb ,_efbf .EG_ColorTransform );
};if _eacb !=""{_gdgg =_bg .ColorRGBFromHex ("\u0023"+_eacb );};return _gdgg ;};type prefixData struct{_gccg string ;_gdgb bool ;_fdda float64 ;_caagb float64 ;};func _cbda (_bbcg *_aac .CT_CommonSlideData ,_fge _aac .ST_PlaceholderType ,_bdd *uint32 ,_faagd bool )(*_gaa .CT_Transform2D ,*_gaa .CT_TextBody ,*bool ,*bool ){if _bbcg !=nil &&(_fge !=_aac .ST_PlaceholderTypeUnset ||!_faagd ){if _ggbg :=_bbcg .SpTree ;
_ggbg !=nil {for _ ,_egef :=range _ggbg .Choice {if _egef !=nil {for _ ,_bded :=range _egef .Sp {if _bded !=nil {_bcff ,_egag :=_agea (_bded );if _fge ==_bcff {if (_faagd &&_egag ==nil )||(!_faagd &&_egag !=nil &&*_egag ==*_bdd ){var _bcbc *_gaa .CT_Transform2D ;
if _bded .SpPr !=nil {_bcbc =_bded .SpPr .Xfrm ;};_fged :=_fge ==_aac .ST_PlaceholderTypeTitle ||_fge ==_aac .ST_PlaceholderTypeCtrTitle ;_dgab :=!_fged &&_fge !=_aac .ST_PlaceholderTypeUnset ;return _bcbc ,_bded .TxBody ,&_fged ,&_dgab ;};};};};};};};
};return nil ,nil ,nil ,nil ;};type convertContext struct{_dga *_bg .Creator ;_bgcd *_f .Rectangle ;_dbbg *_be .Presentation ;_bbfb *_be .Slide ;_dcfb *_aac .SldMaster ;_adac *_aac .SldLayout ;_daa float64 ;_agdec float64 ;_abgg []_bg .Drawable ;_eafeg *background ;
_ecac *_gaa .CT_TextParagraphProperties ;_dfeb *_gaa .CT_TextCharacterProperties ;_dafa *_gaa .CT_TextParagraphProperties ;_ggf *_gaa .CT_TextCharacterProperties ;_fga *_gaa .CT_TextParagraphProperties ;_adb *_gaa .CT_TextCharacterProperties ;_efbg []*_gaa .CT_TextParagraphProperties ;
_gdg []*_gaa .CT_TextParagraphProperties ;_eee []*_gaa .CT_TextParagraphProperties ;_gbdf *_gaa .Theme ;_adc *_gaa .CT_ColorMappingOverride ;};func _ebef (_cgeb float64 )float64 {return _cgeb *_aa .Millimeter };func _fegb (_agbe *_gaa .CT_TextCharacterProperties ,_eagc *_gaa .CT_TableStyleTextStyle )*_gaa .CT_TextCharacterProperties {_adbd :=_gaa .NewCT_TextCharacterProperties ();
if _agbe !=nil {*_adbd =*_agbe ;};if _eagc ==nil {return _adbd ;};if _adbd .BAttr ==nil &&_eagc .BAttr !=_gaa .ST_OnOffStyleTypeUnset {_cccg :=_eagc .BAttr ==_gaa .ST_OnOffStyleTypeOn ;_adbd .BAttr =&_cccg ;};if _adbd .IAttr ==nil &&_eagc .IAttr !=_gaa .ST_OnOffStyleTypeUnset {_dgf :=_eagc .IAttr ==_gaa .ST_OnOffStyleTypeOn ;
_adbd .IAttr =&_dgf ;};if _adbd .NoFill ==nil &&_adbd .SolidFill ==nil {_adbd .SolidFill =_gaa .NewCT_SolidColorFillProperties ();_adbd .SolidFill .ScrgbClr =_eagc .ScrgbClr ;_adbd .SolidFill .SrgbClr =_eagc .SrgbClr ;_adbd .SolidFill .HslClr =_eagc .HslClr ;
_adbd .SolidFill .SysClr =_eagc .SysClr ;_adbd .SolidFill .SchemeClr =_eagc .SchemeClr ;_adbd .SolidFill .PrstClr =_eagc .PrstClr ;};if _aaba :=_eagc .Font ;_aaba !=nil &&_adbd .Latin ==nil &&_adbd .Ea ==nil &&_adbd .Cs ==nil {_adbd .Latin =_aaba .Latin ;
_adbd .Ea =_aaba .Ea ;_adbd .Cs =_aaba .Cs ;};return _adbd ;};func _fcga (_adafa *_gaa .CT_AdjPoint2D )(float64 ,float64 ){var _cgdcd ,_dfde float64 ;_feeb ,_fbb :=_adafa .XAttr ,_adafa .YAttr ;if _ffee :=_feeb .ST_Coordinate ;_ffee !=nil {_cgdcd =_aa .FromEMU (_f .FromSTCoordinate (*_ffee ));
};if _aeb :=_fbb .ST_Coordinate ;_aeb !=nil {_dfde =_aa .FromEMU (_f .FromSTCoordinate (*_aeb ));};return _cgdcd ,_dfde ;};func (_agd *convertContext )getConnectors (_fec *_aac .CT_Connector )[]_bg .Drawable {_ead ,_ ,_ ,_ ,_ ,_ ,_ :=_agd .getShapesFromSpPr (_fec .SpPr ,_fec .Style ,false );
return _ead ;};type romanMatch struct{_ebe int ;_agdb string ;};func _gedd (_bbebd *_gaa .CT_TableCellProperties ,_fcfeg *_gaa .CT_TableStyleCellStyle ,_eeec ,_febc ,_gfc ,_ddag bool )*_gaa .CT_TableCellProperties {_gfag :=_gaa .NewCT_TableCellProperties ();
if _bbebd !=nil {*_gfag =*_bbebd ;};if _fcfeg ==nil {return _gfag ;};if _cbega :=_fcfeg .FillRef ;_cbega !=nil {_fdcf :=_gaa .NewCT_SolidColorFillProperties ();_fdcf .ScrgbClr =_cbega .ScrgbClr ;_fdcf .SrgbClr =_cbega .SrgbClr ;_fdcf .HslClr =_cbega .HslClr ;
_fdcf .SysClr =_cbega .SysClr ;_fdcf .SchemeClr =_cbega .SchemeClr ;_fdcf .PrstClr =_cbega .PrstClr ;_gfag .SolidFill =_fdcf ;};if _gfag .NoFill ==nil &&_gfag .SolidFill ==nil {if _cba :=_fcfeg .Fill ;_cba !=nil {if _gfag .NoFill ==nil {_gfag .NoFill =_cba .NoFill ;
};if _gfag .SolidFill ==nil {_gfag .SolidFill =_cba .SolidFill ;};};};if _gbgf :=_fcfeg .TcBdr ;_gbgf !=nil {if _gfag .LnL ==nil {var _fgb *_gaa .CT_ThemeableLineStyle ;if _gfc {_fgb =_gbgf .Left ;}else {_fgb =_gbgf .InsideV ;};if _fgb !=nil {_gfag .LnL =_fgb .Ln ;
};};if _gfag .LnR ==nil {var _bbabd *_gaa .CT_ThemeableLineStyle ;if _ddag {_bbabd =_gbgf .Right ;}else {_bbabd =_gbgf .InsideV ;};if _bbabd !=nil {_gfag .LnR =_bbabd .Ln ;};};if _gfag .LnT ==nil {var _dccg *_gaa .CT_ThemeableLineStyle ;if _eeec {_dccg =_gbgf .Top ;
}else {_dccg =_gbgf .InsideH ;};if _dccg !=nil {_gfag .LnT =_dccg .Ln ;};};if _gfag .LnB ==nil {var _caff *_gaa .CT_ThemeableLineStyle ;if _febc {_caff =_gbgf .Bottom ;}else {_caff =_gbgf .InsideH ;};if _caff !=nil {_gfag .LnB =_caff .Ln ;};};};return _gfag ;
};func (_cgdc *textboxContext )newWord (){_cgdc ._aefe =&word {_fac :true ,_agac :_cgdc ._dfg ._eab }};func (_eaa *textboxContext )newParagraph (){_bgbfg :=&paragraph {};_bgbfg ._ebde =_eaa ._egab ;_eaa ._fff =_bgbfg ;};func (_gabe *convertContext )applyBlipEffectsOnImg (_edbbg *_bg .Image ,_bcaf ,_dbfa float64 ,_ecga []*_gaa .CT_BlipChoice )*_bg .Image {if len (_ecga )==0{return _edbbg ;
};_edbbg .SetPos (_bcaf ,_dbfa );_dbfd ,_eddaa :=_gabe .renderPageWithDrawableToGoImage (_edbbg );if _eddaa !=nil {_cf .Log .Debug ("\u0045\u0072\u0072\u006f\u0072\u0020\u0072\u0065\u006e\u0064\u0065\u0072\u0020a\u006e\u0020\u0069\u006d\u0061\u0067e\u0020\u0074\u006f\u0020\u0061\u0020\u0047\u006f\u0020\u0069\u006d\u0061\u0067e\u003a\u0020\u0025\u0073",_eddaa );
return _edbbg ;};_bfbf ,_eddaa :=_gabe .renderCurrentStateToGoImage ();if _eddaa !=nil {_cf .Log .Debug ("\u0045\u0072\u0072\u006f\u0072\u0020\u0072\u0065n\u0064\u0065\u0072 t\u0068\u0065\u0020\u0063\u0075\u0072r\u0065\u006e\u0074\u0020\u0073\u0074\u0061\u0074\u0065\u0020\u0074\u006f\u0020\u0061\u0020G\u006f\u0020\u0069\u006d\u0061\u0067\u0065\u003a \u0025\u0073",_eddaa );
return _edbbg ;};_gedb :=_dbfd .Bounds ();_beaa :=_bb .NewRGBA (_gedb );_ecgcc ,_ceae :=_edbbg .Width (),_edbbg .Height ();for _ ,_add :=range _ecga {for _ ,_bdae :=range _add .AlphaModFix {if _faae :=_bdae .AmtAttr ;_faae !=nil {if _dded :=_faae .ST_PositivePercentageDecimal ;
_dded !=nil {_cbab :=uint8 (255*(*_dded )/100000);_dcge :=_bb .NewUniform (_bf .Alpha {_cbab });_c .Draw (_beaa ,_gedb ,_bfbf ,_bb .Point {0,0},_c .Src );_c .DrawMask (_beaa ,_gedb ,_dbfd ,_bb .Point {0,0},_dcge ,_bb .Point {0,0},_c .Over );};};};};_cdeef :=_bb .Rect (int (_bcaf ),int (_dbfa ),int (_bcaf +_ecgcc )+1,int (_dbfa +_ceae )+1);
_fdf :=_f .CropImageByRect (_beaa ,_cdeef );_caee ,_eddaa :=_gabe ._dga .NewImageFromGoImage (_fdf );if _eddaa !=nil {_cf .Log .Debug ("\u0045\u0072\u0072\u006f\u0072\u0020\u0061\u006e\u0020\u0069\u006d\u0061\u0067\u0065\u0020t\u006f \u0061\u0020\u0047\u006f\u0020\u0069\u006d\u0061\u0067\u0065\u003a\u0020\u0025\u0073",_eddaa );
return _edbbg ;};return _caee ;};func (_gagbga *convertContext )getColorFromSolidFill (_adfa *_gaa .CT_SolidColorFillProperties )(_bg .Color ,float64 ){if _adfa ==nil {return nil ,1;};var _ceda string ;_cdcfc :=1.0;if _cbfa :=_adfa .SrgbClr ;_cbfa !=nil {_ceda =_cbfa .ValAttr ;
_cdcfc =_f .GetOpacityFromColorTransform (_cbfa .EG_ColorTransform );}else if _abcd :=_adfa .SchemeClr ;_abcd !=nil {_ceda =_f .GetColorStringFromDmlColor (_gagbga ._bbfb .GetColorBySchemeColor (_abcd .ValAttr ));_ceda =_f .AdjustColor (_ceda ,_abcd .EG_ColorTransform );
_cdcfc =_f .GetOpacityFromColorTransform (_abcd .EG_ColorTransform );};if _ceda !=""{_egbe :=_bg .ColorRGBFromHex ("\u0023"+_ceda );return _egbe ,_cdcfc ;};return nil ,1;};func (_bcea *line )moveRight (_aade float64 ){for _ ,_fecba :=range _bcea ._cbeg {_fecba ._agac +=_aade ;
};};func (_gagb *convertContext )drawSlide (){_gagb ._dga .NewPage ();for _ ,_beb :=range _gagb ._abgg {if _beb !=nil {_gagb ._dga .MoveTo (0,0);_gagb ._dga .Draw (_beb );};};};func _gbbd (_cec ,_beba *_gaa .CT_TextParagraphProperties )*_gaa .CT_TextParagraphProperties {_caeg :=_gaa .NewCT_TextParagraphProperties ();
if _cec !=nil {*_caeg =*_cec ;};if _beba ==nil {return _caeg ;};if _caeg .MarLAttr ==nil {_caeg .MarLAttr =_beba .MarLAttr ;};if _caeg .MarRAttr ==nil {_caeg .MarRAttr =_beba .MarRAttr ;};if _caeg .LvlAttr ==nil {_caeg .LvlAttr =_beba .LvlAttr ;};if _caeg .IndentAttr ==nil {_caeg .IndentAttr =_beba .IndentAttr ;
};if _caeg .AlgnAttr ==_gaa .ST_TextAlignTypeUnset {_caeg .AlgnAttr =_beba .AlgnAttr ;};if _caeg .DefTabSzAttr ==nil {_caeg .DefTabSzAttr =_beba .DefTabSzAttr ;};if _caeg .RtlAttr ==nil {_caeg .RtlAttr =_beba .RtlAttr ;};if _caeg .EaLnBrkAttr ==nil {_caeg .EaLnBrkAttr =_beba .EaLnBrkAttr ;
};if _caeg .FontAlgnAttr ==_gaa .ST_TextFontAlignTypeUnset {_caeg .FontAlgnAttr =_beba .FontAlgnAttr ;};if _caeg .LatinLnBrkAttr ==nil {_caeg .LatinLnBrkAttr =_beba .LatinLnBrkAttr ;};if _caeg .HangingPunctAttr ==nil {_caeg .HangingPunctAttr =_beba .HangingPunctAttr ;
};if _caeg .LnSpc ==nil {_caeg .LnSpc =_beba .LnSpc ;};if _caeg .SpcBef ==nil {_caeg .SpcBef =_beba .SpcBef ;};if _caeg .SpcAft ==nil {_caeg .SpcAft =_beba .SpcAft ;};if _caeg .BuClrTx ==nil {_caeg .BuClrTx =_beba .BuClrTx ;};if _caeg .BuClr ==nil {_caeg .BuClr =_beba .BuClr ;
};if _caeg .BuSzTx ==nil {_caeg .BuSzTx =_beba .BuSzTx ;};if _caeg .BuSzPct ==nil {_caeg .BuSzPct =_beba .BuSzPct ;};if _caeg .BuSzPts ==nil {_caeg .BuSzPts =_beba .BuSzPts ;};if _caeg .BuFontTx ==nil {_caeg .BuFontTx =_beba .BuFontTx ;};if _caeg .BuFont ==nil {_caeg .BuFont =_beba .BuFont ;
};if _caeg .BuNone ==nil {_caeg .BuNone =_beba .BuNone ;};if _caeg .BuAutoNum ==nil {_caeg .BuAutoNum =_beba .BuAutoNum ;};if _caeg .BuChar ==nil {_caeg .BuChar =_beba .BuChar ;};if _caeg .BuBlip ==nil {_caeg .BuBlip =_beba .BuBlip ;};if _caeg .TabLst ==nil {_caeg .TabLst =_beba .TabLst ;
};if _caeg .ExtLst ==nil {_caeg .ExtLst =_beba .ExtLst ;};_caeg .DefRPr =_gefb (_caeg .DefRPr ,_beba .DefRPr );return _caeg ;};func (_eafbg *textboxContext )addCurrentParagraph (){_eafbg ._egab =_eafbg ._fff ._ebde +_eafbg ._fff ._afcg +_eafbg ._fff ._edbc +_eafbg ._fff ._dddc ;
_eafbg ._gbdbg =append (_eafbg ._gbdbg ,_eafbg ._fff );_eafbg .alignParagraph ();};func (_cff *convertContext )extractDefaultProperties (){_bae :=_cff ._dbbg .X ();_afa :=_bae .DefaultTextStyle ;var _ffd ,_ef ,_afe ,_gg ,_ebf ,_ed ,_de ,_dc ,_gge ,_ce *_gaa .CT_TextParagraphProperties ;
if _afa !=nil {_ffd =_afa .DefPPr ;_ef =_gbbd (_afa .Lvl1pPr ,_ffd );_afe =_gbbd (_afa .Lvl2pPr ,_ffd );_gg =_gbbd (_afa .Lvl3pPr ,_ffd );_ebf =_gbbd (_afa .Lvl4pPr ,_ffd );_ed =_gbbd (_afa .Lvl5pPr ,_ffd );_de =_gbbd (_afa .Lvl6pPr ,_ffd );_dc =_gbbd (_afa .Lvl7pPr ,_ffd );
_gge =_gbbd (_afa .Lvl8pPr ,_ffd );_ce =_gbbd (_afa .Lvl9pPr ,_ffd );_cff ._ecac =_ffd ;_cff ._dfeb =_ffd .DefRPr ;};_cff ._efbg =make ([]*_gaa .CT_TextParagraphProperties ,9);_cff ._efbg [0]=_ef ;_cff ._efbg [1]=_afe ;_cff ._efbg [2]=_gg ;_cff ._efbg [3]=_ebf ;
_cff ._efbg [4]=_ed ;_cff ._efbg [5]=_de ;_cff ._efbg [6]=_dc ;_cff ._efbg [7]=_gge ;_cff ._efbg [8]=_ce ;_eff :=_cff ._dbbg .SlideMasters ()[0].X ();_baa :=_eff .TxStyles ;_ced :=_baa .TitleStyle ;_cff ._dafa =_gbbd (_ced .DefPPr ,_ffd );_cff ._ggf =_cff ._dafa .DefRPr ;
_cff ._gdg =make ([]*_gaa .CT_TextParagraphProperties ,9);_cff ._gdg [0]=_gbbd (_ced .Lvl1pPr ,_ef );_cff ._gdg [1]=_gbbd (_ced .Lvl2pPr ,_afe );_cff ._gdg [2]=_gbbd (_ced .Lvl3pPr ,_gg );_cff ._gdg [3]=_gbbd (_ced .Lvl4pPr ,_ebf );_cff ._gdg [4]=_gbbd (_ced .Lvl5pPr ,_ed );
_cff ._gdg [5]=_gbbd (_ced .Lvl6pPr ,_de );_cff ._gdg [6]=_gbbd (_ced .Lvl7pPr ,_dc );_cff ._gdg [7]=_gbbd (_ced .Lvl8pPr ,_gge );_cff ._gdg [8]=_gbbd (_ced .Lvl9pPr ,_ce );_ea :=_baa .BodyStyle ;_cff ._fga =_gbbd (_ea .DefPPr ,_ffd );_cff ._adb =_cff ._fga .DefRPr ;
_cff ._eee =make ([]*_gaa .CT_TextParagraphProperties ,9);_cff ._eee [0]=_gbbd (_ea .Lvl1pPr ,_ef );_cff ._eee [1]=_gbbd (_ea .Lvl2pPr ,_afe );_cff ._eee [2]=_gbbd (_ea .Lvl3pPr ,_gg );_cff ._eee [3]=_gbbd (_ea .Lvl4pPr ,_ebf );_cff ._eee [4]=_gbbd (_ea .Lvl5pPr ,_ed );
_cff ._eee [5]=_gbbd (_ea .Lvl6pPr ,_de );_cff ._eee [6]=_gbbd (_ea .Lvl7pPr ,_dc );_cff ._eee [7]=_gbbd (_ea .Lvl8pPr ,_gge );_cff ._eee [8]=_gbbd (_ea .Lvl9pPr ,_ce );};func (_gab *convertContext )makePdfBlockFromChart (_fab *_bbb .Chart ,_db ,_cd float64 )(*_bg .Block ,error ){_ba :=_fab .CT_RelId .IdAttr ;
_bc :=_gab ._bbfb .GetChartSpaceByRelId (_ba );if _bc ==nil {return nil ,_a .New ("\u004e\u006f\u0020\u0063\u0068\u0061\u0072\u0074\u0073\u0070\u0061\u0063\u0065");};var _ee *_gaa .Theme ;_fba :=_gab ._dbbg .Themes ();if len (_fba )> 0{_ee =_fba [0];};
return _f .MakeBlockFromChartSpace (_bc ,_db ,_cd ,_ee );};func (_ccf *convertContext )tileImage (_afc *_bg .Image ,_afag *_gaa .CT_TileInfoProperties ,_eg ,_bcb float64 )*_bg .Image {_bbf ,_eca :=1.0,1.0;if _baec :=_afag .SxAttr ;_baec !=nil {_bbf =_f .FromSTPercentage (_baec );
};if _gcf :=_afag .SyAttr ;_gcf !=nil {_eca =_f .FromSTPercentage (_gcf );};_bfdg :=_f .MakeTempCreator (_eg ,_bcb );_afc .Scale (_bbf ,_eca );_fdg ,_caf :=_afc .Width (),_afc .Height ();var _bbbb ,_edc float64 ;if _deb :=_afag .TxAttr ;_deb !=nil {_bbbb =_aa .FromEMU (_f .FromSTCoordinate (*_deb ));
};if _cgg :=_afag .TyAttr ;_cgg !=nil {_edc =_aa .FromEMU (_f .FromSTCoordinate (*_cgg ));};if _bbbb > 0{_bbbb -=_fdg ;};if _edc > 0{_edc -=_caf ;};_ccg :=_ccf ._agdec /_fdg +1;_eae :=_ccf ._daa /_caf +1;for _ece :=0.0;_ece <=_ccg ;_ece ++{_gcb :=_ece *_fdg ;
for _fcc :=0.0;_fcc <=_eae ;_fcc ++{_cdc :=_fcc *_caf ;_afc .SetPos (_gcb +_bbbb ,_cdc +_edc );_bfdg .Draw (_afc );};};_def ,_aea :=_f .GetPageFromCreator (_bfdg );if _aea !=nil {_cf .Log .Debug ("\u0043\u0061\u006e\u006e\u006f\u0074 \u0067\u0065\u0074\u0020\u0069\u006d\u0061\u0067\u0065\u0020\u0066\u0072\u006fm\u0020\u0063\u0072\u0065\u0061\u0074\u006fr\u003a\u0020\u0025\u0073",_aea );
return nil ;};_cef ,_aea :=_e .NewImageDevice ().Render (_def );if _aea !=nil {_cf .Log .Debug ("\u0043\u0061\u006eno\u0074\u0020\u0072\u0065\u006e\u0064\u0065\u0072\u0020\u0069\u006d\u0061\u0067\u0065\u003a\u0020\u0025\u0073",_aea );return nil ;};_abc ,_aea :=_ccf ._dga .NewImageFromGoImage (_cef );
if _aea !=nil {_cf .Log .Debug ("\u0043\u0061nn\u006f\u0074\u0020c\u0072\u0065\u0061\u0074e i\u006dag\u0065\u0020\u0066\u0072\u006f\u006d\u0020Go\u0049\u006d\u0061\u0067\u0065\u003a\u0020%\u0073",_aea );return nil ;};return _abc ;};var _cgcg =map[string ]int32 {"\u0076":9830,"\u00d8":8594,"\u00fc":8730};
func (_fgge *convertContext )makePdfBlockFromTxBody (_ccd *_gaa .CT_TextBody ,_eafd *_gaa .CT_TextBodyProperties ,_gafd *_gaa .CT_TextListStyle ,_gfb ,_dad float64 ,_bef _bg .Color ,_bged ,_gbdc bool )(*_bg .Block ,error ){var _eccc *_gaa .CT_TextParagraphProperties ;
if _cadf :=_ccd .LstStyle ;_cadf !=nil {var _ada *_gaa .CT_TextParagraphProperties ;if _cadf .Lvl1pPr !=nil {_ada =_cadf .Lvl1pPr ;};_eccc =_gbbd (_ada ,_cadf .DefPPr );};var _dgc *_gaa .CT_TextParagraphProperties ;if _eccc !=nil {if _bged {_dgc =_fgge ._gdg [0];
}else if _gbdc {_dgc =_fgge ._eee [0];}else {_dgc =_fgge ._efbg [0];};if _gafd !=nil {_dgc =_gbbd (_gbbd (_gafd .Lvl1pPr ,_gafd .DefPPr ),_dgc );};_dgc =_gbbd (_eccc ,_dgc );}else {if _bged {_dgc =_fgge ._dafa ;}else if _gbdc {_dgc =_fgge ._fga ;}else {_dgc =_fgge ._ecac ;
};};_ggad ,_becb :=_ebef (2.5),_ebef (2.5);_ggg ,_eeae :=_ebef (1.3),_ebef (1.3);_edd :=true ;_bff :=_gaa .ST_TextAnchoringTypeT ;if _eafd !=nil {if _agfe :=_eafd .AnchorAttr ;_agfe !=_gaa .ST_TextAnchoringTypeUnset {_bff =_agfe ;};};if _bfac :=_ccd .BodyPr ;
_bfac !=nil {if _cafd :=_bfac .LInsAttr ;_cafd !=nil {_ggad =_aa .FromEMU (_f .FromSTCoordinate32 (*_cafd ));};if _agc :=_bfac .TInsAttr ;_agc !=nil {_ggg =_aa .FromEMU (_f .FromSTCoordinate32 (*_agc ));};if _ccb :=_bfac .RInsAttr ;_ccb !=nil {_becb =_aa .FromEMU (_f .FromSTCoordinate32 (*_ccb ));
};if _cce :=_bfac .BInsAttr ;_cce !=nil {_eeae =_aa .FromEMU (_f .FromSTCoordinate32 (*_cce ));};_edd =_bfac .WrapAttr !=_gaa .ST_TextWrappingTypeNone ;if _cde :=_bfac .AnchorAttr ;_cde !=_gaa .ST_TextAnchoringTypeUnset {_bff =_bfac .AnchorAttr ;};};_cacc :=_f .MakeTempCreator (_gfb ,_dad );
_cacc .SetPageMargins (_ggad ,_becb ,_ggg ,_eeae );_gafc :=&textboxContext {_dcg :_fgge ,_aadgd :_edd ,_deae :_gfb -_ggad -_becb ,_ceg :_dad -_ggg -_eeae ,_bfbg :_cacc ,_gbdbg :[]*paragraph {}};_cfg :=1;for _ ,_bgff :=range _ccd .P {if _bgff !=nil {_gfdb :=_bgff .PPr ;
var _gba *prefixData ;if _gfdb !=nil &&_gfdb .BuNone ==nil {var _fcfe string ;var _ggadg bool ;if _bgfc :=_gfdb .BuAutoNum ;_bgfc !=nil {var _fbf string ;if _cdea :=_bgfc .StartAtAttr ;_cdea !=nil {_cfg =int (*_cdea );};var _dggf string ;switch _bgfc .TypeAttr {case _gaa .ST_TextAutonumberSchemeAlphaUcParenBoth ,_gaa .ST_TextAutonumberSchemeAlphaUcParenR ,_gaa .ST_TextAutonumberSchemeAlphaUcPeriod :_dggf =_gafg (_cfg ,true );
case _gaa .ST_TextAutonumberSchemeAlphaLcParenBoth ,_gaa .ST_TextAutonumberSchemeAlphaLcParenR ,_gaa .ST_TextAutonumberSchemeAlphaLcPeriod :_dggf =_gafg (_cfg ,false );case _gaa .ST_TextAutonumberSchemeRomanUcParenBoth ,_gaa .ST_TextAutonumberSchemeRomanUcParenR ,_gaa .ST_TextAutonumberSchemeRomanUcPeriod :_dggf =_baed (_cfg ,true );
case _gaa .ST_TextAutonumberSchemeRomanLcParenBoth ,_gaa .ST_TextAutonumberSchemeRomanLcParenR ,_gaa .ST_TextAutonumberSchemeRomanLcPeriod :_dggf =_baed (_cfg ,false );default:_dggf =_ca .Itoa (_cfg );};switch _bgfc .TypeAttr {case _gaa .ST_TextAutonumberSchemeAlphaLcPeriod ,_gaa .ST_TextAutonumberSchemeAlphaUcPeriod ,_gaa .ST_TextAutonumberSchemeArabicPeriod ,_gaa .ST_TextAutonumberSchemeRomanLcPeriod ,_gaa .ST_TextAutonumberSchemeRomanUcPeriod ,_gaa .ST_TextAutonumberSchemeArabicDbPeriod ,_gaa .ST_TextAutonumberSchemeEa1ChsPeriod ,_gaa .ST_TextAutonumberSchemeEa1ChtPeriod ,_gaa .ST_TextAutonumberSchemeEa1JpnChsDbPeriod ,_gaa .ST_TextAutonumberSchemeEa1JpnKorPeriod ,_gaa .ST_TextAutonumberSchemeThaiAlphaPeriod ,_gaa .ST_TextAutonumberSchemeThaiNumPeriod ,_gaa .ST_TextAutonumberSchemeHindiAlphaPeriod ,_gaa .ST_TextAutonumberSchemeHindiNumPeriod ,_gaa .ST_TextAutonumberSchemeHindiAlpha1Period :_fbf ="\u002e";
case _gaa .ST_TextAutonumberSchemeAlphaLcParenR ,_gaa .ST_TextAutonumberSchemeAlphaUcParenR ,_gaa .ST_TextAutonumberSchemeArabicParenR ,_gaa .ST_TextAutonumberSchemeRomanLcParenR ,_gaa .ST_TextAutonumberSchemeRomanUcParenR ,_gaa .ST_TextAutonumberSchemeThaiAlphaParenR ,_gaa .ST_TextAutonumberSchemeThaiNumParenR ,_gaa .ST_TextAutonumberSchemeHindiNumParenR :_fbf ="\u0029";
};_fcfe =_dggf +_fbf ;_cfg ++;}else if _aabc :=_gfdb .BuChar ;_aabc !=nil {_cgd :=_aabc .CharAttr ;if _acd ,_ggea :=_cgcg [_cgd ];_ggea {_cgd =string (rune (_acd ));}else {_cgd ="\u2022";};_fcfe =_cgd ;_ggadg =true ;};if _fcfe !=""{var _ddb ,_gaaa float64 ;
if _gfdb .MarLAttr !=nil {_ddb =_aa .FromEMU (int64 (*_gfdb .MarLAttr ));};if _gfdb .IndentAttr !=nil {_gaaa =_aa .FromEMU (int64 (*_gfdb .IndentAttr ));};_gba =&prefixData {_gccg :_fcfe ,_gdgb :_ggadg ,_fdda :_ddb ,_caagb :_gaaa };};};_gfdb =_gbbd (_gfdb ,_dgc );
_dac :=_gefb (_bgff .EndParaRPr ,_gfdb .DefRPr );_gafc .newParagraph ();_gafc .assignPropsToCurrentParagraph (_gfdb );_gafc .newLine ();_gafc .newWord ();for _dbfc ,_ecaac :=range _bgff .EG_TextRun {_gafc .addTextRun (_ecaac ,_dac ,_bef ,_gba );if _dbfc > 0{_gba =nil ;
};};_gafc .addCurrentWordToParagraph ();};_gafc .addCurrentParagraph ();};_gafc .alignVertically (_bff );_gafc .drawParagraphs ();return _f .MakeBlockFromCreator (_cacc );};func (_gece *convertContext )getShapes (_fee *_aac .CT_Shape )[]_bg .Drawable {_cdb :=[]_bg .Drawable {};
_edb :=_fee .SpPr ;if _edb ==nil {return _cdb ;};var _cfc bool ;if _gce :=_fee .UseBgFillAttr ;_gce !=nil {_cfc =*_gce ;};_cbcb ,_dgdb ,_afcd ,_bgg ,_bba ,_ded ,_gfa :=_gece .getShapesFromSpPr (_edb ,_fee .Style ,_cfc );_cdb =append (_cdb ,_cbcb ...);if _eeag :=_fee .TxBody ;
_eeag !=nil {_cggg ,_gb ,_gfd ,_dcb ,_gede :=_gece .getPhData (_fee );if _cggg !=nil &&!_gfa {_dgdb ,_afcd ,_bgg ,_bba =_f .GetDataFromXfrm (_cggg );};_fdcg ,_dcf :=_gece .makePdfBlockFromTxBody (_eeag ,_gb ,_gfd ,_bgg ,_bba ,_ded ,_dcb ,_gede );if _dcf !=nil {_cf .Log .Debug ("\u0043\u0061\u006e\u006e\u006f\u0074\u0020\u006d\u0061\u006b\u0065\u0020\u0050\u0044\u0046\u0020\u0062\u006c\u006f\u0063\u006b\u0020\u0066\u0072o\u006d\u0020\u0074\u0065\u0078t\u0062\u006fx\u003a\u0020\u0025\u0073",_dcf );
}else if _fdcg !=nil {_fdcg .SetPos (_dgdb ,_afcd );_cdb =append (_cdb ,_fdcg );};};return _cdb ;};func (_bfbb *convertContext )makeStyleFromRPr (_eef *_gaa .CT_TextCharacterProperties )(*_bg .TextStyle ,bool ,bool ,bool ){var _bee ,_gef ,_ffe bool ;_ddf :=_bfbb ._dga .NewTextStyle ();
if _eef !=nil {_adf :=_f .FontStyle_Regular ;_ceba :=_gbdbf (_eef .BAttr );_cbfe :=_gbdbf (_eef .IAttr );if _ceba &&_cbfe {_adf =_f .FontStyle_BoldItalic ;}else if _ceba {_adf =_f .FontStyle_Bold ;}else if _cbfe {_adf =_f .FontStyle_Italic ;};_ffe =_eef .UAttr !=_gaa .ST_TextUnderlineTypeUnset &&_eef .UAttr !=_gaa .ST_TextUnderlineTypeNone ;
_fdb :="\u0064e\u0066\u0061\u0075\u006c\u0074";if _bbfe :=_eef .Latin ;_bbfe !=nil {_fdb =_bbfe .TypefaceAttr ;}else if _egdc :=_eef .Ea ;_egdc !=nil {_fdb =_egdc .TypefaceAttr ;}else if _accc :=_eef .Cs ;_accc !=nil {_fdb =_accc .TypefaceAttr ;}else if _efb :=_eef .Sym ;
_efb !=nil {_fdb =_efb .TypefaceAttr ;};if _eda ,_cfe :=_f .StdFontsMap [_fdb ];_cfe {_ddf .Font =_f .AssignStdFontByName (_ddf ,_eda [_adf ]);}else if _eafe :=_f .GetRegisteredFont (_fdb ,_adf );_eafe !=nil {_ddf .Font =_eafe ;}else {_cf .Log .Debug ("\u0046\u006f\u006e\u0074\u0020\u0025\u0073\u0020\u0077\u0069\u0074h\u0020\u0073\u0074\u0079\u006c\u0065\u0020\u0025s\u0020i\u0073\u0020\u006e\u006f\u0074\u0020\u0066\u006f\u0075\u006e\u0064\u002c\u0020\u0072\u0065\u0073\u0065\u0074 \u0074\u006f\u0020\u0064\u0065\u0066\u0061\u0075\u006c\u0074\u002e",_fdb ,_adf );
_ddf .Font =_f .AssignStdFontByName (_ddf ,_f .StdFontsMap ["\u0064e\u0066\u0061\u0075\u006c\u0074"][_adf ]);};var _cge float64 ;if _ffgg :=_eef .SzAttr ;_ffgg !=nil {_cge =float64 (*_ffgg )/100;}else {_cge =_f .DefaultFontSize ;};if _ccge :=_eef .BaselineAttr ;
_ccge !=nil {if _bd :=_ccge .ST_PercentageDecimal ;_bd !=nil {if *_bd > 0{_bee =true ;}else if *_bd < 0{_gef =true ;};};};if _bee ||_gef {_cge *=0.64;};_ddf .FontSize =_cge ;_gefd :=0.0;if _bfaf :=_eef .SpcAttr ;_bfaf !=nil {if _fafe :=_bfaf .ST_TextPointUnqualified ;
_fafe !=nil {_gefd =float64 (*_fafe )/100;};};_ddf .CharSpacing =_gefd ;};return &_ddf ,_bee ,_gef ,_ffe ;};func (_bdbc *convertContext )getPhData (_fgdeg *_aac .CT_Shape )(*_gaa .CT_Transform2D ,*_gaa .CT_TextBodyProperties ,*_gaa .CT_TextListStyle ,bool ,bool ){_fdaf ,_geeg :=_agea (_fgdeg );
_bfbe :=_geeg ==nil ;_cdgd ,_dede ,_afgc ,_dgad :=_cbda (_bdbc ._dcfb .CSld ,_fdaf ,_geeg ,_bfbe );_dge ,_bfbea ,_bgfe ,_bde :=_cbda (_bdbc ._adac .CSld ,_fdaf ,_geeg ,_bfbe );if _dge ==nil {_dge =_cdgd ;};_fddg ,_cfeg :=_dbgc (_bfbea ,_dede );var _bcca ,_gabg bool ;
if _bgfe ==nil {if _afgc !=nil {_bcca =*_afgc ;};}else {_bcca =*_bgfe ;};if _bde ==nil {if _dgad !=nil {_gabg =*_dgad ;};}else {_gabg =*_bde ;};return _dge ,_fddg ,_cfeg ,_bcca ,_gabg ;};func (_cgdce *textboxContext )addPrefix (_befg *prefixData ,_bfab *_bg .TextStyle ){_bdc :=_gca (_befg ._gccg );
_gefa :=*_bfab ;if _befg ._gdgb {_gefa .Font =_f .AssignStdFontByName (_gefa ,"\u0053\u0079\u006d\u0062\u006f\u006c");};for _ ,_edcc :=range _bdc {_edcc ._bfba =&_gefa ;_cgdce .addTextSymbol (_edcc );};_afac :=-(_befg ._caagb +_cgdce ._aefe ._dfed );if _afac < 0{_afac =0;
};_aadd :=&symbol {_bebd :"\u0020",_gcc :_afac };_cgdce .addTextSymbol (_aadd );_cgdce ._aefe ._agac +=(_befg ._caagb +_befg ._fdda );};func (_dcbc *convertContext )getStyleColors (_cbg *_gaa .CT_ShapeStyle )(_bg .Color ,_bg .Color ,_bg .Color ){var _ddgf ,_cgfc ,_egdg _bg .Color ;
if _cfab :=_cbg .LnRef ;_cfab !=nil {_cgfc =_dcbc .getColorFromMatrixReference (_cfab );};if _egbeg :=_cbg .FillRef ;_egbeg !=nil {_egdg =_dcbc .getColorFromMatrixReference (_egbeg );};if _fdbc :=_cbg .FontRef ;_fdbc !=nil {_ddgf =_dcbc .getColorFromFontReference (_fdbc );
};return _ddgf ,_egdg ,_cgfc ;};

// FontStyle represents a kind of font styling. It can be FontStyle_Regular, FontStyle_Bold, FontStyle_Italic and FontStyle_BoldItalic.
type FontStyle =_f .FontStyle ;type line struct{_affd float64 ;_cdgf float64 ;_adgf float64 ;_eab float64 ;_cegc float64 ;_cbeg []*word ;};func (_daee *convertContext )addCellToTable (_efcc *_bg .Table ,_abd *_gaa .CT_TableCell ,_fad *_gaa .CT_TablePartStyle ,_edaf float64 ,_beec ,_ccc ,_feg ,_dgb bool )float64 {var _gagf *_bg .TableCell ;
_gaae :=1;if _abd .GridSpanAttr !=nil {_gaae =int (*_abd .GridSpanAttr );};_gagf =_efcc .MultiColCell (_gaae );_fbcg :=_abd .TcPr ;var _gbg *_gaa .CT_TableStyleTextStyle ;if _fad !=nil {_fbcg =_gedd (_fbcg ,_fad .TcStyle ,_beec ,_ccc ,_feg ,_dgb );_gbg =_fad .TcTxStyle ;
};_gagfa :=_bca ;_cefa :=_bg .CellVerticalAlignmentMiddle ;if _fbcg !=nil {if _gbdb :=_fbcg .LnL ;_gbdb !=nil {_ace ,_gaee ,_aceb :=_daee .getBorderStyle (_gbdb );_gagf .SetBorder (_bg .CellBorderSideLeft ,_ace ,_aceb );if _gaee !=nil &&*_gaee !=nil {_gagf .SetSideBorderColor (_bg .CellBorderSideLeft ,*_gaee );
};};if _gcef :=_fbcg .LnT ;_gcef !=nil {_ecba ,_ade ,_egdcb :=_daee .getBorderStyle (_gcef );_gagf .SetBorder (_bg .CellBorderSideTop ,_ecba ,_egdcb );if _ade !=nil &&*_ade !=nil {_gagf .SetSideBorderColor (_bg .CellBorderSideTop ,*_ade );};};if _agde :=_fbcg .LnR ;
_agde !=nil {_egae ,_agb ,_abcb :=_daee .getBorderStyle (_agde );_gagf .SetBorder (_bg .CellBorderSideRight ,_egae ,_abcb );if _agb !=nil &&*_agb !=nil {_gagf .SetSideBorderColor (_bg .CellBorderSideRight ,*_agb );};};if _dfe :=_fbcg .LnB ;_dfe !=nil {_gaea ,_bfgd ,_gagbg :=_daee .getBorderStyle (_dfe );
_gagf .SetBorder (_bg .CellBorderSideBottom ,_gaea ,_gagbg );if _bfgd !=nil &&*_bfgd !=nil {_gagf .SetSideBorderColor (_bg .CellBorderSideBottom ,*_bfgd );};};if _aadc :=_fbcg .MarLAttr ;_aadc !=nil {_gagfa =float64 (_f .FromSTCoordinate32 (*_aadc ));};
switch _fbcg .AnchorAttr {case _gaa .ST_TextAnchoringTypeT :_cefa =_bg .CellVerticalAlignmentTop ;case _gaa .ST_TextAnchoringTypeB :_cefa =_bg .CellVerticalAlignmentBottom ;};if _fbcg .NoFill ==nil {if _baaf :=_fbcg .SolidFill ;_baaf !=nil {_bgbc ,_ :=_daee .getColorFromSolidFill (_baaf );
_gagf .SetBackgroundColor (_bgbc );};};};_gagf .SetVerticalAlignment (_cefa );_gagf .SetIndent (_gagfa );var _ebfc float64 ;if _efcf :=_abd .TxBody ;_efcf !=nil {_gcbd :=_daee .makePdfDivisionFromTxBody (_efcf ,_edaf ,_ebfc ,_gbg );_ebfc =_gcbd .Height ();
_gagf .SetContent (_gcbd );};return _ebfc ;};type textboxContext struct{_dcg *convertContext ;_deae float64 ;_ceg float64 ;_bfbg *_bg .Creator ;_egab float64 ;_gbdbg []*paragraph ;_fff *paragraph ;_dfg *line ;_aefe *word ;_aadgd bool ;};func _gbdbf (_deg *bool )bool {return _deg !=nil &&*_deg };
func (_cagf *textboxContext )alignParagraphsVertically (_dgbf _gaa .ST_TextAnchoringType ){if _dgbf ==_gaa .ST_TextAnchoringTypeT {return ;};_fcfg :=0.0;for _ ,_gabbf :=range _cagf ._gbdbg {_fcfg +=_gabbf ._afcg +_gabbf ._edbc +_gabbf ._dddc ;};var _aced float64 ;
switch _dgbf {case _gaa .ST_TextAnchoringTypeCtr :_aced =(_cagf ._ceg -_fcfg )/2;case _gaa .ST_TextAnchoringTypeB :_aced =_cagf ._ceg -_fcfg ;};for _ ,_cea :=range _cagf ._gbdbg {_cea ._ebde +=_aced ;};};func _dbgc (_fgcb ,_edda *_gaa .CT_TextBody )(*_gaa .CT_TextBodyProperties ,*_gaa .CT_TextListStyle ){if _fgcb ==nil &&_edda ==nil {return nil ,nil ;
};if _fgcb ==nil {return _edda .BodyPr ,_edda .LstStyle ;};if _edda ==nil {return _fgcb .BodyPr ,_fgcb .LstStyle ;};_efca ,_eccce :=_fgcb .BodyPr ,_fgcb .LstStyle ;_dacb ,_cfdf :=_edda .BodyPr ,_edda .LstStyle ;_dcaab :=_ccae (_efca ,_dacb );_bbeb :=_egfb (_eccce ,_cfdf );
return _dcaab ,_bbeb ;};

// RegisterFontsFromDirectory registers all fonts from the given directory automatically detecting font families and styles.
func RegisterFontsFromDirectory (dirName string )error {return _f .RegisterFontsFromDirectory (dirName )};

// RegisterFont makes a PdfFont accessible for using in converting to PDF.
func RegisterFont (name string ,style FontStyle ,font *_gf .PdfFont ){_f .RegisterFont (name ,style ,font );};func (_abe *convertContext )getShapeFromBlipFill (_cgaa *_gaa .CT_BlipFillProperties ,_fbcgf ,_bebc ,_dbff ,_ddfcd float64 ,_bffe bool )_bg .Drawable {_cceg ,_fbdg ,_gffd :=_abe .makePdfImageFromBlipFill (_cgaa ,_bffe );
if _gffd !=nil {_cf .Log .Debug ("\u0043\u0061\u006e\u006e\u006f\u0074\u0020\u006d\u0061\u006b\u0065\u0020\u0050D\u0046\u0020\u0069\u006d\u0061\u0067e\u0020\u0066\u0072\u006f\u006d\u0020\u0042\u006c\u0069\u0070\u0046\u0069\u006cl\u003a\u0020\u0025\u0073",_gffd );
return nil ;};if _cceg ==nil {return nil ;};if _fdgc :=_cgaa .Tile ;_fdgc !=nil {_cceg =_abe .tileImage (_cceg ,_cgaa .Tile ,_dbff ,_ddfcd );};if _abgc :=_cgaa .Stretch ;_abgc !=nil {_cceg ,_fbcgf ,_bebc =_abe .stretchImage (_cceg ,_cgaa .Stretch ,_fbcgf ,_bebc ,_dbff ,_ddfcd );
};if len (_fbdg )==0{_cceg .SetPos (_fbcgf ,_bebc );return _cceg ;};_cceg =_abe .applyBlipEffectsOnImg (_cceg ,_fbcgf ,_bebc ,_fbdg );_cceg .SetPos (_fbcgf ,_bebc );return _cceg ;};func (_faeba *textboxContext )alignParagraph (){_aage :=_faeba ._fff ;if _aage ._faeb ==_gaa .ST_TextAlignTypeL {return ;
};_egad :=len (_aage ._gdf )-1;for _gdd ,_edfa :=range _aage ._gdf {_dccb :=true ;_ccbg :=len (_edfa ._cbeg );_ebc :=0.0;for _adbb :=len (_edfa ._cbeg )-1;_adbb >=0;_adbb --{_cdac :=_edfa ._cbeg [_adbb ];if _dccb &&_cdac ._fac {_ccbg =_adbb ;}else {_dccb =false ;
for _ ,_febg :=range _cdac ._ggd {_ebc +=_febg ._gcc ;};};};_edfa ._cbeg =_edfa ._cbeg [:_ccbg ];_fgde :=_edfa ._adgf -_edfa ._cdgf -_ebc ;switch _aage ._faeb {case _gaa .ST_TextAlignTypeR :_edfa .moveRight (_fgde );case _gaa .ST_TextAlignTypeCtr :_edfa .moveRight (_fgde /2);
case _gaa .ST_TextAlignTypeJust :if _gdd !=_egad {_baadg :=[]*word {};for _ ,_bac :=range _edfa ._cbeg {if _bac ._fac {_baadg =append (_baadg ,_bac );};};_eeacc :=_fgde /float64 (len (_baadg ));for _ ,_dgcd :=range _baadg {_dgcd ._dfed +=_eeacc ;};var _ddbe *word ;
for _ ,_faag :=range _edfa ._cbeg {if _ddbe !=nil {_faag ._agac =_ddbe ._agac +_ddbe ._dfed ;};_ddbe =_faag ;};};};};};func (_fccg *convertContext )getBorderStyle (_cgce *_gaa .CT_LineProperties )(_bg .CellBorderStyle ,*_bg .Color ,float64 ){if _cgce ==nil ||_cgce .NoFill !=nil {return _bg .CellBorderStyleNone ,nil ,0;
};var _gde _bg .Color ;if _aef :=_cgce .SolidFill ;_aef !=nil {_gde ,_ =_fccg .getColorFromSolidFill (_aef );};_aabf :=0.0;if _ceee :=_cgce .WAttr ;_ceee !=nil {_aabf =_aa .FromEMU (int64 (*_ceee ));};return _bg .CellBorderStyleSingle ,&_gde ,_aabf ;};
func _egfb (_dbfe ,_efaf *_gaa .CT_TextListStyle )*_gaa .CT_TextListStyle {_adad :=_gaa .NewCT_TextListStyle ();if _dbfe !=nil {*_adad =*_dbfe ;};if _efaf ==nil {return _adad ;};_adad .DefPPr =_gbbd (_adad .DefPPr ,_efaf .DefPPr );_adad .Lvl1pPr =_gbbd (_adad .Lvl1pPr ,_efaf .Lvl1pPr );
_adad .Lvl2pPr =_gbbd (_adad .Lvl2pPr ,_efaf .Lvl2pPr );_adad .Lvl3pPr =_gbbd (_adad .Lvl3pPr ,_efaf .Lvl3pPr );_adad .Lvl4pPr =_gbbd (_adad .Lvl4pPr ,_efaf .Lvl4pPr );_adad .Lvl5pPr =_gbbd (_adad .Lvl5pPr ,_efaf .Lvl5pPr );_adad .Lvl6pPr =_gbbd (_adad .Lvl6pPr ,_efaf .Lvl6pPr );
_adad .Lvl7pPr =_gbbd (_adad .Lvl7pPr ,_efaf .Lvl7pPr );_adad .Lvl8pPr =_gbbd (_adad .Lvl8pPr ,_efaf .Lvl8pPr );_adad .Lvl9pPr =_gbbd (_adad .Lvl9pPr ,_efaf .Lvl9pPr );return _adad ;};func _gafg (_bgfg int ,_dccd bool )string {_fecb :=(_bgfg -1)/26+1;_gegd :=byte ((_bgfg -1)%26);
if _dccd {_gegd +=byte (65);}else {_gegd +=byte (97);};_afff :=_g .NewBuffer ([]byte {});for _aede :=0;_aede < _fecb ;_aede ++{_afff .Write ([]byte {_gegd });};return _afff .String ();};func (_fcbd *textboxContext )drawParagraphs (){_fcbd ._bfbg .NewPage ();
for _ ,_efbb :=range _fcbd ._gbdbg {for _ ,_fgd :=range _efbb ._gdf {for _ ,_abf :=range _fgd ._cbeg {for _ ,_gfbb :=range _abf ._ggd {_gdfb :=_fcbd ._bfbg .NewStyledParagraph ();if _gfbb ._ebac {_gfbb ._afed =0;}else if _gfbb ._edaa {_gfbb ._afed =1.2*_fgd ._cegc -_gfbb ._eefe ;
};_dfca :=_abf ._agac +_gfbb ._gea ;_agg :=_efbb ._ebde +_fgd ._affd +_gfbb ._afed ;_gdfb .SetPos (_dfca ,_agg );_ddfg :=_gdfb .Append (_gfbb ._bebd );if _gfbb ._bfba !=nil {_ddfg .Style =*_gfbb ._bfba ;};_fcbd ._bfbg .Draw (_gdfb );if _gfbb ._eeee {_cdef :=_agg +_gfbb ._eefe +2;
_f .DrawLine (_fcbd ._bfbg ,_dfca ,_cdef ,_dfca +_gfbb ._gcc ,_cdef ,1,_gfbb ._bfba .Color );};};};};};};func (_cead *convertContext )getColorFromFontReference (_dfd *_gaa .CT_FontReference )_bg .Color {var _bdb _bg .Color ;var _eafc string ;if _adaf :=_dfd .SrgbClr ;
_adaf !=nil {_eafc =_adaf .ValAttr ;}else if _gcbcb :=_dfd .SchemeClr ;_gcbcb !=nil {_eafc =_f .GetColorStringFromDmlColor (_cead ._dbbg .GetColorBySchemeColor (_gcbcb .ValAttr ));_eafc =_f .AdjustColor (_eafc ,_gcbcb .EG_ColorTransform );};if _eafc !=""{_bdb =_bg .ColorRGBFromHex ("\u0023"+_eafc );
};return _bdb ;};func (_cga *convertContext )makePdfDivisionFromTxBody (_bab *_gaa .CT_TextBody ,_fead ,_fcb float64 ,_gabb *_gaa .CT_TableStyleTextStyle )*_bg .Division {_dbgb :=_cga ._dga .NewDivision ();_baba :=_cga ._ecac ;_fbeg :=_gaa .ST_TextAnchoringTypeT ;
if _bgf :=_bab .BodyPr ;_bgf !=nil {if _gdc :=_bgf .AnchorAttr ;_gdc !=_gaa .ST_TextAnchoringTypeUnset {_fbeg =_bgf .AnchorAttr ;};};if _eaf :=_bab .LstStyle ;_eaf !=nil {var _bgbf *_gaa .CT_TextParagraphProperties ;if _eaf .Lvl1pPr !=nil {_bgbf =_eaf .Lvl1pPr ;
}else {_bgbf =_cga ._efbg [0];};_baba =_gbbd (_bgbf ,_gbbd (_eaf .DefPPr ,_baba ));};for _ ,_aged :=range _bab .P {if _aged !=nil {_ccad :=_cga ._dga .NewStyledParagraph ();_ecaa :=_gbbd (_aged .PPr ,_baba );_fcg :=_gefb (_aged .EndParaRPr ,_ecaa .DefRPr );
if len (_aged .EG_TextRun )==0{_ccad .Append ("\u000a");_dbgb .Add (_ccad );continue ;};for _ ,_acc :=range _aged .EG_TextRun {if _bfe :=_acc .Br ;_bfe !=nil {_ccad .Append ("\u000a");}else if _agef :=_acc .R ;_agef !=nil {_bfdc :=_fegb (_agef .RPr ,_gabb );
_bfdc =_gefb (_bfdc ,_fcg );var _gaf _bg .Color ;if _bfdc .SolidFill !=nil {_gaf ,_ =_cga .getColorFromSolidFill (_bfdc .SolidFill );}else {_gaf =_bg .ColorBlack ;};_cad ,_bec ,_debe ,_ :=_cga .makeStyleFromRPr (_bfdc );_cad .Color =_gaf ;if _bec {_cad .TextRise =0.5;
}else if _debe {_cad .TextRise =-0.5;};_dcaa :=_agef .T ;if _bfdc .CapAttr ==_gaa .ST_TextCapsTypeAll {for _ ,_ddd :=range _dcaa {_ddd =[]rune (_ga .ToUpper (string (_ddd )))[0];};};_bgd :=_ccad .Append (_dcaa );_bgd .Style =*_cad ;};};_ =_fbeg ;_dbgb .Add (_ccad );
};};return _dbgb ;};func (_gcdd *convertContext )getInfoFromLn (_fag *_gaa .CT_LineProperties )(_bg .Color ,float64 ,float64 ){if _fag ==nil ||_fag .NoFill !=nil {return nil ,0,0;};var _dffc float64 ;_ffc ,_cdf :=_gcdd .getColorFromSolidFill (_fag .SolidFill );
if _aggc :=_fag .WAttr ;_aggc !=nil {_dffc =_aa .FromEMU (int64 (*_aggc ));}else {_dffc =1;};return _ffc ,_dffc ,_cdf ;};type symbolStyle struct{_efcfg *string ;_bebdc *float64 ;_dffe *string ;_gad *bool ;_adgd *bool ;_dfc *bool ;_geg *bool ;_edg *bool ;
};func _gca (_caab string )[]*symbol {_eed :=[]*symbol {};for _ ,_ggeaf :=range _caab {_eed =append (_eed ,&symbol {_bebd :string (_ggeaf )});};return _eed ;};func (_fgf *convertContext )renderPageWithDrawableToGoImage (_cdcd _bg .Drawable )(_bb .Image ,error ){_cbce :=_f .MakeTempCreator (_fgf ._agdec ,_fgf ._daa );
_cbce .NewPage ();_cbce .Draw (_cdcd );_gdfd ,_eecbf :=_f .GetPageFromCreator (_cbce );if _eecbf !=nil {return nil ,_eecbf ;};return _e .NewImageDevice ().Render (_gdfd );};type word struct{_ggd []*symbol ;_agac float64 ;_dfed float64 ;_fac bool ;};func (_bgedd *textboxContext )addTextSymbol (_ddc *symbol ){_adce :=_bg .New ();
_ecee :=_adce .NewStyledParagraph ();_ecee .SetMargins (0,0,0,0);_aeacd :=_ecee .Append (_ddc ._bebd );_fgag :=0.0;if _ddc ._bfba !=nil {_aeacd .Style =*_ddc ._bfba ;if _ddc ._bfba .CharSpacing !=0{_fgag =_ddc ._bfba .CharSpacing ;};};_ddc ._eefe =_ecee .Height ();
_ddc ._caag =_ecee .Height ()*1.2;if _ddc ._caag < _bgedd ._fff ._eecg {_ddc ._caag =_bgedd ._fff ._eecg ;};if _ddc ._gcc ==0{_ddc ._gcc =_ecee .Width ()+_fgag ;};if len (_bgedd ._aefe ._ggd )> 0{_acg :=_bgedd ._aefe ._ggd [len (_bgedd ._aefe ._ggd )-1]._bebd ;
if _bgedd ._fff ._cbe ||_f .IsNoSpaceLanguage (_acg )||(_acg =="\u0020")!=(_ddc ._bebd =="\u0020"){_bgedd .addCurrentWordToParagraph ();_bgedd .newWord ();};};_bgedd ._aefe ._ggd =append (_bgedd ._aefe ._ggd ,_ddc );_ddc ._gea =_bgedd ._aefe ._dfed ;_bgedd ._aefe ._dfed +=_ddc ._gcc ;
if _ddc ._bebd !="\u0020"{_bgedd ._aefe ._fac =false ;};};func _ffga (_ebad ,_cabf *_gaa .CT_TablePartStyle )*_gaa .CT_TablePartStyle {_fbfcc :=_gaa .NewCT_TablePartStyle ();if _ebad !=nil {*_fbfcc =*_ebad ;};if _cabf ==nil {return _fbfcc ;};if _fbfcc .TcTxStyle ==nil {_fbfcc .TcTxStyle =_cabf .TcTxStyle ;
}else {_fbfcc .TcTxStyle =_gdb (_fbfcc .TcTxStyle ,_cabf .TcTxStyle );};if _fbfcc .TcStyle ==nil {_fbfcc .TcStyle =_cabf .TcStyle ;}else {_fbfcc .TcStyle =_cdfa (_fbfcc .TcStyle ,_cabf .TcStyle );};return _fbfcc ;};func (_dadb *convertContext )makePdfBlockFromTable (_bffd *_gaa .Tbl ,_eeac float64 )*_bg .Table {_bgea :=_bffd .TblGrid ;
if _bgea ==nil {return nil ;};_bffc :=len (_bgea .GridCol );if _bffc ==0{return nil ;};_eagb :=[]float64 {};_bfdd :=0.0;for _ ,_fbge :=range _bgea .GridCol {_bbbg :=_aa .FromEMU (_f .FromSTCoordinate (_fbge .WAttr ));_eagb =append (_eagb ,_bbbg );_bfdd +=_bbbg ;
};_fabc :=[]float64 {};for _gbb :=0;_gbb < _bffc ;_gbb ++{_fabc =append (_fabc ,_eagb [_gbb ]/_bfdd );};_afb :=_dadb ._dga .NewTable (_bffc );_afb .SetColumnWidths (_fabc ...);_gfbd :=_bffd .TblPr ;var _cgcc *_gaa .CT_TableStyle ;if _ecbb :=_gfbd .Choice ;
_ecbb !=nil {if _ecbb .TableStyle !=nil {_cgcc =_ecbb .TableStyle ;}else if _ecbb .TableStyleId !=nil {_cgcc =_dadb ._dbbg .GetTableStyleById (*_ecbb .TableStyleId );};};_bgdb :=_gaa .NewCT_TablePartStyle ();_bgdb .TcStyle =_gaa .NewCT_TableStyleCellStyle ();
_bgdb .TcTxStyle =_gaa .NewCT_TableStyleTextStyle ();if _cgcc !=nil {if _cgcc .WholeTbl !=nil {*_bgdb =*_cgcc .WholeTbl ;};if _cgcc .TblBg !=nil {if _bgdb .TcStyle .Fill ==nil {_bgdb .TcStyle .Fill =_cgcc .TblBg .Fill ;};};};if _bgdb .TcStyle .Fill ==nil {_bgdb .TcStyle .Fill =_gaa .NewCT_FillProperties ();
_bgdb .TcStyle .Fill .NoFill =_gfbd .NoFill ;_bgdb .TcStyle .Fill .SolidFill =_gfbd .SolidFill ;};_cfdd :=len (_bffd .Tr );for _ffgc ,_bfad :=range _bffd .Tr {_afg :=_ffgc ==0;_bbea :=_ffgc ==_cfdd -1;_dce :=_ffgc %2==0;_ecgc :=len (_bfad .Tc );var _ddfc *_gaa .CT_TablePartStyle ;
if _afg {_ddfc =_cgcc .FirstRow ;}else if _dce {_ddfc =_cgcc .Band2H ;}else {_ddfc =_cgcc .Band1H ;};var _eac float64 ;for _dag ,_fggd :=range _bfad .Tc {_dba :=_dag ==0;_ecd :=_dag ==_ecgc -1;_dggd :=_dag %2==0;var _cdg *_gaa .CT_TablePartStyle ;if _dba {_cdg =_cgcc .FirstCol ;
}else if _dggd {_cdg =_cgcc .Band2V ;}else {_cdg =_cgcc .Band1V ;};_adff :=_ffga (_ffga (_cdg ,_ddfc ),_bgdb );_fdeb :=_dadb .addCellToTable (_afb ,_fggd ,_adff ,_eeac *_fabc [_dag ],_afg ,_bbea ,_dba ,_ecd );if _fdeb > _eac {_eac =_fdeb ;};};_aga :=_aa .FromEMU (_f .FromSTCoordinate (_bfad .HAttr ));
if _aga < _eac {_aga =_eac ;};if _aga < _ebef (4){_aga =_ebef (4);};_afb .SetRowHeight (_afb .CurRow (),_aga );};return _afb ;};var _bca =_ebef (1.9);func _cdfa (_gbe ,_eagbg *_gaa .CT_TableStyleCellStyle )*_gaa .CT_TableStyleCellStyle {_dcba :=_gaa .NewCT_TableStyleCellStyle ();
if _gbe !=nil {*_dcba =*_gbe ;};if _eagbg ==nil {return _dcba ;};if _dcba .TcBdr ==nil {_dcba .TcBdr =_eagbg .TcBdr ;};if _dcba .Fill ==nil {_dcba .Fill =_eagbg .Fill ;};if _dcba .FillRef ==nil {_dcba .FillRef =_eagbg .FillRef ;};return _dcba ;};