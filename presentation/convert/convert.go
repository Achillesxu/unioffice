//
// Copyright 2020 FoxyUtils ehf. All rights reserved.
//
// This is a commercial product and requires a license to operate.
// A trial license can be obtained at https://unidoc.io
//
// DO NOT EDIT: generated by unitwist Go source code obfuscator.
//
// Use of this source code is governed by the UniDoc End User License Agreement
// terms that can be accessed at https://unidoc.io/eula/

package convert ;import (_db "bytes";_e "errors";_ec "github.com/unidoc/unioffice/common/logger";_ef "github.com/unidoc/unioffice/common/tempstorage";_bb "github.com/unidoc/unioffice/internal/convertutils";_fe "github.com/unidoc/unioffice/measurement";_fa "github.com/unidoc/unioffice/presentation";_bbd "github.com/unidoc/unioffice/schema/soo/dml";_eb "github.com/unidoc/unioffice/schema/soo/dml/chart";_dcc "github.com/unidoc/unioffice/schema/soo/pml";_g "github.com/unidoc/unipdf/v3/contentstream/draw";_de "github.com/unidoc/unipdf/v3/creator";_dg "github.com/unidoc/unipdf/v3/model";_fea "github.com/unidoc/unipdf/v3/render";_dc "image";_ea "image/color";_b "image/draw";_c "strconv";_f "strings";);type paragraph struct{_dfg float64 ;_gffa float64 ;_agff float64 ;_ggf float64 ;_gag float64 ;_fegb float64 ;_aef float64 ;_gbc float64 ;_ddbf _bbd .ST_TextAlignType ;_bcdg float64 ;_ffaa bool ;_ebbe []*line ;};

// ConvertToPdf converts a presentation to a PDF file. This package is beta, breaking changes can take place.
func ConvertToPdf (pr *_fa .Presentation )*_de .Creator {_efe :=pr .X ().SldSz ;_feae :=_fe .FromEMU (int64 (_efe .CxAttr ));_fb :=_fe .FromEMU (int64 (_efe .CyAttr ));_ebe :=_de .PageSize {_feae ,_fb };_bc :=_de .New ();_bc .SetPageSize (_ebe );var _ee *_bbd .Theme ;if len (pr .Themes ())> 0{_ee =pr .Themes ()[0];};for _ ,_ecb :=range pr .Slides (){if _ecb .X ()==nil {continue ;};_df :=&convertContext {_cbda :_bc ,_ccd :&_ecb ,_agf :_ecb .GetSlideLayout (),_fbbf :pr .SlideMasters ()[0].X (),_efca :pr ,_feeb :_ee ,_ddf :_ecb .X ().ClrMapOvr ,_dbac :_ebe [1],_gba :_ebe [0]};_df ._agf =_ecb .GetSlideLayout ();_df .extractDefaultProperties ();_df .makeSlide ();_df .drawSlide ();};return _bc ;};type background struct{_cfa _de .Color ;_dead float64 ;_ded *_bbd .CT_BlipFillProperties ;};var _eg =_gbdg (1.9);func (_cbce *textboxContext )assignPropsToCurrentParagraph (_bcafd *_bbd .CT_TextParagraphProperties ){_dbc :=12.4;if _bcafd ==nil {_cbce ._gbge ._bcdg =_dbc ;return ;};if _gaa :=_bcafd .DefRPr ;_gaa !=nil {_dfee :=_gaa .SzAttr ;if _dfee !=nil {_ecbad :=float64 (*_dfee )/1200;if _dbc <=_ecbad {_dbc =_ecbad ;};};};if _eagb :=_bcafd .MarLAttr ;_eagb !=nil {_cbce ._gbge ._gag =_fe .FromEMU (int64 (*_eagb ));};_cbce ._gbge ._fegb =_cbce ._gged ;if _fbdb :=_bcafd .MarRAttr ;_fbdb !=nil {_cbce ._gbge ._fegb -=_fe .FromEMU (int64 (*_fbdb ));};if _debf :=_bcafd .IndentAttr ;_debf !=nil {_cbce ._gbge ._ggf =_fe .FromEMU (int64 (*_debf ));};if _cbb :=_bcafd .LatinLnBrkAttr ;_cbb !=nil {_cbce ._gbge ._ffaa =*_cbb ;};if _dedg :=_bcafd .LnSpc ;_dedg !=nil {if _cgfaa :=_dedg .SpcPct ;_cgfaa !=nil {if _ccbf :=_cgfaa .ValAttr .ST_TextSpacingPercent ;_ccbf !=nil {_dbc =float64 (*_ccbf )/5000;};};};var _aec float64 ;if _egge :=_bcafd .SpcBef ;_egge !=nil {if _debc :=_egge .SpcPts ;_debc !=nil {_aec =float64 (_debc .ValAttr )/100;};};_edd :=_cbce ._gege ;if len (_edd )> 0{_aec -=_edd [len (_edd )-1]._agff ;if _aec < 0{_aec =0;};};_cbce ._gbge ._gffa =_aec ;if _cddg :=_bcafd .SpcAft ;_cddg !=nil {if _fgfe :=_cddg .SpcPts ;_fgfe !=nil {_cbce ._gbge ._agff =float64 (_fgfe .ValAttr )/100;};};_cbce ._gbge ._bcdg =_dbc ;_cbce ._gbge ._ddbf =_bcafd .AlgnAttr ;};func (_ceaa *convertContext )getShapes (_daf *_dcc .CT_Shape )[]_de .Drawable {_gfa :=[]_de .Drawable {};_acb :=_daf .SpPr ;if _acb ==nil {return _gfa ;};var _cef bool ;if _baa :=_daf .UseBgFillAttr ;_baa !=nil {_cef =*_baa ;};_cg ,_ccc ,_cde ,_bbb ,_ecdf ,_gccdc ,_adc :=_ceaa .getShapesFromSpPr (_acb ,_daf .Style ,_cef );_gfa =append (_gfa ,_cg ...);if _cgf :=_daf .TxBody ;_cgf !=nil {_gfc ,_fcf ,_dbe ,_fdd ,_aag :=_ceaa .getPhData (_daf );if _gfc !=nil &&!_adc {_ccc ,_cde ,_bbb ,_ecdf =_bb .GetDataFromXfrm (_gfc );};_edeg ,_eafb :=_ceaa .makePdfBlockFromTxBody (_cgf ,_fcf ,_dbe ,_bbb ,_ecdf ,_gccdc ,_fdd ,_aag );if _eafb !=nil {_ec .Log .Debug ("\u0043\u0061\u006e\u006e\u006f\u0074\u0020\u006d\u0061\u006b\u0065\u0020\u0050\u0044\u0046\u0020\u0062\u006c\u006f\u0063\u006b\u0020\u0066\u0072o\u006d\u0020\u0074\u0065\u0078t\u0062\u006fx\u003a\u0020\u0025\u0073",_eafb );}else if _edeg !=nil {_edeg .SetPos (_ccc ,_cde );_gfa =append (_gfa ,_edeg );};};return _gfa ;};func (_cbcg *textboxContext )addTextRun (_cacg *_bbd .EG_TextRun ,_eefd *_bbd .CT_TextCharacterProperties ,_bgbe _de .Color ,_adfa *prefixData ){if _ged :=_cacg .Br ;_ged !=nil {_cbcg .addCurrentWordToParagraph ();_cbcg .newLine ();_cbcg .newWord ();}else if _dfgd :=_cacg .R ;_dfgd !=nil {var _ffb _de .Color ;if _dfgd .RPr .SolidFill !=nil {_ffb ,_ =_cbcg ._cgfa .getColorFromSolidFill (_dfgd .RPr .SolidFill );}else if _bgbe !=nil {_ffb =_bgbe ;}else if _eefd .SolidFill !=nil {_ffb ,_ =_cbcg ._cgfa .getColorFromSolidFill (_eefd .SolidFill );}else {_ffb =_de .ColorBlack ;};_gead :=_ddd (_dfgd .RPr ,_eefd );_gbd ,_cefd ,_efbf ,_abcd :=_cbcg ._cgfa .makeStyleFromRPr (_gead );_gbd .Color =_ffb ;if _adfa !=nil {_cbcg .addPrefix (_adfa ,_gbd );};_eba :=_adef (_dfgd .T );for _ ,_faab :=range _eba {_faab ._fdga =_gbd ;_faab ._cgab =_cefd ;_faab ._fada =_efbf ;_faab ._eced =_abcd ;if _gead .CapAttr ==_bbd .ST_TextCapsTypeAll {_faab ._gfce =_f .ToUpper (_faab ._gfce );};_cbcg .addTextSymbol (_faab );};};};func (_dd *convertContext )makePdfBlockFromChart (_fd *_eb .Chart ,_gc ,_gcf float64 )(*_de .Block ,error ){_ca :=_fd .CT_RelId .IdAttr ;_gb :=_dd ._ccd .GetChartSpaceByRelId (_ca );if _gb ==nil {return nil ,_e .New ("\u004e\u006f\u0020\u0063\u0068\u0061\u0072\u0074\u0073\u0070\u0061\u0063\u0065");};var _efb *_bbd .Theme ;_dbf :=_dd ._efca .Themes ();if len (_dbf )> 0{_efb =_dbf [0];};return _bb .MakeBlockFromChartSpace (_gb ,_gc ,_gcf ,_efb );};func (_gedb *line )moveRight (_ffae float64 ){for _ ,_adeb :=range _gedb ._ebbea {_adeb ._begb +=_ffae ;};};func (_fcg *convertContext )getShapesFromSpPr (_edf *_bbd .CT_ShapeProperties ,_ge *_bbd .CT_ShapeStyle ,_ebfg bool )([]_de .Drawable ,float64 ,float64 ,float64 ,float64 ,_de .Color ,bool ){_bab :=[]_de .Drawable {};var _dcg ,_cbe ,_ffa ,_cbg ,_adcd float64 ;var _edfg ,_gabg ,_gca ,_bgad _de .Color ;var _caaa *_bbd .CT_BlipFillProperties ;_bgb ,_cdde :=1.0,1.0;if _ge !=nil {_edfg ,_gabg ,_bgad =_fcg .getStyleColors (_ge );};if _cfd :=_edf .Ln ;_cfd !=nil {if _cfd .NoFill !=nil {_gca ,_adcd =nil ,0;}else {_gca ,_adcd ,_bgb =_fcg .getInfoFromLn (_cfd );if _gca ==nil {_gca =_bgad ;};};};if _edf .NoFill !=nil {_gabg ,_cdde =nil ,0;}else if _ebfg {_gabg =_fcg ._fac ._cfa ;_cdde =_fcg ._fac ._dead ;_caaa =_fcg ._fac ._ded ;}else if _bgf :=_edf .SolidFill ;_bgf !=nil {_gabg ,_cdde =_fcg .getColorFromSolidFill (_bgf );};var _abf bool ;if _bef :=_edf .Xfrm ;_bef !=nil {_dcg ,_cbe ,_ffa ,_cbg =_bb .GetDataFromXfrm (_bef );_abf =true ;};if _deg :=_edf .CustGeom ;_deg !=nil {_bba :=[]_g .Point {};_dce ,_acg :=1.0,1.0;if _gbe :=_deg .PathLst ;_gbe !=nil {for _ ,_cebd :=range _gbe .Path {if _cebd !=nil {if _dab :=_cebd .WAttr ;_dab !=nil {_dce =_ffa /_fe .FromEMU (*_dab );};if _ebg :=_cebd .HAttr ;_ebg !=nil {_acg =_cbg /_fe .FromEMU (*_ebg );};for _ ,_ffe :=range _cebd .Close {if _ffe !=nil {};};for _ ,_bff :=range _cebd .MoveTo {if _bff !=nil &&_bff .Pt !=nil {_acd ,_gade :=_dffb (_bff .Pt );_bba =append (_bba ,_g .Point {X :_acd *_dce +_dcg ,Y :_gade *_acg +_cbe });};};for _ ,_bfd :=range _cebd .LnTo {if _bfd !=nil &&_bfd .Pt !=nil {_fefb ,_gde :=_dffb (_bfd .Pt );_bba =append (_bba ,_g .Point {X :_fefb *_dce +_dcg ,Y :_gde *_acg +_cbe });};};_baac :=_fcg ._cbda .NewPolygon ([][]_g .Point {_bba });_baac .SetFillColor (_gabg );_baac .SetFillOpacity (_cdde );_baac .SetBorderWidth (_adcd );if _gca !=nil {_baac .SetBorderColor (_gca );_baac .SetBorderOpacity (_bgb );};_bab =append (_bab ,_baac );};};};};if _dbfg :=_edf .PrstGeom ;_dbfg !=nil {switch _dbfg .PrstAttr {case _bbd .ST_ShapeTypeRect :if _caaa !=nil {_gg :=_fcg .getShapeFromBlipFill (_caaa ,_dcg ,_cbe ,_ffa ,_cbg );_bab =append (_bab ,_gg );}else {_bda :=_fcg ._cbda .NewRectangle (_dcg ,_cbe ,_ffa ,_cbg );_bda .SetFillColor (_gabg );_bda .SetFillOpacity (_cdde );_bda .SetBorderWidth (_adcd );if _gca !=nil {_bda .SetBorderColor (_gca );_bda .SetBorderOpacity (_bgb );};_bab =append (_bab ,_bda );};case _bbd .ST_ShapeTypeLine :_cae :=_fcg ._cbda .NewLine (_dcg ,_cbe ,_dcg +_ffa ,_cbe +_cbg );_cae .SetLineWidth (_adcd );if _gca !=nil {_cae .SetColor (_gca );};_bab =append (_bab ,_cae );};};return _bab ,_dcg ,_cbe ,_ffa ,_cbg ,_edfg ,_abf ;};func (_fcag *convertContext )makePdfBlockFromTable (_cfg *_bbd .Tbl ,_dag float64 )*_de .Table {_ebgb :=_cfg .TblGrid ;if _ebgb ==nil {return nil ;};_abea :=len (_ebgb .GridCol );if _abea ==0{return nil ;};_dbfb :=[]float64 {};_caf :=0.0;for _ ,_ead :=range _ebgb .GridCol {_baf :=_fe .FromEMU (_bb .FromSTCoordinate (_ead .WAttr ));_dbfb =append (_dbfb ,_baf );_caf +=_baf ;};_aggd :=[]float64 {};for _cca :=0;_cca < _abea ;_cca ++{_aggd =append (_aggd ,_dbfb [_cca ]/_caf );};_gge :=_fcag ._cbda .NewTable (_abea );_gge .SetColumnWidths (_aggd ...);_fae :=_cfg .TblPr ;var _abda *_bbd .CT_TableStyle ;if _afg :=_fae .Choice ;_afg !=nil {if _afg .TableStyle !=nil {_abda =_afg .TableStyle ;}else if _afg .TableStyleId !=nil {_abda =_fcag ._efca .GetTableStyleById (*_afg .TableStyleId );};};_dcea :=_bbd .NewCT_TablePartStyle ();_dcea .TcStyle =_bbd .NewCT_TableStyleCellStyle ();_dcea .TcTxStyle =_bbd .NewCT_TableStyleTextStyle ();if _abda !=nil {if _abda .WholeTbl !=nil {*_dcea =*_abda .WholeTbl ;};if _abda .TblBg !=nil {if _dcea .TcStyle .Fill ==nil {_dcea .TcStyle .Fill =_abda .TblBg .Fill ;};};};if _dcea .TcStyle .Fill ==nil {_dcea .TcStyle .Fill =_bbd .NewCT_FillProperties ();_dcea .TcStyle .Fill .NoFill =_fae .NoFill ;_dcea .TcStyle .Fill .SolidFill =_fae .SolidFill ;};_dbb :=len (_cfg .Tr );for _bdag ,_bbca :=range _cfg .Tr {_cab :=_bdag ==0;_fdc :=_bdag ==_dbb -1;_eac :=_bdag %2==0;_bbbc :=len (_bbca .Tc );var _ecg *_bbd .CT_TablePartStyle ;if _cab {_ecg =_abda .FirstRow ;}else if _eac {_ecg =_abda .Band2H ;}else {_ecg =_abda .Band1H ;};var _fba float64 ;for _cfe ,_ffd :=range _bbca .Tc {_eec :=_cfe ==0;_eag :=_cfe ==_bbbc -1;_gded :=_cfe %2==0;var _ecdg *_bbd .CT_TablePartStyle ;if _eec {_ecdg =_abda .FirstCol ;}else if _gded {_ecdg =_abda .Band2V ;}else {_ecdg =_abda .Band1V ;};_cge :=_gffc (_gffc (_ecdg ,_ecg ),_dcea );_fcgf :=_fcag .addCellToTable (_gge ,_ffd ,_cge ,_dag *_aggd [_cfe ],_cab ,_fdc ,_eec ,_eag );if _fcgf > _fba {_fba =_fcgf ;};};_gbeb :=_fe .FromEMU (_bb .FromSTCoordinate (_bbca .HAttr ));if _gbeb < _fba {_gbeb =_fba ;};if _gbeb < _gbdg (4){_gbeb =_gbdg (4);};_gge .SetRowHeight (_gge .CurRow (),_gbeb );};return _gge ;};func (_becc *textboxContext )addPrefix (_cgg *prefixData ,_afcf *_de .TextStyle ){_fbdf :=_adef (_cgg ._ccf );_ggdcc :=*_afcf ;if _cgg ._bac {_ggdcc .Font =_bb .AssignStdFontByName (_ggdcc ,"\u0053\u0079\u006d\u0062\u006f\u006c");};for _ ,_cdcf :=range _fbdf {_cdcf ._fdga =&_ggdcc ;_becc .addTextSymbol (_cdcf );};_beagb :=-(_cgg ._ecge +_becc ._bgbc ._age );if _beagb < 0{_beagb =0;};_dfeg :=&symbol {_gfce :"\u0020",_fgf :_beagb };_becc .addTextSymbol (_dfeg );_becc ._bgbc ._begb +=(_cgg ._ecge +_cgg ._deb );};func _gaf (_ddaf int ,_bbaa bool )string {_gfff :=_db .NewBuffer ([]byte {});for _ ,_bgagb :=range _cefe {for {if _ddaf < _bgagb ._dfgf {break ;};_gfff .WriteString (_bgagb ._gaca );_ddaf -=_bgagb ._dfgf ;};};_bcaf :=_gfff .String ();if _bbaa {_bcaf =_f .ToUpper (_bcaf );};return _bcaf ;};func _ffee (_fccg int ,_gabf bool )string {_ggea :=(_fccg -1)/26+1;_bbac :=byte ((_fccg -1)%26);if _gabf {_bbac +=byte (65);}else {_bbac +=byte (97);};_bcdb :=_db .NewBuffer ([]byte {});for _ecfc :=0;_ecfc < _ggea ;_ecfc ++{_bcdb .Write ([]byte {_bbac });};return _bcdb .String ();};func (_ecde *convertContext )renderCurrentStateToGoImage ()(_dc .Image ,error ){_ddag :=_bb .MakeTempCreator (_ecde ._gba ,_ecde ._dbac );_ddag .NewPage ();for _ ,_ffdfe :=range _ecde ._ddcf {if _ffdfe !=nil {_ddag .MoveTo (0,0);_ddag .Draw (_ffdfe );};};_dfcd ,_bgcg :=_bb .GetPageFromCreator (_ddag );if _bgcg !=nil {return nil ,_bgcg ;};return _fea .NewImageDevice ().Render (_dfcd );};func (_dbba *convertContext )getInfoFromLn (_fccge *_bbd .CT_LineProperties )(_de .Color ,float64 ,float64 ){if _fccge ==nil ||_fccge .NoFill !=nil {return nil ,0,0;};var _ccgaf float64 ;_dbca ,_eeb :=_dbba .getColorFromSolidFill (_fccge .SolidFill );if _ffbf :=_fccge .WAttr ;_ffbf !=nil {_ccgaf =_fe .FromEMU (int64 (*_ffbf ));}else {_ccgaf =1;};return _dbca ,_ccgaf ,_eeb ;};type romanMatch struct{_dfgf int ;_gaca string ;};func _aeff (_dde *_dcc .CT_Shape )(_dcc .ST_PlaceholderType ,*uint32 ){if _fgdc :=_dde .NvSpPr ;_fgdc !=nil {if _bbf :=_fgdc .NvPr ;_bbf !=nil {if _gefb :=_bbf .Ph ;_gefb !=nil {return _gefb .TypeAttr ,_gefb .IdxAttr ;};};};return _dcc .ST_PlaceholderTypeUnset ,nil ;};var _cefe =[]romanMatch {romanMatch {1000,"\u006d"},romanMatch {900,"\u0063\u006d"},romanMatch {500,"\u0064"},romanMatch {400,"\u0063\u0064"},romanMatch {100,"\u0063"},romanMatch {90,"\u0078\u0063"},romanMatch {50,"\u006c"},romanMatch {40,"\u0078\u006c"},romanMatch {10,"\u0078"},romanMatch {9,"\u0069\u0078"},romanMatch {5,"\u0076"},romanMatch {4,"\u0069\u0076"},romanMatch {1,"\u0069"}};func (_cddc *convertContext )getShapeFromBlipFill (_agge *_bbd .CT_BlipFillProperties ,_gefd ,_fddd ,_bge ,_bed float64 )_de .Drawable {_aged ,_aaf ,_ecgg :=_cddc .makePdfImageFromBlipFill (_agge );if _ecgg !=nil {_ec .Log .Debug ("\u0043\u0061\u006e\u006e\u006f\u0074\u0020\u006d\u0061\u006b\u0065\u0020\u0050D\u0046\u0020\u0069\u006d\u0061\u0067e\u0020\u0066\u0072\u006f\u006d\u0020\u0042\u006c\u0069\u0070\u0046\u0069\u006cl\u003a\u0020\u0025\u0073",_ecgg );return nil ;};if _aged ==nil {return nil ;};if _dcbg :=_agge .Tile ;_dcbg !=nil {_aged =_cddc .tileImage (_aged ,_agge .Tile ,_bge ,_bed );};if _caaf :=_agge .Stretch ;_caaf !=nil {_aged ,_gefd ,_fddd =_cddc .stretchImage (_aged ,_agge .Stretch ,_gefd ,_fddd ,_bge ,_bed );};if len (_aaf )==0{_aged .SetPos (_gefd ,_fddd );return _aged ;};_aged =_cddc .applyBlipEffectsOnImg (_aged ,_gefd ,_fddd ,_aaf );_aged .SetPos (_gefd ,_fddd );return _aged ;};func _gffc (_bafe ,_cgafd *_bbd .CT_TablePartStyle )*_bbd .CT_TablePartStyle {_eade :=_bbd .NewCT_TablePartStyle ();if _bafe !=nil {*_eade =*_bafe ;};if _cgafd ==nil {return _eade ;};if _eade .TcTxStyle ==nil {_eade .TcTxStyle =_cgafd .TcTxStyle ;}else {_eade .TcTxStyle =_eaea (_eade .TcTxStyle ,_cgafd .TcTxStyle );};if _eade .TcStyle ==nil {_eade .TcStyle =_cgafd .TcStyle ;}else {_eade .TcStyle =_eggd (_eade .TcStyle ,_cgafd .TcStyle );};return _eade ;};func (_bfga *convertContext )getColorFromMatrixReference (_eccg *_bbd .CT_StyleMatrixReference )_de .Color {if _eccg ==nil {return nil ;};var _baba _de .Color ;var _feaa string ;if _ccaf :=_eccg .SrgbClr ;_ccaf !=nil {_feaa =_ccaf .ValAttr ;}else if _dcbb :=_eccg .SchemeClr ;_dcbb !=nil {_feaa =_bb .GetColorStringFromDmlColor (_bfga ._efca .GetColorBySchemeColor (_dcbb .ValAttr ));_feaa =_bb .AdjustColor (_feaa ,_dcbb .EG_ColorTransform );};if _feaa !=""{_baba =_de .ColorRGBFromHex ("\u0023"+_feaa );};return _baba ;};func _gbdg (_gdae float64 )float64 {return _gdae *_fe .Millimeter };func (_cbed *textboxContext )drawParagraphs (){_cbed ._beg .NewPage ();for _ ,_dfeae :=range _cbed ._gege {for _ ,_ddbfg :=range _dfeae ._ebbe {for _ ,_dae :=range _ddbfg ._ebbea {for _ ,_gbgg :=range _dae ._bfc {_aea :=_cbed ._beg .NewStyledParagraph ();if _gbgg ._cgab {_gbgg ._cdce =0;}else if _gbgg ._fada {_gbgg ._cdce =1.2*_ddbfg ._ecc -_gbgg ._decd ;};_fgcb :=_dae ._begb +_gbgg ._bcc ;_bdfe :=_dfeae ._aef +_ddbfg ._acac +_gbgg ._cdce ;_aea .SetPos (_fgcb ,_bdfe );_ggc :=_aea .Append (_gbgg ._gfce );if _gbgg ._fdga !=nil {_ggc .Style =*_gbgg ._fdga ;};_cbed ._beg .Draw (_aea );if _gbgg ._eced {_cgaf :=_bdfe +_gbgg ._decd +2;_bb .DrawLine (_cbed ._beg ,_fgcb ,_cgaf ,_fgcb +_gbgg ._fgf ,_cgaf ,1,_gbgg ._fdga .Color );};};};};};};func (_egf *convertContext )makeStyleFromRPr (_bfda *_bbd .CT_TextCharacterProperties )(*_de .TextStyle ,bool ,bool ,bool ){var _eefa ,_bbbe ,_cgb bool ;_fbb :=_egf ._cbda .NewTextStyle ();if _bfda !=nil {_gfca :=_bb .FontStyle_Regular ;_gegd :=_aeea (_bfda .BAttr );_afd :=_aeea (_bfda .IAttr );if _gegd &&_afd {_gfca =_bb .FontStyle_BoldItalic ;}else if _gegd {_gfca =_bb .FontStyle_Bold ;}else if _afd {_gfca =_bb .FontStyle_Italic ;};_cgb =_bfda .UAttr !=_bbd .ST_TextUnderlineTypeUnset &&_bfda .UAttr !=_bbd .ST_TextUnderlineTypeNone ;_bde :="\u0064e\u0066\u0061\u0075\u006c\u0074";if _cbd :=_bfda .Latin ;_cbd !=nil {_bde =_cbd .TypefaceAttr ;}else if _bfaa :=_bfda .Ea ;_bfaa !=nil {_bde =_bfaa .TypefaceAttr ;}else if _dbg :=_bfda .Cs ;_dbg !=nil {_bde =_dbg .TypefaceAttr ;}else if _ceaag :=_bfda .Sym ;_ceaag !=nil {_bde =_ceaag .TypefaceAttr ;};if _ecf ,_bdf :=_bb .StdFontsMap [_bde ];_bdf {_fbb .Font =_bb .AssignStdFontByName (_fbb ,_ecf [_gfca ]);}else if _dff :=_bb .GetRegisteredFont (_bde ,_gfca );_dff !=nil {_fbb .Font =_dff ;}else {_ec .Log .Debug ("\u0046\u006f\u006e\u0074\u0020\u0025\u0073\u0020\u0077\u0069\u0074h\u0020\u0073\u0074\u0079\u006c\u0065\u0020\u0025s\u0020i\u0073\u0020\u006e\u006f\u0074\u0020\u0066\u006f\u0075\u006e\u0064\u002c\u0020\u0072\u0065\u0073\u0065\u0074 \u0074\u006f\u0020\u0064\u0065\u0066\u0061\u0075\u006c\u0074\u002e",_bde ,_gfca );_fbb .Font =_bb .AssignStdFontByName (_fbb ,_bb .StdFontsMap ["\u0064e\u0066\u0061\u0075\u006c\u0074"][_gfca ]);};var _gga float64 ;if _cecg :=_bfda .SzAttr ;_cecg !=nil {_gga =float64 (*_cecg )/100;}else {_gga =_bb .DefaultFontSize ;};if _gbeg :=_bfda .BaselineAttr ;_gbeg !=nil {if _aaef :=_gbeg .ST_PercentageDecimal ;_aaef !=nil {if *_aaef > 0{_eefa =true ;}else if *_aaef < 0{_bbbe =true ;};};};if _eefa ||_bbbe {_gga *=0.64;};_fbb .FontSize =_gga ;_abc :=0.0;if _caee :=_bfda .SpcAttr ;_caee !=nil {if _eda :=_caee .ST_TextPointUnqualified ;_eda !=nil {_abc =float64 (*_eda )/100;};};_fbb .CharSpacing =_abc ;};return &_fbb ,_eefa ,_bbbe ,_cgb ;};func (_ecaa *convertContext )makePdfDivisionFromTxBody (_ccg *_bbd .CT_TextBody ,_ceab ,_geg float64 ,_gdc *_bbd .CT_TableStyleTextStyle )*_de .Division {_ece :=_ecaa ._cbda .NewDivision ();_gbg :=_ecaa ._afe ;_eff :=_bbd .ST_TextAnchoringTypeT ;if _fadf :=_ccg .BodyPr ;_fadf !=nil {if _ace :=_fadf .AnchorAttr ;_ace !=_bbd .ST_TextAnchoringTypeUnset {_eff =_fadf .AnchorAttr ;};};if _dabc :=_ccg .LstStyle ;_dabc !=nil {var _cee *_bbd .CT_TextParagraphProperties ;if _dabc .Lvl1pPr !=nil {_cee =_dabc .Lvl1pPr ;}else {_cee =_ecaa ._agcge [0];};_gbg =_fbed (_cee ,_fbed (_dabc .DefPPr ,_gbg ));};for _ ,_fgee :=range _ccg .P {if _fgee !=nil {_gef :=_ecaa ._cbda .NewStyledParagraph ();_cga :=_fbed (_fgee .PPr ,_gbg );_acc :=_ddd (_fgee .EndParaRPr ,_cga .DefRPr );if len (_fgee .EG_TextRun )==0{_gef .Append ("\u000a");_ece .Add (_gef );continue ;};for _ ,_fcd :=range _fgee .EG_TextRun {if _agcg :=_fcd .Br ;_agcg !=nil {_gef .Append ("\u000a");}else if _ddae :=_fcd .R ;_ddae !=nil {_caad :=_bfcg (_ddae .RPr ,_gdc );_caad =_ddd (_caad ,_acc );var _add _de .Color ;if _caad .SolidFill !=nil {_add ,_ =_ecaa .getColorFromSolidFill (_caad .SolidFill );}else {_add =_de .ColorBlack ;};_gfd ,_dgb ,_baaf ,_ :=_ecaa .makeStyleFromRPr (_caad );_gfd .Color =_add ;if _dgb {_gfd .TextRise =0.5;}else if _baaf {_gfd .TextRise =-0.5;};_cad :=_ddae .T ;if _caad .CapAttr ==_bbd .ST_TextCapsTypeAll {for _ ,_fee :=range _cad {_fee =[]rune (_f .ToUpper (string (_fee )))[0];};};_fca :=_gef .Append (_cad );_fca .Style =*_gfd ;};};_ =_eff ;_ece .Add (_gef );};};return _ece ;};func (_cd *convertContext )extractDefaultProperties (){_cac :=_cd ._efca .X ();_cf :=_cac .DefaultTextStyle ;var _a ,_fc ,_fg ,_bce ,_ff ,_ce ,_ffg ,_ecd ,_eef ,_aa *_bbd .CT_TextParagraphProperties ;if _cf !=nil {_a =_cf .DefPPr ;_fc =_fbed (_cf .Lvl1pPr ,_a );_fg =_fbed (_cf .Lvl2pPr ,_a );_bce =_fbed (_cf .Lvl3pPr ,_a );_ff =_fbed (_cf .Lvl4pPr ,_a );_ce =_fbed (_cf .Lvl5pPr ,_a );_ffg =_fbed (_cf .Lvl6pPr ,_a );_ecd =_fbed (_cf .Lvl7pPr ,_a );_eef =_fbed (_cf .Lvl8pPr ,_a );_aa =_fbed (_cf .Lvl9pPr ,_a );_cd ._afe =_a ;_cd ._gdeae =_a .DefRPr ;};_cd ._agcge =make ([]*_bbd .CT_TextParagraphProperties ,9);_cd ._agcge [0]=_fc ;_cd ._agcge [1]=_fg ;_cd ._agcge [2]=_bce ;_cd ._agcge [3]=_ff ;_cd ._agcge [4]=_ce ;_cd ._agcge [5]=_ffg ;_cd ._agcge [6]=_ecd ;_cd ._agcge [7]=_eef ;_cd ._agcge [8]=_aa ;_egb :=_cd ._efca .SlideMasters ()[0].X ();_cdc :=_egb .TxStyles ;_ac :=_cdc .TitleStyle ;_cd ._efde =_fbed (_ac .DefPPr ,_a );_cd ._baad =_cd ._efde .DefRPr ;_cd ._fbae =make ([]*_bbd .CT_TextParagraphProperties ,9);_cd ._fbae [0]=_fbed (_ac .Lvl1pPr ,_fc );_cd ._fbae [1]=_fbed (_ac .Lvl2pPr ,_fg );_cd ._fbae [2]=_fbed (_ac .Lvl3pPr ,_bce );_cd ._fbae [3]=_fbed (_ac .Lvl4pPr ,_ff );_cd ._fbae [4]=_fbed (_ac .Lvl5pPr ,_ce );_cd ._fbae [5]=_fbed (_ac .Lvl6pPr ,_ffg );_cd ._fbae [6]=_fbed (_ac .Lvl7pPr ,_ecd );_cd ._fbae [7]=_fbed (_ac .Lvl8pPr ,_eef );_cd ._fbae [8]=_fbed (_ac .Lvl9pPr ,_aa );_ag :=_cdc .BodyStyle ;_cd ._dfef =_fbed (_ag .DefPPr ,_a );_cd ._fcb =_cd ._dfef .DefRPr ;_cd ._dfbe =make ([]*_bbd .CT_TextParagraphProperties ,9);_cd ._dfbe [0]=_fbed (_ag .Lvl1pPr ,_fc );_cd ._dfbe [1]=_fbed (_ag .Lvl2pPr ,_fg );_cd ._dfbe [2]=_fbed (_ag .Lvl3pPr ,_bce );_cd ._dfbe [3]=_fbed (_ag .Lvl4pPr ,_ff );_cd ._dfbe [4]=_fbed (_ag .Lvl5pPr ,_ce );_cd ._dfbe [5]=_fbed (_ag .Lvl6pPr ,_ffg );_cd ._dfbe [6]=_fbed (_ag .Lvl7pPr ,_ecd );_cd ._dfbe [7]=_fbed (_ag .Lvl8pPr ,_eef );_cd ._dfbe [8]=_fbed (_ag .Lvl9pPr ,_aa );};func (_gae *textboxContext )adjustHeights (_baae float64 ){if _gae ._ebeb ._ecc < _baae {_gae ._gbge ._gbc +=(_baae -_gae ._ebeb ._ecc );_gae ._ebeb ._ecc =_baae ;};};func (_bcag *textboxContext )newWord (){_bcag ._bgbc =&word {_ecba :true ,_begb :_bcag ._ebeb ._ggdc }};type symbolStyle struct{_bgbg *string ;_adca *float64 ;_cabbe *string ;_gbcc *bool ;_ega *bool ;_efed *bool ;_fbcd *bool ;_bffc *bool ;};func (_gacf *convertContext )getColorFromFontReference (_cega *_bbd .CT_FontReference )_de .Color {var _geff _de .Color ;var _efeb string ;if _gfcf :=_cega .SrgbClr ;_gfcf !=nil {_efeb =_gfcf .ValAttr ;}else if _aeb :=_cega .SchemeClr ;_aeb !=nil {_efeb =_bb .GetColorStringFromDmlColor (_gacf ._efca .GetColorBySchemeColor (_aeb .ValAttr ));_efeb =_bb .AdjustColor (_efeb ,_aeb .EG_ColorTransform );};if _efeb !=""{_geff =_de .ColorRGBFromHex ("\u0023"+_efeb );};return _geff ;};func (_cfc *convertContext )getConnectors (_feab *_dcc .CT_Connector )[]_de .Drawable {_fge ,_ ,_ ,_ ,_ ,_ ,_ :=_cfc .getShapesFromSpPr (_feab .SpPr ,_feab .Style ,false );return _fge ;};func (_abd *convertContext )makePdfBlockFromTxBody (_fdbc *_bbd .CT_TextBody ,_acgd *_bbd .CT_TextBodyProperties ,_aed *_bbd .CT_TextListStyle ,_fff ,_fgc float64 ,_dec _de .Color ,_eae ,_gabe bool )(*_de .Block ,error ){var _fgd *_bbd .CT_TextParagraphProperties ;if _beag :=_fdbc .LstStyle ;_beag !=nil {var _bgc *_bbd .CT_TextParagraphProperties ;if _beag .Lvl1pPr !=nil {_bgc =_beag .Lvl1pPr ;};_fgd =_fbed (_bgc ,_beag .DefPPr );};var _dea *_bbd .CT_TextParagraphProperties ;if _fgd !=nil {if _eae {_dea =_abd ._fbae [0];}else if _gabe {_dea =_abd ._dfbe [0];}else {_dea =_abd ._agcge [0];};if _aed !=nil {_dea =_fbed (_fbed (_aed .Lvl1pPr ,_aed .DefPPr ),_dea );};_dea =_fbed (_fgd ,_dea );}else {if _eae {_dea =_abd ._efde ;}else if _gabe {_dea =_abd ._dfef ;}else {_dea =_abd ._afe ;};};_cec ,_deeg :=_gbdg (2.5),_gbdg (2.5);_efdc ,_ddbb :=_gbdg (1.3),_gbdg (1.3);_fcdc :=true ;_ced :=_bbd .ST_TextAnchoringTypeT ;if _acgd !=nil {if _afc :=_acgd .AnchorAttr ;_afc !=_bbd .ST_TextAnchoringTypeUnset {_ced =_afc ;};};if _dac :=_fdbc .BodyPr ;_dac !=nil {if _ggg :=_dac .LInsAttr ;_ggg !=nil {_cec =_fe .FromEMU (_bb .FromSTCoordinate32 (*_ggg ));};if _fcc :=_dac .TInsAttr ;_fcc !=nil {_efdc =_fe .FromEMU (_bb .FromSTCoordinate32 (*_fcc ));};if _cffa :=_dac .RInsAttr ;_cffa !=nil {_deeg =_fe .FromEMU (_bb .FromSTCoordinate32 (*_cffa ));};if _ceef :=_dac .BInsAttr ;_ceef !=nil {_ddbb =_fe .FromEMU (_bb .FromSTCoordinate32 (*_ceef ));};_fcdc =_dac .WrapAttr !=_bbd .ST_TextWrappingTypeNone ;if _bgg :=_dac .AnchorAttr ;_bgg !=_bbd .ST_TextAnchoringTypeUnset {_ced =_dac .AnchorAttr ;};};_dad :=_bb .MakeTempCreator (_fff ,_fgc );_dad .SetPageMargins (_cec ,_deeg ,_efdc ,_ddbb );_gfdc :=&textboxContext {_cgfa :_abd ,_adee :_fcdc ,_gged :_fff -_cec -_deeg ,_fbga :_fgc -_efdc -_ddbb ,_beg :_dad ,_gege :[]*paragraph {}};_cbc :=1;for _ ,_aadg :=range _fdbc .P {if _aadg !=nil {_agbg :=_aadg .PPr ;var _dgad *prefixData ;if _agbg !=nil &&_agbg .BuNone ==nil {var _gadea string ;var _gfg bool ;if _bbcd :=_agbg .BuAutoNum ;_bbcd !=nil {var _dgcg string ;if _ebfc :=_bbcd .StartAtAttr ;_ebfc !=nil {_cbc =int (*_ebfc );};var _edee string ;switch _bbcd .TypeAttr {case _bbd .ST_TextAutonumberSchemeAlphaUcParenBoth ,_bbd .ST_TextAutonumberSchemeAlphaUcParenR ,_bbd .ST_TextAutonumberSchemeAlphaUcPeriod :_edee =_ffee (_cbc ,true );case _bbd .ST_TextAutonumberSchemeAlphaLcParenBoth ,_bbd .ST_TextAutonumberSchemeAlphaLcParenR ,_bbd .ST_TextAutonumberSchemeAlphaLcPeriod :_edee =_ffee (_cbc ,false );case _bbd .ST_TextAutonumberSchemeRomanUcParenBoth ,_bbd .ST_TextAutonumberSchemeRomanUcParenR ,_bbd .ST_TextAutonumberSchemeRomanUcPeriod :_edee =_gaf (_cbc ,true );case _bbd .ST_TextAutonumberSchemeRomanLcParenBoth ,_bbd .ST_TextAutonumberSchemeRomanLcParenR ,_bbd .ST_TextAutonumberSchemeRomanLcPeriod :_edee =_gaf (_cbc ,false );default:_edee =_c .Itoa (_cbc );};switch _bbcd .TypeAttr {case _bbd .ST_TextAutonumberSchemeAlphaLcPeriod ,_bbd .ST_TextAutonumberSchemeAlphaUcPeriod ,_bbd .ST_TextAutonumberSchemeArabicPeriod ,_bbd .ST_TextAutonumberSchemeRomanLcPeriod ,_bbd .ST_TextAutonumberSchemeRomanUcPeriod ,_bbd .ST_TextAutonumberSchemeArabicDbPeriod ,_bbd .ST_TextAutonumberSchemeEa1ChsPeriod ,_bbd .ST_TextAutonumberSchemeEa1ChtPeriod ,_bbd .ST_TextAutonumberSchemeEa1JpnChsDbPeriod ,_bbd .ST_TextAutonumberSchemeEa1JpnKorPeriod ,_bbd .ST_TextAutonumberSchemeThaiAlphaPeriod ,_bbd .ST_TextAutonumberSchemeThaiNumPeriod ,_bbd .ST_TextAutonumberSchemeHindiAlphaPeriod ,_bbd .ST_TextAutonumberSchemeHindiNumPeriod ,_bbd .ST_TextAutonumberSchemeHindiAlpha1Period :_dgcg ="\u002e";case _bbd .ST_TextAutonumberSchemeAlphaLcParenR ,_bbd .ST_TextAutonumberSchemeAlphaUcParenR ,_bbd .ST_TextAutonumberSchemeArabicParenR ,_bbd .ST_TextAutonumberSchemeRomanLcParenR ,_bbd .ST_TextAutonumberSchemeRomanUcParenR ,_bbd .ST_TextAutonumberSchemeThaiAlphaParenR ,_bbd .ST_TextAutonumberSchemeThaiNumParenR ,_bbd .ST_TextAutonumberSchemeHindiNumParenR :_dgcg ="\u0029";};_gadea =_edee +_dgcg ;_cbc ++;}else if _ddbbc :=_agbg .BuChar ;_ddbbc !=nil {_ffab :=_ddbbc .CharAttr ;if _ggd ,_aagg :=_ada [_ffab ];_aagg {_ffab =string (rune (_ggd ));}else {_ffab ="\u2022";};_gadea =_ffab ;_gfg =true ;};if _gadea !=""{var _gcda ,_gfdb float64 ;if _agbg .MarLAttr !=nil {_gcda =_fe .FromEMU (int64 (*_agbg .MarLAttr ));};if _agbg .IndentAttr !=nil {_gfdb =_fe .FromEMU (int64 (*_agbg .IndentAttr ));};_dgad =&prefixData {_ccf :_gadea ,_bac :_gfg ,_deb :_gcda ,_ecge :_gfdb };};};_agbg =_fbed (_agbg ,_dea );_beage :=_ddd (_aadg .EndParaRPr ,_agbg .DefRPr );_gfdc .newParagraph ();_gfdc .assignPropsToCurrentParagraph (_agbg );_gfdc .newLine ();_gfdc .newWord ();for _ecbbe ,_aaa :=range _aadg .EG_TextRun {_gfdc .addTextRun (_aaa ,_beage ,_dec ,_dgad );if _ecbbe > 0{_dgad =nil ;};};_gfdc .addCurrentWordToParagraph ();};_gfdc .addCurrentParagraph ();};_gfdc .alignVertically (_ced );_gfdc .drawParagraphs ();return _bb .MakeBlockFromCreator (_dad );};func (_ebd *convertContext )getStyleColors (_gfgc *_bbd .CT_ShapeStyle )(_de .Color ,_de .Color ,_de .Color ){var _eaec ,_bae ,_gcbc _de .Color ;if _fda :=_gfgc .LnRef ;_fda !=nil {_bae =_ebd .getColorFromMatrixReference (_fda );};if _gdaa :=_gfgc .FillRef ;_gdaa !=nil {_gcbc =_ebd .getColorFromMatrixReference (_gdaa );};if _cba :=_gfgc .FontRef ;_cba !=nil {_eaec =_ebd .getColorFromFontReference (_cba );};return _eaec ,_gcbc ,_bae ;};type line struct{_acac float64 ;_gcfc float64 ;_eadd float64 ;_ggdc float64 ;_ecc float64 ;_ebbea []*word ;};func (_dgg *textboxContext )newParagraph (){_abdaf :=&paragraph {};_abdaf ._aef =_dgg ._ggae ;_dgg ._gbge =_abdaf ;};

// FontStyle represents a kind of font styling. It can be FontStyle_Regular, FontStyle_Bold, FontStyle_Italic and FontStyle_BoldItalic.
type FontStyle =_bb .FontStyle ;

// RegisterFontsFromDirectory registers all fonts from the given directory automatically detecting font families and styles.
func RegisterFontsFromDirectory (dirName string )error {return _bb .RegisterFontsFromDirectory (dirName )};type convertContext struct{_cbda *_de .Creator ;_bcge *_bb .Rectangle ;_efca *_fa .Presentation ;_ccd *_fa .Slide ;_fbbf *_dcc .SldMaster ;_agf *_dcc .SldLayout ;_dbac float64 ;_gba float64 ;_ddcf []_de .Drawable ;_fac *background ;_afe *_bbd .CT_TextParagraphProperties ;_gdeae *_bbd .CT_TextCharacterProperties ;_efde *_bbd .CT_TextParagraphProperties ;_baad *_bbd .CT_TextCharacterProperties ;_dfef *_bbd .CT_TextParagraphProperties ;_fcb *_bbd .CT_TextCharacterProperties ;_agcge []*_bbd .CT_TextParagraphProperties ;_fbae []*_bbd .CT_TextParagraphProperties ;_dfbe []*_bbd .CT_TextParagraphProperties ;_feeb *_bbd .Theme ;_ddf *_bbd .CT_ColorMappingOverride ;};var _ada =map[string ]int32 {"\u0076":9830,"\u00d8":8594,"\u00fc":8730};const (FontStyle_Regular FontStyle =0;FontStyle_Bold FontStyle =1;FontStyle_Italic FontStyle =2;FontStyle_BoldItalic FontStyle =3;);func _bebf (_gegdb *_dcc .CT_CommonSlideData ,_cgc _dcc .ST_PlaceholderType ,_aefa *uint32 ,_abdf bool )(*_bbd .CT_Transform2D ,*_bbd .CT_TextBody ,*bool ,*bool ){if _gegdb !=nil &&(_cgc !=_dcc .ST_PlaceholderTypeUnset ||!_abdf ){if _abcf :=_gegdb .SpTree ;_abcf !=nil {for _ ,_dccbc :=range _abcf .Choice {if _dccbc !=nil {for _ ,_feb :=range _dccbc .Sp {if _feb !=nil {_gdead ,_bdb :=_aeff (_feb );if _cgc ==_gdead {if (_abdf &&_bdb ==nil )||(!_abdf &&_bdb !=nil &&*_bdb ==*_aefa ){var _bffg *_bbd .CT_Transform2D ;if _feb .SpPr !=nil {_bffg =_feb .SpPr .Xfrm ;};_bbeb :=_cgc ==_dcc .ST_PlaceholderTypeTitle ||_cgc ==_dcc .ST_PlaceholderTypeCtrTitle ;_afbg :=!_bbeb &&_cgc !=_dcc .ST_PlaceholderTypeUnset ;return _bffg ,_feb .TxBody ,&_bbeb ,&_afbg ;};};};};};};};};return nil ,nil ,nil ,nil ;};func _eggd (_bbbbc ,_fdbcg *_bbd .CT_TableStyleCellStyle )*_bbd .CT_TableStyleCellStyle {_fbaf :=_bbd .NewCT_TableStyleCellStyle ();if _bbbbc !=nil {*_fbaf =*_bbbbc ;};if _fdbcg ==nil {return _fbaf ;};if _fbaf .TcBdr ==nil {_fbaf .TcBdr =_fdbcg .TcBdr ;};if _fbaf .Fill ==nil {_fbaf .Fill =_fdbcg .Fill ;};if _fbaf .FillRef ==nil {_fbaf .FillRef =_fdbcg .FillRef ;};return _fbaf ;};type textboxContext struct{_cgfa *convertContext ;_gged float64 ;_fbga float64 ;_beg *_de .Creator ;_ggae float64 ;_gege []*paragraph ;_gbge *paragraph ;_ebeb *line ;_bgbc *word ;_adee bool ;};func (_bfg *textboxContext )addTextSymbol (_eaa *symbol ){_ebbfd :=_de .New ();_aecd :=_ebbfd .NewStyledParagraph ();_aecd .SetMargins (0,0,0,0);_cfef :=_aecd .Append (_eaa ._gfce );_acf :=0.0;if _eaa ._fdga !=nil {_cfef .Style =*_eaa ._fdga ;if _eaa ._fdga .CharSpacing !=0{_acf =_eaa ._fdga .CharSpacing ;};};_eaa ._decd =_aecd .Height ();_eaa ._cgdg =_aecd .Height ()*1.2;if _eaa ._cgdg < _bfg ._gbge ._bcdg {_eaa ._cgdg =_bfg ._gbge ._bcdg ;};if _eaa ._fgf ==0{_eaa ._fgf =_aecd .Width ()+_acf ;};if len (_bfg ._bgbc ._bfc )> 0{_bee :=_bfg ._bgbc ._bfc [len (_bfg ._bgbc ._bfc )-1]._gfce ;if _bfg ._gbge ._ffaa ||_bb .IsNoSpaceLanguage (_bee )||(_bee =="\u0020")!=(_eaa ._gfce =="\u0020"){_bfg .addCurrentWordToParagraph ();_bfg .newWord ();};};_bfg ._bgbc ._bfc =append (_bfg ._bgbc ._bfc ,_eaa );_eaa ._bcc =_bfg ._bgbc ._age ;_bfg ._bgbc ._age +=_eaa ._fgf ;if _eaa ._gfce !="\u0020"{_bfg ._bgbc ._ecba =false ;};};func (_bcg *convertContext )drawSlide (){_bcg ._cbda .NewPage ();for _ ,_bd :=range _bcg ._ddcf {if _bd !=nil {_bcg ._cbda .MoveTo (0,0);_bcg ._cbda .Draw (_bd );};};};func (_cdg *convertContext )stretchImage (_ade *_de .Image ,_ecbe *_bbd .CT_StretchInfoProperties ,_faae ,_aad ,_cc ,_cce float64 )(*_de .Image ,float64 ,float64 ){_gac :=_ecbe .FillRect ;if _gac ==nil {_fgag :=_ade .Width ()/_ade .Height ();_efce :=_cc /_cce ;var _abg ,_bca float64 ;if _fgag > _efce {_bca =_cce ;_abg =_cce *_fgag ;}else {_abg =_cc ;_bca =_cc /_fgag ;};_ade .Scale (_abg /_ade .Width (),_bca /_ade .Height ());return _ade ,_faae ,_aad ;};var _dcbe ,_dfe ,_fbg ,_efcf float64 ;if _gfee :=_gac .LAttr ;_gfee !=nil {_fbg =_bb .FromSTPercentage (_gfee );};if _cag :=_gac .TAttr ;_cag !=nil {_dcbe =_bb .FromSTPercentage (_cag );};if _ba :=_gac .RAttr ;_ba !=nil {_efcf =_bb .FromSTPercentage (_ba );};if _fbe :=_gac .BAttr ;_fbe !=nil {_dfe =_bb .FromSTPercentage (_fbe );};_dca :=_cc *(1-_fbg -_efcf );_fbec :=_cce *(1-_dcbe -_dfe );_ade .Scale (_dca /_ade .Width (),_fbec /_ade .Height ());return _ade ,_faae +_fbg *_cc ,_aad +_dcbe *_cce ;};func (_dcca *convertContext )getPhData (_bcdd *_dcc .CT_Shape )(*_bbd .CT_Transform2D ,*_bbd .CT_TextBodyProperties ,*_bbd .CT_TextListStyle ,bool ,bool ){_bbcc ,_fed :=_aeff (_bcdd );_gegb :=_fed ==nil ;_dgbc ,_gfaga ,_gfgcf ,_eab :=_bebf (_dcca ._fbbf .CSld ,_bbcc ,_fed ,_gegb );_fcdb ,_gaed ,_egcf ,_faec :=_bebf (_dcca ._agf .CSld ,_bbcc ,_fed ,_gegb );if _fcdb ==nil {_fcdb =_dgbc ;};_gefg ,_egag :=_efef (_gaed ,_gfaga );var _beed ,_bbbb bool ;if _egcf ==nil {if _gfgcf !=nil {_beed =*_gfgcf ;};}else {_beed =*_egcf ;};if _faec ==nil {if _eab !=nil {_bbbb =*_eab ;};}else {_bbbb =*_faec ;};return _fcdb ,_gefg ,_egag ,_beed ,_bbbb ;};func _adef (_feg string )[]*symbol {_befb :=[]*symbol {};for _ ,_abff :=range _feg {_befb =append (_befb ,&symbol {_gfce :string (_abff )});};return _befb ;};func _efef (_fafd ,_cbcc *_bbd .CT_TextBody )(*_bbd .CT_TextBodyProperties ,*_bbd .CT_TextListStyle ){if _fafd ==nil &&_cbcc ==nil {return nil ,nil ;};if _fafd ==nil {return _cbcc .BodyPr ,_cbcc .LstStyle ;};if _cbcc ==nil {return _fafd .BodyPr ,_fafd .LstStyle ;};_aga ,_ccda :=_fafd .BodyPr ,_fafd .LstStyle ;_gfcg ,_gedf :=_cbcc .BodyPr ,_cbcc .LstStyle ;_bcfd :=_ecaf (_aga ,_gfcg );_bfbc :=_bbg (_ccda ,_gedf );return _bcfd ,_bfbc ;};func _eaea (_agaa ,_dfdf *_bbd .CT_TableStyleTextStyle )*_bbd .CT_TableStyleTextStyle {_fdfe :=_bbd .NewCT_TableStyleTextStyle ();if _agaa !=nil {*_fdfe =*_agaa ;};if _dfdf ==nil {return _fdfe ;};if _fdfe .BAttr ==_bbd .ST_OnOffStyleTypeUnset {_fdfe .BAttr =_dfdf .BAttr ;};if _fdfe .IAttr ==_bbd .ST_OnOffStyleTypeUnset {_fdfe .IAttr =_dfdf .IAttr ;};if _fdfe .Font ==nil {_fdfe .Font =_dfdf .Font ;};if _fdfe .FontRef ==nil {_fdfe .FontRef =_dfdf .FontRef ;};if _fdfe .ScrgbClr ==nil {_fdfe .ScrgbClr =_dfdf .ScrgbClr ;};if _fdfe .SrgbClr ==nil {_fdfe .SrgbClr =_dfdf .SrgbClr ;};if _fdfe .HslClr ==nil {_fdfe .HslClr =_dfdf .HslClr ;};if _fdfe .SysClr ==nil {_fdfe .SysClr =_dfdf .SysClr ;};if _fdfe .SchemeClr ==nil {_fdfe .SchemeClr =_dfdf .SchemeClr ;};if _fdfe .PrstClr ==nil {_fdfe .PrstClr =_dfdf .PrstClr ;};return _fdfe ;};func (_dgcb *textboxContext )addCurrentParagraph (){_dgcb ._ggae =_dgcb ._gbge ._aef +_dgcb ._gbge ._gffa +_dgcb ._gbge ._gbc +_dgcb ._gbge ._agff ;_dgcb ._gege =append (_dgcb ._gege ,_dgcb ._gbge );_dgcb .alignParagraph ();};func (_bgba *convertContext )makePdfImageFromBlipFill (_cfad *_bbd .CT_BlipFillProperties )(*_de .Image ,[]*_bbd .CT_BlipChoice ,error ){if _gfba :=_cfad .Blip ;_gfba !=nil {if _ggac :=_gfba .EmbedAttr ;_ggac !=nil {_deegc ,_effa :=_bgba ._ccd .GetImageByRelID (*_ggac );if _effa {_gcb ,_cgbc :=_ef .Open (_deegc .Path ());if _cgbc !=nil {_ec .Log .Debug ("\u0046\u0069\u006c\u0065 o\u0070\u0065\u006e\u0020\u0065\u0072\u0072\u006f\u0072\u003a\u0020\u0025\u0073",_cgbc );return nil ,nil ,_cgbc ;};defer _gcb .Close ();_ceefa ,_ ,_cgbc :=_dc .Decode (_gcb );if _cgbc !=nil {_ec .Log .Debug ("\u0044\u0065\u0063\u006fde\u0020\u0069\u006d\u0061\u0067\u0065\u0020\u0065\u0072\u0072\u006f\u0072\u003a\u0020%\u0073",_cgbc );return nil ,nil ,_cgbc ;};if _bad :=_cfad .SrcRect ;_bad !=nil {_ecgf :=_ceefa .Bounds ().Size ();_gdd :=_ecgf .X ;_baag :=_ecgf .Y ;var _bcgef ,_daff ,_bfae ,_deac int ;var _ffdg bool ;if _badf :=_bad .LAttr ;_badf !=nil {_bcgef =int (float64 (_gdd )*_bb .FromSTPercentage (_badf ));_ffdg =true ;}else {_bcgef =0;};if _gbeba :=_bad .TAttr ;_gbeba !=nil {_bfae =int (float64 (_baag )*_bb .FromSTPercentage (_gbeba ));_ffdg =true ;}else {_bfae =0;};if _gedd :=_bad .RAttr ;_gedd !=nil {_daff =int (float64 (_gdd )*(1-_bb .FromSTPercentage (_gedd )));_ffdg =true ;}else {_daff =_gdd ;};if _efg :=_bad .BAttr ;_efg !=nil {_deac =int (float64 (_baag )*(1-_bb .FromSTPercentage (_efg )));_ffdg =true ;}else {_deac =_baag ;};if _ffdg {_ceefa =_bb .CropImageByRect (_ceefa ,_dc .Rect (_bcgef ,_bfae ,_daff +1,_deac +1));};};_afda ,_cgbc :=_bgba ._cbda .NewImageFromGoImage (_ceefa );if _cgbc !=nil {_ec .Log .Debug ("\u0043\u0061\u006e\u006e\u006ft\u0020\u0063\u0072\u0065\u0061\u0074\u0065\u0020\u0050\u0044\u0046\u0020\u0069m\u0061\u0067\u0065\u0020\u0066\u0072\u006f\u006d\u0020\u0047\u006f\u0020\u0069\u006d\u0061\u0067\u0065\u003a\u0020\u0025\u0073",_cgbc );return nil ,nil ,_cgbc ;};return _afda ,_gfba .Choice ,nil ;};};};return nil ,nil ,nil ;};func (_cggc *textboxContext )alignVertically (_dggf _bbd .ST_TextAnchoringType ){_cggc .alignParagraphsVertically (_dggf );_cggc .alignSymbolsVertically ();};

// RegisterFont makes a PdfFont accessible for using in converting to PDF.
func RegisterFont (name string ,style FontStyle ,font *_dg .PdfFont ){_bb .RegisterFont (name ,style ,font );};type symbol struct{_gfce string ;_bcc float64 ;_cgdg float64 ;_decd float64 ;_cdce float64 ;_fgf float64 ;_fdga *_de .TextStyle ;_bec string ;_cgab bool ;_fada bool ;_eced bool ;};func (_gbcf *textboxContext )newLine (){if _gbcf ._gbge ==nil {_gbcf .newParagraph ();};_abdc :=_gbcf ._gbge ._gbc +_gbcf ._gbge ._gffa ;_acgg :=&line {};_acgg ._gcfc =_gbcf ._gbge ._gag ;if len (_gbcf ._gbge ._ebbe )==0{_acgg ._gcfc +=_gbcf ._gbge ._ggf ;};_acgg ._eadd =_gbcf ._gbge ._fegb ;_acgg ._ggdc =_acgg ._gcfc ;_acgg ._acac =_abdc ;_gbcf ._gbge ._ebbe =append (_gbcf ._gbge ._ebbe ,_acgg );_gbcf ._ebeb =_acgg ;};func _aeea (_daa *bool )bool {return _daa !=nil &&*_daa };func (_ecbb *convertContext )makeSlide (){_bg :=_ecbb ._ccd .X ().CSld ;if _bg ==nil {return ;};_gd :=&background {};if _ab :=_bg .Bg ;_ab !=nil {if _fbc :=_ab .BgPr ;_fbc !=nil {if _fbc .NoFill ==nil {if _ed :=_fbc .SolidFill ;_ed !=nil {_dga ,_aae :=_ecbb .getColorFromSolidFill (_ed );if _dga !=nil {_gd ._cfa =_dga ;_gd ._dead =_aae ;};}else if _ddc :=_fbc .BlipFill ;_ddc !=nil {_gd ._ded =_ddc ;};};};};_ecbb ._fac =_gd ;if _fdg :=_bg .SpTree ;_fdg !=nil {for _ ,_ebf :=range _fdg .Choice {if _ebf !=nil {for _ ,_gf :=range _ebf .Sp {if _gf !=nil {_dfd :=_ecbb .getShapes (_gf );_ecbb ._ddcf =append (_ecbb ._ddcf ,_dfd ...);};};for _ ,_efd :=range _ebf .GraphicFrame {if _efd !=nil {var _efcd ,_ebfa ,_bcd ,_ga float64 ;if _aca :=_efd .Xfrm ;_aca !=nil {_efcd ,_ebfa ,_bcd ,_ga =_bb .GetDataFromXfrm (_aca );};if _caa :=_efd .Graphic ;_caa !=nil {if _gfb :=_caa .GraphicData ;_gfb !=nil {for _ ,_gcc :=range _gfb .Any {if _dee ,_gccd :=_gcc .(*_eb .Chart );_gccd {_dgc ,_bf :=_ecbb .makePdfBlockFromChart (_dee ,_bcd ,_ga );if _bf !=nil {_ec .Log .Debug ("C\u0061\u006e\u006e\u006ft \u0072e\u0061\u0064\u0020\u0062\u006co\u0063\u006b\u003a\u0020\u0025\u0073",_bf );};if _dgc !=nil {_dgc .SetPos (_efcd ,_ebfa );_ecbb ._ddcf =append (_ecbb ._ddcf ,_dgc );};}else if _abe ,_gad :=_gcc .(*_bbd .Tbl );_gad {_faa :=_ecbb .makePdfBlockFromTable (_abe ,_bcd );if _faa !=nil {_ad :=_de .NewBlock (_bcd ,_ga );_ad .SetPos (_efcd ,_ebfa );_ad .Draw (_faa );_ecbb ._ddcf =append (_ecbb ._ddcf ,_ad );};};};};};};};for _ ,_cb :=range _ebf .CxnSp {if _cb !=nil {_gbb :=_ecbb .getConnectors (_cb );_ecbb ._ddcf =append (_ecbb ._ddcf ,_gbb ...);};};for _ ,_agd :=range _ebf .Pic {if _agd !=nil {var _ceb ,_cdb ,_cdd ,_fef float64 ;if _eca :=_agd .SpPr ;_eca !=nil {if _bbe :=_eca .Xfrm ;_bbe !=nil {_ceb ,_cdb ,_cdd ,_fef =_bb .GetDataFromXfrm (_bbe );};};if _gab :=_agd .BlipFill ;_gab !=nil {_gcd :=_ecbb .getShapeFromBlipFill (_gab ,_ceb ,_cdb ,_cdd ,_fef );_ecbb ._ddcf =append (_ecbb ._ddcf ,_gcd );};};};};};};};func (_dcd *convertContext )addCellToTable (_fbgb *_de .Table ,_dbd *_bbd .CT_TableCell ,_cgd *_bbd .CT_TablePartStyle ,_dccb float64 ,_adcde ,_egg ,_eacc ,_dffd bool )float64 {var _aadd *_de .TableCell ;_bgd :=1;if _dbd .GridSpanAttr !=nil {_bgd =int (*_dbd .GridSpanAttr );};_aadd =_fbgb .MultiColCell (_bgd );_bcf :=_dbd .TcPr ;var _bgbd *_bbd .CT_TableStyleTextStyle ;if _cgd !=nil {_bcf =_aafe (_bcf ,_cgd .TcStyle ,_adcde ,_egg ,_eacc ,_dffd );_bgbd =_cgd .TcTxStyle ;};_cbgc :=_eg ;_bgdg :=_de .CellVerticalAlignmentMiddle ;if _bcf !=nil {if _dgbe :=_bcf .LnL ;_dgbe !=nil {_fdfg ,_decb ,_adb :=_dcd .getBorderStyle (_dgbe );_aadd .SetBorder (_de .CellBorderSideLeft ,_fdfg ,_adb );if _decb !=nil &&*_decb !=nil {_aadd .SetSideBorderColor (_de .CellBorderSideLeft ,*_decb );};};if _efbb :=_bcf .LnT ;_efbb !=nil {_gfcb ,_gccdf ,_cead :=_dcd .getBorderStyle (_efbb );_aadd .SetBorder (_de .CellBorderSideTop ,_gfcb ,_cead );if _gccdf !=nil &&*_gccdf !=nil {_aadd .SetSideBorderColor (_de .CellBorderSideTop ,*_gccdf );};};if _bbbef :=_bcf .LnR ;_bbbef !=nil {_gea ,_gcgf ,_aadc :=_dcd .getBorderStyle (_bbbef );_aadd .SetBorder (_de .CellBorderSideRight ,_gea ,_aadc );if _gcgf !=nil &&*_gcgf !=nil {_aadd .SetSideBorderColor (_de .CellBorderSideRight ,*_gcgf );};};if _bfdd :=_bcf .LnB ;_bfdd !=nil {_egfe ,_dfea ,_ebb :=_dcd .getBorderStyle (_bfdd );_aadd .SetBorder (_de .CellBorderSideBottom ,_egfe ,_ebb );if _dfea !=nil &&*_dfea !=nil {_aadd .SetSideBorderColor (_de .CellBorderSideBottom ,*_dfea );};};if _fdff :=_bcf .MarLAttr ;_fdff !=nil {_cbgc =float64 (_bb .FromSTCoordinate32 (*_fdff ));};switch _bcf .AnchorAttr {case _bbd .ST_TextAnchoringTypeT :_bgdg =_de .CellVerticalAlignmentTop ;case _bbd .ST_TextAnchoringTypeB :_bgdg =_de .CellVerticalAlignmentBottom ;};if _bcf .NoFill ==nil {if _ebbf :=_bcf .SolidFill ;_ebbf !=nil {_cabb ,_ :=_dcd .getColorFromSolidFill (_ebbf );_aadd .SetBackgroundColor (_cabb );};};};_aadd .SetVerticalAlignment (_bgdg );_aadd .SetIndent (_cbgc );var _aaag float64 ;if _fbd :=_dbd .TxBody ;_fbd !=nil {_eeeb :=_dcd .makePdfDivisionFromTxBody (_fbd ,_dccb ,_aaag ,_bgbd );_aaag =_eeeb .Height ();_aadd .SetContent (_eeeb );};return _aaag ;};func _fbed (_dfa ,_ddaa *_bbd .CT_TextParagraphProperties )*_bbd .CT_TextParagraphProperties {_gfag :=_bbd .NewCT_TextParagraphProperties ();if _dfa !=nil {*_gfag =*_dfa ;};if _ddaa ==nil {return _gfag ;};if _gfag .MarLAttr ==nil {_gfag .MarLAttr =_ddaa .MarLAttr ;};if _gfag .MarRAttr ==nil {_gfag .MarRAttr =_ddaa .MarRAttr ;};if _gfag .LvlAttr ==nil {_gfag .LvlAttr =_ddaa .LvlAttr ;};if _gfag .IndentAttr ==nil {_gfag .IndentAttr =_ddaa .IndentAttr ;};if _gfag .AlgnAttr ==_bbd .ST_TextAlignTypeUnset {_gfag .AlgnAttr =_ddaa .AlgnAttr ;};if _gfag .DefTabSzAttr ==nil {_gfag .DefTabSzAttr =_ddaa .DefTabSzAttr ;};if _gfag .RtlAttr ==nil {_gfag .RtlAttr =_ddaa .RtlAttr ;};if _gfag .EaLnBrkAttr ==nil {_gfag .EaLnBrkAttr =_ddaa .EaLnBrkAttr ;};if _gfag .FontAlgnAttr ==_bbd .ST_TextFontAlignTypeUnset {_gfag .FontAlgnAttr =_ddaa .FontAlgnAttr ;};if _gfag .LatinLnBrkAttr ==nil {_gfag .LatinLnBrkAttr =_ddaa .LatinLnBrkAttr ;};if _gfag .HangingPunctAttr ==nil {_gfag .HangingPunctAttr =_ddaa .HangingPunctAttr ;};if _gfag .LnSpc ==nil {_gfag .LnSpc =_ddaa .LnSpc ;};if _gfag .SpcBef ==nil {_gfag .SpcBef =_ddaa .SpcBef ;};if _gfag .SpcAft ==nil {_gfag .SpcAft =_ddaa .SpcAft ;};if _gfag .BuClrTx ==nil {_gfag .BuClrTx =_ddaa .BuClrTx ;};if _gfag .BuClr ==nil {_gfag .BuClr =_ddaa .BuClr ;};if _gfag .BuSzTx ==nil {_gfag .BuSzTx =_ddaa .BuSzTx ;};if _gfag .BuSzPct ==nil {_gfag .BuSzPct =_ddaa .BuSzPct ;};if _gfag .BuSzPts ==nil {_gfag .BuSzPts =_ddaa .BuSzPts ;};if _gfag .BuFontTx ==nil {_gfag .BuFontTx =_ddaa .BuFontTx ;};if _gfag .BuFont ==nil {_gfag .BuFont =_ddaa .BuFont ;};if _gfag .BuNone ==nil {_gfag .BuNone =_ddaa .BuNone ;};if _gfag .BuAutoNum ==nil {_gfag .BuAutoNum =_ddaa .BuAutoNum ;};if _gfag .BuChar ==nil {_gfag .BuChar =_ddaa .BuChar ;};if _gfag .BuBlip ==nil {_gfag .BuBlip =_ddaa .BuBlip ;};if _gfag .TabLst ==nil {_gfag .TabLst =_ddaa .TabLst ;};if _gfag .ExtLst ==nil {_gfag .ExtLst =_ddaa .ExtLst ;};_gfag .DefRPr =_ddd (_gfag .DefRPr ,_ddaa .DefRPr );return _gfag ;};type word struct{_bfc []*symbol ;_begb float64 ;_age float64 ;_ecba bool ;};func _dffb (_ffdf *_bbd .CT_AdjPoint2D )(float64 ,float64 ){var _gcdc ,_fbad float64 ;_ffc ,_acggd :=_ffdf .XAttr ,_ffdf .YAttr ;if _dfbf :=_ffc .ST_Coordinate ;_dfbf !=nil {_gcdc =_fe .FromEMU (_bb .FromSTCoordinate (*_dfbf ));};if _agda :=_acggd .ST_Coordinate ;_agda !=nil {_fbad =_fe .FromEMU (_bb .FromSTCoordinate (*_agda ));};return _gcdc ,_fbad ;};func _bfcg (_fgda *_bbd .CT_TextCharacterProperties ,_gacab *_bbd .CT_TableStyleTextStyle )*_bbd .CT_TextCharacterProperties {_abeg :=_bbd .NewCT_TextCharacterProperties ();if _fgda !=nil {*_abeg =*_fgda ;};if _gacab ==nil {return _abeg ;};if _abeg .BAttr ==nil &&_gacab .BAttr !=_bbd .ST_OnOffStyleTypeUnset {_geb :=_gacab .BAttr ==_bbd .ST_OnOffStyleTypeOn ;_abeg .BAttr =&_geb ;};if _abeg .IAttr ==nil &&_gacab .IAttr !=_bbd .ST_OnOffStyleTypeUnset {_fdbgg :=_gacab .IAttr ==_bbd .ST_OnOffStyleTypeOn ;_abeg .IAttr =&_fdbgg ;};if _abeg .NoFill ==nil &&_abeg .SolidFill ==nil {_abeg .SolidFill =_bbd .NewCT_SolidColorFillProperties ();_abeg .SolidFill .ScrgbClr =_gacab .ScrgbClr ;_abeg .SolidFill .SrgbClr =_gacab .SrgbClr ;_abeg .SolidFill .HslClr =_gacab .HslClr ;_abeg .SolidFill .SysClr =_gacab .SysClr ;_abeg .SolidFill .SchemeClr =_gacab .SchemeClr ;_abeg .SolidFill .PrstClr =_gacab .PrstClr ;};if _cacf :=_gacab .Font ;_cacf !=nil &&_abeg .Latin ==nil &&_abeg .Ea ==nil &&_abeg .Cs ==nil {_abeg .Latin =_cacf .Latin ;_abeg .Ea =_cacf .Ea ;_abeg .Cs =_cacf .Cs ;};return _abeg ;};func _bbg (_bfgd ,_fegbg *_bbd .CT_TextListStyle )*_bbd .CT_TextListStyle {_dabb :=_bbd .NewCT_TextListStyle ();if _bfgd !=nil {*_dabb =*_bfgd ;};if _fegbg ==nil {return _dabb ;};_dabb .DefPPr =_fbed (_dabb .DefPPr ,_fegbg .DefPPr );_dabb .Lvl1pPr =_fbed (_dabb .Lvl1pPr ,_fegbg .Lvl1pPr );_dabb .Lvl2pPr =_fbed (_dabb .Lvl2pPr ,_fegbg .Lvl2pPr );_dabb .Lvl3pPr =_fbed (_dabb .Lvl3pPr ,_fegbg .Lvl3pPr );_dabb .Lvl4pPr =_fbed (_dabb .Lvl4pPr ,_fegbg .Lvl4pPr );_dabb .Lvl5pPr =_fbed (_dabb .Lvl5pPr ,_fegbg .Lvl5pPr );_dabb .Lvl6pPr =_fbed (_dabb .Lvl6pPr ,_fegbg .Lvl6pPr );_dabb .Lvl7pPr =_fbed (_dabb .Lvl7pPr ,_fegbg .Lvl7pPr );_dabb .Lvl8pPr =_fbed (_dabb .Lvl8pPr ,_fegbg .Lvl8pPr );_dabb .Lvl9pPr =_fbed (_dabb .Lvl9pPr ,_fegbg .Lvl9pPr );return _dabb ;};func _ddd (_adg ,_gdad *_bbd .CT_TextCharacterProperties )*_bbd .CT_TextCharacterProperties {_cfeg :=_bbd .NewCT_TextCharacterProperties ();if _adg !=nil {*_cfeg =*_adg ;};if _gdad ==nil {return _cfeg ;};if _cfeg .KumimojiAttr ==nil {_cfeg .KumimojiAttr =_gdad .KumimojiAttr ;};if _cfeg .LangAttr ==nil {_cfeg .LangAttr =_gdad .LangAttr ;};if _cfeg .AltLangAttr ==nil {_cfeg .AltLangAttr =_gdad .AltLangAttr ;};if _cfeg .SzAttr ==nil {_cfeg .SzAttr =_gdad .SzAttr ;};if _cfeg .BAttr ==nil {_cfeg .BAttr =_gdad .BAttr ;};if _cfeg .IAttr ==nil {_cfeg .IAttr =_gdad .IAttr ;};if _cfeg .UAttr ==_bbd .ST_TextUnderlineTypeUnset {_cfeg .UAttr =_gdad .UAttr ;};if _cfeg .StrikeAttr ==_bbd .ST_TextStrikeTypeUnset {_cfeg .StrikeAttr =_gdad .StrikeAttr ;};if _cfeg .KernAttr ==nil {_cfeg .KernAttr =_gdad .KernAttr ;};if _cfeg .CapAttr ==_bbd .ST_TextCapsTypeUnset {_cfeg .CapAttr =_gdad .CapAttr ;};if _cfeg .SpcAttr ==nil {_cfeg .SpcAttr =_gdad .SpcAttr ;};if _cfeg .NormalizeHAttr ==nil {_cfeg .NormalizeHAttr =_gdad .NormalizeHAttr ;};if _cfeg .BaselineAttr ==nil {_cfeg .BaselineAttr =_gdad .BaselineAttr ;};if _cfeg .NoProofAttr ==nil {_cfeg .NoProofAttr =_gdad .NoProofAttr ;};if _cfeg .DirtyAttr ==nil {_cfeg .DirtyAttr =_gdad .DirtyAttr ;};if _cfeg .ErrAttr ==nil {_cfeg .ErrAttr =_gdad .ErrAttr ;};if _cfeg .SmtCleanAttr ==nil {_cfeg .SmtCleanAttr =_gdad .SmtCleanAttr ;};if _cfeg .SmtIdAttr ==nil {_cfeg .SmtIdAttr =_gdad .SmtIdAttr ;};if _cfeg .BmkAttr ==nil {_cfeg .BmkAttr =_gdad .BmkAttr ;};if _cfeg .Ln ==nil {_cfeg .Ln =_gdad .Ln ;};if _cfeg .NoFill ==nil {_cfeg .NoFill =_gdad .NoFill ;};if _cfeg .SolidFill ==nil {_cfeg .SolidFill =_gdad .SolidFill ;};if _cfeg .BlipFill ==nil {_cfeg .BlipFill =_gdad .BlipFill ;};if _cfeg .EffectLst ==nil {_cfeg .EffectLst =_gdad .EffectLst ;};if _cfeg .EffectDag ==nil {_cfeg .EffectDag =_gdad .EffectDag ;};if _cfeg .Highlight ==nil {_cfeg .Highlight =_gdad .Highlight ;};if _cfeg .ULnTx ==nil {_cfeg .ULnTx =_gdad .ULnTx ;};if _cfeg .ULn ==nil {_cfeg .ULn =_gdad .ULn ;};if _cfeg .UFillTx ==nil {_cfeg .UFillTx =_gdad .UFillTx ;};if _cfeg .UFill ==nil {_cfeg .UFill =_gdad .UFill ;};if _cfeg .Latin ==nil {_cfeg .Latin =_gdad .Latin ;};if _cfeg .Ea ==nil {_cfeg .Ea =_gdad .Ea ;};if _cfeg .Cs ==nil {_cfeg .Cs =_gdad .Cs ;};if _cfeg .Sym ==nil {_cfeg .Sym =_gdad .Sym ;};if _cfeg .Rtl ==nil {_cfeg .Rtl =_gdad .Rtl ;};return _cfeg ;};func (_gdb *convertContext )getBorderStyle (_ccb *_bbd .CT_LineProperties )(_de .CellBorderStyle ,*_de .Color ,float64 ){if _ccb ==nil ||_ccb .NoFill !=nil {return _de .CellBorderStyleNone ,nil ,0;};var _ddg _de .Color ;if _ffed :=_ccb .SolidFill ;_ffed !=nil {_ddg ,_ =_gdb .getColorFromSolidFill (_ffed );};_efbc :=0.0;if _fddb :=_ccb .WAttr ;_fddb !=nil {_efbc =_fe .FromEMU (int64 (*_fddb ));};return _de .CellBorderStyleSingle ,&_ddg ,_efbc ;};func (_ecafb *convertContext )applyBlipEffectsOnImg (_adfg *_de .Image ,_bgca ,_bacd float64 ,_eeed []*_bbd .CT_BlipChoice )*_de .Image {if len (_eeed )==0{return _adfg ;};_adfg .SetPos (_bgca ,_bacd );_gabc ,_ebfbg :=_ecafb .renderPageWithDrawableToGoImage (_adfg );if _ebfbg !=nil {_ec .Log .Debug ("\u0045\u0072\u0072\u006f\u0072\u0020\u0072\u0065\u006e\u0064\u0065\u0072\u0020a\u006e\u0020\u0069\u006d\u0061\u0067e\u0020\u0074\u006f\u0020\u0061\u0020\u0047\u006f\u0020\u0069\u006d\u0061\u0067e\u003a\u0020\u0025\u0073",_ebfbg );return _adfg ;};_facb ,_ebfbg :=_ecafb .renderCurrentStateToGoImage ();if _ebfbg !=nil {_ec .Log .Debug ("\u0045\u0072\u0072\u006f\u0072\u0020\u0072\u0065n\u0064\u0065\u0072 t\u0068\u0065\u0020\u0063\u0075\u0072r\u0065\u006e\u0074\u0020\u0073\u0074\u0061\u0074\u0065\u0020\u0074\u006f\u0020\u0061\u0020G\u006f\u0020\u0069\u006d\u0061\u0067\u0065\u003a \u0025\u0073",_ebfbg );return _adfg ;};_eeca :=_gabc .Bounds ();_adga :=_dc .NewRGBA (_eeca );_cddcd ,_cdf :=_adfg .Width (),_adfg .Height ();for _ ,_fdda :=range _eeed {for _ ,_abce :=range _fdda .AlphaModFix {if _ggad :=_abce .AmtAttr ;_ggad !=nil {if _adce :=_ggad .ST_PositivePercentageDecimal ;_adce !=nil {_ffeb :=uint8 (255*(*_adce )/100000);_geaa :=_dc .NewUniform (_ea .Alpha {_ffeb });_b .Draw (_adga ,_eeca ,_facb ,_dc .Point {0,0},_b .Src );_b .DrawMask (_adga ,_eeca ,_gabc ,_dc .Point {0,0},_geaa ,_dc .Point {0,0},_b .Over );};};};};_bgga :=_dc .Rect (int (_bgca ),int (_bacd ),int (_bgca +_cddcd )+1,int (_bacd +_cdf )+1);_daea :=_bb .CropImageByRect (_adga ,_bgga );_dbge ,_ebfbg :=_ecafb ._cbda .NewImageFromGoImage (_daea );if _ebfbg !=nil {_ec .Log .Debug ("\u0045\u0072\u0072\u006f\u0072\u0020\u0061\u006e\u0020\u0069\u006d\u0061\u0067\u0065\u0020t\u006f \u0061\u0020\u0047\u006f\u0020\u0069\u006d\u0061\u0067\u0065\u003a\u0020\u0025\u0073",_ebfbg );return _adfg ;};return _dbge ;};func _aafe (_ecbd *_bbd .CT_TableCellProperties ,_ddeb *_bbd .CT_TableStyleCellStyle ,_eaab ,_cfae ,_aggf ,_egga bool )*_bbd .CT_TableCellProperties {_fead :=_bbd .NewCT_TableCellProperties ();if _ecbd !=nil {*_fead =*_ecbd ;};if _ddeb ==nil {return _fead ;};if _bfgb :=_ddeb .FillRef ;_bfgb !=nil {_caac :=_bbd .NewCT_SolidColorFillProperties ();_caac .ScrgbClr =_bfgb .ScrgbClr ;_caac .SrgbClr =_bfgb .SrgbClr ;_caac .HslClr =_bfgb .HslClr ;_caac .SysClr =_bfgb .SysClr ;_caac .SchemeClr =_bfgb .SchemeClr ;_caac .PrstClr =_bfgb .PrstClr ;_fead .SolidFill =_caac ;};if _fead .NoFill ==nil &&_fead .SolidFill ==nil {if _ccdad :=_ddeb .Fill ;_ccdad !=nil {if _fead .NoFill ==nil {_fead .NoFill =_ccdad .NoFill ;};if _fead .SolidFill ==nil {_fead .SolidFill =_ccdad .SolidFill ;};};};if _fcbc :=_ddeb .TcBdr ;_fcbc !=nil {if _fead .LnL ==nil {var _acdc *_bbd .CT_ThemeableLineStyle ;if _aggf {_acdc =_fcbc .Left ;}else {_acdc =_fcbc .InsideV ;};if _acdc !=nil {_fead .LnL =_acdc .Ln ;};};if _fead .LnR ==nil {var _gbca *_bbd .CT_ThemeableLineStyle ;if _egga {_gbca =_fcbc .Right ;}else {_gbca =_fcbc .InsideV ;};if _gbca !=nil {_fead .LnR =_gbca .Ln ;};};if _fead .LnT ==nil {var _edec *_bbd .CT_ThemeableLineStyle ;if _eaab {_edec =_fcbc .Top ;}else {_edec =_fcbc .InsideH ;};if _edec !=nil {_fead .LnT =_edec .Ln ;};};if _fead .LnB ==nil {var _ffgc *_bbd .CT_ThemeableLineStyle ;if _cfae {_ffgc =_fcbc .Bottom ;}else {_ffgc =_fcbc .InsideH ;};if _ffgc !=nil {_fead .LnB =_ffgc .Ln ;};};};return _fead ;};func (_aac *convertContext )getColorFromSolidFill (_ggdce *_bbd .CT_SolidColorFillProperties )(_de .Color ,float64 ){if _ggdce ==nil {return nil ,1;};var _ffdb string ;_dgcge :=1.0;if _gffd :=_ggdce .SrgbClr ;_gffd !=nil {_ffdb =_gffd .ValAttr ;_dgcge =_bb .GetOpacityFromColorTransform (_gffd .EG_ColorTransform );}else if _bfb :=_ggdce .SchemeClr ;_bfb !=nil {_ffdb =_bb .GetColorStringFromDmlColor (_aac ._ccd .GetColorBySchemeColor (_bfb .ValAttr ));_ffdb =_bb .AdjustColor (_ffdb ,_bfb .EG_ColorTransform );_dgcge =_bb .GetOpacityFromColorTransform (_bfb .EG_ColorTransform );};if _ffdb !=""{_ddaea :=_de .ColorRGBFromHex ("\u0023"+_ffdb );return _ddaea ,_dgcge ;};return nil ,1;};func (_bcef *textboxContext )alignSymbolsVertically (){for _ ,_efbbc :=range _bcef ._gege {for _ ,_bgfb :=range _efbbc ._ebbe {_fag :=0.0;for _ ,_deegd :=range _bgfb ._ebbea {for _ ,_gafg :=range _deegd ._bfc {if _gafg ._cgdg > _fag {_fag =_gafg ._cgdg ;};};};for _ ,_eeg :=range _bgfb ._ebbea {for _ ,_fged :=range _eeg ._bfc {if _fged ._decd < _fag {_fged ._cdce =_fag -_fged ._decd ;};};};};};};func (_aadcd *textboxContext )alignParagraphsVertically (_eefb _bbd .ST_TextAnchoringType ){if _eefb ==_bbd .ST_TextAnchoringTypeT {return ;};_eeee :=0.0;for _ ,_acfc :=range _aadcd ._gege {_eeee +=_acfc ._gffa +_acfc ._gbc +_acfc ._agff ;};var _bdeb float64 ;switch _eefb {case _bbd .ST_TextAnchoringTypeCtr :_bdeb =(_aadcd ._fbga -_eeee )/2;case _bbd .ST_TextAnchoringTypeB :_bdeb =_aadcd ._fbga -_eeee ;};for _ ,_fgae :=range _aadcd ._gege {_fgae ._aef +=_bdeb ;};};func (_gaad *textboxContext )addCurrentWordToParagraph (){if _gaad ._adee &&_gaad ._ebeb ._ggdc +_gaad ._bgbc ._age > _gaad ._ebeb ._eadd {_gaad .newLine ();};if !_gaad ._bgbc ._ecba ||len (_gaad ._ebeb ._ebbea )> 0{_gaad ._bgbc ._begb =_gaad ._ebeb ._ggdc ;_gaad ._ebeb ._ebbea =append (_gaad ._ebeb ._ebbea ,_gaad ._bgbc );_gaad ._ebeb ._ggdc +=_gaad ._bgbc ._age ;for _ ,_dbbc :=range _gaad ._bgbc ._bfc {_gaad .adjustHeights (_dbbc ._cgdg );};};};func (_cebe *convertContext )tileImage (_af *_de .Image ,_ddb *_bbd .CT_TileInfoProperties ,_gfe ,_bbc float64 )*_de .Image {_gff ,_ede :=1.0,1.0;if _fad :=_ddb .SxAttr ;_fad !=nil {_gff =_bb .FromSTPercentage (_fad );};if _gda :=_ddb .SyAttr ;_gda !=nil {_ede =_bb .FromSTPercentage (_gda );};_cff :=_bb .MakeTempCreator (_gfe ,_bbc );_af .Scale (_gff ,_ede );_be ,_agb :=_af .Width (),_af .Height ();var _bga ,_ebfaf float64 ;if _da :=_ddb .TxAttr ;_da !=nil {_bga =_fe .FromEMU (_bb .FromSTCoordinate (*_da ));};if _abb :=_ddb .TyAttr ;_abb !=nil {_ebfaf =_fe .FromEMU (_bb .FromSTCoordinate (*_abb ));};if _bga > 0{_bga -=_be ;};if _ebfaf > 0{_ebfaf -=_agb ;};_gbbc :=_cebe ._gba /_be +1;_gcg :=_cebe ._dbac /_agb +1;for _dcb :=0.0;_dcb <=_gbbc ;_dcb ++{_gabd :=_dcb *_be ;for _bea :=0.0;_bea <=_gcg ;_bea ++{_dda :=_bea *_agb ;_af .SetPos (_gabd +_bga ,_dda +_ebfaf );_cff .Draw (_af );};};_afb ,_eaf :=_bb .GetPageFromCreator (_cff );if _eaf !=nil {_ec .Log .Debug ("\u0043\u0061\u006e\u006e\u006f\u0074 \u0067\u0065\u0074\u0020\u0069\u006d\u0061\u0067\u0065\u0020\u0066\u0072\u006fm\u0020\u0063\u0072\u0065\u0061\u0074\u006fr\u003a\u0020\u0025\u0073",_eaf );return nil ;};_agc ,_eaf :=_fea .NewImageDevice ().Render (_afb );if _eaf !=nil {_ec .Log .Debug ("\u0043\u0061\u006eno\u0074\u0020\u0072\u0065\u006e\u0064\u0065\u0072\u0020\u0069\u006d\u0061\u0067\u0065\u003a\u0020\u0025\u0073",_eaf );return nil ;};_cffg ,_eaf :=_cebe ._cbda .NewImageFromGoImage (_agc );if _eaf !=nil {_ec .Log .Debug ("\u0043\u0061nn\u006f\u0074\u0020c\u0072\u0065\u0061\u0074e i\u006dag\u0065\u0020\u0066\u0072\u006f\u006d\u0020Go\u0049\u006d\u0061\u0067\u0065\u003a\u0020%\u0073",_eaf );return nil ;};return _cffg ;};type prefixData struct{_ccf string ;_bac bool ;_deb float64 ;_ecge float64 ;};func (_afcd *convertContext )renderPageWithDrawableToGoImage (_aebc _de .Drawable )(_dc .Image ,error ){_aebf :=_bb .MakeTempCreator (_afcd ._gba ,_afcd ._dbac );_aebf .NewPage ();_aebf .Draw (_aebc );_cgaa ,_fege :=_bb .GetPageFromCreator (_aebf );if _fege !=nil {return nil ,_fege ;};return _fea .NewImageDevice ().Render (_cgaa );};func _ecaf (_dgae ,_dega *_bbd .CT_TextBodyProperties )*_bbd .CT_TextBodyProperties {_afgf :=_bbd .NewCT_TextBodyProperties ();if _dgae !=nil {*_afgf =*_dgae ;};if _dega ==nil {return _afgf ;};if _afgf .RotAttr ==nil {_afgf .RotAttr =_dega .RotAttr ;};if _afgf .SpcFirstLastParaAttr ==nil {_afgf .SpcFirstLastParaAttr =_dega .SpcFirstLastParaAttr ;};if _afgf .VertOverflowAttr ==_bbd .ST_TextVertOverflowTypeUnset {_afgf .VertOverflowAttr =_dega .VertOverflowAttr ;};if _afgf .HorzOverflowAttr ==_bbd .ST_TextHorzOverflowTypeUnset {_afgf .HorzOverflowAttr =_dega .HorzOverflowAttr ;};if _afgf .VertAttr ==_bbd .ST_TextVerticalTypeUnset {_afgf .VertAttr =_dega .VertAttr ;};if _afgf .WrapAttr ==_bbd .ST_TextWrappingTypeUnset {_afgf .WrapAttr =_dega .WrapAttr ;};if _afgf .LInsAttr ==nil {_afgf .LInsAttr =_dega .LInsAttr ;};if _afgf .TInsAttr ==nil {_afgf .TInsAttr =_dega .TInsAttr ;};if _afgf .RInsAttr ==nil {_afgf .RInsAttr =_dega .RInsAttr ;};if _afgf .BInsAttr ==nil {_afgf .BInsAttr =_dega .BInsAttr ;};if _afgf .NumColAttr ==nil {_afgf .NumColAttr =_dega .NumColAttr ;};if _afgf .SpcColAttr ==nil {_afgf .SpcColAttr =_dega .SpcColAttr ;};if _afgf .RtlColAttr ==nil {_afgf .RtlColAttr =_dega .RtlColAttr ;};if _afgf .AnchorAttr ==_bbd .ST_TextAnchoringTypeUnset {_afgf .AnchorAttr =_dega .AnchorAttr ;};if _afgf .AnchorCtrAttr ==nil {_afgf .AnchorCtrAttr =_dega .AnchorCtrAttr ;};if _afgf .ForceAAAttr ==nil {_afgf .ForceAAAttr =_dega .ForceAAAttr ;};if _afgf .UprightAttr ==nil {_afgf .UprightAttr =_dega .UprightAttr ;};if _afgf .CompatLnSpcAttr ==nil {_afgf .CompatLnSpcAttr =_dega .CompatLnSpcAttr ;};if _afgf .PrstTxWarp ==nil {_afgf .PrstTxWarp =_dega .PrstTxWarp ;};if _afgf .NoAutofit ==nil {_afgf .NoAutofit =_dega .NoAutofit ;};if _afgf .NormAutofit ==nil {_afgf .NormAutofit =_dega .NormAutofit ;};if _afgf .SpAutoFit ==nil {_afgf .SpAutoFit =_dega .SpAutoFit ;};if _afgf .Scene3d ==nil {_afgf .Scene3d =_dega .Scene3d ;};if _afgf .Sp3d ==nil {_afgf .Sp3d =_dega .Sp3d ;};if _afgf .FlatTx ==nil {_afgf .FlatTx =_dega .FlatTx ;};if _afgf .ExtLst ==nil {_afgf .ExtLst =_dega .ExtLst ;};return _afgf ;};func (_cffb *textboxContext )alignParagraph (){_fdgef :=_cffb ._gbge ;if _fdgef ._ddbf ==_bbd .ST_TextAlignTypeL {return ;};_bcec :=len (_fdgef ._ebbe )-1;for _fbca ,_cced :=range _fdgef ._ebbe {_dbae :=true ;_efdef :=len (_cced ._ebbea );_afec :=0.0;for _bega :=len (_cced ._ebbea )-1;_bega >=0;_bega --{_afecg :=_cced ._ebbea [_bega ];if _dbae &&_afecg ._ecba {_efdef =_bega ;}else {_dbae =false ;for _ ,_edga :=range _afecg ._bfc {_afec +=_edga ._fgf ;};};};_cced ._ebbea =_cced ._ebbea [:_efdef ];_afba :=_cced ._eadd -_cced ._gcfc -_afec ;switch _fdgef ._ddbf {case _bbd .ST_TextAlignTypeR :_cced .moveRight (_afba );case _bbd .ST_TextAlignTypeCtr :_cced .moveRight (_afba /2);case _bbd .ST_TextAlignTypeJust :if _fbca !=_bcec {_cfab :=[]*word {};for _ ,_gbae :=range _cced ._ebbea {if _gbae ._ecba {_cfab =append (_cfab ,_gbae );};};_aefe :=_afba /float64 (len (_cfab ));for _ ,_aggc :=range _cfab {_aggc ._age +=_aefe ;};var _dfc *word ;for _ ,_egc :=range _cced ._ebbea {if _dfc !=nil {_egc ._begb =_dfc ._begb +_dfc ._age ;};_dfc =_egc ;};};};};};