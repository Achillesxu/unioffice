//
// Copyright 2020 FoxyUtils ehf. All rights reserved.
//
// This is a commercial product and requires a license to operate.
// A trial license can be obtained at https://unidoc.io
//
// DO NOT EDIT: generated by unitwist Go source code obfuscator.
//
// Use of this source code is governed by the UniDoc End User License Agreement
// terms that can be accessed at https://unidoc.io/eula/

package convert ;import (_be "bytes";_g "errors";_bd "github.com/unidoc/unioffice/common/logger";_bea "github.com/unidoc/unioffice/common/tempstorage";_gc "github.com/unidoc/unioffice/internal/convertutils";_c "github.com/unidoc/unioffice/measurement";_a "github.com/unidoc/unioffice/presentation";_beb "github.com/unidoc/unioffice/schema/soo/dml";_gdc "github.com/unidoc/unioffice/schema/soo/dml/chart";_e "github.com/unidoc/unioffice/schema/soo/pml";_ad "github.com/unidoc/unipdf/v3/contentstream/draw";_ab "github.com/unidoc/unipdf/v3/creator";_f "github.com/unidoc/unipdf/v3/model";_gd "github.com/unidoc/unipdf/v3/render";_bf "image";_d "image/color";_bg "image/draw";_gf "strconv";_db "strings";);func _aegc (_dcb ,_cffd *_beb .CT_TextBody )(*_beb .CT_TextBodyProperties ,*_beb .CT_TextListStyle ){if _dcb ==nil &&_cffd ==nil {return nil ,nil ;};if _dcb ==nil {return _cffd .BodyPr ,_cffd .LstStyle ;};if _cffd ==nil {return _dcb .BodyPr ,_dcb .LstStyle ;};_cebd ,_abebg :=_dcb .BodyPr ,_dcb .LstStyle ;_fcddf ,_eedg :=_cffd .BodyPr ,_cffd .LstStyle ;_dbcg :=_dbcc (_cebd ,_fcddf );_gdegd :=_fbge (_abebg ,_eedg );return _dbcg ,_gdegd ;};func (_dfbc *textboxContext )alignSymbolsVertically (){for _ ,_acea :=range _dfbc ._eca {for _ ,_aag :=range _acea ._addc {_babf :=0.0;for _ ,_fed :=range _aag ._cfec {for _ ,_bbbe :=range _fed ._acdf {if _bbbe ._eaff > _babf {_babf =_bbbe ._eaff ;};};};for _ ,_dacc :=range _aag ._cfec {for _ ,_aad :=range _dacc ._acdf {if _aad ._daac < _babf {_aad ._gaf =_babf -_aad ._daac ;};};};};};};func (_eag *convertContext )getConnectors (_cba *_e .CT_Connector )[]_ab .Drawable {_dcf ,_ ,_ ,_ ,_ ,_ ,_ :=_eag .getShapesFromSpPr (_cba .SpPr ,_cba .Style ,false );return _dcf ;};func (_abg *convertContext )makeSlide (){_fb :=_abg ._debd .X ().CSld ;if _fb ==nil {return ;};_bdg :=&background {};if _gdg :=_fb .Bg ;_gdg !=nil {if _bfe :=_gdg .BgPr ;_bfe !=nil {if _bfe .NoFill ==nil {if _cg :=_bfe .SolidFill ;_cg !=nil {_ace ,_gg :=_abg .getColorFromSolidFill (_cg );if _ace !=nil {_bdg ._bbfgb =_ace ;_bdg ._efef =_gg ;};}else if _cdd :=_bfe .BlipFill ;_cdd !=nil {_bdg ._gab =_cdd ;};};};};_abg ._agf =_bdg ;if _bgf :=_fb .SpTree ;_bgf !=nil {for _ ,_aae :=range _bgf .Choice {if _aae !=nil {for _ ,_eff :=range _aae .Sp {if _eff !=nil {_cad :=_abg .getShapes (_eff );_abg ._eaa =append (_abg ._eaa ,_cad ...);};};for _ ,_dg :=range _aae .GraphicFrame {if _dg !=nil {var _bgfe ,_ebf ,_cea ,_gce float64 ;if _fea :=_dg .Xfrm ;_fea !=nil {_bgfe ,_ebf ,_cea ,_gce =_gc .GetDataFromXfrm (_fea );};if _ccc :=_dg .Graphic ;_ccc !=nil {if _gcf :=_ccc .GraphicData ;_gcf !=nil {for _ ,_df :=range _gcf .Any {if _de ,_abb :=_df .(*_gdc .Chart );_abb {_cef ,_cb :=_abg .makePdfBlockFromChart (_de ,_cea ,_gce );if _cb !=nil {_bd .Log .Debug ("C\u0061\u006e\u006e\u006ft \u0072e\u0061\u0064\u0020\u0062\u006co\u0063\u006b\u003a\u0020\u0025\u0073",_cb );};if _cef !=nil {_cef .SetPos (_bgfe ,_ebf );_abg ._eaa =append (_abg ._eaa ,_cef );};}else if _eea ,_faa :=_df .(*_beb .Tbl );_faa {_ba :=_abg .makePdfBlockFromTable (_eea ,_cea );if _ba !=nil {_fca :=_ab .NewBlock (_cea ,_gce );_fca .SetPos (_bgfe ,_ebf );_fca .Draw (_ba );_abg ._eaa =append (_abg ._eaa ,_fca );};};};};};};};for _ ,_ggf :=range _aae .CxnSp {if _ggf !=nil {_dbd :=_abg .getConnectors (_ggf );_abg ._eaa =append (_abg ._eaa ,_dbd ...);};};for _ ,_fd :=range _aae .Pic {if _fd !=nil {var _ae ,_adg ,_gda ,_dgd float64 ;if _cae :=_fd .SpPr ;_cae !=nil {if _cec :=_cae .Xfrm ;_cec !=nil {_ae ,_adg ,_gda ,_dgd =_gc .GetDataFromXfrm (_cec );};};if _fdb :=_fd .BlipFill ;_fdb !=nil {_agd :=_abg .getShapeFromBlipFill (_fdb ,_ae ,_adg ,_gda ,_dgd );_abg ._eaa =append (_abg ._eaa ,_agd );};};};};};};};func (_deab *textboxContext )newWord (){_deab ._eeac =&word {_cdfb :true ,_aec :_deab ._bca ._cag }};func _faed (_ggb float64 )float64 {return _ggb *_c .Millimeter };func (_ddee *textboxContext )alignVertically (_gbad _beb .ST_TextAnchoringType ){_ddee .alignParagraphsVertically (_gbad );_ddee .alignSymbolsVertically ();};type background struct{_bbfgb _ab .Color ;_efef float64 ;_gab *_beb .CT_BlipFillProperties ;};func (_ggcc *convertContext )getColorFromFontReference (_edd *_beb .CT_FontReference )_ab .Color {var _aafb _ab .Color ;var _bddf string ;if _ccdcg :=_edd .SrgbClr ;_ccdcg !=nil {_bddf =_ccdcg .ValAttr ;}else if _caed :=_edd .SchemeClr ;_caed !=nil {_bddf =_gc .GetColorStringFromDmlColor (_ggcc ._bdce .GetColorBySchemeColor (_caed .ValAttr ));_bddf =_gc .AdjustColor (_bddf ,_caed .EG_ColorTransform );};if _bddf !=""{_aafb =_ab .ColorRGBFromHex ("\u0023"+_bddf );};return _aafb ;};type prefixData struct{_agcg string ;_efg bool ;_ffbb float64 ;_gecf float64 ;};func (_gdcg *textboxContext )newLine (){if _gdcg ._dff ==nil {_gdcg .newParagraph ();};_dbc :=_gdcg ._dff ._ddga +_gdcg ._dff ._daag ;_ggfc :=&line {};_ggfc ._adf =_gdcg ._dff ._aegg ;if len (_gdcg ._dff ._addc )==0{_ggfc ._adf +=_gdcg ._dff ._fbce ;};_ggfc ._ceg =_gdcg ._dff ._acf ;_ggfc ._cag =_ggfc ._adf ;_ggfc ._egd =_dbc ;_gdcg ._dff ._addc =append (_gdcg ._dff ._addc ,_ggfc );_gdcg ._bca =_ggfc ;};func (_acb *convertContext )tileImage (_aga *_ab .Image ,_abd *_beb .CT_TileInfoProperties ,_dbf ,_fg float64 )*_ab .Image {_gca ,_gfd :=1.0,1.0;if _gge :=_abd .SxAttr ;_gge !=nil {_gca =_gc .FromSTPercentage (_gge );};if _dea :=_abd .SyAttr ;_dea !=nil {_gfd =_gc .FromSTPercentage (_dea );};_cga :=_gc .MakeTempCreator (_dbf ,_fg );_aga .Scale (_gca ,_gfd );_ead ,_cgc :=_aga .Width (),_aga .Height ();var _dbb ,_bgb float64 ;if _bgc :=_abd .TxAttr ;_bgc !=nil {_dbb =_c .FromEMU (_gc .FromSTCoordinate (*_bgc ));};if _bef :=_abd .TyAttr ;_bef !=nil {_bgb =_c .FromEMU (_gc .FromSTCoordinate (*_bef ));};if _dbb > 0{_dbb -=_ead ;};if _bgb > 0{_bgb -=_cgc ;};_adb :=_acb ._edc /_ead +1;_abdd :=_acb ._aac /_cgc +1;for _ed :=0.0;_ed <=_adb ;_ed ++{_fda :=_ed *_ead ;for _cdf :=0.0;_cdf <=_abdd ;_cdf ++{_bde :=_cdf *_cgc ;_aga .SetPos (_fda +_dbb ,_bde +_bgb );_cga .Draw (_aga );};};_bdec ,_fab :=_gc .GetPageFromCreator (_cga );if _fab !=nil {_bd .Log .Debug ("\u0043\u0061\u006e\u006e\u006f\u0074 \u0067\u0065\u0074\u0020\u0069\u006d\u0061\u0067\u0065\u0020\u0066\u0072\u006fm\u0020\u0063\u0072\u0065\u0061\u0074\u006fr\u003a\u0020\u0025\u0073",_fab );return nil ;};_bdga ,_fab :=_gd .NewImageDevice ().Render (_bdec );if _fab !=nil {_bd .Log .Debug ("\u0043\u0061\u006eno\u0074\u0020\u0072\u0065\u006e\u0064\u0065\u0072\u0020\u0069\u006d\u0061\u0067\u0065\u003a\u0020\u0025\u0073",_fab );return nil ;};_dgb ,_fab :=_acb ._faf .NewImageFromGoImage (_bdga );if _fab !=nil {_bd .Log .Debug ("\u0043\u0061nn\u006f\u0074\u0020c\u0072\u0065\u0061\u0074e i\u006dag\u0065\u0020\u0066\u0072\u006f\u006d\u0020Go\u0049\u006d\u0061\u0067\u0065\u003a\u0020%\u0073",_fab );return nil ;};return _dgb ;};func (_dceg *convertContext )makePdfBlockFromTxBody (_ddb *_beb .CT_TextBody ,_cead *_beb .CT_TextBodyProperties ,_dege *_beb .CT_TextListStyle ,_aeag ,_agae float64 ,_dbbg _ab .Color ,_gcfd ,_ddc bool )(*_ab .Block ,error ){var _bad *_beb .CT_TextParagraphProperties ;if _ggd :=_ddb .LstStyle ;_ggd !=nil {var _edbc *_beb .CT_TextParagraphProperties ;if _ggd .Lvl1pPr !=nil {_edbc =_ggd .Lvl1pPr ;};_bad =_fdcc (_edbc ,_ggd .DefPPr );};var _gad *_beb .CT_TextParagraphProperties ;if _bad !=nil {if _gcfd {_gad =_dceg ._gdga [0];}else if _ddc {_gad =_dceg ._bebc [0];}else {_gad =_dceg ._fag [0];};if _dege !=nil {_gad =_fdcc (_fdcc (_dege .Lvl1pPr ,_dege .DefPPr ),_gad );};_gad =_fdcc (_bad ,_gad );}else {if _gcfd {_gad =_dceg ._ecf ;}else if _ddc {_gad =_dceg ._caca ;}else {_gad =_dceg ._gfge ;};};_ece ,_beab :=_faed (2.5),_faed (2.5);_bfde ,_gfa :=_faed (1.3),_faed (1.3);_agcb :=true ;_fcd :=_beb .ST_TextAnchoringTypeT ;if _cead !=nil {if _gdb :=_cead .AnchorAttr ;_gdb !=_beb .ST_TextAnchoringTypeUnset {_fcd =_gdb ;};};if _ebed :=_ddb .BodyPr ;_ebed !=nil {if _bbcf :=_ebed .LInsAttr ;_bbcf !=nil {_ece =_c .FromEMU (_gc .FromSTCoordinate32 (*_bbcf ));};if _eba :=_ebed .TInsAttr ;_eba !=nil {_bfde =_c .FromEMU (_gc .FromSTCoordinate32 (*_eba ));};if _efce :=_ebed .RInsAttr ;_efce !=nil {_beab =_c .FromEMU (_gc .FromSTCoordinate32 (*_efce ));};if _bgcd :=_ebed .BInsAttr ;_bgcd !=nil {_gfa =_c .FromEMU (_gc .FromSTCoordinate32 (*_bgcd ));};_agcb =_ebed .WrapAttr !=_beb .ST_TextWrappingTypeNone ;if _fgf :=_ebed .AnchorAttr ;_fgf !=_beb .ST_TextAnchoringTypeUnset {_fcd =_ebed .AnchorAttr ;};};_ddf :=_gc .MakeTempCreator (_aeag ,_agae );_ddf .SetPageMargins (_ece ,_beab ,_bfde ,_gfa );_fdaa :=&textboxContext {_fgbf :_dceg ,_fadf :_agcb ,_gdcf :_aeag -_ece -_beab ,_gedb :_agae -_bfde -_gfa ,_daaf :_ddf ,_eca :[]*paragraph {}};_fec :=1;for _ ,_bec :=range _ddb .P {if _bec !=nil {_dee :=_bec .PPr ;var _eada *prefixData ;if _dee !=nil &&_dee .BuNone ==nil {var _cbb string ;var _cfc bool ;if _ffc :=_dee .BuAutoNum ;_ffc !=nil {var _geg string ;if _cfg :=_ffc .StartAtAttr ;_cfg !=nil {_fec =int (*_cfg );};var _dgbf string ;switch _ffc .TypeAttr {case _beb .ST_TextAutonumberSchemeAlphaUcParenBoth ,_beb .ST_TextAutonumberSchemeAlphaUcParenR ,_beb .ST_TextAutonumberSchemeAlphaUcPeriod :_dgbf =_dgac (_fec ,true );case _beb .ST_TextAutonumberSchemeAlphaLcParenBoth ,_beb .ST_TextAutonumberSchemeAlphaLcParenR ,_beb .ST_TextAutonumberSchemeAlphaLcPeriod :_dgbf =_dgac (_fec ,false );case _beb .ST_TextAutonumberSchemeRomanUcParenBoth ,_beb .ST_TextAutonumberSchemeRomanUcParenR ,_beb .ST_TextAutonumberSchemeRomanUcPeriod :_dgbf =_dgad (_fec ,true );case _beb .ST_TextAutonumberSchemeRomanLcParenBoth ,_beb .ST_TextAutonumberSchemeRomanLcParenR ,_beb .ST_TextAutonumberSchemeRomanLcPeriod :_dgbf =_dgad (_fec ,false );default:_dgbf =_gf .Itoa (_fec );};switch _ffc .TypeAttr {case _beb .ST_TextAutonumberSchemeAlphaLcPeriod ,_beb .ST_TextAutonumberSchemeAlphaUcPeriod ,_beb .ST_TextAutonumberSchemeArabicPeriod ,_beb .ST_TextAutonumberSchemeRomanLcPeriod ,_beb .ST_TextAutonumberSchemeRomanUcPeriod ,_beb .ST_TextAutonumberSchemeArabicDbPeriod ,_beb .ST_TextAutonumberSchemeEa1ChsPeriod ,_beb .ST_TextAutonumberSchemeEa1ChtPeriod ,_beb .ST_TextAutonumberSchemeEa1JpnChsDbPeriod ,_beb .ST_TextAutonumberSchemeEa1JpnKorPeriod ,_beb .ST_TextAutonumberSchemeThaiAlphaPeriod ,_beb .ST_TextAutonumberSchemeThaiNumPeriod ,_beb .ST_TextAutonumberSchemeHindiAlphaPeriod ,_beb .ST_TextAutonumberSchemeHindiNumPeriod ,_beb .ST_TextAutonumberSchemeHindiAlpha1Period :_geg ="\u002e";case _beb .ST_TextAutonumberSchemeAlphaLcParenR ,_beb .ST_TextAutonumberSchemeAlphaUcParenR ,_beb .ST_TextAutonumberSchemeArabicParenR ,_beb .ST_TextAutonumberSchemeRomanLcParenR ,_beb .ST_TextAutonumberSchemeRomanUcParenR ,_beb .ST_TextAutonumberSchemeThaiAlphaParenR ,_beb .ST_TextAutonumberSchemeThaiNumParenR ,_beb .ST_TextAutonumberSchemeHindiNumParenR :_geg ="\u0029";};_cbb =_dgbf +_geg ;_fec ++;}else if _geac :=_dee .BuChar ;_geac !=nil {_bfdef :=_geac .CharAttr ;if _efe ,_fdde :=_bfcca [_bfdef ];_fdde {_bfdef =string (rune (_efe ));}else {_bfdef ="\u2022";};_cbb =_bfdef ;_cfc =true ;};if _cbb !=""{var _bffg ,_fdf float64 ;if _dee .MarLAttr !=nil {_bffg =_c .FromEMU (int64 (*_dee .MarLAttr ));};if _dee .IndentAttr !=nil {_fdf =_c .FromEMU (int64 (*_dee .IndentAttr ));};_eada =&prefixData {_agcg :_cbb ,_efg :_cfc ,_ffbb :_bffg ,_gecf :_fdf };};};_dee =_fdcc (_dee ,_gad );_cccb :=_aaee (_bec .EndParaRPr ,_dee .DefRPr );_fdaa .newParagraph ();_fdaa .assignPropsToCurrentParagraph (_dee );_fdaa .newLine ();_fdaa .newWord ();for _afb ,_ecg :=range _bec .EG_TextRun {_fdaa .addTextRun (_ecg ,_cccb ,_dbbg ,_eada );if _afb > 0{_eada =nil ;};};_fdaa .addCurrentWordToParagraph ();};_fdaa .addCurrentParagraph ();};_fdaa .alignVertically (_fcd );_fdaa .drawParagraphs ();return _gc .MakeBlockFromCreator (_ddf );};func _dbcc (_aedf ,_deaed *_beb .CT_TextBodyProperties )*_beb .CT_TextBodyProperties {_dcda :=_beb .NewCT_TextBodyProperties ();if _aedf !=nil {*_dcda =*_aedf ;};if _deaed ==nil {return _dcda ;};if _dcda .RotAttr ==nil {_dcda .RotAttr =_deaed .RotAttr ;};if _dcda .SpcFirstLastParaAttr ==nil {_dcda .SpcFirstLastParaAttr =_deaed .SpcFirstLastParaAttr ;};if _dcda .VertOverflowAttr ==_beb .ST_TextVertOverflowTypeUnset {_dcda .VertOverflowAttr =_deaed .VertOverflowAttr ;};if _dcda .HorzOverflowAttr ==_beb .ST_TextHorzOverflowTypeUnset {_dcda .HorzOverflowAttr =_deaed .HorzOverflowAttr ;};if _dcda .VertAttr ==_beb .ST_TextVerticalTypeUnset {_dcda .VertAttr =_deaed .VertAttr ;};if _dcda .WrapAttr ==_beb .ST_TextWrappingTypeUnset {_dcda .WrapAttr =_deaed .WrapAttr ;};if _dcda .LInsAttr ==nil {_dcda .LInsAttr =_deaed .LInsAttr ;};if _dcda .TInsAttr ==nil {_dcda .TInsAttr =_deaed .TInsAttr ;};if _dcda .RInsAttr ==nil {_dcda .RInsAttr =_deaed .RInsAttr ;};if _dcda .BInsAttr ==nil {_dcda .BInsAttr =_deaed .BInsAttr ;};if _dcda .NumColAttr ==nil {_dcda .NumColAttr =_deaed .NumColAttr ;};if _dcda .SpcColAttr ==nil {_dcda .SpcColAttr =_deaed .SpcColAttr ;};if _dcda .RtlColAttr ==nil {_dcda .RtlColAttr =_deaed .RtlColAttr ;};if _dcda .AnchorAttr ==_beb .ST_TextAnchoringTypeUnset {_dcda .AnchorAttr =_deaed .AnchorAttr ;};if _dcda .AnchorCtrAttr ==nil {_dcda .AnchorCtrAttr =_deaed .AnchorCtrAttr ;};if _dcda .ForceAAAttr ==nil {_dcda .ForceAAAttr =_deaed .ForceAAAttr ;};if _dcda .UprightAttr ==nil {_dcda .UprightAttr =_deaed .UprightAttr ;};if _dcda .CompatLnSpcAttr ==nil {_dcda .CompatLnSpcAttr =_deaed .CompatLnSpcAttr ;};if _dcda .PrstTxWarp ==nil {_dcda .PrstTxWarp =_deaed .PrstTxWarp ;};if _dcda .NoAutofit ==nil {_dcda .NoAutofit =_deaed .NoAutofit ;};if _dcda .NormAutofit ==nil {_dcda .NormAutofit =_deaed .NormAutofit ;};if _dcda .SpAutoFit ==nil {_dcda .SpAutoFit =_deaed .SpAutoFit ;};if _dcda .Scene3d ==nil {_dcda .Scene3d =_deaed .Scene3d ;};if _dcda .Sp3d ==nil {_dcda .Sp3d =_deaed .Sp3d ;};if _dcda .FlatTx ==nil {_dcda .FlatTx =_deaed .FlatTx ;};if _dcda .ExtLst ==nil {_dcda .ExtLst =_deaed .ExtLst ;};return _dcda ;};func _fgc (_dcde *_beb .CT_AdjPoint2D )(float64 ,float64 ){var _bgdb ,_ddeg float64 ;_abebe ,_ddfd :=_dcde .XAttr ,_dcde .YAttr ;if _eggg :=_abebe .ST_Coordinate ;_eggg !=nil {_bgdb =_c .FromEMU (_gc .FromSTCoordinate (*_eggg ));};if _dacf :=_ddfd .ST_Coordinate ;_dacf !=nil {_ddeg =_c .FromEMU (_gc .FromSTCoordinate (*_dacf ));};return _bgdb ,_ddeg ;};func _bgfg (_acfg ,_ebce *_beb .CT_TableStyleTextStyle )*_beb .CT_TableStyleTextStyle {_dega :=_beb .NewCT_TableStyleTextStyle ();if _acfg !=nil {*_dega =*_acfg ;};if _ebce ==nil {return _dega ;};if _dega .BAttr ==_beb .ST_OnOffStyleTypeUnset {_dega .BAttr =_ebce .BAttr ;};if _dega .IAttr ==_beb .ST_OnOffStyleTypeUnset {_dega .IAttr =_ebce .IAttr ;};if _dega .Font ==nil {_dega .Font =_ebce .Font ;};if _dega .FontRef ==nil {_dega .FontRef =_ebce .FontRef ;};if _dega .ScrgbClr ==nil {_dega .ScrgbClr =_ebce .ScrgbClr ;};if _dega .SrgbClr ==nil {_dega .SrgbClr =_ebce .SrgbClr ;};if _dega .HslClr ==nil {_dega .HslClr =_ebce .HslClr ;};if _dega .SysClr ==nil {_dega .SysClr =_ebce .SysClr ;};if _dega .SchemeClr ==nil {_dega .SchemeClr =_ebce .SchemeClr ;};if _dega .PrstClr ==nil {_dega .PrstClr =_ebce .PrstClr ;};return _dega ;};func (_daea *convertContext )makePdfImageFromBlipFill (_egad *_beb .CT_BlipFillProperties )(*_ab .Image ,[]*_beb .CT_BlipChoice ,error ){if _edgc :=_egad .Blip ;_edgc !=nil {if _bdbb :=_edgc .EmbedAttr ;_bdbb !=nil {_bccf ,_bfga :=_daea ._debd .GetImageByRelID (*_bdbb );if _bfga {_beaa ,_eac :=_bea .Open (_bccf .Path ());if _eac !=nil {_bd .Log .Debug ("\u0046\u0069\u006c\u0065 o\u0070\u0065\u006e\u0020\u0065\u0072\u0072\u006f\u0072\u003a\u0020\u0025\u0073",_eac );return nil ,nil ,_eac ;};defer _beaa .Close ();_aaga ,_ ,_eac :=_bf .Decode (_beaa );if _eac !=nil {_bd .Log .Debug ("\u0044\u0065\u0063\u006fde\u0020\u0069\u006d\u0061\u0067\u0065\u0020\u0065\u0072\u0072\u006f\u0072\u003a\u0020%\u0073",_eac );return nil ,nil ,_eac ;};if _aaed :=_egad .SrcRect ;_aaed !=nil {_gcbd :=_aaga .Bounds ().Size ();_aefd :=_gcbd .X ;_baga :=_gcbd .Y ;var _bfaf ,_cgf ,_caf ,_bcbf int ;var _geabe bool ;if _adfc :=_aaed .LAttr ;_adfc !=nil {_bfaf =int (float64 (_aefd )*_gc .FromSTPercentage (_adfc ));_geabe =true ;}else {_bfaf =0;};if _bgad :=_aaed .TAttr ;_bgad !=nil {_caf =int (float64 (_baga )*_gc .FromSTPercentage (_bgad ));_geabe =true ;}else {_caf =0;};if _agcf :=_aaed .RAttr ;_agcf !=nil {_cgf =int (float64 (_aefd )*(1-_gc .FromSTPercentage (_agcf )));_geabe =true ;}else {_cgf =_aefd ;};if _gebb :=_aaed .BAttr ;_gebb !=nil {_bcbf =int (float64 (_baga )*(1-_gc .FromSTPercentage (_gebb )));_geabe =true ;}else {_bcbf =_baga ;};if _geabe {_aaga =_gc .CropImageByRect (_aaga ,_bf .Rect (_bfaf ,_caf ,_cgf +1,_bcbf +1));};};_dffc ,_eac :=_daea ._faf .NewImageFromGoImage (_aaga );if _eac !=nil {_bd .Log .Debug ("\u0043\u0061\u006e\u006e\u006ft\u0020\u0063\u0072\u0065\u0061\u0074\u0065\u0020\u0050\u0044\u0046\u0020\u0069m\u0061\u0067\u0065\u0020\u0066\u0072\u006f\u006d\u0020\u0047\u006f\u0020\u0069\u006d\u0061\u0067\u0065\u003a\u0020\u0025\u0073",_eac );return nil ,nil ,_eac ;};return _dffc ,_edgc .Choice ,nil ;};};};return nil ,nil ,nil ;};

// RegisterFont makes a PdfFont accessible for using in converting to PDF.
func RegisterFont (name string ,style FontStyle ,font *_f .PdfFont ){_gc .RegisterFont (name ,style ,font );};func (_bcdd *convertContext )makeStyleFromRPr (_bdee *_beb .CT_TextCharacterProperties )(*_ab .TextStyle ,bool ,bool ,bool ){var _efb ,_gaga ,_bbe bool ;_fbba :=_bcdd ._faf .NewTextStyle ();if _bdee !=nil {_add :=_gc .FontStyle_Regular ;_aff :=_dcd (_bdee .BAttr );_acd :=_dcd (_bdee .IAttr );if _aff &&_acd {_add =_gc .FontStyle_BoldItalic ;}else if _aff {_add =_gc .FontStyle_Bold ;}else if _acd {_add =_gc .FontStyle_Italic ;};_bbe =_bdee .UAttr !=_beb .ST_TextUnderlineTypeUnset &&_bdee .UAttr !=_beb .ST_TextUnderlineTypeNone ;_bfae :="\u0064e\u0066\u0061\u0075\u006c\u0074";if _dafc :=_bdee .Latin ;_dafc !=nil {_bfae =_dafc .TypefaceAttr ;}else if _dgc :=_bdee .Ea ;_dgc !=nil {_bfae =_dgc .TypefaceAttr ;}else if _cgb :=_bdee .Cs ;_cgb !=nil {_bfae =_cgb .TypefaceAttr ;}else if _bfcf :=_bdee .Sym ;_bfcf !=nil {_bfae =_bfcf .TypefaceAttr ;};if _cbbg ,_eefg :=_gc .StdFontsMap [_bfae ];_eefg {_fbba .Font =_gc .AssignStdFontByName (_fbba ,_cbbg [_add ]);}else if _dfe :=_gc .GetRegisteredFont (_bfae ,_add );_dfe !=nil {_fbba .Font =_dfe ;}else {_bd .Log .Debug ("\u0046\u006f\u006e\u0074\u0020\u0025\u0073\u0020\u0077\u0069\u0074h\u0020\u0073\u0074\u0079\u006c\u0065\u0020\u0025s\u0020i\u0073\u0020\u006e\u006f\u0074\u0020\u0066\u006f\u0075\u006e\u0064\u002c\u0020\u0072\u0065\u0073\u0065\u0074 \u0074\u006f\u0020\u0064\u0065\u0066\u0061\u0075\u006c\u0074\u002e",_bfae ,_add );_fbba .Font =_gc .AssignStdFontByName (_fbba ,_gc .StdFontsMap ["\u0064e\u0066\u0061\u0075\u006c\u0074"][_add ]);};var _bcgb float64 ;if _bcc :=_bdee .SzAttr ;_bcc !=nil {_bcgb =float64 (*_bcc )/100;}else {_bcgb =_gc .DefaultFontSize ;};if _fade :=_bdee .BaselineAttr ;_fade !=nil {if _dfd :=_fade .ST_PercentageDecimal ;_dfd !=nil {if *_dfd > 0{_efb =true ;}else if *_dfd < 0{_gaga =true ;};};};if _efb ||_gaga {_bcgb *=0.64;};_fbba .FontSize =_bcgb ;_egg :=0.0;if _beca :=_bdee .SpcAttr ;_beca !=nil {if _efcf :=_beca .ST_TextPointUnqualified ;_efcf !=nil {_egg =float64 (*_efcf )/100;};};_fbba .CharSpacing =_egg ;};return &_fbba ,_efb ,_gaga ,_bbe ;};func _cgac (_cgfb ,_caae *_beb .CT_TableStyleCellStyle )*_beb .CT_TableStyleCellStyle {_cebdb :=_beb .NewCT_TableStyleCellStyle ();if _cgfb !=nil {*_cebdb =*_cgfb ;};if _caae ==nil {return _cebdb ;};if _cebdb .TcBdr ==nil {_cebdb .TcBdr =_caae .TcBdr ;};if _cebdb .Fill ==nil {_cebdb .Fill =_caae .Fill ;};if _cebdb .FillRef ==nil {_cebdb .FillRef =_caae .FillRef ;};return _cebdb ;};func (_eadee *convertContext )getColorFromSolidFill (_eeccg *_beb .CT_SolidColorFillProperties )(_ab .Color ,float64 ){if _eeccg ==nil {return nil ,1;};var _fac string ;_edcgc :=1.0;if _fdcb :=_eeccg .SrgbClr ;_fdcb !=nil {_fac =_fdcb .ValAttr ;_edcgc =_gc .GetOpacityFromColorTransform (_fdcb .EG_ColorTransform );}else if _afgg :=_eeccg .SchemeClr ;_afgg !=nil {_fac =_gc .GetColorStringFromDmlColor (_eadee ._debd .GetColorBySchemeColor (_afgg .ValAttr ));_fac =_gc .AdjustColor (_fac ,_afgg .EG_ColorTransform );_edcgc =_gc .GetOpacityFromColorTransform (_afgg .EG_ColorTransform );};if _fac !=""{_dgfg :=_ab .ColorRGBFromHex ("\u0023"+_fac );return _dgfg ,_edcgc ;};return nil ,1;};func (_cfa *convertContext )renderCurrentStateToGoImage ()(_bf .Image ,error ){_ebdfb :=_gc .MakeTempCreator (_cfa ._edc ,_cfa ._aac );_ebdfb .NewPage ();for _ ,_fcb :=range _cfa ._eaa {if _fcb !=nil {_ebdfb .MoveTo (0,0);_ebdfb .Draw (_fcb );};};_cfag ,_fega :=_gc .GetPageFromCreator (_ebdfb );if _fega !=nil {return nil ,_fega ;};return _gd .NewImageDevice ().Render (_cfag );};func (_afaaf *convertContext )getColorFromMatrixReference (_edea *_beb .CT_StyleMatrixReference )_ab .Color {if _edea ==nil {return nil ;};var _caef _ab .Color ;var _cgea string ;if _acbc :=_edea .SrgbClr ;_acbc !=nil {_cgea =_acbc .ValAttr ;}else if _bdf :=_edea .SchemeClr ;_bdf !=nil {_cgea =_gc .GetColorStringFromDmlColor (_afaaf ._bdce .GetColorBySchemeColor (_bdf .ValAttr ));_cgea =_gc .AdjustColor (_cgea ,_bdf .EG_ColorTransform );};if _cgea !=""{_caef =_ab .ColorRGBFromHex ("\u0023"+_cgea );};return _caef ;};func _fdcc (_aafa ,_cfee *_beb .CT_TextParagraphProperties )*_beb .CT_TextParagraphProperties {_bfac :=_beb .NewCT_TextParagraphProperties ();if _aafa !=nil {*_bfac =*_aafa ;};if _cfee ==nil {return _bfac ;};if _bfac .MarLAttr ==nil {_bfac .MarLAttr =_cfee .MarLAttr ;};if _bfac .MarRAttr ==nil {_bfac .MarRAttr =_cfee .MarRAttr ;};if _bfac .LvlAttr ==nil {_bfac .LvlAttr =_cfee .LvlAttr ;};if _bfac .IndentAttr ==nil {_bfac .IndentAttr =_cfee .IndentAttr ;};if _bfac .AlgnAttr ==_beb .ST_TextAlignTypeUnset {_bfac .AlgnAttr =_cfee .AlgnAttr ;};if _bfac .DefTabSzAttr ==nil {_bfac .DefTabSzAttr =_cfee .DefTabSzAttr ;};if _bfac .RtlAttr ==nil {_bfac .RtlAttr =_cfee .RtlAttr ;};if _bfac .EaLnBrkAttr ==nil {_bfac .EaLnBrkAttr =_cfee .EaLnBrkAttr ;};if _bfac .FontAlgnAttr ==_beb .ST_TextFontAlignTypeUnset {_bfac .FontAlgnAttr =_cfee .FontAlgnAttr ;};if _bfac .LatinLnBrkAttr ==nil {_bfac .LatinLnBrkAttr =_cfee .LatinLnBrkAttr ;};if _bfac .HangingPunctAttr ==nil {_bfac .HangingPunctAttr =_cfee .HangingPunctAttr ;};if _bfac .LnSpc ==nil {_bfac .LnSpc =_cfee .LnSpc ;};if _bfac .SpcBef ==nil {_bfac .SpcBef =_cfee .SpcBef ;};if _bfac .SpcAft ==nil {_bfac .SpcAft =_cfee .SpcAft ;};if _bfac .BuClrTx ==nil {_bfac .BuClrTx =_cfee .BuClrTx ;};if _bfac .BuClr ==nil {_bfac .BuClr =_cfee .BuClr ;};if _bfac .BuSzTx ==nil {_bfac .BuSzTx =_cfee .BuSzTx ;};if _bfac .BuSzPct ==nil {_bfac .BuSzPct =_cfee .BuSzPct ;};if _bfac .BuSzPts ==nil {_bfac .BuSzPts =_cfee .BuSzPts ;};if _bfac .BuFontTx ==nil {_bfac .BuFontTx =_cfee .BuFontTx ;};if _bfac .BuFont ==nil {_bfac .BuFont =_cfee .BuFont ;};if _bfac .BuNone ==nil {_bfac .BuNone =_cfee .BuNone ;};if _bfac .BuAutoNum ==nil {_bfac .BuAutoNum =_cfee .BuAutoNum ;};if _bfac .BuChar ==nil {_bfac .BuChar =_cfee .BuChar ;};if _bfac .BuBlip ==nil {_bfac .BuBlip =_cfee .BuBlip ;};if _bfac .TabLst ==nil {_bfac .TabLst =_cfee .TabLst ;};if _bfac .ExtLst ==nil {_bfac .ExtLst =_cfee .ExtLst ;};_bfac .DefRPr =_aaee (_bfac .DefRPr ,_cfee .DefRPr );return _bfac ;};func (_aeaf *textboxContext )alignParagraphsVertically (_fbde _beb .ST_TextAnchoringType ){if _fbde ==_beb .ST_TextAnchoringTypeT {return ;};_ecef :=0.0;for _ ,_ceaa :=range _aeaf ._eca {_ecef +=_ceaa ._daag +_ceaa ._ddga +_ceaa ._dfbg ;};var _egcb float64 ;switch _fbde {case _beb .ST_TextAnchoringTypeCtr :_egcb =(_aeaf ._gedb -_ecef )/2;case _beb .ST_TextAnchoringTypeB :_egcb =_aeaf ._gedb -_ecef ;};for _ ,_ffce :=range _aeaf ._eca {_ffce ._dgec +=_egcb ;};};func (_bcdf *textboxContext )addPrefix (_acbg *prefixData ,_bacd *_ab .TextStyle ){_fecd :=_afba (_acbg ._agcg );_abeb :=*_bacd ;if _acbg ._efg {_abeb .Font =_gc .AssignStdFontByName (_abeb ,"\u0053\u0079\u006d\u0062\u006f\u006c");};for _ ,_efdc :=range _fecd {_efdc ._ecbd =&_abeb ;_bcdf .addTextSymbol (_efdc );};_fddg :=-(_acbg ._gecf +_bcdf ._eeac ._ebdg );if _fddg < 0{_fddg =0;};_feaa :=&symbol {_aaba :"\u0020",_fgbgf :_fddg };_bcdf .addTextSymbol (_feaa );_bcdf ._eeac ._aec +=(_acbg ._gecf +_acbg ._ffbb );};func (_fbd *convertContext )getShapes (_cfe *_e .CT_Shape )[]_ab .Drawable {_gcd :=[]_ab .Drawable {};_fba :=_cfe .SpPr ;if _fba ==nil {return _gcd ;};var _afa bool ;if _fdg :=_cfe .UseBgFillAttr ;_fdg !=nil {_afa =*_fdg ;};_bfa ,_fcf ,_aca ,_ffa ,_ggg ,_gag ,_cgg :=_fbd .getShapesFromSpPr (_fba ,_cfe .Style ,_afa );_gcd =append (_gcd ,_bfa ...);if _eadb :=_cfe .TxBody ;_eadb !=nil {_adc ,_gbc ,_adac ,_fgdf ,_gagd :=_fbd .getPhData (_cfe );if _adc !=nil &&!_cgg {_fcf ,_aca ,_ffa ,_ggg =_gc .GetDataFromXfrm (_adc );};_cda ,_eab :=_fbd .makePdfBlockFromTxBody (_eadb ,_gbc ,_adac ,_ffa ,_ggg ,_gag ,_fgdf ,_gagd );if _eab !=nil {_bd .Log .Debug ("\u0043\u0061\u006e\u006e\u006f\u0074\u0020\u006d\u0061\u006b\u0065\u0020\u0050\u0044\u0046\u0020\u0062\u006c\u006f\u0063\u006b\u0020\u0066\u0072o\u006d\u0020\u0074\u0065\u0078t\u0062\u006fx\u003a\u0020\u0025\u0073",_eab );}else if _cda !=nil {_cda .SetPos (_fcf ,_aca );_gcd =append (_gcd ,_cda );};};return _gcd ;};func _aaee (_gage ,_edbe *_beb .CT_TextCharacterProperties )*_beb .CT_TextCharacterProperties {_babc :=_beb .NewCT_TextCharacterProperties ();if _gage !=nil {*_babc =*_gage ;};if _edbe ==nil {return _babc ;};if _babc .KumimojiAttr ==nil {_babc .KumimojiAttr =_edbe .KumimojiAttr ;};if _babc .LangAttr ==nil {_babc .LangAttr =_edbe .LangAttr ;};if _babc .AltLangAttr ==nil {_babc .AltLangAttr =_edbe .AltLangAttr ;};if _babc .SzAttr ==nil {_babc .SzAttr =_edbe .SzAttr ;};if _babc .BAttr ==nil {_babc .BAttr =_edbe .BAttr ;};if _babc .IAttr ==nil {_babc .IAttr =_edbe .IAttr ;};if _babc .UAttr ==_beb .ST_TextUnderlineTypeUnset {_babc .UAttr =_edbe .UAttr ;};if _babc .StrikeAttr ==_beb .ST_TextStrikeTypeUnset {_babc .StrikeAttr =_edbe .StrikeAttr ;};if _babc .KernAttr ==nil {_babc .KernAttr =_edbe .KernAttr ;};if _babc .CapAttr ==_beb .ST_TextCapsTypeUnset {_babc .CapAttr =_edbe .CapAttr ;};if _babc .SpcAttr ==nil {_babc .SpcAttr =_edbe .SpcAttr ;};if _babc .NormalizeHAttr ==nil {_babc .NormalizeHAttr =_edbe .NormalizeHAttr ;};if _babc .BaselineAttr ==nil {_babc .BaselineAttr =_edbe .BaselineAttr ;};if _babc .NoProofAttr ==nil {_babc .NoProofAttr =_edbe .NoProofAttr ;};if _babc .DirtyAttr ==nil {_babc .DirtyAttr =_edbe .DirtyAttr ;};if _babc .ErrAttr ==nil {_babc .ErrAttr =_edbe .ErrAttr ;};if _babc .SmtCleanAttr ==nil {_babc .SmtCleanAttr =_edbe .SmtCleanAttr ;};if _babc .SmtIdAttr ==nil {_babc .SmtIdAttr =_edbe .SmtIdAttr ;};if _babc .BmkAttr ==nil {_babc .BmkAttr =_edbe .BmkAttr ;};if _babc .Ln ==nil {_babc .Ln =_edbe .Ln ;};if _babc .NoFill ==nil {_babc .NoFill =_edbe .NoFill ;};if _babc .SolidFill ==nil {_babc .SolidFill =_edbe .SolidFill ;};if _babc .BlipFill ==nil {_babc .BlipFill =_edbe .BlipFill ;};if _babc .EffectLst ==nil {_babc .EffectLst =_edbe .EffectLst ;};if _babc .EffectDag ==nil {_babc .EffectDag =_edbe .EffectDag ;};if _babc .Highlight ==nil {_babc .Highlight =_edbe .Highlight ;};if _babc .ULnTx ==nil {_babc .ULnTx =_edbe .ULnTx ;};if _babc .ULn ==nil {_babc .ULn =_edbe .ULn ;};if _babc .UFillTx ==nil {_babc .UFillTx =_edbe .UFillTx ;};if _babc .UFill ==nil {_babc .UFill =_edbe .UFill ;};if _babc .Latin ==nil {_babc .Latin =_edbe .Latin ;};if _babc .Ea ==nil {_babc .Ea =_edbe .Ea ;};if _babc .Cs ==nil {_babc .Cs =_edbe .Cs ;};if _babc .Sym ==nil {_babc .Sym =_edbe .Sym ;};if _babc .Rtl ==nil {_babc .Rtl =_edbe .Rtl ;};return _babc ;};func (_eaf *convertContext )drawSlide (){_eaf ._faf .NewPage ();for _ ,_deg :=range _eaf ._eaa {if _deg !=nil {_eaf ._faf .MoveTo (0,0);_eaf ._faf .Draw (_deg );};};};func (_bdd *textboxContext )addTextSymbol (_gecb *symbol ){_ebcd :=_ab .New ();_gebc :=_ebcd .NewStyledParagraph ();_gebc .SetMargins (0,0,0,0);_aegd :=_gebc .Append (_gecb ._aaba );_afdd :=0.0;if _gecb ._ecbd !=nil {_aegd .Style =*_gecb ._ecbd ;if _gecb ._ecbd .CharSpacing !=0{_afdd =_gecb ._ecbd .CharSpacing ;};};_gecb ._daac =_gebc .Height ();_gecb ._eaff =_gebc .Height ()*1.2;if _gecb ._eaff < _bdd ._dff ._eae {_gecb ._eaff =_bdd ._dff ._eae ;};if _gecb ._fgbgf ==0{_gecb ._fgbgf =_gebc .Width ()+_afdd ;};if len (_bdd ._eeac ._acdf )> 0{_caec :=_bdd ._eeac ._acdf [len (_bdd ._eeac ._acdf )-1]._aaba ;if _bdd ._dff ._bgd ||_gc .IsNoSpaceLanguage (_caec )||(_caec =="\u0020")!=(_gecb ._aaba =="\u0020"){_bdd .addCurrentWordToParagraph ();_bdd .newWord ();};};_bdd ._eeac ._acdf =append (_bdd ._eeac ._acdf ,_gecb );_gecb ._bbca =_bdd ._eeac ._ebdg ;_bdd ._eeac ._ebdg +=_gecb ._fgbgf ;if _gecb ._aaba !="\u0020"{_bdd ._eeac ._cdfb =false ;};};func (_cbd *convertContext )getShapesFromSpPr (_aaa *_beb .CT_ShapeProperties ,_dce *_beb .CT_ShapeStyle ,_fbc bool )([]_ab .Drawable ,float64 ,float64 ,float64 ,float64 ,_ab .Color ,bool ){_afe :=[]_ab .Drawable {};var _geab ,_aea ,_bdaf ,_fbb ,_dfg float64 ;var _fbf ,_fae ,_bcda ,_gde _ab .Color ;var _bff *_beb .CT_BlipFillProperties ;_gba ,_adbg :=1.0,1.0;if _dce !=nil {_fbf ,_fae ,_gde =_cbd .getStyleColors (_dce );};if _dfge :=_aaa .Ln ;_dfge !=nil {if _dfge .NoFill !=nil {_bcda ,_dfg =nil ,0;}else {_bcda ,_dfg ,_gba =_cbd .getInfoFromLn (_dfge );if _bcda ==nil {_bcda =_gde ;};};};if _aaa .NoFill !=nil {_fae ,_adbg =nil ,0;}else if _fbc {_fae =_cbd ._agf ._bbfgb ;_adbg =_cbd ._agf ._efef ;_bff =_cbd ._agf ._gab ;}else if _acad :=_aaa .SolidFill ;_acad !=nil {_fae ,_adbg =_cbd .getColorFromSolidFill (_acad );};var _eed bool ;if _cbaf :=_aaa .Xfrm ;_cbaf !=nil {_geab ,_aea ,_bdaf ,_fbb =_gc .GetDataFromXfrm (_cbaf );_eed =true ;};if _ccd :=_aaa .CustGeom ;_ccd !=nil {_cac :=[]_ad .Point {};_bdc ,_geb :=1.0,1.0;if _bbb :=_ccd .PathLst ;_bbb !=nil {for _ ,_fdd :=range _bbb .Path {if _fdd !=nil {if _daf :=_fdd .WAttr ;_daf !=nil {_bdc =_bdaf /_c .FromEMU (*_daf );};if _fef :=_fdd .HAttr ;_fef !=nil {_geb =_fbb /_c .FromEMU (*_fef );};for _ ,_bbc :=range _fdd .Close {if _bbc !=nil {};};for _ ,_agc :=range _fdd .MoveTo {if _agc !=nil &&_agc .Pt !=nil {_egc ,_gfb :=_fgc (_agc .Pt );_cac =append (_cac ,_ad .Point {X :_egc *_bdc +_geab ,Y :_gfb *_geb +_aea });};};for _ ,_cde :=range _fdd .LnTo {if _cde !=nil &&_cde .Pt !=nil {_adcb ,_cdea :=_fgc (_cde .Pt );_cac =append (_cac ,_ad .Point {X :_adcb *_bdc +_geab ,Y :_cdea *_geb +_aea });};};_ccdc :=_cbd ._faf .NewPolygon ([][]_ad .Point {_cac });_ccdc .SetFillColor (_fae );_ccdc .SetFillOpacity (_adbg );_ccdc .SetBorderWidth (_dfg );if _bcda !=nil {_ccdc .SetBorderColor (_bcda );_ccdc .SetBorderOpacity (_gba );};_afe =append (_afe ,_ccdc );};};};};if _eeg :=_aaa .PrstGeom ;_eeg !=nil {switch _eeg .PrstAttr {case _beb .ST_ShapeTypeRect :if _bff !=nil {_dbg :=_cbd .getShapeFromBlipFill (_bff ,_geab ,_aea ,_bdaf ,_fbb );_afe =append (_afe ,_dbg );}else {_fgb :=_cbd ._faf .NewRectangle (_geab ,_aea ,_bdaf ,_fbb );_fgb .SetFillColor (_fae );_fgb .SetFillOpacity (_adbg );_fgb .SetBorderWidth (_dfg );if _bcda !=nil {_fgb .SetBorderColor (_bcda );_fgb .SetBorderOpacity (_gba );};_afe =append (_afe ,_fgb );};case _beb .ST_ShapeTypeLine :_cacb :=_cbd ._faf .NewLine (_geab ,_aea ,_geab +_bdaf ,_aea +_fbb );_cacb .SetLineWidth (_dfg );if _bcda !=nil {_cacb .SetColor (_bcda );};_afe =append (_afe ,_cacb );};};return _afe ,_geab ,_aea ,_bdaf ,_fbb ,_fbf ,_eed ;};func (_cebb *textboxContext )assignPropsToCurrentParagraph (_efd *_beb .CT_TextParagraphProperties ){_fagdb :=12.4;if _efd ==nil {_cebb ._dff ._eae =_fagdb ;return ;};if _gcgc :=_efd .DefRPr ;_gcgc !=nil {_agdc :=_gcgc .SzAttr ;if _agdc !=nil {_acda :=float64 (*_agdc )/1200;if _fagdb <=_acda {_fagdb =_acda ;};};};if _dbbbc :=_efd .MarLAttr ;_dbbbc !=nil {_cebb ._dff ._aegg =_c .FromEMU (int64 (*_dbbbc ));};_cebb ._dff ._acf =_cebb ._gdcf ;if _abae :=_efd .MarRAttr ;_abae !=nil {_cebb ._dff ._acf -=_c .FromEMU (int64 (*_abae ));};if _dgf :=_efd .IndentAttr ;_dgf !=nil {_cebb ._dff ._fbce =_c .FromEMU (int64 (*_dgf ));};if _cefe :=_efd .LatinLnBrkAttr ;_cefe !=nil {_cebb ._dff ._bgd =*_cefe ;};if _cggf :=_efd .LnSpc ;_cggf !=nil {if _cbf :=_cggf .SpcPct ;_cbf !=nil {if _addf :=_cbf .ValAttr .ST_TextSpacingPercent ;_addf !=nil {_fagdb =float64 (*_addf )/5000;};};};var _gae float64 ;if _agdf :=_efd .SpcBef ;_agdf !=nil {if _gbe :=_agdf .SpcPts ;_gbe !=nil {_gae =float64 (_gbe .ValAttr )/100;};};_agff :=_cebb ._eca ;if len (_agff )> 0{_gae -=_agff [len (_agff )-1]._dfbg ;if _gae < 0{_gae =0;};};_cebb ._dff ._daag =_gae ;if _ddbb :=_efd .SpcAft ;_ddbb !=nil {if _abc :=_ddbb .SpcPts ;_abc !=nil {_cebb ._dff ._dfbg =float64 (_abc .ValAttr )/100;};};_cebb ._dff ._eae =_fagdb ;_cebb ._dff ._debb =_efd .AlgnAttr ;};type symbolStyle struct{_egb *string ;_aed *float64 ;_bae *string ;_dgdc *bool ;_dda *bool ;_cedg *bool ;_gdaa *bool ;_cdcc *bool ;};func (_bead *convertContext )getPhData (_ggeb *_e .CT_Shape )(*_beb .CT_Transform2D ,*_beb .CT_TextBodyProperties ,*_beb .CT_TextListStyle ,bool ,bool ){_egbb ,_eagfb :=_cfecf (_ggeb );_cfdb :=_eagfb ==nil ;_eafd ,_gfee ,_cdde ,_dfbd :=_eegd (_bead ._gced .CSld ,_egbb ,_eagfb ,_cfdb );_dbdf ,_deba ,_ffcc ,_dbfa :=_eegd (_bead ._baf .CSld ,_egbb ,_eagfb ,_cfdb );if _dbdf ==nil {_dbdf =_eafd ;};_bbde ,_gbee :=_aegc (_deba ,_gfee );var _ffdd ,_aegf bool ;if _ffcc ==nil {if _cdde !=nil {_ffdd =*_cdde ;};}else {_ffdd =*_ffcc ;};if _dbfa ==nil {if _dfbd !=nil {_aegf =*_dfbd ;};}else {_aegf =*_dbfa ;};return _dbdf ,_bbde ,_gbee ,_ffdd ,_aegf ;};var _eg =_faed (1.9);func (_eaea *convertContext )applyBlipEffectsOnImg (_cbcc *_ab .Image ,_gebe ,_gddc float64 ,_bace []*_beb .CT_BlipChoice )*_ab .Image {if len (_bace )==0{return _cbcc ;};_cbcc .SetPos (_gebe ,_gddc );_fgdfc ,_eaaa :=_eaea .renderPageWithDrawableToGoImage (_cbcc );if _eaaa !=nil {_bd .Log .Debug ("\u0045\u0072\u0072\u006f\u0072\u0020\u0072\u0065\u006e\u0064\u0065\u0072\u0020a\u006e\u0020\u0069\u006d\u0061\u0067e\u0020\u0074\u006f\u0020\u0061\u0020\u0047\u006f\u0020\u0069\u006d\u0061\u0067e\u003a\u0020\u0025\u0073",_eaaa );return _cbcc ;};_ebcee ,_eaaa :=_eaea .renderCurrentStateToGoImage ();if _eaaa !=nil {_bd .Log .Debug ("\u0045\u0072\u0072\u006f\u0072\u0020\u0072\u0065n\u0064\u0065\u0072 t\u0068\u0065\u0020\u0063\u0075\u0072r\u0065\u006e\u0074\u0020\u0073\u0074\u0061\u0074\u0065\u0020\u0074\u006f\u0020\u0061\u0020G\u006f\u0020\u0069\u006d\u0061\u0067\u0065\u003a \u0025\u0073",_eaaa );return _cbcc ;};_afgb :=_fgdfc .Bounds ();_geag :=_bf .NewRGBA (_afgb );_gfgef ,_cefea :=_cbcc .Width (),_cbcc .Height ();for _ ,_gcdac :=range _bace {for _ ,_cebgc :=range _gcdac .AlphaModFix {if _edbef :=_cebgc .AmtAttr ;_edbef !=nil {if _cfba :=_edbef .ST_PositivePercentageDecimal ;_cfba !=nil {_gbcf :=uint8 (255*(*_cfba )/100000);_cccba :=_bf .NewUniform (_d .Alpha {_gbcf });_bg .Draw (_geag ,_afgb ,_ebcee ,_bf .Point {0,0},_bg .Src );_bg .DrawMask (_geag ,_afgb ,_fgdfc ,_bf .Point {0,0},_cccba ,_bf .Point {0,0},_bg .Over );};};};};_cafc :=_bf .Rect (int (_gebe ),int (_gddc ),int (_gebe +_gfgef )+1,int (_gddc +_cefea )+1);_cebe :=_gc .CropImageByRect (_geag ,_cafc );_daeac ,_eaaa :=_eaea ._faf .NewImageFromGoImage (_cebe );if _eaaa !=nil {_bd .Log .Debug ("\u0045\u0072\u0072\u006f\u0072\u0020\u0061\u006e\u0020\u0069\u006d\u0061\u0067\u0065\u0020t\u006f \u0061\u0020\u0047\u006f\u0020\u0069\u006d\u0061\u0067\u0065\u003a\u0020\u0025\u0073",_eaaa );return _cbcc ;};return _daeac ;};func (_efbd *convertContext )makePdfBlockFromTable (_dfc *_beb .Tbl ,_dac float64 )*_ab .Table {_ffab :=_dfc .TblGrid ;if _ffab ==nil {return nil ;};_dfee :=len (_ffab .GridCol );if _dfee ==0{return nil ;};_bfg :=[]float64 {};_adgc :=0.0;for _ ,_eade :=range _ffab .GridCol {_cfd :=_c .FromEMU (_gc .FromSTCoordinate (_eade .WAttr ));_bfg =append (_bfg ,_cfd );_adgc +=_cfd ;};_daaa :=[]float64 {};for _fdc :=0;_fdc < _dfee ;_fdc ++{_daaa =append (_daaa ,_bfg [_fdc ]/_adgc );};_cdb :=_efbd ._faf .NewTable (_dfee );_cdb .SetColumnWidths (_daaa ...);_fceb :=_dfc .TblPr ;var _gcfdd *_beb .CT_TableStyle ;if _ged :=_fceb .Choice ;_ged !=nil {if _ged .TableStyle !=nil {_gcfdd =_ged .TableStyle ;}else if _ged .TableStyleId !=nil {_gcfdd =_efbd ._bdce .GetTableStyleById (*_ged .TableStyleId );};};_ega :=_beb .NewCT_TablePartStyle ();_ega .TcStyle =_beb .NewCT_TableStyleCellStyle ();_ega .TcTxStyle =_beb .NewCT_TableStyleTextStyle ();if _gcfdd !=nil {if _gcfdd .WholeTbl !=nil {*_ega =*_gcfdd .WholeTbl ;};if _gcfdd .TblBg !=nil {if _ega .TcStyle .Fill ==nil {_ega .TcStyle .Fill =_gcfdd .TblBg .Fill ;};};};if _ega .TcStyle .Fill ==nil {_ega .TcStyle .Fill =_beb .NewCT_FillProperties ();_ega .TcStyle .Fill .NoFill =_fceb .NoFill ;_ega .TcStyle .Fill .SolidFill =_fceb .SolidFill ;};_dgca :=len (_dfc .Tr );for _deb ,_cbaa :=range _dfc .Tr {_ecb :=_deb ==0;_cbg :=_deb ==_dgca -1;_bcdb :=_deb %2==0;_dbbb :=len (_cbaa .Tc );var _bgcc *_beb .CT_TablePartStyle ;if _ecb {_bgcc =_gcfdd .FirstRow ;}else if _bcdb {_bgcc =_gcfdd .Band2H ;}else {_bgcc =_gcfdd .Band1H ;};var _baad float64 ;for _edbf ,_eceb :=range _cbaa .Tc {_dfcf :=_edbf ==0;_fbdf :=_edbf ==_dbbb -1;_dfea :=_edbf %2==0;var _afce *_beb .CT_TablePartStyle ;if _dfcf {_afce =_gcfdd .FirstCol ;}else if _dfea {_afce =_gcfdd .Band2V ;}else {_afce =_gcfdd .Band1V ;};_aeaa :=_bcbbg (_bcbbg (_afce ,_bgcc ),_ega );_gdcb :=_efbd .addCellToTable (_cdb ,_eceb ,_aeaa ,_dac *_daaa [_edbf ],_ecb ,_cbg ,_dfcf ,_fbdf );if _gdcb > _baad {_baad =_gdcb ;};};_ebfdf :=_c .FromEMU (_gc .FromSTCoordinate (_cbaa .HAttr ));if _ebfdf < _baad {_ebfdf =_baad ;};if _ebfdf < _faed (4){_ebfdf =_faed (4);};_cdb .SetRowHeight (_cdb .CurRow (),_ebfdf );};return _cdb ;};func _dgac (_dafcc int ,_egcc bool )string {_fcee :=(_dafcc -1)/26+1;_caa :=byte ((_dafcc -1)%26);if _egcc {_caa +=byte (65);}else {_caa +=byte (97);};_bge :=_be .NewBuffer ([]byte {});for _aabaf :=0;_aabaf < _fcee ;_aabaf ++{_bge .Write ([]byte {_caa });};return _bge .String ();};func (_cddc *convertContext )getBorderStyle (_dgdd *_beb .CT_LineProperties )(_ab .CellBorderStyle ,*_ab .Color ,float64 ){if _dgdd ==nil ||_dgdd .NoFill !=nil {return _ab .CellBorderStyleNone ,nil ,0;};var _afff _ab .Color ;if _dccc :=_dgdd .SolidFill ;_dccc !=nil {_afff ,_ =_cddc .getColorFromSolidFill (_dccc );};_bbfg :=0.0;if _ccca :=_dgdd .WAttr ;_ccca !=nil {_bbfg =_c .FromEMU (int64 (*_ccca ));};return _ab .CellBorderStyleSingle ,&_afff ,_bbfg ;};func (_dag *textboxContext )addCurrentParagraph (){_dag ._fgbd =_dag ._dff ._dgec +_dag ._dff ._daag +_dag ._dff ._ddga +_dag ._dff ._dfbg ;_dag ._eca =append (_dag ._eca ,_dag ._dff );_dag .alignParagraph ();};func (_bc *convertContext )extractDefaultProperties (){_ccf :=_bc ._bdce .X ();_bcd :=_ccf .DefaultTextStyle ;var _eb ,_aa ,_ff ,_fc ,_bda ,_ada ,_ce ,_gff ,_cdg ,_ca *_beb .CT_TextParagraphProperties ;if _bcd !=nil {_eb =_bcd .DefPPr ;_aa =_fdcc (_bcd .Lvl1pPr ,_eb );_ff =_fdcc (_bcd .Lvl2pPr ,_eb );_fc =_fdcc (_bcd .Lvl3pPr ,_eb );_bda =_fdcc (_bcd .Lvl4pPr ,_eb );_ada =_fdcc (_bcd .Lvl5pPr ,_eb );_ce =_fdcc (_bcd .Lvl6pPr ,_eb );_gff =_fdcc (_bcd .Lvl7pPr ,_eb );_cdg =_fdcc (_bcd .Lvl8pPr ,_eb );_ca =_fdcc (_bcd .Lvl9pPr ,_eb );_bc ._gfge =_eb ;_bc ._def =_eb .DefRPr ;};_bc ._fag =make ([]*_beb .CT_TextParagraphProperties ,9);_bc ._fag [0]=_aa ;_bc ._fag [1]=_ff ;_bc ._fag [2]=_fc ;_bc ._fag [3]=_bda ;_bc ._fag [4]=_ada ;_bc ._fag [5]=_ce ;_bc ._fag [6]=_gff ;_bc ._fag [7]=_cdg ;_bc ._fag [8]=_ca ;_bdb :=_bc ._bdce .SlideMasters ()[0].X ();_ga :=_bdb .TxStyles ;_fa :=_ga .TitleStyle ;_bc ._ecf =_fdcc (_fa .DefPPr ,_eb );_bc ._cggd =_bc ._ecf .DefRPr ;_bc ._gdga =make ([]*_beb .CT_TextParagraphProperties ,9);_bc ._gdga [0]=_fdcc (_fa .Lvl1pPr ,_aa );_bc ._gdga [1]=_fdcc (_fa .Lvl2pPr ,_ff );_bc ._gdga [2]=_fdcc (_fa .Lvl3pPr ,_fc );_bc ._gdga [3]=_fdcc (_fa .Lvl4pPr ,_bda );_bc ._gdga [4]=_fdcc (_fa .Lvl5pPr ,_ada );_bc ._gdga [5]=_fdcc (_fa .Lvl6pPr ,_ce );_bc ._gdga [6]=_fdcc (_fa .Lvl7pPr ,_gff );_bc ._gdga [7]=_fdcc (_fa .Lvl8pPr ,_cdg );_bc ._gdga [8]=_fdcc (_fa .Lvl9pPr ,_ca );_ccg :=_ga .BodyStyle ;_bc ._caca =_fdcc (_ccg .DefPPr ,_eb );_bc ._fgfg =_bc ._caca .DefRPr ;_bc ._bebc =make ([]*_beb .CT_TextParagraphProperties ,9);_bc ._bebc [0]=_fdcc (_ccg .Lvl1pPr ,_aa );_bc ._bebc [1]=_fdcc (_ccg .Lvl2pPr ,_ff );_bc ._bebc [2]=_fdcc (_ccg .Lvl3pPr ,_fc );_bc ._bebc [3]=_fdcc (_ccg .Lvl4pPr ,_bda );_bc ._bebc [4]=_fdcc (_ccg .Lvl5pPr ,_ada );_bc ._bebc [5]=_fdcc (_ccg .Lvl6pPr ,_ce );_bc ._bebc [6]=_fdcc (_ccg .Lvl7pPr ,_gff );_bc ._bebc [7]=_fdcc (_ccg .Lvl8pPr ,_cdg );_bc ._bebc [8]=_fdcc (_ccg .Lvl9pPr ,_ca );};func (_dgacf *textboxContext )newParagraph (){_ggge :=&paragraph {};_ggge ._dgec =_dgacf ._fgbd ;_dgacf ._dff =_ggge ;};var _ceeb =[]romanMatch {romanMatch {1000,"\u006d"},romanMatch {900,"\u0063\u006d"},romanMatch {500,"\u0064"},romanMatch {400,"\u0063\u0064"},romanMatch {100,"\u0063"},romanMatch {90,"\u0078\u0063"},romanMatch {50,"\u006c"},romanMatch {40,"\u0078\u006c"},romanMatch {10,"\u0078"},romanMatch {9,"\u0069\u0078"},romanMatch {5,"\u0076"},romanMatch {4,"\u0069\u0076"},romanMatch {1,"\u0069"}};const (FontStyle_Regular FontStyle =0;FontStyle_Bold FontStyle =1;FontStyle_Italic FontStyle =2;FontStyle_BoldItalic FontStyle =3;);func _bcbbg (_ccgb ,_adad *_beb .CT_TablePartStyle )*_beb .CT_TablePartStyle {_cdbf :=_beb .NewCT_TablePartStyle ();if _ccgb !=nil {*_cdbf =*_ccgb ;};if _adad ==nil {return _cdbf ;};if _cdbf .TcTxStyle ==nil {_cdbf .TcTxStyle =_adad .TcTxStyle ;}else {_cdbf .TcTxStyle =_bgfg (_cdbf .TcTxStyle ,_adad .TcTxStyle );};if _cdbf .TcStyle ==nil {_cdbf .TcStyle =_adad .TcStyle ;}else {_cdbf .TcStyle =_cgac (_cdbf .TcStyle ,_adad .TcStyle );};return _cdbf ;};func _ceebf (_beba *_beb .CT_TextCharacterProperties ,_geabg *_beb .CT_TableStyleTextStyle )*_beb .CT_TextCharacterProperties {_cafd :=_beb .NewCT_TextCharacterProperties ();if _beba !=nil {*_cafd =*_beba ;};if _geabg ==nil {return _cafd ;};if _cafd .BAttr ==nil &&_geabg .BAttr !=_beb .ST_OnOffStyleTypeUnset {_bdgc :=_geabg .BAttr ==_beb .ST_OnOffStyleTypeOn ;_cafd .BAttr =&_bdgc ;};if _cafd .IAttr ==nil &&_geabg .IAttr !=_beb .ST_OnOffStyleTypeUnset {_bdeb :=_geabg .IAttr ==_beb .ST_OnOffStyleTypeOn ;_cafd .IAttr =&_bdeb ;};if _cafd .NoFill ==nil &&_cafd .SolidFill ==nil {_cafd .SolidFill =_beb .NewCT_SolidColorFillProperties ();_cafd .SolidFill .ScrgbClr =_geabg .ScrgbClr ;_cafd .SolidFill .SrgbClr =_geabg .SrgbClr ;_cafd .SolidFill .HslClr =_geabg .HslClr ;_cafd .SolidFill .SysClr =_geabg .SysClr ;_cafd .SolidFill .SchemeClr =_geabg .SchemeClr ;_cafd .SolidFill .PrstClr =_geabg .PrstClr ;};if _ecaf :=_geabg .Font ;_ecaf !=nil &&_cafd .Latin ==nil &&_cafd .Ea ==nil &&_cafd .Cs ==nil {_cafd .Latin =_ecaf .Latin ;_cafd .Ea =_ecaf .Ea ;_cafd .Cs =_ecaf .Cs ;};return _cafd ;};

// RegisterFontsFromDirectory registers all fonts from the given directory automatically detecting font families and styles.
func RegisterFontsFromDirectory (dirName string )error {return _gc .RegisterFontsFromDirectory (dirName )};func (_gaae *convertContext )getStyleColors (_cafb *_beb .CT_ShapeStyle )(_ab .Color ,_ab .Color ,_ab .Color ){var _cgbd ,_dace ,_efdd _ab .Color ;if _ebge :=_cafb .LnRef ;_ebge !=nil {_dace =_gaae .getColorFromMatrixReference (_ebge );};if _febf :=_cafb .FillRef ;_febf !=nil {_efdd =_gaae .getColorFromMatrixReference (_febf );};if _eggf :=_cafb .FontRef ;_eggf !=nil {_cgbd =_gaae .getColorFromFontReference (_eggf );};return _cgbd ,_efdd ,_dace ;};var _bfcca =map[string ]int32 {"\u0076":9830,"\u00d8":8594,"\u00fc":8730};func (_cdcd *textboxContext )addTextRun (_agfa *_beb .EG_TextRun ,_ecfg *_beb .CT_TextCharacterProperties ,_gdeg _ab .Color ,_cecc *prefixData ){if _cdca :=_agfa .Br ;_cdca !=nil {_cdcd .addCurrentWordToParagraph ();_cdcd .newLine ();_cdcd .newWord ();}else if _acfc :=_agfa .R ;_acfc !=nil {var _gfba _ab .Color ;if _acfc .RPr .SolidFill !=nil {_gfba ,_ =_cdcd ._fgbf .getColorFromSolidFill (_acfc .RPr .SolidFill );}else if _gdeg !=nil {_gfba =_gdeg ;}else if _ecfg .SolidFill !=nil {_gfba ,_ =_cdcd ._fgbf .getColorFromSolidFill (_ecfg .SolidFill );}else {_gfba =_ab .ColorBlack ;};_gfdf :=_aaee (_acfc .RPr ,_ecfg );_adbd ,_eagf ,_dbba ,_ceebb :=_cdcd ._fgbf .makeStyleFromRPr (_gfdf );_adbd .Color =_gfba ;if _cecc !=nil {_cdcd .addPrefix (_cecc ,_adbd );};_gfdb :=_afba (_acfc .T );for _ ,_bbfgf :=range _gfdb {_bbfgf ._ecbd =_adbd ;_bbfgf ._fagd =_eagf ;_bbfgf ._defc =_dbba ;_bbfgf ._ced =_ceebb ;if _gfdf .CapAttr ==_beb .ST_TextCapsTypeAll {_bbfgf ._aaba =_db .ToUpper (_bbfgf ._aaba );};_cdcd .addTextSymbol (_bbfgf );};};};func (_ggdf *convertContext )addCellToTable (_ffbg *_ab .Table ,_afgf *_beb .CT_TableCell ,_agg *_beb .CT_TablePartStyle ,_afbg float64 ,_fge ,_eceg ,_ceb ,_ecd bool )float64 {var _bcbd *_ab .TableCell ;_ebg :=1;if _afgf .GridSpanAttr !=nil {_ebg =int (*_afgf .GridSpanAttr );};_bcbd =_ffbg .MultiColCell (_ebg );_aab :=_afgf .TcPr ;var _cbe *_beb .CT_TableStyleTextStyle ;if _agg !=nil {_aab =_fgcg (_aab ,_agg .TcStyle ,_fge ,_eceg ,_ceb ,_ecd );_cbe =_agg .TcTxStyle ;};_ffaf :=_eg ;_fbg :=_ab .CellVerticalAlignmentMiddle ;if _aab !=nil {if _aba :=_aab .LnL ;_aba !=nil {_bcgd ,_bfdc ,_gaa :=_ggdf .getBorderStyle (_aba );_bcbd .SetBorder (_ab .CellBorderSideLeft ,_bcgd ,_gaa );if _bfdc !=nil &&*_bfdc !=nil {_bcbd .SetSideBorderColor (_ab .CellBorderSideLeft ,*_bfdc );};};if _cfb :=_aab .LnT ;_cfb !=nil {_gcdb ,_bga ,_dfdf :=_ggdf .getBorderStyle (_cfb );_bcbd .SetBorder (_ab .CellBorderSideTop ,_gcdb ,_dfdf );if _bga !=nil &&*_bga !=nil {_bcbd .SetSideBorderColor (_ab .CellBorderSideTop ,*_bga );};};if _aege :=_aab .LnR ;_aege !=nil {_gfe ,_bcgc ,_dge :=_ggdf .getBorderStyle (_aege );_bcbd .SetBorder (_ab .CellBorderSideRight ,_gfe ,_dge );if _bcgc !=nil &&*_bcgc !=nil {_bcbd .SetSideBorderColor (_ab .CellBorderSideRight ,*_bcgc );};};if _feb :=_aab .LnB ;_feb !=nil {_bfdcf ,_ddef ,_dbfg :=_ggdf .getBorderStyle (_feb );_bcbd .SetBorder (_ab .CellBorderSideBottom ,_bfdcf ,_dbfg );if _ddef !=nil &&*_ddef !=nil {_bcbd .SetSideBorderColor (_ab .CellBorderSideBottom ,*_ddef );};};if _ggcf :=_aab .MarLAttr ;_ggcf !=nil {_ffaf =float64 (_gc .FromSTCoordinate32 (*_ggcf ));};switch _aab .AnchorAttr {case _beb .ST_TextAnchoringTypeT :_fbg =_ab .CellVerticalAlignmentTop ;case _beb .ST_TextAnchoringTypeB :_fbg =_ab .CellVerticalAlignmentBottom ;};if _aab .NoFill ==nil {if _dfgg :=_aab .SolidFill ;_dfgg !=nil {_aafg ,_ :=_ggdf .getColorFromSolidFill (_dfgg );_bcbd .SetBackgroundColor (_aafg );};};};_bcbd .SetVerticalAlignment (_fbg );_bcbd .SetIndent (_ffaf );var _adbf float64 ;if _bebg :=_afgf .TxBody ;_bebg !=nil {_bfgc :=_ggdf .makePdfDivisionFromTxBody (_bebg ,_afbg ,_adbf ,_cbe );_adbf =_bfgc .Height ();_bcbd .SetContent (_bfgc );};return _adbf ;};func (_gef *convertContext )makePdfDivisionFromTxBody (_bab *_beb .CT_TextBody ,_fdbc ,_cdc float64 ,_accd *_beb .CT_TableStyleTextStyle )*_ab .Division {_gbb :=_gef ._faf .NewDivision ();_bbf :=_gef ._gfge ;_eef :=_beb .ST_TextAnchoringTypeT ;if _bfb :=_bab .BodyPr ;_bfb !=nil {if _fce :=_bfb .AnchorAttr ;_fce !=_beb .ST_TextAnchoringTypeUnset {_eef =_bfb .AnchorAttr ;};};if _baba :=_bab .LstStyle ;_baba !=nil {var _dde *_beb .CT_TextParagraphProperties ;if _baba .Lvl1pPr !=nil {_dde =_baba .Lvl1pPr ;}else {_dde =_gef ._fag [0];};_bbf =_fdcc (_dde ,_fdcc (_baba .DefPPr ,_bbf ));};for _ ,_gcad :=range _bab .P {if _gcad !=nil {_abga :=_gef ._faf .NewStyledParagraph ();_fbe :=_fdcc (_gcad .PPr ,_bbf );_gdfb :=_aaee (_gcad .EndParaRPr ,_fbe .DefRPr );if len (_gcad .EG_TextRun )==0{_abga .Append ("\u000a");_gbb .Add (_abga );continue ;};for _ ,_bfbe :=range _gcad .EG_TextRun {if _gcg :=_bfbe .Br ;_gcg !=nil {_abga .Append ("\u000a");}else if _cff :=_bfbe .R ;_cff !=nil {_afc :=_ceebf (_cff .RPr ,_accd );_afc =_aaee (_afc ,_gdfb );var _fcfe _ab .Color ;if _afc .SolidFill !=nil {_fcfe ,_ =_gef .getColorFromSolidFill (_afc .SolidFill );}else {_fcfe =_ab .ColorBlack ;};_fgbg ,_beaf ,_aeg ,_ :=_gef .makeStyleFromRPr (_afc );_fgbg .Color =_fcfe ;if _beaf {_fgbg .TextRise =0.5;}else if _aeg {_fgbg .TextRise =-0.5;};_bcf :=_cff .T ;if _afc .CapAttr ==_beb .ST_TextCapsTypeAll {for _ ,_efc :=range _bcf {_efc =[]rune (_db .ToUpper (string (_efc )))[0];};};_bcg :=_abga .Append (_bcf );_bcg .Style =*_fgbg ;};};_ =_eef ;_gbb .Add (_abga );};};return _gbb ;};func (_bgfa *textboxContext )adjustHeights (_fbgb float64 ){if _bgfa ._bca ._deae < _fbgb {_bgfa ._dff ._ddga +=(_fbgb -_bgfa ._bca ._deae );_bgfa ._bca ._deae =_fbgb ;};};func (_gdge *line )moveRight (_eeacg float64 ){for _ ,_gfgd :=range _gdge ._cfec {_gfgd ._aec +=_eeacg ;};};func (_ecfd *textboxContext )addCurrentWordToParagraph (){if _ecfd ._fadf &&_ecfd ._bca ._cag +_ecfd ._eeac ._ebdg > _ecfd ._bca ._ceg {_ecfd .newLine ();};if !_ecfd ._eeac ._cdfb ||len (_ecfd ._bca ._cfec )> 0{_ecfd ._eeac ._aec =_ecfd ._bca ._cag ;_ecfd ._bca ._cfec =append (_ecfd ._bca ._cfec ,_ecfd ._eeac );_ecfd ._bca ._cag +=_ecfd ._eeac ._ebdg ;for _ ,_cdbc :=range _ecfd ._eeac ._acdf {_ecfd .adjustHeights (_cdbc ._eaff );};};};func (_fcaf *convertContext )renderPageWithDrawableToGoImage (_cgcg _ab .Drawable )(_bf .Image ,error ){_bfcd :=_gc .MakeTempCreator (_fcaf ._edc ,_fcaf ._aac );_bfcd .NewPage ();_bfcd .Draw (_cgcg );_egdd ,_bfdcb :=_gc .GetPageFromCreator (_bfcd );if _bfdcb !=nil {return nil ,_bfdcb ;};return _gd .NewImageDevice ().Render (_egdd );};func (_bfc *convertContext )stretchImage (_dga *_ab .Image ,_gea *_beb .CT_StretchInfoProperties ,_edf ,_dc ,_dfb ,_afd float64 )(*_ab .Image ,float64 ,float64 ){_cbc :=_gea .FillRect ;if _cbc ==nil {_abe :=_dga .Width ()/_dga .Height ();_edb :=_dfb /_afd ;var _gdf ,_fgd float64 ;if _abe > _edb {_fgd =_afd ;_gdf =_afd *_abe ;}else {_gdf =_dfb ;_fgd =_dfb /_abe ;};_dga .Scale (_gdf /_dga .Width (),_fgd /_dga .Height ());return _dga ,_edf ,_dc ;};var _bba ,_afg ,_cee ,_ffb float64 ;if _baa :=_cbc .LAttr ;_baa !=nil {_cee =_gc .FromSTPercentage (_baa );};if _gdd :=_cbc .TAttr ;_gdd !=nil {_bba =_gc .FromSTPercentage (_gdd );};if _agb :=_cbc .RAttr ;_agb !=nil {_ffb =_gc .FromSTPercentage (_agb );};if _fcc :=_cbc .BAttr ;_fcc !=nil {_afg =_gc .FromSTPercentage (_fcc );};_gcc :=_dfb *(1-_cee -_ffb );_ccgf :=_afd *(1-_bba -_afg );_dga .Scale (_gcc /_dga .Width (),_ccgf /_dga .Height ());return _dga ,_edf +_cee *_dfb ,_dc +_bba *_afd ;};func (_bgee *textboxContext )alignParagraph (){_cedgc :=_bgee ._dff ;if _cedgc ._debb ==_beb .ST_TextAlignTypeL {return ;};_gaaf :=len (_cedgc ._addc )-1;for _afbf ,_dfdg :=range _cedgc ._addc {_cca :=true ;_eaed :=len (_dfdg ._cfec );_afaa :=0.0;for _abcd :=len (_dfdg ._cfec )-1;_abcd >=0;_abcd --{_bcgcc :=_dfdg ._cfec [_abcd ];if _cca &&_bcgcc ._cdfb {_eaed =_abcd ;}else {_cca =false ;for _ ,_ecfb :=range _bcgcc ._acdf {_afaa +=_ecfb ._fgbgf ;};};};_dfdg ._cfec =_dfdg ._cfec [:_eaed ];_eecc :=_dfdg ._ceg -_dfdg ._adf -_afaa ;switch _cedgc ._debb {case _beb .ST_TextAlignTypeR :_dfdg .moveRight (_eecc );case _beb .ST_TextAlignTypeCtr :_dfdg .moveRight (_eecc /2);case _beb .ST_TextAlignTypeJust :if _afbf !=_gaaf {_acce :=[]*word {};for _ ,_dcfg :=range _dfdg ._cfec {if _dcfg ._cdfb {_acce =append (_acce ,_dcfg );};};_fdbg :=_eecc /float64 (len (_acce ));for _ ,_aegdd :=range _acce {_aegdd ._ebdg +=_fdbg ;};var _gggec *word ;for _ ,_ebae :=range _dfdg ._cfec {if _gggec !=nil {_ebae ._aec =_gggec ._aec +_gggec ._ebdg ;};_gggec =_ebae ;};};};};};func (_dceb *convertContext )getShapeFromBlipFill (_dcef *_beb .CT_BlipFillProperties ,_bgdge ,_gccc ,_aefg ,_feg float64 )_ab .Drawable {_ecbe ,_ffcb ,_aggc :=_dceb .makePdfImageFromBlipFill (_dcef );if _aggc !=nil {_bd .Log .Debug ("\u0043\u0061\u006e\u006e\u006f\u0074\u0020\u006d\u0061\u006b\u0065\u0020\u0050D\u0046\u0020\u0069\u006d\u0061\u0067e\u0020\u0066\u0072\u006f\u006d\u0020\u0042\u006c\u0069\u0070\u0046\u0069\u006cl\u003a\u0020\u0025\u0073",_aggc );return nil ;};if _ecbe ==nil {return nil ;};if _eaga :=_dcef .Tile ;_eaga !=nil {_ecbe =_dceb .tileImage (_ecbe ,_dcef .Tile ,_aefg ,_feg );};if _ebdf :=_dcef .Stretch ;_ebdf !=nil {_ecbe ,_bgdge ,_gccc =_dceb .stretchImage (_ecbe ,_dcef .Stretch ,_bgdge ,_gccc ,_aefg ,_feg );};if len (_ffcb )==0{_ecbe .SetPos (_bgdge ,_gccc );return _ecbe ;};_ecbe =_dceb .applyBlipEffectsOnImg (_ecbe ,_bgdge ,_gccc ,_ffcb );_ecbe .SetPos (_bgdge ,_gccc );return _ecbe ;};type line struct{_egd float64 ;_adf float64 ;_ceg float64 ;_cag float64 ;_deae float64 ;_cfec []*word ;};func _afba (_aef string )[]*symbol {_cge :=[]*symbol {};for _ ,_cgca :=range _aef {_cge =append (_cge ,&symbol {_aaba :string (_cgca )});};return _cge ;};func (_cc *convertContext )makePdfBlockFromChart (_da *_gdc .Chart ,_ac ,_ge float64 )(*_ab .Block ,error ){_fe :=_da .CT_RelId .IdAttr ;_af :=_cc ._debd .GetChartSpaceByRelId (_fe );if _af ==nil {return nil ,_g .New ("\u004e\u006f\u0020\u0063\u0068\u0061\u0072\u0074\u0073\u0070\u0061\u0063\u0065");};var _ea *_beb .Theme ;_dd :=_cc ._bdce .Themes ();if len (_dd )> 0{_ea =_dd [0];};return _gc .MakeBlockFromChartSpace (_af ,_ac ,_ge ,_ea );};type word struct{_acdf []*symbol ;_aec float64 ;_ebdg float64 ;_cdfb bool ;};type romanMatch struct{_dbda int ;_cebg string ;};type textboxContext struct{_fgbf *convertContext ;_gdcf float64 ;_gedb float64 ;_daaf *_ab .Creator ;_fgbd float64 ;_eca []*paragraph ;_dff *paragraph ;_bca *line ;_eeac *word ;_fadf bool ;};func (_aaac *textboxContext )drawParagraphs (){_aaac ._daaf .NewPage ();for _ ,_gbeg :=range _aaac ._eca {for _ ,_eda :=range _gbeg ._addc {for _ ,_ddba :=range _eda ._cfec {for _ ,_cgbc :=range _ddba ._acdf {_cbac :=_aaac ._daaf .NewStyledParagraph ();if _cgbc ._fagd {_cgbc ._gaf =0;}else if _cgbc ._defc {_cgbc ._gaf =1.2*_eda ._deae -_cgbc ._daac ;};_cbgd :=_ddba ._aec +_cgbc ._bbca ;_edg :=_gbeg ._dgec +_eda ._egd +_cgbc ._gaf ;_cbac .SetPos (_cbgd ,_edg );_fbfe :=_cbac .Append (_cgbc ._aaba );if _cgbc ._ecbd !=nil {_fbfe .Style =*_cgbc ._ecbd ;};_aaac ._daaf .Draw (_cbac );if _cgbc ._ced {_daeg :=_edg +_cgbc ._daac +2;_gc .DrawLine (_aaac ._daaf ,_cbgd ,_daeg ,_cbgd +_cgbc ._fgbgf ,_daeg ,1,_cgbc ._ecbd .Color );};};};};};};type convertContext struct{_faf *_ab .Creator ;_gdad *_gc .Rectangle ;_bdce *_a .Presentation ;_debd *_a .Slide ;_gced *_e .SldMaster ;_baf *_e .SldLayout ;_aac float64 ;_edc float64 ;_eaa []_ab .Drawable ;_agf *background ;_gfge *_beb .CT_TextParagraphProperties ;_def *_beb .CT_TextCharacterProperties ;_ecf *_beb .CT_TextParagraphProperties ;_cggd *_beb .CT_TextCharacterProperties ;_caca *_beb .CT_TextParagraphProperties ;_fgfg *_beb .CT_TextCharacterProperties ;_fag []*_beb .CT_TextParagraphProperties ;_gdga []*_beb .CT_TextParagraphProperties ;_bebc []*_beb .CT_TextParagraphProperties ;_egfa *_beb .Theme ;_gggf *_beb .CT_ColorMappingOverride ;};func _fbge (_gffa ,_fbdee *_beb .CT_TextListStyle )*_beb .CT_TextListStyle {_gafd :=_beb .NewCT_TextListStyle ();if _gffa !=nil {*_gafd =*_gffa ;};if _fbdee ==nil {return _gafd ;};_gafd .DefPPr =_fdcc (_gafd .DefPPr ,_fbdee .DefPPr );_gafd .Lvl1pPr =_fdcc (_gafd .Lvl1pPr ,_fbdee .Lvl1pPr );_gafd .Lvl2pPr =_fdcc (_gafd .Lvl2pPr ,_fbdee .Lvl2pPr );_gafd .Lvl3pPr =_fdcc (_gafd .Lvl3pPr ,_fbdee .Lvl3pPr );_gafd .Lvl4pPr =_fdcc (_gafd .Lvl4pPr ,_fbdee .Lvl4pPr );_gafd .Lvl5pPr =_fdcc (_gafd .Lvl5pPr ,_fbdee .Lvl5pPr );_gafd .Lvl6pPr =_fdcc (_gafd .Lvl6pPr ,_fbdee .Lvl6pPr );_gafd .Lvl7pPr =_fdcc (_gafd .Lvl7pPr ,_fbdee .Lvl7pPr );_gafd .Lvl8pPr =_fdcc (_gafd .Lvl8pPr ,_fbdee .Lvl8pPr );_gafd .Lvl9pPr =_fdcc (_gafd .Lvl9pPr ,_fbdee .Lvl9pPr );return _gafd ;};func _fgcg (_ddd *_beb .CT_TableCellProperties ,_bcgbf *_beb .CT_TableStyleCellStyle ,_cfcg ,_cgab ,_eee ,_fgbc bool )*_beb .CT_TableCellProperties {_cbbb :=_beb .NewCT_TableCellProperties ();if _ddd !=nil {*_cbbb =*_ddd ;};if _bcgbf ==nil {return _cbbb ;};if _abgd :=_bcgbf .FillRef ;_abgd !=nil {_fffe :=_beb .NewCT_SolidColorFillProperties ();_fffe .ScrgbClr =_abgd .ScrgbClr ;_fffe .SrgbClr =_abgd .SrgbClr ;_fffe .HslClr =_abgd .HslClr ;_fffe .SysClr =_abgd .SysClr ;_fffe .SchemeClr =_abgd .SchemeClr ;_fffe .PrstClr =_abgd .PrstClr ;_cbbb .SolidFill =_fffe ;};if _cbbb .NoFill ==nil &&_cbbb .SolidFill ==nil {if _gfeg :=_bcgbf .Fill ;_gfeg !=nil {if _cbbb .NoFill ==nil {_cbbb .NoFill =_gfeg .NoFill ;};if _cbbb .SolidFill ==nil {_cbbb .SolidFill =_gfeg .SolidFill ;};};};if _ddfe :=_bcgbf .TcBdr ;_ddfe !=nil {if _cbbb .LnL ==nil {var _dfbdd *_beb .CT_ThemeableLineStyle ;if _eee {_dfbdd =_ddfe .Left ;}else {_dfbdd =_ddfe .InsideV ;};if _dfbdd !=nil {_cbbb .LnL =_dfbdd .Ln ;};};if _cbbb .LnR ==nil {var _dba *_beb .CT_ThemeableLineStyle ;if _fgbc {_dba =_ddfe .Right ;}else {_dba =_ddfe .InsideV ;};if _dba !=nil {_cbbb .LnR =_dba .Ln ;};};if _cbbb .LnT ==nil {var _cdgc *_beb .CT_ThemeableLineStyle ;if _cfcg {_cdgc =_ddfe .Top ;}else {_cdgc =_ddfe .InsideH ;};if _cdgc !=nil {_cbbb .LnT =_cdgc .Ln ;};};if _cbbb .LnB ==nil {var _daaac *_beb .CT_ThemeableLineStyle ;if _cgab {_daaac =_ddfe .Bottom ;}else {_daaac =_ddfe .InsideH ;};if _daaac !=nil {_cbbb .LnB =_daaac .Ln ;};};};return _cbbb ;};

// ConvertToPdf converts a presentation to a PDF file. This package is beta, breaking changes can take place.
func ConvertToPdf (pr *_a .Presentation )*_ab .Creator {_ag :=pr .X ().SldSz ;_acg :=_c .FromEMU (int64 (_ag .CxAttr ));_gee :=_c .FromEMU (int64 (_ag .CyAttr ));_ef :=_ab .PageSize {_acg ,_gee };_acc :=_ab .New ();_acc .SetPageSize (_ef );var _gec *_beb .Theme ;if len (pr .Themes ())> 0{_gec =pr .Themes ()[0];};for _ ,_cf :=range pr .Slides (){if _cf .X ()==nil {continue ;};_gcb :=&convertContext {_faf :_acc ,_debd :&_cf ,_baf :_cf .GetSlideLayout (),_gced :pr .SlideMasters ()[0].X (),_bdce :pr ,_egfa :_gec ,_gggf :_cf .X ().ClrMapOvr ,_aac :_ef [1],_edc :_ef [0]};_gcb ._baf =_cf .GetSlideLayout ();_gcb .extractDefaultProperties ();_gcb .makeSlide ();_gcb .drawSlide ();};return _acc ;};func _dgad (_bag int ,_fbgc bool )string {_adgd :=_be .NewBuffer ([]byte {});for _ ,_fece :=range _ceeb {for {if _bag < _fece ._dbda {break ;};_adgd .WriteString (_fece ._cebg );_bag -=_fece ._dbda ;};};_ede :=_adgd .String ();if _fbgc {_ede =_db .ToUpper (_ede );};return _ede ;};type paragraph struct{_gbaf float64 ;_daag float64 ;_dfbg float64 ;_fbce float64 ;_aegg float64 ;_acf float64 ;_dgec float64 ;_ddga float64 ;_debb _beb .ST_TextAlignType ;_eae float64 ;_bgd bool ;_addc []*line ;};func _dcd (_gfbaf *bool )bool {return _gfbaf !=nil &&*_gfbaf };func _cfecf (_fdag *_e .CT_Shape )(_e .ST_PlaceholderType ,*uint32 ){if _bfdea :=_fdag .NvSpPr ;_bfdea !=nil {if _fcdg :=_bfdea .NvPr ;_fcdg !=nil {if _ecaa :=_fcdg .Ph ;_ecaa !=nil {return _ecaa .TypeAttr ,_ecaa .IdxAttr ;};};};return _e .ST_PlaceholderTypeUnset ,nil ;};type symbol struct{_aaba string ;_bbca float64 ;_eaff float64 ;_daac float64 ;_gaf float64 ;_fgbgf float64 ;_ecbd *_ab .TextStyle ;_gadd string ;_fagd bool ;_defc bool ;_ced bool ;};func _eegd (_fbca *_e .CT_CommonSlideData ,_fccb _e .ST_PlaceholderType ,_afced *uint32 ,_ccgfb bool )(*_beb .CT_Transform2D ,*_beb .CT_TextBody ,*bool ,*bool ){if _fbca !=nil &&(_fccb !=_e .ST_PlaceholderTypeUnset ||!_ccgfb ){if _fcag :=_fbca .SpTree ;_fcag !=nil {for _ ,_geegg :=range _fcag .Choice {if _geegg !=nil {for _ ,_dacg :=range _geegg .Sp {if _dacg !=nil {_bbab ,_cagc :=_cfecf (_dacg );if _fccb ==_bbab {if (_ccgfb &&_cagc ==nil )||(!_ccgfb &&_cagc !=nil &&*_cagc ==*_afced ){var _caab *_beb .CT_Transform2D ;if _dacg .SpPr !=nil {_caab =_dacg .SpPr .Xfrm ;};_bcbb :=_fccb ==_e .ST_PlaceholderTypeTitle ||_fccb ==_e .ST_PlaceholderTypeCtrTitle ;_ccb :=!_bcbb &&_fccb !=_e .ST_PlaceholderTypeUnset ;return _caab ,_dacg .TxBody ,&_bcbb ,&_ccb ;};};};};};};};};return nil ,nil ,nil ,nil ;};

// FontStyle represents a kind of font styling. It can be FontStyle_Regular, FontStyle_Bold, FontStyle_Italic and FontStyle_BoldItalic.
type FontStyle =_gc .FontStyle ;func (_abbg *convertContext )getInfoFromLn (_ffbd *_beb .CT_LineProperties )(_ab .Color ,float64 ,float64 ){if _ffbd ==nil ||_ffbd .NoFill !=nil {return nil ,0,0;};var _gdade float64 ;_dgg ,_ddcb :=_abbg .getColorFromSolidFill (_ffbd .SolidFill );if _gcgd :=_ffbd .WAttr ;_gcgd !=nil {_gdade =_c .FromEMU (int64 (*_gcgd ));}else {_gdade =1;};return _dgg ,_gdade ,_ddcb ;};