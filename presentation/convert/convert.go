//
// Copyright 2020 FoxyUtils ehf. All rights reserved.
//
// This is a commercial product and requires a license to operate.
// A trial license can be obtained at https://unidoc.io
//
// DO NOT EDIT: generated by unitwist Go source code obfuscator.
//
// Use of this source code is governed by the UniDoc End User License Agreement
// terms that can be accessed at https://unidoc.io/eula/

package convert ;import (_a "bytes";_g "errors";_db "github.com/unidoc/unioffice/common/logger";_cg "github.com/unidoc/unioffice/common/tempstorage";_gef "github.com/unidoc/unioffice/internal/convertutils";_c "github.com/unidoc/unioffice/measurement";_ed "github.com/unidoc/unioffice/presentation";_b "github.com/unidoc/unioffice/schema/soo/dml";_de "github.com/unidoc/unioffice/schema/soo/dml/chart";_bd "github.com/unidoc/unioffice/schema/soo/pml";_cge "github.com/unidoc/unipdf/v3/contentstream/draw";_eda "github.com/unidoc/unipdf/v3/creator";_ga "github.com/unidoc/unipdf/v3/model";_ad "github.com/unidoc/unipdf/v3/render";_gg "image";_ge "image/color";_f "image/draw";_fa "strconv";_d "strings";);func (_fffa *textboxContext )alignParagraphsVertically (_dcge _b .ST_TextAnchoringType ){if _dcge ==_b .ST_TextAnchoringTypeT {return ;};_dade :=0.0;for _ ,_fac :=range _fffa ._acac {_dade +=_fac ._bedc +_fac ._adb +_fac ._gdbc ;};var _gegc float64 ;switch _dcge {case _b .ST_TextAnchoringTypeCtr :_gegc =(_fffa ._becb -_dade )/2;case _b .ST_TextAnchoringTypeB :_gegc =_fffa ._becb -_dade ;};for _ ,_ecab :=range _fffa ._acac {_ecab ._cdcd +=_gegc ;};};type romanMatch struct{_fea int ;_ccd string ;};func (_ffac *textboxContext )addPrefix (_cdff *prefixData ,_bcbg *_eda .TextStyle ){_afed :=_cfca (_cdff ._acdg );_cdfc :=*_bcbg ;if _cdff ._daga {_cdfc .Font =_gef .AssignStdFontByName (_cdfc ,"\u0053\u0079\u006d\u0062\u006f\u006c");};for _ ,_feeb :=range _afed {_feeb ._eaeg =&_cdfc ;_ffac .addTextSymbol (_feeb );};_cgde :=-(_cdff ._aggf +_ffac ._bgcf ._dcc );if _cgde < 0{_cgde =0;};_dafa :=&symbol {_bgac :"\u0020",_dadf :_cgde };_ffac .addTextSymbol (_dafa );_ffac ._bgcf ._fbee +=(_cdff ._aggf +_cdff ._fgee );};func (_deadd *textboxContext )addTextSymbol (_bcgc *symbol ){_ecef :=_eda .New ();_bcbc :=_ecef .NewStyledParagraph ();_bcbc .SetMargins (0,0,0,0);_gegd :=_bcbc .Append (_bcgc ._bgac );_def :=0.0;if _bcgc ._eaeg !=nil {_gegd .Style =*_bcgc ._eaeg ;if _bcgc ._eaeg .CharSpacing !=0{_def =_bcgc ._eaeg .CharSpacing ;};};_bcgc ._cdbc =_bcbc .Height ();_bcgc ._eedf =_bcbc .Height ()*1.2;if _bcgc ._eedf < _deadd ._edad ._dacc {_bcgc ._eedf =_deadd ._edad ._dacc ;};if _bcgc ._dadf ==0{_bcgc ._dadf =_bcbc .Width ()+_def ;};if len (_deadd ._bgcf ._fcba )> 0{_ddda :=_deadd ._bgcf ._fcba [len (_deadd ._bgcf ._fcba )-1]._bgac ;if _deadd ._edad ._cfe ||_gef .IsNoSpaceLanguage (_ddda )||(_ddda =="\u0020")!=(_bcgc ._bgac =="\u0020"){_deadd .addCurrentWordToParagraph ();_deadd .newWord ();};};_deadd ._bgcf ._fcba =append (_deadd ._bgcf ._fcba ,_bcgc );_bcgc ._gggff =_deadd ._bgcf ._dcc ;_deadd ._bgcf ._dcc +=_bcgc ._dadf ;if _bcgc ._bgac !="\u0020"{_deadd ._bgcf ._gdag =false ;};};func (_eef *convertContext )makePdfDivisionFromTxBody (_afab *_b .CT_TextBody ,_cdb ,_dcd float64 ,_fbb *_b .CT_TableStyleTextStyle )*_eda .Division {_bab :=_eef ._eage .NewDivision ();_bbd :=_eef ._edce ;_dge :=_b .ST_TextAnchoringTypeT ;if _bad :=_afab .BodyPr ;_bad !=nil {if _bae :=_bad .AnchorAttr ;_bae !=_b .ST_TextAnchoringTypeUnset {_dge =_bad .AnchorAttr ;};};if _aca :=_afab .LstStyle ;_aca !=nil {var _gcg *_b .CT_TextParagraphProperties ;if _aca .Lvl1pPr !=nil {_gcg =_aca .Lvl1pPr ;}else {_gcg =_eef ._aabb [0];};_bbd =_baea (_gcg ,_baea (_aca .DefPPr ,_bbd ));};for _ ,_dae :=range _afab .P {if _dae !=nil {_bcec :=_eef ._eage .NewStyledParagraph ();_fagg :=_baea (_dae .PPr ,_bbd );_gde :=_abeg (_dae .EndParaRPr ,_fagg .DefRPr );if len (_dae .EG_TextRun )==0{_bcec .Append ("\u000a");_bab .Add (_bcec );continue ;};for _ ,_dbec :=range _dae .EG_TextRun {if _gda :=_dbec .Br ;_gda !=nil {_bcec .Append ("\u000a");}else if _fcg :=_dbec .R ;_fcg !=nil {_aea :=_eggfa (_fcg .RPr ,_fbb );_aea =_abeg (_aea ,_gde );var _daf _eda .Color ;if _aea .SolidFill !=nil {_daf ,_ =_eef .getColorFromSolidFill (_aea .SolidFill );}else {_daf =_eda .ColorBlack ;};_fegca ,_dcb ,_cad ,_ :=_eef .makeStyleFromRPr (_aea );_fegca .Color =_daf ;if _dcb {_fegca .TextRise =0.5;}else if _cad {_fegca .TextRise =-0.5;};_ebd :=_fcg .T ;if _aea .CapAttr ==_b .ST_TextCapsTypeAll {for _ ,_bfd :=range _ebd {_bfd =[]rune (_d .ToUpper (string (_bfd )))[0];};};_fffc :=_bcec .Append (_ebd );_fffc .Style =*_fegca ;};};_ =_dge ;_bab .Add (_bcec );};};return _bab ;};func _edf (_gbed *_bd .CT_CommonSlideData ,_bccf _bd .ST_PlaceholderType ,_debf *uint32 ,_face bool )(*_b .CT_Transform2D ,*_b .CT_TextBody ,*bool ,*bool ){if _gbed !=nil &&(_bccf !=_bd .ST_PlaceholderTypeUnset ||!_face ){if _cdcf :=_gbed .SpTree ;_cdcf !=nil {for _ ,_cff :=range _cdcf .Choice {if _cff !=nil {for _ ,_egff :=range _cff .Sp {if _egff !=nil {_fedg ,_cfcg :=_eaab (_egff );if _bccf ==_fedg {if (_face &&_cfcg ==nil )||(!_face &&_cfcg !=nil &&*_cfcg ==*_debf ){var _geefa *_b .CT_Transform2D ;if _egff .SpPr !=nil {_geefa =_egff .SpPr .Xfrm ;};_efgbd :=_bccf ==_bd .ST_PlaceholderTypeTitle ||_bccf ==_bd .ST_PlaceholderTypeCtrTitle ;_dadg :=!_efgbd &&_bccf !=_bd .ST_PlaceholderTypeUnset ;return _geefa ,_egff .TxBody ,&_efgbd ,&_dadg ;};};};};};};};};return nil ,nil ,nil ,nil ;};func (_gbe *convertContext )makePdfBlockFromTxBody (_dbed *_b .CT_TextBody ,_bed *_b .CT_TextBodyProperties ,_edbg *_b .CT_TextListStyle ,_adcb ,_dbdc float64 ,_gffd _eda .Color ,_ggg ,_cb bool )(*_eda .Block ,error ){var _ffaa *_b .CT_TextParagraphProperties ;if _bbg :=_dbed .LstStyle ;_bbg !=nil {var _abg *_b .CT_TextParagraphProperties ;if _bbg .Lvl1pPr !=nil {_abg =_bbg .Lvl1pPr ;};_ffaa =_baea (_abg ,_bbg .DefPPr );};var _adg *_b .CT_TextParagraphProperties ;if _ffaa !=nil {if _ggg {_adg =_gbe ._fbe [0];}else if _cb {_adg =_gbe ._gdab [0];}else {_adg =_gbe ._aabb [0];};if _edbg !=nil {_adg =_baea (_baea (_edbg .Lvl1pPr ,_edbg .DefPPr ),_adg );};_adg =_baea (_ffaa ,_adg );}else {if _ggg {_adg =_gbe ._dbcg ;}else if _cb {_adg =_gbe ._fcb ;}else {_adg =_gbe ._edce ;};};_dca ,_cbe :=_cecf (2.5),_cecf (2.5);_fdcf ,_bga :=_cecf (1.3),_cecf (1.3);_dfb :=true ;_dbf :=_b .ST_TextAnchoringTypeT ;if _bed !=nil {if _aadg :=_bed .AnchorAttr ;_aadg !=_b .ST_TextAnchoringTypeUnset {_dbf =_aadg ;};};if _abeed :=_dbed .BodyPr ;_abeed !=nil {if _daeg :=_abeed .LInsAttr ;_daeg !=nil {_dca =_c .FromEMU (_gef .FromSTCoordinate32 (*_daeg ));};if _dad :=_abeed .TInsAttr ;_dad !=nil {_fdcf =_c .FromEMU (_gef .FromSTCoordinate32 (*_dad ));};if _bffd :=_abeed .RInsAttr ;_bffd !=nil {_cbe =_c .FromEMU (_gef .FromSTCoordinate32 (*_bffd ));};if _bbgb :=_abeed .BInsAttr ;_bbgb !=nil {_bga =_c .FromEMU (_gef .FromSTCoordinate32 (*_bbgb ));};_dfb =_abeed .WrapAttr !=_b .ST_TextWrappingTypeNone ;if _eec :=_abeed .AnchorAttr ;_eec !=_b .ST_TextAnchoringTypeUnset {_dbf =_abeed .AnchorAttr ;};};_gfd :=_gef .MakeTempCreator (_adcb ,_dbdc );_gfd .SetPageMargins (_dca ,_cbe ,_fdcf ,_bga );_fcc :=&textboxContext {_fgc :_gbe ,_dfgc :_dfb ,_cgee :_adcb -_dca -_cbe ,_becb :_dbdc -_fdcf -_bga ,_fgfc :_gfd ,_acac :[]*paragraph {}};_fbbg :=1;for _ ,_afggc :=range _dbed .P {if _afggc !=nil {_ecb :=_afggc .PPr ;var _bdg *prefixData ;if _ecb !=nil &&_ecb .BuNone ==nil {var _ecae string ;var _bgebe bool ;if _agd :=_ecb .BuAutoNum ;_agd !=nil {var _fegcb string ;if _ddf :=_agd .StartAtAttr ;_ddf !=nil {_fbbg =int (*_ddf );};var _fcdb string ;switch _agd .TypeAttr {case _b .ST_TextAutonumberSchemeAlphaUcParenBoth ,_b .ST_TextAutonumberSchemeAlphaUcParenR ,_b .ST_TextAutonumberSchemeAlphaUcPeriod :_fcdb =_bfbd (_fbbg ,true );case _b .ST_TextAutonumberSchemeAlphaLcParenBoth ,_b .ST_TextAutonumberSchemeAlphaLcParenR ,_b .ST_TextAutonumberSchemeAlphaLcPeriod :_fcdb =_bfbd (_fbbg ,false );case _b .ST_TextAutonumberSchemeRomanUcParenBoth ,_b .ST_TextAutonumberSchemeRomanUcParenR ,_b .ST_TextAutonumberSchemeRomanUcPeriod :_fcdb =_fgcf (_fbbg ,true );case _b .ST_TextAutonumberSchemeRomanLcParenBoth ,_b .ST_TextAutonumberSchemeRomanLcParenR ,_b .ST_TextAutonumberSchemeRomanLcPeriod :_fcdb =_fgcf (_fbbg ,false );default:_fcdb =_fa .Itoa (_fbbg );};switch _agd .TypeAttr {case _b .ST_TextAutonumberSchemeAlphaLcPeriod ,_b .ST_TextAutonumberSchemeAlphaUcPeriod ,_b .ST_TextAutonumberSchemeArabicPeriod ,_b .ST_TextAutonumberSchemeRomanLcPeriod ,_b .ST_TextAutonumberSchemeRomanUcPeriod ,_b .ST_TextAutonumberSchemeArabicDbPeriod ,_b .ST_TextAutonumberSchemeEa1ChsPeriod ,_b .ST_TextAutonumberSchemeEa1ChtPeriod ,_b .ST_TextAutonumberSchemeEa1JpnChsDbPeriod ,_b .ST_TextAutonumberSchemeEa1JpnKorPeriod ,_b .ST_TextAutonumberSchemeThaiAlphaPeriod ,_b .ST_TextAutonumberSchemeThaiNumPeriod ,_b .ST_TextAutonumberSchemeHindiAlphaPeriod ,_b .ST_TextAutonumberSchemeHindiNumPeriod ,_b .ST_TextAutonumberSchemeHindiAlpha1Period :_fegcb ="\u002e";case _b .ST_TextAutonumberSchemeAlphaLcParenR ,_b .ST_TextAutonumberSchemeAlphaUcParenR ,_b .ST_TextAutonumberSchemeArabicParenR ,_b .ST_TextAutonumberSchemeRomanLcParenR ,_b .ST_TextAutonumberSchemeRomanUcParenR ,_b .ST_TextAutonumberSchemeThaiAlphaParenR ,_b .ST_TextAutonumberSchemeThaiNumParenR ,_b .ST_TextAutonumberSchemeHindiNumParenR :_fegcb ="\u0029";};_ecae =_fcdb +_fegcb ;_fbbg ++;}else if _cgb :=_ecb .BuChar ;_cgb !=nil {_gcf :=_cgb .CharAttr ;if _bgbe ,_ddd :=_fbbd [_gcf ];_ddd {_gcf =string (rune (_bgbe ));}else {_gcf ="\u2022";};_ecae =_gcf ;_bgebe =true ;};if _ecae !=""{var _cee ,_fgg float64 ;if _ecb .MarLAttr !=nil {_cee =_c .FromEMU (int64 (*_ecb .MarLAttr ));};if _ecb .IndentAttr !=nil {_fgg =_c .FromEMU (int64 (*_ecb .IndentAttr ));};_bdg =&prefixData {_acdg :_ecae ,_daga :_bgebe ,_fgee :_cee ,_aggf :_fgg };};};_ecb =_baea (_ecb ,_adg );_gggf :=_abeg (_afggc .EndParaRPr ,_ecb .DefRPr );_fcc .newParagraph ();_fcc .assignPropsToCurrentParagraph (_ecb );_fcc .newLine ();_fcc .newWord ();for _dga ,_bgca :=range _afggc .EG_TextRun {_fcc .addTextRun (_bgca ,_gggf ,_gffd ,_bdg );if _dga > 0{_bdg =nil ;};};_fcc .addCurrentWordToParagraph ();};_fcc .addCurrentParagraph ();};_fcc .alignVertically (_dbf );_fcc .drawParagraphs ();return _gef .MakeBlockFromCreator (_gfd );};func (_cbeg *textboxContext )newLine (){if _cbeg ._edad ==nil {_cbeg .newParagraph ();};_cebg :=_cbeg ._edad ._adb +_cbeg ._edad ._bedc ;_ddeb :=&line {};_ddeb ._aeb =_cbeg ._edad ._dgfe ;if len (_cbeg ._edad ._bdcg )==0{_ddeb ._aeb +=_cbeg ._edad ._dcde ;};_ddeb ._agag =_cbeg ._edad ._ecbg ;_ddeb ._bbdg =_ddeb ._aeb ;_ddeb ._acaf =_cebg ;_cbeg ._edad ._bdcg =append (_cbeg ._edad ._bdcg ,_ddeb );_cbeg ._agea =_ddeb ;};var _ff =_cecf (1.9);

// RegisterFont makes a PdfFont accessible for using in converting to PDF.
func RegisterFont (name string ,style FontStyle ,font *_ga .PdfFont ){_gef .RegisterFont (name ,style ,font );};

// FontStyle represents a kind of font styling. It can be FontStyle_Regular, FontStyle_Bold, FontStyle_Italic and FontStyle_BoldItalic.
type FontStyle =_gef .FontStyle ;type textboxContext struct{_fgc *convertContext ;_cgee float64 ;_becb float64 ;_fgfc *_eda .Creator ;_aeg float64 ;_acac []*paragraph ;_edad *paragraph ;_agea *line ;_bgcf *word ;_dfgc bool ;};func _eagd (_eeeg ,_efe *_b .CT_TextBodyProperties )*_b .CT_TextBodyProperties {_defd :=_b .NewCT_TextBodyProperties ();if _eeeg !=nil {*_defd =*_eeeg ;};if _efe ==nil {return _defd ;};if _defd .RotAttr ==nil {_defd .RotAttr =_efe .RotAttr ;};if _defd .SpcFirstLastParaAttr ==nil {_defd .SpcFirstLastParaAttr =_efe .SpcFirstLastParaAttr ;};if _defd .VertOverflowAttr ==_b .ST_TextVertOverflowTypeUnset {_defd .VertOverflowAttr =_efe .VertOverflowAttr ;};if _defd .HorzOverflowAttr ==_b .ST_TextHorzOverflowTypeUnset {_defd .HorzOverflowAttr =_efe .HorzOverflowAttr ;};if _defd .VertAttr ==_b .ST_TextVerticalTypeUnset {_defd .VertAttr =_efe .VertAttr ;};if _defd .WrapAttr ==_b .ST_TextWrappingTypeUnset {_defd .WrapAttr =_efe .WrapAttr ;};if _defd .LInsAttr ==nil {_defd .LInsAttr =_efe .LInsAttr ;};if _defd .TInsAttr ==nil {_defd .TInsAttr =_efe .TInsAttr ;};if _defd .RInsAttr ==nil {_defd .RInsAttr =_efe .RInsAttr ;};if _defd .BInsAttr ==nil {_defd .BInsAttr =_efe .BInsAttr ;};if _defd .NumColAttr ==nil {_defd .NumColAttr =_efe .NumColAttr ;};if _defd .SpcColAttr ==nil {_defd .SpcColAttr =_efe .SpcColAttr ;};if _defd .RtlColAttr ==nil {_defd .RtlColAttr =_efe .RtlColAttr ;};if _defd .AnchorAttr ==_b .ST_TextAnchoringTypeUnset {_defd .AnchorAttr =_efe .AnchorAttr ;};if _defd .AnchorCtrAttr ==nil {_defd .AnchorCtrAttr =_efe .AnchorCtrAttr ;};if _defd .ForceAAAttr ==nil {_defd .ForceAAAttr =_efe .ForceAAAttr ;};if _defd .UprightAttr ==nil {_defd .UprightAttr =_efe .UprightAttr ;};if _defd .CompatLnSpcAttr ==nil {_defd .CompatLnSpcAttr =_efe .CompatLnSpcAttr ;};if _defd .PrstTxWarp ==nil {_defd .PrstTxWarp =_efe .PrstTxWarp ;};if _defd .NoAutofit ==nil {_defd .NoAutofit =_efe .NoAutofit ;};if _defd .NormAutofit ==nil {_defd .NormAutofit =_efe .NormAutofit ;};if _defd .SpAutoFit ==nil {_defd .SpAutoFit =_efe .SpAutoFit ;};if _defd .Scene3d ==nil {_defd .Scene3d =_efe .Scene3d ;};if _defd .Sp3d ==nil {_defd .Sp3d =_efe .Sp3d ;};if _defd .FlatTx ==nil {_defd .FlatTx =_efe .FlatTx ;};if _defd .ExtLst ==nil {_defd .ExtLst =_efe .ExtLst ;};return _defd ;};func (_ebdg *convertContext )getColorFromFontReference (_dfcc *_b .CT_FontReference )_eda .Color {var _efg _eda .Color ;var _edac string ;if _ebc :=_dfcc .SrgbClr ;_ebc !=nil {_edac =_ebc .ValAttr ;}else if _eddbe :=_dfcc .SchemeClr ;_eddbe !=nil {_edac =_gef .GetColorStringFromDmlColor (_ebdg ._efdd .GetColorBySchemeColor (_eddbe .ValAttr ));_edac =_gef .AdjustColor (_edac ,_eddbe .EG_ColorTransform );};if _edac !=""{_efg =_eda .ColorRGBFromHex ("\u0023"+_edac );};return _efg ;};func (_bbe *convertContext )stretchImage (_gag *_eda .Image ,_bcc *_b .CT_StretchInfoProperties ,_gfa ,_ggd ,_ceb ,_cc float64 )(*_eda .Image ,float64 ,float64 ){_agcc :=_bcc .FillRect ;if _agcc ==nil {_gbf :=_gag .Width ()/_gag .Height ();_dfg :=_ceb /_cc ;var _fde ,_eca float64 ;if _gbf > _dfg {_eca =_cc ;_fde =_cc *_gbf ;}else {_fde =_ceb ;_eca =_ceb /_gbf ;};_gag .Scale (_fde /_gag .Width (),_eca /_gag .Height ());return _gag ,_gfa ,_ggd ;};var _cgea ,_fff ,_ddc ,_cga float64 ;if _ba :=_agcc .LAttr ;_ba !=nil {_ddc =_gef .FromSTPercentage (_ba );};if _geba :=_agcc .TAttr ;_geba !=nil {_cgea =_gef .FromSTPercentage (_geba );};if _eee :=_agcc .RAttr ;_eee !=nil {_cga =_gef .FromSTPercentage (_eee );};if _fee :=_agcc .BAttr ;_fee !=nil {_fff =_gef .FromSTPercentage (_fee );};_ebb :=_ceb *(1-_ddc -_cga );_fce :=_cc *(1-_cgea -_fff );_gag .Scale (_ebb /_gag .Width (),_fce /_gag .Height ());return _gag ,_gfa +_ddc *_ceb ,_ggd +_cgea *_cc ;};func (_gfbe *convertContext )getStyleColors (_aeba *_b .CT_ShapeStyle )(_eda .Color ,_eda .Color ,_eda .Color ){var _fcbd ,_gfbg ,_efdde _eda .Color ;if _egea :=_aeba .LnRef ;_egea !=nil {_gfbg =_gfbe .getColorFromMatrixReference (_egea );};if _adabd :=_aeba .FillRef ;_adabd !=nil {_efdde =_gfbe .getColorFromMatrixReference (_adabd );};if _gefdb :=_aeba .FontRef ;_gefdb !=nil {_fcbd =_gfbe .getColorFromFontReference (_gefdb );};return _fcbd ,_efdde ,_gfbg ;};type background struct{_bafg _eda .Color ;_afef float64 ;_ccgf *_b .CT_BlipFillProperties ;};func (_cfbf *convertContext )getInfoFromLn (_gfef *_b .CT_LineProperties )(_eda .Color ,float64 ,float64 ){if _gfef ==nil ||_gfef .NoFill !=nil {return nil ,0,0;};var _fbga float64 ;_ffbb ,_dee :=_cfbf .getColorFromSolidFill (_gfef .SolidFill );if _dddb :=_gfef .WAttr ;_dddb !=nil {_fbga =_c .FromEMU (int64 (*_dddb ));}else {_fbga =1;};return _ffbb ,_fbga ,_dee ;};func (_caef *convertContext )addCellToTable (_ccg *_eda .Table ,_ddce *_b .CT_TableCell ,_bde *_b .CT_TablePartStyle ,_abb float64 ,_adga ,_dcab ,_fbgf ,_bec bool )float64 {var _fcf *_eda .TableCell ;_gad :=1;if _ddce .GridSpanAttr !=nil {_gad =int (*_ddce .GridSpanAttr );};_fcf =_ccg .MultiColCell (_gad );_abbe :=_ddce .TcPr ;var _cfcf *_b .CT_TableStyleTextStyle ;if _bde !=nil {_abbe =_bcae (_abbe ,_bde .TcStyle ,_adga ,_dcab ,_fbgf ,_bec );_cfcf =_bde .TcTxStyle ;};_cagd :=_ff ;_ccb :=_eda .CellVerticalAlignmentMiddle ;if _abbe !=nil {if _ffad :=_abbe .LnL ;_ffad !=nil {_eed ,_fdac ,_eedb :=_caef .getBorderStyle (_ffad );_fcf .SetBorder (_eda .CellBorderSideLeft ,_eed ,_eedb );if _fdac !=nil &&*_fdac !=nil {_fcf .SetSideBorderColor (_eda .CellBorderSideLeft ,*_fdac );};};if _aefg :=_abbe .LnT ;_aefg !=nil {_dgec ,_cgd ,_geda :=_caef .getBorderStyle (_aefg );_fcf .SetBorder (_eda .CellBorderSideTop ,_dgec ,_geda );if _cgd !=nil &&*_cgd !=nil {_fcf .SetSideBorderColor (_eda .CellBorderSideTop ,*_cgd );};};if _bfbc :=_abbe .LnR ;_bfbc !=nil {_agff ,_cdg ,_bgaab :=_caef .getBorderStyle (_bfbc );_fcf .SetBorder (_eda .CellBorderSideRight ,_agff ,_bgaab );if _cdg !=nil &&*_cdg !=nil {_fcf .SetSideBorderColor (_eda .CellBorderSideRight ,*_cdg );};};if _gdf :=_abbe .LnB ;_gdf !=nil {_acga ,_dgfa ,_cca :=_caef .getBorderStyle (_gdf );_fcf .SetBorder (_eda .CellBorderSideBottom ,_acga ,_cca );if _dgfa !=nil &&*_dgfa !=nil {_fcf .SetSideBorderColor (_eda .CellBorderSideBottom ,*_dgfa );};};if _cdgf :=_abbe .MarLAttr ;_cdgf !=nil {_cagd =float64 (_gef .FromSTCoordinate32 (*_cdgf ));};switch _abbe .AnchorAttr {case _b .ST_TextAnchoringTypeT :_ccb =_eda .CellVerticalAlignmentTop ;case _b .ST_TextAnchoringTypeB :_ccb =_eda .CellVerticalAlignmentBottom ;};if _abbe .NoFill ==nil {if _dadd :=_abbe .SolidFill ;_dadd !=nil {_eaeb ,_ :=_caef .getColorFromSolidFill (_dadd );_fcf .SetBackgroundColor (_eaeb );};};};_fcf .SetVerticalAlignment (_ccb );_fcf .SetIndent (_cagd );var _gcge float64 ;if _dbcd :=_ddce .TxBody ;_dbcd !=nil {_degg :=_caef .makePdfDivisionFromTxBody (_dbcd ,_abb ,_gcge ,_cfcf );_gcge =_degg .Height ();_fcf .SetContent (_degg );};return _gcge ;};

// ConvertToPdf converts a presentation to a PDF file. This package is beta, breaking changes can take place.
func ConvertToPdf (pr *_ed .Presentation )*_eda .Creator {_bc :=pr .X ().SldSz ;_bdd :=_c .FromEMU (int64 (_bc .CxAttr ));_fe :=_c .FromEMU (int64 (_bc .CyAttr ));_dc :=_eda .PageSize {_bdd ,_fe };_fd :=_eda .New ();_fd .SetPageSize (_dc );var _bge *_b .Theme ;if len (pr .Themes ())> 0{_bge =pr .Themes ()[0];};for _ ,_cd :=range pr .Slides (){if _cd .X ()==nil {continue ;};_bda :=&convertContext {_eage :_fd ,_effd :&_cd ,_bfg :_cd .GetSlideLayout (),_ada :pr .SlideMasters ()[0].X (),_efdd :pr ,_gfcf :_bge ,_afgf :_cd .X ().ClrMapOvr ,_gdb :_dc [1],_afdd :_dc [0]};_bda ._bfg =_cd .GetSlideLayout ();_bda .extractDefaultProperties ();_bda .makeSlide ();_bda .drawSlide ();};return _fd ;};func (_bafc *textboxContext )newWord (){_bafc ._bgcf =&word {_gdag :true ,_fbee :_bafc ._agea ._bbdg }};func (_bdde *convertContext )getConnectors (_fced *_bd .CT_Connector )[]_eda .Drawable {_bbba ,_ ,_ ,_ ,_ ,_ ,_ :=_bdde .getShapesFromSpPr (_fced .SpPr ,_fced .Style ,false );return _bbba ;};func (_ebde *line )moveRight (_cedg float64 ){for _ ,_fcbe :=range _ebde ._bacf {_fcbe ._fbee +=_cedg ;};};func (_gfcd *convertContext )makePdfImageFromBlipFill (_ffe *_b .CT_BlipFillProperties )(*_eda .Image ,[]*_b .CT_BlipChoice ,error ){if _bdaa :=_ffe .Blip ;_bdaa !=nil {if _gge :=_bdaa .EmbedAttr ;_gge !=nil {_beff ,_cgdg :=_gfcd ._effd .GetImageByRelID (*_gge );if _cgdg {_cbc ,_dabd :=_cg .Open (_beff .Path ());if _dabd !=nil {_db .Log .Debug ("\u0046\u0069\u006c\u0065 o\u0070\u0065\u006e\u0020\u0065\u0072\u0072\u006f\u0072\u003a\u0020\u0025\u0073",_dabd );return nil ,nil ,_dabd ;};defer _cbc .Close ();_feae ,_ ,_dabd :=_gg .Decode (_cbc );if _dabd !=nil {_db .Log .Debug ("\u0044\u0065\u0063\u006fde\u0020\u0069\u006d\u0061\u0067\u0065\u0020\u0065\u0072\u0072\u006f\u0072\u003a\u0020%\u0073",_dabd );return nil ,nil ,_dabd ;};if _gcb :=_ffe .SrcRect ;_gcb !=nil {_agb :=_feae .Bounds ().Size ();_afbd :=_agb .X ;_fcae :=_agb .Y ;var _gaa ,_ffc ,_bbfc ,_egeg int ;var _aegg bool ;if _eedd :=_gcb .LAttr ;_eedd !=nil {_gaa =int (float64 (_afbd )*_gef .FromSTPercentage (_eedd ));_aegg =true ;}else {_gaa =0;};if _cgga :=_gcb .TAttr ;_cgga !=nil {_bbfc =int (float64 (_fcae )*_gef .FromSTPercentage (_cgga ));_aegg =true ;}else {_bbfc =0;};if _fbc :=_gcb .RAttr ;_fbc !=nil {_ffc =int (float64 (_afbd )*(1-_gef .FromSTPercentage (_fbc )));_aegg =true ;}else {_ffc =_afbd ;};if _cdd :=_gcb .BAttr ;_cdd !=nil {_egeg =int (float64 (_fcae )*(1-_gef .FromSTPercentage (_cdd )));_aegg =true ;}else {_egeg =_fcae ;};if _aegg {_feae =_gef .CropImageByRect (_feae ,_gg .Rect (_gaa ,_bbfc ,_ffc +1,_egeg +1));};};_cfaa ,_dabd :=_gfcd ._eage .NewImageFromGoImage (_feae );if _dabd !=nil {_db .Log .Debug ("\u0043\u0061\u006e\u006e\u006ft\u0020\u0063\u0072\u0065\u0061\u0074\u0065\u0020\u0050\u0044\u0046\u0020\u0069m\u0061\u0067\u0065\u0020\u0066\u0072\u006f\u006d\u0020\u0047\u006f\u0020\u0069\u006d\u0061\u0067\u0065\u003a\u0020\u0025\u0073",_dabd );return nil ,nil ,_dabd ;};return _cfaa ,_bdaa .Choice ,nil ;};};};return nil ,nil ,nil ;};func (_gcc *textboxContext )alignParagraph (){_cebc :=_gcc ._edad ;if _cebc ._fafe ==_b .ST_TextAlignTypeL {return ;};_gggcf :=len (_cebc ._bdcg )-1;for _fegd ,_aggc :=range _cebc ._bdcg {_cece :=true ;_fcgeg :=len (_aggc ._bacf );_aefa :=0.0;for _egc :=len (_aggc ._bacf )-1;_egc >=0;_egc --{_cced :=_aggc ._bacf [_egc ];if _cece &&_cced ._gdag {_fcgeg =_egc ;}else {_cece =false ;for _ ,_beb :=range _cced ._fcba {_aefa +=_beb ._dadf ;};};};_aggc ._bacf =_aggc ._bacf [:_fcgeg ];_bcbd :=_aggc ._agag -_aggc ._aeb -_aefa ;switch _cebc ._fafe {case _b .ST_TextAlignTypeR :_aggc .moveRight (_bcbd );case _b .ST_TextAlignTypeCtr :_aggc .moveRight (_bcbd /2);case _b .ST_TextAlignTypeJust :if _fegd !=_gggcf {_dddg :=[]*word {};for _ ,_aead :=range _aggc ._bacf {if _aead ._gdag {_dddg =append (_dddg ,_aead );};};_fgca :=_bcbd /float64 (len (_dddg ));for _ ,_bbdc :=range _dddg {_bbdc ._dcc +=_fgca ;};var _fga *word ;for _ ,_dgeb :=range _aggc ._bacf {if _fga !=nil {_dgeb ._fbee =_fga ._fbee +_fga ._dcc ;};_fga =_dgeb ;};};};};};func (_cfb *convertContext )getColorFromSolidFill (_gfcg *_b .CT_SolidColorFillProperties )(_eda .Color ,float64 ){if _gfcg ==nil {return nil ,1;};var _cggcb string ;_dfad :=1.0;if _gbce :=_gfcg .SrgbClr ;_gbce !=nil {_cggcb =_gbce .ValAttr ;_dfad =_gef .GetOpacityFromColorTransform (_gbce .EG_ColorTransform );}else if _bagc :=_gfcg .SchemeClr ;_bagc !=nil {_cggcb =_gef .GetColorStringFromDmlColor (_cfb ._effd .GetColorBySchemeColor (_bagc .ValAttr ));_cggcb =_gef .AdjustColor (_cggcb ,_bagc .EG_ColorTransform );_dfad =_gef .GetOpacityFromColorTransform (_bagc .EG_ColorTransform );};if _cggcb !=""{_cfba :=_eda .ColorRGBFromHex ("\u0023"+_cggcb );return _cfba ,_dfad ;};return nil ,1;};func (_bgcc *convertContext )getPhData (_aacc *_bd .CT_Shape )(*_b .CT_Transform2D ,*_b .CT_TextBodyProperties ,*_b .CT_TextListStyle ,bool ,bool ){_abf ,_eaff :=_eaab (_aacc );_gagb :=_eaff ==nil ;_bebc ,_agcfd ,_gbgd ,_gacf :=_edf (_bgcc ._ada .CSld ,_abf ,_eaff ,_gagb );_egfgcg ,_dbab ,_cfdf ,_adbe :=_edf (_bgcc ._bfg .CSld ,_abf ,_eaff ,_gagb );if _egfgcg ==nil {_egfgcg =_bebc ;};_gdfc ,_caa :=_gddg (_dbab ,_agcfd );var _adcbe ,_aggfd bool ;if _cfdf ==nil {if _gbgd !=nil {_adcbe =*_gbgd ;};}else {_adcbe =*_cfdf ;};if _adbe ==nil {if _gacf !=nil {_aggfd =*_gacf ;};}else {_aggfd =*_adbe ;};return _egfgcg ,_gdfc ,_caa ,_adcbe ,_aggfd ;};func (_edaad *convertContext )renderPageWithDrawableToGoImage (_egfgg _eda .Drawable )(_gg .Image ,error ){_becbe :=_gef .MakeTempCreator (_edaad ._afdd ,_edaad ._gdb );_becbe .NewPage ();_becbe .Draw (_egfgg );_cdbd ,_eaabb :=_gef .GetPageFromCreator (_becbe );if _eaabb !=nil {return nil ,_eaabb ;};return _ad .NewImageDevice ().Render (_cdbd );};func _gffb (_cfdc *bool )bool {return _cfdc !=nil &&*_cfdc };func _dgd (_ecfa ,_bfgg *_b .CT_TextListStyle )*_b .CT_TextListStyle {_dbce :=_b .NewCT_TextListStyle ();if _ecfa !=nil {*_dbce =*_ecfa ;};if _bfgg ==nil {return _dbce ;};_dbce .DefPPr =_baea (_dbce .DefPPr ,_bfgg .DefPPr );_dbce .Lvl1pPr =_baea (_dbce .Lvl1pPr ,_bfgg .Lvl1pPr );_dbce .Lvl2pPr =_baea (_dbce .Lvl2pPr ,_bfgg .Lvl2pPr );_dbce .Lvl3pPr =_baea (_dbce .Lvl3pPr ,_bfgg .Lvl3pPr );_dbce .Lvl4pPr =_baea (_dbce .Lvl4pPr ,_bfgg .Lvl4pPr );_dbce .Lvl5pPr =_baea (_dbce .Lvl5pPr ,_bfgg .Lvl5pPr );_dbce .Lvl6pPr =_baea (_dbce .Lvl6pPr ,_bfgg .Lvl6pPr );_dbce .Lvl7pPr =_baea (_dbce .Lvl7pPr ,_bfgg .Lvl7pPr );_dbce .Lvl8pPr =_baea (_dbce .Lvl8pPr ,_bfgg .Lvl8pPr );_dbce .Lvl9pPr =_baea (_dbce .Lvl9pPr ,_bfgg .Lvl9pPr );return _dbce ;};type paragraph struct{_fdaa float64 ;_bedc float64 ;_gdbc float64 ;_dcde float64 ;_dgfe float64 ;_ecbg float64 ;_cdcd float64 ;_adb float64 ;_fafe _b .ST_TextAlignType ;_dacc float64 ;_cfe bool ;_bdcg []*line ;};type prefixData struct{_acdg string ;_daga bool ;_fgee float64 ;_aggf float64 ;};type word struct{_fcba []*symbol ;_fbee float64 ;_dcc float64 ;_gdag bool ;};func _ddeg (_adbca ,_bfgf *_b .CT_TableStyleCellStyle )*_b .CT_TableStyleCellStyle {_ecgf :=_b .NewCT_TableStyleCellStyle ();if _adbca !=nil {*_ecgf =*_adbca ;};if _bfgf ==nil {return _ecgf ;};if _ecgf .TcBdr ==nil {_ecgf .TcBdr =_bfgf .TcBdr ;};if _ecgf .Fill ==nil {_ecgf .Fill =_bfgf .Fill ;};if _ecgf .FillRef ==nil {_ecgf .FillRef =_bfgf .FillRef ;};return _ecgf ;};func _eaab (_ggfb *_bd .CT_Shape )(_bd .ST_PlaceholderType ,*uint32 ){if _caeb :=_ggfb .NvSpPr ;_caeb !=nil {if _effe :=_caeb .NvPr ;_effe !=nil {if _eaged :=_effe .Ph ;_eaged !=nil {return _eaged .TypeAttr ,_eaged .IdxAttr ;};};};return _bd .ST_PlaceholderTypeUnset ,nil ;};func _gddg (_abgb ,_agcf *_b .CT_TextBody )(*_b .CT_TextBodyProperties ,*_b .CT_TextListStyle ){if _abgb ==nil &&_agcf ==nil {return nil ,nil ;};if _abgb ==nil {return _agcf .BodyPr ,_agcf .LstStyle ;};if _agcf ==nil {return _abgb .BodyPr ,_abgb .LstStyle ;};_cafc ,_edda :=_abgb .BodyPr ,_abgb .LstStyle ;_feed ,_bbdd :=_agcf .BodyPr ,_agcf .LstStyle ;_bbbac :=_eagd (_cafc ,_feed );_dfdg :=_dgd (_edda ,_bbdd );return _bbbac ,_dfdg ;};func _baea (_ccc ,_gbg *_b .CT_TextParagraphProperties )*_b .CT_TextParagraphProperties {_bfbde :=_b .NewCT_TextParagraphProperties ();if _ccc !=nil {*_bfbde =*_ccc ;};if _gbg ==nil {return _bfbde ;};if _bfbde .MarLAttr ==nil {_bfbde .MarLAttr =_gbg .MarLAttr ;};if _bfbde .MarRAttr ==nil {_bfbde .MarRAttr =_gbg .MarRAttr ;};if _bfbde .LvlAttr ==nil {_bfbde .LvlAttr =_gbg .LvlAttr ;};if _bfbde .IndentAttr ==nil {_bfbde .IndentAttr =_gbg .IndentAttr ;};if _bfbde .AlgnAttr ==_b .ST_TextAlignTypeUnset {_bfbde .AlgnAttr =_gbg .AlgnAttr ;};if _bfbde .DefTabSzAttr ==nil {_bfbde .DefTabSzAttr =_gbg .DefTabSzAttr ;};if _bfbde .RtlAttr ==nil {_bfbde .RtlAttr =_gbg .RtlAttr ;};if _bfbde .EaLnBrkAttr ==nil {_bfbde .EaLnBrkAttr =_gbg .EaLnBrkAttr ;};if _bfbde .FontAlgnAttr ==_b .ST_TextFontAlignTypeUnset {_bfbde .FontAlgnAttr =_gbg .FontAlgnAttr ;};if _bfbde .LatinLnBrkAttr ==nil {_bfbde .LatinLnBrkAttr =_gbg .LatinLnBrkAttr ;};if _bfbde .HangingPunctAttr ==nil {_bfbde .HangingPunctAttr =_gbg .HangingPunctAttr ;};if _bfbde .LnSpc ==nil {_bfbde .LnSpc =_gbg .LnSpc ;};if _bfbde .SpcBef ==nil {_bfbde .SpcBef =_gbg .SpcBef ;};if _bfbde .SpcAft ==nil {_bfbde .SpcAft =_gbg .SpcAft ;};if _bfbde .BuClrTx ==nil {_bfbde .BuClrTx =_gbg .BuClrTx ;};if _bfbde .BuClr ==nil {_bfbde .BuClr =_gbg .BuClr ;};if _bfbde .BuSzTx ==nil {_bfbde .BuSzTx =_gbg .BuSzTx ;};if _bfbde .BuSzPct ==nil {_bfbde .BuSzPct =_gbg .BuSzPct ;};if _bfbde .BuSzPts ==nil {_bfbde .BuSzPts =_gbg .BuSzPts ;};if _bfbde .BuFontTx ==nil {_bfbde .BuFontTx =_gbg .BuFontTx ;};if _bfbde .BuFont ==nil {_bfbde .BuFont =_gbg .BuFont ;};if _bfbde .BuNone ==nil {_bfbde .BuNone =_gbg .BuNone ;};if _bfbde .BuAutoNum ==nil {_bfbde .BuAutoNum =_gbg .BuAutoNum ;};if _bfbde .BuChar ==nil {_bfbde .BuChar =_gbg .BuChar ;};if _bfbde .BuBlip ==nil {_bfbde .BuBlip =_gbg .BuBlip ;};if _bfbde .TabLst ==nil {_bfbde .TabLst =_gbg .TabLst ;};if _bfbde .ExtLst ==nil {_bfbde .ExtLst =_gbg .ExtLst ;};_bfbde .DefRPr =_abeg (_bfbde .DefRPr ,_gbg .DefRPr );return _bfbde ;};func (_ceadab *textboxContext )addCurrentParagraph (){_ceadab ._aeg =_ceadab ._edad ._cdcd +_ceadab ._edad ._bedc +_ceadab ._edad ._adb +_ceadab ._edad ._gdbc ;_ceadab ._acac =append (_ceadab ._acac ,_ceadab ._edad );_ceadab .alignParagraph ();};func (_deaf *textboxContext )assignPropsToCurrentParagraph (_bafb *_b .CT_TextParagraphProperties ){_gceb :=12.4;if _bafb ==nil {_deaf ._edad ._dacc =_gceb ;return ;};if _adbc :=_bafb .DefRPr ;_adbc !=nil {_degb :=_adbc .SzAttr ;if _degb !=nil {_gfad :=float64 (*_degb )/1200;if _gceb <=_gfad {_gceb =_gfad ;};};};if _adab :=_bafb .MarLAttr ;_adab !=nil {_deaf ._edad ._dgfe =_c .FromEMU (int64 (*_adab ));};_deaf ._edad ._ecbg =_deaf ._cgee ;if _ggdg :=_bafb .MarRAttr ;_ggdg !=nil {_deaf ._edad ._ecbg -=_c .FromEMU (int64 (*_ggdg ));};if _gcd :=_bafb .IndentAttr ;_gcd !=nil {_deaf ._edad ._dcde =_c .FromEMU (int64 (*_gcd ));};if _acaa :=_bafb .LatinLnBrkAttr ;_acaa !=nil {_deaf ._edad ._cfe =*_acaa ;};if _gdd :=_bafb .LnSpc ;_gdd !=nil {if _fcbae :=_gdd .SpcPct ;_fcbae !=nil {if _ece :=_fcbae .ValAttr .ST_TextSpacingPercent ;_ece !=nil {_gceb =float64 (*_ece )/5000;};};};var _fege float64 ;if _dcgc :=_bafb .SpcBef ;_dcgc !=nil {if _abc :=_dcgc .SpcPts ;_abc !=nil {_fege =float64 (_abc .ValAttr )/100;};};_bgbfd :=_deaf ._acac ;if len (_bgbfd )> 0{_fege -=_bgbfd [len (_bgbfd )-1]._gdbc ;if _fege < 0{_fege =0;};};_deaf ._edad ._bedc =_fege ;if _acbg :=_bafb .SpcAft ;_acbg !=nil {if _eeg :=_acbg .SpcPts ;_eeg !=nil {_deaf ._edad ._gdbc =float64 (_eeg .ValAttr )/100;};};_deaf ._edad ._dacc =_gceb ;_deaf ._edad ._fafe =_bafb .AlgnAttr ;};func (_afg *convertContext )getShapes (_gee *_bd .CT_Shape )[]_eda .Drawable {_age :=[]_eda .Drawable {};_caf :=_gee .SpPr ;if _caf ==nil {return _age ;};var _acfd bool ;if _bdf :=_gee .UseBgFillAttr ;_bdf !=nil {_acfd =*_bdf ;};_ffb ,_bbbg ,_bfa ,_bdc ,_acba ,_ggda ,_aga :=_afg .getShapesFromSpPr (_caf ,_gee .Style ,_acfd );_age =append (_age ,_ffb ...);if _afdf :=_gee .TxBody ;_afdf !=nil {_cfc ,_gebd ,_fdcd ,_gfed ,_efd :=_afg .getPhData (_gee );if _cfc !=nil &&!_aga {_bbbg ,_bfa ,_bdc ,_acba =_gef .GetDataFromXfrm (_cfc );};_cafg ,_afa :=_afg .makePdfBlockFromTxBody (_afdf ,_gebd ,_fdcd ,_bdc ,_acba ,_ggda ,_gfed ,_efd );if _afa !=nil {_db .Log .Debug ("\u0043\u0061\u006e\u006e\u006f\u0074\u0020\u006d\u0061\u006b\u0065\u0020\u0050\u0044\u0046\u0020\u0062\u006c\u006f\u0063\u006b\u0020\u0066\u0072o\u006d\u0020\u0074\u0065\u0078t\u0062\u006fx\u003a\u0020\u0025\u0073",_afa );}else if _cafg !=nil {_cafg .SetPos (_bbbg ,_bfa );_age =append (_age ,_cafg );};};return _age ;};type line struct{_acaf float64 ;_aeb float64 ;_agag float64 ;_bbdg float64 ;_bbdb float64 ;_bacf []*word ;};func (_cdc *convertContext )makePdfBlockFromTable (_feb *_b .Tbl ,_dcgf float64 )*_eda .Table {_gfbd :=_feb .TblGrid ;if _gfbd ==nil {return nil ;};_ddcg :=len (_gfbd .GridCol );if _ddcg ==0{return nil ;};_aac :=[]float64 {};_fcec :=0.0;for _ ,_gba :=range _gfbd .GridCol {_eddb :=_c .FromEMU (_gef .FromSTCoordinate (_gba .WAttr ));_aac =append (_aac ,_eddb );_fcec +=_eddb ;};_dda :=[]float64 {};for _ffbd :=0;_ffbd < _ddcg ;_ffbd ++{_dda =append (_dda ,_aac [_ffbd ]/_fcec );};_faf :=_cdc ._eage .NewTable (_ddcg );_faf .SetColumnWidths (_dda ...);_cfd :=_feb .TblPr ;var _gbda *_b .CT_TableStyle ;if _gfc :=_cfd .Choice ;_gfc !=nil {if _gfc .TableStyle !=nil {_gbda =_gfc .TableStyle ;}else if _gfc .TableStyleId !=nil {_gbda =_cdc ._efdd .GetTableStyleById (*_gfc .TableStyleId );};};_ebba :=_b .NewCT_TablePartStyle ();_ebba .TcStyle =_b .NewCT_TableStyleCellStyle ();_ebba .TcTxStyle =_b .NewCT_TableStyleTextStyle ();if _gbda !=nil {if _gbda .WholeTbl !=nil {*_ebba =*_gbda .WholeTbl ;};if _gbda .TblBg !=nil {if _ebba .TcStyle .Fill ==nil {_ebba .TcStyle .Fill =_gbda .TblBg .Fill ;};};};if _ebba .TcStyle .Fill ==nil {_ebba .TcStyle .Fill =_b .NewCT_FillProperties ();_ebba .TcStyle .Fill .NoFill =_cfd .NoFill ;_ebba .TcStyle .Fill .SolidFill =_cfd .SolidFill ;};_gab :=len (_feb .Tr );for _dfbe ,_egfd :=range _feb .Tr {_cfdg :=_dfbe ==0;_egg :=_dfbe ==_gab -1;_bgaa :=_dfbe %2==0;_gefg :=len (_egfd .Tc );var _aefc *_b .CT_TablePartStyle ;if _cfdg {_aefc =_gbda .FirstRow ;}else if _bgaa {_aefc =_gbda .Band2H ;}else {_aefc =_gbda .Band1H ;};var _bee float64 ;for _dgg ,_eece :=range _egfd .Tc {_bba :=_dgg ==0;_fdf :=_dgg ==_gefg -1;_deg :=_dgg %2==0;var _acd *_b .CT_TablePartStyle ;if _bba {_acd =_gbda .FirstCol ;}else if _deg {_acd =_gbda .Band2V ;}else {_acd =_gbda .Band1V ;};_gac :=_dagd (_dagd (_acd ,_aefc ),_ebba );_bcba :=_cdc .addCellToTable (_faf ,_eece ,_gac ,_dcgf *_dda [_dgg ],_cfdg ,_egg ,_bba ,_fdf );if _bcba > _bee {_bee =_bcba ;};};_bdaf :=_c .FromEMU (_gef .FromSTCoordinate (_egfd .HAttr ));if _bdaf < _bee {_bdaf =_bee ;};if _bdaf < _cecf (4){_bdaf =_cecf (4);};_faf .SetRowHeight (_faf .CurRow (),_bdaf );};return _faf ;};type symbolStyle struct{_aabf *string ;_abd *float64 ;_dde *string ;_dabc *bool ;_fcca *bool ;_bcecc *bool ;_abbc *bool ;_cgda *bool ;};func (_afgg *convertContext )getShapesFromSpPr (_bag *_b .CT_ShapeProperties ,_bgebf *_b .CT_ShapeStyle ,_fed bool )([]_eda .Drawable ,float64 ,float64 ,float64 ,float64 ,_eda .Color ,bool ){_cea :=[]_eda .Drawable {};var _bfbe ,_gff ,_bcg ,_cgad ,_cec float64 ;var _gfag ,_edca ,_dgf ,_deac _eda .Color ;var _dbe *_b .CT_BlipFillProperties ;_cef ,_bfbg :=1.0,1.0;if _bgebf !=nil {_gfag ,_edca ,_deac =_afgg .getStyleColors (_bgebf );};if _aad :=_bag .Ln ;_aad !=nil {if _aad .NoFill !=nil {_dgf ,_cec =nil ,0;}else {_dgf ,_cec ,_cef =_afgg .getInfoFromLn (_aad );if _dgf ==nil {_dgf =_deac ;};};};if _bag .NoFill !=nil {_edca ,_bfbg =nil ,0;}else if _fed {_edca =_afgg ._cacg ._bafg ;_bfbg =_afgg ._cacg ._afef ;_dbe =_afgg ._cacg ._ccgf ;}else if _ebbe :=_bag .SolidFill ;_ebbe !=nil {_edca ,_bfbg =_afgg .getColorFromSolidFill (_ebbe );};var _fbd bool ;if _gbd :=_bag .Xfrm ;_gbd !=nil {_bfbe ,_gff ,_bcg ,_cgad =_gef .GetDataFromXfrm (_gbd );_fbd =true ;};if _ccf :=_bag .CustGeom ;_ccf !=nil {_eaa :=[]_cge .Point {};_abe ,_ceg :=1.0,1.0;if _cead :=_ccf .PathLst ;_cead !=nil {for _ ,_geab :=range _cead .Path {if _geab !=nil {if _fag :=_geab .WAttr ;_fag !=nil {_abe =_bcg /_c .FromEMU (*_fag );};if _cgg :=_geab .HAttr ;_cgg !=nil {_ceg =_cgad /_c .FromEMU (*_cgg );};for _ ,_ceada :=range _geab .Close {if _ceada !=nil {};};for _ ,_efaa :=range _geab .MoveTo {if _efaa !=nil &&_efaa .Pt !=nil {_edde ,_edaa :=_ccbf (_efaa .Pt );_eaa =append (_eaa ,_cge .Point {X :_edde *_abe +_bfbe ,Y :_edaa *_ceg +_gff });};};for _ ,_ffg :=range _geab .LnTo {if _ffg !=nil &&_ffg .Pt !=nil {_abee ,_fdef :=_ccbf (_ffg .Pt );_eaa =append (_eaa ,_cge .Point {X :_abee *_abe +_bfbe ,Y :_fdef *_ceg +_gff });};};_adc :=_afgg ._eage .NewPolygon ([][]_cge .Point {_eaa });_adc .SetFillColor (_edca );_adc .SetFillOpacity (_bfbg );_adc .SetBorderWidth (_cec );if _dgf !=nil {_adc .SetBorderColor (_dgf );_adc .SetBorderOpacity (_cef );};_cea =append (_cea ,_adc );};};};};if _cgf :=_bag .PrstGeom ;_cgf !=nil {switch _cgf .PrstAttr {case _b .ST_ShapeTypeRect :if _dbe !=nil {_cgfe :=_afgg .getShapeFromBlipFill (_dbe ,_bfbe ,_gff ,_bcg ,_cgad );_cea =append (_cea ,_cgfe );}else {_eddf :=_afgg ._eage .NewRectangle (_bfbe ,_gff ,_bcg ,_cgad );_eddf .SetFillColor (_edca );_eddf .SetFillOpacity (_bfbg );_eddf .SetBorderWidth (_cec );if _dgf !=nil {_eddf .SetBorderColor (_dgf );_eddf .SetBorderOpacity (_cef );};_cea =append (_cea ,_eddf );};case _b .ST_ShapeTypeLine :_gafa :=_afgg ._eage .NewLine (_bfbe ,_gff ,_bfbe +_bcg ,_gff +_cgad );_gafa .SetLineWidth (_cec );if _dgf !=nil {_gafa .SetColor (_dgf );};_cea =append (_cea ,_gafa );};};return _cea ,_bfbe ,_gff ,_bcg ,_cgad ,_gfag ,_fbd ;};

// RegisterFontsFromDirectory registers all fonts from the given directory automatically detecting font families and styles.
func RegisterFontsFromDirectory (dirName string )error {return _gef .RegisterFontsFromDirectory (dirName );};func (_babg *textboxContext )newParagraph (){_cce :=&paragraph {};_cce ._cdcd =_babg ._aeg ;_babg ._edad =_cce ;};func (_bgbf *convertContext )tileImage (_fegc *_eda .Image ,_eaee *_b .CT_TileInfoProperties ,_dfcg ,_fdc float64 )*_eda .Image {_fg ,_acg :=1.0,1.0;if _bfc :=_eaee .SxAttr ;_bfc !=nil {_fg =_gef .FromSTPercentage (_bfc );};if _dbc :=_eaee .SyAttr ;_dbc !=nil {_acg =_gef .FromSTPercentage (_dbc );};_ebac :=_gef .MakeTempCreator (_dfcg ,_fdc );_fegc .Scale (_fg ,_acg );_gfe ,_bdae :=_fegc .Width (),_fegc .Height ();var _bcb ,_eff float64 ;if _ege :=_eaee .TxAttr ;_ege !=nil {_bcb =_c .FromEMU (_gef .FromSTCoordinate (*_ege ));};if _ce :=_eaee .TyAttr ;_ce !=nil {_eff =_c .FromEMU (_gef .FromSTCoordinate (*_ce ));};if _bcb > 0{_bcb -=_gfe ;};if _eff > 0{_eff -=_bdae ;};_dbd :=_bgbf ._afdd /_gfe +1;_bfb :=_bgbf ._gdb /_bdae +1;for _acb :=0.0;_acb <=_dbd ;_acb ++{_bff :=_acb *_gfe ;for _bgg :=0.0;_bgg <=_bfb ;_bgg ++{_edd :=_bgg *_bdae ;_fegc .SetPos (_bff +_bcb ,_edd +_eff );_ebac .Draw (_fegc );};};_fb ,_fdd :=_gef .GetPageFromCreator (_ebac );if _fdd !=nil {_db .Log .Debug ("\u0043\u0061\u006e\u006e\u006f\u0074 \u0067\u0065\u0074\u0020\u0069\u006d\u0061\u0067\u0065\u0020\u0066\u0072\u006fm\u0020\u0063\u0072\u0065\u0061\u0074\u006fr\u003a\u0020\u0025\u0073",_fdd );return nil ;};_agc ,_fdd :=_ad .NewImageDevice ().Render (_fb );if _fdd !=nil {_db .Log .Debug ("\u0043\u0061\u006eno\u0074\u0020\u0072\u0065\u006e\u0064\u0065\u0072\u0020\u0069\u006d\u0061\u0067\u0065\u003a\u0020\u0025\u0073",_fdd );return nil ;};_dab ,_fdd :=_bgbf ._eage .NewImageFromGoImage (_agc );if _fdd !=nil {_db .Log .Debug ("\u0043\u0061nn\u006f\u0074\u0020c\u0072\u0065\u0061\u0074e i\u006dag\u0065\u0020\u0066\u0072\u006f\u006d\u0020Go\u0049\u006d\u0061\u0067\u0065\u003a\u0020%\u0073",_fdd );return nil ;};return _dab ;};func (_bcf *textboxContext )alignSymbolsVertically (){for _ ,_ffba :=range _bcf ._acac {for _ ,_bcfg :=range _ffba ._bdcg {_egd :=0.0;for _ ,_fba :=range _bcfg ._bacf {for _ ,_baad :=range _fba ._fcba {if _baad ._eedf > _egd {_egd =_baad ._eedf ;};};};for _ ,_dba :=range _bcfg ._bacf {for _ ,_cbee :=range _dba ._fcba {if _cbee ._cdbc < _egd {_cbee ._eecb =_egd -_cbee ._cdbc ;};};};};};};var _ggf =[]romanMatch {romanMatch {1000,"\u006d"},romanMatch {900,"\u0063\u006d"},romanMatch {500,"\u0064"},romanMatch {400,"\u0063\u0064"},romanMatch {100,"\u0063"},romanMatch {90,"\u0078\u0063"},romanMatch {50,"\u006c"},romanMatch {40,"\u0078\u006c"},romanMatch {10,"\u0078"},romanMatch {9,"\u0069\u0078"},romanMatch {5,"\u0076"},romanMatch {4,"\u0069\u0076"},romanMatch {1,"\u0069"}};func (_ecea *textboxContext )drawParagraphs (){_ecea ._fgfc .NewPage ();for _ ,_eac :=range _ecea ._acac {for _ ,_degf :=range _eac ._bdcg {for _ ,_bdcf :=range _degf ._bacf {for _ ,_ecg :=range _bdcf ._fcba {_gbea :=_ecea ._fgfc .NewStyledParagraph ();if _ecg ._aag {_ecg ._eecb =0;}else if _ecg ._cfgc {_ecg ._eecb =1.2*_degf ._bbdb -_ecg ._cdbc ;};_gefd :=_bdcf ._fbee +_ecg ._gggff ;_egdd :=_eac ._cdcd +_degf ._acaf +_ecg ._eecb ;_gbea .SetPos (_gefd ,_egdd );_gfbc :=_gbea .Append (_ecg ._bgac );if _ecg ._eaeg !=nil {_gfbc .Style =*_ecg ._eaeg ;};_ecea ._fgfc .Draw (_gbea );if _ecg ._dadde {_cgaf :=_egdd +_ecg ._cdbc +2;_gef .DrawLine (_ecea ._fgfc ,_gefd ,_cgaf ,_gefd +_ecg ._dadf ,_cgaf ,1,_ecg ._eaeg .Color );};};};};};};var _fbbd =map[string ]int32 {"\u0076":9830,"\u00d8":8594,"\u00fc":8730};func _cecf (_afgfg float64 )float64 {return _afgfg *_c .Millimeter };const (FontStyle_Regular FontStyle =0;FontStyle_Bold FontStyle =1;FontStyle_Italic FontStyle =2;FontStyle_BoldItalic FontStyle =3;);func (_gebef *convertContext )getColorFromMatrixReference (_bbdgb *_b .CT_StyleMatrixReference )_eda .Color {if _bbdgb ==nil {return nil ;};var _fbdb _eda .Color ;var _acgg string ;if _aaf :=_bbdgb .SrgbClr ;_aaf !=nil {_acgg =_aaf .ValAttr ;}else if _cfgd :=_bbdgb .SchemeClr ;_cfgd !=nil {_acgg =_gef .GetColorStringFromDmlColor (_gebef ._efdd .GetColorBySchemeColor (_cfgd .ValAttr ));_acgg =_gef .AdjustColor (_acgg ,_cfgd .EG_ColorTransform );};if _acgg !=""{_fbdb =_eda .ColorRGBFromHex ("\u0023"+_acgg );};return _fbdb ;};func (_bgb *convertContext )extractDefaultProperties (){_gea :=_bgb ._efdd .X ();_be :=_gea .DefaultTextStyle ;var _geb ,_bf ,_acf ,_gd ,_eg ,_df ,_ef ,_bbb ,_ec ,_adf *_b .CT_TextParagraphProperties ;if _be !=nil {_geb =_be .DefPPr ;_bf =_baea (_be .Lvl1pPr ,_geb );_acf =_baea (_be .Lvl2pPr ,_geb );_gd =_baea (_be .Lvl3pPr ,_geb );_eg =_baea (_be .Lvl4pPr ,_geb );_df =_baea (_be .Lvl5pPr ,_geb );_ef =_baea (_be .Lvl6pPr ,_geb );_bbb =_baea (_be .Lvl7pPr ,_geb );_ec =_baea (_be .Lvl8pPr ,_geb );_adf =_baea (_be .Lvl9pPr ,_geb );_bgb ._edce =_geb ;_bgb ._aadb =_geb .DefRPr ;};_bgb ._aabb =make ([]*_b .CT_TextParagraphProperties ,9);_bgb ._aabb [0]=_bf ;_bgb ._aabb [1]=_acf ;_bgb ._aabb [2]=_gd ;_bgb ._aabb [3]=_eg ;_bgb ._aabb [4]=_df ;_bgb ._aabb [5]=_ef ;_bgb ._aabb [6]=_bbb ;_bgb ._aabb [7]=_ec ;_bgb ._aabb [8]=_adf ;_edc :=_bgb ._efdd .SlideMasters ()[0].X ();_fda :=_edc .TxStyles ;_bgeb :=_fda .TitleStyle ;_bgb ._dbcg =_baea (_bgeb .DefPPr ,_geb );_bgb ._cdf =_bgb ._dbcg .DefRPr ;_bgb ._fbe =make ([]*_b .CT_TextParagraphProperties ,9);_bgb ._fbe [0]=_baea (_bgeb .Lvl1pPr ,_bf );_bgb ._fbe [1]=_baea (_bgeb .Lvl2pPr ,_acf );_bgb ._fbe [2]=_baea (_bgeb .Lvl3pPr ,_gd );_bgb ._fbe [3]=_baea (_bgeb .Lvl4pPr ,_eg );_bgb ._fbe [4]=_baea (_bgeb .Lvl5pPr ,_df );_bgb ._fbe [5]=_baea (_bgeb .Lvl6pPr ,_ef );_bgb ._fbe [6]=_baea (_bgeb .Lvl7pPr ,_bbb );_bgb ._fbe [7]=_baea (_bgeb .Lvl8pPr ,_ec );_bgb ._fbe [8]=_baea (_bgeb .Lvl9pPr ,_adf );_gf :=_fda .BodyStyle ;_bgb ._fcb =_baea (_gf .DefPPr ,_geb );_bgb ._fgf =_bgb ._fcb .DefRPr ;_bgb ._gdab =make ([]*_b .CT_TextParagraphProperties ,9);_bgb ._gdab [0]=_baea (_gf .Lvl1pPr ,_bf );_bgb ._gdab [1]=_baea (_gf .Lvl2pPr ,_acf );_bgb ._gdab [2]=_baea (_gf .Lvl3pPr ,_gd );_bgb ._gdab [3]=_baea (_gf .Lvl4pPr ,_eg );_bgb ._gdab [4]=_baea (_gf .Lvl5pPr ,_df );_bgb ._gdab [5]=_baea (_gf .Lvl6pPr ,_ef );_bgb ._gdab [6]=_baea (_gf .Lvl7pPr ,_bbb );_bgb ._gdab [7]=_baea (_gf .Lvl8pPr ,_ec );_bgb ._gdab [8]=_baea (_gf .Lvl9pPr ,_adf );};func (_aee *convertContext )getBorderStyle (_affb *_b .CT_LineProperties )(_eda .CellBorderStyle ,*_eda .Color ,float64 ){if _affb ==nil ||_affb .NoFill !=nil {return _eda .CellBorderStyleNone ,nil ,0;};var _cedd _eda .Color ;if _aae :=_affb .SolidFill ;_aae !=nil {_cedd ,_ =_aee .getColorFromSolidFill (_aae );};_ede :=0.0;if _bgbg :=_affb .WAttr ;_bgbg !=nil {_ede =_c .FromEMU (int64 (*_bgbg ));};return _eda .CellBorderStyleSingle ,&_cedd ,_ede ;};type convertContext struct{_eage *_eda .Creator ;_ecbf *_gef .Rectangle ;_efdd *_ed .Presentation ;_effd *_ed .Slide ;_ada *_bd .SldMaster ;_bfg *_bd .SldLayout ;_gdb float64 ;_afdd float64 ;_cfcb []_eda .Drawable ;_cacg *background ;_edce *_b .CT_TextParagraphProperties ;_aadb *_b .CT_TextCharacterProperties ;_dbcg *_b .CT_TextParagraphProperties ;_cdf *_b .CT_TextCharacterProperties ;_fcb *_b .CT_TextParagraphProperties ;_fgf *_b .CT_TextCharacterProperties ;_aabb []*_b .CT_TextParagraphProperties ;_fbe []*_b .CT_TextParagraphProperties ;_gdab []*_b .CT_TextParagraphProperties ;_gfcf *_b .Theme ;_afgf *_b .CT_ColorMappingOverride ;};func (_eag *convertContext )drawSlide (){_eag ._eage .NewPage ();for _ ,_ag :=range _eag ._cfcb {if _ag !=nil {_eag ._eage .MoveTo (0,0);_eag ._eage .Draw (_ag );};};};func (_beeb *convertContext )getShapeFromBlipFill (_eecg *_b .CT_BlipFillProperties ,_fbbf ,_gbdaa ,_dfgcd ,_effdb float64 )_eda .Drawable {_ebab ,_gffg ,_bbfg :=_beeb .makePdfImageFromBlipFill (_eecg );if _bbfg !=nil {_db .Log .Debug ("\u0043\u0061\u006e\u006e\u006f\u0074\u0020\u006d\u0061\u006b\u0065\u0020\u0050D\u0046\u0020\u0069\u006d\u0061\u0067e\u0020\u0066\u0072\u006f\u006d\u0020\u0042\u006c\u0069\u0070\u0046\u0069\u006cl\u003a\u0020\u0025\u0073",_bbfg );return nil ;};if _ebab ==nil {return nil ;};if _cfcae :=_eecg .Tile ;_cfcae !=nil {_ebab =_beeb .tileImage (_ebab ,_eecg .Tile ,_dfgcd ,_effdb );};if _afdc :=_eecg .Stretch ;_afdc !=nil {_ebab ,_fbbf ,_gbdaa =_beeb .stretchImage (_ebab ,_eecg .Stretch ,_fbbf ,_gbdaa ,_dfgcd ,_effdb );};if len (_gffg )==0{_ebab .SetPos (_fbbf ,_gbdaa );return _ebab ;};_ebab =_beeb .applyBlipEffectsOnImg (_ebab ,_fbbf ,_gbdaa ,_gffg );_ebab .SetPos (_fbbf ,_gbdaa );return _ebab ;};func _abeg (_bggg ,_ggfg *_b .CT_TextCharacterProperties )*_b .CT_TextCharacterProperties {_gdfd :=_b .NewCT_TextCharacterProperties ();if _bggg !=nil {*_gdfd =*_bggg ;};if _ggfg ==nil {return _gdfd ;};if _gdfd .KumimojiAttr ==nil {_gdfd .KumimojiAttr =_ggfg .KumimojiAttr ;};if _gdfd .LangAttr ==nil {_gdfd .LangAttr =_ggfg .LangAttr ;};if _gdfd .AltLangAttr ==nil {_gdfd .AltLangAttr =_ggfg .AltLangAttr ;};if _gdfd .SzAttr ==nil {_gdfd .SzAttr =_ggfg .SzAttr ;};if _gdfd .BAttr ==nil {_gdfd .BAttr =_ggfg .BAttr ;};if _gdfd .IAttr ==nil {_gdfd .IAttr =_ggfg .IAttr ;};if _gdfd .UAttr ==_b .ST_TextUnderlineTypeUnset {_gdfd .UAttr =_ggfg .UAttr ;};if _gdfd .StrikeAttr ==_b .ST_TextStrikeTypeUnset {_gdfd .StrikeAttr =_ggfg .StrikeAttr ;};if _gdfd .KernAttr ==nil {_gdfd .KernAttr =_ggfg .KernAttr ;};if _gdfd .CapAttr ==_b .ST_TextCapsTypeUnset {_gdfd .CapAttr =_ggfg .CapAttr ;};if _gdfd .SpcAttr ==nil {_gdfd .SpcAttr =_ggfg .SpcAttr ;};if _gdfd .NormalizeHAttr ==nil {_gdfd .NormalizeHAttr =_ggfg .NormalizeHAttr ;};if _gdfd .BaselineAttr ==nil {_gdfd .BaselineAttr =_ggfg .BaselineAttr ;};if _gdfd .NoProofAttr ==nil {_gdfd .NoProofAttr =_ggfg .NoProofAttr ;};if _gdfd .DirtyAttr ==nil {_gdfd .DirtyAttr =_ggfg .DirtyAttr ;};if _gdfd .ErrAttr ==nil {_gdfd .ErrAttr =_ggfg .ErrAttr ;};if _gdfd .SmtCleanAttr ==nil {_gdfd .SmtCleanAttr =_ggfg .SmtCleanAttr ;};if _gdfd .SmtIdAttr ==nil {_gdfd .SmtIdAttr =_ggfg .SmtIdAttr ;};if _gdfd .BmkAttr ==nil {_gdfd .BmkAttr =_ggfg .BmkAttr ;};if _gdfd .Ln ==nil {_gdfd .Ln =_ggfg .Ln ;};if _gdfd .NoFill ==nil {_gdfd .NoFill =_ggfg .NoFill ;};if _gdfd .SolidFill ==nil {_gdfd .SolidFill =_ggfg .SolidFill ;};if _gdfd .BlipFill ==nil {_gdfd .BlipFill =_ggfg .BlipFill ;};if _gdfd .EffectLst ==nil {_gdfd .EffectLst =_ggfg .EffectLst ;};if _gdfd .EffectDag ==nil {_gdfd .EffectDag =_ggfg .EffectDag ;};if _gdfd .Highlight ==nil {_gdfd .Highlight =_ggfg .Highlight ;};if _gdfd .ULnTx ==nil {_gdfd .ULnTx =_ggfg .ULnTx ;};if _gdfd .ULn ==nil {_gdfd .ULn =_ggfg .ULn ;};if _gdfd .UFillTx ==nil {_gdfd .UFillTx =_ggfg .UFillTx ;};if _gdfd .UFill ==nil {_gdfd .UFill =_ggfg .UFill ;};if _gdfd .Latin ==nil {_gdfd .Latin =_ggfg .Latin ;};if _gdfd .Ea ==nil {_gdfd .Ea =_ggfg .Ea ;};if _gdfd .Cs ==nil {_gdfd .Cs =_ggfg .Cs ;};if _gdfd .Sym ==nil {_gdfd .Sym =_ggfg .Sym ;};if _gdfd .Rtl ==nil {_gdfd .Rtl =_ggfg .Rtl ;};return _gdfd ;};func _fgcf (_gdbf int ,_bcgg bool )string {_acfg :=_a .NewBuffer ([]byte {});for _ ,_eeeb :=range _ggf {for {if _gdbf < _eeeb ._fea {break ;};_acfg .WriteString (_eeeb ._ccd );_gdbf -=_eeeb ._fea ;};};_dfdc :=_acfg .String ();if _bcgg {_dfdc =_d .ToUpper (_dfdc );};return _dfdc ;};func (_gbdg *convertContext )renderCurrentStateToGoImage ()(_gg .Image ,error ){_ffaf :=_gef .MakeTempCreator (_gbdg ._afdd ,_gbdg ._gdb );_ffaf .NewPage ();for _ ,_egcf :=range _gbdg ._cfcb {if _egcf !=nil {_ffaf .MoveTo (0,0);_ffaf .Draw (_egcf );};};_fef ,_feedd :=_gef .GetPageFromCreator (_ffaf );if _feedd !=nil {return nil ,_feedd ;};return _ad .NewImageDevice ().Render (_fef );};func (_fcea *convertContext )applyBlipEffectsOnImg (_gdg *_eda .Image ,_eeac ,_fgge float64 ,_fcedg []*_b .CT_BlipChoice )*_eda .Image {if len (_fcedg )==0{return _gdg ;};_gdg .SetPos (_eeac ,_fgge );_cfgde ,_cegc :=_fcea .renderPageWithDrawableToGoImage (_gdg );if _cegc !=nil {_db .Log .Debug ("\u0045\u0072\u0072\u006f\u0072\u0020\u0072\u0065\u006e\u0064\u0065\u0072\u0020a\u006e\u0020\u0069\u006d\u0061\u0067e\u0020\u0074\u006f\u0020\u0061\u0020\u0047\u006f\u0020\u0069\u006d\u0061\u0067e\u003a\u0020\u0025\u0073",_cegc );return _gdg ;};_ggbc ,_cegc :=_fcea .renderCurrentStateToGoImage ();if _cegc !=nil {_db .Log .Debug ("\u0045\u0072\u0072\u006f\u0072\u0020\u0072\u0065n\u0064\u0065\u0072 t\u0068\u0065\u0020\u0063\u0075\u0072r\u0065\u006e\u0074\u0020\u0073\u0074\u0061\u0074\u0065\u0020\u0074\u006f\u0020\u0061\u0020G\u006f\u0020\u0069\u006d\u0061\u0067\u0065\u003a \u0025\u0073",_cegc );return _gdg ;};_dfdgb :=_cfgde .Bounds ();_cgeed :=_gg .NewRGBA (_dfdgb );_ddceb ,_dagb :=_gdg .Width (),_gdg .Height ();for _ ,_bacb :=range _fcedg {for _ ,_ffag :=range _bacb .AlphaModFix {if _efdb :=_ffag .AmtAttr ;_efdb !=nil {if _gdbcf :=_efdb .ST_PositivePercentageDecimal ;_gdbcf !=nil {_gaaa :=uint8 (255*(*_gdbcf )/100000);_geed :=_gg .NewUniform (_ge .Alpha {_gaaa });_f .Draw (_cgeed ,_dfdgb ,_ggbc ,_gg .Point {0,0},_f .Src );_f .DrawMask (_cgeed ,_dfdgb ,_cfgde ,_gg .Point {0,0},_geed ,_gg .Point {0,0},_f .Over );};};};};_dgcg :=_gg .Rect (int (_eeac ),int (_fgge ),int (_eeac +_ddceb )+1,int (_fgge +_dagb )+1);_egb :=_gef .CropImageByRect (_cgeed ,_dgcg );_fdbe ,_cegc :=_fcea ._eage .NewImageFromGoImage (_egb );if _cegc !=nil {_db .Log .Debug ("\u0045\u0072\u0072\u006f\u0072\u0020\u0061\u006e\u0020\u0069\u006d\u0061\u0067\u0065\u0020t\u006f \u0061\u0020\u0047\u006f\u0020\u0069\u006d\u0061\u0067\u0065\u003a\u0020\u0025\u0073",_cegc );return _gdg ;};return _fdbe ;};func (_bfdb *textboxContext )adjustHeights (_bfe float64 ){if _bfdb ._agea ._bbdb < _bfe {_bfdb ._edad ._adb +=(_bfe -_bfdb ._agea ._bbdb );_bfdb ._agea ._bbdb =_bfe ;};};func _cfca (_caec string )[]*symbol {_cbd :=[]*symbol {};for _ ,_cda :=range _caec {_cbd =append (_cbd ,&symbol {_bgac :string (_cda )});};return _cbd ;};func (_fbdf *convertContext )makeStyleFromRPr (_cac *_b .CT_TextCharacterProperties )(*_eda .TextStyle ,bool ,bool ,bool ){var _debb ,_agf ,_geef bool ;_dcg :=_fbdf ._eage .NewTextStyle ();if _cac !=nil {_gggc :=_gef .FontStyle_Regular ;_ade :=_gffb (_cac .BAttr );_gffa :=_gffb (_cac .IAttr );if _ade &&_gffa {_gggc =_gef .FontStyle_BoldItalic ;}else if _ade {_gggc =_gef .FontStyle_Bold ;}else if _gffa {_gggc =_gef .FontStyle_Italic ;};_geef =_cac .UAttr !=_b .ST_TextUnderlineTypeUnset &&_cac .UAttr !=_b .ST_TextUnderlineTypeNone ;_bcgf :="\u0064e\u0066\u0061\u0075\u006c\u0074";if _dfa :=_cac .Latin ;_dfa !=nil {_bcgf =_dfa .TypefaceAttr ;}else if _abgd :=_cac .Ea ;_abgd !=nil {_bcgf =_abgd .TypefaceAttr ;}else if _gbb :=_cac .Cs ;_gbb !=nil {_bcgf =_gbb .TypefaceAttr ;}else if _gage :=_cac .Sym ;_gage !=nil {_bcgf =_gage .TypefaceAttr ;};if _egfgc ,_agfb :=_gef .StdFontsMap [_bcgf ];_agfb {_dcg .Font =_gef .AssignStdFontByName (_dcg ,_egfgc [_gggc ]);}else if _ced :=_gef .GetRegisteredFont (_bcgf ,_gggc );_ced !=nil {_dcg .Font =_ced ;}else {_db .Log .Debug ("\u0046\u006f\u006e\u0074\u0020\u0025\u0073\u0020\u0077\u0069\u0074h\u0020\u0073\u0074\u0079\u006c\u0065\u0020\u0025s\u0020i\u0073\u0020\u006e\u006f\u0074\u0020\u0066\u006f\u0075\u006e\u0064\u002c\u0020\u0072\u0065\u0073\u0065\u0074 \u0074\u006f\u0020\u0064\u0065\u0066\u0061\u0075\u006c\u0074\u002e",_bcgf ,_gggc );_dcg .Font =_gef .AssignStdFontByName (_dcg ,_gef .StdFontsMap ["\u0064e\u0066\u0061\u0075\u006c\u0074"][_gggc ]);};var _gbbb float64 ;if _afb :=_cac .SzAttr ;_afb !=nil {_gbbb =float64 (*_afb )/100;}else {_gbbb =_gef .DefaultFontSize ;};if _cae :=_cac .BaselineAttr ;_cae !=nil {if _aedc :=_cae .ST_PercentageDecimal ;_aedc !=nil {if *_aedc > 0{_debb =true ;}else if *_aedc < 0{_agf =true ;};};};if _debb ||_agf {_gbbb *=0.64;};_dcg .FontSize =_gbbb ;_bca :=0.0;if _bcd :=_cac .SpcAttr ;_bcd !=nil {if _fdce :=_bcd .ST_TextPointUnqualified ;_fdce !=nil {_bca =float64 (*_fdce )/100;};};_dcg .CharSpacing =_bca ;};return &_dcg ,_debb ,_agf ,_geef ;};func _eggfa (_eegg *_b .CT_TextCharacterProperties ,_gddb *_b .CT_TableStyleTextStyle )*_b .CT_TextCharacterProperties {_gec :=_b .NewCT_TextCharacterProperties ();if _eegg !=nil {*_gec =*_eegg ;};if _gddb ==nil {return _gec ;};if _gec .BAttr ==nil &&_gddb .BAttr !=_b .ST_OnOffStyleTypeUnset {_ggge :=_gddb .BAttr ==_b .ST_OnOffStyleTypeOn ;_gec .BAttr =&_ggge ;};if _gec .IAttr ==nil &&_gddb .IAttr !=_b .ST_OnOffStyleTypeUnset {_aacf :=_gddb .IAttr ==_b .ST_OnOffStyleTypeOn ;_gec .IAttr =&_aacf ;};if _gec .NoFill ==nil &&_gec .SolidFill ==nil {_gec .SolidFill =_b .NewCT_SolidColorFillProperties ();_gec .SolidFill .ScrgbClr =_gddb .ScrgbClr ;_gec .SolidFill .SrgbClr =_gddb .SrgbClr ;_gec .SolidFill .HslClr =_gddb .HslClr ;_gec .SolidFill .SysClr =_gddb .SysClr ;_gec .SolidFill .SchemeClr =_gddb .SchemeClr ;_gec .SolidFill .PrstClr =_gddb .PrstClr ;};if _gfeg :=_gddb .Font ;_gfeg !=nil &&_gec .Latin ==nil &&_gec .Ea ==nil &&_gec .Cs ==nil {_gec .Latin =_gfeg .Latin ;_gec .Ea =_gfeg .Ea ;_gec .Cs =_gfeg .Cs ;};return _gec ;};func (_bg *convertContext )makePdfBlockFromChart (_af *_de .Chart ,_da ,_ab float64 )(*_eda .Block ,error ){_ac :=_af .CT_RelId .IdAttr ;_ae :=_bg ._effd .GetChartSpaceByRelId (_ac );if _ae ==nil {return nil ,_g .New ("\u004e\u006f\u0020\u0063\u0068\u0061\u0072\u0074\u0073\u0070\u0061\u0063\u0065");};var _fc *_b .Theme ;_aed :=_bg ._efdd .Themes ();if len (_aed )> 0{_fc =_aed [0];};return _gef .MakeBlockFromChartSpace (_ae ,_da ,_ab ,_fc );};func _dcbf (_fdb ,_gcdg *_b .CT_TableStyleTextStyle )*_b .CT_TableStyleTextStyle {_cde :=_b .NewCT_TableStyleTextStyle ();if _fdb !=nil {*_cde =*_fdb ;};if _gcdg ==nil {return _cde ;};if _cde .BAttr ==_b .ST_OnOffStyleTypeUnset {_cde .BAttr =_gcdg .BAttr ;};if _cde .IAttr ==_b .ST_OnOffStyleTypeUnset {_cde .IAttr =_gcdg .IAttr ;};if _cde .Font ==nil {_cde .Font =_gcdg .Font ;};if _cde .FontRef ==nil {_cde .FontRef =_gcdg .FontRef ;};if _cde .ScrgbClr ==nil {_cde .ScrgbClr =_gcdg .ScrgbClr ;};if _cde .SrgbClr ==nil {_cde .SrgbClr =_gcdg .SrgbClr ;};if _cde .HslClr ==nil {_cde .HslClr =_gcdg .HslClr ;};if _cde .SysClr ==nil {_cde .SysClr =_gcdg .SysClr ;};if _cde .SchemeClr ==nil {_cde .SchemeClr =_gcdg .SchemeClr ;};if _cde .PrstClr ==nil {_cde .PrstClr =_gcdg .PrstClr ;};return _cde ;};func _dagd (_gcee ,_fggd *_b .CT_TablePartStyle )*_b .CT_TablePartStyle {_gagbe :=_b .NewCT_TablePartStyle ();if _gcee !=nil {*_gagbe =*_gcee ;};if _fggd ==nil {return _gagbe ;};if _gagbe .TcTxStyle ==nil {_gagbe .TcTxStyle =_fggd .TcTxStyle ;}else {_gagbe .TcTxStyle =_dcbf (_gagbe .TcTxStyle ,_fggd .TcTxStyle );};if _gagbe .TcStyle ==nil {_gagbe .TcStyle =_fggd .TcStyle ;}else {_gagbe .TcStyle =_ddeg (_gagbe .TcStyle ,_fggd .TcStyle );};return _gagbe ;};func _bfbd (_geg int ,_afee bool )string {_afaba :=(_geg -1)/26+1;_acdc :=byte ((_geg -1)%26);if _afee {_acdc +=byte (65);}else {_acdc +=byte (97);};_baef :=_a .NewBuffer ([]byte {});for _beed :=0;_beed < _afaba ;_beed ++{_baef .Write ([]byte {_acdc });};return _baef .String ();};func _bcae (_adad *_b .CT_TableCellProperties ,_eacd *_b .CT_TableStyleCellStyle ,_aabg ,_dgff ,_ebca ,_aaa bool )*_b .CT_TableCellProperties {_ebe :=_b .NewCT_TableCellProperties ();if _adad !=nil {*_ebe =*_adad ;};if _eacd ==nil {return _ebe ;};if _eecd :=_eacd .FillRef ;_eecd !=nil {_geeb :=_b .NewCT_SolidColorFillProperties ();_geeb .ScrgbClr =_eecd .ScrgbClr ;_geeb .SrgbClr =_eecd .SrgbClr ;_geeb .HslClr =_eecd .HslClr ;_geeb .SysClr =_eecd .SysClr ;_geeb .SchemeClr =_eecd .SchemeClr ;_geeb .PrstClr =_eecd .PrstClr ;_ebe .SolidFill =_geeb ;};if _ebe .NoFill ==nil &&_ebe .SolidFill ==nil {if _aba :=_eacd .Fill ;_aba !=nil {if _ebe .NoFill ==nil {_ebe .NoFill =_aba .NoFill ;};if _ebe .SolidFill ==nil {_ebe .SolidFill =_aba .SolidFill ;};};};if _fbde :=_eacd .TcBdr ;_fbde !=nil {if _ebe .LnL ==nil {var _dgcb *_b .CT_ThemeableLineStyle ;if _ebca {_dgcb =_fbde .Left ;}else {_dgcb =_fbde .InsideV ;};if _dgcb !=nil {_ebe .LnL =_dgcb .Ln ;};};if _ebe .LnR ==nil {var _dfgf *_b .CT_ThemeableLineStyle ;if _aaa {_dfgf =_fbde .Right ;}else {_dfgf =_fbde .InsideV ;};if _dfgf !=nil {_ebe .LnR =_dfgf .Ln ;};};if _ebe .LnT ==nil {var _fdceg *_b .CT_ThemeableLineStyle ;if _aabg {_fdceg =_fbde .Top ;}else {_fdceg =_fbde .InsideH ;};if _fdceg !=nil {_ebe .LnT =_fdceg .Ln ;};};if _ebe .LnB ==nil {var _bbgf *_b .CT_ThemeableLineStyle ;if _dgff {_bbgf =_fbde .Bottom ;}else {_bbgf =_fbde .InsideH ;};if _bbgf !=nil {_ebe .LnB =_bbgf .Ln ;};};};return _ebe ;};func (_gaf *convertContext )makeSlide (){_ea :=_gaf ._effd .X ().CSld ;if _ea ==nil {return ;};_eab :=&background {};if _fcd :=_ea .Bg ;_fcd !=nil {if _bef :=_fcd .BgPr ;_bef !=nil {if _bef .NoFill ==nil {if _afe :=_bef .SolidFill ;_afe !=nil {_dfd ,_gebe :=_gaf .getColorFromSolidFill (_afe );if _dfd !=nil {_eab ._bafg =_dfd ;_eab ._afef =_gebe ;};}else if _efb :=_bef .BlipFill ;_efb !=nil {_eab ._ccgf =_efb ;};};};};_gaf ._cacg =_eab ;if _gfb :=_ea .SpTree ;_gfb !=nil {for _ ,_dag :=range _gfb .Choice {if _dag !=nil {for _ ,_efa :=range _dag .Sp {if _efa !=nil {_eb :=_gaf .getShapes (_efa );_gaf ._cfcb =append (_gaf ._cfcb ,_eb ...);};};for _ ,_dac :=range _dag .GraphicFrame {if _dac !=nil {var _bbf ,_ffa ,_eabg ,_eba float64 ;if _eabf :=_dac .Xfrm ;_eabf !=nil {_bbf ,_ffa ,_eabg ,_eba =_gef .GetDataFromXfrm (_eabf );};if _egf :=_dac .Graphic ;_egf !=nil {if _dfe :=_egf .GraphicData ;_dfe !=nil {for _ ,_feg :=range _dfe .Any {if _gb ,_egfg :=_feg .(*_de .Chart );_egfg {_gbc ,_ecf :=_gaf .makePdfBlockFromChart (_gb ,_eabg ,_eba );if _ecf !=nil {_db .Log .Debug ("C\u0061\u006e\u006e\u006ft \u0072e\u0061\u0064\u0020\u0062\u006co\u0063\u006b\u003a\u0020\u0025\u0073",_ecf );};if _gbc !=nil {_gbc .SetPos (_bbf ,_ffa );_gaf ._cfcb =append (_gaf ._cfcb ,_gbc );};}else if _eae ,_eaf :=_feg .(*_b .Tbl );_eaf {_adfc :=_gaf .makePdfBlockFromTable (_eae ,_eabg );if _adfc !=nil {_aa :=_eda .NewBlock (_eabg ,_eba );_aa .SetPos (_bbf ,_ffa );_aa .Draw (_adfc );_gaf ._cfcb =append (_gaf ._cfcb ,_aa );};};};};};};};for _ ,_gc :=range _dag .CxnSp {if _gc !=nil {_ca :=_gaf .getConnectors (_gc );_gaf ._cfcb =append (_gaf ._cfcb ,_ca ...);};};for _ ,_dd :=range _dag .Pic {if _dd !=nil {var _ee ,_aff ,_dfc ,_ggb float64 ;if _aab :=_dd .SpPr ;_aab !=nil {if _fca :=_aab .Xfrm ;_fca !=nil {_ee ,_aff ,_dfc ,_ggb =_gef .GetDataFromXfrm (_fca );};};if _bce :=_dd .BlipFill ;_bce !=nil {_daca :=_gaf .getShapeFromBlipFill (_bce ,_ee ,_aff ,_dfc ,_ggb );_gaf ._cfcb =append (_gaf ._cfcb ,_daca );};};};};};};};type symbol struct{_bgac string ;_gggff float64 ;_eedf float64 ;_cdbc float64 ;_eecb float64 ;_dadf float64 ;_eaeg *_eda .TextStyle ;_dbdd string ;_aag bool ;_cfgc bool ;_dadde bool ;};func (_ddg *textboxContext )addCurrentWordToParagraph (){if _ddg ._dfgc &&_ddg ._agea ._bbdg +_ddg ._bgcf ._dcc > _ddg ._agea ._agag {_ddg .newLine ();};if !_ddg ._bgcf ._gdag ||len (_ddg ._agea ._bacf )> 0{_ddg ._bgcf ._fbee =_ddg ._agea ._bbdg ;_ddg ._agea ._bacf =append (_ddg ._agea ._bacf ,_ddg ._bgcf );_ddg ._agea ._bbdg +=_ddg ._bgcf ._dcc ;for _ ,_bccg :=range _ddg ._bgcf ._fcba {_ddg .adjustHeights (_bccg ._eedf );};};};func _ccbf (_gga *_b .CT_AdjPoint2D )(float64 ,float64 ){var _cbdc ,_cbf float64 ;_ddebf ,_efgb :=_gga .XAttr ,_gga .YAttr ;if _ggdf :=_ddebf .ST_Coordinate ;_ggdf !=nil {_cbdc =_c .FromEMU (_gef .FromSTCoordinate (*_ggdf ));};if _fdcb :=_efgb .ST_Coordinate ;_fdcb !=nil {_cbf =_c .FromEMU (_gef .FromSTCoordinate (*_fdcb ));};return _cbdc ,_cbf ;};func (_cgdb *textboxContext )addTextRun (_ffacf *_b .EG_TextRun ,_afbf *_b .CT_TextCharacterProperties ,_fbgc _eda .Color ,_dabf *prefixData ){if _baff :=_ffacf .Br ;_baff !=nil {_cgdb .addCurrentWordToParagraph ();_cgdb .newLine ();_cgdb .newWord ();}else if _cdgb :=_ffacf .R ;_cdgb !=nil {var _ecc _eda .Color ;if _cdgb .RPr .SolidFill !=nil {_ecc ,_ =_cgdb ._fgc .getColorFromSolidFill (_cdgb .RPr .SolidFill );}else if _fbgc !=nil {_ecc =_fbgc ;}else if _afbf .SolidFill !=nil {_ecc ,_ =_cgdb ._fgc .getColorFromSolidFill (_afbf .SolidFill );}else {_ecc =_eda .ColorBlack ;};_dgc :=_abeg (_cdgb .RPr ,_afbf );_bfge ,_dgad ,_fcbb ,_ggdd :=_cgdb ._fgc .makeStyleFromRPr (_dgc );_bfge .Color =_ecc ;if _dabf !=nil {_cgdb .addPrefix (_dabf ,_bfge );};_dcdd :=_cfca (_cdgb .T );for _ ,_geabe :=range _dcdd {_geabe ._eaeg =_bfge ;_geabe ._aag =_dgad ;_geabe ._cfgc =_fcbb ;_geabe ._dadde =_ggdd ;if _dgc .CapAttr ==_b .ST_TextCapsTypeAll {_geabe ._bgac =_d .ToUpper (_geabe ._bgac );};_cgdb .addTextSymbol (_geabe );};};};func (_eead *textboxContext )alignVertically (_gbff _b .ST_TextAnchoringType ){_eead .alignParagraphsVertically (_gbff );_eead .alignSymbolsVertically ();};