//
// Copyright 2020 FoxyUtils ehf. All rights reserved.
//
// This is a commercial product and requires a license to operate.
// A trial license can be obtained at https://unidoc.io
//
// DO NOT EDIT: generated by unitwist Go source code obfuscator.
//
// Use of this source code is governed by the UniDoc End User License Agreement
// terms that can be accessed at https://unidoc.io/eula/

package convert ;import (_e "bytes";_f "errors";_gg "github.com/unidoc/unioffice/common/logger";_af "github.com/unidoc/unioffice/common/tempstorage";_gb "github.com/unidoc/unioffice/internal/convertutils";_da "github.com/unidoc/unioffice/measurement";_d "github.com/unidoc/unioffice/presentation";_ge "github.com/unidoc/unioffice/schema/soo/dml";_aba "github.com/unidoc/unioffice/schema/soo/dml/chart";_ab "github.com/unidoc/unioffice/schema/soo/pml";_dd "github.com/unidoc/unipdf/v3/contentstream/draw";_gf "github.com/unidoc/unipdf/v3/creator";_dg "github.com/unidoc/unipdf/v3/model";_df "github.com/unidoc/unipdf/v3/render";_a "image";_b "image/color";_c "image/draw";_ff "strconv";_ae "strings";);type textboxContext struct{_ddeg *convertContext ;_aac float64 ;_gea float64 ;_bdfe *_gf .Creator ;_efce float64 ;_fgc []*paragraph ;_fgd *paragraph ;_eda *line ;_aeb *word ;_ageg bool ;};

// FontStyle represents a kind of font styling. It can be FontStyle_Regular, FontStyle_Bold, FontStyle_Italic and FontStyle_BoldItalic.
type FontStyle =_gb .FontStyle ;func (_adg *textboxContext )addCurrentParagraph (){_adg ._efce =_adg ._fgd ._bdb +_adg ._fgd ._cbcd +_adg ._fgd ._caeb +_adg ._fgd ._baf ;_adg ._fgc =append (_adg ._fgc ,_adg ._fgd );_adg .alignParagraph ();};type symbolStyle struct{_dbd *string ;_fdba *float64 ;_ebdce *string ;_aade *bool ;_bdfee *bool ;_cbcb *bool ;_bbe *bool ;_caebg *bool ;};var _bgb =_ddff (1.9);func (_afeca *convertContext )renderCurrentStateToGoImage ()(_a .Image ,error ){_bfbf :=_gb .MakeTempCreator (_afeca ._ffca ,_afeca ._dcce );_bfbf .NewPage ();for _ ,_decg :=range _afeca ._gec {if _decg !=nil {_bfbf .MoveTo (0,0);_bfbf .Draw (_decg );};};_dcbg ,_bcceg :=_gb .GetPageFromCreator (_bfbf );if _bcceg !=nil {return nil ,_bcceg ;};return _df .NewImageDevice ().Render (_dcbg );};func _dbag (_fdcg ,_bfa *_ge .CT_TextBody )(*_ge .CT_TextBodyProperties ,*_ge .CT_TextListStyle ){if _fdcg ==nil &&_bfa ==nil {return nil ,nil ;};if _fdcg ==nil {return _bfa .BodyPr ,_bfa .LstStyle ;};if _bfa ==nil {return _fdcg .BodyPr ,_fdcg .LstStyle ;};_face ,_bfgcf :=_fdcg .BodyPr ,_fdcg .LstStyle ;_agee ,_dbcb :=_bfa .BodyPr ,_bfa .LstStyle ;_gfdf :=_cebfc (_face ,_agee );_fcga :=_caab (_bfgcf ,_dbcb );return _gfdf ,_fcga ;};func (_bdc *convertContext )getBorderStyle (_fgb *_ge .CT_LineProperties )(_gf .CellBorderStyle ,*_gf .Color ,float64 ){if _fgb ==nil ||_fgb .NoFill !=nil {return _gf .CellBorderStyleNone ,nil ,0;};var _fae _gf .Color ;if _dgbca :=_fgb .SolidFill ;_dgbca !=nil {_fae ,_ =_bdc .getColorFromSolidFill (_dgbca );};_ceee :=0.0;if _adf :=_fgb .WAttr ;_adf !=nil {_ceee =_da .FromEMU (int64 (*_adf ));};return _gf .CellBorderStyleSingle ,&_fae ,_ceee ;};func (_cfbf *line )moveRight (_bcca float64 ){for _ ,_ddbb :=range _cfbf ._defef {_ddbb ._cggd +=_bcca ;};};func _abgd (_bgaf ,_ega *_ge .CT_TableStyleCellStyle )*_ge .CT_TableStyleCellStyle {_bgeee :=_ge .NewCT_TableStyleCellStyle ();if _bgaf !=nil {*_bgeee =*_bgaf ;};if _ega ==nil {return _bgeee ;};if _bgeee .TcBdr ==nil {_bgeee .TcBdr =_ega .TcBdr ;};if _bgeee .Fill ==nil {_bgeee .Fill =_ega .Fill ;};if _bgeee .FillRef ==nil {_bgeee .FillRef =_ega .FillRef ;};return _bgeee ;};func _caab (_fgcc ,_facb *_ge .CT_TextListStyle )*_ge .CT_TextListStyle {_fcd :=_ge .NewCT_TextListStyle ();if _fgcc !=nil {*_fcd =*_fgcc ;};if _facb ==nil {return _fcd ;};_fcd .DefPPr =_ggef (_fcd .DefPPr ,_facb .DefPPr );_fcd .Lvl1pPr =_ggef (_fcd .Lvl1pPr ,_facb .Lvl1pPr );_fcd .Lvl2pPr =_ggef (_fcd .Lvl2pPr ,_facb .Lvl2pPr );_fcd .Lvl3pPr =_ggef (_fcd .Lvl3pPr ,_facb .Lvl3pPr );_fcd .Lvl4pPr =_ggef (_fcd .Lvl4pPr ,_facb .Lvl4pPr );_fcd .Lvl5pPr =_ggef (_fcd .Lvl5pPr ,_facb .Lvl5pPr );_fcd .Lvl6pPr =_ggef (_fcd .Lvl6pPr ,_facb .Lvl6pPr );_fcd .Lvl7pPr =_ggef (_fcd .Lvl7pPr ,_facb .Lvl7pPr );_fcd .Lvl8pPr =_ggef (_fcd .Lvl8pPr ,_facb .Lvl8pPr );_fcd .Lvl9pPr =_ggef (_fcd .Lvl9pPr ,_facb .Lvl9pPr );return _fcd ;};func (_ag *convertContext )makePdfBlockFromChart (_gc *_aba .Chart ,_bg ,_aa float64 )(*_gf .Block ,error ){_ddc :=_gc .CT_RelId .IdAttr ;_fb :=_ag ._fbf .GetChartSpaceByRelId (_ddc );if _fb ==nil {return nil ,_f .New ("\u004e\u006f\u0020\u0063\u0068\u0061\u0072\u0074\u0073\u0070\u0061\u0063\u0065");};var _eb *_ge .Theme ;_bc :=_ag ._bbda .Themes ();if len (_bc )> 0{_eb =_bc [0];};return _gb .MakeBlockFromChartSpace (_fb ,_bg ,_aa ,_eb );};type prefixData struct{_ccaac string ;_fgba bool ;_agac float64 ;_fgee float64 ;};func (_fdf *convertContext )makePdfDivisionFromTxBody (_bfd *_ge .CT_TextBody ,_acc ,_bgbab float64 ,_ceb *_ge .CT_TableStyleTextStyle )*_gf .Division {_gafb :=_fdf ._dbc .NewDivision ();_cbgg :=_fdf ._ffa ;_cbf :=_ge .ST_TextAnchoringTypeT ;if _dff :=_bfd .BodyPr ;_dff !=nil {if _dag :=_dff .AnchorAttr ;_dag !=_ge .ST_TextAnchoringTypeUnset {_cbf =_dff .AnchorAttr ;};};if _gdc :=_bfd .LstStyle ;_gdc !=nil {var _babg *_ge .CT_TextParagraphProperties ;if _gdc .Lvl1pPr !=nil {_babg =_gdc .Lvl1pPr ;}else {_babg =_fdf ._dgg [0];};_cbgg =_ggef (_babg ,_ggef (_gdc .DefPPr ,_cbgg ));};for _ ,_aga :=range _bfd .P {if _aga !=nil {_ddde :=_fdf ._dbc .NewStyledParagraph ();_ggfe :=_ggef (_aga .PPr ,_cbgg );_efe :=_aff (_aga .EndParaRPr ,_ggfe .DefRPr );if len (_aga .EG_TextRun )==0{_ddde .Append ("\u000a");_gafb .Add (_ddde );continue ;};for _ ,_ged :=range _aga .EG_TextRun {if _gbb :=_ged .Br ;_gbb !=nil {_ddde .Append ("\u000a");}else if _ecec :=_ged .R ;_ecec !=nil {_cgdc :=_ffad (_ecec .RPr ,_ceb );_cgdc =_aff (_cgdc ,_efe );var _def _gf .Color ;if _cgdc .SolidFill !=nil {_def ,_ =_fdf .getColorFromSolidFill (_cgdc .SolidFill );}else {_def =_gf .ColorBlack ;};_bfg ,_aab ,_cbeb ,_ :=_fdf .makeStyleFromRPr (_cgdc );_bfg .Color =_def ;if _aab {_bfg .TextRise =0.5;}else if _cbeb {_bfg .TextRise =-0.5;};_ggfd :=_ecec .T ;if _cgdc .CapAttr ==_ge .ST_TextCapsTypeAll {for _ ,_cdg :=range _ggfd {_cdg =[]rune (_ae .ToUpper (string (_cdg )))[0];};};_egc :=_ddde .Append (_ggfd );_egc .Style =*_bfg ;};};_ =_cbf ;_gafb .Add (_ddde );};};return _gafb ;};func (_afc *convertContext )getShapesFromSpPr (_gbag *_ge .CT_ShapeProperties ,_dgbc *_ge .CT_ShapeStyle ,_edd bool )([]_gf .Drawable ,float64 ,float64 ,float64 ,float64 ,_gf .Color ,bool ){_gdb :=[]_gf .Drawable {};var _cbe ,_bgbac ,_ccbf ,_fcf ,_ffb float64 ;var _ece ,_gcag ,_cacb ,_edee _gf .Color ;var _fdcc *_ge .CT_BlipFillProperties ;_bbb ,_add :=1.0,1.0;if _dgbc !=nil {_ece ,_gcag ,_edee =_afc .getStyleColors (_dgbc );};if _beg :=_gbag .Ln ;_beg !=nil {if _beg .NoFill !=nil {_cacb ,_ffb =nil ,0;}else {_cacb ,_ffb ,_bbb =_afc .getInfoFromLn (_beg );if _cacb ==nil {_cacb =_edee ;};};};if _gbag .NoFill !=nil {_gcag ,_add =nil ,0;}else if _edd {_gcag =_afc ._fdbe ._cfdd ;_add =_afc ._fdbe ._aggc ;_fdcc =_afc ._fdbe ._bdg ;}else if _gbae :=_gbag .SolidFill ;_gbae !=nil {_gcag ,_add =_afc .getColorFromSolidFill (_gbae );};var _fgaa bool ;if _edec :=_gbag .Xfrm ;_edec !=nil {_cbe ,_bgbac ,_ccbf ,_fcf =_gb .GetDataFromXfrm (_edec );_fgaa =true ;};if _dcf :=_gbag .CustGeom ;_dcf !=nil {_bd :=[]_dd .Point {};_efg ,_cagg :=1.0,1.0;if _gdd :=_dcf .PathLst ;_gdd !=nil {for _ ,_gafa :=range _gdd .Path {if _gafa !=nil {if _aee :=_gafa .WAttr ;_aee !=nil {_efg =_ccbf /_da .FromEMU (*_aee );};if _gae :=_gafa .HAttr ;_gae !=nil {_cagg =_fcf /_da .FromEMU (*_gae );};for _ ,_ggf :=range _gafa .Close {if _ggf !=nil {};};for _ ,_dgab :=range _gafa .MoveTo {if _dgab !=nil &&_dgab .Pt !=nil {_dcfa ,_bab :=_ebbb (_dgab .Pt );_bd =append (_bd ,_dd .Point {X :_dcfa *_efg +_cbe ,Y :_bab *_cagg +_bgbac });};};for _ ,_fda :=range _gafa .LnTo {if _fda !=nil &&_fda .Pt !=nil {_eaf ,_bcc :=_ebbb (_fda .Pt );_bd =append (_bd ,_dd .Point {X :_eaf *_efg +_cbe ,Y :_bcc *_cagg +_bgbac });};};_edb :=_afc ._dbc .NewPolygon ([][]_dd .Point {_bd });_edb .SetFillColor (_gcag );_edb .SetFillOpacity (_add );_edb .SetBorderWidth (_ffb );if _cacb !=nil {_edb .SetBorderColor (_cacb );_edb .SetBorderOpacity (_bbb );};_gdb =append (_gdb ,_edb );};};};};if _bag :=_gbag .PrstGeom ;_bag !=nil {switch _bag .PrstAttr {case _ge .ST_ShapeTypeRect :if _fdcc !=nil {_bcbc :=_afc .getShapeFromBlipFill (_fdcc ,_cbe ,_bgbac ,_ccbf ,_fcf );_gdb =append (_gdb ,_bcbc );}else {_eee :=_afc ._dbc .NewRectangle (_cbe ,_bgbac ,_ccbf ,_fcf );_eee .SetFillColor (_gcag );_eee .SetFillOpacity (_add );_eee .SetBorderWidth (_ffb );if _cacb !=nil {_eee .SetBorderColor (_cacb );_eee .SetBorderOpacity (_bbb );};_gdb =append (_gdb ,_eee );};case _ge .ST_ShapeTypeLine :_cbg :=_afc ._dbc .NewLine (_cbe ,_bgbac ,_cbe +_ccbf ,_bgbac +_fcf );_cbg .SetLineWidth (_ffb );if _cacb !=nil {_cbg .SetColor (_cacb );};_gdb =append (_gdb ,_cbg );};};return _gdb ,_cbe ,_bgbac ,_ccbf ,_fcf ,_ece ,_fgaa ;};const (FontStyle_Regular FontStyle =0;FontStyle_Bold FontStyle =1;FontStyle_Italic FontStyle =2;FontStyle_BoldItalic FontStyle =3;);func (_dab *convertContext )makePdfBlockFromTable (_fgec *_ge .Tbl ,_geda float64 )*_gf .Table {_ecf :=_fgec .TblGrid ;if _ecf ==nil {return nil ;};_fccab :=len (_ecf .GridCol );if _fccab ==0{return nil ;};_bda :=[]float64 {};_dgfg :=0.0;for _ ,_afd :=range _ecf .GridCol {_cab :=_da .FromEMU (_gb .FromSTCoordinate (_afd .WAttr ));_bda =append (_bda ,_cab );_dgfg +=_cab ;};_dffde :=[]float64 {};for _ccce :=0;_ccce < _fccab ;_ccce ++{_dffde =append (_dffde ,_bda [_ccce ]/_dgfg );};_abb :=_dab ._dbc .NewTable (_fccab );_abb .SetColumnWidths (_dffde ...);_defc :=_fgec .TblPr ;var _dcb *_ge .CT_TableStyle ;if _ebgd :=_defc .Choice ;_ebgd !=nil {if _ebgd .TableStyle !=nil {_dcb =_ebgd .TableStyle ;}else if _ebgd .TableStyleId !=nil {_dcb =_dab ._bbda .GetTableStyleById (*_ebgd .TableStyleId );};};_cccea :=_ge .NewCT_TablePartStyle ();_cccea .TcStyle =_ge .NewCT_TableStyleCellStyle ();_cccea .TcTxStyle =_ge .NewCT_TableStyleTextStyle ();if _dcb !=nil {if _dcb .WholeTbl !=nil {*_cccea =*_dcb .WholeTbl ;};if _dcb .TblBg !=nil {if _cccea .TcStyle .Fill ==nil {_cccea .TcStyle .Fill =_dcb .TblBg .Fill ;};};};if _cccea .TcStyle .Fill ==nil {_cccea .TcStyle .Fill =_ge .NewCT_FillProperties ();_cccea .TcStyle .Fill .NoFill =_defc .NoFill ;_cccea .TcStyle .Fill .SolidFill =_defc .SolidFill ;};_deg :=len (_fgec .Tr );for _fbb ,_eeeg :=range _fgec .Tr {_cgg :=_fbb ==0;_bdf :=_fbb ==_deg -1;_agfdc :=_fbb %2==0;_eebf :=len (_eeeg .Tc );var _eafg *_ge .CT_TablePartStyle ;if _cgg {_eafg =_dcb .FirstRow ;}else if _agfdc {_eafg =_dcb .Band2H ;}else {_eafg =_dcb .Band1H ;};var _abbf float64 ;for _cfg ,_cebe :=range _eeeg .Tc {_cea :=_cfg ==0;_badbc :=_cfg ==_eebf -1;_efgb :=_cfg %2==0;var _cacg *_ge .CT_TablePartStyle ;if _cea {_cacg =_dcb .FirstCol ;}else if _efgb {_cacg =_dcb .Band2V ;}else {_cacg =_dcb .Band1V ;};_acfd :=_dggc (_dggc (_cacg ,_eafg ),_cccea );_fadf :=_dab .addCellToTable (_abb ,_cebe ,_acfd ,_geda *_dffde [_cfg ],_cgg ,_bdf ,_cea ,_badbc );if _fadf > _abbf {_abbf =_fadf ;};};_afg :=_da .FromEMU (_gb .FromSTCoordinate (_eeeg .HAttr ));if _afg < _abbf {_afg =_abbf ;};if _afg < _ddff (4){_afg =_ddff (4);};_abb .SetRowHeight (_abb .CurRow (),_afg );};return _abb ;};var _dcee =[]romanMatch {romanMatch {1000,"\u006d"},romanMatch {900,"\u0063\u006d"},romanMatch {500,"\u0064"},romanMatch {400,"\u0063\u0064"},romanMatch {100,"\u0063"},romanMatch {90,"\u0078\u0063"},romanMatch {50,"\u006c"},romanMatch {40,"\u0078\u006c"},romanMatch {10,"\u0078"},romanMatch {9,"\u0069\u0078"},romanMatch {5,"\u0076"},romanMatch {4,"\u0069\u0076"},romanMatch {1,"\u0069"}};func (_bba *convertContext )tileImage (_cb *_gf .Image ,_fge *_ge .CT_TileInfoProperties ,_dgf ,_daeg float64 )*_gf .Image {_ee ,_gce :=1.0,1.0;if _faa :=_fge .SxAttr ;_faa !=nil {_ee =_gb .FromSTPercentage (_faa );};if _aag :=_fge .SyAttr ;_aag !=nil {_gce =_gb .FromSTPercentage (_aag );};_dece :=_gb .MakeTempCreator (_dgf ,_daeg );_cb .Scale (_ee ,_gce );_dfgd ,_fdc :=_cb .Width (),_cb .Height ();var _efdf ,_ddd float64 ;if _ggaa :=_fge .TxAttr ;_ggaa !=nil {_efdf =_da .FromEMU (_gb .FromSTCoordinate (*_ggaa ));};if _bcb :=_fge .TyAttr ;_bcb !=nil {_ddd =_da .FromEMU (_gb .FromSTCoordinate (*_bcb ));};if _efdf > 0{_efdf -=_dfgd ;};if _ddd > 0{_ddd -=_fdc ;};_aed :=_bba ._ffca /_dfgd +1;_gcbd :=_bba ._dcce /_fdc +1;for _bfb :=0.0;_bfb <=_aed ;_bfb ++{_cag :=_bfb *_dfgd ;for _edc :=0.0;_edc <=_gcbd ;_edc ++{_adb :=_edc *_fdc ;_cb .SetPos (_cag +_efdf ,_adb +_ddd );_dece .Draw (_cb );};};_bef ,_dgd :=_gb .GetPageFromCreator (_dece );if _dgd !=nil {_gg .Log .Debug ("\u0043\u0061\u006e\u006e\u006f\u0074 \u0067\u0065\u0074\u0020\u0069\u006d\u0061\u0067\u0065\u0020\u0066\u0072\u006fm\u0020\u0063\u0072\u0065\u0061\u0074\u006fr\u003a\u0020\u0025\u0073",_dgd );return nil ;};_bbd ,_dgd :=_df .NewImageDevice ().Render (_bef );if _dgd !=nil {_gg .Log .Debug ("\u0043\u0061\u006eno\u0074\u0020\u0072\u0065\u006e\u0064\u0065\u0072\u0020\u0069\u006d\u0061\u0067\u0065\u003a\u0020\u0025\u0073",_dgd );return nil ;};_fce ,_dgd :=_bba ._dbc .NewImageFromGoImage (_bbd );if _dgd !=nil {_gg .Log .Debug ("\u0043\u0061nn\u006f\u0074\u0020c\u0072\u0065\u0061\u0074e i\u006dag\u0065\u0020\u0066\u0072\u006f\u006d\u0020Go\u0049\u006d\u0061\u0067\u0065\u003a\u0020%\u0073",_dgd );return nil ;};return _fce ;};func (_afea *convertContext )applyBlipEffectsOnImg (_fcdc *_gf .Image ,_efae ,_eafb float64 ,_aaaf []*_ge .CT_BlipChoice )*_gf .Image {if len (_aaaf )==0{return _fcdc ;};_fcdc .SetPos (_efae ,_eafb );_bafb ,_fcge :=_afea .renderPageWithDrawableToGoImage (_fcdc );if _fcge !=nil {_gg .Log .Debug ("\u0045\u0072\u0072\u006f\u0072\u0020\u0072\u0065\u006e\u0064\u0065\u0072\u0020a\u006e\u0020\u0069\u006d\u0061\u0067e\u0020\u0074\u006f\u0020\u0061\u0020\u0047\u006f\u0020\u0069\u006d\u0061\u0067e\u003a\u0020\u0025\u0073",_fcge );return _fcdc ;};_ddge ,_fcge :=_afea .renderCurrentStateToGoImage ();if _fcge !=nil {_gg .Log .Debug ("\u0045\u0072\u0072\u006f\u0072\u0020\u0072\u0065n\u0064\u0065\u0072 t\u0068\u0065\u0020\u0063\u0075\u0072r\u0065\u006e\u0074\u0020\u0073\u0074\u0061\u0074\u0065\u0020\u0074\u006f\u0020\u0061\u0020G\u006f\u0020\u0069\u006d\u0061\u0067\u0065\u003a \u0025\u0073",_fcge );return _fcdc ;};_cbda :=_bafb .Bounds ();_dgfc :=_a .NewRGBA (_cbda );_abbd ,_fgdd :=_fcdc .Width (),_fcdc .Height ();for _ ,_bgc :=range _aaaf {for _ ,_bcda :=range _bgc .AlphaModFix {if _eeege :=_bcda .AmtAttr ;_eeege !=nil {if _ccbc :=_eeege .ST_PositivePercentageDecimal ;_ccbc !=nil {_beee :=uint8 (255*(*_ccbc )/100000);_bfeb :=_a .NewUniform (_b .Alpha {_beee });_c .Draw (_dgfc ,_cbda ,_ddge ,_a .Point {0,0},_c .Src );_c .DrawMask (_dgfc ,_cbda ,_bafb ,_a .Point {0,0},_bfeb ,_a .Point {0,0},_c .Over );};};};};_dfac :=_a .Rect (int (_efae ),int (_eafb ),int (_efae +_abbd )+1,int (_eafb +_fgdd )+1);_cdd :=_gb .CropImageByRect (_dgfc ,_dfac );_adgcc ,_fcge :=_afea ._dbc .NewImageFromGoImage (_cdd );if _fcge !=nil {_gg .Log .Debug ("\u0045\u0072\u0072\u006f\u0072\u0020\u0061\u006e\u0020\u0069\u006d\u0061\u0067\u0065\u0020t\u006f \u0061\u0020\u0047\u006f\u0020\u0069\u006d\u0061\u0067\u0065\u003a\u0020\u0025\u0073",_fcge );return _fcdc ;};return _adgcc ;};func _ddff (_ggeb float64 )float64 {return _ggeb *_da .Millimeter };func (_cdgg *convertContext )getInfoFromLn (_bcbe *_ge .CT_LineProperties )(_gf .Color ,float64 ,float64 ){if _bcbe ==nil ||_bcbe .NoFill !=nil {return nil ,0,0;};var _eeeb float64 ;_fgcd ,_dcg :=_cdgg .getColorFromSolidFill (_bcbe .SolidFill );if _geca :=_bcbe .WAttr ;_geca !=nil {_eeeb =_da .FromEMU (int64 (*_geca ));}else {_eeeb =1;};return _fgcd ,_eeeb ,_dcg ;};func (_edcd *textboxContext )drawParagraphs (){_edcd ._bdfe .NewPage ();for _ ,_afa :=range _edcd ._fgc {for _ ,_ecg :=range _afa ._ebba {for _ ,_fbcff :=range _ecg ._defef {for _ ,_cbec :=range _fbcff ._dea {_dbbe :=_edcd ._bdfe .NewStyledParagraph ();if _cbec ._gbaed {_cbec ._aeegd =0;}else if _cbec ._gaea {_cbec ._aeegd =1.2*_ecg ._gee -_cbec ._egbc ;};_aecf :=_fbcff ._cggd +_cbec ._dbf ;_ebeb :=_afa ._bdb +_ecg ._gbf +_cbec ._aeegd ;_dbbe .SetPos (_aecf ,_ebeb );_edac :=_dbbe .Append (_cbec ._abbe );if _cbec ._gcbe !=nil {_edac .Style =*_cbec ._gcbe ;};_edcd ._bdfe .Draw (_dbbe );if _cbec ._cabc {_cafg :=_ebeb +_cbec ._egbc +2;_gb .DrawLine (_edcd ._bdfe ,_aecf ,_cafg ,_aecf +_cbec ._efdab ,_cafg ,1,_cbec ._gcbe .Color );};};};};};};func (_bcgc *textboxContext )alignParagraphsVertically (_eede _ge .ST_TextAnchoringType ){if _eede ==_ge .ST_TextAnchoringTypeT {return ;};_fdbd :=0.0;for _ ,_gccc :=range _bcgc ._fgc {_fdbd +=_gccc ._cbcd +_gccc ._caeb +_gccc ._baf ;};var _ebgf float64 ;switch _eede {case _ge .ST_TextAnchoringTypeCtr :_ebgf =(_bcgc ._gea -_fdbd )/2;case _ge .ST_TextAnchoringTypeB :_ebgf =_bcgc ._gea -_fdbd ;};for _ ,_fca :=range _bcgc ._fgc {_fca ._bdb +=_ebgf ;};};func (_dfgf *convertContext )makePdfImageFromBlipFill (_aeee *_ge .CT_BlipFillProperties )(*_gf .Image ,[]*_ge .CT_BlipChoice ,error ){if _cgag :=_aeee .Blip ;_cgag !=nil {if _fab :=_cgag .EmbedAttr ;_fab !=nil {_ffaf ,_cda :=_dfgf ._fbf .GetImageByRelID (*_fab );if _cda {_fef ,_deee :=_af .Open (_ffaf .Path ());if _deee !=nil {_gg .Log .Debug ("\u0046\u0069\u006c\u0065 o\u0070\u0065\u006e\u0020\u0065\u0072\u0072\u006f\u0072\u003a\u0020\u0025\u0073",_deee );return nil ,nil ,_deee ;};defer _fef .Close ();_cfa ,_ ,_deee :=_a .Decode (_fef );if _deee !=nil {_gg .Log .Debug ("\u0044\u0065\u0063\u006fde\u0020\u0069\u006d\u0061\u0067\u0065\u0020\u0065\u0072\u0072\u006f\u0072\u003a\u0020%\u0073",_deee );return nil ,nil ,_deee ;};if _bdca :=_aeee .SrcRect ;_bdca !=nil {_baff :=_cfa .Bounds ().Size ();_bdeb :=_baff .X ;_bcae :=_baff .Y ;var _fbg ,_ecb ,_cbb ,_aage int ;var _ffec bool ;if _fddd :=_bdca .LAttr ;_fddd !=nil {_fbg =int (float64 (_bdeb )*_gb .FromSTPercentage (_fddd ));_ffec =true ;}else {_fbg =0;};if _ffea :=_bdca .TAttr ;_ffea !=nil {_cbb =int (float64 (_bcae )*_gb .FromSTPercentage (_ffea ));_ffec =true ;}else {_cbb =0;};if _daed :=_bdca .RAttr ;_daed !=nil {_ecb =int (float64 (_bdeb )*(1-_gb .FromSTPercentage (_daed )));_ffec =true ;}else {_ecb =_bdeb ;};if _gbbc :=_bdca .BAttr ;_gbbc !=nil {_aage =int (float64 (_bcae )*(1-_gb .FromSTPercentage (_gbbc )));_ffec =true ;}else {_aage =_bcae ;};if _ffec {_cfa =_gb .CropImageByRect (_cfa ,_a .Rect (_fbg ,_cbb ,_ecb +1,_aage +1));};};_fde ,_deee :=_dfgf ._dbc .NewImageFromGoImage (_cfa );if _deee !=nil {_gg .Log .Debug ("\u0043\u0061\u006e\u006e\u006ft\u0020\u0063\u0072\u0065\u0061\u0074\u0065\u0020\u0050\u0044\u0046\u0020\u0069m\u0061\u0067\u0065\u0020\u0066\u0072\u006f\u006d\u0020\u0047\u006f\u0020\u0069\u006d\u0061\u0067\u0065\u003a\u0020\u0025\u0073",_deee );return nil ,nil ,_deee ;};return _fde ,_cgag .Choice ,nil ;};};};return nil ,nil ,nil ;};func (_aadb *convertContext )getConnectors (_bebb *_ab .CT_Connector )[]_gf .Drawable {_ccg ,_ ,_ ,_ ,_ ,_ ,_ :=_aadb .getShapesFromSpPr (_bebb .SpPr ,_bebb .Style ,false );return _ccg ;};type convertContext struct{_dbc *_gf .Creator ;_dddb *_gb .Rectangle ;_bbda *_d .Presentation ;_fbf *_d .Slide ;_abdf *_ab .SldMaster ;_bebbe *_ab .SldLayout ;_dcce float64 ;_ffca float64 ;_gec []_gf .Drawable ;_fdbe *background ;_ffa *_ge .CT_TextParagraphProperties ;_aaee *_ge .CT_TextCharacterProperties ;_bbdc *_ge .CT_TextParagraphProperties ;_cfbb *_ge .CT_TextCharacterProperties ;_edega *_ge .CT_TextParagraphProperties ;_fac *_ge .CT_TextCharacterProperties ;_dgg []*_ge .CT_TextParagraphProperties ;_fafa []*_ge .CT_TextParagraphProperties ;_defe []*_ge .CT_TextParagraphProperties ;_cdec *_ge .Theme ;_efdb *_ge .CT_ColorMappingOverride ;};func (_edef *textboxContext )addCurrentWordToParagraph (){if _edef ._ageg &&_edef ._eda ._cgc +_edef ._aeb ._cfga > _edef ._eda ._gead {_edef .newLine ();};if !_edef ._aeb ._aeded ||len (_edef ._eda ._defef )> 0{_edef ._aeb ._cggd =_edef ._eda ._cgc ;_edef ._eda ._defef =append (_edef ._eda ._defef ,_edef ._aeb );_edef ._eda ._cgc +=_edef ._aeb ._cfga ;for _ ,_cdcb :=range _edef ._aeb ._dea {_edef .adjustHeights (_cdcb ._bceg );};};};func (_ggd *textboxContext )newParagraph (){_dabb :=&paragraph {};_dabb ._bdb =_ggd ._efce ;_ggd ._fgd =_dabb ;};func _dbae (_deed *_ge .CT_TableCellProperties ,_aacd *_ge .CT_TableStyleCellStyle ,_egbbc ,_dfec ,_gfaad ,_eecg bool )*_ge .CT_TableCellProperties {_fbdg :=_ge .NewCT_TableCellProperties ();if _deed !=nil {*_fbdg =*_deed ;};if _aacd ==nil {return _fbdg ;};if _gabgf :=_aacd .FillRef ;_gabgf !=nil {_gfcd :=_ge .NewCT_SolidColorFillProperties ();_gfcd .ScrgbClr =_gabgf .ScrgbClr ;_gfcd .SrgbClr =_gabgf .SrgbClr ;_gfcd .HslClr =_gabgf .HslClr ;_gfcd .SysClr =_gabgf .SysClr ;_gfcd .SchemeClr =_gabgf .SchemeClr ;_gfcd .PrstClr =_gabgf .PrstClr ;_fbdg .SolidFill =_gfcd ;};if _fbdg .NoFill ==nil &&_fbdg .SolidFill ==nil {if _ebeg :=_aacd .Fill ;_ebeg !=nil {if _fbdg .NoFill ==nil {_fbdg .NoFill =_ebeg .NoFill ;};if _fbdg .SolidFill ==nil {_fbdg .SolidFill =_ebeg .SolidFill ;};};};if _bbae :=_aacd .TcBdr ;_bbae !=nil {if _fbdg .LnL ==nil {var _febc *_ge .CT_ThemeableLineStyle ;if _gfaad {_febc =_bbae .Left ;}else {_febc =_bbae .InsideV ;};if _febc !=nil {_fbdg .LnL =_febc .Ln ;};};if _fbdg .LnR ==nil {var _fff *_ge .CT_ThemeableLineStyle ;if _eecg {_fff =_bbae .Right ;}else {_fff =_bbae .InsideV ;};if _fff !=nil {_fbdg .LnR =_fff .Ln ;};};if _fbdg .LnT ==nil {var _fedd *_ge .CT_ThemeableLineStyle ;if _egbbc {_fedd =_bbae .Top ;}else {_fedd =_bbae .InsideH ;};if _fedd !=nil {_fbdg .LnT =_fedd .Ln ;};};if _fbdg .LnB ==nil {var _gecf *_ge .CT_ThemeableLineStyle ;if _dfec {_gecf =_bbae .Bottom ;}else {_gecf =_bbae .InsideH ;};if _gecf !=nil {_fbdg .LnB =_gecf .Ln ;};};};return _fbdg ;};func (_efd *convertContext )makeSlide (){_fc :=_efd ._fbf .X ().CSld ;if _fc ==nil {return ;};_cf :=&background {};if _gba :=_fc .Bg ;_gba !=nil {if _gef :=_gba .BgPr ;_gef !=nil {if _gef .NoFill ==nil {if _bbg :=_gef .SolidFill ;_bbg !=nil {_cgd ,_fe :=_efd .getColorFromSolidFill (_bbg );if _cgd !=nil {_cf ._cfdd =_cgd ;_cf ._aggc =_fe ;};}else if _ddb :=_gef .BlipFill ;_ddb !=nil {_cf ._bdg =_ddb ;};};};};_efd ._fdbe =_cf ;if _abc :=_fc .SpTree ;_abc !=nil {for _ ,_dc :=range _abc .Choice {if _dc !=nil {for _ ,_ea :=range _dc .Sp {if _ea !=nil {_fdb :=_efd .getShapes (_ea );_efd ._gec =append (_efd ._gec ,_fdb ...);};};for _ ,_cc :=range _dc .GraphicFrame {if _cc !=nil {var _ffc ,_ggb ,_ca ,_gcaa float64 ;if _ccd :=_cc .Xfrm ;_ccd !=nil {_ffc ,_ggb ,_ca ,_gcaa =_gb .GetDataFromXfrm (_ccd );};if _gag :=_cc .Graphic ;_gag !=nil {if _ad :=_gag .GraphicData ;_ad !=nil {for _ ,_fcc :=range _ad .Any {if _gbe ,_bcf :=_fcc .(*_aba .Chart );_bcf {_gbd ,_fgg :=_efd .makePdfBlockFromChart (_gbe ,_ca ,_gcaa );if _fgg !=nil {_gg .Log .Debug ("C\u0061\u006e\u006e\u006ft \u0072e\u0061\u0064\u0020\u0062\u006co\u0063\u006b\u003a\u0020\u0025\u0073",_fgg );};if _gbd !=nil {_gbd .SetPos (_ffc ,_ggb );_efd ._gec =append (_efd ._gec ,_gbd );};}else if _caf ,_ebe :=_fcc .(*_ge .Tbl );_ebe {_gcbb :=_efd .makePdfBlockFromTable (_caf ,_ca );if _gcbb !=nil {_efda :=_gf .NewBlock (_ca ,_gcaa );_efda .SetPos (_ffc ,_ggb );_efda .Draw (_gcbb );_efd ._gec =append (_efd ._gec ,_efda );};};};};};};};for _ ,_eg :=range _dc .CxnSp {if _eg !=nil {_ccb :=_efd .getConnectors (_eg );_efd ._gec =append (_efd ._gec ,_ccb ...);};};for _ ,_gcc :=range _dc .Pic {if _gcc !=nil {var _agfe ,_beb ,_cfd ,_dfg float64 ;if _ede :=_gcc .SpPr ;_ede !=nil {if _efa :=_ede .Xfrm ;_efa !=nil {_agfe ,_beb ,_cfd ,_dfg =_gb .GetDataFromXfrm (_efa );};};if _ba :=_gcc .BlipFill ;_ba !=nil {_dde :=_efd .getShapeFromBlipFill (_ba ,_agfe ,_beb ,_cfd ,_dfg );_efd ._gec =append (_efd ._gec ,_dde );};};};};};};};func (_bcfd *textboxContext )addTextSymbol (_efga *symbol ){_cebb :=_gf .New ();_eea :=_cebb .NewStyledParagraph ();_eea .SetMargins (0,0,0,0);_bfba :=_eea .Append (_efga ._abbe );_bgbd :=0.0;if _efga ._gcbe !=nil {_bfba .Style =*_efga ._gcbe ;if _efga ._gcbe .CharSpacing !=0{_bgbd =_efga ._gcbe .CharSpacing ;};};_efga ._egbc =_eea .Height ();_efga ._bceg =_eea .Height ()*1.2;if _efga ._bceg < _bcfd ._fgd ._ddg {_efga ._bceg =_bcfd ._fgd ._ddg ;};if _efga ._efdab ==0{_efga ._efdab =_eea .Width ()+_bgbd ;};if len (_bcfd ._aeb ._dea )> 0{_ceab :=_bcfd ._aeb ._dea [len (_bcfd ._aeb ._dea )-1]._abbe ;if _bcfd ._fgd ._efea ||_gb .IsNoSpaceLanguage (_ceab )||(_ceab =="\u0020")!=(_efga ._abbe =="\u0020"){_bcfd .addCurrentWordToParagraph ();_bcfd .newWord ();};};_bcfd ._aeb ._dea =append (_bcfd ._aeb ._dea ,_efga );_efga ._dbf =_bcfd ._aeb ._cfga ;_bcfd ._aeb ._cfga +=_efga ._efdab ;if _efga ._abbe !="\u0020"{_bcfd ._aeb ._aeded =false ;};};type paragraph struct{_badg float64 ;_cbcd float64 ;_baf float64 ;_cabe float64 ;_gad float64 ;_adfd float64 ;_bdb float64 ;_caeb float64 ;_geg _ge .ST_TextAlignType ;_ddg float64 ;_efea bool ;_ebba []*line ;};func _aff (_dfa ,_ebgg *_ge .CT_TextCharacterProperties )*_ge .CT_TextCharacterProperties {_cebg :=_ge .NewCT_TextCharacterProperties ();if _dfa !=nil {*_cebg =*_dfa ;};if _ebgg ==nil {return _cebg ;};if _cebg .KumimojiAttr ==nil {_cebg .KumimojiAttr =_ebgg .KumimojiAttr ;};if _cebg .LangAttr ==nil {_cebg .LangAttr =_ebgg .LangAttr ;};if _cebg .AltLangAttr ==nil {_cebg .AltLangAttr =_ebgg .AltLangAttr ;};if _cebg .SzAttr ==nil {_cebg .SzAttr =_ebgg .SzAttr ;};if _cebg .BAttr ==nil {_cebg .BAttr =_ebgg .BAttr ;};if _cebg .IAttr ==nil {_cebg .IAttr =_ebgg .IAttr ;};if _cebg .UAttr ==_ge .ST_TextUnderlineTypeUnset {_cebg .UAttr =_ebgg .UAttr ;};if _cebg .StrikeAttr ==_ge .ST_TextStrikeTypeUnset {_cebg .StrikeAttr =_ebgg .StrikeAttr ;};if _cebg .KernAttr ==nil {_cebg .KernAttr =_ebgg .KernAttr ;};if _cebg .CapAttr ==_ge .ST_TextCapsTypeUnset {_cebg .CapAttr =_ebgg .CapAttr ;};if _cebg .SpcAttr ==nil {_cebg .SpcAttr =_ebgg .SpcAttr ;};if _cebg .NormalizeHAttr ==nil {_cebg .NormalizeHAttr =_ebgg .NormalizeHAttr ;};if _cebg .BaselineAttr ==nil {_cebg .BaselineAttr =_ebgg .BaselineAttr ;};if _cebg .NoProofAttr ==nil {_cebg .NoProofAttr =_ebgg .NoProofAttr ;};if _cebg .DirtyAttr ==nil {_cebg .DirtyAttr =_ebgg .DirtyAttr ;};if _cebg .ErrAttr ==nil {_cebg .ErrAttr =_ebgg .ErrAttr ;};if _cebg .SmtCleanAttr ==nil {_cebg .SmtCleanAttr =_ebgg .SmtCleanAttr ;};if _cebg .SmtIdAttr ==nil {_cebg .SmtIdAttr =_ebgg .SmtIdAttr ;};if _cebg .BmkAttr ==nil {_cebg .BmkAttr =_ebgg .BmkAttr ;};if _cebg .Ln ==nil {_cebg .Ln =_ebgg .Ln ;};if _cebg .NoFill ==nil {_cebg .NoFill =_ebgg .NoFill ;};if _cebg .SolidFill ==nil {_cebg .SolidFill =_ebgg .SolidFill ;};if _cebg .BlipFill ==nil {_cebg .BlipFill =_ebgg .BlipFill ;};if _cebg .EffectLst ==nil {_cebg .EffectLst =_ebgg .EffectLst ;};if _cebg .EffectDag ==nil {_cebg .EffectDag =_ebgg .EffectDag ;};if _cebg .Highlight ==nil {_cebg .Highlight =_ebgg .Highlight ;};if _cebg .ULnTx ==nil {_cebg .ULnTx =_ebgg .ULnTx ;};if _cebg .ULn ==nil {_cebg .ULn =_ebgg .ULn ;};if _cebg .UFillTx ==nil {_cebg .UFillTx =_ebgg .UFillTx ;};if _cebg .UFill ==nil {_cebg .UFill =_ebgg .UFill ;};if _cebg .Latin ==nil {_cebg .Latin =_ebgg .Latin ;};if _cebg .Ea ==nil {_cebg .Ea =_ebgg .Ea ;};if _cebg .Cs ==nil {_cebg .Cs =_ebgg .Cs ;};if _cebg .Sym ==nil {_cebg .Sym =_ebgg .Sym ;};if _cebg .Rtl ==nil {_cebg .Rtl =_ebgg .Rtl ;};return _cebg ;};type romanMatch struct{_eag int ;_ebc string ;};func _fdbf (_afce *_ab .CT_CommonSlideData ,_adgc _ab .ST_PlaceholderType ,_fefd *uint32 ,_beba bool )(*_ge .CT_Transform2D ,*_ge .CT_TextBody ,*bool ,*bool ){if _afce !=nil &&(_adgc !=_ab .ST_PlaceholderTypeUnset ||!_beba ){if _dcd :=_afce .SpTree ;_dcd !=nil {for _ ,_ccf :=range _dcd .Choice {if _ccf !=nil {for _ ,_cdf :=range _ccf .Sp {if _cdf !=nil {_cgde ,_adgd :=_bccg (_cdf );if _adgc ==_cgde {if (_beba &&_adgd ==nil )||(!_beba &&_adgd !=nil &&*_adgd ==*_fefd ){var _cgcf *_ge .CT_Transform2D ;if _cdf .SpPr !=nil {_cgcf =_cdf .SpPr .Xfrm ;};_ddfb :=_adgc ==_ab .ST_PlaceholderTypeTitle ||_adgc ==_ab .ST_PlaceholderTypeCtrTitle ;_ffae :=!_ddfb &&_adgc !=_ab .ST_PlaceholderTypeUnset ;return _cgcf ,_cdf .TxBody ,&_ddfb ,&_ffae ;};};};};};};};};return nil ,nil ,nil ,nil ;};func _gbga (_ecfa *bool )bool {return _ecfa !=nil &&*_ecfa };func _dggc (_ffafc ,_afec *_ge .CT_TablePartStyle )*_ge .CT_TablePartStyle {_bacb :=_ge .NewCT_TablePartStyle ();if _ffafc !=nil {*_bacb =*_ffafc ;};if _afec ==nil {return _bacb ;};if _bacb .TcTxStyle ==nil {_bacb .TcTxStyle =_afec .TcTxStyle ;}else {_bacb .TcTxStyle =_cadb (_bacb .TcTxStyle ,_afec .TcTxStyle );};if _bacb .TcStyle ==nil {_bacb .TcStyle =_afec .TcStyle ;}else {_bacb .TcStyle =_abgd (_bacb .TcStyle ,_afec .TcStyle );};return _bacb ;};func (_dbfe *convertContext )getColorFromMatrixReference (_eae *_ge .CT_StyleMatrixReference )_gf .Color {if _eae ==nil {return nil ;};var _cef _gf .Color ;var _eeg string ;if _gebd :=_eae .SrgbClr ;_gebd !=nil {_eeg =_gebd .ValAttr ;}else if _afdbc :=_eae .SchemeClr ;_afdbc !=nil {_eeg =_gb .GetColorStringFromDmlColor (_dbfe ._bbda .GetColorBySchemeColor (_afdbc .ValAttr ));_eeg =_gb .AdjustColor (_eeg ,_afdbc .EG_ColorTransform );};if _eeg !=""{_cef =_gf .ColorRGBFromHex ("\u0023"+_eeg );};return _cef ;};func (_bfca *convertContext )getColorFromFontReference (_acae *_ge .CT_FontReference )_gf .Color {var _abae _gf .Color ;var _begg string ;if _gbbfd :=_acae .SrgbClr ;_gbbfd !=nil {_begg =_gbbfd .ValAttr ;}else if _fee :=_acae .SchemeClr ;_fee !=nil {_begg =_gb .GetColorStringFromDmlColor (_bfca ._bbda .GetColorBySchemeColor (_fee .ValAttr ));_begg =_gb .AdjustColor (_begg ,_fee .EG_ColorTransform );};if _begg !=""{_abae =_gf .ColorRGBFromHex ("\u0023"+_begg );};return _abae ;};func (_ddf *convertContext )stretchImage (_gfd *_gf .Image ,_dcc *_ge .CT_StretchInfoProperties ,_gfe ,_bed ,_cbd ,_bfbc float64 )(*_gf .Image ,float64 ,float64 ){_faf :=_dcc .FillRect ;if _faf ==nil {_ac :=_gfd .Width ()/_gfd .Height ();_cgf :=_cbd /_bfbc ;var _gff ,_bae float64 ;if _ac > _cgf {_bae =_bfbc ;_gff =_bfbc *_ac ;}else {_gff =_cbd ;_bae =_cbd /_ac ;};_gfd .Scale (_gff /_gfd .Width (),_bae /_gfd .Height ());return _gfd ,_gfe ,_bed ;};var _cac ,_dga ,_fcca ,_fcg float64 ;if _cdc :=_faf .LAttr ;_cdc !=nil {_fcca =_gb .FromSTPercentage (_cdc );};if _fga :=_faf .TAttr ;_fga !=nil {_cac =_gb .FromSTPercentage (_fga );};if _ec :=_faf .RAttr ;_ec !=nil {_fcg =_gb .FromSTPercentage (_ec );};if _gcaf :=_faf .BAttr ;_gcaf !=nil {_dga =_gb .FromSTPercentage (_gcaf );};_gd :=_cbd *(1-_fcca -_fcg );_acb :=_bfbc *(1-_cac -_dga );_gfd .Scale (_gd /_gfd .Width (),_acb /_gfd .Height ());return _gfd ,_gfe +_fcca *_cbd ,_bed +_cac *_bfbc ;};type word struct{_dea []*symbol ;_cggd float64 ;_cfga float64 ;_aeded bool ;};func (_effe *convertContext )getShapes (_db *_ab .CT_Shape )[]_gf .Drawable {_dad :=[]_gf .Drawable {};_gbg :=_db .SpPr ;if _gbg ==nil {return _dad ;};var _bac bool ;if _aagb :=_db .UseBgFillAttr ;_aagb !=nil {_bac =*_aagb ;};_age ,_dbg ,_gage ,_aca ,_gcbdg ,_aad ,_egg :=_effe .getShapesFromSpPr (_gbg ,_db .Style ,_bac );_dad =append (_dad ,_age ...);if _agfd :=_db .TxBody ;_agfd !=nil {_abd ,_dgfe ,_fed ,_bffd ,_cad :=_effe .getPhData (_db );if _abd !=nil &&!_egg {_dbg ,_gage ,_aca ,_gcbdg =_gb .GetDataFromXfrm (_abd );};_dgb ,_caa :=_effe .makePdfBlockFromTxBody (_agfd ,_dgfe ,_fed ,_aca ,_gcbdg ,_aad ,_bffd ,_cad );if _caa !=nil {_gg .Log .Debug ("\u0043\u0061\u006e\u006e\u006f\u0074\u0020\u006d\u0061\u006b\u0065\u0020\u0050\u0044\u0046\u0020\u0062\u006c\u006f\u0063\u006b\u0020\u0066\u0072o\u006d\u0020\u0074\u0065\u0078t\u0062\u006fx\u003a\u0020\u0025\u0073",_caa );}else if _dgb !=nil {_dgb .SetPos (_dbg ,_gage );_dad =append (_dad ,_dgb );};};return _dad ;};func _ffad (_cdgb *_ge .CT_TextCharacterProperties ,_gbbd *_ge .CT_TableStyleTextStyle )*_ge .CT_TextCharacterProperties {_bbc :=_ge .NewCT_TextCharacterProperties ();if _cdgb !=nil {*_bbc =*_cdgb ;};if _gbbd ==nil {return _bbc ;};if _bbc .BAttr ==nil &&_gbbd .BAttr !=_ge .ST_OnOffStyleTypeUnset {_fafad :=_gbbd .BAttr ==_ge .ST_OnOffStyleTypeOn ;_bbc .BAttr =&_fafad ;};if _bbc .IAttr ==nil &&_gbbd .IAttr !=_ge .ST_OnOffStyleTypeUnset {_aagd :=_gbbd .IAttr ==_ge .ST_OnOffStyleTypeOn ;_bbc .IAttr =&_aagd ;};if _bbc .NoFill ==nil &&_bbc .SolidFill ==nil {_bbc .SolidFill =_ge .NewCT_SolidColorFillProperties ();_bbc .SolidFill .ScrgbClr =_gbbd .ScrgbClr ;_bbc .SolidFill .SrgbClr =_gbbd .SrgbClr ;_bbc .SolidFill .HslClr =_gbbd .HslClr ;_bbc .SolidFill .SysClr =_gbbd .SysClr ;_bbc .SolidFill .SchemeClr =_gbbd .SchemeClr ;_bbc .SolidFill .PrstClr =_gbbd .PrstClr ;};if _dabbb :=_gbbd .Font ;_dabbb !=nil &&_bbc .Latin ==nil &&_bbc .Ea ==nil &&_bbc .Cs ==nil {_bbc .Latin =_dabbb .Latin ;_bbc .Ea =_dabbb .Ea ;_bbc .Cs =_dabbb .Cs ;};return _bbc ;};func (_ffeg *convertContext )getStyleColors (_daegg *_ge .CT_ShapeStyle )(_gf .Color ,_gf .Color ,_gf .Color ){var _gabg ,_cdcc ,_cbca _gf .Color ;if _bffe :=_daegg .LnRef ;_bffe !=nil {_cdcc =_ffeg .getColorFromMatrixReference (_bffe );};if _feb :=_daegg .FillRef ;_feb !=nil {_cbca =_ffeg .getColorFromMatrixReference (_feb );};if _dfgb :=_daegg .FontRef ;_dfgb !=nil {_gabg =_ffeg .getColorFromFontReference (_dfgb );};return _gabg ,_cbca ,_cdcc ;};

// ConvertToPdf converts a presentation to a PDF file. This package is beta, breaking changes can take place.
func ConvertToPdf (pr *_d .Presentation )*_gf .Creator {_ef :=pr .X ().SldSz ;_cd :=_da .FromEMU (int64 (_ef .CxAttr ));_gfa :=_da .FromEMU (int64 (_ef .CyAttr ));_de :=_gf .PageSize {_cd ,_gfa };_cg :=_gf .New ();_cg .SetPageSize (_de );var _eff *_ge .Theme ;if len (pr .Themes ())> 0{_eff =pr .Themes ()[0];};for _ ,_gfc :=range pr .Slides (){if _gfc .X ()==nil {continue ;};_ggg :=&convertContext {_dbc :_cg ,_fbf :&_gfc ,_bebbe :_gfc .GetSlideLayout (),_abdf :pr .SlideMasters ()[0].X (),_bbda :pr ,_cdec :_eff ,_efdb :_gfc .X ().ClrMapOvr ,_dcce :_de [1],_ffca :_de [0]};_ggg ._bebbe =_gfc .GetSlideLayout ();_ggg .extractDefaultProperties ();_ggg .makeSlide ();_ggg .drawSlide ();};return _cg ;};func (_bfde *textboxContext )newWord (){_bfde ._aeb =&word {_aeded :true ,_cggd :_bfde ._eda ._cgc }};type background struct{_cfdd _gf .Color ;_aggc float64 ;_bdg *_ge .CT_BlipFillProperties ;};func (_dadc *convertContext )addCellToTable (_eaa *_gf .Table ,_fbd *_ge .CT_TableCell ,_egfg *_ge .CT_TablePartStyle ,_cee float64 ,_cga ,_dcbf ,_cebf ,_bfe bool )float64 {var _cfb *_gf .TableCell ;_ddcg :=1;if _fbd .GridSpanAttr !=nil {_ddcg =int (*_fbd .GridSpanAttr );};_cfb =_eaa .MultiColCell (_ddcg );_abg :=_fbd .TcPr ;var _gbac *_ge .CT_TableStyleTextStyle ;if _egfg !=nil {_abg =_dbae (_abg ,_egfg .TcStyle ,_cga ,_dcbf ,_cebf ,_bfe );_gbac =_egfg .TcTxStyle ;};_acfc :=_bgb ;_edf :=_gf .CellVerticalAlignmentMiddle ;if _abg !=nil {if _bcce :=_abg .LnL ;_bcce !=nil {_cec ,_faab ,_bcgb :=_dadc .getBorderStyle (_bcce );_cfb .SetBorder (_gf .CellBorderSideLeft ,_cec ,_bcgb );if _faab !=nil &&*_faab !=nil {_cfb .SetSideBorderColor (_gf .CellBorderSideLeft ,*_faab );};};if _dadf :=_abg .LnT ;_dadf !=nil {_cccg ,_gcae ,_eed :=_dadc .getBorderStyle (_dadf );_cfb .SetBorder (_gf .CellBorderSideTop ,_cccg ,_eed );if _gcae !=nil &&*_gcae !=nil {_cfb .SetSideBorderColor (_gf .CellBorderSideTop ,*_gcae );};};if _edeg :=_abg .LnR ;_edeg !=nil {_dbga ,_ggfa ,_acg :=_dadc .getBorderStyle (_edeg );_cfb .SetBorder (_gf .CellBorderSideRight ,_dbga ,_acg );if _ggfa !=nil &&*_ggfa !=nil {_cfb .SetSideBorderColor (_gf .CellBorderSideRight ,*_ggfa );};};if _ccaa :=_abg .LnB ;_ccaa !=nil {_aeeg ,_ccae ,_faaf :=_dadc .getBorderStyle (_ccaa );_cfb .SetBorder (_gf .CellBorderSideBottom ,_aeeg ,_faaf );if _ccae !=nil &&*_ccae !=nil {_cfb .SetSideBorderColor (_gf .CellBorderSideBottom ,*_ccae );};};if _cecg :=_abg .MarLAttr ;_cecg !=nil {_acfc =float64 (_gb .FromSTCoordinate32 (*_cecg ));};switch _abg .AnchorAttr {case _ge .ST_TextAnchoringTypeT :_edf =_gf .CellVerticalAlignmentTop ;case _ge .ST_TextAnchoringTypeB :_edf =_gf .CellVerticalAlignmentBottom ;};if _abg .NoFill ==nil {if _gfeg :=_abg .SolidFill ;_gfeg !=nil {_bcd ,_ :=_dadc .getColorFromSolidFill (_gfeg );_cfb .SetBackgroundColor (_bcd );};};};_cfb .SetVerticalAlignment (_edf );_cfb .SetIndent (_acfc );var _cbae float64 ;if _ebdc :=_fbd .TxBody ;_ebdc !=nil {_acbc :=_dadc .makePdfDivisionFromTxBody (_ebdc ,_cee ,_cbae ,_gbac );_cbae =_acbc .Height ();_cfb .SetContent (_acbc );};return _cbae ;};func _ggef (_aaa ,_bbbe *_ge .CT_TextParagraphProperties )*_ge .CT_TextParagraphProperties {_bdag :=_ge .NewCT_TextParagraphProperties ();if _aaa !=nil {*_bdag =*_aaa ;};if _bbbe ==nil {return _bdag ;};if _bdag .MarLAttr ==nil {_bdag .MarLAttr =_bbbe .MarLAttr ;};if _bdag .MarRAttr ==nil {_bdag .MarRAttr =_bbbe .MarRAttr ;};if _bdag .LvlAttr ==nil {_bdag .LvlAttr =_bbbe .LvlAttr ;};if _bdag .IndentAttr ==nil {_bdag .IndentAttr =_bbbe .IndentAttr ;};if _bdag .AlgnAttr ==_ge .ST_TextAlignTypeUnset {_bdag .AlgnAttr =_bbbe .AlgnAttr ;};if _bdag .DefTabSzAttr ==nil {_bdag .DefTabSzAttr =_bbbe .DefTabSzAttr ;};if _bdag .RtlAttr ==nil {_bdag .RtlAttr =_bbbe .RtlAttr ;};if _bdag .EaLnBrkAttr ==nil {_bdag .EaLnBrkAttr =_bbbe .EaLnBrkAttr ;};if _bdag .FontAlgnAttr ==_ge .ST_TextFontAlignTypeUnset {_bdag .FontAlgnAttr =_bbbe .FontAlgnAttr ;};if _bdag .LatinLnBrkAttr ==nil {_bdag .LatinLnBrkAttr =_bbbe .LatinLnBrkAttr ;};if _bdag .HangingPunctAttr ==nil {_bdag .HangingPunctAttr =_bbbe .HangingPunctAttr ;};if _bdag .LnSpc ==nil {_bdag .LnSpc =_bbbe .LnSpc ;};if _bdag .SpcBef ==nil {_bdag .SpcBef =_bbbe .SpcBef ;};if _bdag .SpcAft ==nil {_bdag .SpcAft =_bbbe .SpcAft ;};if _bdag .BuClrTx ==nil {_bdag .BuClrTx =_bbbe .BuClrTx ;};if _bdag .BuClr ==nil {_bdag .BuClr =_bbbe .BuClr ;};if _bdag .BuSzTx ==nil {_bdag .BuSzTx =_bbbe .BuSzTx ;};if _bdag .BuSzPct ==nil {_bdag .BuSzPct =_bbbe .BuSzPct ;};if _bdag .BuSzPts ==nil {_bdag .BuSzPts =_bbbe .BuSzPts ;};if _bdag .BuFontTx ==nil {_bdag .BuFontTx =_bbbe .BuFontTx ;};if _bdag .BuFont ==nil {_bdag .BuFont =_bbbe .BuFont ;};if _bdag .BuNone ==nil {_bdag .BuNone =_bbbe .BuNone ;};if _bdag .BuAutoNum ==nil {_bdag .BuAutoNum =_bbbe .BuAutoNum ;};if _bdag .BuChar ==nil {_bdag .BuChar =_bbbe .BuChar ;};if _bdag .BuBlip ==nil {_bdag .BuBlip =_bbbe .BuBlip ;};if _bdag .TabLst ==nil {_bdag .TabLst =_bbbe .TabLst ;};if _bdag .ExtLst ==nil {_bdag .ExtLst =_bbbe .ExtLst ;};_bdag .DefRPr =_aff (_bdag .DefRPr ,_bbbe .DefRPr );return _bdag ;};func (_gaeag *convertContext )getShapeFromBlipFill (_faae *_ge .CT_BlipFillProperties ,_efgad ,_geeg ,_fabf ,_ceg float64 )_gf .Drawable {_beea ,_bgbf ,_eccg :=_gaeag .makePdfImageFromBlipFill (_faae );if _eccg !=nil {_gg .Log .Debug ("\u0043\u0061\u006e\u006e\u006f\u0074\u0020\u006d\u0061\u006b\u0065\u0020\u0050D\u0046\u0020\u0069\u006d\u0061\u0067e\u0020\u0066\u0072\u006f\u006d\u0020\u0042\u006c\u0069\u0070\u0046\u0069\u006cl\u003a\u0020\u0025\u0073",_eccg );return nil ;};if _beea ==nil {return nil ;};if _aaga :=_faae .Tile ;_aaga !=nil {_beea =_gaeag .tileImage (_beea ,_faae .Tile ,_fabf ,_ceg );};if _edfb :=_faae .Stretch ;_edfb !=nil {_beea ,_efgad ,_geeg =_gaeag .stretchImage (_beea ,_faae .Stretch ,_efgad ,_geeg ,_fabf ,_ceg );};if len (_bgbf )==0{_beea .SetPos (_efgad ,_geeg );return _beea ;};_beea =_gaeag .applyBlipEffectsOnImg (_beea ,_efgad ,_geeg ,_bgbf );_beea .SetPos (_efgad ,_geeg );return _beea ;};func _bccg (_efdg *_ab .CT_Shape )(_ab .ST_PlaceholderType ,*uint32 ){if _bdba :=_efdg .NvSpPr ;_bdba !=nil {if _eeae :=_bdba .NvPr ;_eeae !=nil {if _dege :=_eeae .Ph ;_dege !=nil {return _dege .TypeAttr ,_dege .IdxAttr ;};};};return _ab .ST_PlaceholderTypeUnset ,nil ;};func (_cfce *textboxContext )alignParagraph (){_beed :=_cfce ._fgd ;if _beed ._geg ==_ge .ST_TextAlignTypeL {return ;};_daa :=len (_beed ._ebba )-1;for _bfgc ,_fcgb :=range _beed ._ebba {_gfg :=true ;_fbbf :=len (_fcgb ._defef );_cbea :=0.0;for _abdd :=len (_fcgb ._defef )-1;_abdd >=0;_abdd --{_dfd :=_fcgb ._defef [_abdd ];if _gfg &&_dfd ._aeded {_fbbf =_abdd ;}else {_gfg =false ;for _ ,_afdb :=range _dfd ._dea {_cbea +=_afdb ._efdab ;};};};_fcgb ._defef =_fcgb ._defef [:_fbbf ];_bfdb :=_fcgb ._gead -_fcgb ._cggf -_cbea ;switch _beed ._geg {case _ge .ST_TextAlignTypeR :_fcgb .moveRight (_bfdb );case _ge .ST_TextAlignTypeCtr :_fcgb .moveRight (_bfdb /2);case _ge .ST_TextAlignTypeJust :if _bfgc !=_daa {_gcd :=[]*word {};for _ ,_gbaedf :=range _fcgb ._defef {if _gbaedf ._aeded {_gcd =append (_gcd ,_gbaedf );};};_fgef :=_bfdb /float64 (len (_gcd ));for _ ,_baga :=range _gcd {_baga ._cfga +=_fgef ;};var _aea *word ;for _ ,_fceg :=range _fcgb ._defef {if _aea !=nil {_fceg ._cggd =_aea ._cggd +_aea ._cfga ;};_aea =_fceg ;};};};};};func (_acbb *textboxContext )alignSymbolsVertically (){for _ ,_afded :=range _acbb ._fgc {for _ ,_bfc :=range _afded ._ebba {_cfec :=0.0;for _ ,_fccb :=range _bfc ._defef {for _ ,_bee :=range _fccb ._dea {if _bee ._bceg > _cfec {_cfec =_bee ._bceg ;};};};for _ ,_fdccg :=range _bfc ._defef {for _ ,_gdg :=range _fdccg ._dea {if _gdg ._egbc < _cfec {_gdg ._aeegd =_cfec -_gdg ._egbc ;};};};};};};type symbol struct{_abbe string ;_dbf float64 ;_bceg float64 ;_egbc float64 ;_aeegd float64 ;_efdab float64 ;_gcbe *_gf .TextStyle ;_dddf string ;_gbaed bool ;_gaea bool ;_cabc bool ;};func _aacf (_gbdf int ,_cdeb bool )string {_dcca :=_e .NewBuffer ([]byte {});for _ ,_bca :=range _dcee {for {if _gbdf < _bca ._eag {break ;};_dcca .WriteString (_bca ._ebc );_gbdf -=_bca ._eag ;};};_egdc :=_dcca .String ();if _cdeb {_egdc =_ae .ToUpper (_egdc );};return _egdc ;};func (_fdd *convertContext )extractDefaultProperties (){_bb :=_fdd ._bbda .X ();_ga :=_bb .DefaultTextStyle ;var _gga ,_effc ,_gca ,_dae ,_gcb ,_bf ,_fa ,_dee ,_bff ,_aae *_ge .CT_TextParagraphProperties ;if _ga !=nil {_gga =_ga .DefPPr ;_effc =_ggef (_ga .Lvl1pPr ,_gga );_gca =_ggef (_ga .Lvl2pPr ,_gga );_dae =_ggef (_ga .Lvl3pPr ,_gga );_gcb =_ggef (_ga .Lvl4pPr ,_gga );_bf =_ggef (_ga .Lvl5pPr ,_gga );_fa =_ggef (_ga .Lvl6pPr ,_gga );_dee =_ggef (_ga .Lvl7pPr ,_gga );_bff =_ggef (_ga .Lvl8pPr ,_gga );_aae =_ggef (_ga .Lvl9pPr ,_gga );_fdd ._ffa =_gga ;_fdd ._aaee =_gga .DefRPr ;};_fdd ._dgg =make ([]*_ge .CT_TextParagraphProperties ,9);_fdd ._dgg [0]=_effc ;_fdd ._dgg [1]=_gca ;_fdd ._dgg [2]=_dae ;_fdd ._dgg [3]=_gcb ;_fdd ._dgg [4]=_bf ;_fdd ._dgg [5]=_fa ;_fdd ._dgg [6]=_dee ;_fdd ._dgg [7]=_bff ;_fdd ._dgg [8]=_aae ;_ce :=_fdd ._bbda .SlideMasters ()[0].X ();_ed :=_ce .TxStyles ;_fg :=_ed .TitleStyle ;_fdd ._bbdc =_ggef (_fg .DefPPr ,_gga );_fdd ._cfbb =_fdd ._bbdc .DefRPr ;_fdd ._fafa =make ([]*_ge .CT_TextParagraphProperties ,9);_fdd ._fafa [0]=_ggef (_fg .Lvl1pPr ,_effc );_fdd ._fafa [1]=_ggef (_fg .Lvl2pPr ,_gca );_fdd ._fafa [2]=_ggef (_fg .Lvl3pPr ,_dae );_fdd ._fafa [3]=_ggef (_fg .Lvl4pPr ,_gcb );_fdd ._fafa [4]=_ggef (_fg .Lvl5pPr ,_bf );_fdd ._fafa [5]=_ggef (_fg .Lvl6pPr ,_fa );_fdd ._fafa [6]=_ggef (_fg .Lvl7pPr ,_dee );_fdd ._fafa [7]=_ggef (_fg .Lvl8pPr ,_bff );_fdd ._fafa [8]=_ggef (_fg .Lvl9pPr ,_aae );_be :=_ed .BodyStyle ;_fdd ._edega =_ggef (_be .DefPPr ,_gga );_fdd ._fac =_fdd ._edega .DefRPr ;_fdd ._defe =make ([]*_ge .CT_TextParagraphProperties ,9);_fdd ._defe [0]=_ggef (_be .Lvl1pPr ,_effc );_fdd ._defe [1]=_ggef (_be .Lvl2pPr ,_gca );_fdd ._defe [2]=_ggef (_be .Lvl3pPr ,_dae );_fdd ._defe [3]=_ggef (_be .Lvl4pPr ,_gcb );_fdd ._defe [4]=_ggef (_be .Lvl5pPr ,_bf );_fdd ._defe [5]=_ggef (_be .Lvl6pPr ,_fa );_fdd ._defe [6]=_ggef (_be .Lvl7pPr ,_dee );_fdd ._defe [7]=_ggef (_be .Lvl8pPr ,_bff );_fdd ._defe [8]=_ggef (_be .Lvl9pPr ,_aae );};func (_egdf *convertContext )renderPageWithDrawableToGoImage (_cfag _gf .Drawable )(_a .Image ,error ){_cbfc :=_gb .MakeTempCreator (_egdf ._ffca ,_egdf ._dcce );_cbfc .NewPage ();_cbfc .Draw (_cfag );_fdg ,_cbcc :=_gb .GetPageFromCreator (_cbfc );if _cbcc !=nil {return nil ,_cbcc ;};return _df .NewImageDevice ().Render (_fdg );};func (_ecc *convertContext )makePdfBlockFromTxBody (_bge *_ge .CT_TextBody ,_gbaa *_ge .CT_TextBodyProperties ,_gagb *_ge .CT_TextListStyle ,_bcfb ,_baa float64 ,_gbab _gf .Color ,_bcfe ,_cae bool )(*_gf .Block ,error ){var _gafd *_ge .CT_TextParagraphProperties ;if _acf :=_bge .LstStyle ;_acf !=nil {var _gdf *_ge .CT_TextParagraphProperties ;if _acf .Lvl1pPr !=nil {_gdf =_acf .Lvl1pPr ;};_gafd =_ggef (_gdf ,_acf .DefPPr );};var _abca *_ge .CT_TextParagraphProperties ;if _gafd !=nil {if _bcfe {_abca =_ecc ._fafa [0];}else if _cae {_abca =_ecc ._defe [0];}else {_abca =_ecc ._dgg [0];};if _gagb !=nil {_abca =_ggef (_ggef (_gagb .Lvl1pPr ,_gagb .DefPPr ),_abca );};_abca =_ggef (_gafd ,_abca );}else {if _bcfe {_abca =_ecc ._bbdc ;}else if _cae {_abca =_ecc ._edega ;}else {_abca =_ecc ._ffa ;};};_gab ,_bgee :=_ddff (2.5),_ddff (2.5);_cde ,_egf :=_ddff (1.3),_ddff (1.3);_ddfc :=true ;_fag :=_ge .ST_TextAnchoringTypeT ;if _gbaa !=nil {if _cacd :=_gbaa .AnchorAttr ;_cacd !=_ge .ST_TextAnchoringTypeUnset {_fag =_cacd ;};};if _dbb :=_bge .BodyPr ;_dbb !=nil {if _efc :=_dbb .LInsAttr ;_efc !=nil {_gab =_da .FromEMU (_gb .FromSTCoordinate32 (*_efc ));};if _bce :=_dbb .TInsAttr ;_bce !=nil {_cde =_da .FromEMU (_gb .FromSTCoordinate32 (*_bce ));};if _eeee :=_dbb .RInsAttr ;_eeee !=nil {_bgee =_da .FromEMU (_gb .FromSTCoordinate32 (*_eeee ));};if _egff :=_dbb .BInsAttr ;_egff !=nil {_egf =_da .FromEMU (_gb .FromSTCoordinate32 (*_egff ));};_ddfc =_dbb .WrapAttr !=_ge .ST_TextWrappingTypeNone ;if _badd :=_dbb .AnchorAttr ;_badd !=_ge .ST_TextAnchoringTypeUnset {_fag =_dbb .AnchorAttr ;};};_cgfe :=_gb .MakeTempCreator (_bcfb ,_baa );_cgfe .SetPageMargins (_gab ,_bgee ,_cde ,_egf );_fad :=&textboxContext {_ddeg :_ecc ,_ageg :_ddfc ,_aac :_bcfb -_gab -_bgee ,_gea :_baa -_cde -_egf ,_bdfe :_cgfe ,_fgc :[]*paragraph {}};_eceg :=1;for _ ,_cccf :=range _bge .P {if _cccf !=nil {_cca :=_cccf .PPr ;var _eeef *prefixData ;if _cca !=nil &&_cca .BuNone ==nil {var _gcec string ;var _ebd bool ;if _efb :=_cca .BuAutoNum ;_efb !=nil {var _dce string ;if _ebg :=_efb .StartAtAttr ;_ebg !=nil {_eceg =int (*_ebg );};var _aecg string ;switch _efb .TypeAttr {case _ge .ST_TextAutonumberSchemeAlphaUcParenBoth ,_ge .ST_TextAutonumberSchemeAlphaUcParenR ,_ge .ST_TextAutonumberSchemeAlphaUcPeriod :_aecg =_debe (_eceg ,true );case _ge .ST_TextAutonumberSchemeAlphaLcParenBoth ,_ge .ST_TextAutonumberSchemeAlphaLcParenR ,_ge .ST_TextAutonumberSchemeAlphaLcPeriod :_aecg =_debe (_eceg ,false );case _ge .ST_TextAutonumberSchemeRomanUcParenBoth ,_ge .ST_TextAutonumberSchemeRomanUcParenR ,_ge .ST_TextAutonumberSchemeRomanUcPeriod :_aecg =_aacf (_eceg ,true );case _ge .ST_TextAutonumberSchemeRomanLcParenBoth ,_ge .ST_TextAutonumberSchemeRomanLcParenR ,_ge .ST_TextAutonumberSchemeRomanLcPeriod :_aecg =_aacf (_eceg ,false );default:_aecg =_ff .Itoa (_eceg );};switch _efb .TypeAttr {case _ge .ST_TextAutonumberSchemeAlphaLcPeriod ,_ge .ST_TextAutonumberSchemeAlphaUcPeriod ,_ge .ST_TextAutonumberSchemeArabicPeriod ,_ge .ST_TextAutonumberSchemeRomanLcPeriod ,_ge .ST_TextAutonumberSchemeRomanUcPeriod ,_ge .ST_TextAutonumberSchemeArabicDbPeriod ,_ge .ST_TextAutonumberSchemeEa1ChsPeriod ,_ge .ST_TextAutonumberSchemeEa1ChtPeriod ,_ge .ST_TextAutonumberSchemeEa1JpnChsDbPeriod ,_ge .ST_TextAutonumberSchemeEa1JpnKorPeriod ,_ge .ST_TextAutonumberSchemeThaiAlphaPeriod ,_ge .ST_TextAutonumberSchemeThaiNumPeriod ,_ge .ST_TextAutonumberSchemeHindiAlphaPeriod ,_ge .ST_TextAutonumberSchemeHindiNumPeriod ,_ge .ST_TextAutonumberSchemeHindiAlpha1Period :_dce ="\u002e";case _ge .ST_TextAutonumberSchemeAlphaLcParenR ,_ge .ST_TextAutonumberSchemeAlphaUcParenR ,_ge .ST_TextAutonumberSchemeArabicParenR ,_ge .ST_TextAutonumberSchemeRomanLcParenR ,_ge .ST_TextAutonumberSchemeRomanUcParenR ,_ge .ST_TextAutonumberSchemeThaiAlphaParenR ,_ge .ST_TextAutonumberSchemeThaiNumParenR ,_ge .ST_TextAutonumberSchemeHindiNumParenR :_dce ="\u0029";};_gcec =_aecg +_dce ;_eceg ++;}else if _caec :=_cca .BuChar ;_caec !=nil {_gbde :=_caec .CharAttr ;if _egfc ,_gbbf :=_cgfg [_gbde ];_gbbf {_gbde =string (rune (_egfc ));}else {_gbde ="\u2022";};_gcec =_gbde ;_ebd =true ;};if _gcec !=""{var _cbge ,_afe float64 ;if _cca .MarLAttr !=nil {_cbge =_da .FromEMU (int64 (*_cca .MarLAttr ));};if _cca .IndentAttr !=nil {_afe =_da .FromEMU (int64 (*_cca .IndentAttr ));};_eeef =&prefixData {_ccaac :_gcec ,_fgba :_ebd ,_agac :_cbge ,_fgee :_afe };};};_cca =_ggef (_cca ,_abca );_aede :=_aff (_cccf .EndParaRPr ,_cca .DefRPr );_fad .newParagraph ();_fad .assignPropsToCurrentParagraph (_cca );_fad .newLine ();_fad .newWord ();for _eccf ,_ebb :=range _cccf .EG_TextRun {_fad .addTextRun (_ebb ,_aede ,_gbab ,_eeef );if _eccf > 0{_eeef =nil ;};};_fad .addCurrentWordToParagraph ();};_fad .addCurrentParagraph ();};_fad .alignVertically (_fag );_fad .drawParagraphs ();return _gb .MakeBlockFromCreator (_cgfe );};type line struct{_gbf float64 ;_cggf float64 ;_gead float64 ;_cgc float64 ;_gee float64 ;_defef []*word ;};var _cgfg =map[string ]int32 {"\u0076":9830,"\u00d8":8594,"\u00fc":8730};func (_acd *textboxContext )adjustHeights (_cgdf float64 ){if _acd ._eda ._gee < _cgdf {_acd ._fgd ._caeb +=(_cgdf -_acd ._eda ._gee );_acd ._eda ._gee =_cgdf ;};};func (_bcfgg *convertContext )makeStyleFromRPr (_fcec *_ge .CT_TextCharacterProperties )(*_gf .TextStyle ,bool ,bool ,bool ){var _fbc ,_badb ,_dffd bool ;_gafbd :=_bcfgg ._dbc .NewTextStyle ();if _fcec !=nil {_gdbf :=_gb .FontStyle_Regular ;_agg :=_gbga (_fcec .BAttr );_gced :=_gbga (_fcec .IAttr );if _agg &&_gced {_gdbf =_gb .FontStyle_BoldItalic ;}else if _agg {_gdbf =_gb .FontStyle_Bold ;}else if _gced {_gdbf =_gb .FontStyle_Italic ;};_dffd =_fcec .UAttr !=_ge .ST_TextUnderlineTypeUnset &&_fcec .UAttr !=_ge .ST_TextUnderlineTypeNone ;_fbcf :="\u0064e\u0066\u0061\u0075\u006c\u0074";if _eec :=_fcec .Latin ;_eec !=nil {_fbcf =_eec .TypefaceAttr ;}else if _eab :=_fcec .Ea ;_eab !=nil {_fbcf =_eab .TypefaceAttr ;}else if _dca :=_fcec .Cs ;_dca !=nil {_fbcf =_dca .TypefaceAttr ;}else if _aeeb :=_fcec .Sym ;_aeeb !=nil {_fbcf =_aeeb .TypefaceAttr ;};if _gedc ,_egd :=_gb .StdFontsMap [_fbcf ];_egd {_gafbd .Font =_gb .AssignStdFontByName (_gafbd ,_gedc [_gdbf ]);}else if _babd :=_gb .GetRegisteredFont (_fbcf ,_gdbf );_babd !=nil {_gafbd .Font =_babd ;}else {_gg .Log .Debug ("\u0046\u006f\u006e\u0074\u0020\u0025\u0073\u0020\u0077\u0069\u0074h\u0020\u0073\u0074\u0079\u006c\u0065\u0020\u0025s\u0020i\u0073\u0020\u006e\u006f\u0074\u0020\u0066\u006f\u0075\u006e\u0064\u002c\u0020\u0072\u0065\u0073\u0065\u0074 \u0074\u006f\u0020\u0064\u0065\u0066\u0061\u0075\u006c\u0074\u002e",_fbcf ,_gdbf );_gafbd .Font =_gb .AssignStdFontByName (_gafbd ,_gb .StdFontsMap ["\u0064e\u0066\u0061\u0075\u006c\u0074"][_gdbf ]);};var _eeb float64 ;if _cagf :=_fcec .SzAttr ;_cagf !=nil {_eeb =float64 (*_cagf )/100;}else {_eeb =_gb .DefaultFontSize ;};if _egb :=_fcec .BaselineAttr ;_egb !=nil {if _ecd :=_egb .ST_PercentageDecimal ;_ecd !=nil {if *_ecd > 0{_fbc =true ;}else if *_ecd < 0{_badb =true ;};};};if _fbc ||_badb {_eeb *=0.64;};_gafbd .FontSize =_eeb ;_dfb :=0.0;if _ffce :=_fcec .SpcAttr ;_ffce !=nil {if _fage :=_ffce .ST_TextPointUnqualified ;_fage !=nil {_dfb =float64 (*_fage )/100;};};_gafbd .CharSpacing =_dfb ;};return &_gafbd ,_fbc ,_badb ,_dffd ;};func _cadb (_eaac ,_fcb *_ge .CT_TableStyleTextStyle )*_ge .CT_TableStyleTextStyle {_gceca :=_ge .NewCT_TableStyleTextStyle ();if _eaac !=nil {*_gceca =*_eaac ;};if _fcb ==nil {return _gceca ;};if _gceca .BAttr ==_ge .ST_OnOffStyleTypeUnset {_gceca .BAttr =_fcb .BAttr ;};if _gceca .IAttr ==_ge .ST_OnOffStyleTypeUnset {_gceca .IAttr =_fcb .IAttr ;};if _gceca .Font ==nil {_gceca .Font =_fcb .Font ;};if _gceca .FontRef ==nil {_gceca .FontRef =_fcb .FontRef ;};if _gceca .ScrgbClr ==nil {_gceca .ScrgbClr =_fcb .ScrgbClr ;};if _gceca .SrgbClr ==nil {_gceca .SrgbClr =_fcb .SrgbClr ;};if _gceca .HslClr ==nil {_gceca .HslClr =_fcb .HslClr ;};if _gceca .SysClr ==nil {_gceca .SysClr =_fcb .SysClr ;};if _gceca .SchemeClr ==nil {_gceca .SchemeClr =_fcb .SchemeClr ;};if _gceca .PrstClr ==nil {_gceca .PrstClr =_fcb .PrstClr ;};return _gceca ;};func (_dbba *convertContext )getColorFromSolidFill (_gagbg *_ge .CT_SolidColorFillProperties )(_gf .Color ,float64 ){if _gagbg ==nil {return nil ,1;};var _caecf string ;_bade :=1.0;if _fgaac :=_gagbg .SrgbClr ;_fgaac !=nil {_caecf =_fgaac .ValAttr ;_bade =_gb .GetOpacityFromColorTransform (_fgaac .EG_ColorTransform );}else if _geag :=_gagbg .SchemeClr ;_geag !=nil {_caecf =_gb .GetColorStringFromDmlColor (_dbba ._fbf .GetColorBySchemeColor (_geag .ValAttr ));_caecf =_gb .AdjustColor (_caecf ,_geag .EG_ColorTransform );_bade =_gb .GetOpacityFromColorTransform (_geag .EG_ColorTransform );};if _caecf !=""{_bcgca :=_gf .ColorRGBFromHex ("\u0023"+_caecf );return _bcgca ,_bade ;};return nil ,1;};func _ebbb (_eeac *_ge .CT_AdjPoint2D )(float64 ,float64 ){var _afdcd ,_gcbda float64 ;_bbga ,_gdcb :=_eeac .XAttr ,_eeac .YAttr ;if _faafc :=_bbga .ST_Coordinate ;_faafc !=nil {_afdcd =_da .FromEMU (_gb .FromSTCoordinate (*_faafc ));};if _cbdf :=_gdcb .ST_Coordinate ;_cbdf !=nil {_gcbda =_da .FromEMU (_gb .FromSTCoordinate (*_cbdf ));};return _afdcd ,_gcbda ;};

// RegisterFont makes a PdfFont accessible for using in converting to PDF.
func RegisterFont (name string ,style FontStyle ,font *_dg .PdfFont ){_gb .RegisterFont (name ,style ,font );};func _eac (_bga string )[]*symbol {_cfe :=[]*symbol {};for _ ,_feg :=range _bga {_cfe =append (_cfe ,&symbol {_abbe :string (_feg )});};return _cfe ;};func (_abcb *textboxContext )newLine (){if _abcb ._fgd ==nil {_abcb .newParagraph ();};_dcfd :=_abcb ._fgd ._caeb +_abcb ._fgd ._cbcd ;_fbbd :=&line {};_fbbd ._cggf =_abcb ._fgd ._gad ;if len (_abcb ._fgd ._ebba )==0{_fbbd ._cggf +=_abcb ._fgd ._cabe ;};_fbbd ._gead =_abcb ._fgd ._adfd ;_fbbd ._cgc =_fbbd ._cggf ;_fbbd ._gbf =_dcfd ;_abcb ._fgd ._ebba =append (_abcb ._fgd ._ebba ,_fbbd );_abcb ._eda =_fbbd ;};func (_gcf *convertContext )drawSlide (){_gcf ._dbc .NewPage ();for _ ,_gaf :=range _gcf ._gec {if _gaf !=nil {_gcf ._dbc .MoveTo (0,0);_gcf ._dbc .Draw (_gaf );};};};func _cebfc (_ddfca ,_agaca *_ge .CT_TextBodyProperties )*_ge .CT_TextBodyProperties {_ege :=_ge .NewCT_TextBodyProperties ();if _ddfca !=nil {*_ege =*_ddfca ;};if _agaca ==nil {return _ege ;};if _ege .RotAttr ==nil {_ege .RotAttr =_agaca .RotAttr ;};if _ege .SpcFirstLastParaAttr ==nil {_ege .SpcFirstLastParaAttr =_agaca .SpcFirstLastParaAttr ;};if _ege .VertOverflowAttr ==_ge .ST_TextVertOverflowTypeUnset {_ege .VertOverflowAttr =_agaca .VertOverflowAttr ;};if _ege .HorzOverflowAttr ==_ge .ST_TextHorzOverflowTypeUnset {_ege .HorzOverflowAttr =_agaca .HorzOverflowAttr ;};if _ege .VertAttr ==_ge .ST_TextVerticalTypeUnset {_ege .VertAttr =_agaca .VertAttr ;};if _ege .WrapAttr ==_ge .ST_TextWrappingTypeUnset {_ege .WrapAttr =_agaca .WrapAttr ;};if _ege .LInsAttr ==nil {_ege .LInsAttr =_agaca .LInsAttr ;};if _ege .TInsAttr ==nil {_ege .TInsAttr =_agaca .TInsAttr ;};if _ege .RInsAttr ==nil {_ege .RInsAttr =_agaca .RInsAttr ;};if _ege .BInsAttr ==nil {_ege .BInsAttr =_agaca .BInsAttr ;};if _ege .NumColAttr ==nil {_ege .NumColAttr =_agaca .NumColAttr ;};if _ege .SpcColAttr ==nil {_ege .SpcColAttr =_agaca .SpcColAttr ;};if _ege .RtlColAttr ==nil {_ege .RtlColAttr =_agaca .RtlColAttr ;};if _ege .AnchorAttr ==_ge .ST_TextAnchoringTypeUnset {_ege .AnchorAttr =_agaca .AnchorAttr ;};if _ege .AnchorCtrAttr ==nil {_ege .AnchorCtrAttr =_agaca .AnchorCtrAttr ;};if _ege .ForceAAAttr ==nil {_ege .ForceAAAttr =_agaca .ForceAAAttr ;};if _ege .UprightAttr ==nil {_ege .UprightAttr =_agaca .UprightAttr ;};if _ege .CompatLnSpcAttr ==nil {_ege .CompatLnSpcAttr =_agaca .CompatLnSpcAttr ;};if _ege .PrstTxWarp ==nil {_ege .PrstTxWarp =_agaca .PrstTxWarp ;};if _ege .NoAutofit ==nil {_ege .NoAutofit =_agaca .NoAutofit ;};if _ege .NormAutofit ==nil {_ege .NormAutofit =_agaca .NormAutofit ;};if _ege .SpAutoFit ==nil {_ege .SpAutoFit =_agaca .SpAutoFit ;};if _ege .Scene3d ==nil {_ege .Scene3d =_agaca .Scene3d ;};if _ege .Sp3d ==nil {_ege .Sp3d =_agaca .Sp3d ;};if _ege .FlatTx ==nil {_ege .FlatTx =_agaca .FlatTx ;};if _ege .ExtLst ==nil {_ege .ExtLst =_agaca .ExtLst ;};return _ege ;};func (_gdde *textboxContext )alignVertically (_ffg _ge .ST_TextAnchoringType ){_gdde .alignParagraphsVertically (_ffg );_gdde .alignSymbolsVertically ();};func _debe (_babde int ,_gfb bool )string {_gac :=(_babde -1)/26+1;_afef :=byte ((_babde -1)%26);if _gfb {_afef +=byte (65);}else {_afef +=byte (97);};_dgba :=_e .NewBuffer ([]byte {});for _fede :=0;_fede < _gac ;_fede ++{_dgba .Write ([]byte {_afef });};return _dgba .String ();};func (_eebfb *convertContext )getPhData (_ffgf *_ab .CT_Shape )(*_ge .CT_Transform2D ,*_ge .CT_TextBodyProperties ,*_ge .CT_TextListStyle ,bool ,bool ){_aadg ,_badf :=_bccg (_ffgf );_aaed :=_badf ==nil ;_bcbce ,_cdgd ,_cbbb ,_bdff :=_fdbf (_eebfb ._abdf .CSld ,_aadg ,_badf ,_aaed );_fbae ,_dcea ,_agb ,_fgcb :=_fdbf (_eebfb ._bebbe .CSld ,_aadg ,_badf ,_aaed );if _fbae ==nil {_fbae =_bcbce ;};_cbdfb ,_afac :=_dbag (_dcea ,_cdgd );var _caef ,_egbb bool ;if _agb ==nil {if _cbbb !=nil {_caef =*_cbbb ;};}else {_caef =*_agb ;};if _fgcb ==nil {if _bdff !=nil {_egbb =*_bdff ;};}else {_egbb =*_fgcb ;};return _fbae ,_cbdfb ,_afac ,_caef ,_egbb ;};func (_baeg *textboxContext )addPrefix (_gfaa *prefixData ,_acfcd *_gf .TextStyle ){_cdb :=_eac (_gfaa ._ccaac );_abaa :=*_acfcd ;if _gfaa ._fgba {_abaa .Font =_gb .AssignStdFontByName (_abaa ,"\u0053\u0079\u006d\u0062\u006f\u006c");};for _ ,_gcfd :=range _cdb {_gcfd ._gcbe =&_abaa ;_baeg .addTextSymbol (_gcfd );};_geed :=-(_gfaa ._fgee +_baeg ._aeb ._cfga );if _geed < 0{_geed =0;};_bbgb :=&symbol {_abbe :"\u0020",_efdab :_geed };_baeg .addTextSymbol (_bbgb );_baeg ._aeb ._cggd +=(_gfaa ._fgee +_gfaa ._agac );};func (_gfbg *textboxContext )assignPropsToCurrentParagraph (_dgbb *_ge .CT_TextParagraphProperties ){_ced :=12.4;if _dgbb ==nil {_gfbg ._fgd ._ddg =_ced ;return ;};if _fagb :=_dgbb .DefRPr ;_fagb !=nil {_cgfc :=_fagb .SzAttr ;if _cgfc !=nil {_bgad :=float64 (*_cgfc )/1200;if _ced <=_bgad {_ced =_bgad ;};};};if _fccd :=_dgbb .MarLAttr ;_fccd !=nil {_gfbg ._fgd ._gad =_da .FromEMU (int64 (*_fccd ));};_gfbg ._fgd ._adfd =_gfbg ._aac ;if _eef :=_dgbb .MarRAttr ;_eef !=nil {_gfbg ._fgd ._adfd -=_da .FromEMU (int64 (*_eef ));};if _fba :=_dgbb .IndentAttr ;_fba !=nil {_gfbg ._fgd ._cabe =_da .FromEMU (int64 (*_fba ));};if _cbff :=_dgbb .LatinLnBrkAttr ;_cbff !=nil {_gfbg ._fgd ._efea =*_cbff ;};if _aef :=_dgbb .LnSpc ;_aef !=nil {if _cabd :=_aef .SpcPct ;_cabd !=nil {if _cbee :=_cabd .ValAttr .ST_TextSpacingPercent ;_cbee !=nil {_ced =float64 (*_cbee )/5000;};};};var _bfbb float64 ;if _efbg :=_dgbb .SpcBef ;_efbg !=nil {if _cfbba :=_efbg .SpcPts ;_cfbba !=nil {_bfbb =float64 (_cfbba .ValAttr )/100;};};_dega :=_gfbg ._fgc ;if len (_dega )> 0{_bfbb -=_dega [len (_dega )-1]._baf ;if _bfbb < 0{_bfbb =0;};};_gfbg ._fgd ._cbcd =_bfbb ;if _dgaa :=_dgbb .SpcAft ;_dgaa !=nil {if _caaf :=_dgaa .SpcPts ;_caaf !=nil {_gfbg ._fgd ._baf =float64 (_caaf .ValAttr )/100;};};_gfbg ._fgd ._ddg =_ced ;_gfbg ._fgd ._geg =_dgbb .AlgnAttr ;};

// RegisterFontsFromDirectory registers all fonts from the given directory automatically detecting font families and styles.
func RegisterFontsFromDirectory (dirName string )error {return _gb .RegisterFontsFromDirectory (dirName )};func (_gfbf *textboxContext )addTextRun (_abgf *_ge .EG_TextRun ,_aaf *_ge .CT_TextCharacterProperties ,_daba _gf .Color ,_eedd *prefixData ){if _decf :=_abgf .Br ;_decf !=nil {_gfbf .addCurrentWordToParagraph ();_gfbf .newLine ();_gfbf .newWord ();}else if _bde :=_abgf .R ;_bde !=nil {var _faeg _gf .Color ;if _bde .RPr .SolidFill !=nil {_faeg ,_ =_gfbf ._ddeg .getColorFromSolidFill (_bde .RPr .SolidFill );}else if _daba !=nil {_faeg =_daba ;}else if _aaf .SolidFill !=nil {_faeg ,_ =_gfbf ._ddeg .getColorFromSolidFill (_aaf .SolidFill );}else {_faeg =_gf .ColorBlack ;};_acfb :=_aff (_bde .RPr ,_aaf );_eccb ,_ade ,_cfc ,_ggfeb :=_gfbf ._ddeg .makeStyleFromRPr (_acfb );_eccb .Color =_faeg ;if _eedd !=nil {_gfbf .addPrefix (_eedd ,_eccb );};_dgc :=_eac (_bde .T );for _ ,_cgge :=range _dgc {_cgge ._gcbe =_eccb ;_cgge ._gbaed =_ade ;_cgge ._gaea =_cfc ;_cgge ._cabc =_ggfeb ;if _acfb .CapAttr ==_ge .ST_TextCapsTypeAll {_cgge ._abbe =_ae .ToUpper (_cgge ._abbe );};_gfbf .addTextSymbol (_cgge );};};};