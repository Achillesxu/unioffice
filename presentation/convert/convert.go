//
// Copyright 2020 FoxyUtils ehf. All rights reserved.
//
// This is a commercial product and requires a license to operate.
// A trial license can be obtained at https://unidoc.io
//
// DO NOT EDIT: generated by unitwist Go source code obfuscator.
//
// Use of this source code is governed by the UniDoc End User License Agreement
// terms that can be accessed at https://unidoc.io/eula/

package convert ;import (_ca "bytes";_e "errors";_f "github.com/unidoc/unioffice/common/logger";_ga "github.com/unidoc/unioffice/common/tempstorage";_ef "github.com/unidoc/unioffice/internal/convertutils";_d "github.com/unidoc/unioffice/measurement";_ed "github.com/unidoc/unioffice/presentation";_fc "github.com/unidoc/unioffice/schema/soo/dml";_da "github.com/unidoc/unioffice/schema/soo/dml/chart";_ea "github.com/unidoc/unioffice/schema/soo/pml";_bf "github.com/unidoc/unipdf/v3/contentstream/draw";_dc "github.com/unidoc/unipdf/v3/creator";_b "github.com/unidoc/unipdf/v3/model";_ced "github.com/unidoc/unipdf/v3/render";_gd "image";_g "image/color";_a "image/draw";_cc "strconv";_ce "strings";);func (_gabea *textboxContext )alignVertically (_eedc _fc .ST_TextAnchoringType ){_gabea .alignParagraphsVertically (_eedc );_gabea .alignSymbolsVertically ();};func _bffa (_edde float64 )float64 {return _edde *_d .Millimeter };func (_bfffb *convertContext )renderCurrentStateToGoImage ()(_gd .Image ,error ){_gffa :=_ef .MakeTempCreator (_bfffb ._faad ,_bfffb ._fgbf );_gffa .NewPage ();for _ ,_baca :=range _bfffb ._edab {if _baca !=nil {_gffa .MoveTo (0,0);_gffa .Draw (_baca );};};_abcc ,_eedb :=_ef .GetPageFromCreator (_gffa );if _eedb !=nil {return nil ,_eedb ;};return _ced .NewImageDevice ().Render (_abcc );};type background struct{_bgg _dc .Color ;_ddca float64 ;_aebb *_fc .CT_BlipFillProperties ;};func _bbaee (_bgee *_ea .CT_CommonSlideData ,_ffef _ea .ST_PlaceholderType ,_cbg *uint32 ,_fca bool )(*_fc .CT_Transform2D ,*_fc .CT_TextBody ,*bool ,*bool ){if _bgee !=nil &&(_ffef !=_ea .ST_PlaceholderTypeUnset ||!_fca ){if _eaad :=_bgee .SpTree ;_eaad !=nil {for _ ,_bccf :=range _eaad .Choice {if _bccf !=nil {for _ ,_gcea :=range _bccf .Sp {if _gcea !=nil {_dddf ,_ggce :=_cdbg (_gcea );if _ffef ==_dddf {if (_fca &&_ggce ==nil )||(!_fca &&_ggce !=nil &&*_ggce ==*_cbg ){var _eaee *_fc .CT_Transform2D ;if _gcea .SpPr !=nil {_eaee =_gcea .SpPr .Xfrm ;};_ffacd :=_ffef ==_ea .ST_PlaceholderTypeTitle ||_ffef ==_ea .ST_PlaceholderTypeCtrTitle ;_cebdd :=!_ffacd &&_ffef !=_ea .ST_PlaceholderTypeUnset ;return _eaee ,_gcea .TxBody ,&_ffacd ,&_cebdd ;};};};};};};};};return nil ,nil ,nil ,nil ;};func (_ddda *convertContext )getStyleColors (_eac *_fc .CT_ShapeStyle )(_dc .Color ,_dc .Color ,_dc .Color ){var _dbda ,_afcf ,_dfd _dc .Color ;if _bdef :=_eac .LnRef ;_bdef !=nil {_afcf =_ddda .getColorFromMatrixReference (_bdef );};if _fdeec :=_eac .FillRef ;_fdeec !=nil {_dfd =_ddda .getColorFromMatrixReference (_fdeec );};if _dgcd :=_eac .FontRef ;_dgcd !=nil {_dbda =_ddda .getColorFromFontReference (_dgcd );};return _dbda ,_dfd ,_afcf ;};func (_cga *convertContext )makePdfDivisionFromTxBody (_fgf *_fc .CT_TextBody ,_gabe ,_eee float64 ,_cab *_fc .CT_TableStyleTextStyle )*_dc .Division {_dddd :=_cga ._fbgd .NewDivision ();_ggba :=_cga ._ecc ;_bae :=_fc .ST_TextAnchoringTypeT ;if _gdgb :=_fgf .BodyPr ;_gdgb !=nil {if _afc :=_gdgb .AnchorAttr ;_afc !=_fc .ST_TextAnchoringTypeUnset {_bae =_gdgb .AnchorAttr ;};};if _ffc :=_fgf .LstStyle ;_ffc !=nil {var _ggg *_fc .CT_TextParagraphProperties ;if _ffc .Lvl1pPr !=nil {_ggg =_ffc .Lvl1pPr ;}else {_ggg =_cga ._gfac [0];};_ggba =_bfff (_ggg ,_bfff (_ffc .DefPPr ,_ggba ));};for _ ,_deed :=range _fgf .P {if _deed !=nil {_gaaf :=_cga ._fbgd .NewStyledParagraph ();_cedgg :=_bfff (_deed .PPr ,_ggba );_abba :=_bbad (_deed .EndParaRPr ,_cedgg .DefRPr );if len (_deed .EG_TextRun )==0{_gaaf .Append ("\u000a");_dddd .Add (_gaaf );continue ;};for _ ,_eafb :=range _deed .EG_TextRun {if _aba :=_eafb .Br ;_aba !=nil {_gaaf .Append ("\u000a");}else if _ead :=_eafb .R ;_ead !=nil {_gdf :=_efag (_ead .RPr ,_cab );_gdf =_bbad (_gdf ,_abba );var _deede _dc .Color ;if _gdf .SolidFill !=nil {_deede ,_ =_cga .getColorFromSolidFill (_gdf .SolidFill );}else {_deede =_dc .ColorBlack ;};_dcb ,_abf ,_bffc ,_ :=_cga .makeStyleFromRPr (_gdf );_dcb .Color =_deede ;if _abf {_dcb .TextRise =0.5;}else if _bffc {_dcb .TextRise =-0.5;};_fgd :=_ead .T ;if _gdf .CapAttr ==_fc .ST_TextCapsTypeAll {for _ ,_bfb :=range _fgd {_bfb =[]rune (_ce .ToUpper (string (_bfb )))[0];};};_efc :=_gaaf .Append (_fgd );_efc .Style =*_dcb ;};};_ =_bae ;_dddd .Add (_gaaf );};};return _dddd ;};func (_acbc *textboxContext )addPrefix (_bac *prefixData ,_dffe *_dc .TextStyle ){_ebbf :=_bfdg (_bac ._cgfa );_gcff :=*_dffe ;if _bac ._begb {_gcff .Font =_ef .AssignStdFontByName (_gcff ,"\u0053\u0079\u006d\u0062\u006f\u006c");};for _ ,_gcdaf :=range _ebbf {_gcdaf ._gaac =&_gcff ;_acbc .addTextSymbol (_gcdaf );};_fac :=-(_bac ._dgbd +_acbc ._cfbe ._geb );if _fac < 0{_fac =0;};_geefe :=&symbol {_abce :"\u0020",_aeeb :_fac };_acbc .addTextSymbol (_geefe );_acbc ._cfbe ._bcag +=(_bac ._dgbd +_bac ._cecg );};func (_daf *convertContext )extractDefaultProperties (){_df :=_daf ._ddad .X ();_ge :=_df .DefaultTextStyle ;var _gf ,_geg ,_gaa ,_cedf ,_fgb ,_ccc ,_bbd ,_fa ,_fec ,_dec *_fc .CT_TextParagraphProperties ;if _ge !=nil {_gf =_ge .DefPPr ;_geg =_bfff (_ge .Lvl1pPr ,_gf );_gaa =_bfff (_ge .Lvl2pPr ,_gf );_cedf =_bfff (_ge .Lvl3pPr ,_gf );_fgb =_bfff (_ge .Lvl4pPr ,_gf );_ccc =_bfff (_ge .Lvl5pPr ,_gf );_bbd =_bfff (_ge .Lvl6pPr ,_gf );_fa =_bfff (_ge .Lvl7pPr ,_gf );_fec =_bfff (_ge .Lvl8pPr ,_gf );_dec =_bfff (_ge .Lvl9pPr ,_gf );_daf ._ecc =_gf ;_daf ._dad =_gf .DefRPr ;};_daf ._gfac =make ([]*_fc .CT_TextParagraphProperties ,9);_daf ._gfac [0]=_geg ;_daf ._gfac [1]=_gaa ;_daf ._gfac [2]=_cedf ;_daf ._gfac [3]=_fgb ;_daf ._gfac [4]=_ccc ;_daf ._gfac [5]=_bbd ;_daf ._gfac [6]=_fa ;_daf ._gfac [7]=_fec ;_daf ._gfac [8]=_dec ;_cf :=_daf ._ddad .SlideMasters ()[0].X ();_ebb :=_cf .TxStyles ;_cccb :=_ebb .TitleStyle ;_daf ._egga =_bfff (_cccb .DefPPr ,_gf );_daf ._cdce =_daf ._egga .DefRPr ;_daf ._bgdab =make ([]*_fc .CT_TextParagraphProperties ,9);_daf ._bgdab [0]=_bfff (_cccb .Lvl1pPr ,_geg );_daf ._bgdab [1]=_bfff (_cccb .Lvl2pPr ,_gaa );_daf ._bgdab [2]=_bfff (_cccb .Lvl3pPr ,_cedf );_daf ._bgdab [3]=_bfff (_cccb .Lvl4pPr ,_fgb );_daf ._bgdab [4]=_bfff (_cccb .Lvl5pPr ,_ccc );_daf ._bgdab [5]=_bfff (_cccb .Lvl6pPr ,_bbd );_daf ._bgdab [6]=_bfff (_cccb .Lvl7pPr ,_fa );_daf ._bgdab [7]=_bfff (_cccb .Lvl8pPr ,_fec );_daf ._bgdab [8]=_bfff (_cccb .Lvl9pPr ,_dec );_ff :=_ebb .BodyStyle ;_daf ._bcb =_bfff (_ff .DefPPr ,_gf );_daf ._eaff =_daf ._bcb .DefRPr ;_daf ._efg =make ([]*_fc .CT_TextParagraphProperties ,9);_daf ._efg [0]=_bfff (_ff .Lvl1pPr ,_geg );_daf ._efg [1]=_bfff (_ff .Lvl2pPr ,_gaa );_daf ._efg [2]=_bfff (_ff .Lvl3pPr ,_cedf );_daf ._efg [3]=_bfff (_ff .Lvl4pPr ,_fgb );_daf ._efg [4]=_bfff (_ff .Lvl5pPr ,_ccc );_daf ._efg [5]=_bfff (_ff .Lvl6pPr ,_bbd );_daf ._efg [6]=_bfff (_ff .Lvl7pPr ,_fa );_daf ._efg [7]=_bfff (_ff .Lvl8pPr ,_fec );_daf ._efg [8]=_bfff (_ff .Lvl9pPr ,_dec );};var _fcb =[]romanMatch {romanMatch {1000,"\u006d"},romanMatch {900,"\u0063\u006d"},romanMatch {500,"\u0064"},romanMatch {400,"\u0063\u0064"},romanMatch {100,"\u0063"},romanMatch {90,"\u0078\u0063"},romanMatch {50,"\u006c"},romanMatch {40,"\u0078\u006c"},romanMatch {10,"\u0078"},romanMatch {9,"\u0069\u0078"},romanMatch {5,"\u0076"},romanMatch {4,"\u0069\u0076"},romanMatch {1,"\u0069"}};func (_acac *textboxContext )newWord (){_acac ._cfbe =&word {_bfbd :true ,_bcag :_acac ._cbbf ._agfb }};func _gbe (_eagag *bool )bool {return _eagag !=nil &&*_eagag };

// RegisterFont makes a PdfFont accessible for using in converting to PDF.
func RegisterFont (name string ,style FontStyle ,font *_b .PdfFont ){_ef .RegisterFont (name ,style ,font );};func (_edd *convertContext )getConnectors (_cde *_ea .CT_Connector )[]_dc .Drawable {_cdg ,_ ,_ ,_ ,_ ,_ ,_ :=_edd .getShapesFromSpPr (_cde .SpPr ,_cde .Style ,false );return _cdg ;};func (_gede *textboxContext )addTextSymbol (_ccee *symbol ){_fgeb :=_dc .New ();_ffbf :=_fgeb .NewStyledParagraph ();_ffbf .SetMargins (0,0,0,0);_fbba :=_ffbf .Append (_ccee ._abce );_abeg :=0.0;if _ccee ._gaac !=nil {_fbba .Style =*_ccee ._gaac ;if _ccee ._gaac .CharSpacing !=0{_abeg =_ccee ._gaac .CharSpacing ;};};_ccee ._bdb =_ffbf .Height ();_ccee ._cdf =_ffbf .Height ()*1.2;if _ccee ._cdf < _gede ._fbb ._ace {_ccee ._cdf =_gede ._fbb ._ace ;};if _ccee ._aeeb ==0{_ccee ._aeeb =_ffbf .Width ()+_abeg ;};if len (_gede ._cfbe ._dffb )> 0{_babe :=_gede ._cfbe ._dffb [len (_gede ._cfbe ._dffb )-1]._abce ;if _gede ._fbb ._dgac ||_ef .IsNoSpaceLanguage (_babe )||(_babe =="\u0020")!=(_ccee ._abce =="\u0020"){_gede .addCurrentWordToParagraph ();_gede .newWord ();};};_gede ._cfbe ._dffb =append (_gede ._cfbe ._dffb ,_ccee );_ccee ._ffb =_gede ._cfbe ._geb ;_gede ._cfbe ._geb +=_ccee ._aeeb ;if _ccee ._abce !="\u0020"{_gede ._cfbe ._bfbd =false ;};};func _bfdg (_cccc string )[]*symbol {_ffea :=[]*symbol {};for _ ,_ccf :=range _cccc {_ffea =append (_ffea ,&symbol {_abce :string (_ccf )});};return _ffea ;};type line struct{_dfbf float64 ;_cac float64 ;_fbfe float64 ;_agfb float64 ;_fdeea float64 ;_gabg []*word ;};func (_acg *textboxContext )newLine (){if _acg ._fbb ==nil {_acg .newParagraph ();};_acff :=_acg ._fbb ._eeed +_acg ._fbb ._gea ;_afdg :=&line {};_afdg ._cac =_acg ._fbb ._aefb ;if len (_acg ._fbb ._gegc )==0{_afdg ._cac +=_acg ._fbb ._cafb ;};_afdg ._fbfe =_acg ._fbb ._dbce ;_afdg ._agfb =_afdg ._cac ;_afdg ._dfbf =_acff ;_acg ._fbb ._gegc =append (_acg ._fbb ._gegc ,_afdg );_acg ._cbbf =_afdg ;};func _aggef (_eebc ,_cbfc *_fc .CT_TextBodyProperties )*_fc .CT_TextBodyProperties {_fgcc :=_fc .NewCT_TextBodyProperties ();if _eebc !=nil {*_fgcc =*_eebc ;};if _cbfc ==nil {return _fgcc ;};if _fgcc .RotAttr ==nil {_fgcc .RotAttr =_cbfc .RotAttr ;};if _fgcc .SpcFirstLastParaAttr ==nil {_fgcc .SpcFirstLastParaAttr =_cbfc .SpcFirstLastParaAttr ;};if _fgcc .VertOverflowAttr ==_fc .ST_TextVertOverflowTypeUnset {_fgcc .VertOverflowAttr =_cbfc .VertOverflowAttr ;};if _fgcc .HorzOverflowAttr ==_fc .ST_TextHorzOverflowTypeUnset {_fgcc .HorzOverflowAttr =_cbfc .HorzOverflowAttr ;};if _fgcc .VertAttr ==_fc .ST_TextVerticalTypeUnset {_fgcc .VertAttr =_cbfc .VertAttr ;};if _fgcc .WrapAttr ==_fc .ST_TextWrappingTypeUnset {_fgcc .WrapAttr =_cbfc .WrapAttr ;};if _fgcc .LInsAttr ==nil {_fgcc .LInsAttr =_cbfc .LInsAttr ;};if _fgcc .TInsAttr ==nil {_fgcc .TInsAttr =_cbfc .TInsAttr ;};if _fgcc .RInsAttr ==nil {_fgcc .RInsAttr =_cbfc .RInsAttr ;};if _fgcc .BInsAttr ==nil {_fgcc .BInsAttr =_cbfc .BInsAttr ;};if _fgcc .NumColAttr ==nil {_fgcc .NumColAttr =_cbfc .NumColAttr ;};if _fgcc .SpcColAttr ==nil {_fgcc .SpcColAttr =_cbfc .SpcColAttr ;};if _fgcc .RtlColAttr ==nil {_fgcc .RtlColAttr =_cbfc .RtlColAttr ;};if _fgcc .AnchorAttr ==_fc .ST_TextAnchoringTypeUnset {_fgcc .AnchorAttr =_cbfc .AnchorAttr ;};if _fgcc .AnchorCtrAttr ==nil {_fgcc .AnchorCtrAttr =_cbfc .AnchorCtrAttr ;};if _fgcc .ForceAAAttr ==nil {_fgcc .ForceAAAttr =_cbfc .ForceAAAttr ;};if _fgcc .UprightAttr ==nil {_fgcc .UprightAttr =_cbfc .UprightAttr ;};if _fgcc .CompatLnSpcAttr ==nil {_fgcc .CompatLnSpcAttr =_cbfc .CompatLnSpcAttr ;};if _fgcc .PrstTxWarp ==nil {_fgcc .PrstTxWarp =_cbfc .PrstTxWarp ;};if _fgcc .NoAutofit ==nil {_fgcc .NoAutofit =_cbfc .NoAutofit ;};if _fgcc .NormAutofit ==nil {_fgcc .NormAutofit =_cbfc .NormAutofit ;};if _fgcc .SpAutoFit ==nil {_fgcc .SpAutoFit =_cbfc .SpAutoFit ;};if _fgcc .Scene3d ==nil {_fgcc .Scene3d =_cbfc .Scene3d ;};if _fgcc .Sp3d ==nil {_fgcc .Sp3d =_cbfc .Sp3d ;};if _fgcc .FlatTx ==nil {_fgcc .FlatTx =_cbfc .FlatTx ;};if _fgcc .ExtLst ==nil {_fgcc .ExtLst =_cbfc .ExtLst ;};return _fgcc ;};type prefixData struct{_cgfa string ;_begb bool ;_cecg float64 ;_dgbd float64 ;};func (_aaf *convertContext )makePdfBlockFromTxBody (_acf *_fc .CT_TextBody ,_deee *_fc .CT_TextBodyProperties ,_bgda *_fc .CT_TextListStyle ,_eed ,_fagf float64 ,_eggf _dc .Color ,_feeb ,_ege bool )(*_dc .Block ,error ){var _dbg *_fc .CT_TextParagraphProperties ;if _cce :=_acf .LstStyle ;_cce !=nil {var _cdeb *_fc .CT_TextParagraphProperties ;if _cce .Lvl1pPr !=nil {_cdeb =_cce .Lvl1pPr ;};_dbg =_bfff (_cdeb ,_cce .DefPPr );};var _ccca *_fc .CT_TextParagraphProperties ;if _dbg !=nil {if _feeb {_ccca =_aaf ._bgdab [0];}else if _ege {_ccca =_aaf ._efg [0];}else {_ccca =_aaf ._gfac [0];};if _bgda !=nil {_ccca =_bfff (_bfff (_bgda .Lvl1pPr ,_bgda .DefPPr ),_ccca );};_ccca =_bfff (_dbg ,_ccca );}else {if _feeb {_ccca =_aaf ._egga ;}else if _ege {_ccca =_aaf ._bcb ;}else {_ccca =_aaf ._ecc ;};};_ffa ,_fgcf :=_bffa (2.5),_bffa (2.5);_gfad ,_fcgc :=_bffa (1.3),_bffa (1.3);_gcg :=true ;_gfcd :=_fc .ST_TextAnchoringTypeT ;if _deee !=nil {if _cdaf :=_deee .AnchorAttr ;_cdaf !=_fc .ST_TextAnchoringTypeUnset {_gfcd =_cdaf ;};};if _aafg :=_acf .BodyPr ;_aafg !=nil {if _ded :=_aafg .LInsAttr ;_ded !=nil {_ffa =_d .FromEMU (_ef .FromSTCoordinate32 (*_ded ));};if _bbf :=_aafg .TInsAttr ;_bbf !=nil {_gfad =_d .FromEMU (_ef .FromSTCoordinate32 (*_bbf ));};if _cff :=_aafg .RInsAttr ;_cff !=nil {_fgcf =_d .FromEMU (_ef .FromSTCoordinate32 (*_cff ));};if _bab :=_aafg .BInsAttr ;_bab !=nil {_fcgc =_d .FromEMU (_ef .FromSTCoordinate32 (*_bab ));};_gcg =_aafg .WrapAttr !=_fc .ST_TextWrappingTypeNone ;if _dbe :=_aafg .AnchorAttr ;_dbe !=_fc .ST_TextAnchoringTypeUnset {_gfcd =_aafg .AnchorAttr ;};};_cgb :=_ef .MakeTempCreator (_eed ,_fagf );_cgb .SetPageMargins (_ffa ,_fgcf ,_gfad ,_fcgc );_fdb :=&textboxContext {_bfee :_aaf ,_aaa :_gcg ,_edbd :_eed -_ffa -_fgcf ,_fcc :_fagf -_gfad -_fcgc ,_faaf :_cgb ,_gfacc :[]*paragraph {}};_feef :=1;for _ ,_fagd :=range _acf .P {if _fagd !=nil {_cgde :=_fagd .PPr ;var _ddf *prefixData ;if _cgde !=nil &&_cgde .BuNone ==nil {var _gaga string ;var _gdfg bool ;if _bef :=_cgde .BuAutoNum ;_bef !=nil {var _cecc string ;if _acc :=_bef .StartAtAttr ;_acc !=nil {_feef =int (*_acc );};var _adcc string ;switch _bef .TypeAttr {case _fc .ST_TextAutonumberSchemeAlphaUcParenBoth ,_fc .ST_TextAutonumberSchemeAlphaUcParenR ,_fc .ST_TextAutonumberSchemeAlphaUcPeriod :_adcc =_acb (_feef ,true );case _fc .ST_TextAutonumberSchemeAlphaLcParenBoth ,_fc .ST_TextAutonumberSchemeAlphaLcParenR ,_fc .ST_TextAutonumberSchemeAlphaLcPeriod :_adcc =_acb (_feef ,false );case _fc .ST_TextAutonumberSchemeRomanUcParenBoth ,_fc .ST_TextAutonumberSchemeRomanUcParenR ,_fc .ST_TextAutonumberSchemeRomanUcPeriod :_adcc =_aceg (_feef ,true );case _fc .ST_TextAutonumberSchemeRomanLcParenBoth ,_fc .ST_TextAutonumberSchemeRomanLcParenR ,_fc .ST_TextAutonumberSchemeRomanLcPeriod :_adcc =_aceg (_feef ,false );default:_adcc =_cc .Itoa (_feef );};switch _bef .TypeAttr {case _fc .ST_TextAutonumberSchemeAlphaLcPeriod ,_fc .ST_TextAutonumberSchemeAlphaUcPeriod ,_fc .ST_TextAutonumberSchemeArabicPeriod ,_fc .ST_TextAutonumberSchemeRomanLcPeriod ,_fc .ST_TextAutonumberSchemeRomanUcPeriod ,_fc .ST_TextAutonumberSchemeArabicDbPeriod ,_fc .ST_TextAutonumberSchemeEa1ChsPeriod ,_fc .ST_TextAutonumberSchemeEa1ChtPeriod ,_fc .ST_TextAutonumberSchemeEa1JpnChsDbPeriod ,_fc .ST_TextAutonumberSchemeEa1JpnKorPeriod ,_fc .ST_TextAutonumberSchemeThaiAlphaPeriod ,_fc .ST_TextAutonumberSchemeThaiNumPeriod ,_fc .ST_TextAutonumberSchemeHindiAlphaPeriod ,_fc .ST_TextAutonumberSchemeHindiNumPeriod ,_fc .ST_TextAutonumberSchemeHindiAlpha1Period :_cecc ="\u002e";case _fc .ST_TextAutonumberSchemeAlphaLcParenR ,_fc .ST_TextAutonumberSchemeAlphaUcParenR ,_fc .ST_TextAutonumberSchemeArabicParenR ,_fc .ST_TextAutonumberSchemeRomanLcParenR ,_fc .ST_TextAutonumberSchemeRomanUcParenR ,_fc .ST_TextAutonumberSchemeThaiAlphaParenR ,_fc .ST_TextAutonumberSchemeThaiNumParenR ,_fc .ST_TextAutonumberSchemeHindiNumParenR :_cecc ="\u0029";};_gaga =_adcc +_cecc ;_feef ++;}else if _bffd :=_cgde .BuChar ;_bffd !=nil {_edb :=_bffd .CharAttr ;if _agf ,_afg :=_cede [_edb ];_afg {_edb =string (rune (_agf ));}else {_edb ="\u2022";};_gaga =_edb ;_gdfg =true ;};if _gaga !=""{var _eag ,_bbb float64 ;if _cgde .MarLAttr !=nil {_eag =_d .FromEMU (int64 (*_cgde .MarLAttr ));};if _cgde .IndentAttr !=nil {_bbb =_d .FromEMU (int64 (*_cgde .IndentAttr ));};_ddf =&prefixData {_cgfa :_gaga ,_begb :_gdfg ,_cecg :_eag ,_dgbd :_bbb };};};_cgde =_bfff (_cgde ,_ccca );_eeeb :=_bbad (_fagd .EndParaRPr ,_cgde .DefRPr );_fdb .newParagraph ();_fdb .assignPropsToCurrentParagraph (_cgde );_fdb .newLine ();_fdb .newWord ();for _fdbd ,_dga :=range _fagd .EG_TextRun {_fdb .addTextRun (_dga ,_eeeb ,_eggf ,_ddf );if _fdbd > 0{_ddf =nil ;};};_fdb .addCurrentWordToParagraph ();};_fdb .addCurrentParagraph ();};_fdb .alignVertically (_gfcd );_fdb .drawParagraphs ();return _ef .MakeBlockFromCreator (_cgb );};func (_ffg *convertContext )getShapes (_cgc *_ea .CT_Shape )[]_dc .Drawable {_ged :=[]_dc .Drawable {};_aca :=_cgc .SpPr ;if _aca ==nil {return _ged ;};var _ffeb bool ;if _fgg :=_cgc .UseBgFillAttr ;_fgg !=nil {_ffeb =*_fgg ;};_cec ,_ebbb ,_def ,_defe ,_ba ,_fb ,_beg :=_ffg .getShapesFromSpPr (_aca ,_cgc .Style ,_ffeb );_ged =append (_ged ,_cec ...);if _eaac :=_cgc .TxBody ;_eaac !=nil {_bcc ,_ggb ,_cega ,_gbdd ,_cbe :=_ffg .getPhData (_cgc );if _bcc !=nil &&!_beg {_ebbb ,_def ,_defe ,_ba =_ef .GetDataFromXfrm (_bcc );};_fggg ,_eeb :=_ffg .makePdfBlockFromTxBody (_eaac ,_ggb ,_cega ,_defe ,_ba ,_fb ,_gbdd ,_cbe );if _eeb !=nil {_f .Log .Debug ("\u0043\u0061\u006e\u006e\u006f\u0074\u0020\u006d\u0061\u006b\u0065\u0020\u0050\u0044\u0046\u0020\u0062\u006c\u006f\u0063\u006b\u0020\u0066\u0072o\u006d\u0020\u0074\u0065\u0078t\u0062\u006fx\u003a\u0020\u0025\u0073",_eeb );}else if _fggg !=nil {_fggg .SetPos (_ebbb ,_def );_ged =append (_ged ,_fggg );};};return _ged ;};func _cdbg (_adde *_ea .CT_Shape )(_ea .ST_PlaceholderType ,*uint32 ){if _gdfbb :=_adde .NvSpPr ;_gdfbb !=nil {if _cdge :=_gdfbb .NvPr ;_cdge !=nil {if _gcfg :=_cdge .Ph ;_gcfg !=nil {return _gcfg .TypeAttr ,_gcfg .IdxAttr ;};};};return _ea .ST_PlaceholderTypeUnset ,nil ;};func _aceg (_ecdf int ,_cdda bool )string {_fedg :=_ca .NewBuffer ([]byte {});for _ ,_bgae :=range _fcb {for {if _ecdf < _bgae ._dbd {break ;};_fedg .WriteString (_bgae ._bdd );_ecdf -=_bgae ._dbd ;};};_gbcc :=_fedg .String ();if _cdda {_gbcc =_ce .ToUpper (_gbcc );};return _gbcc ;};func (_dddde *textboxContext )newParagraph (){_gcda :=&paragraph {};_gcda ._dgba =_dddde ._agee ;_dddde ._fbb =_gcda ;};func (_fbee *convertContext )addCellToTable (_bfc *_dc .Table ,_gbde *_fc .CT_TableCell ,_acfg *_fc .CT_TablePartStyle ,_dbc float64 ,_fbg ,_gde ,_fdbc ,_gce bool )float64 {var _ccfa *_dc .TableCell ;_ffebb :=1;if _gbde .GridSpanAttr !=nil {_ffebb =int (*_gbde .GridSpanAttr );};_ccfa =_bfc .MultiColCell (_ffebb );_ffgf :=_gbde .TcPr ;var _fecc *_fc .CT_TableStyleTextStyle ;if _acfg !=nil {_ffgf =_ageb (_ffgf ,_acfg .TcStyle ,_fbg ,_gde ,_fdbc ,_gce );_fecc =_acfg .TcTxStyle ;};_caaf :=_dg ;_cfc :=_dc .CellVerticalAlignmentMiddle ;if _ffgf !=nil {if _abbc :=_ffgf .LnL ;_abbc !=nil {_dacg ,_cgf ,_ccd :=_fbee .getBorderStyle (_abbc );_ccfa .SetBorder (_dc .CellBorderSideLeft ,_dacg ,_ccd );if _cgf !=nil &&*_cgf !=nil {_ccfa .SetSideBorderColor (_dc .CellBorderSideLeft ,*_cgf );};};if _bcf :=_ffgf .LnT ;_bcf !=nil {_fge ,_gcf ,_eaaa :=_fbee .getBorderStyle (_bcf );_ccfa .SetBorder (_dc .CellBorderSideTop ,_fge ,_eaaa );if _gcf !=nil &&*_gcf !=nil {_ccfa .SetSideBorderColor (_dc .CellBorderSideTop ,*_gcf );};};if _dde :=_ffgf .LnR ;_dde !=nil {_ccb ,_eaaaa ,_dacf :=_fbee .getBorderStyle (_dde );_ccfa .SetBorder (_dc .CellBorderSideRight ,_ccb ,_dacf );if _eaaaa !=nil &&*_eaaaa !=nil {_ccfa .SetSideBorderColor (_dc .CellBorderSideRight ,*_eaaaa );};};if _cfg :=_ffgf .LnB ;_cfg !=nil {_acfge ,_dcfe ,_fcfg :=_fbee .getBorderStyle (_cfg );_ccfa .SetBorder (_dc .CellBorderSideBottom ,_acfge ,_fcfg );if _dcfe !=nil &&*_dcfe !=nil {_ccfa .SetSideBorderColor (_dc .CellBorderSideBottom ,*_dcfe );};};if _fda :=_ffgf .MarLAttr ;_fda !=nil {_caaf =float64 (_ef .FromSTCoordinate32 (*_fda ));};switch _ffgf .AnchorAttr {case _fc .ST_TextAnchoringTypeT :_cfc =_dc .CellVerticalAlignmentTop ;case _fc .ST_TextAnchoringTypeB :_cfc =_dc .CellVerticalAlignmentBottom ;};if _ffgf .NoFill ==nil {if _gbga :=_ffgf .SolidFill ;_gbga !=nil {_bee ,_ :=_fbee .getColorFromSolidFill (_gbga );_ccfa .SetBackgroundColor (_bee );};};};_ccfa .SetVerticalAlignment (_cfc );_ccfa .SetIndent (_caaf );var _dcag float64 ;if _ddb :=_gbde .TxBody ;_ddb !=nil {_cfdb :=_fbee .makePdfDivisionFromTxBody (_ddb ,_dbc ,_dcag ,_fecc );_dcag =_cfdb .Height ();_ccfa .SetContent (_cfdb );};return _dcag ;};

// FontStyle represents a kind of font styling. It can be FontStyle_Regular, FontStyle_Bold, FontStyle_Italic and FontStyle_BoldItalic.
type FontStyle =_ef .FontStyle ;func (_afd *convertContext )stretchImage (_aeba *_dc .Image ,_cedc *_fc .CT_StretchInfoProperties ,_aee ,_ceg ,_ffe ,_afeb float64 )(*_dc .Image ,float64 ,float64 ){_eaf :=_cedc .FillRect ;if _eaf ==nil {_gcdd :=_aeba .Width ()/_aeba .Height ();_edf :=_ffe /_afeb ;var _ecd ,_cedg float64 ;if _gcdd > _edf {_cedg =_afeb ;_ecd =_afeb *_gcdd ;}else {_ecd =_ffe ;_cedg =_ffe /_gcdd ;};_aeba .Scale (_ecd /_aeba .Width (),_cedg /_aeba .Height ());return _aeba ,_aee ,_ceg ;};var _dgf ,_dac ,_bfe ,_dcf float64 ;if _deb :=_eaf .LAttr ;_deb !=nil {_bfe =_ef .FromSTPercentage (_deb );};if _dfa :=_eaf .TAttr ;_dfa !=nil {_dgf =_ef .FromSTPercentage (_dfa );};if _bdg :=_eaf .RAttr ;_bdg !=nil {_dcf =_ef .FromSTPercentage (_bdg );};if _bca :=_eaf .BAttr ;_bca !=nil {_dac =_ef .FromSTPercentage (_bca );};_ee :=_ffe *(1-_bfe -_dcf );_afa :=_afeb *(1-_dgf -_dac );_aeba .Scale (_ee /_aeba .Width (),_afa /_aeba .Height ());return _aeba ,_aee +_bfe *_ffe ,_ceg +_dgf *_afeb ;};func (_fdc *convertContext )getColorFromSolidFill (_cffb *_fc .CT_SolidColorFillProperties )(_dc .Color ,float64 ){if _cffb ==nil {return nil ,1;};var _gbgfe string ;_fbbb :=1.0;if _gagb :=_cffb .SrgbClr ;_gagb !=nil {_gbgfe =_gagb .ValAttr ;_fbbb =_ef .GetOpacityFromColorTransform (_gagb .EG_ColorTransform );}else if _acgd :=_cffb .SchemeClr ;_acgd !=nil {_gbgfe =_ef .GetColorStringFromDmlColor (_fdc ._ddbg .GetColorBySchemeColor (_acgd .ValAttr ));_gbgfe =_ef .AdjustColor (_gbgfe ,_acgd .EG_ColorTransform );_fbbb =_ef .GetOpacityFromColorTransform (_acgd .EG_ColorTransform );};if _gbgfe !=""{_gagga :=_dc .ColorRGBFromHex ("\u0023"+_gbgfe );return _gagga ,_fbbb ;};return nil ,1;};const (FontStyle_Regular FontStyle =0;FontStyle_Bold FontStyle =1;FontStyle_Italic FontStyle =2;FontStyle_BoldItalic FontStyle =3;);func _bcgd (_bbg ,_adb *_fc .CT_TextListStyle )*_fc .CT_TextListStyle {_bdgb :=_fc .NewCT_TextListStyle ();if _bbg !=nil {*_bdgb =*_bbg ;};if _adb ==nil {return _bdgb ;};_bdgb .DefPPr =_bfff (_bdgb .DefPPr ,_adb .DefPPr );_bdgb .Lvl1pPr =_bfff (_bdgb .Lvl1pPr ,_adb .Lvl1pPr );_bdgb .Lvl2pPr =_bfff (_bdgb .Lvl2pPr ,_adb .Lvl2pPr );_bdgb .Lvl3pPr =_bfff (_bdgb .Lvl3pPr ,_adb .Lvl3pPr );_bdgb .Lvl4pPr =_bfff (_bdgb .Lvl4pPr ,_adb .Lvl4pPr );_bdgb .Lvl5pPr =_bfff (_bdgb .Lvl5pPr ,_adb .Lvl5pPr );_bdgb .Lvl6pPr =_bfff (_bdgb .Lvl6pPr ,_adb .Lvl6pPr );_bdgb .Lvl7pPr =_bfff (_bdgb .Lvl7pPr ,_adb .Lvl7pPr );_bdgb .Lvl8pPr =_bfff (_bdgb .Lvl8pPr ,_adb .Lvl8pPr );_bdgb .Lvl9pPr =_bfff (_bdgb .Lvl9pPr ,_adb .Lvl9pPr );return _bdgb ;};var _dg =_bffa (1.9);func (_bcfc *textboxContext )drawParagraphs (){_bcfc ._faaf .NewPage ();for _ ,_ecbc :=range _bcfc ._gfacc {for _ ,_eec :=range _ecbc ._gegc {for _ ,_gggg :=range _eec ._gabg {for _ ,_gdeb :=range _gggg ._dffb {_fgab :=_bcfc ._faaf .NewStyledParagraph ();if _gdeb ._bgdg {_gdeb ._eeda =0;}else if _gdeb ._egeg {_gdeb ._eeda =1.2*_eec ._fdeea -_gdeb ._bdb ;};_cabf :=_gggg ._bcag +_gdeb ._ffb ;_efafd :=_ecbc ._dgba +_eec ._dfbf +_gdeb ._eeda ;_fgab .SetPos (_cabf ,_efafd );_facg :=_fgab .Append (_gdeb ._abce );if _gdeb ._gaac !=nil {_facg .Style =*_gdeb ._gaac ;};_bcfc ._faaf .Draw (_fgab );if _gdeb ._gbf {_gae :=_efafd +_gdeb ._bdb +2;_ef .DrawLine (_bcfc ._faaf ,_cabf ,_gae ,_cabf +_gdeb ._aeeb ,_gae ,1,_gdeb ._gaac .Color );};};};};};};func (_eggc *textboxContext )alignParagraph (){_fccca :=_eggc ._fbb ;if _fccca ._bdea ==_fc .ST_TextAlignTypeL {return ;};_eae :=len (_fccca ._gegc )-1;for _dabc ,_geab :=range _fccca ._gegc {_bbfe :=true ;_ddbe :=len (_geab ._gabg );_cgdg :=0.0;for _aacf :=len (_geab ._gabg )-1;_aacf >=0;_aacf --{_gagd :=_geab ._gabg [_aacf ];if _bbfe &&_gagd ._bfbd {_ddbe =_aacf ;}else {_bbfe =false ;for _ ,_efgd :=range _gagd ._dffb {_cgdg +=_efgd ._aeeb ;};};};_geab ._gabg =_geab ._gabg [:_ddbe ];_ggee :=_geab ._fbfe -_geab ._cac -_cgdg ;switch _fccca ._bdea {case _fc .ST_TextAlignTypeR :_geab .moveRight (_ggee );case _fc .ST_TextAlignTypeCtr :_geab .moveRight (_ggee /2);case _fc .ST_TextAlignTypeJust :if _dabc !=_eae {_dfec :=[]*word {};for _ ,_gaf :=range _geab ._gabg {if _gaf ._bfbd {_dfec =append (_dfec ,_gaf );};};_ecbg :=_ggee /float64 (len (_dfec ));for _ ,_cef :=range _dfec {_cef ._geb +=_ecbg ;};var _bcg *word ;for _ ,_daag :=range _geab ._gabg {if _bcg !=nil {_daag ._bcag =_bcg ._bcag +_bcg ._geb ;};_bcg =_daag ;};};};};};func (_cfbc *textboxContext )adjustHeights (_cdea float64 ){if _cfbc ._cbbf ._fdeea < _cdea {_cfbc ._fbb ._eeed +=(_cdea -_cfbc ._cbbf ._fdeea );_cfbc ._cbbf ._fdeea =_cdea ;};};

// RegisterFontsFromDirectory registers all fonts from the given directory automatically detecting font families and styles.
func RegisterFontsFromDirectory (dirName string )error {return _ef .RegisterFontsFromDirectory (dirName )};func (_efab *convertContext )getColorFromMatrixReference (_cebc *_fc .CT_StyleMatrixReference )_dc .Color {if _cebc ==nil {return nil ;};var _ffbfb _dc .Color ;var _aaaba string ;if _adae :=_cebc .SrgbClr ;_adae !=nil {_aaaba =_adae .ValAttr ;}else if _affe :=_cebc .SchemeClr ;_affe !=nil {_aaaba =_ef .GetColorStringFromDmlColor (_efab ._ddad .GetColorBySchemeColor (_affe .ValAttr ));_aaaba =_ef .AdjustColor (_aaaba ,_affe .EG_ColorTransform );};if _aaaba !=""{_ffbfb =_dc .ColorRGBFromHex ("\u0023"+_aaaba );};return _ffbfb ;};func (_fbfa *textboxContext )addCurrentParagraph (){_fbfa ._agee =_fbfa ._fbb ._dgba +_fbfa ._fbb ._gea +_fbfa ._fbb ._eeed +_fbfa ._fbb ._afba ;_fbfa ._gfacc =append (_fbfa ._gfacc ,_fbfa ._fbb );_fbfa .alignParagraph ();};func (_fde *convertContext )tileImage (_fee *_dc .Image ,_bbcf *_fc .CT_TileInfoProperties ,_dgg ,_egb float64 )*_dc .Image {_gfa ,_gcd :=1.0,1.0;if _ad :=_bbcf .SxAttr ;_ad !=nil {_gfa =_ef .FromSTPercentage (_ad );};if _cgg :=_bbcf .SyAttr ;_cgg !=nil {_gcd =_ef .FromSTPercentage (_cgg );};_ade :=_ef .MakeTempCreator (_dgg ,_egb );_fee .Scale (_gfa ,_gcd );_aef ,_gegb :=_fee .Width (),_fee .Height ();var _deg ,_afe float64 ;if _dda :=_bbcf .TxAttr ;_dda !=nil {_deg =_d .FromEMU (_ef .FromSTCoordinate (*_dda ));};if _cdaa :=_bbcf .TyAttr ;_cdaa !=nil {_afe =_d .FromEMU (_ef .FromSTCoordinate (*_cdaa ));};if _deg > 0{_deg -=_aef ;};if _afe > 0{_afe -=_gegb ;};_ddd :=_fde ._faad /_aef +1;_efd :=_fde ._fgbf /_gegb +1;for _fga :=0.0;_fga <=_ddd ;_fga ++{_gg :=_fga *_aef ;for _deeb :=0.0;_deeb <=_efd ;_deeb ++{_fgc :=_deeb *_gegb ;_fee .SetPos (_gg +_deg ,_fgc +_afe );_ade .Draw (_fee );};};_efa ,_bec :=_ef .GetPageFromCreator (_ade );if _bec !=nil {_f .Log .Debug ("\u0043\u0061\u006e\u006e\u006f\u0074 \u0067\u0065\u0074\u0020\u0069\u006d\u0061\u0067\u0065\u0020\u0066\u0072\u006fm\u0020\u0063\u0072\u0065\u0061\u0074\u006fr\u003a\u0020\u0025\u0073",_bec );return nil ;};_ecf ,_bec :=_ced .NewImageDevice ().Render (_efa );if _bec !=nil {_f .Log .Debug ("\u0043\u0061\u006eno\u0074\u0020\u0072\u0065\u006e\u0064\u0065\u0072\u0020\u0069\u006d\u0061\u0067\u0065\u003a\u0020\u0025\u0073",_bec );return nil ;};_adc ,_bec :=_fde ._fbgd .NewImageFromGoImage (_ecf );if _bec !=nil {_f .Log .Debug ("\u0043\u0061nn\u006f\u0074\u0020c\u0072\u0065\u0061\u0074e i\u006dag\u0065\u0020\u0066\u0072\u006f\u006d\u0020Go\u0049\u006d\u0061\u0067\u0065\u003a\u0020%\u0073",_bec );return nil ;};return _adc ;};func (_fba *line )moveRight (_gfae float64 ){for _ ,_dede :=range _fba ._gabg {_dede ._bcag +=_gfae ;};};var _cede =map[string ]int32 {"\u0076":9830,"\u00d8":8594,"\u00fc":8730};type romanMatch struct{_dbd int ;_bdd string ;};func (_cee *convertContext )getPhData (_fbbf *_ea .CT_Shape )(*_fc .CT_Transform2D ,*_fc .CT_TextBodyProperties ,*_fc .CT_TextListStyle ,bool ,bool ){_debd ,_adbf :=_cdbg (_fbbf );_afec :=_adbf ==nil ;_ecaa ,_beae ,_gdfb ,_acdg :=_bbaee (_cee ._ddc .CSld ,_debd ,_adbf ,_afec );_fad ,_edae ,_abbe ,_gff :=_bbaee (_cee ._adab .CSld ,_debd ,_adbf ,_afec );if _fad ==nil {_fad =_ecaa ;};_ffbb ,_eddd :=_ddce (_edae ,_beae );var _gfda ,_bgea bool ;if _abbe ==nil {if _gdfb !=nil {_gfda =*_gdfb ;};}else {_gfda =*_abbe ;};if _gff ==nil {if _acdg !=nil {_bgea =*_acdg ;};}else {_bgea =*_gff ;};return _fad ,_ffbb ,_eddd ,_gfda ,_bgea ;};func (_fdeg *textboxContext )addCurrentWordToParagraph (){if _fdeg ._aaa &&_fdeg ._cbbf ._agfb +_fdeg ._cfbe ._geb > _fdeg ._cbbf ._fbfe {_fdeg .newLine ();};if !_fdeg ._cfbe ._bfbd ||len (_fdeg ._cbbf ._gabg )> 0{_fdeg ._cfbe ._bcag =_fdeg ._cbbf ._agfb ;_fdeg ._cbbf ._gabg =append (_fdeg ._cbbf ._gabg ,_fdeg ._cfbe );_fdeg ._cbbf ._agfb +=_fdeg ._cfbe ._geb ;for _ ,_aae :=range _fdeg ._cfbe ._dffb {_fdeg .adjustHeights (_aae ._cdf );};};};func (_gbag *convertContext )getShapeFromBlipFill (_cffd *_fc .CT_BlipFillProperties ,_cacd ,_aea ,_adcd ,_facgc float64 )_dc .Drawable {_dbeg ,_dfcb ,_egfb :=_gbag .makePdfImageFromBlipFill (_cffd );if _egfb !=nil {_f .Log .Debug ("\u0043\u0061\u006e\u006e\u006f\u0074\u0020\u006d\u0061\u006b\u0065\u0020\u0050D\u0046\u0020\u0069\u006d\u0061\u0067e\u0020\u0066\u0072\u006f\u006d\u0020\u0042\u006c\u0069\u0070\u0046\u0069\u006cl\u003a\u0020\u0025\u0073",_egfb );return nil ;};if _dbeg ==nil {return nil ;};if _eged :=_cffd .Tile ;_eged !=nil {_dbeg =_gbag .tileImage (_dbeg ,_cffd .Tile ,_adcd ,_facgc );};if _bece :=_cffd .Stretch ;_bece !=nil {_dbeg ,_cacd ,_aea =_gbag .stretchImage (_dbeg ,_cffd .Stretch ,_cacd ,_aea ,_adcd ,_facgc );};if len (_dfcb )==0{_dbeg .SetPos (_cacd ,_aea );return _dbeg ;};_dbeg =_gbag .applyBlipEffectsOnImg (_dbeg ,_cacd ,_aea ,_dfcb );_dbeg .SetPos (_cacd ,_aea );return _dbeg ;};func _bfff (_bfa ,_defa *_fc .CT_TextParagraphProperties )*_fc .CT_TextParagraphProperties {_ddbd :=_fc .NewCT_TextParagraphProperties ();if _bfa !=nil {*_ddbd =*_bfa ;};if _defa ==nil {return _ddbd ;};if _ddbd .MarLAttr ==nil {_ddbd .MarLAttr =_defa .MarLAttr ;};if _ddbd .MarRAttr ==nil {_ddbd .MarRAttr =_defa .MarRAttr ;};if _ddbd .LvlAttr ==nil {_ddbd .LvlAttr =_defa .LvlAttr ;};if _ddbd .IndentAttr ==nil {_ddbd .IndentAttr =_defa .IndentAttr ;};if _ddbd .AlgnAttr ==_fc .ST_TextAlignTypeUnset {_ddbd .AlgnAttr =_defa .AlgnAttr ;};if _ddbd .DefTabSzAttr ==nil {_ddbd .DefTabSzAttr =_defa .DefTabSzAttr ;};if _ddbd .RtlAttr ==nil {_ddbd .RtlAttr =_defa .RtlAttr ;};if _ddbd .EaLnBrkAttr ==nil {_ddbd .EaLnBrkAttr =_defa .EaLnBrkAttr ;};if _ddbd .FontAlgnAttr ==_fc .ST_TextFontAlignTypeUnset {_ddbd .FontAlgnAttr =_defa .FontAlgnAttr ;};if _ddbd .LatinLnBrkAttr ==nil {_ddbd .LatinLnBrkAttr =_defa .LatinLnBrkAttr ;};if _ddbd .HangingPunctAttr ==nil {_ddbd .HangingPunctAttr =_defa .HangingPunctAttr ;};if _ddbd .LnSpc ==nil {_ddbd .LnSpc =_defa .LnSpc ;};if _ddbd .SpcBef ==nil {_ddbd .SpcBef =_defa .SpcBef ;};if _ddbd .SpcAft ==nil {_ddbd .SpcAft =_defa .SpcAft ;};if _ddbd .BuClrTx ==nil {_ddbd .BuClrTx =_defa .BuClrTx ;};if _ddbd .BuClr ==nil {_ddbd .BuClr =_defa .BuClr ;};if _ddbd .BuSzTx ==nil {_ddbd .BuSzTx =_defa .BuSzTx ;};if _ddbd .BuSzPct ==nil {_ddbd .BuSzPct =_defa .BuSzPct ;};if _ddbd .BuSzPts ==nil {_ddbd .BuSzPts =_defa .BuSzPts ;};if _ddbd .BuFontTx ==nil {_ddbd .BuFontTx =_defa .BuFontTx ;};if _ddbd .BuFont ==nil {_ddbd .BuFont =_defa .BuFont ;};if _ddbd .BuNone ==nil {_ddbd .BuNone =_defa .BuNone ;};if _ddbd .BuAutoNum ==nil {_ddbd .BuAutoNum =_defa .BuAutoNum ;};if _ddbd .BuChar ==nil {_ddbd .BuChar =_defa .BuChar ;};if _ddbd .BuBlip ==nil {_ddbd .BuBlip =_defa .BuBlip ;};if _ddbd .TabLst ==nil {_ddbd .TabLst =_defa .TabLst ;};if _ddbd .ExtLst ==nil {_ddbd .ExtLst =_defa .ExtLst ;};_ddbd .DefRPr =_bbad (_ddbd .DefRPr ,_defa .DefRPr );return _ddbd ;};func (_egad *textboxContext )addTextRun (_caeb *_fc .EG_TextRun ,_abfd *_fc .CT_TextCharacterProperties ,_fcca _dc .Color ,_debf *prefixData ){if _ccce :=_caeb .Br ;_ccce !=nil {_egad .addCurrentWordToParagraph ();_egad .newLine ();_egad .newWord ();}else if _gbgg :=_caeb .R ;_gbgg !=nil {var _aab _dc .Color ;if _gbgg .RPr .SolidFill !=nil {_aab ,_ =_egad ._bfee .getColorFromSolidFill (_gbgg .RPr .SolidFill );}else if _fcca !=nil {_aab =_fcca ;}else if _abfd .SolidFill !=nil {_aab ,_ =_egad ._bfee .getColorFromSolidFill (_abfd .SolidFill );}else {_aab =_dc .ColorBlack ;};_eaga :=_bbad (_gbgg .RPr ,_abfd );_dgeb ,_fcff ,_ebgd ,_aadc :=_egad ._bfee .makeStyleFromRPr (_eaga );_dgeb .Color =_aab ;if _debf !=nil {_egad .addPrefix (_debf ,_dgeb );};_daad :=_bfdg (_gbgg .T );for _ ,_cafc :=range _daad {_cafc ._gaac =_dgeb ;_cafc ._bgdg =_fcff ;_cafc ._egeg =_ebgd ;_cafc ._gbf =_aadc ;if _eaga .CapAttr ==_fc .ST_TextCapsTypeAll {_cafc ._abce =_ce .ToUpper (_cafc ._abce );};_egad .addTextSymbol (_cafc );};};};type word struct{_dffb []*symbol ;_bcag float64 ;_geb float64 ;_bfbd bool ;};func (_gbb *convertContext )applyBlipEffectsOnImg (_cfce *_dc .Image ,_effa ,_geec float64 ,_gcfe []*_fc .CT_BlipChoice )*_dc .Image {if len (_gcfe )==0{return _cfce ;};_cfce .SetPos (_effa ,_geec );_ccag ,_ceeb :=_gbb .renderPageWithDrawableToGoImage (_cfce );if _ceeb !=nil {_f .Log .Debug ("\u0045\u0072\u0072\u006f\u0072\u0020\u0072\u0065\u006e\u0064\u0065\u0072\u0020a\u006e\u0020\u0069\u006d\u0061\u0067e\u0020\u0074\u006f\u0020\u0061\u0020\u0047\u006f\u0020\u0069\u006d\u0061\u0067e\u003a\u0020\u0025\u0073",_ceeb );return _cfce ;};_agfa ,_ceeb :=_gbb .renderCurrentStateToGoImage ();if _ceeb !=nil {_f .Log .Debug ("\u0045\u0072\u0072\u006f\u0072\u0020\u0072\u0065n\u0064\u0065\u0072 t\u0068\u0065\u0020\u0063\u0075\u0072r\u0065\u006e\u0074\u0020\u0073\u0074\u0061\u0074\u0065\u0020\u0074\u006f\u0020\u0061\u0020G\u006f\u0020\u0069\u006d\u0061\u0067\u0065\u003a \u0025\u0073",_ceeb );return _cfce ;};_eefc :=_ccag .Bounds ();_bebf :=_gd .NewRGBA (_eefc );_gfddg ,_effd :=_cfce .Width (),_cfce .Height ();for _ ,_bcde :=range _gcfe {for _ ,_dabg :=range _bcde .AlphaModFix {if _abfg :=_dabg .AmtAttr ;_abfg !=nil {if _bcbb :=_abfg .ST_PositivePercentageDecimal ;_bcbb !=nil {_cdca :=uint8 (255*(*_bcbb )/100000);_fdfb :=_gd .NewUniform (_g .Alpha {_cdca });_a .Draw (_bebf ,_eefc ,_agfa ,_gd .Point {0,0},_a .Src );_a .DrawMask (_bebf ,_eefc ,_ccag ,_gd .Point {0,0},_fdfb ,_gd .Point {0,0},_a .Over );};};};};_bcea :=_gd .Rect (int (_effa ),int (_geec ),int (_effa +_gfddg )+1,int (_geec +_effd )+1);_bdgcd :=_ef .CropImageByRect (_bebf ,_bcea );_caac ,_ceeb :=_gbb ._fbgd .NewImageFromGoImage (_bdgcd );if _ceeb !=nil {_f .Log .Debug ("\u0045\u0072\u0072\u006f\u0072\u0020\u0061\u006e\u0020\u0069\u006d\u0061\u0067\u0065\u0020t\u006f \u0061\u0020\u0047\u006f\u0020\u0069\u006d\u0061\u0067\u0065\u003a\u0020\u0025\u0073",_ceeb );return _cfce ;};return _caac ;};func (_cbcc *textboxContext )alignSymbolsVertically (){for _ ,_egfe :=range _cbcc ._gfacc {for _ ,_eba :=range _egfe ._gegc {_eab :=0.0;for _ ,_fff :=range _eba ._gabg {for _ ,_dfe :=range _fff ._dffb {if _dfe ._cdf > _eab {_eab =_dfe ._cdf ;};};};for _ ,_fccc :=range _eba ._gabg {for _ ,_gedc :=range _fccc ._dffb {if _gedc ._bdb < _eab {_gedc ._eeda =_eab -_gedc ._bdb ;};};};};};};type symbol struct{_abce string ;_ffb float64 ;_cdf float64 ;_bdb float64 ;_eeda float64 ;_aeeb float64 ;_gaac *_dc .TextStyle ;_cca string ;_bgdg bool ;_egeg bool ;_gbf bool ;};func (_agge *convertContext )makeStyleFromRPr (_fbe *_fc .CT_TextCharacterProperties )(*_dc .TextStyle ,bool ,bool ,bool ){var _eda ,_ffed ,_gcdf bool ;_bed :=_agge ._fbgd .NewTextStyle ();if _fbe !=nil {_ddac :=_ef .FontStyle_Regular ;_cbef :=_gbe (_fbe .BAttr );_cbca :=_gbe (_fbe .IAttr );if _cbef &&_cbca {_ddac =_ef .FontStyle_BoldItalic ;}else if _cbef {_ddac =_ef .FontStyle_Bold ;}else if _cbca {_ddac =_ef .FontStyle_Italic ;};_gcdf =_fbe .UAttr !=_fc .ST_TextUnderlineTypeUnset &&_fbe .UAttr !=_fc .ST_TextUnderlineTypeNone ;_efce :="\u0064e\u0066\u0061\u0075\u006c\u0074";if _bge :=_fbe .Latin ;_bge !=nil {_efce =_bge .TypefaceAttr ;}else if _cedd :=_fbe .Ea ;_cedd !=nil {_efce =_cedd .TypefaceAttr ;}else if _gedb :=_fbe .Cs ;_gedb !=nil {_efce =_gedb .TypefaceAttr ;}else if _afbd :=_fbe .Sym ;_afbd !=nil {_efce =_afbd .TypefaceAttr ;};if _fcf ,_efcd :=_ef .StdFontsMap [_efce ];_efcd {_bed .Font =_ef .AssignStdFontByName (_bed ,_fcf [_ddac ]);}else if _cge :=_ef .GetRegisteredFont (_efce ,_ddac );_cge !=nil {_bed .Font =_cge ;}else {_f .Log .Debug ("\u0046\u006f\u006e\u0074\u0020\u0025\u0073\u0020\u0077\u0069\u0074h\u0020\u0073\u0074\u0079\u006c\u0065\u0020\u0025s\u0020i\u0073\u0020\u006e\u006f\u0074\u0020\u0066\u006f\u0075\u006e\u0064\u002c\u0020\u0072\u0065\u0073\u0065\u0074 \u0074\u006f\u0020\u0064\u0065\u0066\u0061\u0075\u006c\u0074\u002e",_efce ,_ddac );_bed .Font =_ef .AssignStdFontByName (_bed ,_ef .StdFontsMap ["\u0064e\u0066\u0061\u0075\u006c\u0074"][_ddac ]);};var _bba float64 ;if _ddg :=_fbe .SzAttr ;_ddg !=nil {_bba =float64 (*_ddg )/100;}else {_bba =_ef .DefaultFontSize ;};if _fcd :=_fbe .BaselineAttr ;_fcd !=nil {if _efaf :=_fcd .ST_PercentageDecimal ;_efaf !=nil {if *_efaf > 0{_eda =true ;}else if *_efaf < 0{_ffed =true ;};};};if _eda ||_ffed {_bba *=0.64;};_bed .FontSize =_bba ;_ceb :=0.0;if _gfadd :=_fbe .SpcAttr ;_gfadd !=nil {if _cebd :=_gfadd .ST_TextPointUnqualified ;_cebd !=nil {_ceb =float64 (*_cebd )/100;};};_bed .CharSpacing =_ceb ;};return &_bed ,_eda ,_ffed ,_gcdf ;};func (_aaabd *convertContext )renderPageWithDrawableToGoImage (_eafbd _dc .Drawable )(_gd .Image ,error ){_agea :=_ef .MakeTempCreator (_aaabd ._faad ,_aaabd ._fgbf );_agea .NewPage ();_agea .Draw (_eafbd );_fbeeb ,_dcgg :=_ef .GetPageFromCreator (_agea );if _dcgg !=nil {return nil ,_dcgg ;};return _ced .NewImageDevice ().Render (_fbeeb );};func (_bgf *convertContext )getBorderStyle (_fbd *_fc .CT_LineProperties )(_dc .CellBorderStyle ,*_dc .Color ,float64 ){if _fbd ==nil ||_fbd .NoFill !=nil {return _dc .CellBorderStyleNone ,nil ,0;};var _cbcb _dc .Color ;if _abab :=_fbd .SolidFill ;_abab !=nil {_cbcb ,_ =_bgf .getColorFromSolidFill (_abab );};_eaab :=0.0;if _eea :=_fbd .WAttr ;_eea !=nil {_eaab =_d .FromEMU (int64 (*_eea ));};return _dc .CellBorderStyleSingle ,&_cbcb ,_eaab ;};func (_cgaf *convertContext )makePdfImageFromBlipFill (_ebbd *_fc .CT_BlipFillProperties )(*_dc .Image ,[]*_fc .CT_BlipChoice ,error ){if _bbabc :=_ebbd .Blip ;_bbabc !=nil {if _fcgb :=_bbabc .EmbedAttr ;_fcgb !=nil {_gfd ,_cceg :=_cgaf ._ddbg .GetImageByRelID (*_fcgb );if _cceg {_aeg ,_ffbe :=_ga .Open (_gfd .Path ());if _ffbe !=nil {_f .Log .Debug ("\u0046\u0069\u006c\u0065 o\u0070\u0065\u006e\u0020\u0065\u0072\u0072\u006f\u0072\u003a\u0020\u0025\u0073",_ffbe );return nil ,nil ,_ffbe ;};defer _aeg .Close ();_ebf ,_ ,_ffbe :=_gd .Decode (_aeg );if _ffbe !=nil {_f .Log .Debug ("\u0044\u0065\u0063\u006fde\u0020\u0069\u006d\u0061\u0067\u0065\u0020\u0065\u0072\u0072\u006f\u0072\u003a\u0020%\u0073",_ffbe );return nil ,nil ,_ffbe ;};if _dfef :=_ebbd .SrcRect ;_dfef !=nil {_bbbg :=_ebf .Bounds ().Size ();_ddace :=_bbbg .X ;_bagc :=_bbbg .Y ;var _dfg ,_egaa ,_dabd ,_fcbb int ;var _gdebb bool ;if _gfaca :=_dfef .LAttr ;_gfaca !=nil {_dfg =int (float64 (_ddace )*_ef .FromSTPercentage (_gfaca ));_gdebb =true ;}else {_dfg =0;};if _ffac :=_dfef .TAttr ;_ffac !=nil {_dabd =int (float64 (_bagc )*_ef .FromSTPercentage (_ffac ));_gdebb =true ;}else {_dabd =0;};if _eecg :=_dfef .RAttr ;_eecg !=nil {_egaa =int (float64 (_ddace )*(1-_ef .FromSTPercentage (_eecg )));_gdebb =true ;}else {_egaa =_ddace ;};if _efca :=_dfef .BAttr ;_efca !=nil {_fcbb =int (float64 (_bagc )*(1-_ef .FromSTPercentage (_efca )));_gdebb =true ;}else {_fcbb =_bagc ;};if _gdebb {_ebf =_ef .CropImageByRect (_ebf ,_gd .Rect (_dfg ,_dabd ,_egaa +1,_fcbb +1));};};_aag ,_ffbe :=_cgaf ._fbgd .NewImageFromGoImage (_ebf );if _ffbe !=nil {_f .Log .Debug ("\u0043\u0061\u006e\u006e\u006ft\u0020\u0063\u0072\u0065\u0061\u0074\u0065\u0020\u0050\u0044\u0046\u0020\u0069m\u0061\u0067\u0065\u0020\u0066\u0072\u006f\u006d\u0020\u0047\u006f\u0020\u0069\u006d\u0061\u0067\u0065\u003a\u0020\u0025\u0073",_ffbe );return nil ,nil ,_ffbe ;};return _aag ,_bbabc .Choice ,nil ;};};};return nil ,nil ,nil ;};type convertContext struct{_fbgd *_dc .Creator ;_bgdc *_ef .Rectangle ;_ddad *_ed .Presentation ;_ddbg *_ed .Slide ;_ddc *_ea .SldMaster ;_adab *_ea .SldLayout ;_fgbf float64 ;_faad float64 ;_edab []_dc .Drawable ;_add *background ;_ecc *_fc .CT_TextParagraphProperties ;_dad *_fc .CT_TextCharacterProperties ;_egga *_fc .CT_TextParagraphProperties ;_cdce *_fc .CT_TextCharacterProperties ;_bcb *_fc .CT_TextParagraphProperties ;_eaff *_fc .CT_TextCharacterProperties ;_gfac []*_fc .CT_TextParagraphProperties ;_bgdab []*_fc .CT_TextParagraphProperties ;_efg []*_fc .CT_TextParagraphProperties ;_dea *_fc .Theme ;_daa *_fc .CT_ColorMappingOverride ;};func _ageb (_fdd *_fc .CT_TableCellProperties ,_eada *_fc .CT_TableStyleCellStyle ,_ceff ,_eccge ,_acaa ,_daac bool )*_fc .CT_TableCellProperties {_fddg :=_fc .NewCT_TableCellProperties ();if _fdd !=nil {*_fddg =*_fdd ;};if _eada ==nil {return _fddg ;};if _fbc :=_eada .FillRef ;_fbc !=nil {_bgaf :=_fc .NewCT_SolidColorFillProperties ();_bgaf .ScrgbClr =_fbc .ScrgbClr ;_bgaf .SrgbClr =_fbc .SrgbClr ;_bgaf .HslClr =_fbc .HslClr ;_bgaf .SysClr =_fbc .SysClr ;_bgaf .SchemeClr =_fbc .SchemeClr ;_bgaf .PrstClr =_fbc .PrstClr ;_fddg .SolidFill =_bgaf ;};if _fddg .NoFill ==nil &&_fddg .SolidFill ==nil {if _aebg :=_eada .Fill ;_aebg !=nil {if _fddg .NoFill ==nil {_fddg .NoFill =_aebg .NoFill ;};if _fddg .SolidFill ==nil {_fddg .SolidFill =_aebg .SolidFill ;};};};if _cfa :=_eada .TcBdr ;_cfa !=nil {if _fddg .LnL ==nil {var _cabff *_fc .CT_ThemeableLineStyle ;if _acaa {_cabff =_cfa .Left ;}else {_cabff =_cfa .InsideV ;};if _cabff !=nil {_fddg .LnL =_cabff .Ln ;};};if _fddg .LnR ==nil {var _dbeb *_fc .CT_ThemeableLineStyle ;if _daac {_dbeb =_cfa .Right ;}else {_dbeb =_cfa .InsideV ;};if _dbeb !=nil {_fddg .LnR =_dbeb .Ln ;};};if _fddg .LnT ==nil {var _dbcf *_fc .CT_ThemeableLineStyle ;if _ceff {_dbcf =_cfa .Top ;}else {_dbcf =_cfa .InsideH ;};if _dbcf !=nil {_fddg .LnT =_dbcf .Ln ;};};if _fddg .LnB ==nil {var _feebb *_fc .CT_ThemeableLineStyle ;if _eccge {_feebb =_cfa .Bottom ;}else {_feebb =_cfa .InsideH ;};if _feebb !=nil {_fddg .LnB =_feebb .Ln ;};};};return _fddg ;};

// ConvertToPdf converts a presentation to a PDF file. This package is beta, breaking changes can take place.
func ConvertToPdf (pr *_ed .Presentation )*_dc .Creator {_bff :=pr .X ().SldSz ;_cbc :=_d .FromEMU (int64 (_bff .CxAttr ));_ac :=_d .FromEMU (int64 (_bff .CyAttr ));_acd :=_dc .PageSize {_cbc ,_ac };_af :=_dc .New ();_af .SetPageSize (_acd );var _aga *_fc .Theme ;if len (pr .Themes ())> 0{_aga =pr .Themes ()[0];};for _ ,_age :=range pr .Slides (){if _age .X ()==nil {continue ;};_fg :=&convertContext {_fbgd :_af ,_ddbg :&_age ,_adab :_age .GetSlideLayout (),_ddc :pr .SlideMasters ()[0].X (),_ddad :pr ,_dea :_aga ,_daa :_age .X ().ClrMapOvr ,_fgbf :_acd [1],_faad :_acd [0]};_fg ._adab =_age .GetSlideLayout ();_fg .extractDefaultProperties ();_fg .makeSlide ();_fg .drawSlide ();};return _af ;};func _ddce (_fceb ,_fbgb *_fc .CT_TextBody )(*_fc .CT_TextBodyProperties ,*_fc .CT_TextListStyle ){if _fceb ==nil &&_fbgb ==nil {return nil ,nil ;};if _fceb ==nil {return _fbgb .BodyPr ,_fbgb .LstStyle ;};if _fbgb ==nil {return _fceb .BodyPr ,_fceb .LstStyle ;};_bggg ,_acgg :=_fceb .BodyPr ,_fceb .LstStyle ;_beb ,_befb :=_fbgb .BodyPr ,_fbgb .LstStyle ;_eef :=_aggef (_bggg ,_beb );_gbaf :=_bcgd (_acgg ,_befb );return _eef ,_gbaf ;};func (_gbc *convertContext )makePdfBlockFromTable (_dgfb *_fc .Tbl ,_cdgd float64 )*_dc .Table {_egff :=_dgfb .TblGrid ;if _egff ==nil {return nil ;};_aff :=len (_egff .GridCol );if _aff ==0{return nil ;};_deef :=[]float64 {};_abc :=0.0;for _ ,_fgbe :=range _egff .GridCol {_aad :=_d .FromEMU (_ef .FromSTCoordinate (_fgbe .WAttr ));_deef =append (_deef ,_aad );_abc +=_aad ;};_ggc :=[]float64 {};for _fdg :=0;_fdg < _aff ;_fdg ++{_ggc =append (_ggc ,_deef [_fdg ]/_abc );};_dffg :=_gbc ._fbgd .NewTable (_aff );_dffg .SetColumnWidths (_ggc ...);_daca :=_dgfb .TblPr ;var _feec *_fc .CT_TableStyle ;if _fbf :=_daca .Choice ;_fbf !=nil {if _fbf .TableStyle !=nil {_feec =_fbf .TableStyle ;}else if _fbf .TableStyleId !=nil {_feec =_gbc ._ddad .GetTableStyleById (*_fbf .TableStyleId );};};_dddc :=_fc .NewCT_TablePartStyle ();_dddc .TcStyle =_fc .NewCT_TableStyleCellStyle ();_dddc .TcTxStyle =_fc .NewCT_TableStyleTextStyle ();if _feec !=nil {if _feec .WholeTbl !=nil {*_dddc =*_feec .WholeTbl ;};if _feec .TblBg !=nil {if _dddc .TcStyle .Fill ==nil {_dddc .TcStyle .Fill =_feec .TblBg .Fill ;};};};if _dddc .TcStyle .Fill ==nil {_dddc .TcStyle .Fill =_fc .NewCT_FillProperties ();_dddc .TcStyle .Fill .NoFill =_daca .NoFill ;_dddc .TcStyle .Fill .SolidFill =_daca .SolidFill ;};_gge :=len (_dgfb .Tr );for _fdee ,_fea :=range _dgfb .Tr {_dgbce :=_fdee ==0;_cfe :=_fdee ==_gge -1;_dedc :=_fdee %2==0;_abcf :=len (_fea .Tc );var _fef *_fc .CT_TablePartStyle ;if _dgbce {_fef =_feec .FirstRow ;}else if _dedc {_fef =_feec .Band2H ;}else {_fef =_feec .Band1H ;};var _gcc float64 ;for _cafa ,_dbfe :=range _fea .Tc {_aadf :=_cafa ==0;_feb :=_cafa ==_abcf -1;_dae :=_cafa %2==0;var _bga *_fc .CT_TablePartStyle ;if _aadf {_bga =_feec .FirstCol ;}else if _dae {_bga =_feec .Band2V ;}else {_bga =_feec .Band1V ;};_gecd :=_faga (_faga (_bga ,_fef ),_dddc );_aebe :=_gbc .addCellToTable (_dffg ,_dbfe ,_gecd ,_cdgd *_ggc [_cafa ],_dgbce ,_cfe ,_aadf ,_feb );if _aebe > _gcc {_gcc =_aebe ;};};_ffce :=_d .FromEMU (_ef .FromSTCoordinate (_fea .HAttr ));if _ffce < _gcc {_ffce =_gcc ;};if _ffce < _bffa (4){_ffce =_bffa (4);};_dffg .SetRowHeight (_dffg .CurRow (),_ffce );};return _dffg ;};func (_ffgg *textboxContext )assignPropsToCurrentParagraph (_adef *_fc .CT_TextParagraphProperties ){_cfcb :=12.4;if _adef ==nil {_ffgg ._fbb ._ace =_cfcb ;return ;};if _agc :=_adef .DefRPr ;_agc !=nil {_cgea :=_agc .SzAttr ;if _cgea !=nil {_ecb :=float64 (*_cgea )/1200;if _cfcb <=_ecb {_cfcb =_ecb ;};};};if _gfcb :=_adef .MarLAttr ;_gfcb !=nil {_ffgg ._fbb ._aefb =_d .FromEMU (int64 (*_gfcb ));};_ffgg ._fbb ._dbce =_ffgg ._edbd ;if _gbgb :=_adef .MarRAttr ;_gbgb !=nil {_ffgg ._fbb ._dbce -=_d .FromEMU (int64 (*_gbgb ));};if _gbgf :=_adef .IndentAttr ;_gbgf !=nil {_ffgg ._fbb ._cafb =_d .FromEMU (int64 (*_gbgf ));};if _dggf :=_adef .LatinLnBrkAttr ;_dggf !=nil {_ffgg ._fbb ._dgac =*_dggf ;};if _bfdc :=_adef .LnSpc ;_bfdc !=nil {if _cfef :=_bfdc .SpcPct ;_cfef !=nil {if _dbdc :=_cfef .ValAttr .ST_TextSpacingPercent ;_dbdc !=nil {_cfcb =float64 (*_dbdc )/5000;};};};var _ccfab float64 ;if _dcg :=_adef .SpcBef ;_dcg !=nil {if _gfe :=_dcg .SpcPts ;_gfe !=nil {_ccfab =float64 (_gfe .ValAttr )/100;};};_ebg :=_ffgg ._gfacc ;if len (_ebg )> 0{_ccfab -=_ebg [len (_ebg )-1]._afba ;if _ccfab < 0{_ccfab =0;};};_ffgg ._fbb ._gea =_ccfab ;if _feda :=_adef .SpcAft ;_feda !=nil {if _beee :=_feda .SpcPts ;_beee !=nil {_ffgg ._fbb ._afba =float64 (_beee .ValAttr )/100;};};_ffgg ._fbb ._ace =_cfcb ;_ffgg ._fbb ._bdea =_adef .AlgnAttr ;};type textboxContext struct{_bfee *convertContext ;_edbd float64 ;_fcc float64 ;_faaf *_dc .Creator ;_agee float64 ;_gfacc []*paragraph ;_fbb *paragraph ;_cbbf *line ;_cfbe *word ;_aaa bool ;};func (_eddb *convertContext )getShapesFromSpPr (_abb *_fc .CT_ShapeProperties ,_cea *_fc .CT_ShapeStyle ,_gfc bool )([]_dc .Drawable ,float64 ,float64 ,float64 ,float64 ,_dc .Color ,bool ){_gec :=[]_dc .Drawable {};var _ega ,_fcg ,_agdb ,_gfbc ,_cgcb float64 ;var _dgcf ,_caf ,_gedd ,_egc _dc .Color ;var _cae *_fc .CT_BlipFillProperties ;_dbb ,_gabc :=1.0,1.0;if _cea !=nil {_dgcf ,_caf ,_egc =_eddb .getStyleColors (_cea );};if _abe :=_abb .Ln ;_abe !=nil {if _abe .NoFill !=nil {_gedd ,_cgcb =nil ,0;}else {_gedd ,_cgcb ,_dbb =_eddb .getInfoFromLn (_abe );if _gedd ==nil {_gedd =_egc ;};};};if _abb .NoFill !=nil {_caf ,_gabc =nil ,0;}else if _gfc {_caf =_eddb ._add ._bgg ;_gabc =_eddb ._add ._ddca ;_cae =_eddb ._add ._aebb ;}else if _bea :=_abb .SolidFill ;_bea !=nil {_caf ,_gabc =_eddb .getColorFromSolidFill (_bea );};var _fab bool ;if _bgc :=_abb .Xfrm ;_bgc !=nil {_ega ,_fcg ,_agdb ,_gfbc =_ef .GetDataFromXfrm (_bgc );_fab =true ;};if _gag :=_abb .CustGeom ;_gag !=nil {_dffa :=[]_bf .Point {};_bdc ,_gaab :=1.0,1.0;if _dgbc :=_gag .PathLst ;_dgbc !=nil {for _ ,_aace :=range _dgbc .Path {if _aace !=nil {if _gagg :=_aace .WAttr ;_gagg !=nil {_bdc =_agdb /_d .FromEMU (*_gagg );};if _gfg :=_aace .HAttr ;_gfg !=nil {_gaab =_gfbc /_d .FromEMU (*_gfg );};for _ ,_adf :=range _aace .Close {if _adf !=nil {};};for _ ,_gdg :=range _aace .MoveTo {if _gdg !=nil &&_gdg .Pt !=nil {_faaa ,_efe :=_accf (_gdg .Pt );_dffa =append (_dffa ,_bf .Point {X :_faaa *_bdc +_ega ,Y :_efe *_gaab +_fcg });};};for _ ,_bdgc :=range _aace .LnTo {if _bdgc !=nil &&_bdgc .Pt !=nil {_geee ,_dca :=_accf (_bdgc .Pt );_dffa =append (_dffa ,_bf .Point {X :_geee *_bdc +_ega ,Y :_dca *_gaab +_fcg });};};_bce :=_eddb ._fbgd .NewPolygon ([][]_bf .Point {_dffa });_bce .SetFillColor (_caf );_bce .SetFillOpacity (_gabc );_bce .SetBorderWidth (_cgcb );if _gedd !=nil {_bce .SetBorderColor (_gedd );_bce .SetBorderOpacity (_dbb );};_gec =append (_gec ,_bce );};};};};if _dgd :=_abb .PrstGeom ;_dgd !=nil {switch _dgd .PrstAttr {case _fc .ST_ShapeTypeRect :if _cae !=nil {_bde :=_eddb .getShapeFromBlipFill (_cae ,_ega ,_fcg ,_agdb ,_gfbc );_gec =append (_gec ,_bde );}else {_cbb :=_eddb ._fbgd .NewRectangle (_ega ,_fcg ,_agdb ,_gfbc );_cbb .SetFillColor (_caf );_cbb .SetFillOpacity (_gabc );_cbb .SetBorderWidth (_cgcb );if _gedd !=nil {_cbb .SetBorderColor (_gedd );_cbb .SetBorderOpacity (_dbb );};_gec =append (_gec ,_cbb );};case _fc .ST_ShapeTypeLine :_caa :=_eddb ._fbgd .NewLine (_ega ,_fcg ,_ega +_agdb ,_fcg +_gfbc );_caa .SetLineWidth (_cgcb );if _gedd !=nil {_caa .SetColor (_gedd );};_gec =append (_gec ,_caa );};};return _gec ,_ega ,_fcg ,_agdb ,_gfbc ,_dgcf ,_fab ;};func _efag (_bccb *_fc .CT_TextCharacterProperties ,_ffbc *_fc .CT_TableStyleTextStyle )*_fc .CT_TextCharacterProperties {_ccbb :=_fc .NewCT_TextCharacterProperties ();if _bccb !=nil {*_ccbb =*_bccb ;};if _ffbc ==nil {return _ccbb ;};if _ccbb .BAttr ==nil &&_ffbc .BAttr !=_fc .ST_OnOffStyleTypeUnset {_gfdd :=_ffbc .BAttr ==_fc .ST_OnOffStyleTypeOn ;_ccbb .BAttr =&_gfdd ;};if _ccbb .IAttr ==nil &&_ffbc .IAttr !=_fc .ST_OnOffStyleTypeUnset {_cfbf :=_ffbc .IAttr ==_fc .ST_OnOffStyleTypeOn ;_ccbb .IAttr =&_cfbf ;};if _ccbb .NoFill ==nil &&_ccbb .SolidFill ==nil {_ccbb .SolidFill =_fc .NewCT_SolidColorFillProperties ();_ccbb .SolidFill .ScrgbClr =_ffbc .ScrgbClr ;_ccbb .SolidFill .SrgbClr =_ffbc .SrgbClr ;_ccbb .SolidFill .HslClr =_ffbc .HslClr ;_ccbb .SolidFill .SysClr =_ffbc .SysClr ;_ccbb .SolidFill .SchemeClr =_ffbc .SchemeClr ;_ccbb .SolidFill .PrstClr =_ffbc .PrstClr ;};if _agdc :=_ffbc .Font ;_agdc !=nil &&_ccbb .Latin ==nil &&_ccbb .Ea ==nil &&_ccbb .Cs ==nil {_ccbb .Latin =_agdc .Latin ;_ccbb .Ea =_agdc .Ea ;_ccbb .Cs =_agdc .Cs ;};return _ccbb ;};func _acb (_egbg int ,_abd bool )string {_cgad :=(_egbg -1)/26+1;_ddcaa :=byte ((_egbg -1)%26);if _abd {_ddcaa +=byte (65);}else {_ddcaa +=byte (97);};_bdee :=_ca .NewBuffer ([]byte {});for _dge :=0;_dge < _cgad ;_dge ++{_bdee .Write ([]byte {_ddcaa });};return _bdee .String ();};func (_efdf *textboxContext )alignParagraphsVertically (_gcdfb _fc .ST_TextAnchoringType ){if _gcdfb ==_fc .ST_TextAnchoringTypeT {return ;};_dab :=0.0;for _ ,_egab :=range _efdf ._gfacc {_dab +=_egab ._gea +_egab ._eeed +_egab ._afba ;};var _ece float64 ;switch _gcdfb {case _fc .ST_TextAnchoringTypeCtr :_ece =(_efdf ._fcc -_dab )/2;case _fc .ST_TextAnchoringTypeB :_ece =_efdf ._fcc -_dab ;};for _ ,_acdb :=range _efdf ._gfacc {_acdb ._dgba +=_ece ;};};func (_gaaba *convertContext )getInfoFromLn (_abcfg *_fc .CT_LineProperties )(_dc .Color ,float64 ,float64 ){if _abcfg ==nil ||_abcfg .NoFill !=nil {return nil ,0,0;};var _bfg float64 ;_bcge ,_cbfg :=_gaaba .getColorFromSolidFill (_abcfg .SolidFill );if _fgad :=_abcfg .WAttr ;_fgad !=nil {_bfg =_d .FromEMU (int64 (*_fgad ));}else {_bfg =1;};return _bcge ,_bfg ,_cbfg ;};func (_ffgb *convertContext )getColorFromFontReference (_fdf *_fc .CT_FontReference )_dc .Color {var _gaba _dc .Color ;var _gfgf string ;if _fecb :=_fdf .SrgbClr ;_fecb !=nil {_gfgf =_fecb .ValAttr ;}else if _bcfb :=_fdf .SchemeClr ;_bcfb !=nil {_gfgf =_ef .GetColorStringFromDmlColor (_ffgb ._ddad .GetColorBySchemeColor (_bcfb .ValAttr ));_gfgf =_ef .AdjustColor (_gfgf ,_bcfb .EG_ColorTransform );};if _gfgf !=""{_gaba =_dc .ColorRGBFromHex ("\u0023"+_gfgf );};return _gaba ;};func (_de *convertContext )makePdfBlockFromChart (_eb *_da .Chart ,_cb ,_cg float64 )(*_dc .Block ,error ){_ag :=_eb .CT_RelId .IdAttr ;_bg :=_de ._ddbg .GetChartSpaceByRelId (_ag );if _bg ==nil {return nil ,_e .New ("\u004e\u006f\u0020\u0063\u0068\u0061\u0072\u0074\u0073\u0070\u0061\u0063\u0065");};var _gb *_fc .Theme ;_bb :=_de ._ddad .Themes ();if len (_bb )> 0{_gb =_bb [0];};return _ef .MakeBlockFromChartSpace (_bg ,_cb ,_cg ,_gb );};func (_ebe *convertContext )drawSlide (){_ebe ._fbgd .NewPage ();for _ ,_cgd :=range _ebe ._edab {if _cgd !=nil {_ebe ._fbgd .MoveTo (0,0);_ebe ._fbgd .Draw (_cgd );};};};func _accf (_gfgb *_fc .CT_AdjPoint2D )(float64 ,float64 ){var _eaef ,_bgef float64 ;_daae ,_bdcb :=_gfgb .XAttr ,_gfgb .YAttr ;if _bbab :=_daae .ST_Coordinate ;_bbab !=nil {_eaef =_d .FromEMU (_ef .FromSTCoordinate (*_bbab ));};if _eggg :=_bdcb .ST_Coordinate ;_eggg !=nil {_bgef =_d .FromEMU (_ef .FromSTCoordinate (*_eggg ));};return _eaef ,_bgef ;};func _faga (_cfed ,_aadg *_fc .CT_TablePartStyle )*_fc .CT_TablePartStyle {_gabgb :=_fc .NewCT_TablePartStyle ();if _cfed !=nil {*_gabgb =*_cfed ;};if _aadg ==nil {return _gabgb ;};if _gabgb .TcTxStyle ==nil {_gabgb .TcTxStyle =_aadg .TcTxStyle ;}else {_gabgb .TcTxStyle =_febc (_gabgb .TcTxStyle ,_aadg .TcTxStyle );};if _gabgb .TcStyle ==nil {_gabgb .TcStyle =_aadg .TcStyle ;}else {_gabgb .TcStyle =_gdgd (_gabgb .TcStyle ,_aadg .TcStyle );};return _gabgb ;};type symbolStyle struct{_cbcbg *string ;_addg *float64 ;_geef *string ;_cdfa *bool ;_edaf *bool ;_dgae *bool ;_bdbc *bool ;_febe *bool ;};type paragraph struct{_bbae float64 ;_gea float64 ;_afba float64 ;_cafb float64 ;_aefb float64 ;_dbce float64 ;_dgba float64 ;_eeed float64 ;_bdea _fc .ST_TextAlignType ;_ace float64 ;_dgac bool ;_gegc []*line ;};func (_eg *convertContext )makeSlide (){_gab :=_eg ._ddbg .X ().CSld ;if _gab ==nil {return ;};_cba :=&background {};if _dee :=_gab .Bg ;_dee !=nil {if _cfb :=_dee .BgPr ;_cfb !=nil {if _cfb .NoFill ==nil {if _agd :=_cfb .SolidFill ;_agd !=nil {_ede ,_dff :=_eg .getColorFromSolidFill (_agd );if _ede !=nil {_cba ._bgg =_ede ;_cba ._ddca =_dff ;};}else if _db :=_cfb .BlipFill ;_db !=nil {_cba ._aebb =_db ;};};};};_eg ._add =_cba ;if _gc :=_gab .SpTree ;_gc !=nil {for _ ,_dd :=range _gc .Choice {if _dd !=nil {for _ ,_egf :=range _dd .Sp {if _egf !=nil {_eff :=_eg .getShapes (_egf );_eg ._edab =append (_eg ._edab ,_eff ...);};};for _ ,_aa :=range _dd .GraphicFrame {if _aa !=nil {var _gad ,_dgb ,_ab ,_gfb float64 ;if _be :=_aa .Xfrm ;_be !=nil {_gad ,_dgb ,_ab ,_gfb =_ef .GetDataFromXfrm (_be );};if _cd :=_aa .Graphic ;_cd !=nil {if _gee :=_cd .GraphicData ;_gee !=nil {for _ ,_eaa :=range _gee .Any {if _fd ,_dfb :=_eaa .(*_da .Chart );_dfb {_bbc ,_aac :=_eg .makePdfBlockFromChart (_fd ,_ab ,_gfb );if _aac !=nil {_f .Log .Debug ("C\u0061\u006e\u006e\u006ft \u0072e\u0061\u0064\u0020\u0062\u006co\u0063\u006b\u003a\u0020\u0025\u0073",_aac );};if _bbc !=nil {_bbc .SetPos (_gad ,_dgb );_eg ._edab =append (_eg ._edab ,_bbc );};}else if _ec ,_cda :=_eaa .(*_fc .Tbl );_cda {_ecg :=_eg .makePdfBlockFromTable (_ec ,_ab );if _ecg !=nil {_ae :=_dc .NewBlock (_ab ,_gfb );_ae .SetPos (_gad ,_dgb );_ae .Draw (_ecg );_eg ._edab =append (_eg ._edab ,_ae );};};};};};};};for _ ,_egd :=range _dd .CxnSp {if _egd !=nil {_gef :=_eg .getConnectors (_egd );_eg ._edab =append (_eg ._edab ,_gef ...);};};for _ ,_fag :=range _dd .Pic {if _fag !=nil {var _egfg ,_dbaa ,_abg ,_bd float64 ;if _bc :=_fag .SpPr ;_bc !=nil {if _aeb :=_bc .Xfrm ;_aeb !=nil {_egfg ,_dbaa ,_abg ,_bd =_ef .GetDataFromXfrm (_aeb );};};if _egg :=_fag .BlipFill ;_egg !=nil {_agg :=_eg .getShapeFromBlipFill (_egg ,_egfg ,_dbaa ,_abg ,_bd );_eg ._edab =append (_eg ._edab ,_agg );};};};};};};};func _bbad (_edc ,_efac *_fc .CT_TextCharacterProperties )*_fc .CT_TextCharacterProperties {_bcd :=_fc .NewCT_TextCharacterProperties ();if _edc !=nil {*_bcd =*_edc ;};if _efac ==nil {return _bcd ;};if _bcd .KumimojiAttr ==nil {_bcd .KumimojiAttr =_efac .KumimojiAttr ;};if _bcd .LangAttr ==nil {_bcd .LangAttr =_efac .LangAttr ;};if _bcd .AltLangAttr ==nil {_bcd .AltLangAttr =_efac .AltLangAttr ;};if _bcd .SzAttr ==nil {_bcd .SzAttr =_efac .SzAttr ;};if _bcd .BAttr ==nil {_bcd .BAttr =_efac .BAttr ;};if _bcd .IAttr ==nil {_bcd .IAttr =_efac .IAttr ;};if _bcd .UAttr ==_fc .ST_TextUnderlineTypeUnset {_bcd .UAttr =_efac .UAttr ;};if _bcd .StrikeAttr ==_fc .ST_TextStrikeTypeUnset {_bcd .StrikeAttr =_efac .StrikeAttr ;};if _bcd .KernAttr ==nil {_bcd .KernAttr =_efac .KernAttr ;};if _bcd .CapAttr ==_fc .ST_TextCapsTypeUnset {_bcd .CapAttr =_efac .CapAttr ;};if _bcd .SpcAttr ==nil {_bcd .SpcAttr =_efac .SpcAttr ;};if _bcd .NormalizeHAttr ==nil {_bcd .NormalizeHAttr =_efac .NormalizeHAttr ;};if _bcd .BaselineAttr ==nil {_bcd .BaselineAttr =_efac .BaselineAttr ;};if _bcd .NoProofAttr ==nil {_bcd .NoProofAttr =_efac .NoProofAttr ;};if _bcd .DirtyAttr ==nil {_bcd .DirtyAttr =_efac .DirtyAttr ;};if _bcd .ErrAttr ==nil {_bcd .ErrAttr =_efac .ErrAttr ;};if _bcd .SmtCleanAttr ==nil {_bcd .SmtCleanAttr =_efac .SmtCleanAttr ;};if _bcd .SmtIdAttr ==nil {_bcd .SmtIdAttr =_efac .SmtIdAttr ;};if _bcd .BmkAttr ==nil {_bcd .BmkAttr =_efac .BmkAttr ;};if _bcd .Ln ==nil {_bcd .Ln =_efac .Ln ;};if _bcd .NoFill ==nil {_bcd .NoFill =_efac .NoFill ;};if _bcd .SolidFill ==nil {_bcd .SolidFill =_efac .SolidFill ;};if _bcd .BlipFill ==nil {_bcd .BlipFill =_efac .BlipFill ;};if _bcd .EffectLst ==nil {_bcd .EffectLst =_efac .EffectLst ;};if _bcd .EffectDag ==nil {_bcd .EffectDag =_efac .EffectDag ;};if _bcd .Highlight ==nil {_bcd .Highlight =_efac .Highlight ;};if _bcd .ULnTx ==nil {_bcd .ULnTx =_efac .ULnTx ;};if _bcd .ULn ==nil {_bcd .ULn =_efac .ULn ;};if _bcd .UFillTx ==nil {_bcd .UFillTx =_efac .UFillTx ;};if _bcd .UFill ==nil {_bcd .UFill =_efac .UFill ;};if _bcd .Latin ==nil {_bcd .Latin =_efac .Latin ;};if _bcd .Ea ==nil {_bcd .Ea =_efac .Ea ;};if _bcd .Cs ==nil {_bcd .Cs =_efac .Cs ;};if _bcd .Sym ==nil {_bcd .Sym =_efac .Sym ;};if _bcd .Rtl ==nil {_bcd .Rtl =_efac .Rtl ;};return _bcd ;};func _gdgd (_adbg ,_dbcg *_fc .CT_TableStyleCellStyle )*_fc .CT_TableStyleCellStyle {_fggc :=_fc .NewCT_TableStyleCellStyle ();if _adbg !=nil {*_fggc =*_adbg ;};if _dbcg ==nil {return _fggc ;};if _fggc .TcBdr ==nil {_fggc .TcBdr =_dbcg .TcBdr ;};if _fggc .Fill ==nil {_fggc .Fill =_dbcg .Fill ;};if _fggc .FillRef ==nil {_fggc .FillRef =_dbcg .FillRef ;};return _fggc ;};func _febc (_cad ,_ffdc *_fc .CT_TableStyleTextStyle )*_fc .CT_TableStyleTextStyle {_ebd :=_fc .NewCT_TableStyleTextStyle ();if _cad !=nil {*_ebd =*_cad ;};if _ffdc ==nil {return _ebd ;};if _ebd .BAttr ==_fc .ST_OnOffStyleTypeUnset {_ebd .BAttr =_ffdc .BAttr ;};if _ebd .IAttr ==_fc .ST_OnOffStyleTypeUnset {_ebd .IAttr =_ffdc .IAttr ;};if _ebd .Font ==nil {_ebd .Font =_ffdc .Font ;};if _ebd .FontRef ==nil {_ebd .FontRef =_ffdc .FontRef ;};if _ebd .ScrgbClr ==nil {_ebd .ScrgbClr =_ffdc .ScrgbClr ;};if _ebd .SrgbClr ==nil {_ebd .SrgbClr =_ffdc .SrgbClr ;};if _ebd .HslClr ==nil {_ebd .HslClr =_ffdc .HslClr ;};if _ebd .SysClr ==nil {_ebd .SysClr =_ffdc .SysClr ;};if _ebd .SchemeClr ==nil {_ebd .SchemeClr =_ffdc .SchemeClr ;};if _ebd .PrstClr ==nil {_ebd .PrstClr =_ffdc .PrstClr ;};return _ebd ;};