//
// Copyright 2020 FoxyUtils ehf. All rights reserved.
//
// This is a commercial product and requires a license to operate.
// A trial license can be obtained at https://unidoc.io
//
// DO NOT EDIT: generated by unitwist Go source code obfuscator.
//
// Use of this source code is governed by the UniDoc End User License Agreement
// terms that can be accessed at https://unidoc.io/eula/

package convert ;import (_f "errors";_aa "github.com/unidoc/unioffice/common/tempstorage";_b "github.com/unidoc/unioffice/internal/convertutils";_ae "github.com/unidoc/unioffice/measurement";_g "github.com/unidoc/unioffice/presentation";_bf "github.com/unidoc/unioffice/schema/soo/dml";_aea "github.com/unidoc/unioffice/schema/soo/dml/chart";_bg "github.com/unidoc/unioffice/schema/soo/pml";_cb "github.com/unidoc/unipdf/v3/contentstream/draw";_c "github.com/unidoc/unipdf/v3/creator";_fc "github.com/unidoc/unipdf/v3/model";_gd "github.com/unidoc/unipdf/v3/render";_db "image";_e "image/color";_d "image/draw";_fe "log";_de "strings";);func (_gddc *textboxContext )addTextSymbol (_gcbg *symbol ){_fbb :=_c .New ();_fbc :=_fbb .NewStyledParagraph ();_fbc .SetMargins (0,0,0,0);_acf :=_fbc .Append (_gcbg ._gfag );_fbc .SetLineHeight (_gddc ._febgd ._aed );_ccd :=0.0;if _gcbg ._ebgg !=nil {_acf .Style =*_gcbg ._ebgg ;if _gcbg ._ebgg .CharSpacing !=0{_ccd =_gcbg ._ebgg .CharSpacing ;};};_gcbg ._dag =_fbc .Height ();if _gcbg ._fca ==0{_gcbg ._fca =_fbc .Width ()+_ccd ;};if len (_gddc ._gada ._befc )> 0{_faaa :=_gddc ._gada ._befc [len (_gddc ._gada ._befc )-1]._gfag ;if _gddc ._febgd ._faaf ||_b .IsNoSpaceLanguage (_faaa )||(_faaa =="\u0020")!=(_gcbg ._gfag =="\u0020"){_gddc .addCurrentWordToParagraph ();_gddc .newWord ();};};_gddc ._gada ._befc =append (_gddc ._gada ._befc ,_gcbg );_gcbg ._bggeb =_gddc ._gada ._fbd ;_gddc ._gada ._fbd +=_gcbg ._fca ;if _gcbg ._gfag !="\u0020"{_gddc ._gada ._dfd =false ;};};func _ebag (_dccbc float64 )float64 {return _dccbc *_ae .Millimeter };func (_bdb *textboxContext )addCurrentWordToParagraph (){if _bdb ._bfe &&_bdb ._eadg ._dcg +_bdb ._gada ._fbd > _bdb ._eadg ._ffab {_bdb .newLine ();};if !_bdb ._gada ._dfd ||len (_bdb ._eadg ._ffad )> 0{_bdb ._gada ._bbea =_bdb ._eadg ._dcg ;_bdb ._eadg ._ffad =append (_bdb ._eadg ._ffad ,_bdb ._gada );_bdb ._eadg ._dcg +=_bdb ._gada ._fbd ;for _ ,_bdbb :=range _bdb ._gada ._befc {_bdb .adjustHeights (_bdbb ._dag );};};};func (_ged *textboxContext )alignVertically (_gbab _bf .ST_TextAnchoringType ){_ged .alignParagraphsVertically (_gbab );_ged .alignSymbolsVertically ();};func _aafg (_aabb *bool )bool {return _aabb !=nil &&*_aabb };func (_ac *convertContext )extractDefaultProperties (){_ed :=_ac ._cfde .X ();_dcc :=_ed .DefaultTextStyle ;var _ee ,_cc ,_ea ,_edc ,_dg ,_cg ,_add ,_cf ,_ab *_bf .CT_TextParagraphProperties ;if _dcc !=nil {_ee =_efg (_dcc .Lvl1pPr ,_dcc .DefPPr );_cc =_efg (_dcc .Lvl2pPr ,_dcc .DefPPr );_ea =_efg (_dcc .Lvl3pPr ,_dcc .DefPPr );_edc =_efg (_dcc .Lvl4pPr ,_dcc .DefPPr );_dg =_efg (_dcc .Lvl5pPr ,_dcc .DefPPr );_cg =_efg (_dcc .Lvl6pPr ,_dcc .DefPPr );_add =_efg (_dcc .Lvl7pPr ,_dcc .DefPPr );_cf =_efg (_dcc .Lvl8pPr ,_dcc .DefPPr );_ab =_efg (_dcc .Lvl9pPr ,_dcc .DefPPr );};_gcb :=_ac ._cfde .SlideMasters ()[0].X ();_bcc :=_gcb .TxStyles ;_ac ._dcf =_efg (_bcc .TitleStyle .Lvl1pPr ,_ee );_ge :=_bcc .BodyStyle ;_ee =_efg (_ge .Lvl1pPr ,_ee );_cc =_efg (_ge .Lvl2pPr ,_cc );_ea =_efg (_ge .Lvl3pPr ,_ea );_edc =_efg (_ge .Lvl4pPr ,_edc );_dg =_efg (_ge .Lvl5pPr ,_dg );_cg =_efg (_ge .Lvl6pPr ,_cg );_add =_efg (_ge .Lvl7pPr ,_add );_cf =_efg (_ge .Lvl8pPr ,_cf );_ab =_efg (_ge .Lvl9pPr ,_ab );_ac ._bad =make ([]*_bf .CT_TextParagraphProperties ,9);_ac ._bad [0]=_ee ;_ac ._bad [1]=_cc ;_ac ._bad [2]=_ea ;_ac ._bad [3]=_edc ;_ac ._bad [4]=_dg ;_ac ._bad [5]=_cg ;_ac ._bad [6]=_add ;_ac ._bad [7]=_cf ;_ac ._bad [8]=_ab ;_ac ._gbb =_ee ;_ac ._bfd =_ac ._gbb .DefRPr ;};func (_bdgd *line )moveRight (_agdf float64 ){for _ ,_dgdg :=range _bdgd ._ffad {_dgdg ._bbea +=_agdf ;};};func (_bege *convertContext )stretchImage (_fdb *_c .Image ,_dff *_bf .CT_StretchInfoProperties ,_ca ,_cge ,_cac ,_efd float64 )(*_c .Image ,float64 ,float64 ){_gbf :=_dff .FillRect ;if _gbf ==nil {_fag :=_fdb .Width ()/_fdb .Height ();_bgg :=_cac /_efd ;var _dgf ,_begg float64 ;if _fag > _bgg {_begg =_efd ;_dgf =_efd *_fag ;}else {_dgf =_cac ;_begg =_cac /_fag ;};_fdb .Scale (_dgf /_fdb .Width (),_begg /_fdb .Height ());return _fdb ,_ca ,_cge ;};var _eec ,_baf ,_bbe ,_dbc float64 ;if _dga :=_gbf .LAttr ;_dga !=nil {_bbe =_b .FromSTPercentage (_dga );};if _cec :=_gbf .TAttr ;_cec !=nil {_eec =_b .FromSTPercentage (_cec );};if _aae :=_gbf .RAttr ;_aae !=nil {_dbc =_b .FromSTPercentage (_aae );};if _ddf :=_gbf .BAttr ;_ddf !=nil {_baf =_b .FromSTPercentage (_ddf );};_ceg :=_cac *(1-_bbe -_dbc );_ggf :=_efd *(1-_eec -_baf );_fdb .Scale (_ceg /_fdb .Width (),_ggf /_fdb .Height ());return _fdb ,_ca +_bbe *_cac ,_cge +_eec *_efd ;};func (_bggd *textboxContext )alignSymbolsVertically (){for _ ,_bccf :=range _bggd ._gcbb {for _ ,_bccc :=range _bccf ._bdf {_baga :=0.0;for _ ,_egdf :=range _bccc ._ffad {for _ ,_gceg :=range _egdf ._befc {if _gceg ._dag > _baga {_baga =_gceg ._dag ;};};};for _ ,_fefab :=range _bccc ._ffad {for _ ,_fcgd :=range _fefab ._befc {if _fcgd ._dag < _baga {_fcgd ._agb =_baga -_fcgd ._dag ;};};};};};};func (_edfd *convertContext )getConnectors (_acbc *_bg .CT_Connector )[]_c .Drawable {_ffc ,_ ,_ ,_ ,_ ,_ ,_ :=_edfd .getShapesFromSpPr (_acbc .SpPr ,_acbc .Style ,false );return _ffc ;};

// ConvertToPdf converts a presentation to a PDF file. This package is beta, breaking changes can take place.
func ConvertToPdf (pr *_g .Presentation )*_c .Creator {_fd :=pr .X ().SldSz ;_ad :=_ae .FromEMU (int64 (_fd .CxAttr ));_gc :=_ae .FromEMU (int64 (_fd .CyAttr ));_bc :=_c .PageSize {_ad ,_gc };_gda :=_c .New ();_gda .SetPageSize (_bc );var _ce *_bf .Theme ;if len (pr .Themes ())> 0{_ce =pr .Themes ()[0];};for _ ,_ddg :=range pr .Slides (){if _ddg .X ()==nil {continue ;};_dc :=&convertContext {_acgg :_gda ,_gaf :&_ddg ,_cecf :_ddg .GetSlideLayout (),_dbdde :pr .SlideMasters ()[0].X (),_cfde :pr ,_cfeb :_ce ,_fef :_ddg .X ().ClrMapOvr ,_gcgf :_bc [1],_face :_bc [0]};_dc ._cecf =_ddg .GetSlideLayout ();_dc .extractDefaultProperties ();_dc .makeSlide ();_dc .drawSlide ();};return _gda ;};

// RegisterFontsFromDirectory registers all fonts from the given directory automatically detecting font families and styles.
func RegisterFontsFromDirectory (dirName string )error {return _b .RegisterFontsFromDirectory (dirName )};func (_deec *convertContext )tileImage (_bab *_c .Image ,_dea *_bf .CT_TileInfoProperties ,_ceb ,_ga float64 )*_c .Image {_deg ,_aabf :=1.0,1.0;if _dde :=_dea .SxAttr ;_dde !=nil {_deg =_b .FromSTPercentage (_dde );};if _fa :=_dea .SyAttr ;_fa !=nil {_aabf =_b .FromSTPercentage (_fa );};_da :=_b .MakeTempCreator (_ceb ,_ga );_bab .Scale (_deg ,_aabf );_abc ,_fcb :=_bab .Width (),_bab .Height ();var _bdd ,_bed float64 ;if _ccc :=_dea .TxAttr ;_ccc !=nil {_bdd =_ae .FromEMU (_b .FromSTCoordinate (*_ccc ));};if _fbf :=_dea .TyAttr ;_fbf !=nil {_bed =_ae .FromEMU (_b .FromSTCoordinate (*_fbf ));};if _bdd > 0{_bdd -=_abc ;};if _bed > 0{_bed -=_fcb ;};_bge :=_deec ._face /_abc +1;_dge :=_deec ._gcgf /_fcb +1;for _bag :=0.0;_bag <=_bge ;_bag ++{_ddc :=_bag *_abc ;for _aee :=0.0;_aee <=_dge ;_aee ++{_cea :=_aee *_fcb ;_bab .SetPos (_ddc +_bdd ,_cea +_bed );_da .Draw (_bab );};};_bee ,_edb :=_b .GetPageFromCreator (_da );if _edb !=nil {_fe .Println ("\u0043\u0061\u006e\u006e\u006f\u0074\u0020\u0067\u0065\u0074 \u0069\u006d\u0061\u0067\u0065\u0020\u0066r\u006f\u006d\u0020\u0063\u0072\u0065\u0061\u0074\u006f\u0072\u003a",_edb );return nil ;};_gec ,_edb :=_gd .NewImageDevice ().Render (_bee );if _edb !=nil {_fe .Println ("C\u0061n\u006e\u006f\u0074\u0020\u0072\u0065\u006e\u0064e\u0072\u0020\u0069\u006dag\u0065\u003a",_edb );return nil ;};_feaf ,_edb :=_deec ._acgg .NewImageFromGoImage (_gec );if _edb !=nil {_fe .Println ("\u0043\u0061\u006e\u006e\u006f\u0074 \u0063\u0072\u0065\u0061\u0074\u0065\u0020\u0069\u006d\u0061\u0067\u0065\u0020f\u0072\u006f\u006d\u0020\u0047\u006f\u0049m\u0061\u0067\u0065\u003a",_edb );return nil ;};return _feaf ;};func (_befa *convertContext )getColorFromMatrixReference (_feaef *_bf .CT_StyleMatrixReference )_c .Color {if _feaef ==nil {return nil ;};var _bfde _c .Color ;var _gddb string ;if _gedd :=_feaef .SrgbClr ;_gedd !=nil {_gddb =_gedd .ValAttr ;}else if _afe :=_feaef .SchemeClr ;_afe !=nil {_gddb =_b .GetColorStringFromDmlColor (_befa ._cfde .GetColorBySchemeColor (_afe .ValAttr ));_gddb =_b .AdjustColor (_gddb ,_afe .EG_ColorTransform );};if _gddb !=""{_bfde =_c .ColorRGBFromHex ("\u0023"+_gddb );};return _bfde ;};func _ddba (_cbf ,_ffcba *_bf .CT_TableStyleTextStyle )*_bf .CT_TableStyleTextStyle {_ddbd :=_bf .NewCT_TableStyleTextStyle ();if _cbf !=nil {*_ddbd =*_cbf ;};if _ffcba ==nil {return _ddbd ;};if _ddbd .BAttr ==_bf .ST_OnOffStyleTypeUnset {_ddbd .BAttr =_ffcba .BAttr ;};if _ddbd .IAttr ==_bf .ST_OnOffStyleTypeUnset {_ddbd .IAttr =_ffcba .IAttr ;};if _ddbd .Font ==nil {_ddbd .Font =_ffcba .Font ;};if _ddbd .FontRef ==nil {_ddbd .FontRef =_ffcba .FontRef ;};if _ddbd .ScrgbClr ==nil {_ddbd .ScrgbClr =_ffcba .ScrgbClr ;};if _ddbd .SrgbClr ==nil {_ddbd .SrgbClr =_ffcba .SrgbClr ;};if _ddbd .HslClr ==nil {_ddbd .HslClr =_ffcba .HslClr ;};if _ddbd .SysClr ==nil {_ddbd .SysClr =_ffcba .SysClr ;};if _ddbd .SchemeClr ==nil {_ddbd .SchemeClr =_ffcba .SchemeClr ;};if _ddbd .PrstClr ==nil {_ddbd .PrstClr =_ffcba .PrstClr ;};return _ddbd ;};func (_dbfa *convertContext )getBorderStyle (_cgae *_bf .CT_LineProperties )(_c .CellBorderStyle ,*_c .Color ,float64 ){if _cgae ==nil ||_cgae .NoFill !=nil {return _c .CellBorderStyleNone ,nil ,0;};var _faa _c .Color ;if _affb :=_cgae .SolidFill ;_affb !=nil {_faa ,_ =_dbfa .getColorFromSolidFill (_affb );};_dab :=0.0;if _ddfg :=_cgae .WAttr ;_ddfg !=nil {_dab =_ae .FromEMU (int64 (*_ddfg ));};return _c .CellBorderStyleSingle ,&_faa ,_dab ;};func (_ddgd *textboxContext )assignPropsToCurrentParagraph (_dfc *_bf .CT_TextParagraphProperties ){_ddfbe :=1.1;if _dfc ==nil {_ddgd ._febgd ._aed =_ddfbe ;return ;};if _bacf :=_dfc .MarLAttr ;_bacf !=nil {_ddgd ._febgd ._febf =_ae .FromEMU (int64 (*_bacf ));};_ddgd ._febgd ._bcfb =_ddgd ._abda ;if _gabc :=_dfc .MarRAttr ;_gabc !=nil {_ddgd ._febgd ._bcfb -=_ae .FromEMU (int64 (*_gabc ));};if _dccd :=_dfc .IndentAttr ;_dccd !=nil {_ddgd ._febgd ._dae =_ae .FromEMU (int64 (*_dccd ));};if _cdbb :=_dfc .LatinLnBrkAttr ;_cdbb !=nil {_ddgd ._febgd ._faaf =*_cdbb ;};if _gadc :=_dfc .SpcBef ;_gadc !=nil {if _eafa :=_gadc .SpcPts ;_eafa !=nil {_ddgd ._febgd ._ebb =float64 (_eafa .ValAttr )/100;};};if _ggg :=_dfc .SpcAft ;_ggg !=nil {if _fdga :=_ggg .SpcPts ;_fdga !=nil {_ddgd ._febgd ._edff =float64 (_fdga .ValAttr )/100;};};if _ade :=_dfc .LnSpc ;_ade !=nil {if _ecfg :=_ade .SpcPct ;_ecfg !=nil {if _afa :=_ecfg .ValAttr .ST_TextSpacingPercent ;_afa !=nil {_ddfbe =float64 (*_afa )/100000;};};};_ddgd ._febgd ._aed =_ddfbe ;_ddgd ._febgd ._gdb =_dfc .AlgnAttr ;};

// RegisterFont makes a PdfFont accessible for using in converting to PDF.
func RegisterFont (name string ,style FontStyle ,font *_fc .PdfFont ){_b .RegisterFont (name ,style ,font );};func (_aadd *convertContext )makeStyleFromRPr (_bffa *_bf .CT_TextCharacterProperties )(*_c .TextStyle ,bool ,bool ){var _ebg ,_eab bool ;_bbebg :=_aadd ._acgg .NewTextStyle ();if _bffa !=nil {_fcdd :=_b .FontStyle_Regular ;_aaea :=_aafg (_bffa .BAttr );_gdac :=_aafg (_bffa .IAttr );if _aaea &&_gdac {_fcdd =_b .FontStyle_BoldItalic ;}else if _aaea {_fcdd =_b .FontStyle_Bold ;}else if _gdac {_fcdd =_b .FontStyle_Italic ;};if _bffa .UAttr !=_bf .ST_TextUnderlineTypeUnset &&_bffa .UAttr !=_bf .ST_TextUnderlineTypeNone {_bbebg .Underline =true ;_bbebg .UnderlineStyle =_c .TextDecorationLineStyle {Offset :_ebag (0.5),Thickness :_ebag (1/32)};};_dbe :="\u0064e\u0066\u0061\u0075\u006c\u0074";if _fgc :=_bffa .Latin ;_fgc !=nil {_dbe =_fgc .TypefaceAttr ;}else if _cfgf :=_bffa .Ea ;_cfgf !=nil {_dbe =_cfgf .TypefaceAttr ;}else if _adbg :=_bffa .Cs ;_adbg !=nil {_dbe =_adbg .TypefaceAttr ;}else if _dca :=_bffa .Sym ;_dca !=nil {_dbe =_dca .TypefaceAttr ;};if _cdbe ,_bebe :=_b .StdFontsMap [_dbe ];_bebe {_bbebg .Font =_b .AssignStdFontByName (_bbebg ,_cdbe [_fcdd ]);}else if _gab :=_b .GetRegisteredFont (_dbe ,_fcdd );_gab !=nil {_bbebg .Font =_gab ;}else {_fe .Printf ("\u0046\u006f\u006e\u0074\u0020\u0025\u0073\u0020\u0077\u0069\u0074\u0068\u0020\u0073\u0074y\u006c\u0065\u0020\u0025\u0073\u0020\u0069\u0073\u0020\u006e\u006f\u0074\u0020f\u006f\u0075\u006e\u0064\u002c\u0020\u0072\u0065\u0073\u0065\u0074\u0020to\u0020\u0064\u0065\u0066\u0061\u0075\u006c\u0074\u002e\u000a",_dbe ,_fcdd );_bbebg .Font =_b .AssignStdFontByName (_bbebg ,_b .StdFontsMap ["\u0064e\u0066\u0061\u0075\u006c\u0074"][_fcdd ]);};var _afb float64 ;if _def :=_bffa .SzAttr ;_def !=nil {_afb =float64 (*_def )/100;}else {_afb =_b .DefaultFontSize ;};if _bcea :=_bffa .BaselineAttr ;_bcea !=nil {if _cgeb :=_bcea .ST_PercentageDecimal ;_cgeb !=nil {if *_cgeb > 0{_ebg =true ;}else if *_cgeb < 0{_eab =true ;};};};if _ebg ||_eab {_afb *=0.64;};_bbebg .FontSize =_afb ;_bddb :=0.0;if _gbga :=_bffa .SpcAttr ;_gbga !=nil {if _cccd :=_gbga .ST_TextPointUnqualified ;_cccd !=nil {_bddb =float64 (*_cccd )/100;};};_bbebg .CharSpacing =_bddb ;};return &_bbebg ,_ebg ,_eab ;};func _bbce (_bfffg *_bf .CT_TableCellProperties ,_fbca *_bf .CT_TableStyleCellStyle ,_geec ,_aabedc ,_gefa ,_cebf bool )*_bf .CT_TableCellProperties {_eebc :=_bf .NewCT_TableCellProperties ();if _bfffg !=nil {*_eebc =*_bfffg ;};if _fbca ==nil {return _eebc ;};if _ggff :=_fbca .FillRef ;_ggff !=nil {_bgda :=_bf .NewCT_SolidColorFillProperties ();_bgda .ScrgbClr =_ggff .ScrgbClr ;_bgda .SrgbClr =_ggff .SrgbClr ;_bgda .HslClr =_ggff .HslClr ;_bgda .SysClr =_ggff .SysClr ;_bgda .SchemeClr =_ggff .SchemeClr ;_bgda .PrstClr =_ggff .PrstClr ;_eebc .SolidFill =_bgda ;};if _eebc .NoFill ==nil &&_eebc .SolidFill ==nil {if _dgc :=_fbca .Fill ;_dgc !=nil {if _eebc .NoFill ==nil {_eebc .NoFill =_dgc .NoFill ;};if _eebc .SolidFill ==nil {_eebc .SolidFill =_dgc .SolidFill ;};};};if _fcc :=_fbca .TcBdr ;_fcc !=nil {if _eebc .LnL ==nil {var _gcee *_bf .CT_ThemeableLineStyle ;if _gefa {_gcee =_fcc .Left ;}else {_gcee =_fcc .InsideV ;};if _gcee !=nil {_eebc .LnL =_gcee .Ln ;};};if _eebc .LnR ==nil {var _cgb *_bf .CT_ThemeableLineStyle ;if _cebf {_cgb =_fcc .Right ;}else {_cgb =_fcc .InsideV ;};if _cgb !=nil {_eebc .LnR =_cgb .Ln ;};};if _eebc .LnT ==nil {var _bgdb *_bf .CT_ThemeableLineStyle ;if _geec {_bgdb =_fcc .Top ;}else {_bgdb =_fcc .InsideH ;};if _bgdb !=nil {_eebc .LnT =_bgdb .Ln ;};};if _eebc .LnB ==nil {var _afbf *_bf .CT_ThemeableLineStyle ;if _aabedc {_afbf =_fcc .Bottom ;}else {_afbf =_fcc .InsideH ;};if _afbf !=nil {_eebc .LnB =_afbf .Ln ;};};};return _eebc ;};func (_aeb *textboxContext )newWord (){_aeb ._gada =&word {_dfd :true ,_bbea :_aeb ._eadg ._dcg }};type symbolStyle struct{_gbaf *string ;_beca *float64 ;_gbgc *string ;_cbc *bool ;_ddgeg *bool ;_adaa *bool ;_fee *bool ;_ebcgc *bool ;};func (_abed *convertContext )makePdfDivisionFromTxBody (_beb *_bf .CT_TextBody ,_bcde ,_bbeb float64 ,_cef *_bf .CT_TableStyleTextStyle )*_c .Division {_ddge :=_abed ._acgg .NewDivision ();_gdae :=_abed ._gbb ;_dfb :=_bf .ST_TextAnchoringTypeT ;if _gcf :=_beb .BodyPr ;_gcf !=nil {if _cfgg :=_gcf .AnchorAttr ;_cfgg !=_bf .ST_TextAnchoringTypeUnset {_dfb =_gcf .AnchorAttr ;};};if _ebd :=_beb .LstStyle ;_ebd !=nil {_gdae =_efg (_ebd .Lvl1pPr ,_efg (_ebd .DefPPr ,_gdae ));};for _ ,_feb :=range _beb .P {if _feb !=nil {_agf :=_abed ._acgg .NewStyledParagraph ();_acge :=_efg (_feb .PPr ,_gdae );_eeb :=_ecdfe (_feb .EndParaRPr ,_ecdfe (_acge .DefRPr ,_abed ._bfd ));if len (_feb .EG_TextRun )==0{_agf .Append ("\u000a");_ddge .Add (_agf );continue ;};for _ ,_dcbb :=range _feb .EG_TextRun {if _gcg :=_dcbb .Br ;_gcg !=nil {_agf .Append ("\u000a");}else if _fga :=_dcbb .R ;_fga !=nil {_ffd :=_ddcgf (_fga .RPr ,_cef );_ffd =_ecdfe (_ffd ,_eeb );var _aabe _c .Color ;if _ffd .SolidFill !=nil {_aabe ,_ =_abed .getColorFromSolidFill (_ffd .SolidFill );}else {_aabe =_c .ColorBlack ;};_ace ,_deae ,_deee :=_abed .makeStyleFromRPr (_ffd );_ace .Color =_aabe ;if _deae {_ace .TextRise =0.5;}else if _deee {_ace .TextRise =-0.5;};_ddgc :=_fga .T ;if _ffd .CapAttr ==_bf .ST_TextCapsTypeAll {for _ ,_beff :=range _ddgc {_beff =[]rune (_de .ToUpper (string (_beff )))[0];};};_bba :=_agf .Append (_ddgc );_bba .Style =*_ace ;};};_ =_dfb ;_ddge .Add (_agf );};};return _ddge ;};func (_cfc *convertContext )getShapesFromSpPr (_ada *_bf .CT_ShapeProperties ,_gecc *_bf .CT_ShapeStyle ,_aef bool )([]_c .Drawable ,float64 ,float64 ,float64 ,float64 ,_c .Color ,bool ){_eba :=[]_c .Drawable {};var _caa ,_eaf ,_ddcg ,_ddgg ,_fg float64 ;var _ggc ,_ebcd ,_cfe ,_ddd _c .Color ;var _fad *_bf .CT_BlipFillProperties ;_gca ,_adad :=1.0,1.0;if _gecc !=nil {_ggc ,_ebcd ,_ddd =_cfc .getStyleColors (_gecc );};if _bcf :=_ada .Ln ;_bcf !=nil {if _bcf .NoFill !=nil {_cfe ,_fg =nil ,0;}else {_cfe ,_fg ,_gca =_cfc .getInfoFromLn (_bcf );if _cfe ==nil {_cfe =_ddd ;};};};if _ada .NoFill !=nil {_ebcd ,_adad =nil ,0;}else if _aef {_ebcd =_cfc ._ded ._ebfd ;_adad =_cfc ._ded ._dcge ;_fad =_cfc ._ded ._aaf ;}else if _ccfb :=_ada .SolidFill ;_ccfb !=nil {_ebcd ,_adad =_cfc .getColorFromSolidFill (_ccfb );};var _fda bool ;if _cfa :=_ada .Xfrm ;_cfa !=nil {_caa ,_eaf ,_ddcg ,_ddgg =_b .GetDataFromXfrm (_cfa );_fda =true ;};if _efb :=_ada .CustGeom ;_efb !=nil {_cga :=[]_cb .Point {};_fgf ,_ffac :=1.0,1.0;if _dbdd :=_efb .PathLst ;_dbdd !=nil {for _ ,_gfd :=range _dbdd .Path {if _gfd !=nil {if _egd :=_gfd .WAttr ;_egd !=nil {_fgf =_ddcg /_ae .FromEMU (*_egd );};if _cdc :=_gfd .HAttr ;_cdc !=nil {_ffac =_ddgg /_ae .FromEMU (*_cdc );};for _ ,_gba :=range _gfd .Close {if _gba !=nil {};};for _ ,_fdg :=range _gfd .MoveTo {if _fdg !=nil &&_fdg .Pt !=nil {_bbf ,_gad :=_bfed (_fdg .Pt );_cga =append (_cga ,_cb .Point {X :_bbf *_fgf +_caa ,Y :_gad *_ffac +_eaf });};};for _ ,_eda :=range _gfd .LnTo {if _eda !=nil &&_eda .Pt !=nil {_fac ,_acbd :=_bfed (_eda .Pt );_cga =append (_cga ,_cb .Point {X :_fac *_fgf +_caa ,Y :_acbd *_ffac +_eaf });};};_bae :=_cfc ._acgg .NewPolygon ([][]_cb .Point {_cga });_bae .SetFillColor (_ebcd );_bae .SetFillOpacity (_adad );_bae .SetBorderWidth (_fg );if _cfe !=nil {_bae .SetBorderColor (_cfe );_bae .SetBorderOpacity (_gca );};_eba =append (_eba ,_bae );};};};};if _acd :=_ada .PrstGeom ;_acd !=nil {switch _acd .PrstAttr {case _bf .ST_ShapeTypeRect :if _fad !=nil {_cdb :=_cfc .getShapeFromBlipFill (_fad ,_caa ,_eaf ,_ddcg ,_ddgg );_eba =append (_eba ,_cdb );}else {_cee :=_cfc ._acgg .NewRectangle (_caa ,_eaf ,_ddcg ,_ddgg );_cee .SetFillColor (_ebcd );_cee .SetFillOpacity (_adad );_cee .SetBorderWidth (_fg );if _cfe !=nil {_cee .SetBorderColor (_cfe );_cee .SetBorderOpacity (_gca );};_eba =append (_eba ,_cee );};case _bf .ST_ShapeTypeLine :_gge :=_cfc ._acgg .NewLine (_caa ,_eaf ,_caa +_ddcg ,_eaf +_ddgg );_gge .SetLineWidth (_fg );if _cfe !=nil {_gge .SetColor (_cfe );};_eba =append (_eba ,_gge );};};return _eba ,_caa ,_eaf ,_ddcg ,_ddgg ,_ggc ,_fda ;};func _bacc (_beffd ,_gebg *_bf .CT_TablePartStyle )*_bf .CT_TablePartStyle {_faca :=_bf .NewCT_TablePartStyle ();if _beffd !=nil {*_faca =*_beffd ;};if _gebg ==nil {return _faca ;};if _faca .TcTxStyle ==nil {_faca .TcTxStyle =_gebg .TcTxStyle ;}else {_faca .TcTxStyle =_ddba (_faca .TcTxStyle ,_gebg .TcTxStyle );};if _faca .TcStyle ==nil {_faca .TcStyle =_gebg .TcStyle ;}else {_faca .TcStyle =_fcef (_faca .TcStyle ,_gebg .TcStyle );};return _faca ;};func (_effc *convertContext )renderPageWithDrawableToGoImage (_cccg _c .Drawable )(_db .Image ,error ){_ege :=_b .MakeTempCreator (_effc ._face ,_effc ._gcgf );_ege .NewPage ();_ege .Draw (_cccg );_adf ,_cfba :=_b .GetPageFromCreator (_ege );if _cfba !=nil {return nil ,_cfba ;};return _gd .NewImageDevice ().Render (_adf );};func _gagc (_cccb ,_beaf *_bf .CT_TextListStyle )*_bf .CT_TextListStyle {_bbca :=_bf .NewCT_TextListStyle ();if _cccb !=nil {*_bbca =*_cccb ;};if _beaf ==nil {return _bbca ;};_bbca .DefPPr =_efg (_bbca .DefPPr ,_beaf .DefPPr );_bbca .Lvl1pPr =_efg (_bbca .Lvl1pPr ,_beaf .Lvl1pPr );_bbca .Lvl2pPr =_efg (_bbca .Lvl2pPr ,_beaf .Lvl2pPr );_bbca .Lvl3pPr =_efg (_bbca .Lvl3pPr ,_beaf .Lvl3pPr );_bbca .Lvl4pPr =_efg (_bbca .Lvl4pPr ,_beaf .Lvl4pPr );_bbca .Lvl5pPr =_efg (_bbca .Lvl5pPr ,_beaf .Lvl5pPr );_bbca .Lvl6pPr =_efg (_bbca .Lvl6pPr ,_beaf .Lvl6pPr );_bbca .Lvl7pPr =_efg (_bbca .Lvl7pPr ,_beaf .Lvl7pPr );_bbca .Lvl8pPr =_efg (_bbca .Lvl8pPr ,_beaf .Lvl8pPr );_bbca .Lvl9pPr =_efg (_bbca .Lvl9pPr ,_beaf .Lvl9pPr );return _bbca ;};func (_aec *convertContext )makePdfBlockFromChart (_bb *_aea .Chart ,_ec ,_dd float64 )(*_c .Block ,error ){_eg :=_bb .CT_RelId .IdAttr ;_gb :=_aec ._gaf .GetChartSpaceByRelId (_eg );if _gb ==nil {return nil ,_f .New ("\u004e\u006f\u0020\u0063\u0068\u0061\u0072\u0074\u0073\u0070\u0061\u0063\u0065");};var _bff *_bf .Theme ;_fea :=_aec ._cfde .Themes ();if len (_fea )> 0{_bff =_fea [0];};return _b .MakeBlockFromChartSpace (_gb ,_ec ,_dd ,_bff );};func (_cfee *textboxContext )newLine (){if _cfee ._febgd ==nil {_cfee .newParagraph ();};_befg :=_cfee ._febgd ._gde +_cfee ._febgd ._ebb ;_cdgc :=&line {};_cdgc ._bgee =_cfee ._febgd ._febf ;if len (_cfee ._febgd ._bdf )==0{_cdgc ._bgee +=_cfee ._febgd ._dae ;};_cdgc ._ffab =_cfee ._febgd ._bcfb ;_cdgc ._dcg =_cdgc ._bgee ;_cdgc ._fefa =_befg ;_cfee ._febgd ._bdf =append (_cfee ._febgd ._bdf ,_cdgc );_cfee ._eadg =_cdgc ;};type convertContext struct{_acgg *_c .Creator ;_gea *_b .Rectangle ;_cfde *_g .Presentation ;_gaf *_g .Slide ;_dbdde *_bg .SldMaster ;_cecf *_bg .SldLayout ;_gcgf float64 ;_face float64 ;_geac []_c .Drawable ;_ded *background ;_gbb *_bf .CT_TextParagraphProperties ;_bfd *_bf .CT_TextCharacterProperties ;_dcf *_bf .CT_TextParagraphProperties ;_bad []*_bf .CT_TextParagraphProperties ;_cfeb *_bf .Theme ;_fef *_bf .CT_ColorMappingOverride ;};type paragraph struct{_dffa float64 ;_ebb float64 ;_edff float64 ;_dae float64 ;_febf float64 ;_bcfb float64 ;_edcd float64 ;_gde float64 ;_gdb _bf .ST_TextAlignType ;_aed float64 ;_faaf bool ;_bdf []*line ;};func (_cfac *textboxContext )alignParagraph (){_ffgd :=_cfac ._febgd ;if _ffgd ._gdb ==_bf .ST_TextAlignTypeL {return ;};_gcegb :=len (_ffgd ._bdf )-1;for _dfbc ,_fbe :=range _ffgd ._bdf {_dccf :=true ;_gbbf :=len (_fbe ._ffad );_cca :=0.0;for _ddfba :=len (_fbe ._ffad )-1;_ddfba >=0;_ddfba --{_gedc :=_fbe ._ffad [_ddfba ];if _dccf &&_gedc ._dfd {_gbbf =_ddfba ;}else {_dccf =false ;for _ ,_cefg :=range _gedc ._befc {_cca +=_cefg ._fca ;};};};_fbe ._ffad =_fbe ._ffad [:_gbbf ];_aedf :=_fbe ._ffab -_fbe ._bgee -_cca ;switch _ffgd ._gdb {case _bf .ST_TextAlignTypeR :_fbe .moveRight (_aedf );case _bf .ST_TextAlignTypeCtr :_fbe .moveRight (_aedf /2);case _bf .ST_TextAlignTypeJust :if _dfbc !=_gcegb {_cgafb :=[]*word {};for _ ,_bbebd :=range _fbe ._ffad {if _bbebd ._dfd {_cgafb =append (_cgafb ,_bbebd );};};_cgdd :=_aedf /float64 (len (_cgafb ));for _ ,_ddfgf :=range _cgafb {_ddfgf ._fbd +=_cgdd ;};var _beac *word ;for _ ,_aggc :=range _fbe ._ffad {if _beac !=nil {_aggc ._bbea =_beac ._bbea +_beac ._fbd ;};_beac =_aggc ;};};};};};type textboxContext struct{_ceec *convertContext ;_abda float64 ;_gef float64 ;_cbgf *_c .Creator ;_ebgc float64 ;_gcbb []*paragraph ;_febgd *paragraph ;_eadg *line ;_gada *word ;_bfe bool ;};func (_gfe *convertContext )getColorFromSolidFill (_afcg *_bf .CT_SolidColorFillProperties )(_c .Color ,float64 ){if _afcg ==nil {return nil ,1;};var _bgc string ;_gfcb :=1.0;if _dccb :=_afcg .SrgbClr ;_dccb !=nil {_bgc =_dccb .ValAttr ;_gfcb =_b .GetOpacityFromColorTransform (_dccb .EG_ColorTransform );}else if _gbeb :=_afcg .SchemeClr ;_gbeb !=nil {_bgc =_b .GetColorStringFromDmlColor (_gfe ._gaf .GetColorBySchemeColor (_gbeb .ValAttr ));_bgc =_b .AdjustColor (_bgc ,_gbeb .EG_ColorTransform );_gfcb =_b .GetOpacityFromColorTransform (_gbeb .EG_ColorTransform );};if _bgc !=""{_ddeb :=_c .ColorRGBFromHex ("\u0023"+_bgc );return _ddeb ,_gfcb ;};return nil ,1;};func _dda (_fbba ,_gceb *_bf .CT_TextBody )(*_bf .CT_TextBodyProperties ,*_bf .CT_TextListStyle ){if _fbba ==nil &&_gceb ==nil {return nil ,nil ;};if _fbba ==nil {return _gceb .BodyPr ,_gceb .LstStyle ;};if _gceb ==nil {return _fbba .BodyPr ,_fbba .LstStyle ;};_gcgfe ,_dfcg :=_fbba .BodyPr ,_fbba .LstStyle ;_cafg ,_eadf :=_gceb .BodyPr ,_gceb .LstStyle ;_ceee :=_gadg (_gcgfe ,_cafg );_aefa :=_gagc (_dfcg ,_eadf );return _ceee ,_aefa ;};func _bfed (_ccg *_bf .CT_AdjPoint2D )(float64 ,float64 ){var _caf ,_faf float64 ;_cafb ,_gbbfb :=_ccg .XAttr ,_ccg .YAttr ;if _edd :=_cafb .ST_Coordinate ;_edd !=nil {_caf =_ae .FromEMU (_b .FromSTCoordinate (*_edd ));};if _aeca :=_gbbfb .ST_Coordinate ;_aeca !=nil {_faf =_ae .FromEMU (_b .FromSTCoordinate (*_aeca ));};return _caf ,_faf ;};func _acde (_bda string )[]*symbol {_acee :=[]*symbol {};for _ ,_ecf :=range _bda {_acee =append (_acee ,&symbol {_gfag :string (_ecf )});};return _acee ;};func (_aebg *convertContext )getStyleColors (_efe *_bf .CT_ShapeStyle )(_c .Color ,_c .Color ,_c .Color ){var _daag ,_babf ,_cbcd _c .Color ;if _bga :=_efe .LnRef ;_bga !=nil {_babf =_aebg .getColorFromMatrixReference (_bga );};if _caee :=_efe .FillRef ;_caee !=nil {_cbcd =_aebg .getColorFromMatrixReference (_caee );};if _aggg :=_efe .FontRef ;_aggg !=nil {_daag =_aebg .getColorFromFontReference (_aggg );};return _daag ,_cbcd ,_babf ;};func (_cfd *convertContext )makePdfBlockFromTable (_abd *_bf .Tbl ,_ebf float64 )*_c .Table {_bgge :=_abd .TblGrid ;if _bgge ==nil {return nil ;};_fdge :=len (_bgge .GridCol );if _fdge ==0{return nil ;};_bbg :=[]float64 {};_daa :=0.0;for _ ,_ddfb :=range _bgge .GridCol {_geb :=_ae .FromEMU (_b .FromSTCoordinate (_ddfb .WAttr ));_bbg =append (_bbg ,_geb );_daa +=_geb ;};_ebde :=[]float64 {};for _aaed :=0;_aaed < _fdge ;_aaed ++{_ebde =append (_ebde ,_bbg [_aaed ]/_daa );};_febg :=_cfd ._acgg .NewTable (_fdge );_febg .SetColumnWidths (_ebde ...);_aca :=_abd .TblPr ;var _eagg *_bf .CT_TableStyle ;if _aga :=_aca .Choice ;_aga !=nil {if _aga .TableStyle !=nil {_eagg =_aga .TableStyle ;}else if _aga .TableStyleId !=nil {_eagg =_cfd ._cfde .GetTableStyleById (*_aga .TableStyleId );};};_ddbg :=_bf .NewCT_TablePartStyle ();_ddbg .TcStyle =_bf .NewCT_TableStyleCellStyle ();_ddbg .TcTxStyle =_bf .NewCT_TableStyleTextStyle ();if _eagg !=nil {if _eagg .WholeTbl !=nil {*_ddbg =*_eagg .WholeTbl ;};if _eagg .TblBg !=nil {if _ddbg .TcStyle .Fill ==nil {_ddbg .TcStyle .Fill =_eagg .TblBg .Fill ;};};};if _ddbg .TcStyle .Fill ==nil {_ddbg .TcStyle .Fill =_bf .NewCT_FillProperties ();_ddbg .TcStyle .Fill .NoFill =_aca .NoFill ;_ddbg .TcStyle .Fill .SolidFill =_aca .SolidFill ;};_ddfc :=len (_abd .Tr );for _ddbb ,_ecg :=range _abd .Tr {_egb :=_ddbb ==0;_bdg :=_ddbb ==_ddfc -1;_bcff :=_ddbb %2==0;_ebcf :=len (_ecg .Tc );var _bca *_bf .CT_TablePartStyle ;if _egb {_bca =_eagg .FirstRow ;}else if _bcff {_bca =_eagg .Band2H ;}else {_bca =_eagg .Band1H ;};var _fcg float64 ;for _fdgb ,_gce :=range _ecg .Tc {_cbe :=_fdgb ==0;_eca :=_fdgb ==_ebcf -1;_bbc :=_fdgb %2==0;var _fde *_bf .CT_TablePartStyle ;if _cbe {_fde =_eagg .FirstCol ;}else if _bbc {_fde =_eagg .Band2V ;}else {_fde =_eagg .Band1V ;};_cfb :=_bacc (_bacc (_fde ,_bca ),_ddbg );_ffcb :=_cfd .addCellToTable (_febg ,_gce ,_cfb ,_ebf *_ebde [_fdgb ],_egb ,_bdg ,_cbe ,_eca );if _ffcb > _fcg {_fcg =_ffcb ;};};_cce :=_ae .FromEMU (_b .FromSTCoordinate (_ecg .HAttr ));if _cce < _fcg {_cce =_fcg ;};if _cce < _ebag (4){_cce =_ebag (4);};_febg .SetRowHeight (_febg .CurRow (),_cce );};return _febg ;};const (FontStyle_Regular FontStyle =0;FontStyle_Bold FontStyle =1;FontStyle_Italic FontStyle =2;FontStyle_BoldItalic FontStyle =3;);func (_egf *convertContext )getColorFromFontReference (_dfa *_bf .CT_FontReference )_c .Color {var _egff _c .Color ;var _gddf string ;if _geba :=_dfa .SrgbClr ;_geba !=nil {_gddf =_geba .ValAttr ;}else if _ecdg :=_dfa .SchemeClr ;_ecdg !=nil {_gddf =_b .GetColorStringFromDmlColor (_egf ._cfde .GetColorBySchemeColor (_ecdg .ValAttr ));_gddf =_b .AdjustColor (_gddf ,_ecdg .EG_ColorTransform );};if _gddf !=""{_egff =_c .ColorRGBFromHex ("\u0023"+_gddf );};return _egff ;};func (_gcgc *convertContext )makePdfImageFromBlipFill (_cbgc *_bf .CT_BlipFillProperties )(*_c .Image ,[]*_bf .CT_BlipChoice ,error ){if _aabed :=_cbgc .Blip ;_aabed !=nil {if _bafa :=_aabed .EmbedAttr ;_bafa !=nil {_ggfc ,_ebbb :=_gcgc ._gaf .GetImageByRelID (*_bafa );if _ebbb {_efa ,_adce :=_aa .Open (_ggfc .Path ());if _adce !=nil {_fe .Println ("\u0046\u0069l\u0065\u0020\u006fp\u0065\u006e\u0020\u0065\u0072\u0072\u006f\u0072\u003a",_adce );return nil ,nil ,_adce ;};defer _efa .Close ();_dfag ,_ ,_adce :=_db .Decode (_efa );if _adce !=nil {_fe .Println ("\u0044\u0065\u0063\u006fde\u0020\u0069\u006d\u0061\u0067\u0065\u0020\u0065\u0072\u0072\u006f\u0072\u003a",_adce );return nil ,nil ,_adce ;};if _agaa :=_cbgc .SrcRect ;_agaa !=nil {_fcbg :=_dfag .Bounds ().Size ();_fbfg :=_fcbg .X ;_ecde :=_fcbg .Y ;var _gdg ,_eed ,_edde ,_bebd int ;var _cgaed bool ;if _gdadg :=_agaa .LAttr ;_gdadg !=nil {_gdg =int (float64 (_fbfg )*_b .FromSTPercentage (_gdadg ));_cgaed =true ;}else {_gdg =0;};if _gcba :=_agaa .TAttr ;_gcba !=nil {_edde =int (float64 (_ecde )*_b .FromSTPercentage (_gcba ));_cgaed =true ;}else {_edde =0;};if _gcec :=_agaa .RAttr ;_gcec !=nil {_eed =int (float64 (_fbfg )*(1-_b .FromSTPercentage (_gcec )));_cgaed =true ;}else {_eed =_fbfg ;};if _ffag :=_agaa .BAttr ;_ffag !=nil {_bebd =int (float64 (_ecde )*(1-_b .FromSTPercentage (_ffag )));_cgaed =true ;}else {_bebd =_ecde ;};if _cgaed {_dfag =_b .CropImageByRect (_dfag ,_db .Rect (_gdg ,_edde ,_eed +1,_bebd +1));};};_cbeg ,_adce :=_gcgc ._acgg .NewImageFromGoImage (_dfag );if _adce !=nil {_fe .Println ("\u0043\u0061\u006e\u006e\u006f\u0074\u0020\u0063\u0072\u0065\u0061\u0074\u0065\u0020\u0050\u0044\u0046\u0020\u0069\u006d\u0061\u0067\u0065\u0020f\u0072\u006f\u006d\u0020\u0047o\u0020\u0069m\u0061\u0067\u0065\u003a",_adce );return nil ,nil ,_adce ;};return _cbeg ,_aabed .Choice ,nil ;};};};return nil ,nil ,nil ;};func _gadg (_acdb ,_ggfbg *_bf .CT_TextBodyProperties )*_bf .CT_TextBodyProperties {_adgb :=_bf .NewCT_TextBodyProperties ();if _acdb !=nil {*_adgb =*_acdb ;};if _ggfbg ==nil {return _adgb ;};if _adgb .RotAttr ==nil {_adgb .RotAttr =_ggfbg .RotAttr ;};if _adgb .SpcFirstLastParaAttr ==nil {_adgb .SpcFirstLastParaAttr =_ggfbg .SpcFirstLastParaAttr ;};if _adgb .VertOverflowAttr ==_bf .ST_TextVertOverflowTypeUnset {_adgb .VertOverflowAttr =_ggfbg .VertOverflowAttr ;};if _adgb .HorzOverflowAttr ==_bf .ST_TextHorzOverflowTypeUnset {_adgb .HorzOverflowAttr =_ggfbg .HorzOverflowAttr ;};if _adgb .VertAttr ==_bf .ST_TextVerticalTypeUnset {_adgb .VertAttr =_ggfbg .VertAttr ;};if _adgb .WrapAttr ==_bf .ST_TextWrappingTypeUnset {_adgb .WrapAttr =_ggfbg .WrapAttr ;};if _adgb .LInsAttr ==nil {_adgb .LInsAttr =_ggfbg .LInsAttr ;};if _adgb .TInsAttr ==nil {_adgb .TInsAttr =_ggfbg .TInsAttr ;};if _adgb .RInsAttr ==nil {_adgb .RInsAttr =_ggfbg .RInsAttr ;};if _adgb .BInsAttr ==nil {_adgb .BInsAttr =_ggfbg .BInsAttr ;};if _adgb .NumColAttr ==nil {_adgb .NumColAttr =_ggfbg .NumColAttr ;};if _adgb .SpcColAttr ==nil {_adgb .SpcColAttr =_ggfbg .SpcColAttr ;};if _adgb .RtlColAttr ==nil {_adgb .RtlColAttr =_ggfbg .RtlColAttr ;};if _adgb .AnchorAttr ==_bf .ST_TextAnchoringTypeUnset {_adgb .AnchorAttr =_ggfbg .AnchorAttr ;};if _adgb .AnchorCtrAttr ==nil {_adgb .AnchorCtrAttr =_ggfbg .AnchorCtrAttr ;};if _adgb .ForceAAAttr ==nil {_adgb .ForceAAAttr =_ggfbg .ForceAAAttr ;};if _adgb .UprightAttr ==nil {_adgb .UprightAttr =_ggfbg .UprightAttr ;};if _adgb .CompatLnSpcAttr ==nil {_adgb .CompatLnSpcAttr =_ggfbg .CompatLnSpcAttr ;};if _adgb .PrstTxWarp ==nil {_adgb .PrstTxWarp =_ggfbg .PrstTxWarp ;};if _adgb .NoAutofit ==nil {_adgb .NoAutofit =_ggfbg .NoAutofit ;};if _adgb .NormAutofit ==nil {_adgb .NormAutofit =_ggfbg .NormAutofit ;};if _adgb .SpAutoFit ==nil {_adgb .SpAutoFit =_ggfbg .SpAutoFit ;};if _adgb .Scene3d ==nil {_adgb .Scene3d =_ggfbg .Scene3d ;};if _adgb .Sp3d ==nil {_adgb .Sp3d =_ggfbg .Sp3d ;};if _adgb .FlatTx ==nil {_adgb .FlatTx =_ggfbg .FlatTx ;};if _adgb .ExtLst ==nil {_adgb .ExtLst =_ggfbg .ExtLst ;};return _adgb ;};

// FontStyle represents a kind of font styling. It can be FontStyle_Regular, FontStyle_Bold, FontStyle_Italic and FontStyle_BoldItalic.
type FontStyle =_b .FontStyle ;func (_aced *convertContext )makePdfBlockFromTxBody (_dbf *_bf .CT_TextBody ,_fead *_bf .CT_TextBodyProperties ,_af *_bf .CT_TextListStyle ,_feag ,_bea float64 ,_cgf _c .Color ,_cgcg bool )(*_c .Block ,error ){_ecc :=_b .MakeTempCreator (_feag ,_bea );_bbed ,_bcbe :=_ebag (2.5),_ebag (2.5);_eggf ,_acdc :=_ebag (1.3),_ebag (1.3);_dffd :=true ;var _deeb *_bf .CT_TextParagraphProperties ;if _cgcg {_deeb =_aced ._dcf ;}else {_deeb =_aced ._gbb ;};_eecc :=_bf .ST_TextAnchoringTypeT ;if _fead !=nil {if _gdfg :=_fead .AnchorAttr ;_gdfg !=_bf .ST_TextAnchoringTypeUnset {_eecc =_gdfg ;};};if _af !=nil {_deeb =_efg (_af .Lvl1pPr ,_efg (_af .DefPPr ,_deeb ));};if _cgce :=_dbf .BodyPr ;_cgce !=nil {if _ddb :=_cgce .LInsAttr ;_ddb !=nil {_bbed =_ae .FromEMU (_b .FromSTCoordinate32 (*_ddb ));};if _cfcf :=_cgce .TInsAttr ;_cfcf !=nil {_eggf =_ae .FromEMU (_b .FromSTCoordinate32 (*_cfcf ));};if _aff :=_cgce .RInsAttr ;_aff !=nil {_bcbe =_ae .FromEMU (_b .FromSTCoordinate32 (*_aff ));};if _egdd :=_cgce .BInsAttr ;_egdd !=nil {_acdc =_ae .FromEMU (_b .FromSTCoordinate32 (*_egdd ));};_dffd =_cgce .WrapAttr !=_bf .ST_TextWrappingTypeNone ;if _cgaa :=_cgce .AnchorAttr ;_cgaa !=_bf .ST_TextAnchoringTypeUnset {_eecc =_cgce .AnchorAttr ;};};_ecc .SetPageMargins (_bbed ,_bcbe ,_eggf ,_acdc );_ega :=&textboxContext {_ceec :_aced ,_bfe :_dffd ,_abda :_feag -_bbed -_bcbe ,_gef :_bea -_eggf -_acdc ,_cbgf :_ecc ,_gcbb :[]*paragraph {}};if _gag :=_dbf .LstStyle ;_gag !=nil {_deeb =_efg (_gag .Lvl1pPr ,_efg (_gag .DefPPr ,_deeb ));};for _ ,_efde :=range _dbf .P {if _efde !=nil {_ceca :=_efg (_efde .PPr ,_deeb );_cgaf :=_ecdfe (_efde .EndParaRPr ,_ecdfe (_ceca .DefRPr ,_aced ._bfd ));_ega .newParagraph ();_ega .assignPropsToCurrentParagraph (_ceca );_ega .newLine ();_ega .newWord ();for _ ,_bcdfa :=range _efde .EG_TextRun {_ega .addTextRun (_bcdfa ,_cgaf ,_cgf );};_ega .addCurrentWordToParagraph ();};_ega .addCurrentParagraph ();};_ega .alignVertically (_eecc );_ega .drawParagraphs ();return _b .MakeBlockFromCreator (_ecc );};type word struct{_befc []*symbol ;_bbea float64 ;_fbd float64 ;_dfd bool ;};func (_adb *convertContext )getShapes (_gdf *_bg .CT_Shape )[]_c .Drawable {_ggd :=[]_c .Drawable {};_abeb :=_gdf .SpPr ;if _abeb ==nil {return _ggd ;};var _ffg bool ;if _eea :=_gdf .UseBgFillAttr ;_eea !=nil {_ffg =*_eea ;};_dcb ,_edfa ,_ag ,_gdc ,_cbd ,_gbg ,_bcb :=_adb .getShapesFromSpPr (_abeb ,_gdf .Style ,_ffg );_ggd =append (_ggd ,_dcb ...);if _ffa :=_gdf .TxBody ;_ffa !=nil {_fab ,_aade ,_ddcf ,_ebc :=_adb .getPhData (_gdf );if _fab !=nil &&!_bcb {_edfa ,_ag ,_gdc ,_cbd =_b .GetDataFromXfrm (_fab );};_agc ,_ebcg :=_adb .makePdfBlockFromTxBody (_ffa ,_aade ,_ddcf ,_gdc ,_cbd ,_gbg ,_ebc );if _ebcg !=nil {_fe .Println ("C\u0061\u006e\u006e\u006f\u0074\u0020m\u0061\u006b\u0065\u0020\u0050\u0044F\u0020\u0062\u006c\u006f\u0063\u006b\u0020f\u0072\u006f\u006d\u0020\u0074\u0065\u0078\u0074\u0062\u006fx\u003a",_ebcg );}else if _agc !=nil {_agc .SetPos (_edfa ,_ag );_ggd =append (_ggd ,_agc );};};return _ggd ;};func (_bceaf *textboxContext )adjustHeights (_bbee float64 ){if _bceaf ._eadg ._bgd < _bbee {_bceaf ._febgd ._gde +=(_bbee -_bceaf ._eadg ._bgd );_bceaf ._eadg ._bgd =_bbee ;};};type symbol struct{_gfag string ;_bggeb float64 ;_dag float64 ;_agb float64 ;_fca float64 ;_ebgg *_c .TextStyle ;_ccfc string ;_agd bool ;_feac bool ;};func (_gccd *textboxContext )addTextRun (_bfce *_bf .EG_TextRun ,_ggfbd *_bf .CT_TextCharacterProperties ,_fgg _c .Color ){if _bfcg :=_bfce .Br ;_bfcg !=nil {_gccd .addCurrentWordToParagraph ();_gccd .newLine ();_gccd .newWord ();}else if _dgdc :=_bfce .R ;_dgdc !=nil {var _dgg _c .Color ;if _dgdc .RPr .SolidFill !=nil {_dgg ,_ =_gccd ._ceec .getColorFromSolidFill (_dgdc .RPr .SolidFill );}else if _fgg !=nil {_dgg =_fgg ;}else if _ggfbd .SolidFill !=nil {_dgg ,_ =_gccd ._ceec .getColorFromSolidFill (_ggfbd .SolidFill );}else {_dgg =_c .ColorBlack ;};_bafbb :=_ecdfe (_dgdc .RPr ,_ggfbd );_fdgg ,_aeea ,_fefg :=_gccd ._ceec .makeStyleFromRPr (_bafbb );_fdgg .Color =_dgg ;_eebb :=_acde (_dgdc .T );for _ ,_agdc :=range _eebb {_agdc ._ebgg =_fdgg ;_agdc ._agd =_aeea ;_agdc ._feac =_fefg ;if _bafbb .CapAttr ==_bf .ST_TextCapsTypeAll {_agdc ._gfag =_de .ToUpper (_agdc ._gfag );};_gccd .addTextSymbol (_agdc );};};};func _cgddd (_ebeg *_bg .CT_Shape )(_bg .ST_PlaceholderType ,*uint32 ){if _bcfe :=_ebeg .NvSpPr ;_bcfe !=nil {if _aeg :=_bcfe .NvPr ;_aeg !=nil {if _ebaa :=_aeg .Ph ;_ebaa !=nil {return _ebaa .TypeAttr ,_ebaa .IdxAttr ;};};};return _bg .ST_PlaceholderTypeUnset ,nil ;};func _fcef (_fdgd ,_gcab *_bf .CT_TableStyleCellStyle )*_bf .CT_TableStyleCellStyle {_fgb :=_bf .NewCT_TableStyleCellStyle ();if _fdgd !=nil {*_fgb =*_fdgd ;};if _gcab ==nil {return _fgb ;};if _fgb .TcBdr ==nil {_fgb .TcBdr =_gcab .TcBdr ;};if _fgb .Fill ==nil {_fgb .Fill =_gcab .Fill ;};if _fgb .FillRef ==nil {_fgb .FillRef =_gcab .FillRef ;};return _fgb ;};func (_cdcd *convertContext )getPhData (_ebbd *_bg .CT_Shape )(*_bf .CT_Transform2D ,*_bf .CT_TextBodyProperties ,*_bf .CT_TextListStyle ,bool ){_ffaf ,_gcff :=_cgddd (_ebbd );_fcac :=_gcff ==nil ;_gfb ,_gcbbg ,_gcac :=_bcbb (_cdcd ._dbdde .CSld ,_ffaf ,_gcff ,_fcac );_adcg ,_dgaa ,_fcgdd :=_bcbb (_cdcd ._cecf .CSld ,_ffaf ,_gcff ,_fcac );if _adcg ==nil {_adcg =_gfb ;};_bfff ,_fagg :=_dda (_dgaa ,_gcbbg );var _gae bool ;if _fcgdd ==nil {if _gcac !=nil {_gae =*_gcac ;};}else {_gae =*_fcgdd ;};return _adcg ,_bfff ,_fagg ,_gae ;};func (_bafb *textboxContext )newParagraph (){_egbg :=&paragraph {};_egbg ._edcd =_bafb ._ebgc ;_bafb ._febgd =_egbg ;};func (_cadc *textboxContext )alignParagraphsVertically (_ddfbed _bf .ST_TextAnchoringType ){if _ddfbed ==_bf .ST_TextAnchoringTypeT {return ;};_cdfb :=0.0;for _ ,_gbe :=range _cadc ._gcbb {_cdfb +=_gbe ._ebb +_gbe ._gde +_gbe ._edff ;};var _abgb float64 ;switch _ddfbed {case _bf .ST_TextAnchoringTypeCtr :_abgb =(_cadc ._gef -_cdfb )/2;case _bf .ST_TextAnchoringTypeB :_abgb =_cadc ._gef -_cdfb ;};for _ ,_fdgba :=range _cadc ._gcbb {_fdgba ._edcd +=_abgb ;};};func _ecdfe (_efaf ,_dddf *_bf .CT_TextCharacterProperties )*_bf .CT_TextCharacterProperties {_adg :=_bf .NewCT_TextCharacterProperties ();if _efaf !=nil {*_adg =*_efaf ;};if _dddf ==nil {return _adg ;};if _adg .KumimojiAttr ==nil {_adg .KumimojiAttr =_dddf .KumimojiAttr ;};if _adg .LangAttr ==nil {_adg .LangAttr =_dddf .LangAttr ;};if _adg .AltLangAttr ==nil {_adg .AltLangAttr =_dddf .AltLangAttr ;};if _adg .SzAttr ==nil {_adg .SzAttr =_dddf .SzAttr ;};if _adg .BAttr ==nil {_adg .BAttr =_dddf .BAttr ;};if _adg .IAttr ==nil {_adg .IAttr =_dddf .IAttr ;};if _adg .UAttr ==_bf .ST_TextUnderlineTypeUnset {_adg .UAttr =_dddf .UAttr ;};if _adg .StrikeAttr ==_bf .ST_TextStrikeTypeUnset {_adg .StrikeAttr =_dddf .StrikeAttr ;};if _adg .KernAttr ==nil {_adg .KernAttr =_dddf .KernAttr ;};if _adg .CapAttr ==_bf .ST_TextCapsTypeUnset {_adg .CapAttr =_dddf .CapAttr ;};if _adg .SpcAttr ==nil {_adg .SpcAttr =_dddf .SpcAttr ;};if _adg .NormalizeHAttr ==nil {_adg .NormalizeHAttr =_dddf .NormalizeHAttr ;};if _adg .BaselineAttr ==nil {_adg .BaselineAttr =_dddf .BaselineAttr ;};if _adg .NoProofAttr ==nil {_adg .NoProofAttr =_dddf .NoProofAttr ;};if _adg .DirtyAttr ==nil {_adg .DirtyAttr =_dddf .DirtyAttr ;};if _adg .ErrAttr ==nil {_adg .ErrAttr =_dddf .ErrAttr ;};if _adg .SmtCleanAttr ==nil {_adg .SmtCleanAttr =_dddf .SmtCleanAttr ;};if _adg .SmtIdAttr ==nil {_adg .SmtIdAttr =_dddf .SmtIdAttr ;};if _adg .BmkAttr ==nil {_adg .BmkAttr =_dddf .BmkAttr ;};if _adg .Ln ==nil {_adg .Ln =_dddf .Ln ;};if _adg .NoFill ==nil {_adg .NoFill =_dddf .NoFill ;};if _adg .SolidFill ==nil {_adg .SolidFill =_dddf .SolidFill ;};if _adg .BlipFill ==nil {_adg .BlipFill =_dddf .BlipFill ;};if _adg .EffectLst ==nil {_adg .EffectLst =_dddf .EffectLst ;};if _adg .EffectDag ==nil {_adg .EffectDag =_dddf .EffectDag ;};if _adg .Highlight ==nil {_adg .Highlight =_dddf .Highlight ;};if _adg .ULnTx ==nil {_adg .ULnTx =_dddf .ULnTx ;};if _adg .ULn ==nil {_adg .ULn =_dddf .ULn ;};if _adg .UFillTx ==nil {_adg .UFillTx =_dddf .UFillTx ;};if _adg .UFill ==nil {_adg .UFill =_dddf .UFill ;};if _adg .Latin ==nil {_adg .Latin =_dddf .Latin ;};if _adg .Ea ==nil {_adg .Ea =_dddf .Ea ;};if _adg .Cs ==nil {_adg .Cs =_dddf .Cs ;};if _adg .Sym ==nil {_adg .Sym =_dddf .Sym ;};if _adg .Rtl ==nil {_adg .Rtl =_dddf .Rtl ;};return _adg ;};type line struct{_fefa float64 ;_bgee float64 ;_ffab float64 ;_dcg float64 ;_bgd float64 ;_ffad []*word ;};func _bcbb (_ecfb *_bg .CT_CommonSlideData ,_gdcd _bg .ST_PlaceholderType ,_bfac *uint32 ,_agda bool )(*_bf .CT_Transform2D ,*_bf .CT_TextBody ,*bool ){if _ecfb !=nil {if _ffb :=_ecfb .SpTree ;_ffb !=nil {for _ ,_affe :=range _ffb .Choice {if _affe !=nil {for _ ,_ccb :=range _affe .Sp {if _ccb !=nil {_dfda ,_gbeg :=_cgddd (_ccb );if _gdcd ==_dfda {if (_agda &&_gbeg ==nil )||(!_agda &&_gbeg !=nil &&*_gbeg ==*_bfac ){var _bgaa *_bf .CT_Transform2D ;if _ccb .SpPr !=nil {_bgaa =_ccb .SpPr .Xfrm ;};_eff :=_gdcd ==_bg .ST_PlaceholderTypeTitle ||_gdcd ==_bg .ST_PlaceholderTypeCtrTitle ;return _bgaa ,_ccb .TxBody ,&_eff ;};};};};};};};};return nil ,nil ,nil ;};func (_bbb *convertContext )renderCurrentStateToGoImage ()(_db .Image ,error ){_bggdg :=_b .MakeTempCreator (_bbb ._face ,_bbb ._gcgf );_bggdg .NewPage ();for _ ,_ddca :=range _bbb ._geac {if _ddca !=nil {_bggdg .MoveTo (0,0);_bggdg .Draw (_ddca );};};_aeaa ,_febe :=_b .GetPageFromCreator (_bggdg );if _febe !=nil {return nil ,_febe ;};return _gd .NewImageDevice ().Render (_aeaa );};func (_edbc *textboxContext )drawParagraphs (){_edbc ._cbgf .NewPage ();for _ ,_bbfd :=range _edbc ._gcbb {for _ ,_bfdg :=range _bbfd ._bdf {for _ ,_gcfb :=range _bfdg ._ffad {for _ ,_agcd :=range _gcfb ._befc {_cae :=_edbc ._cbgf .NewStyledParagraph ();if _agcd ._agd {_agcd ._agb =0;}else if _agcd ._feac {_agcd ._agb =1.2*_bfdg ._bgd -_agcd ._dag ;};_fgad :=_gcfb ._bbea +_agcd ._bggeb ;_ddfd :=_bbfd ._edcd +_bfdg ._fefa +_agcd ._agb ;_cae .SetPos (_fgad ,_ddfd );_gefe :=_cae .Append (_agcd ._gfag );if _agcd ._ebgg !=nil {_gefe .Style =*_agcd ._ebgg ;};_edbc ._cbgf .Draw (_cae );};};};};};func (_ead *convertContext )drawSlide (){_ead ._acgg .NewPage ();for _ ,_acg :=range _ead ._geac {if _acg !=nil {_ead ._acgg .MoveTo (0,0);_ead ._acgg .Draw (_acg );};};};func (_cgc *convertContext )makeSlide (){_dgd :=_cgc ._gaf .X ().CSld ;if _dgd ==nil {return ;};_bbd :=&background {};if _abb :=_dgd .Bg ;_abb !=nil {if _ff :=_abb .BgPr ;_ff !=nil {if _ff .NoFill ==nil {if _abe :=_ff .SolidFill ;_abe !=nil {_bac ,_df :=_cgc .getColorFromSolidFill (_abe );if _bac !=nil {_bbd ._ebfd =_bac ;_bbd ._dcge =_df ;};}else if _gf :=_ff .BlipFill ;_gf !=nil {_bbd ._aaf =_gf ;};};};};_cgc ._ded =_bbd ;if _feae :=_dgd .SpTree ;_feae !=nil {for _ ,_fcd :=range _feae .Choice {if _fcd !=nil {for _ ,_be :=range _fcd .Sp {if _be !=nil {_ece :=_cgc .getShapes (_be );_cgc ._geac =append (_cgc ._geac ,_ece ...);};};for _ ,_bfc :=range _fcd .GraphicFrame {if _bfc !=nil {var _acb ,_bfb ,_fed ,_ecdf float64 ;if _ef :=_bfc .Xfrm ;_ef !=nil {_acb ,_bfb ,_fed ,_ecdf =_b .GetDataFromXfrm (_ef );};if _egg :=_bfc .Graphic ;_egg !=nil {if _dcd :=_egg .GraphicData ;_dcd !=nil {for _ ,_edca :=range _dcd .Any {if _fb ,_cfg :=_edca .(*_aea .Chart );_cfg {_gdd ,_baa :=_cgc .makePdfBlockFromChart (_fb ,_fed ,_ecdf );if _baa !=nil {_fe .Println ("\u0043a\u006en\u006f\u0074\u0020\u0072\u0065a\u0064\u0020b\u006c\u006f\u0063\u006b\u003a",_baa );};if _gdd !=nil {_gdd .SetPos (_acb ,_bfb );_cgc ._geac =append (_cgc ._geac ,_gdd );};}else if _eag ,_dbg :=_edca .(*_bf .Tbl );_dbg {_bcdf :=_cgc .makePdfBlockFromTable (_eag ,_fed );if _bcdf !=nil {_bec :=_c .NewBlock (_fed ,_ecdf );_bec .SetPos (_acb ,_bfb );_bec .Draw (_bcdf );_cgc ._geac =append (_cgc ._geac ,_bec );};};};};};};};for _ ,_gg :=range _fcd .CxnSp {if _gg !=nil {_gfa :=_cgc .getConnectors (_gg );_cgc ._geac =append (_cgc ._geac ,_gfa ...);};};for _ ,_dee :=range _fcd .Pic {if _dee !=nil {var _gff ,_bd ,_eeg ,_ecb float64 ;if _ccf :=_dee .SpPr ;_ccf !=nil {if _beg :=_ccf .Xfrm ;_beg !=nil {_gff ,_bd ,_eeg ,_ecb =_b .GetDataFromXfrm (_beg );};};if _cd :=_dee .BlipFill ;_cd !=nil {_cdf :=_cgc .getShapeFromBlipFill (_cd ,_gff ,_bd ,_eeg ,_ecb );_cgc ._geac =append (_cgc ._geac ,_cdf );};};};};};};};var _ba =_ebag (1.9);func (_fgd *convertContext )getShapeFromBlipFill (_bfa *_bf .CT_BlipFillProperties ,_dcaf ,_dfdf ,_agff ,_bebec float64 )_c .Drawable {_bede ,_afca ,_efc :=_fgd .makePdfImageFromBlipFill (_bfa );if _efc !=nil {_fe .Println ("\u0043\u0061nn\u006f\u0074\u0020m\u0061\u006b\u0065\u0020PDF\u0020im\u0061\u0067\u0065\u0020\u0066\u0072\u006fm \u0042\u006c\u0069\u0070\u0046\u0069\u006cl\u003a",_efc );return nil ;};if _bede ==nil {return nil ;};if _cgdb :=_bfa .Tile ;_cgdb !=nil {_bede =_fgd .tileImage (_bede ,_bfa .Tile ,_agff ,_bebec );};if _ccda :=_bfa .Stretch ;_ccda !=nil {_bede ,_dcaf ,_dfdf =_fgd .stretchImage (_bede ,_bfa .Stretch ,_dcaf ,_dfdf ,_agff ,_bebec );};if len (_afca )==0{_bede .SetPos (_dcaf ,_dfdf );return _bede ;};_bede =_fgd .applyBlipEffectsOnImg (_bede ,_dcaf ,_dfdf ,_afca );_bede .SetPos (_dcaf ,_dfdf );return _bede ;};type background struct{_ebfd _c .Color ;_dcge float64 ;_aaf *_bf .CT_BlipFillProperties ;};func (_edce *convertContext )getInfoFromLn (_efdc *_bf .CT_LineProperties )(_c .Color ,float64 ,float64 ){if _efdc ==nil ||_efdc .NoFill !=nil {return nil ,0,0;};var _bdfa float64 ;_gbbc ,_dabb :=_edce .getColorFromSolidFill (_efdc .SolidFill );if _cgeg :=_efdc .WAttr ;_cgeg !=nil {_bdfa =_ae .FromEMU (int64 (*_cgeg ));}else {_bdfa =1;};return _gbbc ,_bdfa ,_dabb ;};func _ddcgf (_fec *_bf .CT_TextCharacterProperties ,_ddfe *_bf .CT_TableStyleTextStyle )*_bf .CT_TextCharacterProperties {_gdce :=_bf .NewCT_TextCharacterProperties ();if _fec !=nil {*_gdce =*_fec ;};if _ddfe ==nil {return _gdce ;};if _gdce .BAttr ==nil &&_ddfe .BAttr !=_bf .ST_OnOffStyleTypeUnset {_adbgc :=_ddfe .BAttr ==_bf .ST_OnOffStyleTypeOn ;_gdce .BAttr =&_adbgc ;};if _gdce .IAttr ==nil &&_ddfe .IAttr !=_bf .ST_OnOffStyleTypeUnset {_bfced :=_ddfe .IAttr ==_bf .ST_OnOffStyleTypeOn ;_gdce .IAttr =&_bfced ;};if _gdce .NoFill ==nil &&_gdce .SolidFill ==nil {_gdce .SolidFill =_bf .NewCT_SolidColorFillProperties ();_gdce .SolidFill .ScrgbClr =_ddfe .ScrgbClr ;_gdce .SolidFill .SrgbClr =_ddfe .SrgbClr ;_gdce .SolidFill .HslClr =_ddfe .HslClr ;_gdce .SolidFill .SysClr =_ddfe .SysClr ;_gdce .SolidFill .SchemeClr =_ddfe .SchemeClr ;_gdce .SolidFill .PrstClr =_ddfe .PrstClr ;};if _bfcea :=_ddfe .Font ;_bfcea !=nil &&_gdce .Latin ==nil &&_gdce .Ea ==nil &&_gdce .Cs ==nil {_gdce .Latin =_bfcea .Latin ;_gdce .Ea =_bfcea .Ea ;_gdce .Cs =_bfcea .Cs ;};return _gdce ;};func (_afc *convertContext )addCellToTable (_afg *_c .Table ,_bfbe *_bf .CT_TableCell ,_efbe *_bf .CT_TablePartStyle ,_ddgcf float64 ,_bbdc ,_acgef ,_dbca ,_cdg bool )float64 {var _facd *_c .TableCell ;_cacc :=1;if _bfbe .GridSpanAttr !=nil {_cacc =int (*_bfbe .GridSpanAttr );};_facd =_afg .MultiColCell (_cacc );_eabb :=_bfbe .TcPr ;var _cdbc *_bf .CT_TableStyleTextStyle ;if _efbe !=nil {_eabb =_bbce (_eabb ,_efbe .TcStyle ,_bbdc ,_acgef ,_dbca ,_cdg );_cdbc =_efbe .TcTxStyle ;};_bafg :=_ba ;_acc :=_c .CellVerticalAlignmentMiddle ;if _eabb !=nil {if _cbg :=_eabb .LnL ;_cbg !=nil {_gaa ,_cgca ,_gaac :=_afc .getBorderStyle (_cbg );_facd .SetBorder (_c .CellBorderSideLeft ,_gaa ,_gaac );if _cgca !=nil &&*_cgca !=nil {_facd .SetSideBorderColor (_c .CellBorderSideLeft ,*_cgca );};};if _afcd :=_eabb .LnT ;_afcd !=nil {_deac ,_cgcec ,_ecgc :=_afc .getBorderStyle (_afcd );_facd .SetBorder (_c .CellBorderSideTop ,_deac ,_ecgc );if _cgcec !=nil &&*_cgcec !=nil {_facd .SetSideBorderColor (_c .CellBorderSideTop ,*_cgcec );};};if _cdd :=_eabb .LnR ;_cdd !=nil {_egag ,_eecg ,_abca :=_afc .getBorderStyle (_cdd );_facd .SetBorder (_c .CellBorderSideRight ,_egag ,_abca );if _eecg !=nil &&*_eecg !=nil {_facd .SetSideBorderColor (_c .CellBorderSideRight ,*_eecg );};};if _cfbf :=_eabb .LnB ;_cfbf !=nil {_bceb ,_acca ,_bddf :=_afc .getBorderStyle (_cfbf );_facd .SetBorder (_c .CellBorderSideBottom ,_bceb ,_bddf );if _acca !=nil &&*_acca !=nil {_facd .SetSideBorderColor (_c .CellBorderSideBottom ,*_acca );};};if _ebcfd :=_eabb .MarLAttr ;_ebcfd !=nil {_bafg =float64 (_b .FromSTCoordinate32 (*_ebcfd ));};switch _eabb .AnchorAttr {case _bf .ST_TextAnchoringTypeT :_acc =_c .CellVerticalAlignmentTop ;case _bf .ST_TextAnchoringTypeB :_acc =_c .CellVerticalAlignmentBottom ;};if _eabb .NoFill ==nil {if _bfcc :=_eabb .SolidFill ;_bfcc !=nil {_agca ,_ :=_afc .getColorFromSolidFill (_bfcc );_facd .SetBackgroundColor (_agca );};};};_facd .SetVerticalAlignment (_acc );_facd .SetIndent (_bafg );var _bcbea float64 ;if _dbgg :=_bfbe .TxBody ;_dbgg !=nil {_gee :=_afc .makePdfDivisionFromTxBody (_dbgg ,_ddgcf ,_bcbea ,_cdbc );_bcbea =_gee .Height ();_facd .SetContent (_gee );};return _bcbea ;};func (_bfbd *convertContext )applyBlipEffectsOnImg (_efgg *_c .Image ,_aaab ,_cgbf float64 ,_aag []*_bf .CT_BlipChoice )*_c .Image {if len (_aag )==0{return _efgg ;};_efgg .SetPos (_aaab ,_cgbf );_ffde ,_efab :=_bfbd .renderPageWithDrawableToGoImage (_efgg );if _efab !=nil {_fe .Println (_efab );return _efgg ;};_bgea ,_efab :=_bfbd .renderCurrentStateToGoImage ();if _efab !=nil {_fe .Println (_efab );return _efgg ;};_bacg :=_ffde .Bounds ();_dac :=_db .NewRGBA (_bacg );_facdd ,_abde :=_efgg .Width (),_efgg .Height ();for _ ,_agcac :=range _aag {for _ ,_bde :=range _agcac .AlphaModFix {if _aage :=_bde .AmtAttr ;_aage !=nil {if _gbag :=_aage .ST_PositivePercentageDecimal ;_gbag !=nil {_becc :=uint8 (255*(*_gbag )/100000);_bgcb :=_db .NewUniform (_e .Alpha {_becc });_d .Draw (_dac ,_bacg ,_bgea ,_db .Point {0,0},_d .Src );_d .DrawMask (_dac ,_bacg ,_ffde ,_db .Point {0,0},_bgcb ,_db .Point {0,0},_d .Over );};};};};_aceb :=_db .Rect (int (_aaab ),int (_cgbf ),int (_aaab +_facdd )+1,int (_cgbf +_abde )+1);_afgd :=_b .CropImageByRect (_dac ,_aceb );_gdff ,_efab :=_bfbd ._acgg .NewImageFromGoImage (_afgd );if _efab !=nil {_fe .Println (_efab );return _efgg ;};return _gdff ;};func (_gdad *textboxContext )addCurrentParagraph (){_gdad ._ebgc =_gdad ._febgd ._edcd +_gdad ._febgd ._ebb +_gdad ._febgd ._gde +_gdad ._febgd ._edff ;_gdad ._gcbb =append (_gdad ._gcbb ,_gdad ._febgd );_gdad .alignParagraph ();};func _efg (_fdgc ,_edbg *_bf .CT_TextParagraphProperties )*_bf .CT_TextParagraphProperties {_fcgdg :=_bf .NewCT_TextParagraphProperties ();if _fdgc !=nil {*_fcgdg =*_fdgc ;};if _edbg ==nil {return _fcgdg ;};if _fcgdg .MarLAttr ==nil {_fcgdg .MarLAttr =_edbg .MarLAttr ;};if _fcgdg .MarRAttr ==nil {_fcgdg .MarRAttr =_edbg .MarRAttr ;};if _fcgdg .LvlAttr ==nil {_fcgdg .LvlAttr =_edbg .LvlAttr ;};if _fcgdg .IndentAttr ==nil {_fcgdg .IndentAttr =_edbg .IndentAttr ;};if _fcgdg .AlgnAttr ==_bf .ST_TextAlignTypeUnset {_fcgdg .AlgnAttr =_edbg .AlgnAttr ;};if _fcgdg .DefTabSzAttr ==nil {_fcgdg .DefTabSzAttr =_edbg .DefTabSzAttr ;};if _fcgdg .RtlAttr ==nil {_fcgdg .RtlAttr =_edbg .RtlAttr ;};if _fcgdg .EaLnBrkAttr ==nil {_fcgdg .EaLnBrkAttr =_edbg .EaLnBrkAttr ;};if _fcgdg .FontAlgnAttr ==_bf .ST_TextFontAlignTypeUnset {_fcgdg .FontAlgnAttr =_edbg .FontAlgnAttr ;};if _fcgdg .LatinLnBrkAttr ==nil {_fcgdg .LatinLnBrkAttr =_edbg .LatinLnBrkAttr ;};if _fcgdg .HangingPunctAttr ==nil {_fcgdg .HangingPunctAttr =_edbg .HangingPunctAttr ;};if _fcgdg .LnSpc ==nil {_fcgdg .LnSpc =_edbg .LnSpc ;};if _fcgdg .SpcBef ==nil {_fcgdg .SpcBef =_edbg .SpcBef ;};if _fcgdg .SpcAft ==nil {_fcgdg .SpcAft =_edbg .SpcAft ;};if _fcgdg .BuClrTx ==nil {_fcgdg .BuClrTx =_edbg .BuClrTx ;};if _fcgdg .BuClr ==nil {_fcgdg .BuClr =_edbg .BuClr ;};if _fcgdg .BuSzTx ==nil {_fcgdg .BuSzTx =_edbg .BuSzTx ;};if _fcgdg .BuSzPct ==nil {_fcgdg .BuSzPct =_edbg .BuSzPct ;};if _fcgdg .BuSzPts ==nil {_fcgdg .BuSzPts =_edbg .BuSzPts ;};if _fcgdg .BuFontTx ==nil {_fcgdg .BuFontTx =_edbg .BuFontTx ;};if _fcgdg .BuFont ==nil {_fcgdg .BuFont =_edbg .BuFont ;};if _fcgdg .BuNone ==nil {_fcgdg .BuNone =_edbg .BuNone ;};if _fcgdg .BuAutoNum ==nil {_fcgdg .BuAutoNum =_edbg .BuAutoNum ;};if _fcgdg .BuChar ==nil {_fcgdg .BuChar =_edbg .BuChar ;};if _fcgdg .BuBlip ==nil {_fcgdg .BuBlip =_edbg .BuBlip ;};if _fcgdg .TabLst ==nil {_fcgdg .TabLst =_edbg .TabLst ;};if _fcgdg .ExtLst ==nil {_fcgdg .ExtLst =_edbg .ExtLst ;};_fcgdg .DefRPr =_ecdfe (_fcgdg .DefRPr ,_edbg .DefRPr );return _fcgdg ;};