//
// Copyright 2020 FoxyUtils ehf. All rights reserved.
//
// This is a commercial product and requires a license to operate.
// A trial license can be obtained at https://unidoc.io
//
// DO NOT EDIT: generated by unitwist Go source code obfuscator.
//
// Use of this source code is governed by the UniDoc End User License Agreement
// terms that can be accessed at https://unidoc.io/eula/

package convert ;import (_e "bytes";_cb "errors";_a "github.com/unidoc/unioffice/common/logger";_dd "github.com/unidoc/unioffice/common/tempstorage";_f "github.com/unidoc/unioffice/internal/convertutils";_fe "github.com/unidoc/unioffice/measurement";_dc "github.com/unidoc/unioffice/presentation";_ced "github.com/unidoc/unioffice/schema/soo/dml";_ca "github.com/unidoc/unioffice/schema/soo/dml/chart";_bg "github.com/unidoc/unioffice/schema/soo/pml";_ac "github.com/unidoc/unipdf/v3/contentstream/draw";_ff "github.com/unidoc/unipdf/v3/creator";_bfg "github.com/unidoc/unipdf/v3/model";_ad "github.com/unidoc/unipdf/v3/render";_b "image";_g "image/color";_d "image/draw";_bf "strconv";_ce "strings";);func _cdcf (_fdd string )[]*symbol {_bab :=[]*symbol {};for _ ,_bec :=range _fdd {_bab =append (_bab ,&symbol {_abda :string (_bec )});};return _bab ;};type symbol struct{_abda string ;_adbaa float64 ;_abg float64 ;_ffce float64 ;_gcef float64 ;_agga float64 ;_accf *_ff .TextStyle ;_afde string ;_ecfc bool ;_egb bool ;_gaebf bool ;};type line struct{_efdf float64 ;_bdf float64 ;_dcf float64 ;_fdfg float64 ;_cecg float64 ;_dfab []*word ;};func (_cab *convertContext )makePdfBlockFromTxBody (_gbb *_ced .CT_TextBody ,_cec *_ced .CT_TextBodyProperties ,_fbgd *_ced .CT_TextListStyle ,_ebe ,_cbd float64 ,_dfc _ff .Color ,_ecfg ,_cedf bool )(*_ff .Block ,error ){var _ffe *_ced .CT_TextParagraphProperties ;if _dgf :=_gbb .LstStyle ;_dgf !=nil {var _ffg *_ced .CT_TextParagraphProperties ;if _dgf .Lvl1pPr !=nil {_ffg =_dgf .Lvl1pPr ;};_ffe =_dgec (_ffg ,_dgf .DefPPr );};var _ceag *_ced .CT_TextParagraphProperties ;if _ffe !=nil {if _ecfg {_ceag =_cab ._faff [0];}else if _cedf {_ceag =_cab ._bbad [0];}else {_ceag =_cab ._cga [0];};if _fbgd !=nil {_ceag =_dgec (_dgec (_fbgd .Lvl1pPr ,_fbgd .DefPPr ),_ceag );};_ceag =_dgec (_ffe ,_ceag );}else {if _ecfg {_ceag =_cab ._gdef ;}else if _cedf {_ceag =_cab ._bdab ;}else {_ceag =_cab ._gagc ;};};_dbdf ,_ceg :=_dedg (2.5),_dedg (2.5);_cace ,_fee :=_dedg (1.3),_dedg (1.3);_ccdg :=true ;_cfg :=_ced .ST_TextAnchoringTypeT ;if _cec !=nil {if _fdf :=_cec .AnchorAttr ;_fdf !=_ced .ST_TextAnchoringTypeUnset {_cfg =_fdf ;};};if _cabd :=_gbb .BodyPr ;_cabd !=nil {if _cgcg :=_cabd .LInsAttr ;_cgcg !=nil {_dbdf =_fe .FromEMU (_f .FromSTCoordinate32 (*_cgcg ));};if _dfdfg :=_cabd .TInsAttr ;_dfdfg !=nil {_cace =_fe .FromEMU (_f .FromSTCoordinate32 (*_dfdfg ));};if _dbc :=_cabd .RInsAttr ;_dbc !=nil {_ceg =_fe .FromEMU (_f .FromSTCoordinate32 (*_dbc ));};if _eff :=_cabd .BInsAttr ;_eff !=nil {_fee =_fe .FromEMU (_f .FromSTCoordinate32 (*_eff ));};_ccdg =_cabd .WrapAttr !=_ced .ST_TextWrappingTypeNone ;if _bgf :=_cabd .AnchorAttr ;_bgf !=_ced .ST_TextAnchoringTypeUnset {_cfg =_cabd .AnchorAttr ;};};_aedef :=_f .MakeTempCreator (_ebe ,_cbd );_aedef .SetPageMargins (_dbdf ,_ceg ,_cace ,_fee );_efc :=&textboxContext {_ecff :_cab ,_geac :_ccdg ,_fgg :_ebe -_dbdf -_ceg ,_abdf :_cbd -_cace -_fee ,_fafc :_aedef ,_aacb :[]*paragraph {}};_afda :=1;for _ ,_gbe :=range _gbb .P {if _gbe !=nil {_fbd :=_gbe .PPr ;var _eaf *prefixData ;if _fbd !=nil &&_fbd .BuNone ==nil {var _ece string ;var _fea bool ;if _gbcf :=_fbd .BuAutoNum ;_gbcf !=nil {var _afebe string ;if _affg :=_gbcf .StartAtAttr ;_affg !=nil {_afda =int (*_affg );};var _fbc string ;switch _gbcf .TypeAttr {case _ced .ST_TextAutonumberSchemeAlphaUcParenBoth ,_ced .ST_TextAutonumberSchemeAlphaUcParenR ,_ced .ST_TextAutonumberSchemeAlphaUcPeriod :_fbc =_acbf (_afda ,true );case _ced .ST_TextAutonumberSchemeAlphaLcParenBoth ,_ced .ST_TextAutonumberSchemeAlphaLcParenR ,_ced .ST_TextAutonumberSchemeAlphaLcPeriod :_fbc =_acbf (_afda ,false );case _ced .ST_TextAutonumberSchemeRomanUcParenBoth ,_ced .ST_TextAutonumberSchemeRomanUcParenR ,_ced .ST_TextAutonumberSchemeRomanUcPeriod :_fbc =_fdef (_afda ,true );case _ced .ST_TextAutonumberSchemeRomanLcParenBoth ,_ced .ST_TextAutonumberSchemeRomanLcParenR ,_ced .ST_TextAutonumberSchemeRomanLcPeriod :_fbc =_fdef (_afda ,false );default:_fbc =_bf .Itoa (_afda );};switch _gbcf .TypeAttr {case _ced .ST_TextAutonumberSchemeAlphaLcPeriod ,_ced .ST_TextAutonumberSchemeAlphaUcPeriod ,_ced .ST_TextAutonumberSchemeArabicPeriod ,_ced .ST_TextAutonumberSchemeRomanLcPeriod ,_ced .ST_TextAutonumberSchemeRomanUcPeriod ,_ced .ST_TextAutonumberSchemeArabicDbPeriod ,_ced .ST_TextAutonumberSchemeEa1ChsPeriod ,_ced .ST_TextAutonumberSchemeEa1ChtPeriod ,_ced .ST_TextAutonumberSchemeEa1JpnChsDbPeriod ,_ced .ST_TextAutonumberSchemeEa1JpnKorPeriod ,_ced .ST_TextAutonumberSchemeThaiAlphaPeriod ,_ced .ST_TextAutonumberSchemeThaiNumPeriod ,_ced .ST_TextAutonumberSchemeHindiAlphaPeriod ,_ced .ST_TextAutonumberSchemeHindiNumPeriod ,_ced .ST_TextAutonumberSchemeHindiAlpha1Period :_afebe ="\u002e";case _ced .ST_TextAutonumberSchemeAlphaLcParenR ,_ced .ST_TextAutonumberSchemeAlphaUcParenR ,_ced .ST_TextAutonumberSchemeArabicParenR ,_ced .ST_TextAutonumberSchemeRomanLcParenR ,_ced .ST_TextAutonumberSchemeRomanUcParenR ,_ced .ST_TextAutonumberSchemeThaiAlphaParenR ,_ced .ST_TextAutonumberSchemeThaiNumParenR ,_ced .ST_TextAutonumberSchemeHindiNumParenR :_afebe ="\u0029";};_ece =_fbc +_afebe ;_afda ++;}else if _eabc :=_fbd .BuChar ;_eabc !=nil {_dade :=_eabc .CharAttr ;if _bdag ,_aaf :=_bdcb [_dade ];_aaf {_dade =string (rune (_bdag ));}else {_dade ="\u2022";};_ece =_dade ;_fea =true ;};if _ece !=""{var _cbg ,_fce float64 ;if _fbd .MarLAttr !=nil {_cbg =_fe .FromEMU (int64 (*_fbd .MarLAttr ));};if _fbd .IndentAttr !=nil {_fce =_fe .FromEMU (int64 (*_fbd .IndentAttr ));};_eaf =&prefixData {_dac :_ece ,_cbf :_fea ,_bdac :_cbg ,_eegc :_fce };};};_fbd =_dgec (_fbd ,_ceag );_fcbf :=_fgfba (_gbe .EndParaRPr ,_fbd .DefRPr );_efc .newParagraph ();_efc .assignPropsToCurrentParagraph (_fbd );_efc .newLine ();_efc .newWord ();for _efe ,_aafe :=range _gbe .EG_TextRun {_efc .addTextRun (_aafe ,_fcbf ,_dfc ,_eaf );if _efe > 0{_eaf =nil ;};};_efc .addCurrentWordToParagraph ();};_efc .addCurrentParagraph ();};_efc .alignVertically (_cfg );_efc .drawParagraphs ();return _f .MakeBlockFromCreator (_aedef );};func (_dbfe *textboxContext )newParagraph (){_gbec :=&paragraph {};_gbec ._efgd =_dbfe ._afdc ;_dbfe ._ecbb =_gbec ;};type word struct{_bgdg []*symbol ;_degf float64 ;_cfda float64 ;_ebab bool ;};func (_gafdf *convertContext )applyBlipEffectsOnImg (_bgda *_ff .Image ,_dfb ,_gdfdf float64 ,_faa []*_ced .CT_BlipChoice )*_ff .Image {if len (_faa )==0{return _bgda ;};_bgda .SetPos (_dfb ,_gdfdf );_faca ,_bfbe :=_gafdf .renderPageWithDrawableToGoImage (_bgda );if _bfbe !=nil {_a .Log .Debug ("\u0045\u0072\u0072\u006f\u0072\u0020\u0072\u0065\u006e\u0064\u0065\u0072\u0020a\u006e\u0020\u0069\u006d\u0061\u0067e\u0020\u0074\u006f\u0020\u0061\u0020\u0047\u006f\u0020\u0069\u006d\u0061\u0067e\u003a\u0020\u0025\u0073",_bfbe );return _bgda ;};_dbfbd ,_bfbe :=_gafdf .renderCurrentStateToGoImage ();if _bfbe !=nil {_a .Log .Debug ("\u0045\u0072\u0072\u006f\u0072\u0020\u0072\u0065n\u0064\u0065\u0072 t\u0068\u0065\u0020\u0063\u0075\u0072r\u0065\u006e\u0074\u0020\u0073\u0074\u0061\u0074\u0065\u0020\u0074\u006f\u0020\u0061\u0020G\u006f\u0020\u0069\u006d\u0061\u0067\u0065\u003a \u0025\u0073",_bfbe );return _bgda ;};_aae :=_faca .Bounds ();_gecc :=_b .NewRGBA (_aae );_ffab ,_gggf :=_bgda .Width (),_bgda .Height ();for _ ,_bdbc :=range _faa {for _ ,_fdde :=range _bdbc .AlphaModFix {if _ddd :=_fdde .AmtAttr ;_ddd !=nil {if _edc :=_ddd .ST_PositivePercentageDecimal ;_edc !=nil {_fafa :=uint8 (255*(*_edc )/100000);_gdfc :=_b .NewUniform (_g .Alpha {_fafa });_d .Draw (_gecc ,_aae ,_dbfbd ,_b .Point {0,0},_d .Src );_d .DrawMask (_gecc ,_aae ,_faca ,_b .Point {0,0},_gdfc ,_b .Point {0,0},_d .Over );};};};};_gdff :=_b .Rect (int (_dfb ),int (_gdfdf ),int (_dfb +_ffab )+1,int (_gdfdf +_gggf )+1);_fbadd :=_f .CropImageByRect (_gecc ,_gdff );_bfca ,_bfbe :=_gafdf ._dece .NewImageFromGoImage (_fbadd );if _bfbe !=nil {_a .Log .Debug ("\u0045\u0072\u0072\u006f\u0072\u0020\u0061\u006e\u0020\u0069\u006d\u0061\u0067\u0065\u0020t\u006f \u0061\u0020\u0047\u006f\u0020\u0069\u006d\u0061\u0067\u0065\u003a\u0020\u0025\u0073",_bfbe );return _bgda ;};return _bfca ;};func (_dgdd *convertContext )getShapeFromBlipFill (_fgea *_ced .CT_BlipFillProperties ,_cfef ,_fcbg ,_egbe ,_feb float64 )_ff .Drawable {_acbd ,_gfe ,_gbbb :=_dgdd .makePdfImageFromBlipFill (_fgea );if _gbbb !=nil {_a .Log .Debug ("\u0043\u0061\u006e\u006e\u006f\u0074\u0020\u006d\u0061\u006b\u0065\u0020\u0050D\u0046\u0020\u0069\u006d\u0061\u0067e\u0020\u0066\u0072\u006f\u006d\u0020\u0042\u006c\u0069\u0070\u0046\u0069\u006cl\u003a\u0020\u0025\u0073",_gbbb );return nil ;};if _acbd ==nil {return nil ;};if _ddeca :=_fgea .Tile ;_ddeca !=nil {_acbd =_dgdd .tileImage (_acbd ,_fgea .Tile ,_egbe ,_feb );};if _ebcdd :=_fgea .Stretch ;_ebcdd !=nil {_acbd ,_cfef ,_fcbg =_dgdd .stretchImage (_acbd ,_fgea .Stretch ,_cfef ,_fcbg ,_egbe ,_feb );};if len (_gfe )==0{_acbd .SetPos (_cfef ,_fcbg );return _acbd ;};_acbd =_dgdd .applyBlipEffectsOnImg (_acbd ,_cfef ,_fcbg ,_gfe );_acbd .SetPos (_cfef ,_fcbg );return _acbd ;};func _gcc (_fdb *_ced .CT_AdjPoint2D )(float64 ,float64 ){var _dgba ,_ddee float64 ;_agbd ,_ecde :=_fdb .XAttr ,_fdb .YAttr ;if _geed :=_agbd .ST_Coordinate ;_geed !=nil {_dgba =_fe .FromEMU (_f .FromSTCoordinate (*_geed ));};if _afad :=_ecde .ST_Coordinate ;_afad !=nil {_ddee =_fe .FromEMU (_f .FromSTCoordinate (*_afad ));};return _dgba ,_ddee ;};func (_ccg *convertContext )drawSlide (){_ccg ._dece .NewPage ();for _ ,_ebd :=range _ccg ._def {if _ebd !=nil {_ccg ._dece .MoveTo (0,0);_ccg ._dece .Draw (_ebd );};};};var _ebef =[]romanMatch {romanMatch {1000,"\u006d"},romanMatch {900,"\u0063\u006d"},romanMatch {500,"\u0064"},romanMatch {400,"\u0063\u0064"},romanMatch {100,"\u0063"},romanMatch {90,"\u0078\u0063"},romanMatch {50,"\u006c"},romanMatch {40,"\u0078\u006c"},romanMatch {10,"\u0078"},romanMatch {9,"\u0069\u0078"},romanMatch {5,"\u0076"},romanMatch {4,"\u0069\u0076"},romanMatch {1,"\u0069"}};func (_feag *convertContext )getStyleColors (_bffc *_ced .CT_ShapeStyle )(_ff .Color ,_ff .Color ,_ff .Color ){var _dadgb ,_ffgf ,_abbb _ff .Color ;if _cbacc :=_bffc .LnRef ;_cbacc !=nil {_ffgf =_feag .getColorFromMatrixReference (_cbacc );};if _adac :=_bffc .FillRef ;_adac !=nil {_abbb =_feag .getColorFromMatrixReference (_adac );};if _effa :=_bffc .FontRef ;_effa !=nil {_dadgb =_feag .getColorFromFontReference (_effa );};return _dadgb ,_abbb ,_ffgf ;};func _edee (_beddc *_bg .CT_Shape )(_bg .ST_PlaceholderType ,*uint32 ){if _cgce :=_beddc .NvSpPr ;_cgce !=nil {if _age :=_cgce .NvPr ;_age !=nil {if _bcc :=_age .Ph ;_bcc !=nil {return _bcc .TypeAttr ,_bcc .IdxAttr ;};};};return _bg .ST_PlaceholderTypeUnset ,nil ;};func (_aadf *convertContext )renderPageWithDrawableToGoImage (_bfec _ff .Drawable )(_b .Image ,error ){_egc :=_f .MakeTempCreator (_aadf ._fgfe ,_aadf ._bacf );_egc .NewPage ();_egc .Draw (_bfec );_geaac ,_fdeg :=_f .GetPageFromCreator (_egc );if _fdeg !=nil {return nil ,_fdeg ;};return _ad .NewImageDevice ().Render (_geaac );};func (_fgba *line )moveRight (_gedc float64 ){for _ ,_aeee :=range _fgba ._dfab {_aeee ._degf +=_gedc ;};};func _fdef (_gfb int ,_cgd bool )string {_egee :=_e .NewBuffer ([]byte {});for _ ,_eefg :=range _ebef {for {if _gfb < _eefg ._bcd {break ;};_egee .WriteString (_eefg ._bbbg );_gfb -=_eefg ._bcd ;};};_gdfd :=_egee .String ();if _cgd {_gdfd =_ce .ToUpper (_gdfd );};return _gdfd ;};func _acbf (_abba int ,_fgfb bool )string {_eeb :=(_abba -1)/26+1;_fagg :=byte ((_abba -1)%26);if _fgfb {_fagg +=byte (65);}else {_fagg +=byte (97);};_dcg :=_e .NewBuffer ([]byte {});for _gcf :=0;_gcf < _eeb ;_gcf ++{_dcg .Write ([]byte {_fagg });};return _dcg .String ();};func (_cbfa *textboxContext )alignVertically (_abaff _ced .ST_TextAnchoringType ){_cbfa .alignParagraphsVertically (_abaff );_cbfa .alignSymbolsVertically ();};func _begb (_eeae ,_agcf *_ced .CT_TextBody )(*_ced .CT_TextBodyProperties ,*_ced .CT_TextListStyle ){if _eeae ==nil &&_agcf ==nil {return nil ,nil ;};if _eeae ==nil {return _agcf .BodyPr ,_agcf .LstStyle ;};if _agcf ==nil {return _eeae .BodyPr ,_eeae .LstStyle ;};_cega ,_dgeg :=_eeae .BodyPr ,_eeae .LstStyle ;_acda ,_aaae :=_agcf .BodyPr ,_agcf .LstStyle ;_aegb :=_cbgf (_cega ,_acda );_eegd :=_gfef (_dgeg ,_aaae );return _aegb ,_eegd ;};type convertContext struct{_dece *_ff .Creator ;_fcbc *_f .Rectangle ;_dce *_dc .Presentation ;_edfa *_dc .Slide ;_bbcb *_bg .SldMaster ;_gcdde *_bg .SldLayout ;_bacf float64 ;_fgfe float64 ;_def []_ff .Drawable ;_aafd *background ;_gagc *_ced .CT_TextParagraphProperties ;_ddec *_ced .CT_TextCharacterProperties ;_gdef *_ced .CT_TextParagraphProperties ;_ada *_ced .CT_TextCharacterProperties ;_bdab *_ced .CT_TextParagraphProperties ;_aec *_ced .CT_TextCharacterProperties ;_cga []*_ced .CT_TextParagraphProperties ;_faff []*_ced .CT_TextParagraphProperties ;_bbad []*_ced .CT_TextParagraphProperties ;_bcbg *_ced .Theme ;_edaf *_ced .CT_ColorMappingOverride ;};

// ConvertToPdf converts a presentation to a PDF file. This package is beta, breaking changes can take place.
func ConvertToPdf (pr *_dc .Presentation )*_ff .Creator {_af :=pr .X ().SldSz ;_gg :=_fe .FromEMU (int64 (_af .CxAttr ));_cc :=_fe .FromEMU (int64 (_af .CyAttr ));_bb :=_ff .PageSize {_gg ,_cc };_be :=_ff .New ();_be .SetPageSize (_bb );var _gb *_ced .Theme ;if len (pr .Themes ())> 0{_gb =pr .Themes ()[0];};for _ ,_ef :=range pr .Slides (){if _ef .X ()==nil {continue ;};_bfc :=&convertContext {_dece :_be ,_edfa :&_ef ,_gcdde :_ef .GetSlideLayout (),_bbcb :pr .SlideMasters ()[0].X (),_dce :pr ,_bcbg :_gb ,_edaf :_ef .X ().ClrMapOvr ,_bacf :_bb [1],_fgfe :_bb [0]};_bfc ._gcdde =_ef .GetSlideLayout ();_bfc .extractDefaultProperties ();_bfc .makeSlide ();_bfc .drawSlide ();};return _be ;};func (_aaa *textboxContext )addTextRun (_ccc *_ced .EG_TextRun ,_beeb *_ced .CT_TextCharacterProperties ,_acdd _ff .Color ,_gdcb *prefixData ){if _cgcgc :=_ccc .Br ;_cgcgc !=nil {_aaa .addCurrentWordToParagraph ();_aaa .newLine ();_aaa .newWord ();}else if _bebd :=_ccc .R ;_bebd !=nil {var _cca _ff .Color ;if _bebd .RPr .SolidFill !=nil {_cca ,_ =_aaa ._ecff .getColorFromSolidFill (_bebd .RPr .SolidFill );}else if _acdd !=nil {_cca =_acdd ;}else if _beeb .SolidFill !=nil {_cca ,_ =_aaa ._ecff .getColorFromSolidFill (_beeb .SolidFill );}else {_cca =_ff .ColorBlack ;};_dab :=_fgfba (_bebd .RPr ,_beeb );_beee ,_abaf ,_dba ,_gadd :=_aaa ._ecff .makeStyleFromRPr (_dab );_beee .Color =_cca ;if _gdcb !=nil {_aaa .addPrefix (_gdcb ,_beee );};_feee :=_cdcf (_bebd .T );for _ ,_gadda :=range _feee {_gadda ._accf =_beee ;_gadda ._ecfc =_abaf ;_gadda ._egb =_dba ;_gadda ._gaebf =_gadd ;if _dab .CapAttr ==_ced .ST_TextCapsTypeAll {_gadda ._abda =_ce .ToUpper (_gadda ._abda );};_aaa .addTextSymbol (_gadda );};};};func (_adbaad *textboxContext )drawParagraphs (){_adbaad ._fafc .NewPage ();for _ ,_gecd :=range _adbaad ._aacb {for _ ,_bfee :=range _gecd ._bbfd {for _ ,_ddeb :=range _bfee ._dfab {for _ ,_gfae :=range _ddeb ._bgdg {_ddf :=_adbaad ._fafc .NewStyledParagraph ();if _gfae ._ecfc {_gfae ._gcef =0;}else if _gfae ._egb {_gfae ._gcef =1.2*_bfee ._cecg -_gfae ._ffce ;};_afg :=_ddeb ._degf +_gfae ._adbaa ;_egg :=_gecd ._efgd +_bfee ._efdf +_gfae ._gcef ;_ddf .SetPos (_afg ,_egg );_bcdf :=_ddf .Append (_gfae ._abda );if _gfae ._accf !=nil {_bcdf .Style =*_gfae ._accf ;};_adbaad ._fafc .Draw (_ddf );if _gfae ._gaebf {_gbccf :=_egg +_gfae ._ffce +2;_f .DrawLine (_adbaad ._fafc ,_afg ,_gbccf ,_afg +_gfae ._agga ,_gbccf ,1,_gfae ._accf .Color );};};};};};};func (_caae *textboxContext )addCurrentWordToParagraph (){if _caae ._geac &&_caae ._fag ._fdfg +_caae ._gggg ._cfda > _caae ._fag ._dcf {_caae .newLine ();};if !_caae ._gggg ._ebab ||len (_caae ._fag ._dfab )> 0{_caae ._gggg ._degf =_caae ._fag ._fdfg ;_caae ._fag ._dfab =append (_caae ._fag ._dfab ,_caae ._gggg );_caae ._fag ._fdfg +=_caae ._gggg ._cfda ;for _ ,_ffgd :=range _caae ._gggg ._bgdg {_caae .adjustHeights (_ffgd ._abg );};};};func (_gfd *textboxContext )assignPropsToCurrentParagraph (_ede *_ced .CT_TextParagraphProperties ){_dgg :=12.4;if _ede ==nil {_gfd ._ecbb ._fad =_dgg ;return ;};if _dbce :=_ede .DefRPr ;_dbce !=nil {_fbfd :=_dbce .SzAttr ;if _fbfd !=nil {_geag :=float64 (*_fbfd )/1200;if _dgg <=_geag {_dgg =_geag ;};};};if _ded :=_ede .MarLAttr ;_ded !=nil {_gfd ._ecbb ._acf =_fe .FromEMU (int64 (*_ded ));};_gfd ._ecbb ._cecc =_gfd ._fgg ;if _eafg :=_ede .MarRAttr ;_eafg !=nil {_gfd ._ecbb ._cecc -=_fe .FromEMU (int64 (*_eafg ));};if _eca :=_ede .IndentAttr ;_eca !=nil {_gfd ._ecbb ._cceg =_fe .FromEMU (int64 (*_eca ));};if _ecfge :=_ede .LatinLnBrkAttr ;_ecfge !=nil {_gfd ._ecbb ._dfac =*_ecfge ;};if _cgea :=_ede .LnSpc ;_cgea !=nil {if _ebdfa :=_cgea .SpcPct ;_ebdfa !=nil {if _efag :=_ebdfa .ValAttr .ST_TextSpacingPercent ;_efag !=nil {_dgg =float64 (*_efag )/5000;};};};var _ccb float64 ;if _efde :=_ede .SpcBef ;_efde !=nil {if _aaca :=_efde .SpcPts ;_aaca !=nil {_ccb =float64 (_aaca .ValAttr )/100;};};_fgbf :=_gfd ._aacb ;if len (_fgbf )> 0{_ccb -=_fgbf [len (_fgbf )-1]._gbac ;if _ccb < 0{_ccb =0;};};_gfd ._ecbb ._gba =_ccb ;if _gbba :=_ede .SpcAft ;_gbba !=nil {if _gefg :=_gbba .SpcPts ;_gefg !=nil {_gfd ._ecbb ._gbac =float64 (_gefg .ValAttr )/100;};};_gfd ._ecbb ._fad =_dgg ;_gfd ._ecbb ._bacfg =_ede .AlgnAttr ;};type prefixData struct{_dac string ;_cbf bool ;_bdac float64 ;_eegc float64 ;};func (_ecdc *convertContext )renderCurrentStateToGoImage ()(_b .Image ,error ){_acbb :=_f .MakeTempCreator (_ecdc ._fgfe ,_ecdc ._bacf );_acbb .NewPage ();for _ ,_fef :=range _ecdc ._def {if _fef !=nil {_acbb .MoveTo (0,0);_acbb .Draw (_fef );};};_bcbdd ,_gfbf :=_f .GetPageFromCreator (_acbb );if _gfbf !=nil {return nil ,_gfbf ;};return _ad .NewImageDevice ().Render (_bcbdd );};func _dgeb (_ebaf ,_gfba *_ced .CT_TableStyleCellStyle )*_ced .CT_TableStyleCellStyle {_dfgf :=_ced .NewCT_TableStyleCellStyle ();if _ebaf !=nil {*_dfgf =*_ebaf ;};if _gfba ==nil {return _dfgf ;};if _dfgf .TcBdr ==nil {_dfgf .TcBdr =_gfba .TcBdr ;};if _dfgf .Fill ==nil {_dfgf .Fill =_gfba .Fill ;};if _dfgf .FillRef ==nil {_dfgf .FillRef =_gfba .FillRef ;};return _dfgf ;};func _dgec (_add ,_dadae *_ced .CT_TextParagraphProperties )*_ced .CT_TextParagraphProperties {_ddeeg :=_ced .NewCT_TextParagraphProperties ();if _add !=nil {*_ddeeg =*_add ;};if _dadae ==nil {return _ddeeg ;};if _ddeeg .MarLAttr ==nil {_ddeeg .MarLAttr =_dadae .MarLAttr ;};if _ddeeg .MarRAttr ==nil {_ddeeg .MarRAttr =_dadae .MarRAttr ;};if _ddeeg .LvlAttr ==nil {_ddeeg .LvlAttr =_dadae .LvlAttr ;};if _ddeeg .IndentAttr ==nil {_ddeeg .IndentAttr =_dadae .IndentAttr ;};if _ddeeg .AlgnAttr ==_ced .ST_TextAlignTypeUnset {_ddeeg .AlgnAttr =_dadae .AlgnAttr ;};if _ddeeg .DefTabSzAttr ==nil {_ddeeg .DefTabSzAttr =_dadae .DefTabSzAttr ;};if _ddeeg .RtlAttr ==nil {_ddeeg .RtlAttr =_dadae .RtlAttr ;};if _ddeeg .EaLnBrkAttr ==nil {_ddeeg .EaLnBrkAttr =_dadae .EaLnBrkAttr ;};if _ddeeg .FontAlgnAttr ==_ced .ST_TextFontAlignTypeUnset {_ddeeg .FontAlgnAttr =_dadae .FontAlgnAttr ;};if _ddeeg .LatinLnBrkAttr ==nil {_ddeeg .LatinLnBrkAttr =_dadae .LatinLnBrkAttr ;};if _ddeeg .HangingPunctAttr ==nil {_ddeeg .HangingPunctAttr =_dadae .HangingPunctAttr ;};if _ddeeg .LnSpc ==nil {_ddeeg .LnSpc =_dadae .LnSpc ;};if _ddeeg .SpcBef ==nil {_ddeeg .SpcBef =_dadae .SpcBef ;};if _ddeeg .SpcAft ==nil {_ddeeg .SpcAft =_dadae .SpcAft ;};if _ddeeg .BuClrTx ==nil {_ddeeg .BuClrTx =_dadae .BuClrTx ;};if _ddeeg .BuClr ==nil {_ddeeg .BuClr =_dadae .BuClr ;};if _ddeeg .BuSzTx ==nil {_ddeeg .BuSzTx =_dadae .BuSzTx ;};if _ddeeg .BuSzPct ==nil {_ddeeg .BuSzPct =_dadae .BuSzPct ;};if _ddeeg .BuSzPts ==nil {_ddeeg .BuSzPts =_dadae .BuSzPts ;};if _ddeeg .BuFontTx ==nil {_ddeeg .BuFontTx =_dadae .BuFontTx ;};if _ddeeg .BuFont ==nil {_ddeeg .BuFont =_dadae .BuFont ;};if _ddeeg .BuNone ==nil {_ddeeg .BuNone =_dadae .BuNone ;};if _ddeeg .BuAutoNum ==nil {_ddeeg .BuAutoNum =_dadae .BuAutoNum ;};if _ddeeg .BuChar ==nil {_ddeeg .BuChar =_dadae .BuChar ;};if _ddeeg .BuBlip ==nil {_ddeeg .BuBlip =_dadae .BuBlip ;};if _ddeeg .TabLst ==nil {_ddeeg .TabLst =_dadae .TabLst ;};if _ddeeg .ExtLst ==nil {_ddeeg .ExtLst =_dadae .ExtLst ;};_ddeeg .DefRPr =_fgfba (_ddeeg .DefRPr ,_dadae .DefRPr );return _ddeeg ;};func (_dced *textboxContext )newWord (){_dced ._gggg =&word {_ebab :true ,_degf :_dced ._fag ._fdfg }};func _aaad (_eeaef *_ced .CT_TextCharacterProperties ,_bad *_ced .CT_TableStyleTextStyle )*_ced .CT_TextCharacterProperties {_bgfbc :=_ced .NewCT_TextCharacterProperties ();if _eeaef !=nil {*_bgfbc =*_eeaef ;};if _bad ==nil {return _bgfbc ;};if _bgfbc .BAttr ==nil &&_bad .BAttr !=_ced .ST_OnOffStyleTypeUnset {_edgb :=_bad .BAttr ==_ced .ST_OnOffStyleTypeOn ;_bgfbc .BAttr =&_edgb ;};if _bgfbc .IAttr ==nil &&_bad .IAttr !=_ced .ST_OnOffStyleTypeUnset {_cddb :=_bad .IAttr ==_ced .ST_OnOffStyleTypeOn ;_bgfbc .IAttr =&_cddb ;};if _bgfbc .NoFill ==nil &&_bgfbc .SolidFill ==nil {_bgfbc .SolidFill =_ced .NewCT_SolidColorFillProperties ();_bgfbc .SolidFill .ScrgbClr =_bad .ScrgbClr ;_bgfbc .SolidFill .SrgbClr =_bad .SrgbClr ;_bgfbc .SolidFill .HslClr =_bad .HslClr ;_bgfbc .SolidFill .SysClr =_bad .SysClr ;_bgfbc .SolidFill .SchemeClr =_bad .SchemeClr ;_bgfbc .SolidFill .PrstClr =_bad .PrstClr ;};if _cefe :=_bad .Font ;_cefe !=nil &&_bgfbc .Latin ==nil &&_bgfbc .Ea ==nil &&_bgfbc .Cs ==nil {_bgfbc .Latin =_cefe .Latin ;_bgfbc .Ea =_cefe .Ea ;_bgfbc .Cs =_cefe .Cs ;};return _bgfbc ;};func (_dgbba *convertContext )getInfoFromLn (_cgdf *_ced .CT_LineProperties )(_ff .Color ,float64 ,float64 ){if _cgdf ==nil ||_cgdf .NoFill !=nil {return nil ,0,0;};var _acbef float64 ;_bdcd ,_ddfb :=_dgbba .getColorFromSolidFill (_cgdf .SolidFill );if _afcc :=_cgdf .WAttr ;_afcc !=nil {_acbef =_fe .FromEMU (int64 (*_afcc ));}else {_acbef =1;};return _bdcd ,_acbef ,_ddfb ;};func _ffcg (_ecfb ,_egdd *_ced .CT_TablePartStyle )*_ced .CT_TablePartStyle {_acca :=_ced .NewCT_TablePartStyle ();if _ecfb !=nil {*_acca =*_ecfb ;};if _egdd ==nil {return _acca ;};if _acca .TcTxStyle ==nil {_acca .TcTxStyle =_egdd .TcTxStyle ;}else {_acca .TcTxStyle =_bgeag (_acca .TcTxStyle ,_egdd .TcTxStyle );};if _acca .TcStyle ==nil {_acca .TcStyle =_egdd .TcStyle ;}else {_acca .TcStyle =_dgeb (_acca .TcStyle ,_egdd .TcStyle );};return _acca ;};func (_cfbb *textboxContext )adjustHeights (_ccda float64 ){if _cfbb ._fag ._cecg < _ccda {_cfbb ._ecbb ._fdgd +=(_ccda -_cfbb ._fag ._cecg );_cfbb ._fag ._cecg =_ccda ;};};func (_dbfb *textboxContext )addPrefix (_acaa *prefixData ,_cddc *_ff .TextStyle ){_gbcc :=_cdcf (_acaa ._dac );_bdce :=*_cddc ;if _acaa ._cbf {_bdce .Font =_f .AssignStdFontByName (_bdce ,"\u0053\u0079\u006d\u0062\u006f\u006c");};for _ ,_afebc :=range _gbcc {_afebc ._accf =&_bdce ;_dbfb .addTextSymbol (_afebc );};_ggbg :=-(_acaa ._eegc +_dbfb ._gggg ._cfda );if _ggbg < 0{_ggbg =0;};_fbga :=&symbol {_abda :"\u0020",_agga :_ggbg };_dbfb .addTextSymbol (_fbga );_dbfb ._gggg ._degf +=(_acaa ._eegc +_acaa ._bdac );};func (_ecd *convertContext )getShapesFromSpPr (_fcdc *_ced .CT_ShapeProperties ,_ffcf *_ced .CT_ShapeStyle ,_bge bool )([]_ff .Drawable ,float64 ,float64 ,float64 ,float64 ,_ff .Color ,bool ){_bfcc :=[]_ff .Drawable {};var _cba ,_bbe ,_gdg ,_abae ,_bee float64 ;var _dbg ,_cgca ,_gec ,_bega _ff .Color ;var _afe *_ced .CT_BlipFillProperties ;_adg ,_fcf :=1.0,1.0;if _ffcf !=nil {_dbg ,_cgca ,_bega =_ecd .getStyleColors (_ffcf );};if _bc :=_fcdc .Ln ;_bc !=nil {if _bc .NoFill !=nil {_gec ,_bee =nil ,0;}else {_gec ,_bee ,_adg =_ecd .getInfoFromLn (_bc );if _gec ==nil {_gec =_bega ;};};};if _fcdc .NoFill !=nil {_cgca ,_fcf =nil ,0;}else if _bge {_cgca =_ecd ._aafd ._dagg ;_fcf =_ecd ._aafd ._fbag ;_afe =_ecd ._aafd ._ebcd ;}else if _afd :=_fcdc .SolidFill ;_afd !=nil {_cgca ,_fcf =_ecd .getColorFromSolidFill (_afd );};var _gef bool ;if _ddg :=_fcdc .Xfrm ;_ddg !=nil {_cba ,_bbe ,_gdg ,_abae =_f .GetDataFromXfrm (_ddg );_gef =true ;};if _caag :=_fcdc .CustGeom ;_caag !=nil {_gfc :=[]_ac .Point {};_bda ,_dad :=1.0,1.0;if _dagc :=_caag .PathLst ;_dagc !=nil {for _ ,_gdc :=range _dagc .Path {if _gdc !=nil {if _bcb :=_gdc .WAttr ;_bcb !=nil {_bda =_gdg /_fe .FromEMU (*_bcb );};if _bea :=_gdc .HAttr ;_bea !=nil {_dad =_abae /_fe .FromEMU (*_bea );};for _ ,_abd :=range _gdc .Close {if _abd !=nil {};};for _ ,_abb :=range _gdc .MoveTo {if _abb !=nil &&_abb .Pt !=nil {_fgd ,_dbd :=_gcc (_abb .Pt );_gfc =append (_gfc ,_ac .Point {X :_fgd *_bda +_cba ,Y :_dbd *_dad +_bbe });};};for _ ,_fde :=range _gdc .LnTo {if _fde !=nil &&_fde .Pt !=nil {_afeb ,_efg :=_gcc (_fde .Pt );_gfc =append (_gfc ,_ac .Point {X :_afeb *_bda +_cba ,Y :_efg *_dad +_bbe });};};_cge :=_ecd ._dece .NewPolygon ([][]_ac .Point {_gfc });_cge .SetFillColor (_cgca );_cge .SetFillOpacity (_fcf );_cge .SetBorderWidth (_bee );if _gec !=nil {_cge .SetBorderColor (_gec );_cge .SetBorderOpacity (_adg );};_bfcc =append (_bfcc ,_cge );};};};};if _fa :=_fcdc .PrstGeom ;_fa !=nil {switch _fa .PrstAttr {case _ced .ST_ShapeTypeRect :if _afe !=nil {_aac :=_ecd .getShapeFromBlipFill (_afe ,_cba ,_bbe ,_gdg ,_abae );_bfcc =append (_bfcc ,_aac );}else {_dcc :=_ecd ._dece .NewRectangle (_cba ,_bbe ,_gdg ,_abae );_dcc .SetFillColor (_cgca );_dcc .SetFillOpacity (_fcf );_dcc .SetBorderWidth (_bee );if _gec !=nil {_dcc .SetBorderColor (_gec );_dcc .SetBorderOpacity (_adg );};_bfcc =append (_bfcc ,_dcc );};case _ced .ST_ShapeTypeLine :_aaga :=_ecd ._dece .NewLine (_cba ,_bbe ,_cba +_gdg ,_bbe +_abae );_aaga .SetLineWidth (_bee );if _gec !=nil {_aaga .SetColor (_gec );};_bfcc =append (_bfcc ,_aaga );};};return _bfcc ,_cba ,_bbe ,_gdg ,_abae ,_dbg ,_gef ;};func _cbgf (_afadd ,_dga *_ced .CT_TextBodyProperties )*_ced .CT_TextBodyProperties {_ffdg :=_ced .NewCT_TextBodyProperties ();if _afadd !=nil {*_ffdg =*_afadd ;};if _dga ==nil {return _ffdg ;};if _ffdg .RotAttr ==nil {_ffdg .RotAttr =_dga .RotAttr ;};if _ffdg .SpcFirstLastParaAttr ==nil {_ffdg .SpcFirstLastParaAttr =_dga .SpcFirstLastParaAttr ;};if _ffdg .VertOverflowAttr ==_ced .ST_TextVertOverflowTypeUnset {_ffdg .VertOverflowAttr =_dga .VertOverflowAttr ;};if _ffdg .HorzOverflowAttr ==_ced .ST_TextHorzOverflowTypeUnset {_ffdg .HorzOverflowAttr =_dga .HorzOverflowAttr ;};if _ffdg .VertAttr ==_ced .ST_TextVerticalTypeUnset {_ffdg .VertAttr =_dga .VertAttr ;};if _ffdg .WrapAttr ==_ced .ST_TextWrappingTypeUnset {_ffdg .WrapAttr =_dga .WrapAttr ;};if _ffdg .LInsAttr ==nil {_ffdg .LInsAttr =_dga .LInsAttr ;};if _ffdg .TInsAttr ==nil {_ffdg .TInsAttr =_dga .TInsAttr ;};if _ffdg .RInsAttr ==nil {_ffdg .RInsAttr =_dga .RInsAttr ;};if _ffdg .BInsAttr ==nil {_ffdg .BInsAttr =_dga .BInsAttr ;};if _ffdg .NumColAttr ==nil {_ffdg .NumColAttr =_dga .NumColAttr ;};if _ffdg .SpcColAttr ==nil {_ffdg .SpcColAttr =_dga .SpcColAttr ;};if _ffdg .RtlColAttr ==nil {_ffdg .RtlColAttr =_dga .RtlColAttr ;};if _ffdg .AnchorAttr ==_ced .ST_TextAnchoringTypeUnset {_ffdg .AnchorAttr =_dga .AnchorAttr ;};if _ffdg .AnchorCtrAttr ==nil {_ffdg .AnchorCtrAttr =_dga .AnchorCtrAttr ;};if _ffdg .ForceAAAttr ==nil {_ffdg .ForceAAAttr =_dga .ForceAAAttr ;};if _ffdg .UprightAttr ==nil {_ffdg .UprightAttr =_dga .UprightAttr ;};if _ffdg .CompatLnSpcAttr ==nil {_ffdg .CompatLnSpcAttr =_dga .CompatLnSpcAttr ;};if _ffdg .PrstTxWarp ==nil {_ffdg .PrstTxWarp =_dga .PrstTxWarp ;};if _ffdg .NoAutofit ==nil {_ffdg .NoAutofit =_dga .NoAutofit ;};if _ffdg .NormAutofit ==nil {_ffdg .NormAutofit =_dga .NormAutofit ;};if _ffdg .SpAutoFit ==nil {_ffdg .SpAutoFit =_dga .SpAutoFit ;};if _ffdg .Scene3d ==nil {_ffdg .Scene3d =_dga .Scene3d ;};if _ffdg .Sp3d ==nil {_ffdg .Sp3d =_dga .Sp3d ;};if _ffdg .FlatTx ==nil {_ffdg .FlatTx =_dga .FlatTx ;};if _ffdg .ExtLst ==nil {_ffdg .ExtLst =_dga .ExtLst ;};return _ffdg ;};type paragraph struct{_beab float64 ;_gba float64 ;_gbac float64 ;_cceg float64 ;_acf float64 ;_cecc float64 ;_efgd float64 ;_fdgd float64 ;_bacfg _ced .ST_TextAlignType ;_fad float64 ;_dfac bool ;_bbfd []*line ;};const (FontStyle_Regular FontStyle =0;FontStyle_Bold FontStyle =1;FontStyle_Italic FontStyle =2;FontStyle_BoldItalic FontStyle =3;);func _bgeag (_effd ,_fadd *_ced .CT_TableStyleTextStyle )*_ced .CT_TableStyleTextStyle {_adcc :=_ced .NewCT_TableStyleTextStyle ();if _effd !=nil {*_adcc =*_effd ;};if _fadd ==nil {return _adcc ;};if _adcc .BAttr ==_ced .ST_OnOffStyleTypeUnset {_adcc .BAttr =_fadd .BAttr ;};if _adcc .IAttr ==_ced .ST_OnOffStyleTypeUnset {_adcc .IAttr =_fadd .IAttr ;};if _adcc .Font ==nil {_adcc .Font =_fadd .Font ;};if _adcc .FontRef ==nil {_adcc .FontRef =_fadd .FontRef ;};if _adcc .ScrgbClr ==nil {_adcc .ScrgbClr =_fadd .ScrgbClr ;};if _adcc .SrgbClr ==nil {_adcc .SrgbClr =_fadd .SrgbClr ;};if _adcc .HslClr ==nil {_adcc .HslClr =_fadd .HslClr ;};if _adcc .SysClr ==nil {_adcc .SysClr =_fadd .SysClr ;};if _adcc .SchemeClr ==nil {_adcc .SchemeClr =_fadd .SchemeClr ;};if _adcc .PrstClr ==nil {_adcc .PrstClr =_fadd .PrstClr ;};return _adcc ;};func _gebe (_gdca *_ced .CT_TableCellProperties ,_fca *_ced .CT_TableStyleCellStyle ,_cfc ,_gbae ,_abca ,_gbd bool )*_ced .CT_TableCellProperties {_abfc :=_ced .NewCT_TableCellProperties ();if _gdca !=nil {*_abfc =*_gdca ;};if _fca ==nil {return _abfc ;};if _bebb :=_fca .FillRef ;_bebb !=nil {_aage :=_ced .NewCT_SolidColorFillProperties ();_aage .ScrgbClr =_bebb .ScrgbClr ;_aage .SrgbClr =_bebb .SrgbClr ;_aage .HslClr =_bebb .HslClr ;_aage .SysClr =_bebb .SysClr ;_aage .SchemeClr =_bebb .SchemeClr ;_aage .PrstClr =_bebb .PrstClr ;_abfc .SolidFill =_aage ;};if _abfc .NoFill ==nil &&_abfc .SolidFill ==nil {if _egag :=_fca .Fill ;_egag !=nil {if _abfc .NoFill ==nil {_abfc .NoFill =_egag .NoFill ;};if _abfc .SolidFill ==nil {_abfc .SolidFill =_egag .SolidFill ;};};};if _gbdc :=_fca .TcBdr ;_gbdc !=nil {if _abfc .LnL ==nil {var _eae *_ced .CT_ThemeableLineStyle ;if _abca {_eae =_gbdc .Left ;}else {_eae =_gbdc .InsideV ;};if _eae !=nil {_abfc .LnL =_eae .Ln ;};};if _abfc .LnR ==nil {var _acbc *_ced .CT_ThemeableLineStyle ;if _gbd {_acbc =_gbdc .Right ;}else {_acbc =_gbdc .InsideV ;};if _acbc !=nil {_abfc .LnR =_acbc .Ln ;};};if _abfc .LnT ==nil {var _bgee *_ced .CT_ThemeableLineStyle ;if _cfc {_bgee =_gbdc .Top ;}else {_bgee =_gbdc .InsideH ;};if _bgee !=nil {_abfc .LnT =_bgee .Ln ;};};if _abfc .LnB ==nil {var _ffff *_ced .CT_ThemeableLineStyle ;if _gbae {_ffff =_gbdc .Bottom ;}else {_ffff =_gbdc .InsideH ;};if _ffff !=nil {_abfc .LnB =_ffff .Ln ;};};};return _abfc ;};func (_caf *convertContext )addCellToTable (_ebdf *_ff .Table ,_bdc *_ced .CT_TableCell ,_daa *_ced .CT_TablePartStyle ,_cda float64 ,_bddb ,_ege ,_gbea ,_bbbc bool )float64 {var _cff *_ff .TableCell ;_acd :=1;if _bdc .GridSpanAttr !=nil {_acd =int (*_bdc .GridSpanAttr );};_cff =_ebdf .MultiColCell (_acd );_abbf :=_bdc .TcPr ;var _gggd *_ced .CT_TableStyleTextStyle ;if _daa !=nil {_abbf =_gebe (_abbf ,_daa .TcStyle ,_bddb ,_ege ,_gbea ,_bbbc );_gggd =_daa .TcTxStyle ;};_gaec :=_df ;_cggg :=_ff .CellVerticalAlignmentMiddle ;if _abbf !=nil {if _aee :=_abbf .LnL ;_aee !=nil {_fgc ,_bbca ,_fffe :=_caf .getBorderStyle (_aee );_cff .SetBorder (_ff .CellBorderSideLeft ,_fgc ,_fffe );if _bbca !=nil &&*_bbca !=nil {_cff .SetSideBorderColor (_ff .CellBorderSideLeft ,*_bbca );};};if _ddc :=_abbf .LnT ;_ddc !=nil {_cbae ,_gggc ,_ecb :=_caf .getBorderStyle (_ddc );_cff .SetBorder (_ff .CellBorderSideTop ,_cbae ,_ecb );if _gggc !=nil &&*_gggc !=nil {_cff .SetSideBorderColor (_ff .CellBorderSideTop ,*_gggc );};};if _beb :=_abbf .LnR ;_beb !=nil {_abf ,_bdaf ,_cfe :=_caf .getBorderStyle (_beb );_cff .SetBorder (_ff .CellBorderSideRight ,_abf ,_cfe );if _bdaf !=nil &&*_bdaf !=nil {_cff .SetSideBorderColor (_ff .CellBorderSideRight ,*_bdaf );};};if _decd :=_abbf .LnB ;_decd !=nil {_afa ,_bff ,_befe :=_caf .getBorderStyle (_decd );_cff .SetBorder (_ff .CellBorderSideBottom ,_afa ,_befe );if _bff !=nil &&*_bff !=nil {_cff .SetSideBorderColor (_ff .CellBorderSideBottom ,*_bff );};};if _ggb :=_abbf .MarLAttr ;_ggb !=nil {_gaec =float64 (_f .FromSTCoordinate32 (*_ggb ));};switch _abbf .AnchorAttr {case _ced .ST_TextAnchoringTypeT :_cggg =_ff .CellVerticalAlignmentTop ;case _ced .ST_TextAnchoringTypeB :_cggg =_ff .CellVerticalAlignmentBottom ;};if _abbf .NoFill ==nil {if _cegc :=_abbf .SolidFill ;_cegc !=nil {_aga ,_ :=_caf .getColorFromSolidFill (_cegc );_cff .SetBackgroundColor (_aga );};};};_cff .SetVerticalAlignment (_cggg );_cff .SetIndent (_gaec );var _efa float64 ;if _cfbf :=_bdc .TxBody ;_cfbf !=nil {_acgg :=_caf .makePdfDivisionFromTxBody (_cfbf ,_cda ,_efa ,_gggd );_efa =_acgg .Height ();_cff .SetContent (_acgg );};return _efa ;};type romanMatch struct{_bcd int ;_bbbg string ;};func (_efb *convertContext )getShapes (_adb *_bg .CT_Shape )[]_ff .Drawable {_bdd :=[]_ff .Drawable {};_gf :=_adb .SpPr ;if _gf ==nil {return _bdd ;};var _cefc bool ;if _ffa :=_adb .UseBgFillAttr ;_ffa !=nil {_cefc =*_ffa ;};_edb ,_abc ,_eed ,_edd ,_bac ,_gcdd ,_bbc :=_efb .getShapesFromSpPr (_gf ,_adb .Style ,_cefc );_bdd =append (_bdd ,_edb ...);if _cbec :=_adb .TxBody ;_cbec !=nil {_dfe ,_bfgb ,_bfbb ,_ddbg ,_gde :=_efb .getPhData (_adb );if _dfe !=nil &&!_bbc {_abc ,_eed ,_edd ,_bac =_f .GetDataFromXfrm (_dfe );};_gaeb ,_afbb :=_efb .makePdfBlockFromTxBody (_cbec ,_bfgb ,_bfbb ,_edd ,_bac ,_gcdd ,_ddbg ,_gde );if _afbb !=nil {_a .Log .Debug ("\u0043\u0061\u006e\u006e\u006f\u0074\u0020\u006d\u0061\u006b\u0065\u0020\u0050\u0044\u0046\u0020\u0062\u006c\u006f\u0063\u006b\u0020\u0066\u0072o\u006d\u0020\u0074\u0065\u0078t\u0062\u006fx\u003a\u0020\u0025\u0073",_afbb );}else if _gaeb !=nil {_gaeb .SetPos (_abc ,_eed );_bdd =append (_bdd ,_gaeb );};};return _bdd ;};var _bdcb =map[string ]int32 {"\u0076":9830,"\u00d8":8594,"\u00fc":8730};func _fgfba (_eaffe ,_addg *_ced .CT_TextCharacterProperties )*_ced .CT_TextCharacterProperties {_dfde :=_ced .NewCT_TextCharacterProperties ();if _eaffe !=nil {*_dfde =*_eaffe ;};if _addg ==nil {return _dfde ;};if _dfde .KumimojiAttr ==nil {_dfde .KumimojiAttr =_addg .KumimojiAttr ;};if _dfde .LangAttr ==nil {_dfde .LangAttr =_addg .LangAttr ;};if _dfde .AltLangAttr ==nil {_dfde .AltLangAttr =_addg .AltLangAttr ;};if _dfde .SzAttr ==nil {_dfde .SzAttr =_addg .SzAttr ;};if _dfde .BAttr ==nil {_dfde .BAttr =_addg .BAttr ;};if _dfde .IAttr ==nil {_dfde .IAttr =_addg .IAttr ;};if _dfde .UAttr ==_ced .ST_TextUnderlineTypeUnset {_dfde .UAttr =_addg .UAttr ;};if _dfde .StrikeAttr ==_ced .ST_TextStrikeTypeUnset {_dfde .StrikeAttr =_addg .StrikeAttr ;};if _dfde .KernAttr ==nil {_dfde .KernAttr =_addg .KernAttr ;};if _dfde .CapAttr ==_ced .ST_TextCapsTypeUnset {_dfde .CapAttr =_addg .CapAttr ;};if _dfde .SpcAttr ==nil {_dfde .SpcAttr =_addg .SpcAttr ;};if _dfde .NormalizeHAttr ==nil {_dfde .NormalizeHAttr =_addg .NormalizeHAttr ;};if _dfde .BaselineAttr ==nil {_dfde .BaselineAttr =_addg .BaselineAttr ;};if _dfde .NoProofAttr ==nil {_dfde .NoProofAttr =_addg .NoProofAttr ;};if _dfde .DirtyAttr ==nil {_dfde .DirtyAttr =_addg .DirtyAttr ;};if _dfde .ErrAttr ==nil {_dfde .ErrAttr =_addg .ErrAttr ;};if _dfde .SmtCleanAttr ==nil {_dfde .SmtCleanAttr =_addg .SmtCleanAttr ;};if _dfde .SmtIdAttr ==nil {_dfde .SmtIdAttr =_addg .SmtIdAttr ;};if _dfde .BmkAttr ==nil {_dfde .BmkAttr =_addg .BmkAttr ;};if _dfde .Ln ==nil {_dfde .Ln =_addg .Ln ;};if _dfde .NoFill ==nil {_dfde .NoFill =_addg .NoFill ;};if _dfde .SolidFill ==nil {_dfde .SolidFill =_addg .SolidFill ;};if _dfde .BlipFill ==nil {_dfde .BlipFill =_addg .BlipFill ;};if _dfde .EffectLst ==nil {_dfde .EffectLst =_addg .EffectLst ;};if _dfde .EffectDag ==nil {_dfde .EffectDag =_addg .EffectDag ;};if _dfde .Highlight ==nil {_dfde .Highlight =_addg .Highlight ;};if _dfde .ULnTx ==nil {_dfde .ULnTx =_addg .ULnTx ;};if _dfde .ULn ==nil {_dfde .ULn =_addg .ULn ;};if _dfde .UFillTx ==nil {_dfde .UFillTx =_addg .UFillTx ;};if _dfde .UFill ==nil {_dfde .UFill =_addg .UFill ;};if _dfde .Latin ==nil {_dfde .Latin =_addg .Latin ;};if _dfde .Ea ==nil {_dfde .Ea =_addg .Ea ;};if _dfde .Cs ==nil {_dfde .Cs =_addg .Cs ;};if _dfde .Sym ==nil {_dfde .Sym =_addg .Sym ;};if _dfde .Rtl ==nil {_dfde .Rtl =_addg .Rtl ;};return _dfde ;};func (_bcfc *convertContext )getPhData (_adc *_bg .CT_Shape )(*_ced .CT_Transform2D ,*_ced .CT_TextBodyProperties ,*_ced .CT_TextListStyle ,bool ,bool ){_bdge ,_adgf :=_edee (_adc );_cbcff :=_adgf ==nil ;_befc ,_cagd ,_cdbe ,_aeeg :=_gebb (_bcfc ._bbcb .CSld ,_bdge ,_adgf ,_cbcff );_beae ,_feaa ,_ebbg ,_fab :=_gebb (_bcfc ._gcdde .CSld ,_bdge ,_adgf ,_cbcff );if _beae ==nil {_beae =_befc ;};_ggae ,_bgfc :=_begb (_feaa ,_cagd );var _dgfa ,_cdbg bool ;if _ebbg ==nil {if _cdbe !=nil {_dgfa =*_cdbe ;};}else {_dgfa =*_ebbg ;};if _fab ==nil {if _aeeg !=nil {_cdbg =*_aeeg ;};}else {_cdbg =*_fab ;};return _beae ,_ggae ,_bgfc ,_dgfa ,_cdbg ;};func (_ffaa *convertContext )makeStyleFromRPr (_bbdb *_ced .CT_TextCharacterProperties )(*_ff .TextStyle ,bool ,bool ,bool ){var _gafd ,_gac ,_egaa bool ;_ddge :=_ffaa ._dece .NewTextStyle ();if _bbdb !=nil {_eeg :=_f .FontStyle_Regular ;_cgg :=_cbcf (_bbdb .BAttr );_gfa :=_cbcf (_bbdb .IAttr );if _cgg &&_gfa {_eeg =_f .FontStyle_BoldItalic ;}else if _cgg {_eeg =_f .FontStyle_Bold ;}else if _gfa {_eeg =_f .FontStyle_Italic ;};_egaa =_bbdb .UAttr !=_ced .ST_TextUnderlineTypeUnset &&_bbdb .UAttr !=_ced .ST_TextUnderlineTypeNone ;_bcg :="\u0064e\u0066\u0061\u0075\u006c\u0074";if _eea :=_bbdb .Latin ;_eea !=nil {_bcg =_eea .TypefaceAttr ;}else if _cedb :=_bbdb .Ea ;_cedb !=nil {_bcg =_cedb .TypefaceAttr ;}else if _bcbd :=_bbdb .Cs ;_bcbd !=nil {_bcg =_bcbd .TypefaceAttr ;}else if _gaef :=_bbdb .Sym ;_gaef !=nil {_bcg =_gaef .TypefaceAttr ;};if _dae ,_ggg :=_f .StdFontsMap [_bcg ];_ggg {_ddge .Font =_f .AssignStdFontByName (_ddge ,_dae [_eeg ]);}else if _ffde :=_f .GetRegisteredFont (_bcg ,_eeg );_ffde !=nil {_ddge .Font =_ffde ;}else {_a .Log .Debug ("\u0046\u006f\u006e\u0074\u0020\u0025\u0073\u0020\u0077\u0069\u0074h\u0020\u0073\u0074\u0079\u006c\u0065\u0020\u0025s\u0020i\u0073\u0020\u006e\u006f\u0074\u0020\u0066\u006f\u0075\u006e\u0064\u002c\u0020\u0072\u0065\u0073\u0065\u0074 \u0074\u006f\u0020\u0064\u0065\u0066\u0061\u0075\u006c\u0074\u002e",_bcg ,_eeg );_ddge .Font =_f .AssignStdFontByName (_ddge ,_f .StdFontsMap ["\u0064e\u0066\u0061\u0075\u006c\u0074"][_eeg ]);};var _eafe float64 ;if _gea :=_bbdb .SzAttr ;_gea !=nil {_eafe =float64 (*_gea )/100;}else {_eafe =_f .DefaultFontSize ;};if _eddd :=_bbdb .BaselineAttr ;_eddd !=nil {if _ecdf :=_eddd .ST_PercentageDecimal ;_ecdf !=nil {if *_ecdf > 0{_gafd =true ;}else if *_ecdf < 0{_gac =true ;};};};if _gafd ||_gac {_eafe *=0.64;};_ddge .FontSize =_eafe ;_dff :=0.0;if _bgfa :=_bbdb .SpcAttr ;_bgfa !=nil {if _eba :=_bgfa .ST_TextPointUnqualified ;_eba !=nil {_dff =float64 (*_eba )/100;};};_ddge .CharSpacing =_dff ;};return &_ddge ,_gafd ,_gac ,_egaa ;};func (_fac *textboxContext )addTextSymbol (_fegdc *symbol ){_daef :=_ff .New ();_eaff :=_daef .NewStyledParagraph ();_eaff .SetMargins (0,0,0,0);_bdcf :=_eaff .Append (_fegdc ._abda );_dadg :=0.0;if _fegdc ._accf !=nil {_bdcf .Style =*_fegdc ._accf ;if _fegdc ._accf .CharSpacing !=0{_dadg =_fegdc ._accf .CharSpacing ;};};_fegdc ._ffce =_eaff .Height ();_fegdc ._abg =_eaff .Height ()*1.2;if _fegdc ._abg < _fac ._ecbb ._fad {_fegdc ._abg =_fac ._ecbb ._fad ;};if _fegdc ._agga ==0{_fegdc ._agga =_eaff .Width ()+_dadg ;};if len (_fac ._gggg ._bgdg )> 0{_cae :=_fac ._gggg ._bgdg [len (_fac ._gggg ._bgdg )-1]._abda ;if _fac ._ecbb ._dfac ||_f .IsNoSpaceLanguage (_cae )||(_cae =="\u0020")!=(_fegdc ._abda =="\u0020"){_fac .addCurrentWordToParagraph ();_fac .newWord ();};};_fac ._gggg ._bgdg =append (_fac ._gggg ._bgdg ,_fegdc );_fegdc ._adbaa =_fac ._gggg ._cfda ;_fac ._gggg ._cfda +=_fegdc ._agga ;if _fegdc ._abda !="\u0020"{_fac ._gggg ._ebab =false ;};};func (_fgda *textboxContext )addCurrentParagraph (){_fgda ._afdc =_fgda ._ecbb ._efgd +_fgda ._ecbb ._gba +_fgda ._ecbb ._fdgd +_fgda ._ecbb ._gbac ;_fgda ._aacb =append (_fgda ._aacb ,_fgda ._ecbb );_fgda .alignParagraph ();};func (_ccd *convertContext )getConnectors (_cfbg *_bg .CT_Connector )[]_ff .Drawable {_acab ,_ ,_ ,_ ,_ ,_ ,_ :=_ccd .getShapesFromSpPr (_cfbg .SpPr ,_cfbg .Style ,false );return _acab ;};

// FontStyle represents a kind of font styling. It can be FontStyle_Regular, FontStyle_Bold, FontStyle_Italic and FontStyle_BoldItalic.
type FontStyle =_f .FontStyle ;func (_ccgd *textboxContext )alignSymbolsVertically (){for _ ,_cdag :=range _ccgd ._aacb {for _ ,_feab :=range _cdag ._bbfd {_aadc :=0.0;for _ ,_dge :=range _feab ._dfab {for _ ,_dcde :=range _dge ._bgdg {if _dcde ._abg > _aadc {_aadc =_dcde ._abg ;};};};for _ ,_deca :=range _feab ._dfab {for _ ,_gggb :=range _deca ._bgdg {if _gggb ._ffce < _aadc {_gggb ._gcef =_aadc -_gggb ._ffce ;};};};};};};func (_cg *convertContext )extractDefaultProperties (){_bgd :=_cg ._dce .X ();_gbf :=_bgd .DefaultTextStyle ;var _cd ,_fec ,_ea ,_de ,_dfd ,_bfb ,_ae ,_feg ,_eb ,_cdd *_ced .CT_TextParagraphProperties ;if _gbf !=nil {_cd =_gbf .DefPPr ;_fec =_dgec (_gbf .Lvl1pPr ,_cd );_ea =_dgec (_gbf .Lvl2pPr ,_cd );_de =_dgec (_gbf .Lvl3pPr ,_cd );_dfd =_dgec (_gbf .Lvl4pPr ,_cd );_bfb =_dgec (_gbf .Lvl5pPr ,_cd );_ae =_dgec (_gbf .Lvl6pPr ,_cd );_feg =_dgec (_gbf .Lvl7pPr ,_cd );_eb =_dgec (_gbf .Lvl8pPr ,_cd );_cdd =_dgec (_gbf .Lvl9pPr ,_cd );_cg ._gagc =_cd ;_cg ._ddec =_cd .DefRPr ;};_cg ._cga =make ([]*_ced .CT_TextParagraphProperties ,9);_cg ._cga [0]=_fec ;_cg ._cga [1]=_ea ;_cg ._cga [2]=_de ;_cg ._cga [3]=_dfd ;_cg ._cga [4]=_bfb ;_cg ._cga [5]=_ae ;_cg ._cga [6]=_feg ;_cg ._cga [7]=_eb ;_cg ._cga [8]=_cdd ;_cgc :=_cg ._dce .SlideMasters ()[0].X ();_eab :=_cgc .TxStyles ;_dcd :=_eab .TitleStyle ;_cg ._gdef =_dgec (_dcd .DefPPr ,_cd );_cg ._ada =_cg ._gdef .DefRPr ;_cg ._faff =make ([]*_ced .CT_TextParagraphProperties ,9);_cg ._faff [0]=_dgec (_dcd .Lvl1pPr ,_fec );_cg ._faff [1]=_dgec (_dcd .Lvl2pPr ,_ea );_cg ._faff [2]=_dgec (_dcd .Lvl3pPr ,_de );_cg ._faff [3]=_dgec (_dcd .Lvl4pPr ,_dfd );_cg ._faff [4]=_dgec (_dcd .Lvl5pPr ,_bfb );_cg ._faff [5]=_dgec (_dcd .Lvl6pPr ,_ae );_cg ._faff [6]=_dgec (_dcd .Lvl7pPr ,_feg );_cg ._faff [7]=_dgec (_dcd .Lvl8pPr ,_eb );_cg ._faff [8]=_dgec (_dcd .Lvl9pPr ,_cdd );_caa :=_eab .BodyStyle ;_cg ._bdab =_dgec (_caa .DefPPr ,_cd );_cg ._aec =_cg ._bdab .DefRPr ;_cg ._bbad =make ([]*_ced .CT_TextParagraphProperties ,9);_cg ._bbad [0]=_dgec (_caa .Lvl1pPr ,_fec );_cg ._bbad [1]=_dgec (_caa .Lvl2pPr ,_ea );_cg ._bbad [2]=_dgec (_caa .Lvl3pPr ,_de );_cg ._bbad [3]=_dgec (_caa .Lvl4pPr ,_dfd );_cg ._bbad [4]=_dgec (_caa .Lvl5pPr ,_bfb );_cg ._bbad [5]=_dgec (_caa .Lvl6pPr ,_ae );_cg ._bbad [6]=_dgec (_caa .Lvl7pPr ,_feg );_cg ._bbad [7]=_dgec (_caa .Lvl8pPr ,_eb );_cg ._bbad [8]=_dgec (_caa .Lvl9pPr ,_cdd );};type background struct{_dagg _ff .Color ;_fbag float64 ;_ebcd *_ced .CT_BlipFillProperties ;};func _gfef (_ebfd ,_eeeb *_ced .CT_TextListStyle )*_ced .CT_TextListStyle {_fcc :=_ced .NewCT_TextListStyle ();if _ebfd !=nil {*_fcc =*_ebfd ;};if _eeeb ==nil {return _fcc ;};_fcc .DefPPr =_dgec (_fcc .DefPPr ,_eeeb .DefPPr );_fcc .Lvl1pPr =_dgec (_fcc .Lvl1pPr ,_eeeb .Lvl1pPr );_fcc .Lvl2pPr =_dgec (_fcc .Lvl2pPr ,_eeeb .Lvl2pPr );_fcc .Lvl3pPr =_dgec (_fcc .Lvl3pPr ,_eeeb .Lvl3pPr );_fcc .Lvl4pPr =_dgec (_fcc .Lvl4pPr ,_eeeb .Lvl4pPr );_fcc .Lvl5pPr =_dgec (_fcc .Lvl5pPr ,_eeeb .Lvl5pPr );_fcc .Lvl6pPr =_dgec (_fcc .Lvl6pPr ,_eeeb .Lvl6pPr );_fcc .Lvl7pPr =_dgec (_fcc .Lvl7pPr ,_eeeb .Lvl7pPr );_fcc .Lvl8pPr =_dgec (_fcc .Lvl8pPr ,_eeeb .Lvl8pPr );_fcc .Lvl9pPr =_dgec (_fcc .Lvl9pPr ,_eeeb .Lvl9pPr );return _fcc ;};func (_cgcga *convertContext )getColorFromFontReference (_abgb *_ced .CT_FontReference )_ff .Color {var _ddcb _ff .Color ;var _dage string ;if _cfdf :=_abgb .SrgbClr ;_cfdf !=nil {_dage =_cfdf .ValAttr ;}else if _cfa :=_abgb .SchemeClr ;_cfa !=nil {_dage =_f .GetColorStringFromDmlColor (_cgcga ._dce .GetColorBySchemeColor (_cfa .ValAttr ));_dage =_f .AdjustColor (_dage ,_cfa .EG_ColorTransform );};if _dage !=""{_ddcb =_ff .ColorRGBFromHex ("\u0023"+_dage );};return _ddcb ;};func (_fbfa *convertContext )stretchImage (_gcd *_ff .Image ,_accg *_ced .CT_StretchInfoProperties ,_ffd ,_bba ,_db ,_cdc float64 )(*_ff .Image ,float64 ,float64 ){_efd :=_accg .FillRect ;if _efd ==nil {_egd :=_gcd .Width ()/_gcd .Height ();_dde :=_db /_cdc ;var _cfb ,_fegd float64 ;if _egd > _dde {_fegd =_cdc ;_cfb =_cdc *_egd ;}else {_cfb =_db ;_fegd =_db /_egd ;};_gcd .Scale (_cfb /_gcd .Width (),_fegd /_gcd .Height ());return _gcd ,_ffd ,_bba ;};var _cdda ,_ecc ,_cbe ,_ecf float64 ;if _egdc :=_efd .LAttr ;_egdc !=nil {_cbe =_f .FromSTPercentage (_egdc );};if _dda :=_efd .TAttr ;_dda !=nil {_cdda =_f .FromSTPercentage (_dda );};if _aed :=_efd .RAttr ;_aed !=nil {_ecf =_f .FromSTPercentage (_aed );};if _fecb :=_efd .BAttr ;_fecb !=nil {_ecc =_f .FromSTPercentage (_fecb );};_cedc :=_db *(1-_cbe -_ecf );_bdb :=_cdc *(1-_cdda -_ecc );_gcd .Scale (_cedc /_gcd .Width (),_bdb /_gcd .Height ());return _gcd ,_ffd +_cbe *_db ,_bba +_cdda *_cdc ;};func _dedg (_abbab float64 )float64 {return _abbab *_fe .Millimeter };func _cbcf (_ebfb *bool )bool {return _ebfb !=nil &&*_ebfb };func (_abgfe *textboxContext )newLine (){if _abgfe ._ecbb ==nil {_abgfe .newParagraph ();};_geef :=_abgfe ._ecbb ._fdgd +_abgfe ._ecbb ._gba ;_fecac :=&line {};_fecac ._bdf =_abgfe ._ecbb ._acf ;if len (_abgfe ._ecbb ._bbfd )==0{_fecac ._bdf +=_abgfe ._ecbb ._cceg ;};_fecac ._dcf =_abgfe ._ecbb ._cecc ;_fecac ._fdfg =_fecac ._bdf ;_fecac ._efdf =_geef ;_abgfe ._ecbb ._bbfd =append (_abgfe ._ecbb ._bbfd ,_fecac );_abgfe ._fag =_fecac ;};func (_bbf *convertContext )tileImage (_accd *_ff .Image ,_ffcd *_ced .CT_TileInfoProperties ,_gaaf ,_bfe float64 )*_ff .Image {_bed ,_bgc :=1.0,1.0;if _gca :=_ffcd .SxAttr ;_gca !=nil {_bed =_f .FromSTPercentage (_gca );};if _agg :=_ffcd .SyAttr ;_agg !=nil {_bgc =_f .FromSTPercentage (_agg );};_cdg :=_f .MakeTempCreator (_gaaf ,_bfe );_accd .Scale (_bed ,_bgc );_ee ,_gee :=_accd .Width (),_accd .Height ();var _gae ,_agb float64 ;if _ab :=_ffcd .TxAttr ;_ab !=nil {_gae =_fe .FromEMU (_f .FromSTCoordinate (*_ab ));};if _fecd :=_ffcd .TyAttr ;_fecd !=nil {_agb =_fe .FromEMU (_f .FromSTCoordinate (*_fecd ));};if _gae > 0{_gae -=_ee ;};if _agb > 0{_agb -=_gee ;};_bd :=_bbf ._fgfe /_ee +1;_afc :=_bbf ._bacf /_gee +1;for _bfea :=0.0;_bfea <=_bd ;_bfea ++{_gge :=_bfea *_ee ;for _bbfe :=0.0;_bbfe <=_afc ;_bbfe ++{_bfa :=_bbfe *_gee ;_accd .SetPos (_gge +_gae ,_bfa +_agb );_cdg .Draw (_accd );};};_dfa ,_aba :=_f .GetPageFromCreator (_cdg );if _aba !=nil {_a .Log .Debug ("\u0043\u0061\u006e\u006e\u006f\u0074 \u0067\u0065\u0074\u0020\u0069\u006d\u0061\u0067\u0065\u0020\u0066\u0072\u006fm\u0020\u0063\u0072\u0065\u0061\u0074\u006fr\u003a\u0020\u0025\u0073",_aba );return nil ;};_afb ,_aba :=_ad .NewImageDevice ().Render (_dfa );if _aba !=nil {_a .Log .Debug ("\u0043\u0061\u006eno\u0074\u0020\u0072\u0065\u006e\u0064\u0065\u0072\u0020\u0069\u006d\u0061\u0067\u0065\u003a\u0020\u0025\u0073",_aba );return nil ;};_fbb ,_aba :=_bbf ._dece .NewImageFromGoImage (_afb );if _aba !=nil {_a .Log .Debug ("\u0043\u0061nn\u006f\u0074\u0020c\u0072\u0065\u0061\u0074e i\u006dag\u0065\u0020\u0066\u0072\u006f\u006d\u0020Go\u0049\u006d\u0061\u0067\u0065\u003a\u0020%\u0073",_aba );return nil ;};return _fbb ;};func (_eg *convertContext )makePdfBlockFromChart (_ge *_ca .Chart ,_fd ,_ade float64 )(*_ff .Block ,error ){_fdg :=_ge .CT_RelId .IdAttr ;_dg :=_eg ._edfa .GetChartSpaceByRelId (_fdg );if _dg ==nil {return nil ,_cb .New ("\u004e\u006f\u0020\u0063\u0068\u0061\u0072\u0074\u0073\u0070\u0061\u0063\u0065");};var _cee *_ced .Theme ;_gc :=_eg ._dce .Themes ();if len (_gc )> 0{_cee =_gc [0];};return _f .MakeBlockFromChartSpace (_dg ,_fd ,_ade ,_cee );};func (_agae *convertContext )getBorderStyle (_gdfb *_ced .CT_LineProperties )(_ff .CellBorderStyle ,*_ff .Color ,float64 ){if _gdfb ==nil ||_gdfb .NoFill !=nil {return _ff .CellBorderStyleNone ,nil ,0;};var _dea _ff .Color ;if _eda :=_gdfb .SolidFill ;_eda !=nil {_dea ,_ =_agae .getColorFromSolidFill (_eda );};_feeb :=0.0;if _cag :=_gdfb .WAttr ;_cag !=nil {_feeb =_fe .FromEMU (int64 (*_cag ));};return _ff .CellBorderStyleSingle ,&_dea ,_feeb ;};func (_cecf *convertContext )makePdfImageFromBlipFill (_daf *_ced .CT_BlipFillProperties )(*_ff .Image ,[]*_ced .CT_BlipChoice ,error ){if _aggb :=_daf .Blip ;_aggb !=nil {if _eccg :=_aggb .EmbedAttr ;_eccg !=nil {_gfdd ,_acff :=_cecf ._edfa .GetImageByRelID (*_eccg );if _acff {_gccf ,_ffb :=_dd .Open (_gfdd .Path ());if _ffb !=nil {_a .Log .Debug ("\u0046\u0069\u006c\u0065 o\u0070\u0065\u006e\u0020\u0065\u0072\u0072\u006f\u0072\u003a\u0020\u0025\u0073",_ffb );return nil ,nil ,_ffb ;};defer _gccf .Close ();_fdc ,_ ,_ffb :=_b .Decode (_gccf );if _ffb !=nil {_a .Log .Debug ("\u0044\u0065\u0063\u006fde\u0020\u0069\u006d\u0061\u0067\u0065\u0020\u0065\u0072\u0072\u006f\u0072\u003a\u0020%\u0073",_ffb );return nil ,nil ,_ffb ;};if _ccf :=_daf .SrcRect ;_ccf !=nil {_ccfe :=_fdc .Bounds ().Size ();_aef :=_ccfe .X ;_ecfgd :=_ccfe .Y ;var _deec ,_dgea ,_daad ,_gddb int ;var _adef bool ;if _aagb :=_ccf .LAttr ;_aagb !=nil {_deec =int (float64 (_aef )*_f .FromSTPercentage (_aagb ));_adef =true ;}else {_deec =0;};if _fffea :=_ccf .TAttr ;_fffea !=nil {_daad =int (float64 (_ecfgd )*_f .FromSTPercentage (_fffea ));_adef =true ;}else {_daad =0;};if _cgcf :=_ccf .RAttr ;_cgcf !=nil {_dgea =int (float64 (_aef )*(1-_f .FromSTPercentage (_cgcf )));_adef =true ;}else {_dgea =_aef ;};if _beeeb :=_ccf .BAttr ;_beeeb !=nil {_gddb =int (float64 (_ecfgd )*(1-_f .FromSTPercentage (_beeeb )));_adef =true ;}else {_gddb =_ecfgd ;};if _adef {_fdc =_f .CropImageByRect (_fdc ,_b .Rect (_deec ,_daad ,_dgea +1,_gddb +1));};};_fffeb ,_ffb :=_cecf ._dece .NewImageFromGoImage (_fdc );if _ffb !=nil {_a .Log .Debug ("\u0043\u0061\u006e\u006e\u006ft\u0020\u0063\u0072\u0065\u0061\u0074\u0065\u0020\u0050\u0044\u0046\u0020\u0069m\u0061\u0067\u0065\u0020\u0066\u0072\u006f\u006d\u0020\u0047\u006f\u0020\u0069\u006d\u0061\u0067\u0065\u003a\u0020\u0025\u0073",_ffb );return nil ,nil ,_ffb ;};return _fffeb ,_aggb .Choice ,nil ;};};};return nil ,nil ,nil ;};

// RegisterFontsFromDirectory registers all fonts from the given directory automatically detecting font families and styles.
func RegisterFontsFromDirectory (dirName string )error {return _f .RegisterFontsFromDirectory (dirName )};func (_deab *convertContext )getColorFromSolidFill (_deb *_ced .CT_SolidColorFillProperties )(_ff .Color ,float64 ){if _deb ==nil {return nil ,1;};var _eee string ;_cbeg :=1.0;if _gecbg :=_deb .SrgbClr ;_gecbg !=nil {_eee =_gecbg .ValAttr ;_cbeg =_f .GetOpacityFromColorTransform (_gecbg .EG_ColorTransform );}else if _bceg :=_deb .SchemeClr ;_bceg !=nil {_eee =_f .GetColorStringFromDmlColor (_deab ._edfa .GetColorBySchemeColor (_bceg .ValAttr ));_eee =_f .AdjustColor (_eee ,_bceg .EG_ColorTransform );_cbeg =_f .GetOpacityFromColorTransform (_bceg .EG_ColorTransform );};if _eee !=""{_ddbc :=_ff .ColorRGBFromHex ("\u0023"+_eee );return _ddbc ,_cbeg ;};return nil ,1;};type symbolStyle struct{_dgfb *string ;_ebb *float64 ;_gbaa *string ;_ged *bool ;_befec *bool ;_dgdc *bool ;_abgf *bool ;_bbfa *bool ;};var _df =_dedg (1.9);func (_dfdf *convertContext )makePdfDivisionFromTxBody (_cbef *_ced .CT_TextBody ,_faf ,_gaf float64 ,_efgf *_ced .CT_TableStyleTextStyle )*_ff .Division {_cdb :=_dfdf ._dece .NewDivision ();_bfef :=_dfdf ._gagc ;_cedd :=_ced .ST_TextAnchoringTypeT ;if _aadd :=_cbef .BodyPr ;_aadd !=nil {if _aede :=_aadd .AnchorAttr ;_aede !=_ced .ST_TextAnchoringTypeUnset {_cedd =_aadd .AnchorAttr ;};};if _fcg :=_cbef .LstStyle ;_fcg !=nil {var _fgf *_ced .CT_TextParagraphProperties ;if _fcg .Lvl1pPr !=nil {_fgf =_fcg .Lvl1pPr ;}else {_fgf =_dfdf ._cga [0];};_bfef =_dgec (_fgf ,_dgec (_fcg .DefPPr ,_bfef ));};for _ ,_bfge :=range _cbef .P {if _bfge !=nil {_cea :=_dfdf ._dece .NewStyledParagraph ();_bged :=_dgec (_bfge .PPr ,_bfef );_gcg :=_fgfba (_bfge .EndParaRPr ,_bged .DefRPr );if len (_bfge .EG_TextRun )==0{_cea .Append ("\u000a");_cdb .Add (_cea );continue ;};for _ ,_fcb :=range _bfge .EG_TextRun {if _cfd :=_fcb .Br ;_cfd !=nil {_cea .Append ("\u000a");}else if _bce :=_fcb .R ;_bce !=nil {_dee :=_aaad (_bce .RPr ,_efgf );_dee =_fgfba (_dee ,_gcg );var _cgb _ff .Color ;if _dee .SolidFill !=nil {_cgb ,_ =_dfdf .getColorFromSolidFill (_dee .SolidFill );}else {_cgb =_ff .ColorBlack ;};_gaad ,_afcf ,_gff ,_ :=_dfdf .makeStyleFromRPr (_dee );_gaad .Color =_cgb ;if _afcf {_gaad .TextRise =0.5;}else if _gff {_gaad .TextRise =-0.5;};_dbge :=_bce .T ;if _dee .CapAttr ==_ced .ST_TextCapsTypeAll {for _ ,_gad :=range _dbge {_gad =[]rune (_ce .ToUpper (string (_gad )))[0];};};_dgbb :=_cea .Append (_dbge );_dgbb .Style =*_gaad ;};};_ =_cedd ;_cdb .Add (_cea );};};return _cdb ;};func (_bbgcg *convertContext )getColorFromMatrixReference (_beabf *_ced .CT_StyleMatrixReference )_ff .Color {if _beabf ==nil {return nil ;};var _eeff _ff .Color ;var _gga string ;if _gcac :=_beabf .SrgbClr ;_gcac !=nil {_gga =_gcac .ValAttr ;}else if _geaa :=_beabf .SchemeClr ;_geaa !=nil {_gga =_f .GetColorStringFromDmlColor (_bbgcg ._dce .GetColorBySchemeColor (_geaa .ValAttr ));_gga =_f .AdjustColor (_gga ,_geaa .EG_ColorTransform );};if _gga !=""{_eeff =_ff .ColorRGBFromHex ("\u0023"+_gga );};return _eeff ;};func (_fbgce *convertContext )makePdfBlockFromTable (_gdf *_ced .Tbl ,_edfe float64 )*_ff .Table {_feed :=_gdf .TblGrid ;if _feed ==nil {return nil ;};_dada :=len (_feed .GridCol );if _dada ==0{return nil ;};_gdd :=[]float64 {};_gfca :=0.0;for _ ,_dbf :=range _feed .GridCol {_agbf :=_fe .FromEMU (_f .FromSTCoordinate (_dbf .WAttr ));_gdd =append (_gdd ,_agbf );_gfca +=_agbf ;};_feca :=[]float64 {};for _gcb :=0;_gcb < _dada ;_gcb ++{_feca =append (_feca ,_gdd [_gcb ]/_gfca );};_gecb :=_fbgce ._dece .NewTable (_dada );_gecb .SetColumnWidths (_feca ...);_efeb :=_gdf .TblPr ;var _bfaa *_ced .CT_TableStyle ;if _dgd :=_efeb .Choice ;_dgd !=nil {if _dgd .TableStyle !=nil {_bfaa =_dgd .TableStyle ;}else if _dgd .TableStyleId !=nil {_bfaa =_fbgce ._dce .GetTableStyleById (*_dgd .TableStyleId );};};_decf :=_ced .NewCT_TablePartStyle ();_decf .TcStyle =_ced .NewCT_TableStyleCellStyle ();_decf .TcTxStyle =_ced .NewCT_TableStyleTextStyle ();if _bfaa !=nil {if _bfaa .WholeTbl !=nil {*_decf =*_bfaa .WholeTbl ;};if _bfaa .TblBg !=nil {if _decf .TcStyle .Fill ==nil {_decf .TcStyle .Fill =_bfaa .TblBg .Fill ;};};};if _decf .TcStyle .Fill ==nil {_decf .TcStyle .Fill =_ced .NewCT_FillProperties ();_decf .TcStyle .Fill .NoFill =_efeb .NoFill ;_decf .TcStyle .Fill .SolidFill =_efeb .SolidFill ;};_bdg :=len (_gdf .Tr );for _gdb ,_bacg :=range _gdf .Tr {_bde :=_gdb ==0;_gcgb :=_gdb ==_bdg -1;_geb :=_gdb %2==0;_fcfb :=len (_bacg .Tc );var _bedd *_ced .CT_TablePartStyle ;if _bde {_bedd =_bfaa .FirstRow ;}else if _geb {_bedd =_bfaa .Band2H ;}else {_bedd =_bfaa .Band1H ;};var _cad float64 ;for _ggfd ,_fbad :=range _bacg .Tc {_bbga :=_ggfd ==0;_geff :=_ggfd ==_fcfb -1;_ddad :=_ggfd %2==0;var _agc *_ced .CT_TablePartStyle ;if _bbga {_agc =_bfaa .FirstCol ;}else if _ddad {_agc =_bfaa .Band2V ;}else {_agc =_bfaa .Band1V ;};_fff :=_ffcg (_ffcg (_agc ,_bedd ),_decf );_gafe :=_fbgce .addCellToTable (_gecb ,_fbad ,_fff ,_edfe *_feca [_ggfd ],_bde ,_gcgb ,_bbga ,_geff );if _gafe > _cad {_cad =_gafe ;};};_afbbb :=_fe .FromEMU (_f .FromSTCoordinate (_bacg .HAttr ));if _afbbb < _cad {_afbbb =_cad ;};if _afbbb < _dedg (4){_afbbb =_dedg (4);};_gecb .SetRowHeight (_gecb .CurRow (),_afbbb );};return _gecb ;};func (_adge *textboxContext )alignParagraphsVertically (_edg _ced .ST_TextAnchoringType ){if _edg ==_ced .ST_TextAnchoringTypeT {return ;};_bfaab :=0.0;for _ ,_bacb :=range _adge ._aacb {_bfaab +=_bacb ._gba +_bacb ._fdgd +_bacb ._gbac ;};var _dbb float64 ;switch _edg {case _ced .ST_TextAnchoringTypeCtr :_dbb =(_adge ._abdf -_bfaab )/2;case _ced .ST_TextAnchoringTypeB :_dbb =_adge ._abdf -_bfaab ;};for _ ,_fada :=range _adge ._aacb {_fada ._efgd +=_dbb ;};};func _gebb (_dfca *_bg .CT_CommonSlideData ,_gcca _bg .ST_PlaceholderType ,_bdec *uint32 ,_abe bool )(*_ced .CT_Transform2D ,*_ced .CT_TextBody ,*bool ,*bool ){if _dfca !=nil &&(_gcca !=_bg .ST_PlaceholderTypeUnset ||!_abe ){if _fcde :=_dfca .SpTree ;_fcde !=nil {for _ ,_fegb :=range _fcde .Choice {if _fegb !=nil {for _ ,_ceb :=range _fegb .Sp {if _ceb !=nil {_eac ,_gfbd :=_edee (_ceb );if _gcca ==_eac {if (_abe &&_gfbd ==nil )||(!_abe &&_gfbd !=nil &&*_gfbd ==*_bdec ){var _eeda *_ced .CT_Transform2D ;if _ceb .SpPr !=nil {_eeda =_ceb .SpPr .Xfrm ;};_bfaf :=_gcca ==_bg .ST_PlaceholderTypeTitle ||_gcca ==_bg .ST_PlaceholderTypeCtrTitle ;_aedea :=!_bfaf &&_gcca !=_bg .ST_PlaceholderTypeUnset ;return _eeda ,_ceb .TxBody ,&_bfaf ,&_aedea ;};};};};};};};};return nil ,nil ,nil ,nil ;};

// RegisterFont makes a PdfFont accessible for using in converting to PDF.
func RegisterFont (name string ,style FontStyle ,font *_bfg .PdfFont ){_f .RegisterFont (name ,style ,font );};type textboxContext struct{_ecff *convertContext ;_fgg float64 ;_abdf float64 ;_fafc *_ff .Creator ;_afdc float64 ;_aacb []*paragraph ;_ecbb *paragraph ;_fag *line ;_gggg *word ;_geac bool ;};func (_cf *convertContext )makeSlide (){_ag :=_cf ._edfa .X ().CSld ;if _ag ==nil {return ;};_aea :=&background {};if _fb :=_ag .Bg ;_fb !=nil {if _cac :=_fb .BgPr ;_cac !=nil {if _cac .NoFill ==nil {if _ga :=_cac .SolidFill ;_ga !=nil {_dgb ,_fg :=_cf .getColorFromSolidFill (_ga );if _dgb !=nil {_aea ._dagg =_dgb ;_aea ._fbag =_fg ;};}else if _gbc :=_cac .BlipFill ;_gbc !=nil {_aea ._ebcd =_gbc ;};};};};_cf ._aafd =_aea ;if _bef :=_ag .SpTree ;_bef !=nil {for _ ,_aca :=range _bef .Choice {if _aca !=nil {for _ ,_ec :=range _aca .Sp {if _ec !=nil {_ddb :=_cf .getShapes (_ec );_cf ._def =append (_cf ._def ,_ddb ...);};};for _ ,_cbc :=range _aca .GraphicFrame {if _cbc !=nil {var _ggf ,_aag ,_bbd ,_ffc float64 ;if _gaa :=_cbc .Xfrm ;_gaa !=nil {_ggf ,_aag ,_bbd ,_ffc =_f .GetDataFromXfrm (_gaa );};if _bbg :=_cbc .Graphic ;_bbg !=nil {if _fbg :=_bbg .GraphicData ;_fbg !=nil {for _ ,_fbgc :=range _fbg .Any {if _ed ,_acc :=_fbgc .(*_ca .Chart );_acc {_fc ,_deg :=_cf .makePdfBlockFromChart (_ed ,_bbd ,_ffc );if _deg !=nil {_a .Log .Debug ("C\u0061\u006e\u006e\u006ft \u0072e\u0061\u0064\u0020\u0062\u006co\u0063\u006b\u003a\u0020\u0025\u0073",_deg );};if _fc !=nil {_fc .SetPos (_ggf ,_aag );_cf ._def =append (_cf ._def ,_fc );};}else if _ega ,_gag :=_fbgc .(*_ced .Tbl );_gag {_cef :=_cf .makePdfBlockFromTable (_ega ,_bbd );if _cef !=nil {_ebc :=_ff .NewBlock (_bbd ,_ffc );_ebc .SetPos (_ggf ,_aag );_ebc .Draw (_cef );_cf ._def =append (_cf ._def ,_ebc );};};};};};};};for _ ,_cgf :=range _aca .CxnSp {if _cgf !=nil {_beg :=_cf .getConnectors (_cgf );_cf ._def =append (_cf ._def ,_beg ...);};};for _ ,_acbe :=range _aca .Pic {if _acbe !=nil {var _da ,_fcd ,_bbgc ,_gd float64 ;if _dag :=_acbe .SpPr ;_dag !=nil {if _fbf :=_dag .Xfrm ;_fbf !=nil {_da ,_fcd ,_bbgc ,_gd =_f .GetDataFromXfrm (_fbf );};};if _acg :=_acbe .BlipFill ;_acg !=nil {_egac :=_cf .getShapeFromBlipFill (_acg ,_da ,_fcd ,_bbgc ,_gd );_cf ._def =append (_cf ._def ,_egac );};};};};};};};func (_afded *textboxContext )alignParagraph (){_bgcg :=_afded ._ecbb ;if _bgcg ._bacfg ==_ced .ST_TextAlignTypeL {return ;};_bcf :=len (_bgcg ._bbfd )-1;for _afcg ,_bedg :=range _bgcg ._bbfd {_bcga :=true ;_cbac :=len (_bedg ._dfab );_dcb :=0.0;for _bga :=len (_bedg ._dfab )-1;_bga >=0;_bga --{_fadb :=_bedg ._dfab [_bga ];if _bcga &&_fadb ._ebab {_cbac =_bga ;}else {_bcga =false ;for _ ,_cdac :=range _fadb ._bgdg {_dcb +=_cdac ._agga ;};};};_bedg ._dfab =_bedg ._dfab [:_cbac ];_gdcba :=_bedg ._dcf -_bedg ._bdf -_dcb ;switch _bgcg ._bacfg {case _ced .ST_TextAlignTypeR :_bedg .moveRight (_gdcba );case _ced .ST_TextAlignTypeCtr :_bedg .moveRight (_gdcba /2);case _ced .ST_TextAlignTypeJust :if _afcg !=_bcf {_aeb :=[]*word {};for _ ,_ggdf :=range _bedg ._dfab {if _ggdf ._ebab {_aeb =append (_aeb ,_ggdf );};};_ddcf :=_gdcba /float64 (len (_aeb ));for _ ,_ceeb :=range _aeb {_ceeb ._cfda +=_ddcf ;};var _baf *word ;for _ ,_efec :=range _bedg ._dfab {if _baf !=nil {_efec ._degf =_baf ._degf +_baf ._cfda ;};_baf =_efec ;};};};};};