//
// Copyright 2020 FoxyUtils ehf. All rights reserved.
//
// This is a commercial product and requires a license to operate.
// A trial license can be obtained at https://unidoc.io
//
// DO NOT EDIT: generated by unitwist Go source code obfuscator.
//
// Use of this source code is governed by the UniDoc End User License Agreement
// terms that can be accessed at https://unidoc.io/eula/

package convert ;import (_ge "bytes";_c "errors";_bb "github.com/unidoc/unioffice/common/logger";_a "github.com/unidoc/unioffice/common/tempstorage";_bf "github.com/unidoc/unioffice/internal/convertutils";_bd "github.com/unidoc/unioffice/measurement";_f "github.com/unidoc/unioffice/presentation";_db "github.com/unidoc/unioffice/schema/soo/dml";_bc "github.com/unidoc/unioffice/schema/soo/dml/chart";_bg "github.com/unidoc/unioffice/schema/soo/pml";_ac "github.com/unidoc/unipdf/v3/contentstream/draw";_dc "github.com/unidoc/unipdf/v3/creator";_bbb "github.com/unidoc/unipdf/v3/model";_be "github.com/unidoc/unipdf/v3/render";_eg "image";_g "image/color";_d "image/draw";_cf "strconv";_b "strings";);func (_aecg *convertContext )makeStyleFromRPr (_afbc *_db .CT_TextCharacterProperties )(*_dc .TextStyle ,bool ,bool ,bool ){var _gfb ,_fce ,_ggeb bool ;_gfgf :=_aecg ._ggdc .NewTextStyle ();if _afbc !=nil {_gegd :=_bf .FontStyle_Regular ;_gacd :=_dgc (_afbc .BAttr );_fae :=_dgc (_afbc .IAttr );if _gacd &&_fae {_gegd =_bf .FontStyle_BoldItalic ;}else if _gacd {_gegd =_bf .FontStyle_Bold ;}else if _fae {_gegd =_bf .FontStyle_Italic ;};_ggeb =_afbc .UAttr !=_db .ST_TextUnderlineTypeUnset &&_afbc .UAttr !=_db .ST_TextUnderlineTypeNone ;_cdgc :="\u0064e\u0066\u0061\u0075\u006c\u0074";if _aecd :=_afbc .Latin ;_aecd !=nil {_cdgc =_aecd .TypefaceAttr ;}else if _aeg :=_afbc .Ea ;_aeg !=nil {_cdgc =_aeg .TypefaceAttr ;}else if _ecfd :=_afbc .Cs ;_ecfd !=nil {_cdgc =_ecfd .TypefaceAttr ;}else if _eeb :=_afbc .Sym ;_eeb !=nil {_cdgc =_eeb .TypefaceAttr ;};if _afd ,_aedc :=_bf .StdFontsMap [_cdgc ];_aedc {_gfgf .Font =_bf .AssignStdFontByName (_gfgf ,_afd [_gegd ]);}else if _fbd :=_bf .GetRegisteredFont (_cdgc ,_gegd );_fbd !=nil {_gfgf .Font =_fbd ;}else {_bb .Log .Debug ("\u0046\u006f\u006e\u0074\u0020\u0025\u0073\u0020\u0077\u0069\u0074h\u0020\u0073\u0074\u0079\u006c\u0065\u0020\u0025s\u0020i\u0073\u0020\u006e\u006f\u0074\u0020\u0066\u006f\u0075\u006e\u0064\u002c\u0020\u0072\u0065\u0073\u0065\u0074 \u0074\u006f\u0020\u0064\u0065\u0066\u0061\u0075\u006c\u0074\u002e",_cdgc ,_gegd );_gfgf .Font =_bf .AssignStdFontByName (_gfgf ,_bf .StdFontsMap ["\u0064e\u0066\u0061\u0075\u006c\u0074"][_gegd ]);};var _fef float64 ;if _bbfd :=_afbc .SzAttr ;_bbfd !=nil {_fef =float64 (*_bbfd )/100;}else {_fef =_bf .DefaultFontSize ;};if _degc :=_afbc .BaselineAttr ;_degc !=nil {if _cdag :=_degc .ST_PercentageDecimal ;_cdag !=nil {if *_cdag > 0{_gfb =true ;}else if *_cdag < 0{_fce =true ;};};};if _gfb ||_fce {_fef *=0.64;};_gfgf .FontSize =_fef ;_cdc :=0.0;if _bbce :=_afbc .SpcAttr ;_bbce !=nil {if _ggd :=_bbce .ST_TextPointUnqualified ;_ggd !=nil {_cdc =float64 (*_ggd )/100;};};_gfgf .CharSpacing =_cdc ;};return &_gfgf ,_gfb ,_fce ,_ggeb ;};func _gdfb (_adgg *_db .CT_TextCharacterProperties ,_gbdg *_db .CT_TableStyleTextStyle )*_db .CT_TextCharacterProperties {_dagf :=_db .NewCT_TextCharacterProperties ();if _adgg !=nil {*_dagf =*_adgg ;};if _gbdg ==nil {return _dagf ;};if _dagf .BAttr ==nil &&_gbdg .BAttr !=_db .ST_OnOffStyleTypeUnset {_debc :=_gbdg .BAttr ==_db .ST_OnOffStyleTypeOn ;_dagf .BAttr =&_debc ;};if _dagf .IAttr ==nil &&_gbdg .IAttr !=_db .ST_OnOffStyleTypeUnset {_aab :=_gbdg .IAttr ==_db .ST_OnOffStyleTypeOn ;_dagf .IAttr =&_aab ;};if _dagf .NoFill ==nil &&_dagf .SolidFill ==nil {_dagf .SolidFill =_db .NewCT_SolidColorFillProperties ();_dagf .SolidFill .ScrgbClr =_gbdg .ScrgbClr ;_dagf .SolidFill .SrgbClr =_gbdg .SrgbClr ;_dagf .SolidFill .HslClr =_gbdg .HslClr ;_dagf .SolidFill .SysClr =_gbdg .SysClr ;_dagf .SolidFill .SchemeClr =_gbdg .SchemeClr ;_dagf .SolidFill .PrstClr =_gbdg .PrstClr ;};if _aegab :=_gbdg .Font ;_aegab !=nil &&_dagf .Latin ==nil &&_dagf .Ea ==nil &&_dagf .Cs ==nil {_dagf .Latin =_aegab .Latin ;_dagf .Ea =_aegab .Ea ;_dagf .Cs =_aegab .Cs ;};return _dagf ;};func _bdb (_babf string )[]*symbol {_bgdf :=[]*symbol {};for _ ,_bbcea :=range _babf {_bgdf =append (_bgdf ,&symbol {_bbe :string (_bbcea )});};return _bgdf ;};func (_dcfg *convertContext )getBorderStyle (_ggda *_db .CT_LineProperties )(_dc .CellBorderStyle ,*_dc .Color ,float64 ){if _ggda ==nil ||_ggda .NoFill !=nil {return _dc .CellBorderStyleNone ,nil ,0;};var _fbg _dc .Color ;if _eefg :=_ggda .SolidFill ;_eefg !=nil {_fbg ,_ =_dcfg .getColorFromSolidFill (_eefg );};_fga :=0.0;if _fcef :=_ggda .WAttr ;_fcef !=nil {_fga =_bd .FromEMU (int64 (*_fcef ));};return _dc .CellBorderStyleSingle ,&_fbg ,_fga ;};type prefixData struct{_ccge string ;_gdg bool ;_ebbg float64 ;_dgag float64 ;};const (FontStyle_Regular FontStyle =0;FontStyle_Bold FontStyle =1;FontStyle_Italic FontStyle =2;FontStyle_BoldItalic FontStyle =3;);var _ff =_cafb (1.9);type paragraph struct{_bda float64 ;_accc float64 ;_cbgf float64 ;_ecgb float64 ;_deba float64 ;_cceg float64 ;_gcca float64 ;_fff float64 ;_faeg _db .ST_TextAlignType ;_dggg float64 ;_afdc bool ;_ecd []*line ;};

// ConvertToPdf converts a presentation to a PDF file. This package is beta, breaking changes can take place.
func ConvertToPdf (pr *_f .Presentation )*_dc .Creator {_cg :=pr .X ().SldSz ;_gee :=_bd .FromEMU (int64 (_cg .CxAttr ));_ba :=_bd .FromEMU (int64 (_cg .CyAttr ));_dcg :=_dc .PageSize {_gee ,_ba };_ffa :=_dc .New ();_ffa .SetPageSize (_dcg );var _cff *_db .Theme ;if len (pr .Themes ())> 0{_cff =pr .Themes ()[0];};for _ ,_ffe :=range pr .Slides (){if _ffe .X ()==nil {continue ;};_fa :=&convertContext {_ggdc :_ffa ,_gadf :&_ffe ,_afce :_ffe .GetSlideLayout (),_abge :pr .SlideMasters ()[0].X (),_ccb :pr ,_fcfc :_cff ,_bfd :_ffe .X ().ClrMapOvr ,_cfbd :_dcg [1],_daga :_dcg [0]};_fa ._afce =_ffe .GetSlideLayout ();_fa .extractDefaultProperties ();_fa .makeSlide ();_fa .drawSlide ();};return _ffa ;};var _gce =[]romanMatch {romanMatch {1000,"\u006d"},romanMatch {900,"\u0063\u006d"},romanMatch {500,"\u0064"},romanMatch {400,"\u0063\u0064"},romanMatch {100,"\u0063"},romanMatch {90,"\u0078\u0063"},romanMatch {50,"\u006c"},romanMatch {40,"\u0078\u006c"},romanMatch {10,"\u0078"},romanMatch {9,"\u0069\u0078"},romanMatch {5,"\u0076"},romanMatch {4,"\u0069\u0076"},romanMatch {1,"\u0069"}};func (_cbgfb *textboxContext )addTextSymbol (_egffb *symbol ){_aeb :=_dc .New ();_bdbf :=_aeb .NewStyledParagraph ();_bdbf .SetMargins (0,0,0,0);_efgd :=_bdbf .Append (_egffb ._bbe );_ged :=0.0;if _egffb ._ecde !=nil {_efgd .Style =*_egffb ._ecde ;if _egffb ._ecde .CharSpacing !=0{_ged =_egffb ._ecde .CharSpacing ;};};_egffb ._dgfa =_bdbf .Height ();_egffb ._ffad =_bdbf .Height ()*1.2;if _egffb ._ffad < _cbgfb ._cafg ._dggg {_egffb ._ffad =_cbgfb ._cafg ._dggg ;};if _egffb ._gga ==0{_egffb ._gga =_bdbf .Width ()+_ged ;};if len (_cbgfb ._gdf ._effc )> 0{_bfcgf :=_cbgfb ._gdf ._effc [len (_cbgfb ._gdf ._effc )-1]._bbe ;if _cbgfb ._cafg ._afdc ||_bf .IsNoSpaceLanguage (_bfcgf )||(_bfcgf =="\u0020")!=(_egffb ._bbe =="\u0020"){_cbgfb .addCurrentWordToParagraph ();_cbgfb .newWord ();};};_cbgfb ._gdf ._effc =append (_cbgfb ._gdf ._effc ,_egffb );_egffb ._gfd =_cbgfb ._gdf ._cega ;_cbgfb ._gdf ._cega +=_egffb ._gga ;if _egffb ._bbe !="\u0020"{_cbgfb ._gdf ._bfcg =false ;};};func (_gccf *textboxContext )alignVertically (_ecba _db .ST_TextAnchoringType ){_gccf .alignParagraphsVertically (_ecba );_gccf .alignSymbolsVertically ();};func (_cbac *convertContext )makePdfBlockFromTable (_fafe *_db .Tbl ,_edac float64 )*_dc .Table {_ecg :=_fafe .TblGrid ;if _ecg ==nil {return nil ;};_dea :=len (_ecg .GridCol );if _dea ==0{return nil ;};_gdb :=[]float64 {};_bad :=0.0;for _ ,_eege :=range _ecg .GridCol {_agd :=_bd .FromEMU (_bf .FromSTCoordinate (_eege .WAttr ));_gdb =append (_gdb ,_agd );_bad +=_agd ;};_dgd :=[]float64 {};for _fdcc :=0;_fdcc < _dea ;_fdcc ++{_dgd =append (_dgd ,_gdb [_fdcc ]/_bad );};_gace :=_cbac ._ggdc .NewTable (_dea );_gace .SetColumnWidths (_dgd ...);_aee :=_fafe .TblPr ;var _cgdg *_db .CT_TableStyle ;if _dgef :=_aee .Choice ;_dgef !=nil {if _dgef .TableStyle !=nil {_cgdg =_dgef .TableStyle ;}else if _dgef .TableStyleId !=nil {_cgdg =_cbac ._ccb .GetTableStyleById (*_dgef .TableStyleId );};};_bde :=_db .NewCT_TablePartStyle ();_bde .TcStyle =_db .NewCT_TableStyleCellStyle ();_bde .TcTxStyle =_db .NewCT_TableStyleTextStyle ();if _cgdg !=nil {if _cgdg .WholeTbl !=nil {*_bde =*_cgdg .WholeTbl ;};if _cgdg .TblBg !=nil {if _bde .TcStyle .Fill ==nil {_bde .TcStyle .Fill =_cgdg .TblBg .Fill ;};};};if _bde .TcStyle .Fill ==nil {_bde .TcStyle .Fill =_db .NewCT_FillProperties ();_bde .TcStyle .Fill .NoFill =_aee .NoFill ;_bde .TcStyle .Fill .SolidFill =_aee .SolidFill ;};_feae :=len (_fafe .Tr );for _fege ,_ceff :=range _fafe .Tr {_ffed :=_fege ==0;_faac :=_fege ==_feae -1;_gbf :=_fege %2==0;_fad :=len (_ceff .Tc );var _afbb *_db .CT_TablePartStyle ;if _ffed {_afbb =_cgdg .FirstRow ;}else if _gbf {_afbb =_cgdg .Band2H ;}else {_afbb =_cgdg .Band1H ;};var _cbga float64 ;for _eade ,_acea :=range _ceff .Tc {_cddg :=_eade ==0;_aefb :=_eade ==_fad -1;_ecc :=_eade %2==0;var _ccgb *_db .CT_TablePartStyle ;if _cddg {_ccgb =_cgdg .FirstCol ;}else if _ecc {_ccgb =_cgdg .Band2V ;}else {_ccgb =_cgdg .Band1V ;};_ggde :=_gcec (_gcec (_ccgb ,_afbb ),_bde );_fgga :=_cbac .addCellToTable (_gace ,_acea ,_ggde ,_edac *_dgd [_eade ],_ffed ,_faac ,_cddg ,_aefb );if _fgga > _cbga {_cbga =_fgga ;};};_cegd :=_bd .FromEMU (_bf .FromSTCoordinate (_ceff .HAttr ));if _cegd < _cbga {_cegd =_cbga ;};if _cegd < _cafb (4){_cegd =_cafb (4);};_gace .SetRowHeight (_gace .CurRow (),_cegd );};return _gace ;};func (_fdfg *convertContext )getPhData (_ccfc *_bg .CT_Shape )(*_db .CT_Transform2D ,*_db .CT_TextBodyProperties ,*_db .CT_TextListStyle ,bool ,bool ){_efab ,_efgb :=_egbc (_ccfc );_fdgg :=_efgb ==nil ;_ffec ,_gddf ,_ebfg ,_accb :=_bebc (_fdfg ._abge .CSld ,_efab ,_efgb ,_fdgg );_acgb ,_bfeg ,_cgfd ,_cefc :=_bebc (_fdfg ._afce .CSld ,_efab ,_efgb ,_fdgg );if _acgb ==nil {_acgb =_ffec ;};_cdcf ,_ceba :=_aagc (_bfeg ,_gddf );var _cfaa ,_dbg bool ;if _cgfd ==nil {if _ebfg !=nil {_cfaa =*_ebfg ;};}else {_cfaa =*_cgfd ;};if _cefc ==nil {if _accb !=nil {_dbg =*_accb ;};}else {_dbg =*_cefc ;};return _acgb ,_cdcf ,_ceba ,_cfaa ,_dbg ;};func (_bggag *convertContext )getStyleColors (_gcbc *_db .CT_ShapeStyle )(_dc .Color ,_dc .Color ,_dc .Color ){var _bagec ,_gafd ,_ebbe _dc .Color ;if _bdfb :=_gcbc .LnRef ;_bdfb !=nil {_gafd =_bggag .getColorFromMatrixReference (_bdfb );};if _gdcc :=_gcbc .FillRef ;_gdcc !=nil {_ebbe =_bggag .getColorFromMatrixReference (_gdcc );};if _eeee :=_gcbc .FontRef ;_eeee !=nil {_bagec =_bggag .getColorFromFontReference (_eeee );};return _bagec ,_ebbe ,_gafd ;};func _egbc (_aggg *_bg .CT_Shape )(_bg .ST_PlaceholderType ,*uint32 ){if _ggecd :=_aggg .NvSpPr ;_ggecd !=nil {if _ffc :=_ggecd .NvPr ;_ffc !=nil {if _eage :=_ffc .Ph ;_eage !=nil {return _eage .TypeAttr ,_eage .IdxAttr ;};};};return _bg .ST_PlaceholderTypeUnset ,nil ;};func _bebc (_aadd *_bg .CT_CommonSlideData ,_aecf _bg .ST_PlaceholderType ,_fbee *uint32 ,_gaeb bool )(*_db .CT_Transform2D ,*_db .CT_TextBody ,*bool ,*bool ){if _aadd !=nil &&(_aecf !=_bg .ST_PlaceholderTypeUnset ||!_gaeb ){if _cag :=_aadd .SpTree ;_cag !=nil {for _ ,_edge :=range _cag .Choice {if _edge !=nil {for _ ,_dcfd :=range _edge .Sp {if _dcfd !=nil {_fccc ,_bbbg :=_egbc (_dcfd );if _aecf ==_fccc {if (_gaeb &&_bbbg ==nil )||(!_gaeb &&_bbbg !=nil &&*_bbbg ==*_fbee ){var _dfgd *_db .CT_Transform2D ;if _dcfd .SpPr !=nil {_dfgd =_dcfd .SpPr .Xfrm ;};_geaa :=_aecf ==_bg .ST_PlaceholderTypeTitle ||_aecf ==_bg .ST_PlaceholderTypeCtrTitle ;_gadd :=!_geaa &&_aecf !=_bg .ST_PlaceholderTypeUnset ;return _dfgd ,_dcfd .TxBody ,&_geaa ,&_gadd ;};};};};};};};};return nil ,nil ,nil ,nil ;};func (_gecd *convertContext )getShapeFromBlipFill (_feaed *_db .CT_BlipFillProperties ,_accd ,_ebgga ,_fdff ,_baba float64 )_dc .Drawable {_dfef ,_fgfag ,_bagd :=_gecd .makePdfImageFromBlipFill (_feaed );if _bagd !=nil {_bb .Log .Debug ("\u0043\u0061\u006e\u006e\u006f\u0074\u0020\u006d\u0061\u006b\u0065\u0020\u0050D\u0046\u0020\u0069\u006d\u0061\u0067e\u0020\u0066\u0072\u006f\u006d\u0020\u0042\u006c\u0069\u0070\u0046\u0069\u006cl\u003a\u0020\u0025\u0073",_bagd );return nil ;};if _dfef ==nil {return nil ;};if _abdda :=_feaed .Tile ;_abdda !=nil {_dfef =_gecd .tileImage (_dfef ,_feaed .Tile ,_fdff ,_baba );};if _gfgac :=_feaed .Stretch ;_gfgac !=nil {_dfef ,_accd ,_ebgga =_gecd .stretchImage (_dfef ,_feaed .Stretch ,_accd ,_ebgga ,_fdff ,_baba );};if len (_fgfag )==0{_dfef .SetPos (_accd ,_ebgga );return _dfef ;};_dfef =_gecd .applyBlipEffectsOnImg (_dfef ,_accd ,_ebgga ,_fgfag );_dfef .SetPos (_accd ,_ebgga );return _dfef ;};type symbolStyle struct{_dddd *string ;_fabe *float64 ;_fdeb *string ;_dadg *bool ;_aggd *bool ;_caag *bool ;_agf *bool ;_dcef *bool ;};func (_bbed *convertContext )getColorFromSolidFill (_bebb *_db .CT_SolidColorFillProperties )(_dc .Color ,float64 ){if _bebb ==nil {return nil ,1;};var _ceffg string ;_dfcb :=1.0;if _bbbb :=_bebb .SrgbClr ;_bbbb !=nil {_ceffg =_bbbb .ValAttr ;_dfcb =_bf .GetOpacityFromColorTransform (_bbbb .EG_ColorTransform );}else if _addb :=_bebb .SchemeClr ;_addb !=nil {_ceffg =_bf .GetColorStringFromDmlColor (_bbed ._gadf .GetColorBySchemeColor (_addb .ValAttr ));_ceffg =_bf .AdjustColor (_ceffg ,_addb .EG_ColorTransform );_dfcb =_bf .GetOpacityFromColorTransform (_addb .EG_ColorTransform );};if _ceffg !=""{_dgge :=_dc .ColorRGBFromHex ("\u0023"+_ceffg );return _dgge ,_dfcb ;};return nil ,1;};func _eea (_cedbe int ,_caee bool )string {_abgeb :=(_cedbe -1)/26+1;_ggc :=byte ((_cedbe -1)%26);if _caee {_ggc +=byte (65);}else {_ggc +=byte (97);};_eadd :=_ge .NewBuffer ([]byte {});for _dffa :=0;_dffa < _abgeb ;_dffa ++{_eadd .Write ([]byte {_ggc });};return _eadd .String ();};func (_fgc *textboxContext )newParagraph (){_geea :=&paragraph {};_geea ._gcca =_fgc ._bfac ;_fgc ._cafg =_geea ;};func (_agc *convertContext )drawSlide (){_agc ._ggdc .NewPage ();for _ ,_aae :=range _agc ._caa {if _aae !=nil {_agc ._ggdc .MoveTo (0,0);_agc ._ggdc .Draw (_aae );};};};func (_fgbfg *convertContext )getInfoFromLn (_aega *_db .CT_LineProperties )(_dc .Color ,float64 ,float64 ){if _aega ==nil ||_aega .NoFill !=nil {return nil ,0,0;};var _ebc float64 ;_ggaf ,_bcc :=_fgbfg .getColorFromSolidFill (_aega .SolidFill );if _edd :=_aega .WAttr ;_edd !=nil {_ebc =_bd .FromEMU (int64 (*_edd ));}else {_ebc =1;};return _ggaf ,_ebc ,_bcc ;};func _gdfd (_debae int ,_ggg bool )string {_gdbg :=_ge .NewBuffer ([]byte {});for _ ,_agaa :=range _gce {for {if _debae < _agaa ._fbga {break ;};_gdbg .WriteString (_agaa ._cdde );_debae -=_agaa ._fbga ;};};_adca :=_gdbg .String ();if _ggg {_adca =_b .ToUpper (_adca );};return _adca ;};func (_abdd *convertContext )getColorFromFontReference (_fegb *_db .CT_FontReference )_dc .Color {var _bacb _dc .Color ;var _baaf string ;if _fgae :=_fegb .SrgbClr ;_fgae !=nil {_baaf =_fgae .ValAttr ;}else if _cbdd :=_fegb .SchemeClr ;_cbdd !=nil {_baaf =_bf .GetColorStringFromDmlColor (_abdd ._ccb .GetColorBySchemeColor (_cbdd .ValAttr ));_baaf =_bf .AdjustColor (_baaf ,_cbdd .EG_ColorTransform );};if _baaf !=""{_bacb =_dc .ColorRGBFromHex ("\u0023"+_baaf );};return _bacb ;};func (_abecc *convertContext )renderCurrentStateToGoImage ()(_eg .Image ,error ){_feeda :=_bf .MakeTempCreator (_abecc ._daga ,_abecc ._cfbd );_feeda .NewPage ();for _ ,_ege :=range _abecc ._caa {if _ege !=nil {_feeda .MoveTo (0,0);_feeda .Draw (_ege );};};_eadc ,_ceaa :=_bf .GetPageFromCreator (_feeda );if _ceaa !=nil {return nil ,_ceaa ;};return _be .NewImageDevice ().Render (_eadc );};func _eab (_eae *_db .CT_TableCellProperties ,_aggge *_db .CT_TableStyleCellStyle ,_eba ,_ebfd ,_eegb ,_feaedd bool )*_db .CT_TableCellProperties {_eaa :=_db .NewCT_TableCellProperties ();if _eae !=nil {*_eaa =*_eae ;};if _aggge ==nil {return _eaa ;};if _efcc :=_aggge .FillRef ;_efcc !=nil {_cggb :=_db .NewCT_SolidColorFillProperties ();_cggb .ScrgbClr =_efcc .ScrgbClr ;_cggb .SrgbClr =_efcc .SrgbClr ;_cggb .HslClr =_efcc .HslClr ;_cggb .SysClr =_efcc .SysClr ;_cggb .SchemeClr =_efcc .SchemeClr ;_cggb .PrstClr =_efcc .PrstClr ;_eaa .SolidFill =_cggb ;};if _eaa .NoFill ==nil &&_eaa .SolidFill ==nil {if _ecac :=_aggge .Fill ;_ecac !=nil {if _eaa .NoFill ==nil {_eaa .NoFill =_ecac .NoFill ;};if _eaa .SolidFill ==nil {_eaa .SolidFill =_ecac .SolidFill ;};};};if _dgee :=_aggge .TcBdr ;_dgee !=nil {if _eaa .LnL ==nil {var _gced *_db .CT_ThemeableLineStyle ;if _eegb {_gced =_dgee .Left ;}else {_gced =_dgee .InsideV ;};if _gced !=nil {_eaa .LnL =_gced .Ln ;};};if _eaa .LnR ==nil {var _bdbe *_db .CT_ThemeableLineStyle ;if _feaedd {_bdbe =_dgee .Right ;}else {_bdbe =_dgee .InsideV ;};if _bdbe !=nil {_eaa .LnR =_bdbe .Ln ;};};if _eaa .LnT ==nil {var _fgbb *_db .CT_ThemeableLineStyle ;if _eba {_fgbb =_dgee .Top ;}else {_fgbb =_dgee .InsideH ;};if _fgbb !=nil {_eaa .LnT =_fgbb .Ln ;};};if _eaa .LnB ==nil {var _afdd *_db .CT_ThemeableLineStyle ;if _ebfd {_afdd =_dgee .Bottom ;}else {_afdd =_dgee .InsideH ;};if _afdd !=nil {_eaa .LnB =_afdd .Ln ;};};};return _eaa ;};func (_fgf *textboxContext )alignParagraphsVertically (_ceb _db .ST_TextAnchoringType ){if _ceb ==_db .ST_TextAnchoringTypeT {return ;};_gba :=0.0;for _ ,_cdbc :=range _fgf ._egfa {_gba +=_cdbc ._accc +_cdbc ._fff +_cdbc ._cbgf ;};var _aaa float64 ;switch _ceb {case _db .ST_TextAnchoringTypeCtr :_aaa =(_fgf ._bbcb -_gba )/2;case _db .ST_TextAnchoringTypeB :_aaa =_fgf ._bbcb -_gba ;};for _ ,_cfa :=range _fgf ._egfa {_cfa ._gcca +=_aaa ;};};func (_bgce *convertContext )renderPageWithDrawableToGoImage (_abgf _dc .Drawable )(_eg .Image ,error ){_badc :=_bf .MakeTempCreator (_bgce ._daga ,_bgce ._cfbd );_badc .NewPage ();_badc .Draw (_abgf );_cgde ,_bdabd :=_bf .GetPageFromCreator (_badc );if _bdabd !=nil {return nil ,_bdabd ;};return _be .NewImageDevice ().Render (_cgde );};func (_cdg *convertContext )tileImage (_aea *_dc .Image ,_bge *_db .CT_TileInfoProperties ,_cecb ,_gag float64 )*_dc .Image {_dffc ,_fd :=1.0,1.0;if _fg :=_bge .SxAttr ;_fg !=nil {_dffc =_bf .FromSTPercentage (_fg );};if _edb :=_bge .SyAttr ;_edb !=nil {_fd =_bf .FromSTPercentage (_edb );};_beg :=_bf .MakeTempCreator (_cecb ,_gag );_aea .Scale (_dffc ,_fd );_eace ,_ec :=_aea .Width (),_aea .Height ();var _eb ,_dfb float64 ;if _fab :=_bge .TxAttr ;_fab !=nil {_eb =_bd .FromEMU (_bf .FromSTCoordinate (*_fab ));};if _bgd :=_bge .TyAttr ;_bgd !=nil {_dfb =_bd .FromEMU (_bf .FromSTCoordinate (*_bgd ));};if _eb > 0{_eb -=_eace ;};if _dfb > 0{_dfb -=_ec ;};_aaee :=_cdg ._daga /_eace +1;_fcb :=_cdg ._cfbd /_ec +1;for _egb :=0.0;_egb <=_aaee ;_egb ++{_eca :=_egb *_eace ;for _bfb :=0.0;_bfb <=_fcb ;_bfb ++{_dgb :=_bfb *_ec ;_aea .SetPos (_eca +_eb ,_dgb +_dfb );_beg .Draw (_aea );};};_bfa ,_faa :=_bf .GetPageFromCreator (_beg );if _faa !=nil {_bb .Log .Debug ("\u0043\u0061\u006e\u006e\u006f\u0074 \u0067\u0065\u0074\u0020\u0069\u006d\u0061\u0067\u0065\u0020\u0066\u0072\u006fm\u0020\u0063\u0072\u0065\u0061\u0074\u006fr\u003a\u0020\u0025\u0073",_faa );return nil ;};_fgg ,_faa :=_be .NewImageDevice ().Render (_bfa );if _faa !=nil {_bb .Log .Debug ("\u0043\u0061\u006eno\u0074\u0020\u0072\u0065\u006e\u0064\u0065\u0072\u0020\u0069\u006d\u0061\u0067\u0065\u003a\u0020\u0025\u0073",_faa );return nil ;};_deg ,_faa :=_cdg ._ggdc .NewImageFromGoImage (_fgg );if _faa !=nil {_bb .Log .Debug ("\u0043\u0061nn\u006f\u0074\u0020c\u0072\u0065\u0061\u0074e i\u006dag\u0065\u0020\u0066\u0072\u006f\u006d\u0020Go\u0049\u006d\u0061\u0067\u0065\u003a\u0020%\u0073",_faa );return nil ;};return _deg ;};func (_aa *convertContext )makePdfBlockFromChart (_gd *_bc .Chart ,_bec ,_da float64 )(*_dc .Block ,error ){_dcb :=_gd .CT_RelId .IdAttr ;_cc :=_aa ._gadf .GetChartSpaceByRelId (_dcb );if _cc ==nil {return nil ,_c .New ("\u004e\u006f\u0020\u0063\u0068\u0061\u0072\u0074\u0073\u0070\u0061\u0063\u0065");};var _cb *_db .Theme ;_gf :=_aa ._ccb .Themes ();if len (_gf )> 0{_cb =_gf [0];};return _bf .MakeBlockFromChartSpace (_cc ,_bec ,_da ,_cb );};type word struct{_effc []*symbol ;_edgg float64 ;_cega float64 ;_bfcg bool ;};

// RegisterFontsFromDirectory registers all fonts from the given directory automatically detecting font families and styles.
func RegisterFontsFromDirectory (dirName string )error {return _bf .RegisterFontsFromDirectory (dirName )};func (_ega *textboxContext )addCurrentParagraph (){_ega ._bfac =_ega ._cafg ._gcca +_ega ._cafg ._accc +_ega ._cafg ._fff +_ega ._cafg ._cbgf ;_ega ._egfa =append (_ega ._egfa ,_ega ._cafg );_ega .alignParagraph ();};func (_eadf *textboxContext )addPrefix (_cgcb *prefixData ,_ccd *_dc .TextStyle ){_ffff :=_bdb (_cgcb ._ccge );_gdfad :=*_ccd ;if _cgcb ._gdg {_gdfad .Font =_bf .AssignStdFontByName (_gdfad ,"\u0053\u0079\u006d\u0062\u006f\u006c");};for _ ,_cgb :=range _ffff {_cgb ._ecde =&_gdfad ;_eadf .addTextSymbol (_cgb );};_cdca :=-(_cgcb ._dgag +_eadf ._gdf ._cega );if _cdca < 0{_cdca =0;};_bagc :=&symbol {_bbe :"\u0020",_gga :_cdca };_eadf .addTextSymbol (_bagc );_eadf ._gdf ._edgg +=(_cgcb ._dgag +_cgcb ._ebbg );};func _cafb (_ffgf float64 )float64 {return _ffgf *_bd .Millimeter };func (_eacg *convertContext )addCellToTable (_cadg *_dc .Table ,_feee *_db .CT_TableCell ,_gda *_db .CT_TablePartStyle ,_dbdg float64 ,_cbe ,_bcg ,_ecaa ,_aefc bool )float64 {var _cde *_dc .TableCell ;_edga :=1;if _feee .GridSpanAttr !=nil {_edga =int (*_feee .GridSpanAttr );};_cde =_cadg .MultiColCell (_edga );_ebb :=_feee .TcPr ;var _addc *_db .CT_TableStyleTextStyle ;if _gda !=nil {_ebb =_eab (_ebb ,_gda .TcStyle ,_cbe ,_bcg ,_ecaa ,_aefc );_addc =_gda .TcTxStyle ;};_gea :=_ff ;_egc :=_dc .CellVerticalAlignmentMiddle ;if _ebb !=nil {if _gdaf :=_ebb .LnL ;_gdaf !=nil {_cfbf ,_aedcg ,_ggec :=_eacg .getBorderStyle (_gdaf );_cde .SetBorder (_dc .CellBorderSideLeft ,_cfbf ,_ggec );if _aedcg !=nil &&*_aedcg !=nil {_cde .SetSideBorderColor (_dc .CellBorderSideLeft ,*_aedcg );};};if _cecf :=_ebb .LnT ;_cecf !=nil {_daa ,_ddc ,_cgda :=_eacg .getBorderStyle (_cecf );_cde .SetBorder (_dc .CellBorderSideTop ,_daa ,_cgda );if _ddc !=nil &&*_ddc !=nil {_cde .SetSideBorderColor (_dc .CellBorderSideTop ,*_ddc );};};if _acec :=_ebb .LnR ;_acec !=nil {_ecgc ,_gafe ,_dgff :=_eacg .getBorderStyle (_acec );_cde .SetBorder (_dc .CellBorderSideRight ,_ecgc ,_dgff );if _gafe !=nil &&*_gafe !=nil {_cde .SetSideBorderColor (_dc .CellBorderSideRight ,*_gafe );};};if _afac :=_ebb .LnB ;_afac !=nil {_fefd ,_eeeb ,_egbef :=_eacg .getBorderStyle (_afac );_cde .SetBorder (_dc .CellBorderSideBottom ,_fefd ,_egbef );if _eeeb !=nil &&*_eeeb !=nil {_cde .SetSideBorderColor (_dc .CellBorderSideBottom ,*_eeeb );};};if _efff :=_ebb .MarLAttr ;_efff !=nil {_gea =float64 (_bf .FromSTCoordinate32 (*_efff ));};switch _ebb .AnchorAttr {case _db .ST_TextAnchoringTypeT :_egc =_dc .CellVerticalAlignmentTop ;case _db .ST_TextAnchoringTypeB :_egc =_dc .CellVerticalAlignmentBottom ;};if _ebb .NoFill ==nil {if _cdce :=_ebb .SolidFill ;_cdce !=nil {_gdba ,_ :=_eacg .getColorFromSolidFill (_cdce );_cde .SetBackgroundColor (_gdba );};};};_cde .SetVerticalAlignment (_egc );_cde .SetIndent (_gea );var _abf float64 ;if _bcb :=_feee .TxBody ;_bcb !=nil {_eeec :=_eacg .makePdfDivisionFromTxBody (_bcb ,_dbdg ,_abf ,_addc );_abf =_eeec .Height ();_cde .SetContent (_eeec );};return _abf ;};func (_bbd *convertContext )makeSlide (){_cdf :=_bbd ._gadf .X ().CSld ;if _cdf ==nil {return ;};_gb :=&background {};if _gef :=_cdf .Bg ;_gef !=nil {if _dg :=_gef .BgPr ;_dg !=nil {if _dg .NoFill ==nil {if _af :=_dg .SolidFill ;_af !=nil {_gc ,_cea :=_bbd .getColorFromSolidFill (_af );if _gc !=nil {_gb ._eacd =_gc ;_gb ._cbfe =_cea ;};}else if _ccg :=_dg .BlipFill ;_ccg !=nil {_gb ._gbbd =_ccg ;};};};};_bbd ._fcbc =_gb ;if _cec :=_cdf .SpTree ;_cec !=nil {for _ ,_beff :=range _cec .Choice {if _beff !=nil {for _ ,_afb :=range _beff .Sp {if _afb !=nil {_ace :=_bbd .getShapes (_afb );_bbd ._caa =append (_bbd ._caa ,_ace ...);};};for _ ,_abe :=range _beff .GraphicFrame {if _abe !=nil {var _gdd ,_abb ,_acg ,_eac float64 ;if _ee :=_abe .Xfrm ;_ee !=nil {_gdd ,_abb ,_acg ,_eac =_bf .GetDataFromXfrm (_ee );};if _bed :=_abe .Graphic ;_bed !=nil {if _bcfa :=_bed .GraphicData ;_bcfa !=nil {for _ ,_abg :=range _bcfa .Any {if _bdd ,_baa :=_abg .(*_bc .Chart );_baa {_gde ,_aaf :=_bbd .makePdfBlockFromChart (_bdd ,_acg ,_eac );if _aaf !=nil {_bb .Log .Debug ("C\u0061\u006e\u006e\u006ft \u0072e\u0061\u0064\u0020\u0062\u006co\u0063\u006b\u003a\u0020\u0025\u0073",_aaf );};if _gde !=nil {_gde .SetPos (_gdd ,_abb );_bbd ._caa =append (_bbd ._caa ,_gde );};}else if _cba ,_cgd :=_abg .(*_db .Tbl );_cgd {_fea :=_bbd .makePdfBlockFromTable (_cba ,_acg );if _fea !=nil {_bdf :=_dc .NewBlock (_acg ,_eac );_bdf .SetPos (_gdd ,_abb );_bdf .Draw (_fea );_bbd ._caa =append (_bbd ._caa ,_bdf );};};};};};};};for _ ,_gfa :=range _beff .CxnSp {if _gfa !=nil {_cfb :=_bbd .getConnectors (_gfa );_bbd ._caa =append (_bbd ._caa ,_cfb ...);};};for _ ,_gcd :=range _beff .Pic {if _gcd !=nil {var _cee ,_fc ,_gddb ,_cad float64 ;if _dff :=_gcd .SpPr ;_dff !=nil {if _cbc :=_dff .Xfrm ;_cbc !=nil {_cee ,_fc ,_gddb ,_cad =_bf .GetDataFromXfrm (_cbc );};};if _de :=_gcd .BlipFill ;_de !=nil {_efc :=_bbd .getShapeFromBlipFill (_de ,_cee ,_fc ,_gddb ,_cad );_bbd ._caa =append (_bbd ._caa ,_efc );};};};};};};};func (_dcbd *convertContext )getShapes (_efa *_bg .CT_Shape )[]_dc .Drawable {_adb :=[]_dc .Drawable {};_gec :=_efa .SpPr ;if _gec ==nil {return _adb ;};var _eef bool ;if _ggb :=_efa .UseBgFillAttr ;_ggb !=nil {_eef =*_ggb ;};_feg ,_eag ,_deb ,_bce ,_cbg ,_babc ,_ccgf :=_dcbd .getShapesFromSpPr (_gec ,_efa .Style ,_eef );_adb =append (_adb ,_feg ...);if _bbcc :=_efa .TxBody ;_bbcc !=nil {_edg ,_bebe ,_fee ,_bgec ,_dffb :=_dcbd .getPhData (_efa );if _edg !=nil &&!_ccgf {_eag ,_deb ,_bce ,_cbg =_bf .GetDataFromXfrm (_edg );};_fb ,_cae :=_dcbd .makePdfBlockFromTxBody (_bbcc ,_bebe ,_fee ,_bce ,_cbg ,_babc ,_bgec ,_dffb );if _cae !=nil {_bb .Log .Debug ("\u0043\u0061\u006e\u006e\u006f\u0074\u0020\u006d\u0061\u006b\u0065\u0020\u0050\u0044\u0046\u0020\u0062\u006c\u006f\u0063\u006b\u0020\u0066\u0072o\u006d\u0020\u0074\u0065\u0078t\u0062\u006fx\u003a\u0020\u0025\u0073",_cae );}else if _fb !=nil {_fb .SetPos (_eag ,_deb );_adb =append (_adb ,_fb );};};return _adb ;};func _gdef (_fdea ,_ggff *_db .CT_TextBodyProperties )*_db .CT_TextBodyProperties {_cfeg :=_db .NewCT_TextBodyProperties ();if _fdea !=nil {*_cfeg =*_fdea ;};if _ggff ==nil {return _cfeg ;};if _cfeg .RotAttr ==nil {_cfeg .RotAttr =_ggff .RotAttr ;};if _cfeg .SpcFirstLastParaAttr ==nil {_cfeg .SpcFirstLastParaAttr =_ggff .SpcFirstLastParaAttr ;};if _cfeg .VertOverflowAttr ==_db .ST_TextVertOverflowTypeUnset {_cfeg .VertOverflowAttr =_ggff .VertOverflowAttr ;};if _cfeg .HorzOverflowAttr ==_db .ST_TextHorzOverflowTypeUnset {_cfeg .HorzOverflowAttr =_ggff .HorzOverflowAttr ;};if _cfeg .VertAttr ==_db .ST_TextVerticalTypeUnset {_cfeg .VertAttr =_ggff .VertAttr ;};if _cfeg .WrapAttr ==_db .ST_TextWrappingTypeUnset {_cfeg .WrapAttr =_ggff .WrapAttr ;};if _cfeg .LInsAttr ==nil {_cfeg .LInsAttr =_ggff .LInsAttr ;};if _cfeg .TInsAttr ==nil {_cfeg .TInsAttr =_ggff .TInsAttr ;};if _cfeg .RInsAttr ==nil {_cfeg .RInsAttr =_ggff .RInsAttr ;};if _cfeg .BInsAttr ==nil {_cfeg .BInsAttr =_ggff .BInsAttr ;};if _cfeg .NumColAttr ==nil {_cfeg .NumColAttr =_ggff .NumColAttr ;};if _cfeg .SpcColAttr ==nil {_cfeg .SpcColAttr =_ggff .SpcColAttr ;};if _cfeg .RtlColAttr ==nil {_cfeg .RtlColAttr =_ggff .RtlColAttr ;};if _cfeg .AnchorAttr ==_db .ST_TextAnchoringTypeUnset {_cfeg .AnchorAttr =_ggff .AnchorAttr ;};if _cfeg .AnchorCtrAttr ==nil {_cfeg .AnchorCtrAttr =_ggff .AnchorCtrAttr ;};if _cfeg .ForceAAAttr ==nil {_cfeg .ForceAAAttr =_ggff .ForceAAAttr ;};if _cfeg .UprightAttr ==nil {_cfeg .UprightAttr =_ggff .UprightAttr ;};if _cfeg .CompatLnSpcAttr ==nil {_cfeg .CompatLnSpcAttr =_ggff .CompatLnSpcAttr ;};if _cfeg .PrstTxWarp ==nil {_cfeg .PrstTxWarp =_ggff .PrstTxWarp ;};if _cfeg .NoAutofit ==nil {_cfeg .NoAutofit =_ggff .NoAutofit ;};if _cfeg .NormAutofit ==nil {_cfeg .NormAutofit =_ggff .NormAutofit ;};if _cfeg .SpAutoFit ==nil {_cfeg .SpAutoFit =_ggff .SpAutoFit ;};if _cfeg .Scene3d ==nil {_cfeg .Scene3d =_ggff .Scene3d ;};if _cfeg .Sp3d ==nil {_cfeg .Sp3d =_ggff .Sp3d ;};if _cfeg .FlatTx ==nil {_cfeg .FlatTx =_ggff .FlatTx ;};if _cfeg .ExtLst ==nil {_cfeg .ExtLst =_ggff .ExtLst ;};return _cfeg ;};func (_dcad *textboxContext )adjustHeights (_daf float64 ){if _dcad ._bage ._febd < _daf {_dcad ._cafg ._fff +=(_daf -_dcad ._bage ._febd );_dcad ._bage ._febd =_daf ;};};type romanMatch struct{_fbga int ;_cdde string ;};type background struct{_eacd _dc .Color ;_cbfe float64 ;_gbbd *_db .CT_BlipFillProperties ;};func (_fcfe *convertContext )applyBlipEffectsOnImg (_dac *_dc .Image ,_dacb ,_gafb float64 ,_bae []*_db .CT_BlipChoice )*_dc .Image {if len (_bae )==0{return _dac ;};_dac .SetPos (_dacb ,_gafb );_adbb ,_edgf :=_fcfe .renderPageWithDrawableToGoImage (_dac );if _edgf !=nil {_bb .Log .Debug ("\u0045\u0072\u0072\u006f\u0072\u0020\u0072\u0065\u006e\u0064\u0065\u0072\u0020a\u006e\u0020\u0069\u006d\u0061\u0067e\u0020\u0074\u006f\u0020\u0061\u0020\u0047\u006f\u0020\u0069\u006d\u0061\u0067e\u003a\u0020\u0025\u0073",_edgf );return _dac ;};_effd ,_edgf :=_fcfe .renderCurrentStateToGoImage ();if _edgf !=nil {_bb .Log .Debug ("\u0045\u0072\u0072\u006f\u0072\u0020\u0072\u0065n\u0064\u0065\u0072 t\u0068\u0065\u0020\u0063\u0075\u0072r\u0065\u006e\u0074\u0020\u0073\u0074\u0061\u0074\u0065\u0020\u0074\u006f\u0020\u0061\u0020G\u006f\u0020\u0069\u006d\u0061\u0067\u0065\u003a \u0025\u0073",_edgf );return _dac ;};_fbb :=_adbb .Bounds ();_aacab :=_eg .NewRGBA (_fbb );_fafa ,_cbee :=_dac .Width (),_dac .Height ();for _ ,_agde :=range _bae {for _ ,_efad :=range _agde .AlphaModFix {if _gacf :=_efad .AmtAttr ;_gacf !=nil {if _gab :=_gacf .ST_PositivePercentageDecimal ;_gab !=nil {_bggd :=uint8 (255*(*_gab )/100000);_fafeg :=_eg .NewUniform (_g .Alpha {_bggd });_d .Draw (_aacab ,_fbb ,_effd ,_eg .Point {0,0},_d .Src );_d .DrawMask (_aacab ,_fbb ,_adbb ,_eg .Point {0,0},_fafeg ,_eg .Point {0,0},_d .Over );};};};};_gadc :=_eg .Rect (int (_dacb ),int (_gafb ),int (_dacb +_fafa )+1,int (_gafb +_cbee )+1);_ecbac :=_bf .CropImageByRect (_aacab ,_gadc );_deaa ,_edgf :=_fcfe ._ggdc .NewImageFromGoImage (_ecbac );if _edgf !=nil {_bb .Log .Debug ("\u0045\u0072\u0072\u006f\u0072\u0020\u0061\u006e\u0020\u0069\u006d\u0061\u0067\u0065\u0020t\u006f \u0061\u0020\u0047\u006f\u0020\u0069\u006d\u0061\u0067\u0065\u003a\u0020\u0025\u0073",_edgf );return _dac ;};return _deaa ;};func (_dge *convertContext )stretchImage (_acag *_dc .Image ,_ced *_db .CT_StretchInfoProperties ,_aac ,_feb ,_gg ,_gfe float64 )(*_dc .Image ,float64 ,float64 ){_geg :=_ced .FillRect ;if _geg ==nil {_bab :=_acag .Width ()/_acag .Height ();_dag :=_gg /_gfe ;var _aace ,_bfaa float64 ;if _bab > _dag {_bfaa =_gfe ;_aace =_gfe *_bab ;}else {_aace =_gg ;_bfaa =_gg /_bab ;};_acag .Scale (_aace /_acag .Width (),_bfaa /_acag .Height ());return _acag ,_aac ,_feb ;};var _bdg ,_ffaf ,_becg ,_efb float64 ;if _bag :=_geg .LAttr ;_bag !=nil {_becg =_bf .FromSTPercentage (_bag );};if _ad :=_geg .TAttr ;_ad !=nil {_bdg =_bf .FromSTPercentage (_ad );};if _fde :=_geg .RAttr ;_fde !=nil {_efb =_bf .FromSTPercentage (_fde );};if _aed :=_geg .BAttr ;_aed !=nil {_ffaf =_bf .FromSTPercentage (_aed );};_ebf :=_gg *(1-_becg -_efb );_bgg :=_gfe *(1-_bdg -_ffaf );_acag .Scale (_ebf /_acag .Width (),_bgg /_acag .Height ());return _acag ,_aac +_becg *_gg ,_feb +_bdg *_gfe ;};func (_cdage *convertContext )makePdfImageFromBlipFill (_fgbf *_db .CT_BlipFillProperties )(*_dc .Image ,[]*_db .CT_BlipChoice ,error ){if _fgfa :=_fgbf .Blip ;_fgfa !=nil {if _bdee :=_fgfa .EmbedAttr ;_bdee !=nil {_acce ,_abeg :=_cdage ._gadf .GetImageByRelID (*_bdee );if _abeg {_aad ,_dbc :=_a .Open (_acce .Path ());if _dbc !=nil {_bb .Log .Debug ("\u0046\u0069\u006c\u0065 o\u0070\u0065\u006e\u0020\u0065\u0072\u0072\u006f\u0072\u003a\u0020\u0025\u0073",_dbc );return nil ,nil ,_dbc ;};defer _aad .Close ();_fafc ,_ ,_dbc :=_eg .Decode (_aad );if _dbc !=nil {_bb .Log .Debug ("\u0044\u0065\u0063\u006fde\u0020\u0069\u006d\u0061\u0067\u0065\u0020\u0065\u0072\u0072\u006f\u0072\u003a\u0020%\u0073",_dbc );return nil ,nil ,_dbc ;};if _ceag :=_fgbf .SrcRect ;_ceag !=nil {_abcc :=_fafc .Bounds ().Size ();_cdagf :=_abcc .X ;_abbe :=_abcc .Y ;var _fgaf ,_ccae ,_aff ,_ffgd int ;var _eec bool ;if _agab :=_ceag .LAttr ;_agab !=nil {_fgaf =int (float64 (_cdagf )*_bf .FromSTPercentage (_agab ));_eec =true ;}else {_fgaf =0;};if _ffedc :=_ceag .TAttr ;_ffedc !=nil {_aff =int (float64 (_abbe )*_bf .FromSTPercentage (_ffedc ));_eec =true ;}else {_aff =0;};if _febb :=_ceag .RAttr ;_febb !=nil {_ccae =int (float64 (_cdagf )*(1-_bf .FromSTPercentage (_febb )));_eec =true ;}else {_ccae =_cdagf ;};if _gbg :=_ceag .BAttr ;_gbg !=nil {_ffgd =int (float64 (_abbe )*(1-_bf .FromSTPercentage (_gbg )));_eec =true ;}else {_ffgd =_abbe ;};if _eec {_fafc =_bf .CropImageByRect (_fafc ,_eg .Rect (_fgaf ,_aff ,_ccae +1,_ffgd +1));};};_eada ,_dbc :=_cdage ._ggdc .NewImageFromGoImage (_fafc );if _dbc !=nil {_bb .Log .Debug ("\u0043\u0061\u006e\u006e\u006ft\u0020\u0063\u0072\u0065\u0061\u0074\u0065\u0020\u0050\u0044\u0046\u0020\u0069m\u0061\u0067\u0065\u0020\u0066\u0072\u006f\u006d\u0020\u0047\u006f\u0020\u0069\u006d\u0061\u0067\u0065\u003a\u0020\u0025\u0073",_dbc );return nil ,nil ,_dbc ;};return _eada ,_fgfa .Choice ,nil ;};};};return nil ,nil ,nil ;};func (_bdga *textboxContext )addTextRun (_dbdf *_db .EG_TextRun ,_gadfg *_db .CT_TextCharacterProperties ,_edgc _dc .Color ,_bbgd *prefixData ){if _effa :=_dbdf .Br ;_effa !=nil {_bdga .addCurrentWordToParagraph ();_bdga .newLine ();_bdga .newWord ();}else if _fbde :=_dbdf .R ;_fbde !=nil {var _ffaa _dc .Color ;if _fbde .RPr .SolidFill !=nil {_ffaa ,_ =_bdga ._cbgab .getColorFromSolidFill (_fbde .RPr .SolidFill );}else if _edgc !=nil {_ffaa =_edgc ;}else if _gadfg .SolidFill !=nil {_ffaa ,_ =_bdga ._cbgab .getColorFromSolidFill (_gadfg .SolidFill );}else {_ffaa =_dc .ColorBlack ;};_ggeba :=_bcbf (_fbde .RPr ,_gadfg );_fdce ,_egd ,_cfed ,_fggf :=_bdga ._cbgab .makeStyleFromRPr (_ggeba );_fdce .Color =_ffaa ;if _bbgd !=nil {_bdga .addPrefix (_bbgd ,_fdce );};_dcff :=_bdb (_fbde .T );for _ ,_fed :=range _dcff {_fed ._ecde =_fdce ;_fed ._ggf =_egd ;_fed ._eede =_cfed ;_fed ._abd =_fggf ;if _ggeba .CapAttr ==_db .ST_TextCapsTypeAll {_fed ._bbe =_b .ToUpper (_fed ._bbe );};_bdga .addTextSymbol (_fed );};};};func _ebcc (_eeeeb ,_baafe *_db .CT_TableStyleCellStyle )*_db .CT_TableStyleCellStyle {_bdgg :=_db .NewCT_TableStyleCellStyle ();if _eeeeb !=nil {*_bdgg =*_eeeeb ;};if _baafe ==nil {return _bdgg ;};if _bdgg .TcBdr ==nil {_bdgg .TcBdr =_baafe .TcBdr ;};if _bdgg .Fill ==nil {_bdgg .Fill =_baafe .Fill ;};if _bdgg .FillRef ==nil {_bdgg .FillRef =_baafe .FillRef ;};return _bdgg ;};func (_cbed *textboxContext )assignPropsToCurrentParagraph (_fdd *_db .CT_TextParagraphProperties ){_ddfe :=12.4;if _fdd ==nil {_cbed ._cafg ._dggg =_ddfe ;return ;};if _aeaa :=_fdd .DefRPr ;_aeaa !=nil {_bgf :=_aeaa .SzAttr ;if _bgf !=nil {_fda :=float64 (*_bgf )/1200;if _ddfe <=_fda {_ddfe =_fda ;};};};if _cga :=_fdd .MarLAttr ;_cga !=nil {_cbed ._cafg ._deba =_bd .FromEMU (int64 (*_cga ));};_cbed ._cafg ._cceg =_cbed ._efda ;if _aeaf :=_fdd .MarRAttr ;_aeaf !=nil {_cbed ._cafg ._cceg -=_bd .FromEMU (int64 (*_aeaf ));};if _gggc :=_fdd .IndentAttr ;_gggc !=nil {_cbed ._cafg ._ecgb =_bd .FromEMU (int64 (*_gggc ));};if _fcg :=_fdd .LatinLnBrkAttr ;_fcg !=nil {_cbed ._cafg ._afdc =*_fcg ;};if _ede :=_fdd .LnSpc ;_ede !=nil {if _bfaaa :=_ede .SpcPct ;_bfaaa !=nil {if _ggfe :=_bfaaa .ValAttr .ST_TextSpacingPercent ;_ggfe !=nil {_ddfe =float64 (*_ggfe )/5000;};};};var _dca float64 ;if _dec :=_fdd .SpcBef ;_dec !=nil {if _fbfa :=_dec .SpcPts ;_fbfa !=nil {_dca =float64 (_fbfa .ValAttr )/100;};};_gdfa :=_cbed ._egfa ;if len (_gdfa )> 0{_dca -=_gdfa [len (_gdfa )-1]._cbgf ;if _dca < 0{_dca =0;};};_cbed ._cafg ._accc =_dca ;if _ccbc :=_fdd .SpcAft ;_ccbc !=nil {if _ffba :=_ccbc .SpcPts ;_ffba !=nil {_cbed ._cafg ._cbgf =float64 (_ffba .ValAttr )/100;};};_cbed ._cafg ._dggg =_ddfe ;_cbed ._cafg ._faeg =_fdd .AlgnAttr ;};

// RegisterFont makes a PdfFont accessible for using in converting to PDF.
func RegisterFont (name string ,style FontStyle ,font *_bbb .PdfFont ){_bf .RegisterFont (name ,style ,font );};type textboxContext struct{_cbgab *convertContext ;_efda float64 ;_bbcb float64 ;_ebgg *_dc .Creator ;_bfac float64 ;_egfa []*paragraph ;_cafg *paragraph ;_bage *line ;_gdf *word ;_abfg bool ;};func _dgc (_gefc *bool )bool {return _gefc !=nil &&*_gefc };func (_edc *convertContext )getColorFromMatrixReference (_gfga *_db .CT_StyleMatrixReference )_dc .Color {if _gfga ==nil {return nil ;};var _cegc _dc .Color ;var _bfdb string ;if _aegg :=_gfga .SrgbClr ;_aegg !=nil {_bfdb =_aegg .ValAttr ;}else if _ccec :=_gfga .SchemeClr ;_ccec !=nil {_bfdb =_bf .GetColorStringFromDmlColor (_edc ._ccb .GetColorBySchemeColor (_ccec .ValAttr ));_bfdb =_bf .AdjustColor (_bfdb ,_ccec .EG_ColorTransform );};if _bfdb !=""{_cegc =_dc .ColorRGBFromHex ("\u0023"+_bfdb );};return _cegc ;};func (_dgf *convertContext )makePdfBlockFromTxBody (_cedb *_db .CT_TextBody ,_bfc *_db .CT_TextBodyProperties ,_fbcd *_db .CT_TextListStyle ,_bdgb ,_fgb float64 ,_ada _dc .Color ,_cab ,_ceg bool )(*_dc .Block ,error ){var _eaf *_db .CT_TextParagraphProperties ;if _gae :=_cedb .LstStyle ;_gae !=nil {var _bee *_db .CT_TextParagraphProperties ;if _gae .Lvl1pPr !=nil {_bee =_gae .Lvl1pPr ;};_eaf =_baac (_bee ,_gae .DefPPr );};var _gegg *_db .CT_TextParagraphProperties ;if _eaf !=nil {if _cab {_gegg =_dgf ._gcad [0];}else if _ceg {_gegg =_dgf ._ddg [0];}else {_gegg =_dgf ._ded [0];};if _fbcd !=nil {_gegg =_baac (_baac (_fbcd .Lvl1pPr ,_fbcd .DefPPr ),_gegg );};_gegg =_baac (_eaf ,_gegg );}else {if _cab {_gegg =_dgf ._bcbc ;}else if _ceg {_gegg =_dgf ._agcc ;}else {_gegg =_dgf ._bedb ;};};_cgg ,_bfe :=_cafb (2.5),_cafb (2.5);_gcae ,_ffafg :=_cafb (1.3),_cafb (1.3);_aga :=true ;_cgc :=_db .ST_TextAnchoringTypeT ;if _bfc !=nil {if _faf :=_bfc .AnchorAttr ;_faf !=_db .ST_TextAnchoringTypeUnset {_cgc =_faf ;};};if _afcb :=_cedb .BodyPr ;_afcb !=nil {if _cca :=_afcb .LInsAttr ;_cca !=nil {_cgg =_bd .FromEMU (_bf .FromSTCoordinate32 (*_cca ));};if _cfd :=_afcb .TInsAttr ;_cfd !=nil {_gcae =_bd .FromEMU (_bf .FromSTCoordinate32 (*_cfd ));};if _gcb :=_afcb .RInsAttr ;_gcb !=nil {_bfe =_bd .FromEMU (_bf .FromSTCoordinate32 (*_gcb ));};if _dfe :=_afcb .BInsAttr ;_dfe !=nil {_ffafg =_bd .FromEMU (_bf .FromSTCoordinate32 (*_dfe ));};_aga =_afcb .WrapAttr !=_db .ST_TextWrappingTypeNone ;if _bga :=_afcb .AnchorAttr ;_bga !=_db .ST_TextAnchoringTypeUnset {_cgc =_afcb .AnchorAttr ;};};_cac :=_bf .MakeTempCreator (_bdgb ,_fgb );_cac .SetPageMargins (_cgg ,_bfe ,_gcae ,_ffafg );_gaf :=&textboxContext {_cbgab :_dgf ,_abfg :_aga ,_efda :_bdgb -_cgg -_bfe ,_bbcb :_fgb -_gcae -_ffafg ,_ebgg :_cac ,_egfa :[]*paragraph {}};_dbf :=1;for _ ,_degd :=range _cedb .P {if _degd !=nil {_gad :=_degd .PPr ;var _fafd *prefixData ;if _gad !=nil &&_gad .BuNone ==nil {var _bgc string ;var _dcbe bool ;if _cabe :=_gad .BuAutoNum ;_cabe !=nil {var _cce string ;if _aaca :=_cabe .StartAtAttr ;_aaca !=nil {_dbf =int (*_aaca );};var _gdc string ;switch _cabe .TypeAttr {case _db .ST_TextAutonumberSchemeAlphaUcParenBoth ,_db .ST_TextAutonumberSchemeAlphaUcParenR ,_db .ST_TextAutonumberSchemeAlphaUcPeriod :_gdc =_eea (_dbf ,true );case _db .ST_TextAutonumberSchemeAlphaLcParenBoth ,_db .ST_TextAutonumberSchemeAlphaLcParenR ,_db .ST_TextAutonumberSchemeAlphaLcPeriod :_gdc =_eea (_dbf ,false );case _db .ST_TextAutonumberSchemeRomanUcParenBoth ,_db .ST_TextAutonumberSchemeRomanUcParenR ,_db .ST_TextAutonumberSchemeRomanUcPeriod :_gdc =_gdfd (_dbf ,true );case _db .ST_TextAutonumberSchemeRomanLcParenBoth ,_db .ST_TextAutonumberSchemeRomanLcParenR ,_db .ST_TextAutonumberSchemeRomanLcPeriod :_gdc =_gdfd (_dbf ,false );default:_gdc =_cf .Itoa (_dbf );};switch _cabe .TypeAttr {case _db .ST_TextAutonumberSchemeAlphaLcPeriod ,_db .ST_TextAutonumberSchemeAlphaUcPeriod ,_db .ST_TextAutonumberSchemeArabicPeriod ,_db .ST_TextAutonumberSchemeRomanLcPeriod ,_db .ST_TextAutonumberSchemeRomanUcPeriod ,_db .ST_TextAutonumberSchemeArabicDbPeriod ,_db .ST_TextAutonumberSchemeEa1ChsPeriod ,_db .ST_TextAutonumberSchemeEa1ChtPeriod ,_db .ST_TextAutonumberSchemeEa1JpnChsDbPeriod ,_db .ST_TextAutonumberSchemeEa1JpnKorPeriod ,_db .ST_TextAutonumberSchemeThaiAlphaPeriod ,_db .ST_TextAutonumberSchemeThaiNumPeriod ,_db .ST_TextAutonumberSchemeHindiAlphaPeriod ,_db .ST_TextAutonumberSchemeHindiNumPeriod ,_db .ST_TextAutonumberSchemeHindiAlpha1Period :_cce ="\u002e";case _db .ST_TextAutonumberSchemeAlphaLcParenR ,_db .ST_TextAutonumberSchemeAlphaUcParenR ,_db .ST_TextAutonumberSchemeArabicParenR ,_db .ST_TextAutonumberSchemeRomanLcParenR ,_db .ST_TextAutonumberSchemeRomanUcParenR ,_db .ST_TextAutonumberSchemeThaiAlphaParenR ,_db .ST_TextAutonumberSchemeThaiNumParenR ,_db .ST_TextAutonumberSchemeHindiNumParenR :_cce ="\u0029";};_bgc =_gdc +_cce ;_dbf ++;}else if _efdg :=_gad .BuChar ;_efdg !=nil {_adcc :=_efdg .CharAttr ;if _baga ,_add :=_aaae [_adcc ];_add {_adcc =string (rune (_baga ));}else {_adcc ="\u2022";};_bgc =_adcc ;_dcbe =true ;};if _bgc !=""{var _dad ,_bdfc float64 ;if _gad .MarLAttr !=nil {_dad =_bd .FromEMU (int64 (*_gad .MarLAttr ));};if _gad .IndentAttr !=nil {_bdfc =_bd .FromEMU (int64 (*_gad .IndentAttr ));};_fafd =&prefixData {_ccge :_bgc ,_gdg :_dcbe ,_ebbg :_dad ,_dgag :_bdfc };};};_gad =_baac (_gad ,_gegg );_egbec :=_bcbf (_degd .EndParaRPr ,_gad .DefRPr );_gaf .newParagraph ();_gaf .assignPropsToCurrentParagraph (_gad );_gaf .newLine ();_gaf .newWord ();for _fcf ,_dgg :=range _degd .EG_TextRun {_gaf .addTextRun (_dgg ,_egbec ,_ada ,_fafd );if _fcf > 0{_fafd =nil ;};};_gaf .addCurrentWordToParagraph ();};_gaf .addCurrentParagraph ();};_gaf .alignVertically (_cgc );_gaf .drawParagraphs ();return _bf .MakeBlockFromCreator (_cac );};type symbol struct{_bbe string ;_gfd float64 ;_ffad float64 ;_dgfa float64 ;_cedbc float64 ;_gga float64 ;_ecde *_dc .TextStyle ;_bbg string ;_ggf bool ;_eede bool ;_abd bool ;};func (_bfeb *textboxContext )newLine (){if _bfeb ._cafg ==nil {_bfeb .newParagraph ();};_dced :=_bfeb ._cafg ._fff +_bfeb ._cafg ._accc ;_gfc :=&line {};_gfc ._ddfd =_bfeb ._cafg ._deba ;if len (_bfeb ._cafg ._ecd )==0{_gfc ._ddfd +=_bfeb ._cafg ._ecgb ;};_gfc ._ecb =_bfeb ._cafg ._cceg ;_gfc ._cfcd =_gfc ._ddfd ;_gfc ._bdab =_dced ;_bfeb ._cafg ._ecd =append (_bfeb ._cafg ._ecd ,_gfc );_bfeb ._bage =_gfc ;};func _geee (_acb ,_dgde *_db .CT_TableStyleTextStyle )*_db .CT_TableStyleTextStyle {_bbba :=_db .NewCT_TableStyleTextStyle ();if _acb !=nil {*_bbba =*_acb ;};if _dgde ==nil {return _bbba ;};if _bbba .BAttr ==_db .ST_OnOffStyleTypeUnset {_bbba .BAttr =_dgde .BAttr ;};if _bbba .IAttr ==_db .ST_OnOffStyleTypeUnset {_bbba .IAttr =_dgde .IAttr ;};if _bbba .Font ==nil {_bbba .Font =_dgde .Font ;};if _bbba .FontRef ==nil {_bbba .FontRef =_dgde .FontRef ;};if _bbba .ScrgbClr ==nil {_bbba .ScrgbClr =_dgde .ScrgbClr ;};if _bbba .SrgbClr ==nil {_bbba .SrgbClr =_dgde .SrgbClr ;};if _bbba .HslClr ==nil {_bbba .HslClr =_dgde .HslClr ;};if _bbba .SysClr ==nil {_bbba .SysClr =_dgde .SysClr ;};if _bbba .SchemeClr ==nil {_bbba .SchemeClr =_dgde .SchemeClr ;};if _bbba .PrstClr ==nil {_bbba .PrstClr =_dgde .PrstClr ;};return _bbba ;};func _baac (_fdeba ,_dcbc *_db .CT_TextParagraphProperties )*_db .CT_TextParagraphProperties {_ceca :=_db .NewCT_TextParagraphProperties ();if _fdeba !=nil {*_ceca =*_fdeba ;};if _dcbc ==nil {return _ceca ;};if _ceca .MarLAttr ==nil {_ceca .MarLAttr =_dcbc .MarLAttr ;};if _ceca .MarRAttr ==nil {_ceca .MarRAttr =_dcbc .MarRAttr ;};if _ceca .LvlAttr ==nil {_ceca .LvlAttr =_dcbc .LvlAttr ;};if _ceca .IndentAttr ==nil {_ceca .IndentAttr =_dcbc .IndentAttr ;};if _ceca .AlgnAttr ==_db .ST_TextAlignTypeUnset {_ceca .AlgnAttr =_dcbc .AlgnAttr ;};if _ceca .DefTabSzAttr ==nil {_ceca .DefTabSzAttr =_dcbc .DefTabSzAttr ;};if _ceca .RtlAttr ==nil {_ceca .RtlAttr =_dcbc .RtlAttr ;};if _ceca .EaLnBrkAttr ==nil {_ceca .EaLnBrkAttr =_dcbc .EaLnBrkAttr ;};if _ceca .FontAlgnAttr ==_db .ST_TextFontAlignTypeUnset {_ceca .FontAlgnAttr =_dcbc .FontAlgnAttr ;};if _ceca .LatinLnBrkAttr ==nil {_ceca .LatinLnBrkAttr =_dcbc .LatinLnBrkAttr ;};if _ceca .HangingPunctAttr ==nil {_ceca .HangingPunctAttr =_dcbc .HangingPunctAttr ;};if _ceca .LnSpc ==nil {_ceca .LnSpc =_dcbc .LnSpc ;};if _ceca .SpcBef ==nil {_ceca .SpcBef =_dcbc .SpcBef ;};if _ceca .SpcAft ==nil {_ceca .SpcAft =_dcbc .SpcAft ;};if _ceca .BuClrTx ==nil {_ceca .BuClrTx =_dcbc .BuClrTx ;};if _ceca .BuClr ==nil {_ceca .BuClr =_dcbc .BuClr ;};if _ceca .BuSzTx ==nil {_ceca .BuSzTx =_dcbc .BuSzTx ;};if _ceca .BuSzPct ==nil {_ceca .BuSzPct =_dcbc .BuSzPct ;};if _ceca .BuSzPts ==nil {_ceca .BuSzPts =_dcbc .BuSzPts ;};if _ceca .BuFontTx ==nil {_ceca .BuFontTx =_dcbc .BuFontTx ;};if _ceca .BuFont ==nil {_ceca .BuFont =_dcbc .BuFont ;};if _ceca .BuNone ==nil {_ceca .BuNone =_dcbc .BuNone ;};if _ceca .BuAutoNum ==nil {_ceca .BuAutoNum =_dcbc .BuAutoNum ;};if _ceca .BuChar ==nil {_ceca .BuChar =_dcbc .BuChar ;};if _ceca .BuBlip ==nil {_ceca .BuBlip =_dcbc .BuBlip ;};if _ceca .TabLst ==nil {_ceca .TabLst =_dcbc .TabLst ;};if _ceca .ExtLst ==nil {_ceca .ExtLst =_dcbc .ExtLst ;};_ceca .DefRPr =_bcbf (_ceca .DefRPr ,_dcbc .DefRPr );return _ceca ;};func _aagc (_fcbcc ,_fbgf *_db .CT_TextBody )(*_db .CT_TextBodyProperties ,*_db .CT_TextListStyle ){if _fcbcc ==nil &&_fbgf ==nil {return nil ,nil ;};if _fcbcc ==nil {return _fbgf .BodyPr ,_fbgf .LstStyle ;};if _fbgf ==nil {return _fcbcc .BodyPr ,_fcbcc .LstStyle ;};_dcbf ,_cafaf :=_fcbcc .BodyPr ,_fcbcc .LstStyle ;_gcdc ,_eagd :=_fbgf .BodyPr ,_fbgf .LstStyle ;_ccda :=_gdef (_dcbf ,_gcdc );_ebca :=_bfag (_cafaf ,_eagd );return _ccda ,_ebca ;};

// FontStyle represents a kind of font styling. It can be FontStyle_Regular, FontStyle_Bold, FontStyle_Italic and FontStyle_BoldItalic.
type FontStyle =_bf .FontStyle ;type convertContext struct{_ggdc *_dc .Creator ;_cfc *_bf .Rectangle ;_ccb *_f .Presentation ;_gadf *_f .Slide ;_abge *_bg .SldMaster ;_afce *_bg .SldLayout ;_cfbd float64 ;_daga float64 ;_caa []_dc .Drawable ;_fcbc *background ;_bedb *_db .CT_TextParagraphProperties ;_dae *_db .CT_TextCharacterProperties ;_bcbc *_db .CT_TextParagraphProperties ;_efcf *_db .CT_TextCharacterProperties ;_agcc *_db .CT_TextParagraphProperties ;_dbbg *_db .CT_TextCharacterProperties ;_ded []*_db .CT_TextParagraphProperties ;_gcad []*_db .CT_TextParagraphProperties ;_ddg []*_db .CT_TextParagraphProperties ;_fcfc *_db .Theme ;_bfd *_db .CT_ColorMappingOverride ;};func (_dbd *convertContext )getShapesFromSpPr (_gfg *_db .CT_ShapeProperties ,_ceeg *_db .CT_ShapeStyle ,_dfc bool )([]_dc .Drawable ,float64 ,float64 ,float64 ,float64 ,_dc .Color ,bool ){_gbc :=[]_dc .Drawable {};var _bbdd ,_eda ,_ecf ,_ccgfe ,_ebg float64 ;var _eed ,_dfcf ,_egff ,_gca _dc .Color ;var _feab *_db .CT_BlipFillProperties ;_caf ,_cgf :=1.0,1.0;if _ceeg !=nil {_eed ,_dfcf ,_gca =_dbd .getStyleColors (_ceeg );};if _cafa :=_gfg .Ln ;_cafa !=nil {if _cafa .NoFill !=nil {_egff ,_ebg =nil ,0;}else {_egff ,_ebg ,_caf =_dbd .getInfoFromLn (_cafa );if _egff ==nil {_egff =_gca ;};};};if _gfg .NoFill !=nil {_dfcf ,_cgf =nil ,0;}else if _dfc {_dfcf =_dbd ._fcbc ._eacd ;_cgf =_dbd ._fcbc ._cbfe ;_feab =_dbd ._fcbc ._gbbd ;}else if _cbf :=_gfg .SolidFill ;_cbf !=nil {_dfcf ,_cgf =_dbd .getColorFromSolidFill (_cbf );};var _ccf bool ;if _dbe :=_gfg .Xfrm ;_dbe !=nil {_bbdd ,_eda ,_ecf ,_ccgfe =_bf .GetDataFromXfrm (_dbe );_ccf =true ;};if _aedf :=_gfg .CustGeom ;_aedf !=nil {_fdf :=[]_ac .Point {};_dcf ,_cda :=1.0,1.0;if _gbd :=_aedf .PathLst ;_gbd !=nil {for _ ,_dfg :=range _gbd .Path {if _dfg !=nil {if _gcc :=_dfg .WAttr ;_gcc !=nil {_dcf =_ecf /_bd .FromEMU (*_gcc );};if _dbb :=_dfg .HAttr ;_dbb !=nil {_cda =_ccgfe /_bd .FromEMU (*_dbb );};for _ ,_dceb :=range _dfg .Close {if _dceb !=nil {};};for _ ,_bagb :=range _dfg .MoveTo {if _bagb !=nil &&_bagb .Pt !=nil {_eff ,_fca :=_eafec (_bagb .Pt );_fdf =append (_fdf ,_ac .Point {X :_eff *_dcf +_bbdd ,Y :_fca *_cda +_eda });};};for _ ,_dcfb :=range _dfg .LnTo {if _dcfb !=nil &&_dcfb .Pt !=nil {_aba ,_bdgd :=_eafec (_dcfb .Pt );_fdf =append (_fdf ,_ac .Point {X :_aba *_dcf +_bbdd ,Y :_bdgd *_cda +_eda });};};_cbd :=_dbd ._ggdc .NewPolygon ([][]_ac .Point {_fdf });_cbd .SetFillColor (_dfcf );_cbd .SetFillOpacity (_cgf );_cbd .SetBorderWidth (_ebg );if _egff !=nil {_cbd .SetBorderColor (_egff );_cbd .SetBorderOpacity (_caf );};_gbc =append (_gbc ,_cbd );};};};};if _gbb :=_gfg .PrstGeom ;_gbb !=nil {switch _gbb .PrstAttr {case _db .ST_ShapeTypeRect :if _feab !=nil {_edbg :=_dbd .getShapeFromBlipFill (_feab ,_bbdd ,_eda ,_ecf ,_ccgfe );_gbc =append (_gbc ,_edbg );}else {_adc :=_dbd ._ggdc .NewRectangle (_bbdd ,_eda ,_ecf ,_ccgfe );_adc .SetFillColor (_dfcf );_adc .SetFillOpacity (_cgf );_adc .SetBorderWidth (_ebg );if _egff !=nil {_adc .SetBorderColor (_egff );_adc .SetBorderOpacity (_caf );};_gbc =append (_gbc ,_adc );};case _db .ST_ShapeTypeLine :_dfgf :=_dbd ._ggdc .NewLine (_bbdd ,_eda ,_bbdd +_ecf ,_eda +_ccgfe );_dfgf .SetLineWidth (_ebg );if _egff !=nil {_dfgf .SetColor (_egff );};_gbc =append (_gbc ,_dfgf );};};return _gbc ,_bbdd ,_eda ,_ecf ,_ccgfe ,_eed ,_ccf ;};func (_fagbb *textboxContext )alignParagraph (){_cbda :=_fagbb ._cafg ;if _cbda ._faeg ==_db .ST_TextAlignTypeL {return ;};_degcb :=len (_cbda ._ecd )-1;for _dcbb ,_fdccb :=range _cbda ._ecd {_ddfeb :=true ;_bbfb :=len (_fdccb ._fge );_babg :=0.0;for _cfbb :=len (_fdccb ._fge )-1;_cfbb >=0;_cfbb --{_gbe :=_fdccb ._fge [_cfbb ];if _ddfeb &&_gbe ._bfcg {_bbfb =_cfbb ;}else {_ddfeb =false ;for _ ,_cffd :=range _gbe ._effc {_babg +=_cffd ._gga ;};};};_fdccb ._fge =_fdccb ._fge [:_bbfb ];_gdad :=_fdccb ._ecb -_fdccb ._ddfd -_babg ;switch _cbda ._faeg {case _db .ST_TextAlignTypeR :_fdccb .moveRight (_gdad );case _db .ST_TextAlignTypeCtr :_fdccb .moveRight (_gdad /2);case _db .ST_TextAlignTypeJust :if _dcbb !=_degcb {_cgdf :=[]*word {};for _ ,_gggd :=range _fdccb ._fge {if _gggd ._bfcg {_cgdf =append (_cgdf ,_gggd );};};_aafc :=_gdad /float64 (len (_cgdf ));for _ ,_edbe :=range _cgdf {_edbe ._cega +=_aafc ;};var _bdda *word ;for _ ,_fbdg :=range _fdccb ._fge {if _bdda !=nil {_fbdg ._edgg =_bdda ._edgg +_bdda ._cega ;};_bdda =_fbdg ;};};};};};func (_aag *textboxContext )newWord (){_aag ._gdf =&word {_bfcg :true ,_edgg :_aag ._bage ._cfcd }};func (_dbdfa *textboxContext )alignSymbolsVertically (){for _ ,_feeef :=range _dbdfa ._egfa {for _ ,_befaf :=range _feeef ._ecd {_befe :=0.0;for _ ,_gaae :=range _befaf ._fge {for _ ,_gdaa :=range _gaae ._effc {if _gdaa ._ffad > _befe {_befe =_gdaa ._ffad ;};};};for _ ,_gadfb :=range _befaf ._fge {for _ ,_ddda :=range _gadfb ._effc {if _ddda ._dgfa < _befe {_ddda ._cedbc =_befe -_ddda ._dgfa ;};};};};};};func (_dgfe *line )moveRight (_feed float64 ){for _ ,_egad :=range _dgfe ._fge {_egad ._edgg +=_feed ;};};func (_beb *convertContext )extractDefaultProperties (){_df :=_beb ._ccb .X ();_bbf :=_df .DefaultTextStyle ;var _ef ,_bef ,_ce ,_efd ,_acc ,_bcf ,_ca ,_ea ,_bbc ,_ag *_db .CT_TextParagraphProperties ;if _bbf !=nil {_ef =_bbf .DefPPr ;_bef =_baac (_bbf .Lvl1pPr ,_ef );_ce =_baac (_bbf .Lvl2pPr ,_ef );_efd =_baac (_bbf .Lvl3pPr ,_ef );_acc =_baac (_bbf .Lvl4pPr ,_ef );_bcf =_baac (_bbf .Lvl5pPr ,_ef );_ca =_baac (_bbf .Lvl6pPr ,_ef );_ea =_baac (_bbf .Lvl7pPr ,_ef );_bbc =_baac (_bbf .Lvl8pPr ,_ef );_ag =_baac (_bbf .Lvl9pPr ,_ef );_beb ._bedb =_ef ;_beb ._dae =_ef .DefRPr ;};_beb ._ded =make ([]*_db .CT_TextParagraphProperties ,9);_beb ._ded [0]=_bef ;_beb ._ded [1]=_ce ;_beb ._ded [2]=_efd ;_beb ._ded [3]=_acc ;_beb ._ded [4]=_bcf ;_beb ._ded [5]=_ca ;_beb ._ded [6]=_ea ;_beb ._ded [7]=_bbc ;_beb ._ded [8]=_ag ;_ed :=_beb ._ccb .SlideMasters ()[0].X ();_ae :=_ed .TxStyles ;_fag :=_ae .TitleStyle ;_beb ._bcbc =_baac (_fag .DefPPr ,_ef );_beb ._efcf =_beb ._bcbc .DefRPr ;_beb ._gcad =make ([]*_db .CT_TextParagraphProperties ,9);_beb ._gcad [0]=_baac (_fag .Lvl1pPr ,_bef );_beb ._gcad [1]=_baac (_fag .Lvl2pPr ,_ce );_beb ._gcad [2]=_baac (_fag .Lvl3pPr ,_efd );_beb ._gcad [3]=_baac (_fag .Lvl4pPr ,_acc );_beb ._gcad [4]=_baac (_fag .Lvl5pPr ,_bcf );_beb ._gcad [5]=_baac (_fag .Lvl6pPr ,_ca );_beb ._gcad [6]=_baac (_fag .Lvl7pPr ,_ea );_beb ._gcad [7]=_baac (_fag .Lvl8pPr ,_bbc );_beb ._gcad [8]=_baac (_fag .Lvl9pPr ,_ag );_cd :=_ae .BodyStyle ;_beb ._agcc =_baac (_cd .DefPPr ,_ef );_beb ._dbbg =_beb ._agcc .DefRPr ;_beb ._ddg =make ([]*_db .CT_TextParagraphProperties ,9);_beb ._ddg [0]=_baac (_cd .Lvl1pPr ,_bef );_beb ._ddg [1]=_baac (_cd .Lvl2pPr ,_ce );_beb ._ddg [2]=_baac (_cd .Lvl3pPr ,_efd );_beb ._ddg [3]=_baac (_cd .Lvl4pPr ,_acc );_beb ._ddg [4]=_baac (_cd .Lvl5pPr ,_bcf );_beb ._ddg [5]=_baac (_cd .Lvl6pPr ,_ca );_beb ._ddg [6]=_baac (_cd .Lvl7pPr ,_ea );_beb ._ddg [7]=_baac (_cd .Lvl8pPr ,_bbc );_beb ._ddg [8]=_baac (_cd .Lvl9pPr ,_ag );};func (_fbea *textboxContext )drawParagraphs (){_fbea ._ebgg .NewPage ();for _ ,_feeg :=range _fbea ._egfa {for _ ,_cfcda :=range _feeg ._ecd {for _ ,_afdg :=range _cfcda ._fge {for _ ,_begd :=range _afdg ._effc {_bgga :=_fbea ._ebgg .NewStyledParagraph ();if _begd ._ggf {_begd ._cedbc =0;}else if _begd ._eede {_begd ._cedbc =1.2*_cfcda ._febd -_begd ._dgfa ;};_fgfb :=_afdg ._edgg +_begd ._gfd ;_edf :=_feeg ._gcca +_cfcda ._bdab +_begd ._cedbc ;_bgga .SetPos (_fgfb ,_edf );_dfa :=_bgga .Append (_begd ._bbe );if _begd ._ecde !=nil {_dfa .Style =*_begd ._ecde ;};_fbea ._ebgg .Draw (_bgga );if _begd ._abd {_gcga :=_edf +_begd ._dgfa +2;_bf .DrawLine (_fbea ._ebgg ,_fgfb ,_gcga ,_fgfb +_begd ._gga ,_gcga ,1,_begd ._ecde .Color );};};};};};};var _aaae =map[string ]int32 {"\u0076":9830,"\u00d8":8594,"\u00fc":8730};func _bfag (_ddce ,_ecfde *_db .CT_TextListStyle )*_db .CT_TextListStyle {_bcca :=_db .NewCT_TextListStyle ();if _ddce !=nil {*_bcca =*_ddce ;};if _ecfde ==nil {return _bcca ;};_bcca .DefPPr =_baac (_bcca .DefPPr ,_ecfde .DefPPr );_bcca .Lvl1pPr =_baac (_bcca .Lvl1pPr ,_ecfde .Lvl1pPr );_bcca .Lvl2pPr =_baac (_bcca .Lvl2pPr ,_ecfde .Lvl2pPr );_bcca .Lvl3pPr =_baac (_bcca .Lvl3pPr ,_ecfde .Lvl3pPr );_bcca .Lvl4pPr =_baac (_bcca .Lvl4pPr ,_ecfde .Lvl4pPr );_bcca .Lvl5pPr =_baac (_bcca .Lvl5pPr ,_ecfde .Lvl5pPr );_bcca .Lvl6pPr =_baac (_bcca .Lvl6pPr ,_ecfde .Lvl6pPr );_bcca .Lvl7pPr =_baac (_bcca .Lvl7pPr ,_ecfde .Lvl7pPr );_bcca .Lvl8pPr =_baac (_bcca .Lvl8pPr ,_ecfde .Lvl8pPr );_bcca .Lvl9pPr =_baac (_bcca .Lvl9pPr ,_ecfde .Lvl9pPr );return _bcca ;};func _gcec (_fbfg ,_gaff *_db .CT_TablePartStyle )*_db .CT_TablePartStyle {_daeb :=_db .NewCT_TablePartStyle ();if _fbfg !=nil {*_daeb =*_fbfg ;};if _gaff ==nil {return _daeb ;};if _daeb .TcTxStyle ==nil {_daeb .TcTxStyle =_gaff .TcTxStyle ;}else {_daeb .TcTxStyle =_geee (_daeb .TcTxStyle ,_gaff .TcTxStyle );};if _daeb .TcStyle ==nil {_daeb .TcStyle =_gaff .TcStyle ;}else {_daeb .TcStyle =_ebcc (_daeb .TcStyle ,_gaff .TcStyle );};return _daeb ;};func (_adccc *textboxContext )addCurrentWordToParagraph (){if _adccc ._abfg &&_adccc ._bage ._cfcd +_adccc ._gdf ._cega > _adccc ._bage ._ecb {_adccc .newLine ();};if !_adccc ._gdf ._bfcg ||len (_adccc ._bage ._fge )> 0{_adccc ._gdf ._edgg =_adccc ._bage ._cfcd ;_adccc ._bage ._fge =append (_adccc ._bage ._fge ,_adccc ._gdf );_adccc ._bage ._cfcd +=_adccc ._gdf ._cega ;for _ ,_aefd :=range _adccc ._gdf ._effc {_adccc .adjustHeights (_aefd ._ffad );};};};func _eafec (_fdg *_db .CT_AdjPoint2D )(float64 ,float64 ){var _eefc ,_bced float64 ;_bbbc ,_fegg :=_fdg .XAttr ,_fdg .YAttr ;if _afec :=_bbbc .ST_Coordinate ;_afec !=nil {_eefc =_bd .FromEMU (_bf .FromSTCoordinate (*_afec ));};if _egg :=_fegg .ST_Coordinate ;_egg !=nil {_bced =_bd .FromEMU (_bf .FromSTCoordinate (*_egg ));};return _eefc ,_bced ;};func _bcbf (_eefd ,_bcgf *_db .CT_TextCharacterProperties )*_db .CT_TextCharacterProperties {_abde :=_db .NewCT_TextCharacterProperties ();if _eefd !=nil {*_abde =*_eefd ;};if _bcgf ==nil {return _abde ;};if _abde .KumimojiAttr ==nil {_abde .KumimojiAttr =_bcgf .KumimojiAttr ;};if _abde .LangAttr ==nil {_abde .LangAttr =_bcgf .LangAttr ;};if _abde .AltLangAttr ==nil {_abde .AltLangAttr =_bcgf .AltLangAttr ;};if _abde .SzAttr ==nil {_abde .SzAttr =_bcgf .SzAttr ;};if _abde .BAttr ==nil {_abde .BAttr =_bcgf .BAttr ;};if _abde .IAttr ==nil {_abde .IAttr =_bcgf .IAttr ;};if _abde .UAttr ==_db .ST_TextUnderlineTypeUnset {_abde .UAttr =_bcgf .UAttr ;};if _abde .StrikeAttr ==_db .ST_TextStrikeTypeUnset {_abde .StrikeAttr =_bcgf .StrikeAttr ;};if _abde .KernAttr ==nil {_abde .KernAttr =_bcgf .KernAttr ;};if _abde .CapAttr ==_db .ST_TextCapsTypeUnset {_abde .CapAttr =_bcgf .CapAttr ;};if _abde .SpcAttr ==nil {_abde .SpcAttr =_bcgf .SpcAttr ;};if _abde .NormalizeHAttr ==nil {_abde .NormalizeHAttr =_bcgf .NormalizeHAttr ;};if _abde .BaselineAttr ==nil {_abde .BaselineAttr =_bcgf .BaselineAttr ;};if _abde .NoProofAttr ==nil {_abde .NoProofAttr =_bcgf .NoProofAttr ;};if _abde .DirtyAttr ==nil {_abde .DirtyAttr =_bcgf .DirtyAttr ;};if _abde .ErrAttr ==nil {_abde .ErrAttr =_bcgf .ErrAttr ;};if _abde .SmtCleanAttr ==nil {_abde .SmtCleanAttr =_bcgf .SmtCleanAttr ;};if _abde .SmtIdAttr ==nil {_abde .SmtIdAttr =_bcgf .SmtIdAttr ;};if _abde .BmkAttr ==nil {_abde .BmkAttr =_bcgf .BmkAttr ;};if _abde .Ln ==nil {_abde .Ln =_bcgf .Ln ;};if _abde .NoFill ==nil {_abde .NoFill =_bcgf .NoFill ;};if _abde .SolidFill ==nil {_abde .SolidFill =_bcgf .SolidFill ;};if _abde .BlipFill ==nil {_abde .BlipFill =_bcgf .BlipFill ;};if _abde .EffectLst ==nil {_abde .EffectLst =_bcgf .EffectLst ;};if _abde .EffectDag ==nil {_abde .EffectDag =_bcgf .EffectDag ;};if _abde .Highlight ==nil {_abde .Highlight =_bcgf .Highlight ;};if _abde .ULnTx ==nil {_abde .ULnTx =_bcgf .ULnTx ;};if _abde .ULn ==nil {_abde .ULn =_bcgf .ULn ;};if _abde .UFillTx ==nil {_abde .UFillTx =_bcgf .UFillTx ;};if _abde .UFill ==nil {_abde .UFill =_bcgf .UFill ;};if _abde .Latin ==nil {_abde .Latin =_bcgf .Latin ;};if _abde .Ea ==nil {_abde .Ea =_bcgf .Ea ;};if _abde .Cs ==nil {_abde .Cs =_bcgf .Cs ;};if _abde .Sym ==nil {_abde .Sym =_bcgf .Sym ;};if _abde .Rtl ==nil {_abde .Rtl =_bcgf .Rtl ;};return _abde ;};type line struct{_bdab float64 ;_ddfd float64 ;_ecb float64 ;_cfcd float64 ;_febd float64 ;_fge []*word ;};func (_dce *convertContext )getConnectors (_cfg *_bg .CT_Connector )[]_dc .Drawable {_eeg ,_ ,_ ,_ ,_ ,_ ,_ :=_dce .getShapesFromSpPr (_cfg .SpPr ,_cfg .Style ,false );return _eeg ;};func (_eee *convertContext )makePdfDivisionFromTxBody (_aec *_db .CT_TextBody ,_fcba ,_cdb float64 ,_agb *_db .CT_TableStyleTextStyle )*_dc .Division {_dffcg :=_eee ._ggdc .NewDivision ();_cdd :=_eee ._bedb ;_gcde :=_db .ST_TextAnchoringTypeT ;if _dfd :=_aec .BodyPr ;_dfd !=nil {if _fcab :=_dfd .AnchorAttr ;_fcab !=_db .ST_TextAnchoringTypeUnset {_gcde =_dfd .AnchorAttr ;};};if _gded :=_aec .LstStyle ;_gded !=nil {var _gaa *_db .CT_TextParagraphProperties ;if _gded .Lvl1pPr !=nil {_gaa =_gded .Lvl1pPr ;}else {_gaa =_eee ._ded [0];};_cdd =_baac (_gaa ,_baac (_gded .DefPPr ,_cdd ));};for _ ,_egbe :=range _aec .P {if _egbe !=nil {_cef :=_eee ._ggdc .NewStyledParagraph ();_ffbc :=_baac (_egbe .PPr ,_cdd );_fcc :=_bcbf (_egbe .EndParaRPr ,_ffbc .DefRPr );if len (_egbe .EG_TextRun )==0{_cef .Append ("\u000a");_dffcg .Add (_cef );continue ;};for _ ,_gac :=range _egbe .EG_TextRun {if _fac :=_gac .Br ;_fac !=nil {_cef .Append ("\u000a");}else if _cdfe :=_gac .R ;_cdfe !=nil {_efg :=_gdfb (_cdfe .RPr ,_agb );_efg =_bcbf (_efg ,_fcc );var _gage _dc .Color ;if _efg .SolidFill !=nil {_gage ,_ =_eee .getColorFromSolidFill (_efg .SolidFill );}else {_gage =_dc .ColorBlack ;};_fbf ,_gdde ,_gbcc ,_ :=_eee .makeStyleFromRPr (_efg );_fbf .Color =_gage ;if _gdde {_fbf .TextRise =0.5;}else if _gbcc {_fbf .TextRise =-0.5;};_ddd :=_cdfe .T ;if _efg .CapAttr ==_db .ST_TextCapsTypeAll {for _ ,_ead :=range _ddd {_ead =[]rune (_b .ToUpper (string (_ead )))[0];};};_gge :=_cef .Append (_ddd );_gge .Style =*_fbf ;};};_ =_gcde ;_dffcg .Add (_cef );};};return _dffcg ;};