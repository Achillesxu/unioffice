//
// Copyright 2020 FoxyUtils ehf. All rights reserved.
//
// This is a commercial product and requires a license to operate.
// A trial license can be obtained at https://unidoc.io
//
// DO NOT EDIT: generated by unitwist Go source code obfuscator.
//
// Use of this source code is governed by the UniDoc End User License Agreement
// terms that can be accessed at https://unidoc.io/eula/

package convert ;import (_dg "bytes";_gd "errors";_dc "github.com/unidoc/unioffice/common/tempstorage";_ee "github.com/unidoc/unioffice/document";_ec "github.com/unidoc/unioffice/measurement";_bd "github.com/unidoc/unioffice/schema/soo/dml";_a "github.com/unidoc/unioffice/schema/soo/dml/chart";_be "github.com/unidoc/unioffice/schema/soo/dml/picture";_gg "github.com/unidoc/unioffice/schema/soo/ofc/sharedTypes";_bb "github.com/unidoc/unioffice/schema/soo/wml";_gf "github.com/unidoc/unipdf/v3/creator";_f "github.com/unidoc/unipdf/v3/model";_d "io/ioutil";_e "log";_ce "math";_cg "sort";_b "strconv";_g "strings";);func (_dbg *convertContext )addAnchorExtra (_ebag []*_bb .EG_PContent ){for _ ,_cedd :=range _ebag {for _ ,_baf :=range _cedd .EG_ContentRunContent {if _dfed :=_baf .R ;_dfed !=nil {for _ ,_fbcc :=range _dfed .Extra {if _agb ,_gcda :=_fbcc .(*_bb .AlternateContentRun );_gcda {if _aga :=_agb .Choice ;_aga !=nil {if _abb :=_aga .Drawing ;_abb !=nil {for _ ,_bggb :=range _abb .Anchor {var _cad ,_bcc ,_gagc ,_cec float64 ;_ddce ,_bfegb :=_bggb .PositionH ,_bggb .PositionV ;if _cecf :=_ddce .Choice ;_cecf !=nil {if _cecf .PosOffset !=nil {_cad =_ec .FromEMU (int64 (*_cecf .PosOffset ))/_ec .Millimeter ;};};if _ffg :=_bfegb .Choice ;_ffg !=nil {if _ffg .PosOffset !=nil {_bcc =_ec .FromEMU (int64 (*_ffg .PosOffset ))/_ec .Millimeter ;};};if _eae :=_bggb .Extent ;_eae !=nil {_cec =_ec .FromEMU (_eae .CxAttr )/_ec .Millimeter ;_gagc =_ec .FromEMU (_eae .CyAttr )/_ec .Millimeter ;};_abgef :=_dbg ._bcaf ._ebf +_bcc ;_afbc :=_abgef +_gagc ;_befedf :=_dbg ._bcaf ._dac +_cad ;_cbcf :=_befedf +_cec ;_gfdb :=_bcc +_gagc ;if _gfdb > _dbg ._bcaf ._ae {_dbg ._bcaf ._ae =_gfdb ;};if _bggb .Choice !=nil &&_bggb .Choice .WrapNone ==nil {_dbg ._bcaf ._gcg =append (_dbg ._bcaf ._gcg ,&zoneToSkip {_cb :&rectangle {_eac :_abgef ,_caf :_afbc ,_deb :_befedf ,_aebb :_cbcf },_ea :_bggb .Choice });};if _gdd :=_bggb .Graphic ;_gdd !=nil {if _ddad :=_gdd .GraphicData ;_ddad !=nil {for _ ,_bfed :=range _ddad .Any {if _gbcc ,_eege :=_bfed .(*_bb .WdWsp );_eege {_ccf ,_abdd :=_dbg .makeBlockFromWdWsp (_gbcc );if _abdd !=nil {_e .Println ("\u0043a\u006en\u006f\u0074\u0020\u0072\u0065a\u0064\u0020b\u006c\u006f\u0063\u006b\u003a",_abdd );};if _ccf !=nil {_ccf ._gff .Scale (_cec /_ccf ._gff .Width (),_gagc /_ccf ._gff .Height ());_ccf ._gbf =_befedf ;_ccf ._gaca =_abgef ;if _bggb .BehindDocAttr {_dbg ._bcaf ._gdf =append (_dbg ._bcaf ._gdf ,_ccf );}else {_dbg ._bcaf ._cd =append (_dbg ._bcaf ._cd ,_ccf );};};};};};};};};};};};};};};};func _agea (_fdede *_gf .Creator ,_afac ,_ggea ,_dgbf ,_dcef float64 ,_bgfe *_bd .CT_ShapeProperties ){_bfaa :=_fdede .NewRectangle (_afac ,_ggea ,_dgbf ,_dcef );if _bgfe ==nil {_bfaa .SetBorderWidth (_bbeg );}else {if _gbfdd :=_bgfe .SolidFill ;_gbfdd !=nil {if _ddgc :=_gbfdd .SrgbClr ;_ddgc !=nil {_egff :=_gf .ColorRGBFromHex ("\u0023"+_ddgc .ValAttr );_bfaa .SetFillColor (_egff );};};if _efcf :=_bgfe .Ln ;_efcf !=nil {if _fcfe :=_efcf .WAttr ;_fcfe !=nil {_eacc :=_ec .FromEMU (int64 (*_fcfe ))/_ec .Millimeter ;_bfaa .SetBorderWidth (_eacc );if _cdfc :=_bgfe .SolidFill ;_cdfc !=nil {if _fbgg :=_cdfc .SrgbClr ;_fbgg !=nil {_afaa :=_gf .ColorRGBFromHex ("\u0023"+_fbgg .ValAttr );_bfaa .SetBorderColor (_afaa );};};}else {_bfaa .SetBorderWidth (0);};};};_fdede .Draw (_bfaa );};func (_ged *convertContext )drawPage (_ade *page ){if _ade ._eg {_abgg :=_ade ._ag ._eac +_ad *_da ;_dde :=_ade ._ag ._deb ;_fbf :=_ade ._ag ._aebb ;_dggf (_ged ._ggd ,_dde ,_abgg ,_fbf ,_abgg ,0.25,_gf .ColorBlack );};for _ ,_cbc :=range _ade ._ga {_ged ._ggd .Draw (_cbc );};for _ ,_ceb :=range _ade ._eb {_abg (_ged ._ggd ,_ceb );};for _ ,_ddc :=range _ade ._bbb {if _ddc ._fd {_gcd :=_ddc ._ebf +_ad *_da ;_gda :=_ade ._ag ._deb ;_ccee :=_gda +50;_dggf (_ged ._ggd ,_gda ,_gcd ,_ccee ,_gcd ,0.25,_gf .ColorBlack );}else {for _ ,_bdfc :=range _ddc ._dd {for _ ,_caa :=range _bdfc ._fbd {for _ ,_afc :=range _caa ._daa {for _ ,_dce :=range _afc ._bf {if _dce ._cefg !=nil {_dce ._cefg .SetPos (_afc ._eca +_dce ._dfc ,_ddc ._ebf +_bdfc ._ab +_dce ._aa );_ged ._ggd .Draw (_dce ._cefg );}else if _dce ._fcc !=nil {_dce ._fcc ._gbf =_afc ._eca +_dce ._dfc ;_dce ._fcc ._gaca =_ddc ._ebf +_bdfc ._ab +_dce ._aa ;_abg (_ged ._ggd ,_dce ._fcc );}else {_dcf :=_ged ._ggd .NewStyledParagraph ();if _dce ._gbe {_dce ._aa =0;}else if _dce ._dccg {_dce ._aa =1.2*_bdfc ._bdf -_dce ._cef ;};_fbc :=_afc ._eca +_dce ._dfc ;_bag :=_ddc ._ebf +_bdfc ._ab +_dce ._aa ;_dcf .SetPos (_fbc ,_bag );var _ddd *_gf .TextChunk ;if _dce ._dcc !=""{_ddd =_dcf .AddExternalLink (_dce ._dda ,_dce ._dcc );}else {_ddd =_dcf .Append (_dce ._dda );};if _dce ._gab !=nil {_ddd .Style =*_dce ._gab ;};_ged ._ggd .Draw (_dcf );};};};};};if _ddc ._df !=nil {_bdc :=_gf .NewBlock (_ddc ._bdg -_ddc ._dac ,_ddc ._fa ._eac +_ddc ._gacc +_ddc ._fa ._caf );_bdc .SetPos (_ddc ._fag ,_ddc ._ebf +_ddc ._fa ._eac );_bdc .Draw (_ddc ._df );_ged ._ggd .Draw (_bdc );};};};for _ ,_eec :=range _ade ._ff {_ged ._ggd .Draw (_eec );};for _ ,_ccg :=range _ade ._ge {_abg (_ged ._ggd ,_ccg );};if len (_ade ._gac )> 0{_ffag :=_ade ._ag ._caf +_ad *_da ;_gcf :=_ade ._ag ._deb ;_aaa :=_gcf +50;_dggf (_ged ._ggd ,_gcf ,_ffag ,_aaa ,_ffag ,0.25,_gf .ColorBlack );_adea :=_ade ._ag ._caf +_ad ;for _ ,_ddeb :=range _ade ._gac {_ddeb ._cgc .SetPos (_ade ._ag ._deb ,_adea );_ged ._ggd .Draw (_ddeb ._cgc );_adea +=_ddeb ._cgc .Height ();};};};func (_eee *convertContext )addAbsoluteEGPC (_ddcg []*_bb .EG_PContent ,_gef *_bb .CT_PPr ,_befe *prefix )bool {_eee .newParagraph ();_ebba (_gef ,_eee ._bcaf );_eee .determineParagraphBounds ();_eee .addAnchorBlocks (_ddcg );_eee .addAnchorExtra (_ddcg );_eee .newLine ();_eee .newWord ();if len (_ddcg )==0{_eee .addEmptyLine ();return false ;};if _befe !=nil {_eee ._fbccc =_befe ;};for _ ,_dge :=range _ddcg {for _ ,_gagb :=range _dge .FldSimple {if _gagb !=nil {_eee .addAbsoluteEGPC (_gagb .EG_PContent ,_gef ,_befe );};};if _fegc :=_dge .Hyperlink ;_fegc !=nil {_eee ._bbbg =_fegc ;_eee .addAbsoluteCRC (_fegc .EG_ContentRunContent ,_gef );};_eee ._bbbg =nil ;if _eee .addAbsoluteCRC (_dge .EG_ContentRunContent ,_gef ){return true ;};};_eee .addCurrentWordToParagraph ();return false ;};type paragraph struct{_fc float64 ;_fa *rectangle ;_fag float64 ;_dac float64 ;_bdg float64 ;_ebf float64 ;_gacc float64 ;_feg _gf .TextAlignment ;_gb float64 ;_dd []*line ;_df *_gf .Table ;_af []*_gf .Image ;_cc []*_gf .Image ;_cd []*block ;_gdf []*block ;_ada []*note ;_gc float64 ;_gcg []*zoneToSkip ;_ae float64 ;_fd bool ;};func _cfded (_fbfdf *_bb .CT_TblWidth ,_bgbb float64 )float64 {if _bbd :=_fbfdf .WAttr ;_bbd !=nil {if _aabab :=_bbd .ST_DecimalNumberOrPercent ;_aabab !=nil {if _geae :=_aabab .ST_UnqualifiedPercentage ;_geae !=nil {switch _fbfdf .TypeAttr {case _bb .ST_TblWidthDxa :return float64 (*_geae )/56.7;case _bb .ST_TblWidthPct :return _bgbb ;default:return _bgbb ;};};};};return _bgbb ;};func _fgcg (_bdbf *_ee .Document ,_gced *_bb .CT_RPr ,_dfbgf *_bb .CT_PPr )*_bb .CT_RPr {var _bbgf ,_fdbf *_bb .CT_RPr ;if _gced ==nil {_gced =_bb .NewCT_RPr ();};var _ecgbb *_bb .CT_ParaRPr ;if _dfbgf !=nil &&_dfbgf .RPr !=nil {_ecgbb =_dfbgf .RPr ;};if _ecgbb ==nil {_ecgbb =_bb .NewCT_ParaRPr ();};if _gced .RStyle !=nil {_ggdf :=_bdbf .GetStyleByID (_gced .RStyle .ValAttr );if _eeafa :=_ggdf .X ();_eeafa !=nil {_bbgf =_eeafa .RPr ;};};if _bbgf ==nil {_bbgf =_bb .NewCT_RPr ();};if _ecgbb .RStyle !=nil {_fbag :=_bdbf .GetStyleByID (_ecgbb .RStyle .ValAttr );if _gace :=_fbag .X ();_gace !=nil {_fdbf =_gace .RPr ;};};if _fdbf ==nil {_fdbf =_bb .NewCT_RPr ();};if _gced .Color ==nil {if _bbgf .Color !=nil {_gced .Color =_bbgf .Color ;}else if _ecgbb .Color !=nil {_gced .Color =_ecgbb .Color ;}else if _fdbf .Color !=nil {_gced .Color =_fdbf .Color ;};};if _gced .Spacing ==nil {if _bbgf .Spacing !=nil {_gced .Spacing =_bbgf .Spacing ;}else if _ecgbb .Spacing !=nil {_gced .Spacing =_ecgbb .Spacing ;}else if _fdbf .Spacing !=nil {_gced .Spacing =_fdbf .Spacing ;};};if _gced .Sz ==nil {if _bbgf .Sz !=nil {_gced .Sz =_bbgf .Sz ;}else if _ecgbb .Sz !=nil {_gced .Sz =_ecgbb .Sz ;}else if _fdbf .Sz !=nil {_gced .Sz =_fdbf .Sz ;};};if _gced .SzCs ==nil {if _bbgf .SzCs !=nil {_gced .SzCs =_bbgf .SzCs ;}else if _ecgbb .SzCs !=nil {_gced .SzCs =_ecgbb .SzCs ;}else if _fdbf .SzCs !=nil {_gced .SzCs =_fdbf .SzCs ;};};if _gced .B ==nil {if _bbgf .B !=nil {_gced .B =_bbgf .B ;}else if _ecgbb .B !=nil {_gced .B =_ecgbb .B ;}else if _fdbf .B !=nil {_gced .B =_fdbf .B ;};};if _gced .I ==nil {if _bbgf .I !=nil {_gced .I =_bbgf .I ;}else if _ecgbb .I !=nil {_gced .I =_ecgbb .I ;}else if _fdbf .I !=nil {_gced .I =_fdbf .I ;};};if _gced .RFonts ==nil {if _bbgf .RFonts !=nil {_gced .RFonts =_bbgf .RFonts ;}else if _ecgbb .RFonts !=nil {_gced .RFonts =_ecgbb .RFonts ;}else if _fdbf .RFonts !=nil {_gced .RFonts =_fdbf .RFonts ;};};if _gced .VertAlign ==nil {if _bbgf .VertAlign !=nil {_gced .VertAlign =_bbgf .VertAlign ;}else if _ecgbb .VertAlign !=nil {_gced .VertAlign =_ecgbb .VertAlign ;}else if _fdbf .VertAlign !=nil {_gced .VertAlign =_fdbf .VertAlign ;};};return _gced ;};func (_gbfd *convertContext )addRelativeEGPC (_edcda []*_bb .EG_PContent ,_fdfc *_bb .CT_PPr ,_abed *prefix ){if len (_edcda )==0{_gbfd ._aaga .Append ("\u000d");return ;};if _abed !=nil {_gbfd ._fbccc =_abed ;};for _ ,_cdeb :=range _edcda {for _ ,_bcbd :=range _cdeb .FldSimple {if _bcbd !=nil {_gbfd .addRelativeEGPC (_bcbd .EG_PContent ,_fdfc ,_abed );};};if _abfe :=_cdeb .Hyperlink ;_abfe !=nil {_gbfd ._bbbg =_abfe ;_gbfd .addRelativeCRC (_abfe .EG_ContentRunContent ,_fdfc );};_gbfd ._bbbg =nil ;_gbfd .addRelativeCRC (_cdeb .EG_ContentRunContent ,_fdfc );};};func (_cabgb *convertContext )makePdfBlockFromCBCs (_bdgc [][]*_bb .EG_ContentBlockContent ,_afbe ,_ebafc float64 ,_dagf *rectangle ,_cbfd bool ,_dbff *prefix )(*_gf .Block ,error ){if _dagf ==nil {_dagf =&rectangle {};};_dbbc :=&rectangle {_eac :_dagf ._eac ,_caf :_ebafc -_dagf ._caf ,_deb :_dagf ._deb ,_aebb :_afbe -_dagf ._aebb };_ecaf :=_gecc (_afbe ,_ebafc );_bcgb :=&convertContext {_ggd :_ecaf ,_ceda :_cabgb ._ceda ,_bcecg :_dbbc ,_fbccc :_dbff };for _ ,_cgae :=range _bdgc {_bcgb .addAbsoluteCBCs (_cgae );};if _cbfd {_dabb :=0.0;for _ ,_ggdc :=range _bcgb ._bcbf {for _ ,_gabgb :=range _ggdc ._bbb {_dabb +=(_gabgb ._gacc +_gabgb ._fa ._eac +_gabgb ._fa ._caf );};};_dbbc ._caf =_dabb -_dagf ._caf ;_ecaf =_gecc (_afbe ,_dabb );_bcgb =&convertContext {_ggd :_ecaf ,_ceda :_cabgb ._ceda ,_bcecg :_dbbc ,_fbccc :_dbff };for _ ,_aefa :=range _bdgc {_bcgb .addAbsoluteCBCs (_aefa );};};_bcgb .alignSymbolsVertically ();_bcgb .drawPage (_bcgb ._bcbf [0]);return _acga (_ecaf );};func _dced (_ffeb *_a .CT_SerAx )(uint32 ,_a .ST_AxPos ,_a .ST_TickMark ,_a .ST_TickLblPos ,*_a .CT_ChartLines ,uint32 ,*_bd .CT_ShapeProperties ,error ){var _daea ,_efff uint32 ;var _ffad _a .ST_AxPos ;var _ebac _a .ST_TickMark ;var _acag *_a .CT_ChartLines ;var _gfcc _a .ST_TickLblPos ;if _ffeb .AxId ==nil {return _daea ,_ffad ,_ebac ,_gfcc ,_acag ,_efff ,_ffeb .SpPr ,_gd .New ("\u004e\u006f\u0020x\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");}else {_daea =_ffeb .AxId .ValAttr ;};if _ffeb .AxPos ==nil {return _daea ,_ffad ,_ebac ,_gfcc ,_acag ,_efff ,_ffeb .SpPr ,_gd .New ("\u004eo\u0020x\u0020\u0061\u0078\u0069\u0073 \u0070\u006fs\u0069\u0074\u0069\u006f\u006e");}else {_ffad =_ffeb .AxPos .ValAttr ;};if _ffeb .MajorTickMark !=nil {_ebac =_ffeb .MajorTickMark .ValAttr ;};if _ffeb .TickLblPos !=nil {_gfcc =_ffeb .TickLblPos .ValAttr ;};if _ffeb .CrossAx ==nil {return _daea ,_ffad ,_ebac ,_gfcc ,_acag ,_efff ,_ffeb .SpPr ,_gd .New ("\u004e\u006f \u0063\u0072\u006fs\u0073\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");}else {_efff =_ffeb .CrossAx .ValAttr ;};_acag =_ffeb .MajorGridlines ;return _daea ,_ffad ,_ebac ,_gfcc ,_acag ,_efff ,_ffeb .SpPr ,nil ;};func _agdd (_gbge *_bb .EG_RunInnerContent )bool {if _agga :=_gbge .Br ;_agga !=nil {return _agga .TypeAttr ==_bb .ST_BrTypePage ;};return false ;};func (_caca *convertContext )addCurrentParagraphToCurrentPage (){_caca ._aadd ._fe =_caca ._bcaf ._ebf +_caca ._bcaf ._fa ._eac +_caca ._bcaf ._gacc +_caca ._bcaf ._fa ._caf ;_caca ._aadd ._ff =append (_caca ._aadd ._ff ,_caca ._bcaf ._af ...);_caca ._aadd ._ga =append (_caca ._aadd ._ga ,_caca ._bcaf ._cc ...);_caca ._aadd ._ge =append (_caca ._aadd ._ge ,_caca ._bcaf ._cd ...);_caca ._aadd ._eb =append (_caca ._aadd ._eb ,_caca ._bcaf ._gdf ...);_caca ._aadd ._cf =append (_caca ._aadd ._cf ,_caca ._bcaf ._gcg ...);_caca ._aadd ._bbb =append (_caca ._aadd ._bbb ,_caca ._bcaf );_caca .adjustRightBoundOfLastSpan ();_caca .alignParagraph ();if len (_caca ._aadd ._gac )==0&&len (_caca ._bcaf ._ada )> 0{_caca ._aadd ._ag ._caf -=_ad ;};_caca ._aadd ._gac =append (_caca ._aadd ._gac ,_caca ._bcaf ._ada ...);_caca ._aadd ._ag ._caf -=_caca ._bcaf ._gc ;};func _gebf (_dbefa float64 )float64 {return _dbefa *_ec .Millimeter /_ec .Twips };const _dgeb =1.5;type serValue struct{_bbbd string ;_bbgc float64 ;_cge *_bd .CT_ShapeProperties ;};func (_efe *convertContext )addTables (_ecg []*_bb .CT_Tbl ){for _ ,_gdb :=range _ecg {_aae :=_efe .addAbsoluteTable (_gdb );if _aae ==nil {continue ;};_ead :=_gecc (1000,1000);_ead .Draw (_aae );_efe .newParagraph ();_efe ._bcaf ._fa =&rectangle {1,1,1,1};_efe ._bcaf ._df =_aae ;_efe ._bcaf ._gacc =_aae .Height ();_efe .determineParagraphBounds ();if _efe .currentParagraphOverflowsCurrentPage (){_efe .newPage ();_efe ._bcaf ._ebf =_efe ._aadd ._fe ;_efe .determineParagraphBounds ();};_efe .addCurrentParagraphToCurrentPage ();};};const _cbfa =2.5;func (_agafb *convertContext )addSeparator (){_agafb .newParagraph ();_agafb ._bcaf ._fd =true ;_agafb ._bcaf ._gacc =_ad ;if _agafb .currentParagraphOverflowsCurrentPage (){_agafb .newPage ();_agafb ._bcaf ._ebf =_agafb ._aadd ._fe ;};_agafb .addCurrentParagraphToCurrentPage ();};type serCategory struct{_gedg string ;_cfga []serValue ;};func (_gag *convertContext )addParagraphs (_eag []*_bb .CT_P ){for _ ,_bcd :=range _eag {_abgf ,_bgg :=_gag .combinePPrWithStyles (_bcd .PPr );if _gag .addAbsoluteEGPC (_bcd .EG_PContent ,_abgf ,_bgg ){_gag .newPage ();continue ;};if _gag .currentParagraphOverflowsCurrentPage (){_gag .newPage ();_gag .addAbsoluteEGPC (_bcd .EG_PContent ,_abgf ,_bgg );};_gag .addCurrentParagraphToCurrentPage ();};};type note struct{_fb string ;_ggc []*_bb .EG_BlockLevelElts ;_cgc *_gf .Block ;};func _abg (_faf *_gf .Creator ,_aed *block ){_aed ._gff .SetPos (_aed ._gbf ,_aed ._gaca );_faf .Draw (_aed ._gff );if _aed ._adg {_dcab (_faf ,&rectangle {_eac :_aed ._gaca ,_caf :_aed ._gaca +_aed ._gff .Height (),_deb :_aed ._gbf ,_aebb :_aed ._gbf +_aed ._gff .Width ()},_aed ._cbg ,_aed ._fef );};};func (_cefe barSerByOrder )Less (i ,j int )bool {return _cefe [i ].Order .ValAttr < _cefe [j ].Order .ValAttr ;};func _bafce (_dddc *_gf .Creator ,_fgfg *rectangle ,_edbf []*legendItem ,_feca bool ){_afcf :=float64 (len (_edbf ));if _feca {_cabba :=&rectangle {_eac :_fgfg ._eac +1,_caf :_fgfg ._caf -1,_deb :_fgfg ._deb +2.5,_aebb :_fgfg ._aebb -2.5};var _fcf float64 ;if _afcf > 1{_fcf =(_cabba ._aebb -_cabba ._deb )/_afcf ;};_ggb :=_cabba ._deb ;_aea :=_cabba ._eac ;for _ ,_fdbd :=range _edbf {if _bdfa :=_fdbd ._egfd ;_bdfa !=nil {_agea (_dddc ,_ggb ,_aea +_bfb ,_dgeb ,_dgeb ,_bdfa );_bgdfe :=_ggb +_dgeb *2;_cdd :=_dddc .NewStyledParagraph ();_cdd .SetPos (_bgdfe ,_aea );_bgbg :=_cdd .Append (_fdbd ._cfd );_egfg ,_ebgc :=_f .NewStandard14Font (_f .HelveticaName );if _ebgc ==nil {_bgbg .Style =_gf .TextStyle {FontSize :_cbfa ,Font :_egfg ,TextRise :0.4};_dddc .Draw (_cdd );};};_ggb +=_fcf ;};}else {_dfeg :=&rectangle {_eac :_fgfg ._eac +2.5,_caf :_fgfg ._caf -2.5,_deb :_fgfg ._deb +2.5,_aebb :_fgfg ._aebb -2.5};var _eafb float64 ;if _afcf > 1{_eafb =(_dfeg ._caf -_dfeg ._eac -_cbfa )/(_afcf -1);};_ccbg :=_dfeg ._eac ;_ffaf :=_dfeg ._deb ;_egbg :=_ffaf +_dgeb *2;for _ ,_gafd :=range _edbf {if _aeb :=_gafd ._egfd ;_aeb !=nil {_agea (_dddc ,_ffaf ,_ccbg +_bfb ,_dgeb ,_dgeb ,_aeb );_cefa :=_dddc .NewStyledParagraph ();_cefa .SetPos (_egbg ,_ccbg );_aabaf :=_cefa .Append (_gafd ._cfd );_cff ,_abga :=_f .NewStandard14Font (_f .HelveticaName );if _abga ==nil {_aabaf .Style =_gf .TextStyle {FontSize :_cbfa ,Font :_cff ,TextRise :0.4};_dddc .Draw (_cefa );};};_ccbg +=_eafb ;};};};func (_daf *span )moveRight (_ef float64 ){for _ ,_gbda :=range _daf ._daa {_gbda ._eca +=_ef ;};};func _ddfg (_fbba *_bb .CT_OnOff )bool {if _fbba !=nil {if _dddd :=_fbba .ValAttr ;_dddd !=nil {if _bgbe :=_dddd .Bool ;_bgbe !=nil {return *_bgbe ;};return _dddd .ST_OnOff1 ==_gg .ST_OnOff1On ;};return true ;};return false ;};type prefix struct{_dbac string ;_cgdg []float64 ;_deeg bool ;_bfdfb bool ;};func (_cee *convertContext )addAbsoluteCRC (_dcff []*_bb .EG_ContentRunContent ,_befa *_bb .CT_PPr )bool {for _ ,_fegd :=range _dcff {if _adf :=_fegd .R ;_adf !=nil {_cgf :=_fgcg (_cee ._ceda ,_adf .RPr ,_befa );if _cee ._fbccc !=nil {_cee .addAbsoluteRIC (nil ,_cgf );_cee ._fbccc =nil ;};for _ ,_eeff :=range _adf .EG_RunInnerContent {if _cee .addAbsoluteRIC (_eeff ,_cgf ){return true ;};};for _ ,_efd :=range _adf .Extra {if _cag ,_abge :=_efd .(*_bb .AlternateContentRun );_abge {if _ggg :=_cag .Choice ;_ggg !=nil {if _bcf :=_ggg .Drawing ;_bcf !=nil {if len (_bcf .Inline )> 0{for _ ,_bed :=range _bcf .Inline {_dbf :=_bed .Extent ;if _dbf ==nil {return false ;};_gbc :=_ec .FromEMU (_dbf .CxAttr )/_ec .Millimeter ;_ecd :=_ec .FromEMU (_dbf .CyAttr )/_ec .Millimeter ;if _dfg :=_bed .Graphic ;_dfg !=nil {if _acgf :=_dfg .GraphicData ;_acgf !=nil {for _ ,_fdg :=range _acgf .Any {if _ggcd ,_feb :=_fdg .(*_bb .WdWsp );_feb {_fea ,_bgf :=_cee .makeBlockFromWdWsp (_ggcd );if _bgf !=nil {_e .Println ("\u0043a\u006en\u006f\u0074\u0020\u0072\u0065a\u0064\u0020b\u006c\u006f\u0063\u006b\u003a",_bgf );};if _fea ==nil {continue ;};_fea ._gff .Scale (_gbc /_fea ._gff .Width (),_ecd /_fea ._gff .Height ());_cee .addInlineSymbol (&symbol {_cef :_ecd ,_bc :_gbc ,_fcc :_fea });};};};};};};};};};};};};return false ;};func (_gaed *convertContext )addHdrFtr (_dacfe []*_bb .CT_P ){for _ ,_cfde :=range _dacfe {_gbeae :=_gaed ._ggd .NewStyledParagraph ();_gaed ._aaga =_gbeae ;_fffd ,_ebgf :=_gaed .combinePPrWithStyles (_cfde .PPr );_eadf ,_agdf :=_fbfg (_fffd ,_gbeae );_gaed .addRelativeEGPC (_cfde .EG_PContent ,_fffd ,_ebgf );if _gaed ._fcbe {_gaed ._ggd .DrawHeader (func (_becd *_gf .Block ,_bdff _gf .HeaderFunctionArgs ){_gbeae .SetPos (_gaed ._dcdb +_agdf ,_eadf +_gaed ._edfdd );_becd .Draw (_gbeae );});}else if _gaed ._ccce {_gaed ._ggd .DrawFooter (func (_gcfg *_gf .Block ,_ecedb _gf .FooterFunctionArgs ){_gbeae .SetPos (_gaed ._dcdb +_agdf ,_eadf +_gaed ._bfeb -_gaed ._gagbg );_gcfg .Draw (_gbeae );});};};};func (_befed *convertContext )addEmptyLine (){_befed .addTextSymbol (&symbol {_dda :"\u000d",_bc :0})};func (_afa *convertContext )adjustHeights (_afcg float64 ){if _afa ._feefa ._bdf < _afcg {_afa ._bcaf ._gacc +=(_afcg -_afa ._feefa ._bdf );_afa ._feefa ._bdf =_afcg ;};};func (_fdcf barSerByOrder )Len ()int {return len (_fdcf )};func (_cfad *convertContext )addAbsoluteTable (_eagd *_bb .CT_Tbl )*_gf .Table {_gcag :=_eagd .TblGrid ;if _gcag ==nil {return nil ;};_geca :=len (_gcag .GridCol );if _geca ==0{return nil ;};_gba :=[]float64 {};_aagf :=[]float64 {};_agd :=0.0;for _ ,_dae :=range _gcag .GridCol {_dacd :=0.0;if _dae .WAttr .ST_UnsignedDecimalNumber !=nil {_dacd =_faag (int64 (*_dae .WAttr .ST_UnsignedDecimalNumber ));};_gba =append (_gba ,_dacd );_agd +=_dacd ;};for _gdbg :=0;_gdbg < _geca ;_gdbg ++{_aagf =append (_aagf ,_gba [_gdbg ]/_agd );};_dbeg :=_cfad ._ggd .NewTable (_geca );_dbeg .SetColumnWidths (_aagf ...);_abbe :=_cdgfe (_cfad ._ceda ,_eagd .TblPr );_dbgbb :=len (_eagd .EG_ContentRowContent );for _cfe ,_ded :=range _eagd .EG_ContentRowContent {if _ded ==nil {continue ;};if _gfac :=_ded .Tr ;len (_gfac )> 0{_edc :=_gfac [0];for _dbeb ,_fddf :=range _edc .EG_ContentCellContent {if _cgfb :=_fddf .Tc ;len (_cgfb )> 0{_gaff :=_cgfb [0];if _gaff !=nil {_efc :=_dbeg .NewCell ();_degc :=_bdd (_abbe ,_gaff .TcPr ,_cfe ,_dbeb ,_dbgbb ,_geca );_acf :=1.9;_cdg :=_gf .CellVerticalAlignmentTop ;if _degc !=nil {if _acdbc :=_degc .TcBorders ;_acdbc !=nil {if _gcfb :=_acdbc .Left ;_gcfb !=nil {_eadc ,_aceg ,_abeb :=_cebde (_gcfb );_efc .SetBorder (_gf .CellBorderSideLeft ,_eadc ,_abeb );if _aceg !=nil &&*_aceg !=nil {_efc .SetSideBorderColor (_gf .CellBorderSideLeft ,*_aceg );};};if _cbce :=_acdbc .Top ;_cbce !=nil {_adeg ,_cgca ,_gebc :=_cebde (_cbce );_efc .SetBorder (_gf .CellBorderSideTop ,_adeg ,_gebc );if _cgca !=nil &&*_cgca !=nil {_efc .SetSideBorderColor (_gf .CellBorderSideTop ,*_cgca );};};if _ffb :=_acdbc .Right ;_ffb !=nil {_defe ,_eeb ,_dee :=_cebde (_ffb );_efc .SetBorder (_gf .CellBorderSideRight ,_defe ,_dee );if _eeb !=nil &&*_eeb !=nil {_efc .SetSideBorderColor (_gf .CellBorderSideRight ,*_eeb );};};if _edfc :=_acdbc .Bottom ;_edfc !=nil {_eeeg ,_fbb ,_efg :=_cebde (_edfc );_efc .SetBorder (_gf .CellBorderSideBottom ,_eeeg ,_efg );if _fbb !=nil &&*_fbb !=nil {_efc .SetSideBorderColor (_gf .CellBorderSideBottom ,*_fbb );};};}else {_efc .SetBorder (_gf .CellBorderSideAll ,_gf .CellBorderStyleSingle ,0.125);_efc .SetBorderColor (_gf .ColorBlack );};if _dfd :=_degc .Shd ;_dfd !=nil {if _eeee :=_dfd .FillAttr ;_eeee !=nil {if _cbef :=_eeee .ST_HexColorRGB ;_cbef !=nil {_dbef :=_gf .ColorRGBFromHex ("\u0023"+*_cbef );_efc .SetBackgroundColor (_dbef );};};};if _egbc :=_degc .TcMar ;_egbc !=nil {if _dbae :=_egbc .Left ;_dbae !=nil {_acf =_cfded (_dbae ,1.9);};};if _cefgf :=_degc .VAlign ;_cefgf !=nil {switch _cefgf .ValAttr {case _bb .ST_VerticalJcCenter :_cdg =_gf .CellVerticalAlignmentMiddle ;case _bb .ST_VerticalJcBottom :_cdg =_gf .CellVerticalAlignmentBottom ;};};};_efc .SetVerticalAlignment (_cdg );_efc .SetIndent (_acf );_bdga :=_gaff .EG_BlockLevelElts ;_dddf :=_cfad ._ggd .NewStyledParagraph ();_edfd :=false ;for _ ,_gcc :=range _bdga {for _ ,_daad :=range _gcc .EG_ContentBlockContent {_ceeg :=true ;for _ ,_cgd :=range _daad .P {_gagcg ,_ :=_cfad .combinePPrWithStyles (_cgd .PPr );if _gagcg ==nil {continue ;};for _ ,_ffae :=range _cgd .EG_PContent {for _ ,_bcb :=range _ffae .EG_ContentRunContent {if _fcd :=_bcb .R ;_fcd !=nil {_gfgc :=_fgcg (_cfad ._ceda ,_fcd .RPr ,_gagcg );for _ ,_eafc :=range _fcd .EG_RunInnerContent {var _dcde *_gf .TextChunk ;if _eafc .T !=nil &&_eafc .T .Content !=""{if _edfd {if _ceeg {_geg :=_dddf .Append ("\u000a");_ccc :=_cfad ._ggd .NewTextStyle ();_ccc .FontSize =0;_geg .Style =_ccc ;_ceeg =false ;};}else {_edfd =true ;};_dcde =_dddf .Append (_eafc .T .Content );_dcde .Style ,_ ,_ =_cfad .makeRunStyle (_gfgc ,false ,false ,false ,false ,false );};};};};};if _dddf !=nil {_fbfg (_gagcg ,_dddf );};};};};_efc .SetContent (_dddf );};};};_gbab :=1.0;if _aagfe :=_edc .TrPr ;_aagfe !=nil {if len (_aagfe .TrHeight )!=0{_adggg :=_aagfe .TrHeight [0];if _eab :=_adggg .ValAttr ;_eab !=nil {if _eab .ST_UnsignedDecimalNumber !=nil {_gbab =_faag (int64 (*_eab .ST_UnsignedDecimalNumber ));};};};};_dbeg .SetRowHeight (_dbeg .CurRow (),_gbab );};};_bede :=0.0;_gbea :=true ;if _ebae :=_abbe .Jc ;_ebae !=nil {_gbea =_ebae .ValAttr ==_bb .ST_JcTableLeft ;};if _gbea {if _dcdg :=_abbe .TblInd ;_dcdg !=nil {_bede =_cfded (_dcdg ,50);};};_cfeb :=1.0;_dbeg .SetMargins (_bede -1,0,_cfeb ,_cfeb );return _dbeg ;};const _bfb =(_cbfa -_dgeb )/2;func _ebba (_fdff *_bb .CT_PPr ,_gcddc *paragraph )(float64 ,float64 ){if _fdff ==nil {return 0,0;};if _fdff .Jc !=nil {switch _fdff .Jc .ValAttr {case _bb .ST_JcRight :_gcddc ._feg =_gf .TextAlignmentRight ;case _bb .ST_JcCenter :_gcddc ._feg =_gf .TextAlignmentCenter ;case _bb .ST_JcBoth :_gcddc ._feg =_gf .TextAlignmentJustify ;default:_gcddc ._feg =_gf .TextAlignmentLeft ;};};var _gdc ,_fgc ,_cabbb ,_ece ,_bga float64 ;_egg :=1.0;if _cdab :=_fdff .Spacing ;_cdab !=nil {if _eff :=_cdab .BeforeAttr ;_eff !=nil {if _eff .ST_UnsignedDecimalNumber !=nil {_gdc =_faag (int64 (*_eff .ST_UnsignedDecimalNumber ));};};if _cbf :=_cdab .AfterAttr ;_cbf !=nil {if _cbf .ST_UnsignedDecimalNumber !=nil {_fgc =_faag (int64 (*_cbf .ST_UnsignedDecimalNumber ));};};if _acde :=_cdab .LineAttr ;_acde !=nil {if _acde .Int64 !=nil &&*_acde .Int64 !=0{_egg =float64 (*_acde .Int64 /240);};};};if _adec :=_fdff .Ind ;_adec !=nil {if _bff :=_adec .FirstLineAttr ;_bff !=nil {if _bff .ST_UnsignedDecimalNumber !=nil {_bga =_faag (int64 (*_bff .ST_UnsignedDecimalNumber ));};};if _dgea :=_adec .HangingAttr ;_dgea !=nil {if _dgea .ST_UnsignedDecimalNumber !=nil {_bga -=_faag (int64 (*_dgea .ST_UnsignedDecimalNumber ));};};if _egdd :=_adec .LeftAttr ;_egdd !=nil {if _egdd .Int64 !=nil {_cabbb =_faag (*_egdd .Int64 );};};if _efdg :=_adec .RightAttr ;_efdg !=nil {if _efdg .Int64 !=nil {_ece =_faag (*_efdg .Int64 );};};};_gcddc ._fa =&rectangle {_eac :_gdc ,_caf :_fgc ,_deb :_cabbb ,_aebb :_ece };_gcddc ._fc =_bga ;_gcddc ._gb =_egg ;return _gdc ,_cabbb ;};func _dcab (_affbe *_gf .Creator ,_gaeac *rectangle ,_baac float64 ,_dcbec _gf .Color ){_dggf (_affbe ,_gaeac ._deb ,_gaeac ._eac ,_gaeac ._aebb ,_gaeac ._eac ,_baac ,_dcbec );_dggf (_affbe ,_gaeac ._deb ,_gaeac ._eac ,_gaeac ._deb ,_gaeac ._caf ,_baac ,_dcbec );_dggf (_affbe ,_gaeac ._deb ,_gaeac ._caf ,_gaeac ._aebb ,_gaeac ._caf ,_baac ,_dcbec );_dggf (_affbe ,_gaeac ._aebb ,_gaeac ._eac ,_gaeac ._aebb ,_gaeac ._caf ,_baac ,_dcbec );};func _aabaff (_cbfac *_gf .Creator ,_dea *_a .CT_PlotAreaChoice1 ,_aage ,_bfef ,_fge float64 ,_fegb []string ,_febf *rectangle ,_eced bool )error {if _dea ==nil {return _gd .New ("\u004e\u006f\u0020\u0061xi\u0073\u0020\u0069\u006e\u0066\u006f\u0072\u006d\u0061\u0074\u0069\u006f\u006e");};if len (_dea .ValAx )==0||(len (_dea .CatAx )==0&&len (_dea .DateAx )==0&&len (_dea .SerAx )==0){return _gd .New ("\u004e\u006f\u0020\u0078\u0020\u006f\u0072\u0020\u0079 \u0061\u0078\u0069\u0073");};var _bcfef ,_cdde ,_ebdb ,_eaba uint32 ;var _aabc ,_acea _a .ST_AxPos ;var _ebed ,_efcg _a .ST_TickMark ;var _cbfb ,_daaf *_a .CT_ChartLines ;var _dbde ,_bbga _a .ST_TickLblPos ;var _cadc ,_fabd *_bd .CT_ShapeProperties ;var _eeeee error ;if len (_dea .ValAx )> 0{_cdde ,_acea ,_efcg ,_bbga ,_daaf ,_eaba ,_fabd ,_eeeee =_fdde (_dea .ValAx [0]);};if _acea !=_a .ST_AxPosL {return _gd .New ("\u004f\u006e\u006cy\u0020\u006c\u0065\u0066t\u0020\u0079\u0020\u0061\u0078\u0069\u0073 \u0073\u0075\u0070\u0070\u006f\u0072\u0074\u0020\u0073\u006f\u0020\u0066\u0061\u0072");};_gga :=_febf ._aebb -_febf ._deb ;_dcgc :=_febf ._caf -_febf ._eac ;_cgfg :=_bfef -_aage ;_bbed :=int (_cgfg /_fge )+1;var _gdfg ,_ecgb float64 ;switch _efcg {case _a .ST_TickMarkIn :_gdfg ,_ecgb =1,0;case _a .ST_TickMarkOut :_gdfg ,_ecgb =0,1;case _a .ST_TickMarkCross :_gdfg ,_ecgb =1,1;};var _acded *_bd .CT_ShapeProperties ;if _daaf !=nil {_acded =_daaf .SpPr ;};_dacf ,_ggad :=_dbde !=_a .ST_TickLblPosNone ,_bbga !=_a .ST_TickLblPosNone ;_dbcf :=_aage ;if _eced {_ddac :=_gga /_cgfg ;_aega :=_febf ._caf -_gdfg ;_dbb :=_febf ._caf +_ecgb ;_fdbb :=_febf ._eac ;_gbfg :=_febf ._caf ;for _dgf :=0;_dgf < _bbed ;_dgf ++{_edbd :=_febf ._deb +(_dbcf -_aage )*_ddac ;_febbf (_cbfac ,_fabd ,_edbd ,_aega ,_edbd ,_dbb );_febbf (_cbfac ,_acded ,_edbd ,_fdbb ,_edbd ,_gbfg );if _ggad {_aead :=_cbfac .NewParagraph (_b .FormatFloat (_dbcf ,'g',-1,64));_aead .SetFontSize (2);_aead .SetPos (_edbd -0.5,_gbfg +1.5);_cbfac .Draw (_aead );};_dbcf +=_fge ;};}else {_ggac :=_dcgc /_cgfg ;_dec :=_febf ._deb -_ecgb ;_eeeb :=_febf ._deb +_gdfg ;_eaa :=_febf ._deb ;_agbe :=_febf ._aebb ;for _gfge :=0;_gfge < _bbed ;_gfge ++{_bfdf :=_febf ._caf -(_dbcf -_aage )*_ggac ;_febbf (_cbfac ,_fabd ,_dec ,_bfdf ,_eeeb ,_bfdf );_febbf (_cbfac ,_acded ,_eaa ,_bfdf ,_agbe ,_bfdf );if _ggad {_gcdb :=_cbfac .NewParagraph (_b .FormatFloat (_dbcf ,'g',-1,64));_gcdb .SetFontSize (2);_gcdb .SetPos (_eaa -5,_bfdf -1.5);_cbfac .Draw (_gcdb );};_dbcf +=_fge ;};};if len (_dea .CatAx )> 0{_bcfef ,_aabc ,_ebed ,_dbde ,_cbfb ,_ebdb ,_cadc ,_eeeee =_gadd (_dea .CatAx [0]);}else if len (_dea .DateAx )> 0{_bcfef ,_aabc ,_ebed ,_dbde ,_cbfb ,_ebdb ,_cadc ,_eeeee =_fdca (_dea .DateAx [0]);}else if len (_dea .SerAx )> 0{_bcfef ,_aabc ,_ebed ,_dbde ,_cbfb ,_ebdb ,_cadc ,_eeeee =_dced (_dea .SerAx [0]);};if _eeeee !=nil {return _eeeee ;};if _aabc !=_a .ST_AxPosB {return _gd .New ("\u004f\u006e\u006c\u0079\u0020\u0062o\u0074\u0074\u006f\u006d\u0020\u0078\u0020\u0061\u0078\u0069\u0073\u0020\u0073u\u0070\u0070\u006f\u0072\u0074\u0020\u0073o\u0020\u0066\u0061\u0072");};if _bcfef !=_eaba ||_cdde !=_ebdb {return _gd .New ("a\u0078i\u0073\u0020\u0069\u0064\u0073\u0020\u0064\u006fn\u0027\u0074\u0020\u006dat\u0063\u0068");};_ccffe :=len (_fegb )+1;var _faga ,_feee float64 ;switch _ebed {case _a .ST_TickMarkIn :_faga ,_feee =1,0;case _a .ST_TickMarkOut :_faga ,_feee =0,1;case _a .ST_TickMarkCross :_faga ,_feee =1,1;};var _ccfa *_bd .CT_ShapeProperties ;if _cbfb !=nil {_ccfa =_cbfb .SpPr ;};if _eced {_ggcc :=_dcgc /float64 (len (_fegb ));_dbbb :=_febf ._deb -_aage *_gga /_cgfg ;_cgfd :=_dbbb -_feee ;_egdba :=_dbbb +_faga ;_eafe :=_febf ._deb ;_gcfbe :=_febf ._aebb ;_dgbg :=_dbbb -7.5;for _cfcd :=0;_cfcd < _ccffe ;_cfcd ++{_bffe :=_febf ._caf -float64 (_cfcd )*_ggcc ;_febbf (_cbfac ,_cadc ,_cgfd ,_bffe ,_egdba ,_bffe );_febbf (_cbfac ,_ccfa ,_eafe ,_bffe ,_gcfbe ,_bffe );if _dacf &&_cfcd < _ccffe -1{_cabfg :=_cbfac .NewParagraph (_fegb [_cfcd ]);_cabfg .SetFontSize (2);_cabfg .SetPos (_dgbg ,_bffe -_ggcc /2-2);_cbfac .Draw (_cabfg );};};}else {_ggadg :=_gga /float64 (len (_fegb ));_aeda :=_febf ._caf +_aage *_dcgc /_cgfg ;_cabg :=_aeda -_faga ;_fad :=_aeda +_feee ;_cacaa :=_febf ._eac ;_gcfa :=_febf ._caf ;_cgb :=_aeda +1.5;for _efa :=0;_efa < _ccffe ;_efa ++{_dbegb :=_febf ._deb +float64 (_efa )*_ggadg ;_febbf (_cbfac ,_cadc ,_dbegb ,_cabg ,_dbegb ,_fad );_febbf (_cbfac ,_ccfa ,_dbegb ,_cacaa ,_dbegb ,_gcfa );if _dacf &&_efa < _ccffe -1{_bec :=_cbfac .NewParagraph (_fegb [_efa ]);_bec .SetFontSize (2);_bec .SetPos (_dbegb +5,_cgb );_cbfac .Draw (_bec );};};};return nil ;};const _da =0.67;func (_fgaf *convertContext )addEndnotes (){for _dcdeb ,_bcfe :=range _fgaf ._gaffe {if _dcdeb ==0{_fgaf .addSeparator ();};_fgaf ._fbccc =&prefix {_dbac :_bcfe ._fb };for _fbea ,_edag :=range _bcfe ._ggc {if _dcdeb !=0||_fbea !=0{_fgaf ._cffb =true ;};_fgaf .addAbsoluteCBCs (_edag .EG_ContentBlockContent );};};_fgaf ._cffb =false ;};func _dggf (_fgafd *_gf .Creator ,_geaf ,_ddfd ,_cecg ,_afed ,_ffge float64 ,_cfgg _gf .Color ){_gccg :=_fgafd .NewLine (_geaf ,_ddfd ,_cecg ,_afed );_gccg .SetLineWidth (_ffge );_gccg .SetColor (_cfgg );_fgafd .Draw (_gccg );};type page struct{_ag *rectangle ;_bbb []*paragraph ;_fe float64 ;_cf []*zoneToSkip ;_ff []*_gf .Image ;_ga []*_gf .Image ;_ge []*block ;_eb []*block ;_gac []*note ;_eg bool ;};func (_eef *convertContext )alignParagraph (){_abc :=_eef ._bcaf ;if _abc ._feg ==_gf .TextAlignmentLeft {return ;};_fcg :=len (_abc ._dd )-1;for _fcb ,_dad :=range _abc ._dd {_fee :=len (_dad ._fbd )-1;for _eeg ,_ebg :=range _dad ._fbd {_cgcf :=true ;_fec :=len (_ebg ._daa );_gfd :=0.0;for _bfeg :=len (_ebg ._daa )-1;_bfeg >=0;_bfeg --{_ffe :=_ebg ._daa [_bfeg ];if _cgcf &&_ffe ._gbd {_fec =_bfeg ;}else {_cgcf =false ;for _ ,_adgg :=range _ffe ._bf {_gfd +=_adgg ._bc ;};};};_ebg ._daa =_ebg ._daa [:_fec ];_aag :=_ebg ._fg -_ebg ._cce -_gfd ;switch _abc ._feg {case _gf .TextAlignmentRight :_ebg .moveRight (_aag );case _gf .TextAlignmentCenter :_ebg .moveRight (_aag /2);case _gf .TextAlignmentJustify :if _fcb !=_fcg ||_eeg !=_fee {_cdc :=[]*word {};for _ ,_dfe :=range _ebg ._daa {if _dfe ._gbd {_cdc =append (_cdc ,_dfe );};};_abd :=_aag /float64 (len (_cdc ));for _ ,_acd :=range _cdc {_acd ._de +=_abd ;};var _cbgd *word ;for _ ,_aba :=range _ebg ._daa {if _cbgd !=nil {_aba ._eca =_cbgd ._eca +_cbgd ._de ;};_cbgd =_aba ;};};};};};};func (_feaae *convertContext )newParagraph (){if _feaae ._aadd ==nil {_feaae .newPage ();};_bbfe :=&paragraph {};_bbfe ._fa =&rectangle {};_bbfe ._ebf =_feaae ._aadd ._fe ;_feaae ._bcaf =_bbfe ;};func _gadd (_ebfc *_a .CT_CatAx )(uint32 ,_a .ST_AxPos ,_a .ST_TickMark ,_a .ST_TickLblPos ,*_a .CT_ChartLines ,uint32 ,*_bd .CT_ShapeProperties ,error ){var _cdgg ,_fccb uint32 ;var _fac _a .ST_AxPos ;var _abf _a .ST_TickMark ;var _dgebd *_a .CT_ChartLines ;var _dfdf _a .ST_TickLblPos ;if _ebfc .AxId ==nil {return _cdgg ,_fac ,_abf ,_dfdf ,_dgebd ,_fccb ,_ebfc .SpPr ,_gd .New ("\u004e\u006f\u0020x\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");}else {_cdgg =_ebfc .AxId .ValAttr ;};if _ebfc .AxPos ==nil {return _cdgg ,_fac ,_abf ,_dfdf ,_dgebd ,_fccb ,_ebfc .SpPr ,_gd .New ("\u004eo\u0020x\u0020\u0061\u0078\u0069\u0073 \u0070\u006fs\u0069\u0074\u0069\u006f\u006e");}else {_fac =_ebfc .AxPos .ValAttr ;};if _ebfc .MajorTickMark !=nil {_abf =_ebfc .MajorTickMark .ValAttr ;};if _ebfc .TickLblPos !=nil {_dfdf =_ebfc .TickLblPos .ValAttr ;};if _ebfc .CrossAx ==nil {return _cdgg ,_fac ,_abf ,_dfdf ,_dgebd ,_fccb ,_ebfc .SpPr ,_gd .New ("\u004e\u006f \u0063\u0072\u006fs\u0073\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");}else {_fccb =_ebfc .CrossAx .ValAttr ;};_dgebd =_ebfc .MajorGridlines ;return _cdgg ,_fac ,_abf ,_dfdf ,_dgebd ,_fccb ,_ebfc .SpPr ,nil ;};func _bba (_feed *_gf .Creator ,_fgag *_a .CT_BarChart ,_bgb *rectangle ,_fddd *_a .CT_PlotAreaChoice1 )([]*legendItem ,error ){var _dacb bool ;if _dgd :=_fgag .BarDir ;_dgd !=nil {_dacb =_dgd .ValAttr ==_a .ST_BarDirBar ;};_bgaa :=_fgag .Ser ;_cg .Sort (barSerByOrder (_bgaa ));_accc :=map[string ]serCategory {};_dfb :=[]string {};_gefb :=[]*legendItem {};_cabbc :=_ce .Inf (1);_cadg :=_ce .Inf (-1);for _ ,_aab :=range _bgaa {var _ccd string ;if _bedb :=_aab .Tx ;_bedb !=nil {if _eegef :=_bedb .Choice ;_eegef !=nil {if _eegef .V !=nil {_ccd =*_eegef .V ;}else if _fegaa :=_eegef .StrRef ;_fegaa !=nil {if _eea :=_fegaa .StrCache ;_eea !=nil {for _ ,_edfb :=range _eea .Pt {_ccd =_edfb .V ;};};};};};if _gfe :=_aab .Cat ;_gfe !=nil {if _afbf :=_gfe .Choice ;_afbf !=nil {if _egdff :=_afbf .StrRef ;_egdff !=nil {if _bgdf :=_egdff .StrCache ;_bgdf !=nil {for _ ,_acecg :=range _bgdf .Pt {_edcd :=_acecg .V ;if _ ,_ebeeb :=_accc [_edcd ];!_ebeeb {_accc [_edcd ]=serCategory {_gedg :_edcd ,_cfga :[]serValue {}};_dfb =append (_dfb ,_edcd );};};};};};};if _aaba :=_aab .Val ;_aaba !=nil {if _agc :=_aaba .Choice ;_agc !=nil {if _ecef :=_agc .NumRef ;_ecef !=nil {if _dbdg :=_ecef .NumCache ;_dbdg !=nil {for _ffaed ,_adc :=range _dbdg .Pt {_ccff ,_afbg :=_b .ParseFloat (_adc .V ,64);if _afbg !=nil {_ccff =0;_e .Println ("\u0070\u0061\u0072s\u0065\u0020\u0065\u0072\u0072\u006f\u0072\u003a",_afbg );};if _ccff > _cadg {_cadg =_ccff ;};if _ccff < _cabbc {_cabbc =_ccff ;};_eabg :=_accc [_dfb [_ffaed ]];_eabg ._cfga =append (_eabg ._cfga ,serValue {_bbbd :_ccd ,_bbgc :_ccff ,_cge :_aab .SpPr });_accc [_dfb [_ffaed ]]=_eabg ;};};};};};_gefb =append (_gefb ,&legendItem {_cfd :_ccd ,_egfd :_aab .SpPr });};var _bccg float64 ;var _gede ,_bab float64 ;if _cadg ==0&&_cabbc ==0{_bccg =0.2;_bab =0;_gede =1;}else {var _afbcf float64 ;if _bca :=_ce .Abs (_cabbc );_cadg < _bca {_afbcf =_bca ;}else {_afbcf =_cadg ;};_dca :=_ce .Pow (10,_ce .Floor (_ce .Log10 (_afbcf )));_acb :=_afbcf /_dca ;if _acb >=1.715&&_acb < 4.29{_bccg =0.5;}else if _acb >=4.29&&_acb < 8.58{_bccg =1;}else {_bccg =2;};_bccg *=_dca ;if _cadg <=0{_gede =0;}else {_gede =(_ce .Ceil (_cadg /_bccg )+1)*_bccg ;};if _cabbc >=0{_bab =0;}else {_bab =(_ce .Floor (_cabbc /_bccg )-1)*_bccg ;};};_cacd :=_aabaff (_feed ,_fddd ,_bab ,_gede ,_bccg ,_dfb ,_bgb ,_dacb );if _cacd !=nil {return nil ,_cacd ;};_edga :=0.0;if _fgag .GapWidth !=nil {if _gabg :=_fgag .GapWidth .ValAttr ;_gabg !=nil {if _adfg :=_gabg .ST_GapAmountUShort ;_adfg !=nil {_edga =float64 (*_adfg )/100.0;};};};_dbab :=_bgb ._aebb -_bgb ._deb ;_edfcf :=_bgb ._caf -_bgb ._eac ;_bcfb :=float64 (len (_dfb ));if _dacb {_fbgf :=_gede /(_gede -_bab )*_dbab ;_aef :=-_bab /(_gede -_bab )*_dbab ;_fdfg :=_bgb ._deb +_aef ;_gacaf :=_edfcf /_bcfb ;for _bbc ,_eaff :=range _dfb {_caab :=_accc [_eaff ];_dcce :=float64 (len (_caab ._cfga ))+_edga ;_ccb :=_gacaf /_dcce ;_acfg :=_ccb *_edga ;_bccga :=_bgb ._caf -float64 (_bbc )*_gacaf -_acfg /2-_ccb ;for _ ,_cdgf :=range _caab ._cfga {var _degg ,_ggfc float64 ;if _cdgf ._bbgc > 0{_ggfc =_cdgf ._bbgc /_gede *_fbgf ;_agea (_feed ,_fdfg ,_bccga ,_ggfc ,_ccb ,_cdgf ._cge );}else {_ggfc =_cdgf ._bbgc /_bab *_aef ;_degg =_fdfg -_ggfc ;_agea (_feed ,_degg ,_bccga ,_ggfc ,_ccb ,nil );};_bccga -=_ccb ;};};}else {_agac :=_gede /(_gede -_bab )*_edfcf ;_agab :=-_bab /(_gede -_bab )*_edfcf ;_ccgfb :=_bgb ._eac +_agac ;_ede :=_dbab /_bcfb ;for _gddg ,_fdec :=range _dfb {_dadd :=_accc [_fdec ];_gfgf :=float64 (len (_dadd ._cfga ))+_edga ;_fded :=_ede /_gfgf ;_efcc :=_fded *_edga ;_fcad :=_bgb ._deb +float64 (_gddg )*_ede +_efcc /2;for _ ,_aff :=range _dadd ._cfga {var _eeac ,_dcbb float64 ;if _aff ._bbgc > 0{_dcbb =_aff ._bbgc /_gede *_agac ;_eeac =_ccgfb -_dcbb ;_agea (_feed ,_fcad ,_eeac ,_fded ,_dcbb ,_aff ._cge );}else {_dcbb =_aff ._bbgc /_bab *_agab ;_agea (_feed ,_fcad ,_ccgfb ,_fded ,_dcbb ,nil );};_fcad +=_fded ;};};};return _gefb ,nil ;};type span struct{_cce float64 ;_fg float64 ;_daa []*word ;};

// ConvertToPdf converts document to PDF file. This package is beta, breaking changes can take place.
func ConvertToPdf (d *_ee .Document )*_gf .Creator {_bgdfb :=d .BodySection ().X ();var _gecb ,_bge ,_gfgeb ,_fddgb ,_eebb ,_aeca float64 ;_gbed :=_bgdfb .PgMar ;if _gbed .LeftAttr .ST_UnsignedDecimalNumber !=nil {_gecb =_faag (int64 (*_gbed .LeftAttr .ST_UnsignedDecimalNumber ));};if _gbed .LeftAttr .ST_UnsignedDecimalNumber !=nil {_bge =_faag (int64 (*_gbed .RightAttr .ST_UnsignedDecimalNumber ));};if _gbed .TopAttr .Int64 !=nil {_gfgeb =_faag (*_gbed .TopAttr .Int64 );};if _gbed .BottomAttr .Int64 !=nil {_fddgb =_faag (*_gbed .BottomAttr .Int64 );};_affb :=_bgdfb .PgSz ;_ecdd ,_ebcd :=210.0,297.0;if _affb .WAttr !=nil {_ecdd =_faag (int64 (*_affb .WAttr .ST_UnsignedDecimalNumber ));};if _affb .HAttr !=nil {_ebcd =_faag (int64 (*_affb .HAttr .ST_UnsignedDecimalNumber ));};if _gbed .HeaderAttr .ST_UnsignedDecimalNumber !=nil {_eebb =_faag (int64 (*_gbed .HeaderAttr .ST_UnsignedDecimalNumber ));};if _gbed .FooterAttr .ST_UnsignedDecimalNumber !=nil {_aeca =_fddgb -_faag (int64 (*_gbed .FooterAttr .ST_UnsignedDecimalNumber ));};_edcg =_faag (int64 (*d .Settings .X ().DefaultTabStop .ValAttr .ST_UnsignedDecimalNumber ));_ffd :=_gf .New ();_ffd .SetPageSize (_gf .PageSize {_ecdd ,_ebcd });_ffd .SetPageMargins (_gecb ,_bge ,_gfgeb ,_fddgb );for _ ,_dgeg :=range d .Headers (){_dcgd :=&convertContext {_ggd :_ffd ,_ceda :d ,_fcbe :true ,_dcdb :_gecb ,_edfdd :_eebb };_dcgd .addRelativeCBCs (_dgeg .X ().EG_ContentBlockContent );};for _ ,_cba :=range d .Footers (){_bcge :=&convertContext {_ggd :_ffd ,_ceda :d ,_ccce :true ,_dcdb :_gecb ,_bfeb :_aeca };_bcge .addRelativeCBCs (_cba .X ().EG_ContentBlockContent );};_gacb :=&convertContext {_ggd :_ffd ,_ceda :d ,_bcecg :&rectangle {_eac :_gfgeb ,_caf :_ebcd -_fddgb ,_deb :_gecb ,_aebb :_ecdd -_bge },_gaffe :[]note {}};for _ ,_dccf :=range d .X ().Body .EG_BlockLevelElts {_gacb .addAbsoluteCBCs (_dccf .EG_ContentBlockContent );};_gacb .addEndnotes ();_gacb .alignSymbolsVertically ();_gacb .drawPages ();return _ffd ;};func (_fdba *convertContext )makeRunStyle (_caeb *_bb .CT_RPr ,_caebg ,_agce ,_gfadb ,_dbgc ,_gecbd bool )(_gf .TextStyle ,bool ,bool ){_befac :=_fdba ._ggd .NewTextStyle ();if _caeb !=nil {_cacg :=0;_cbga :=_ddfg (_caeb .B );_dadc :=_ddfg (_caeb .I );if _cbga &&_dadc {_cacg =3;}else if _cbga {_cacg =1;}else if _dadc {_cacg =2;};if _gecbd {_befac .Underline =true ;_befac .UnderlineStyle =_gf .TextDecorationLineStyle {Offset :0.5,Thickness :1/32};};if _caeb .U !=nil &&_caeb .U .ValAttr !=_bb .ST_UnderlineNone &&!_dbgc {_befac .Underline =true ;_befac .UnderlineStyle =_gf .TextDecorationLineStyle {Offset :0.5,Thickness :1/32};if _gcge :=_caeb .U .ColorAttr ;_gcge !=nil {if _bcda :=_gcge .ST_HexColorRGB ;_bcda !=nil {_befac .UnderlineStyle .Color =_gf .ColorRGBFromHex ("\u0023"+*_bcda );};};};var _cdfe string ;if _dbgc {_cdfe ="\u0053\u0079\u006d\u0062\u006f\u006c";}else {_afcc :="\u0064e\u0066\u0061\u0075\u006c\u0074";if _gcegd :=_caeb .RFonts ;_gcegd !=nil {if _adecc :=_gcegd .AsciiAttr ;_adecc !=nil {_afcc =*_adecc ;}else if _egedd :=_gcegd .HAnsiAttr ;_egedd !=nil {_afcc =*_egedd ;};};_fbcb ,_dbaf :=_aabe [_afcc ];if !_dbaf {_fbcb =_aabe ["\u0064e\u0066\u0061\u0075\u006c\u0074"];};_cdfe =_fbcb [_cacg ];};_bgeg :=_f .StdFontName (_cdfe );_befac .Font =_f .NewStandard14FontMustCompile (_bgeg );var _fcfa float64 ;_ebcc :=_gceg ;if _ffbd :=_caeb .Sz ;_ffbd !=nil {_fcfa =float64 (*_ffbd .ValAttr .ST_UnsignedDecimalNumber );}else if _agf :=_caeb .SzCs ;_agf !=nil {_fcfa =float64 (*_agf .ValAttr .ST_UnsignedDecimalNumber );};if _fcfa !=0{_ebcc =_fcfa /24*_gceg ;};if _fdaedc :=_caeb .VertAlign ;_fdaedc !=nil {_egeg :=_fdaedc .ValAttr ;_caebg =_egeg ==_gg .ST_VerticalAlignRunSuperscript ;_agce =_egeg ==_gg .ST_VerticalAlignRunSubscript ;};if _ebcc > _fdba ._gagbg {_fdba ._gagbg =_ebcc ;};if _caebg ||_agce {_ebcc *=0.64;};if _gfadb {if _caebg {_befac .TextRise =1.5;};if _agce {_befac .TextRise =-1.5;};};_befac .FontSize =_ebcc ;_cfgb :=0.0;if _fced :=_caeb .Spacing ;_fced !=nil {_cfgb =_faag (*_fced .ValAttr .Int64 );};_befac .CharSpacing =_cfgb ;_aded :=_gf .ColorBlack ;if _caeb .Color !=nil {_acfa :=_caeb .Color .ValAttr .ST_HexColorRGB ;if _acfa !=nil {_aded =_gf .ColorRGBFromHex ("\u0023"+*_acfa );};};if _gfadb {_ceaa ,_dfcd ,_cedae :=_aded .ToRGB ();_ceaa ,_dfcd ,_cedae =_eaga (_ceaa ),_eaga (_dfcd ),_eaga (_cedae );_aded =_gf .ColorRGBFromArithmetic (_ceaa ,_dfcd ,_cedae );};_befac .Color =_aded ;};return _befac ,_caebg ,_agce ;};type legendItem struct{_cfd string ;_egfd *_bd .CT_ShapeProperties ;};func _gecd (_bcada int64 ,_eaec _bb .ST_NumberFormat )string {_caea :=int (_bcada );switch _eaec {case _bb .ST_NumberFormatDecimal :return _b .Itoa (_caea );case _bb .ST_NumberFormatUpperRoman :return _dbadc (_caea ,true );case _bb .ST_NumberFormatLowerRoman :return _dbadc (_caea ,false );case _bb .ST_NumberFormatUpperLetter :return _eeca (_caea ,true );case _bb .ST_NumberFormatLowerLetter :return _eeca (_caea ,false );default:return _b .Itoa (_caea );};};const _bbeg =0.125;const _bcgd =2.5;func (_cabf *convertContext )addInlineSymbol (_dcg *symbol ){if len (_cabf ._gcbb ._bf )> 0{_fbg :=_cabf ._gcbb ._bf [len (_cabf ._gcbb ._bf )-1]._dda ;if _fbg =="\u0020"{_cabf .addCurrentWordToParagraph ();_cabf .newWord ();};};_cabf ._gcbb ._bf =append (_cabf ._gcbb ._bf ,_dcg );_dcg ._dfc =_cabf ._gcbb ._de ;_cabf ._gcbb ._de +=_dcg ._bc ;_cabf ._gcbb ._gbd =false ;if _cabf ._feefa ._bdf < _dcg ._cef {_cabf ._bcaf ._gacc +=(_dcg ._cef -_cabf ._feefa ._bdf );_cabf ._feefa ._bdf =_dcg ._cef ;};};func _fdca (_eecg *_a .CT_DateAx )(uint32 ,_a .ST_AxPos ,_a .ST_TickMark ,_a .ST_TickLblPos ,*_a .CT_ChartLines ,uint32 ,*_bd .CT_ShapeProperties ,error ){var _aagff ,_cfb uint32 ;var _ffbe _a .ST_AxPos ;var _gfgb _a .ST_TickMark ;var _dgda *_a .CT_ChartLines ;var _acbf _a .ST_TickLblPos ;if _eecg .AxId ==nil {return _aagff ,_ffbe ,_gfgb ,_acbf ,_dgda ,_cfb ,_eecg .SpPr ,_gd .New ("\u004e\u006f\u0020x\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");}else {_aagff =_eecg .AxId .ValAttr ;};if _eecg .AxPos ==nil {return _aagff ,_ffbe ,_gfgb ,_acbf ,_dgda ,_cfb ,_eecg .SpPr ,_gd .New ("\u004eo\u0020x\u0020\u0061\u0078\u0069\u0073 \u0070\u006fs\u0069\u0074\u0069\u006f\u006e");}else {_ffbe =_eecg .AxPos .ValAttr ;};if _eecg .MajorTickMark !=nil {_gfgb =_eecg .MajorTickMark .ValAttr ;};if _eecg .TickLblPos !=nil {_acbf =_eecg .TickLblPos .ValAttr ;};if _eecg .CrossAx ==nil {return _aagff ,_ffbe ,_gfgb ,_acbf ,_dgda ,_cfb ,_eecg .SpPr ,_gd .New ("\u004e\u006f \u0063\u0072\u006fs\u0073\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");}else {_cfb =_eecg .CrossAx .ValAttr ;};_dgda =_eecg .MajorGridlines ;return _aagff ,_ffbe ,_gfgb ,_acbf ,_dgda ,_cfb ,_eecg .SpPr ,nil ;};func _fdde (_ffaee *_a .CT_ValAx )(uint32 ,_a .ST_AxPos ,_a .ST_TickMark ,_a .ST_TickLblPos ,*_a .CT_ChartLines ,uint32 ,*_bd .CT_ShapeProperties ,error ){var _adb ,_gdbga uint32 ;var _aaec _a .ST_AxPos ;var _gae _a .ST_TickMark ;var _aec *_a .CT_ChartLines ;var _gbdb _a .ST_TickLblPos ;if _ffaee .AxId ==nil {return _adb ,_aaec ,_gae ,_gbdb ,_aec ,_gdbga ,_ffaee .SpPr ,_gd .New ("\u004e\u006f\u0020x\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");}else {_adb =_ffaee .AxId .ValAttr ;};if _ffaee .AxPos ==nil {return _adb ,_aaec ,_gae ,_gbdb ,_aec ,_gdbga ,_ffaee .SpPr ,_gd .New ("\u004eo\u0020x\u0020\u0061\u0078\u0069\u0073 \u0070\u006fs\u0069\u0074\u0069\u006f\u006e");}else {_aaec =_ffaee .AxPos .ValAttr ;};if _ffaee .MajorTickMark !=nil {_gae =_ffaee .MajorTickMark .ValAttr ;};if _ffaee .TickLblPos !=nil {_gbdb =_ffaee .TickLblPos .ValAttr ;};if _ffaee .CrossAx ==nil {return _adb ,_aaec ,_gae ,_gbdb ,_aec ,_gdbga ,_ffaee .SpPr ,_gd .New ("\u004e\u006f \u0063\u0072\u006fs\u0073\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");}else {_gdbga =_ffaee .CrossAx .ValAttr ;};_aec =_ffaee .MajorGridlines ;return _adb ,_aaec ,_gae ,_gbdb ,_aec ,_gdbga ,_ffaee .SpPr ,nil ;};func _eaga (_dega float64 )float64 {return 0.6+0.4*_dega };func (_gca *convertContext )newPage (){_egag :=&page {};_egag ._ag =_gca ._bcecg ;_egag ._fe =_egag ._ag ._eac ;if _gca ._cffb {_egag ._eg =true ;_egag ._fe +=_ad ;};_gca ._bcbf =append (_gca ._bcbf ,_egag );_gca ._aadd =_egag ;};var _ecba =[]romanMatch {romanMatch {1000,"\u006d"},romanMatch {900,"\u0063\u006d"},romanMatch {500,"\u0064"},romanMatch {400,"\u0063\u0064"},romanMatch {100,"\u0063"},romanMatch {90,"\u0078\u0063"},romanMatch {50,"\u006c"},romanMatch {40,"\u0078\u006c"},romanMatch {10,"\u0078"},romanMatch {9,"\u0069\u0078"},romanMatch {5,"\u0076"},romanMatch {4,"\u0069\u0076"},romanMatch {1,"\u0069"}};type convertContext struct{_ggd *_gf .Creator ;_ceda *_ee .Document ;_aaga *_gf .StyledParagraph ;_bcbf []*page ;_aadd *page ;_bcecg *rectangle ;_bcaf *paragraph ;_bagd *rectangle ;_feefa *line ;_cfgc *span ;_gcbb *word ;_bbbg *_bb .CT_Hyperlink ;_fceg *_bb .CT_ParaRPr ;_gaffe []note ;_fbccc *prefix ;_bbfa bool ;_fcbe bool ;_ccce bool ;_dcdb float64 ;_edfdd float64 ;_bfeb float64 ;_gagbg float64 ;_cffb bool ;_fbfa map[int64 ]map[int64 ]int ;};func _fdeg (_agee *_bb .CT_PPr ,_fcgf *_bb .CT_PPrGeneral ,_acda *_bb .CT_RPr )*_bb .CT_PPr {if _fcgf !=nil {if _agee .Jc ==nil &&_fcgf .Jc !=nil {_agee .Jc =_fcgf .Jc ;};if _agee .Spacing ==nil &&_fcgf .Spacing !=nil {_agee .Spacing =_fcgf .Spacing ;};if _fcgf .Ind !=nil {if _agee .Ind ==nil {_agee .Ind =_fcgf .Ind ;}else {_bee ,_bcdg :=_agee .Ind .FirstLineAttr ==nil ,_agee .Ind .HangingAttr ==nil ;if _bee &&_bcdg &&_fcgf .Ind .FirstLineAttr !=nil {_agee .Ind .FirstLineAttr =_fcgf .Ind .FirstLineAttr ;_bee =false ;};if _bee &&_bcdg &&_fcgf .Ind .HangingAttr !=nil {_agee .Ind .HangingAttr =_fcgf .Ind .HangingAttr ;};if _agee .Ind .LeftAttr ==nil {_agee .Ind .LeftAttr =_fcgf .Ind .LeftAttr ;};if _agee .Ind .RightAttr ==nil {_agee .Ind .RightAttr =_fcgf .Ind .RightAttr ;};};};if _agee .Tabs ==nil &&_fcgf .Tabs !=nil {_agee .Tabs =_fcgf .Tabs ;};};if _acda !=nil {var _fgb _bb .CT_ParaRPr ;if _agee .RPr ==nil {_fgb =*_bb .NewCT_ParaRPr ();}else {_fgb =*_agee .RPr ;};if _fgb .Color ==nil &&_acda .Color !=nil {_fgb .Color =_acda .Color ;};if _fgb .Spacing ==nil &&_acda .Spacing !=nil {_fgb .Spacing =_acda .Spacing ;};if _fgb .Sz ==nil &&_acda .Sz !=nil {_fgb .Sz =_acda .Sz ;};if _fgb .SzCs ==nil &&_acda .SzCs !=nil {_fgb .SzCs =_acda .SzCs ;};if _fgb .B ==nil &&_acda .B !=nil {_fgb .B =_acda .B ;};if _fgb .I ==nil &&_acda .I !=nil {_fgb .I =_acda .I ;};if _fgb .RFonts ==nil &&_acda .RFonts !=nil {_fgb .RFonts =_acda .RFonts ;};if _fgb .VertAlign ==nil &&_acda .VertAlign !=nil {_fgb .VertAlign =_acda .VertAlign ;};_agee .RPr =&_fgb ;};return _agee ;};const _gceg =4.25;func _dbadc (_dbca int ,_aaff bool )string {_fecfe :=_dg .NewBuffer ([]byte {});for _ ,_aecc :=range _ecba {for {if _dbca < _aecc ._acff {break ;};_fecfe .WriteString (_aecc ._ffgfe );_dbca -=_aecc ._acff ;};};_acgg :=_fecfe .String ();if _aaff {_acgg =_g .ToUpper (_acgg );};return _acgg ;};func (_ca *convertContext )drawPages (){for _ ,_afe :=range _ca ._bcbf {_ca ._ggd .NewPage ();_ca .drawPage (_afe );};};const _ad =6;type symbol struct{_dda string ;_dfc float64 ;_cef float64 ;_aa float64 ;_bc float64 ;_gab *_gf .TextStyle ;_cefg *_gf .Image ;_fcc *block ;_dcc string ;_gbe bool ;_dccg bool ;};func _acga (_gdfd *_gf .Creator )(*_gf .Block ,error ){_bdgaa :=_dg .NewBuffer ([]byte {});_faee :=_gdfd .Write (_bdgaa );if _faee !=nil {return nil ,_faee ;};_ageeg :=_dg .NewReader (_bdgaa .Bytes ());_agfe ,_faee :=_f .NewPdfReader (_ageeg );if _faee !=nil {return nil ,_faee ;};_begd ,_faee :=_agfe .GetPage (1);if _faee !=nil {return nil ,_faee ;};_ffbeg ,_faee :=_gf .NewBlockFromPage (_begd );if _faee !=nil {return nil ,_faee ;};return _ffbeg ,nil ;};func (_fecfd *convertContext )makeBlockFromWdWsp (_gfeg *_bb .WdWsp )(*block ,error ){if _aadb :=_gfeg .WChoice ;_aadb !=nil {if _fcbf :=_aadb .Txbx ;_fcbf !=nil {if _dadf :=_fcbf .TxbxContent ;_dadf !=nil {if _cgg :=_dadf .EG_ContentBlockContent ;len (_cgg )> 0{if _dcad :=_gfeg .SpPr ;_dcad !=nil {if _eabf :=_dcad .Xfrm ;_eabf !=nil {if _aedg :=_eabf .Ext ;_aedg !=nil {_eacg :=_ec .FromEMU (_aedg .CxAttr )/_ec .Millimeter ;_cfea :=_ec .FromEMU (_aedg .CyAttr )/_ec .Millimeter ;_gbbg :=&rectangle {_eac :_bcgd ,_caf :_bcgd ,_deb :_bcgd ,_aebb :_bcgd };_bbcg ,_gfed :=_fecfd .makePdfBlockFromCBCs ([][]*_bb .EG_ContentBlockContent {_cgg },_eacg ,_cfea ,_gbbg ,false ,nil );if _gfed !=nil {return nil ,_gfed ;};var _caga bool ;var _bbaa float64 ;var _ceed _gf .Color ;if _dfbe :=_dcad .PrstGeom ;_dfbe !=nil {if _dfbe .PrstAttr ==_bd .ST_ShapeTypeRect {if _eedg :=_dcad .Ln ;_eedg !=nil {if _dbdb :=_eedg .WAttr ;_dbdb !=nil {_caga =true ;_bbaa =_ec .FromEMU (int64 (*_dbdb ))/_ec .Millimeter ;_ceed =_gf .ColorBlack ;if _dfega :=_eedg .SolidFill ;_dfega !=nil {if _ddeg :=_dfega .SrgbClr ;_ddeg !=nil {_ceed =_gf .ColorRGBFromHex ("\u0023"+_ddeg .ValAttr );};};};};};};_dgce :=&block {_gff :_bbcg ,_adg :_caga ,_cbg :_bbaa ,_fef :_ceed };return _dgce ,nil ;};};};};};};};return nil ,nil ;};func _egda (_cdaba ,_decf *_bb .CT_Border ,_dcbe bool )*_bb .CT_Border {if _dcbe {return _cdaba ;};return _decf ;};type word struct{_bf []*symbol ;_eca float64 ;_de float64 ;_gbd bool ;};func (_ecgf *convertContext )addRelativeCBCs (_eega []*_bb .EG_ContentBlockContent ){for _ ,_bcde :=range _eega {_ecgf .addHdrFtr (_bcde .P );};};type romanMatch struct{_acff int ;_ffgfe string ;};func (_afef *convertContext )determineParagraphBounds (){_afef ._bcaf ._dac =_afef ._aadd ._ag ._deb +_afef ._bcaf ._fa ._deb ;_afef ._bcaf ._fag =_afef ._bcaf ._dac +_afef ._bcaf ._fc ;_afef ._bcaf ._bdg =_afef ._aadd ._ag ._aebb -_afef ._bcaf ._fa ._aebb ;};func (_bgfb *convertContext )addRelativeCRC (_egcf []*_bb .EG_ContentRunContent ,_bagdf *_bb .CT_PPr ){for _ ,_gcffc :=range _egcf {if _bfac :=_gcffc .R ;_bfac !=nil {_dgba :=_fgcg (_bgfb ._ceda ,_bfac .RPr ,_bagdf );if _bgfb ._fbccc !=nil {_bgfb .addRelativeRIC (nil ,_dgba );_bgfb ._fbccc =nil ;};for _ ,_fgeg :=range _bfac .EG_RunInnerContent {_bgfb .addRelativeRIC (_fgeg ,_dgba );};};};};func _febbf (_defa *_gf .Creator ,_aaddf *_bd .CT_ShapeProperties ,_dabg ,_cdcc ,_acdf ,_fdcfd float64 ){if _aaddf !=nil {if _edab :=_aaddf .Ln ;_edab !=nil {var _bgga float64 ;if _dagb :=_edab .WAttr ;_dagb !=nil {_bgga =_ec .FromEMU (int64 (*_dagb ))/_ec .Millimeter ;}else {_bgga =_bbeg ;};_efba :=_gf .ColorBlack ;if _geea :=_edab .SolidFill ;_geea !=nil {if _dedb :=_geea .SrgbClr ;_dedb !=nil {_efba =_gf .ColorRGBFromHex ("\u0023"+_dedb .ValAttr );};};_dggf (_defa ,_dabg ,_cdcc ,_acdf ,_fdcfd ,_bgga ,_efba );};};};func _cebde (_gbgd *_bb .CT_Border )(_gf .CellBorderStyle ,*_gf .Color ,float64 ){if _gbgd ==nil {return _gf .CellBorderStyleNone ,nil ,0;};var _fdaf _gf .CellBorderStyle ;switch _gbgd .ValAttr {case _bb .ST_BorderSingle :_fdaf =_gf .CellBorderStyleSingle ;case _bb .ST_BorderDouble :_fdaf =_gf .CellBorderStyleDouble ;default:_fdaf =_gf .CellBorderStyleNone ;};var _eeab _gf .Color ;if _fgbc :=_gbgd .ColorAttr ;_fgbc !=nil {if _fade :=_fgbc .ST_HexColorRGB ;_fade !=nil {_eeab =_gf .ColorRGBFromHex ("\u0023"+*_fade );};};_cfgd :=0.0;if _cgcc :=_gbgd .SzAttr ;_cgcc !=nil {_cfgd =float64 (*_cgcc )/8/_ec .Millimeter ;};return _fdaf ,&_eeab ,_cfgd ;};var _aabe =map[string ][]string {"\u0048e\u006c\u0076\u0065\u0074\u0069\u0063a":[]string {"\u0048e\u006c\u0076\u0065\u0074\u0069\u0063a","\u0048\u0065\u006c\u0076\u0065\u0074\u0069\u0063\u0061-\u0042\u006f\u006c\u0064","\u0048\u0065\u006c\u0076\u0065\u0074\u0069\u0063\u0061\u002d\u004f\u0062l\u0069\u0071\u0075\u0065","H\u0065\u006c\u0076\u0065ti\u0063a\u002d\u0042\u006f\u006c\u0064O\u0062\u006c\u0069\u0071\u0075\u0065"},"\u0043o\u0075\u0072\u0069\u0065\u0072":[]string {"\u0043o\u0075\u0072\u0069\u0065\u0072","\u0043\u006f\u0075r\u0069\u0065\u0072\u002d\u0042\u006f\u006c\u0064","\u0043o\u0075r\u0069\u0065\u0072\u002d\u004f\u0062\u006c\u0069\u0071\u0075\u0065","\u0043\u006f\u0075\u0072ie\u0072\u002d\u0042\u006f\u006c\u0064\u004f\u0062\u006c\u0069\u0071\u0075\u0065"},"\u0054i\u006de\u0073\u0020\u004e\u0065\u0077\u0020\u0052\u006f\u006d\u0061\u006e":[]string {"T\u0069\u006d\u0065\u0073\u002d\u0052\u006f\u006d\u0061\u006e","\u0054\u0069\u006d\u0065\u0073\u002d\u0042\u006f\u006c\u0064","\u0054\u0069\u006de\u0073\u002d\u0049\u0074\u0061\u006c\u0069\u0063","\u0054\u0069m\u0065\u0073\u002dB\u006f\u006c\u0064\u0049\u0074\u0061\u006c\u0069\u0063"},"\u0064e\u0066\u0061\u0075\u006c\u0074":[]string {"\u0048e\u006c\u0076\u0065\u0074\u0069\u0063a","\u0048\u0065\u006c\u0076\u0065\u0074\u0069\u0063\u0061-\u0042\u006f\u006c\u0064","\u0048\u0065\u006c\u0076\u0065\u0074\u0069\u0063\u0061\u002d\u004f\u0062l\u0069\u0071\u0075\u0065","H\u0065\u006c\u0076\u0065ti\u0063a\u002d\u0042\u006f\u006c\u0064O\u0062\u006c\u0069\u0071\u0075\u0065"}};func (_ege *convertContext )addRelativeRIC (_dfdg *_bb .EG_RunInnerContent ,_dgde *_bb .CT_RPr ){var _bdbg *_gf .TextChunk ;var _afg ,_afeb bool ;_cfed :=false ;if _dfdg ==nil {if _ege ._fbccc !=nil {_afg =true ;_bdbg =_ege ._aaga .Append (_ege ._fbccc ._dbac );};}else {if _dfdg .T !=nil &&_dfdg .T .Content !=""{_dgcaa :=_dfdg .T .Content ;if _cfbf :=_ege ._bbbg ;_cfbf !=nil &&_cfbf .IdAttr !=nil {_cfed =true ;_bdbg =_ege ._aaga .AddExternalLink (_dgcaa ,_ege ._ceda .GetTargetByRelId (*_cfbf .IdAttr ));}else {_bdbg =_ege ._aaga .Append (_dgcaa );};}else if _gdgc :=_dfdg .EndnoteReference ;_gdgc !=nil {_aceag :=_ege ._ceda .BodySection ().X ();_afg =true ;_ebgce :=_gdgc .IdAttr ;_cbb :=_ebgce ;_gbccc :=_bb .ST_NumberFormatLowerRoman ;if _cgfdg :=_aceag .EndnotePr ;_cgfdg !=nil {if _cdba :=_cgfdg .NumFmt ;_cdba !=nil {_gbccc =_cdba .ValAttr ;};if _dcga :=_cgfdg .NumStart ;_dcga !=nil {_cbb +=_dcga .ValAttr -1;};};_dgge :=_gecd (_cbb ,_gbccc );_baa :=_ege ._ceda .Endnote (_ebgce ).X ();if _baa !=nil {_ege ._gaffe =append (_ege ._gaffe ,note {_fb :_dgge ,_ggc :_baa .EG_BlockLevelElts });_bdbg =_ege ._aaga .Append (_dgge );};}else if _cfge :=_dfdg .FootnoteReference ;_cfge !=nil {_ecaed :=_ege ._ceda .BodySection ().X ();_afg =true ;_efbc :=_cfge .IdAttr ;_abag :=_efbc ;_gaea :=_bb .ST_NumberFormatDecimal ;if _cbab :=_ecaed .FootnotePr ;_cbab !=nil {if _cgdgf :=_cbab .NumFmt ;_cgdgf !=nil {_gaea =_cgdgf .ValAttr ;};if _befea :=_cbab .NumStart ;_befea !=nil {_abag +=_befea .ValAttr -1;};};_afcgf :=_gecd (_abag ,_gaea );_bdbg =_ege ._aaga .Append (_afcgf );};};if _bdbg !=nil {_bdbg .Style ,_ ,_ =_ege .makeRunStyle (_dgde ,_afg ,_afeb ,true ,false ,_cfed );};};func _cdgfe (_ffgfed *_ee .Document ,_cbfe *_bb .CT_TblPr )*_bb .CT_TblPr {if _cbfe ==nil {_cbfe =_bb .NewCT_TblPr ();};if _cbfe .TblStyle !=nil {_adab :=_ffgfed .GetStyleByID (_cbfe .TblStyle .ValAttr );if _gefe :=_adab .X ();_gefe !=nil {if _acbb :=_gefe .TblPr ;_acbb !=nil {_cfae :=_cbfe .TblBorders ;_acfgf :=_acbb .TblBorders ;if _cfae ==nil {_cfae =_acfgf ;}else {if _cfae .Top ==nil {_cfae .Top =_acfgf .Top ;};if _cfae .Bottom ==nil {_cfae .Bottom =_acfgf .Bottom ;};if _cfae .Left ==nil {_cfae .Left =_acfgf .Left ;};if _cfae .Right ==nil {_cfae .Right =_acfgf .Right ;};if _cfae .InsideH ==nil {_cfae .InsideH =_acfgf .InsideH ;};if _cfae .InsideV ==nil {_cfae .InsideV =_acfgf .InsideV ;};};_fgcd :=_cbfe .Shd ;_fed :=_acbb .Shd ;if _fgcd ==nil {_fgcd =_fed ;}else {if _fed !=nil &&_fgcd .FillAttr ==nil {_fgcd .FillAttr =_fed .FillAttr ;};};_affa :=_cbfe .TblCellMar ;_bdbgf :=_acbb .TblCellMar ;if _affa ==nil {_affa =_bdbgf ;}else {if _bdbgf !=nil &&_affa .Left ==nil {_affa .Left =_bdbgf .Left ;};};if _cbfe .TblInd ==nil {_cbfe .TblInd =_acbb .TblInd ;};if _cbfe .Jc ==nil {_cbfe .Jc =_acbb .Jc ;};};};};return _cbfe ;};func _faag (_dgbcg int64 )float64 {return float64 (int64 (float64 (_dgbcg )*_ec .Twips /_ec .Millimeter *10+0.5))/10;};func (_cdcg *convertContext )makePdfBlockFromChart (_aca *_a .Chart ,_cebd ,_bfc float64 )(*_gf .Block ,error ){_daab :=_aca .CT_RelId .IdAttr ;_bffc :=_cdcg ._ceda .GetChartSpaceByRelId (_daab );if _bffc ==nil {return nil ,_gd .New ("\u004e\u006f\u0020\u0063\u0068\u0061\u0072\u0074\u0073\u0070\u0061\u0063\u0065");};_febbg :=&rectangle {};_aadf :=&rectangle {_eac :_febbg ._eac ,_caf :_cebd -_febbg ._caf ,_deb :_febbg ._deb ,_aebb :_bfc -_febbg ._aebb };_adca :=_gecc (_bfc ,_cebd );_efce (_adca ,_bffc .SpPr ,_aadf ,_bbeg );var _cfda bool ;if _bfea :=_bffc .Chart ;_bfea !=nil {_agca :=_bfea .PlotArea ;if _agca ==nil {return nil ,_gd .New ("\u004e\u006f\u0020p\u006c\u006f\u0074\u0020\u0061\u0072\u0065\u0061");};_dedg :=&rectangle {_eac :100,_caf :_aadf ._caf -15,_deb :100,_aebb :_aadf ._aebb -10};var _gfag *rectangle ;if _edeb :=_bfea .Legend ;_edeb !=nil {_fbae :=_edeb .Overlay !=nil &&_edeb .Overlay .ValAttr !=nil &&*_edeb .Overlay .ValAttr ;if _ecbc :=_edeb .LegendPos ;_ecbc !=nil {switch _ecbc .ValAttr {case _a .ST_LegendPosTr :if !_fbae {_dedg =&rectangle {_eac :25,_caf :_aadf ._caf -10,_deb :10,_aebb :_aadf ._aebb -25};};_gfag =&rectangle {_eac :2.5,_caf :22.5,_deb :_aadf ._aebb -22.5,_aebb :_aadf ._aebb -2.5};case _a .ST_LegendPosT :_gfag =&rectangle {_eac :2.5,_caf :7.5,_deb :(_aadf ._aebb -_aadf ._deb )*0.25,_aebb :(_aadf ._aebb -_aadf ._deb )*0.75};if !_fbae {_dedg =&rectangle {_eac :12.5,_caf :_aadf ._caf -15,_deb :10,_aebb :_aadf ._aebb -5};};_cfda =true ;case _a .ST_LegendPosB :_gfag =&rectangle {_eac :_aadf ._caf -7.5,_caf :_aadf ._caf -2.5,_deb :(_aadf ._aebb -_aadf ._deb )*0.25,_aebb :(_aadf ._aebb -_aadf ._deb )*0.75};if !_fbae {_dedg =&rectangle {_eac :5,_caf :_aadf ._caf -15,_deb :10,_aebb :_aadf ._aebb -5};};_cfda =true ;case _a .ST_LegendPosR :_gfag =&rectangle {_eac :(_aadf ._caf -_aadf ._eac )/2-10,_caf :(_aadf ._caf -_aadf ._eac )/2+10,_deb :_aadf ._aebb -22.5,_aebb :_aadf ._aebb -2.5};if !_fbae {_dedg =&rectangle {_eac :5,_caf :_aadf ._caf -12.5,_deb :10,_aebb :_aadf ._aebb -25};};case _a .ST_LegendPosL :_gfag =&rectangle {_eac :(_aadf ._caf -_aadf ._eac )/2-10,_caf :(_aadf ._caf -_aadf ._eac )/2+10,_deb :2.5,_aebb :22.5};if !_fbae {_dedg =&rectangle {_eac :5,_caf :_aadf ._caf -12.5,_deb :30,_aebb :_aadf ._aebb -5};};default:_gfag =&rectangle {_eac :(_aadf ._caf -_aadf ._eac )/2-10,_caf :(_aadf ._caf -_aadf ._eac )/2+10,_deb :_aadf ._aebb -25,_aebb :_aadf ._aebb -5};if !_fbae {_dedg =&rectangle {_eac :5,_caf :_aadf ._caf -12.5,_deb :100,_aebb :_aadf ._aebb -25};};};};_efce (_adca ,_edeb .SpPr ,_gfag ,_bbeg );};_efce (_adca ,_agca .SpPr ,_dedg ,_bbeg );_gfff :=[]*legendItem {};var _fcdg error ;_add :=_agca .CChoice ;for _ ,_gfcg :=range _agca .Choice {if _fdaed :=_gfcg .BarChart ;_fdaed !=nil {_gfff ,_fcdg =_bba (_adca ,_fdaed ,_dedg ,_add );if _fcdg !=nil {return nil ,_fcdg ;};};};if len (_gfff )!=0{_bafce (_adca ,_gfag ,_gfff ,_cfda );};};return _acga (_adca );};type line struct{_ab float64 ;_cea float64 ;_ed float64 ;_bg float64 ;_bdf float64 ;_fbd []*span ;};func (_cdea *convertContext )newSpan (){_fbfd :=&span {_cce :_cdea ._feefa ._bg ,_fg :_cdea ._feefa ._ed };_cdea ._cfgc =_fbfd ;_cdea ._feefa ._fbd =append (_cdea ._feefa ._fbd ,_fbfd );};var _edcg float64 ;func _fbfg (_cbefc *_bb .CT_PPr ,_efbf *_gf .StyledParagraph )(float64 ,float64 ){if _cbefc .Jc !=nil {var _cbed _gf .TextAlignment ;switch _cbefc .Jc .ValAttr {case _bb .ST_JcRight :_cbed =_gf .TextAlignmentRight ;case _bb .ST_JcCenter :_cbed =_gf .TextAlignmentCenter ;case _bb .ST_JcBoth :_cbed =_gf .TextAlignmentJustify ;default:_cbed =_gf .TextAlignmentLeft ;};_efbf .SetTextAlignment (_cbed );};var _eeaa ,_dgfb ,_dfgd ,_fgfd float64 ;_gfcgb :=1.0;if _edfda :=_cbefc .Spacing ;_edfda !=nil {if _deaf :=_edfda .BeforeAttr ;_deaf !=nil {if _deaf .ST_UnsignedDecimalNumber !=nil {_eeaa =_faag (int64 (*_deaf .ST_UnsignedDecimalNumber ));};};if _gcec :=_edfda .AfterAttr ;_gcec !=nil {if _gcec .ST_UnsignedDecimalNumber !=nil {_dgfb =_faag (int64 (*_gcec .ST_UnsignedDecimalNumber ));};};if _accg :=_edfda .LineAttr ;_accg !=nil {if _accg .Int64 !=nil {_gfcgb =float64 (*_accg .Int64 /240);};};};if _beg :=_cbefc .Ind ;_beg !=nil {if _dfedc :=_beg .LeftAttr ;_dfedc !=nil {if _dfedc .Int64 !=nil {_dfgd =_faag (*_dfedc .Int64 );};};if _gegf :=_beg .RightAttr ;_gegf !=nil {if _gegf .Int64 !=nil {_fgfd =_faag (*_gegf .Int64 );};};};_efbf .SetMargins (_dfgd ,_fgfd ,_eeaa -_gfcgb /2,_dgfb +_gfcgb /2);_efbf .SetLineHeight (_gfcgb );return _eeaa ,_dfgd ;};func (_abe *convertContext )addCurrentWordToParagraph (){for {_aagcg :=_abe ._feefa ._bg ;_gbb :=_aagcg +_abe ._gcbb ._de ;if _gbb > _abe ._feefa ._ed {_abe .newLine ();};_aee :=_abe ._bcaf ._ebf +_abe ._feefa ._ab ;_dggc :=_aee +_abe ._feefa ._bdf ;_cdb :=false ;_defb :=append (_abe ._aadd ._cf ,_abe ._bcaf ._gcg ...);for _ ,_fdcd :=range _defb {_cae :=_fdcd ._cb ;if ((_aee > _cae ._eac &&_aee < _cae ._caf )||(_dggc > _cae ._eac &&_dggc < _cae ._caf ))&&((_aagcg > _cae ._deb &&_aagcg < _cae ._aebb )||(_gbb > _cae ._deb &&_gbb < _cae ._aebb )){_cdb =true ;if _abe ._feefa ._bg < _cae ._aebb {_abe ._cfgc ._fg =_cae ._deb ;_abe ._feefa ._bg =_cae ._aebb ;_abe .newSpan ();};};};if !_cdb {break ;};};if !_abe ._gcbb ._gbd ||len (_abe ._cfgc ._daa )> 0{_abe ._gcbb ._eca =_abe ._feefa ._bg ;_abe ._cfgc ._daa =append (_abe ._cfgc ._daa ,_abe ._gcbb );_abe ._feefa ._bg +=_abe ._gcbb ._de ;for _ ,_cgcd :=range _abe ._gcbb ._bf {_abe .adjustHeights (_cgcd ._cef );};};};func (_bgda *convertContext )newLine (){_cgfa :=0.0;if _bgda ._bcaf ==nil {_bgda .newParagraph ();};_cgfa =_bgda ._bcaf ._gacc +_bgda ._bcaf ._fa ._eac ;_ccgf :=&line {};if len (_bgda ._bcaf ._dd )==0{_ccgf ._cea =_bgda ._bcaf ._fag ;}else {_ccgf ._cea =_bgda ._bcaf ._dac ;};_ccgf ._ed =_bgda ._bcaf ._bdg ;_ccgf ._bg =_ccgf ._cea ;_ccgf ._ab =_cgfa ;_bgda ._bcaf ._dd =append (_bgda ._bcaf ._dd ,_ccgf );_bgda ._feefa =_ccgf ;_bgda .newSpan ();};func (_cdca *convertContext )makePdfImageFromGraphics (_agbf *_be .Pic )(*_gf .Image ,error ){if _edcgc :=_agbf .BlipFill ;_edcgc !=nil {if _ebfcg :=_edcgc .Blip ;_ebfcg !=nil {if _dffc :=_ebfcg .EmbedAttr ;_dffc !=nil {_gdde ,_afce :=_cdca ._ceda .GetImageObjByRelId (*_dffc );if _afce !=nil {return nil ,_afce ;};_gdbb ,_afce :=_dc .Open (_gdde .Path );if _afce !=nil {return nil ,_afce ;};_cbd ,_afce :=_d .ReadAll (_gdbb );if _afce !=nil {return nil ,_afce ;};_caef ,_afce :=_cdca ._ggd .NewImageFromData (_cbd );if _afce !=nil {return nil ,_afce ;};return _caef ,nil ;};};};return nil ,nil ;};func (_bdb barSerByOrder )Swap (i ,j int ){_bdb [i ],_bdb [j ]=_bdb [j ],_bdb [i ]};func (_gffc *convertContext )adjustRightBoundOfLastSpan (){_gfaa :=_gffc ._cfgc ._fg ;_gbca :=_gffc ._feefa ._ab +_gffc ._bcaf ._ebf ;_egdc :=_gbca +_gffc ._feefa ._bdf ;for _ ,_aaf :=range _gffc ._aadd ._cf {if ((_gbca > _aaf ._cb ._eac &&_gbca < _aaf ._cb ._caf )||(_egdc > _aaf ._cb ._eac &&_gbca < _aaf ._cb ._caf ))&&(_gfaa > _aaf ._cb ._deb ){_gfaa =_aaf ._cb ._deb ;};};_gffc ._cfgc ._fg =_gfaa ;};func (_dgbc *convertContext )combinePPrWithStyles (_bega *_bb .CT_PPr )(*_bb .CT_PPr ,*prefix ){if _bega ==nil {return nil ,nil ;};var _gaffd *prefix ;if _bega !=nil &&_bega .NumPr !=nil {if _ffcc ,_dgcg :=_bega .NumPr .Ilvl ,_bega .NumPr .NumId ;_ffcc !=nil &&_dgcg !=nil {_fafg :=_dgbc ._ceda .GetNumberingLevelByIds (_dgcg .ValAttr ,_ffcc .ValAttr ).X ();_bega =_fdeg (_bega ,_fafg .PPr ,_fafg .RPr );if _ggdg :=_fafg .NumFmt ;_ggdg !=nil {if _decb :=_ggdg .ValAttr ;_decb ==_bb .ST_NumberFormatBullet ||_decb ==_bb .ST_NumberFormatDecimal {var _eged []float64 ;if _cdf :=_bega .Tabs ;_cdf !=nil &&len (_cdf .Tab )!=0{for _ ,_aaad :=range _cdf .Tab {_eged =append (_eged ,_faag (*_aaad .PosAttr .Int64 ));};};_gaffd =&prefix {_cgdg :_eged ,_deeg :true };if _decb ==_bb .ST_NumberFormatBullet {if _dfgdc :=_fafg .LvlText ;_dfgdc !=nil {if _debb :=_dfgdc .ValAttr ;_debb !=nil &&*_debb !=""{_gaffd ._dbac =*_debb ;_gaffd ._bfdfb =true ;};};}else {_fecd ,_dcgg :=_dgcg .ValAttr ,_ffcc .ValAttr ;if _ ,_bbee :=_dgbc ._fbfa [_fecd ];!_bbee {_dgbc ._fbfa [_fecd ]=map[int64 ]int {};};if _ ,_aceb :=_dgbc ._fbfa [_fecd ][_dcgg ];!_aceb {_dgbc ._fbfa [_fecd ][_dcgg ]=1;};_gecf :=_dgbc ._fbfa [_fecd ][_dcgg ];_dgbc ._fbfa [_fecd ][_dcgg ]++;_gaffd ._dbac =_b .Itoa (_gecf )+"\u002e";};};};};};if _bega !=nil &&_bega .PStyle !=nil {_babe :=_dgbc ._ceda .GetStyleByID (_bega .PStyle .ValAttr );if _gacd :=_babe .X ();_gacd !=nil {_bega =_fdeg (_bega ,_gacd .PPr ,_gacd .RPr );};};return _bega ,_gaffd ;};func (_ffgf *convertContext )newWord (){_ffgf ._gcbb =&word {_gbd :true ,_eca :_ffgf ._feefa ._bg }};func _eeca (_degb int ,_acad bool )string {_fceb :=(_degb -1)/26+1;_eaffa :=byte ((_degb -1)%26);if _acad {_eaffa +=byte (65);}else {_eaffa +=byte (97);};_ddaf :=_dg .NewBuffer ([]byte {});for _bcad :=0;_bcad < _fceb ;_bcad ++{_ddaf .Write ([]byte {_eaffa });};return _ddaf .String ();};type zoneToSkip struct{_cb *rectangle ;_ea *_bb .WdEG_WrapTypeChoice ;};func _bdd (_cecfb *_bb .CT_TblPr ,_bceb *_bb .CT_TcPr ,_eedgc ,_cffa ,_gfaf ,_edbc int )*_bb .CT_TcPr {if _bceb ==nil {_bceb =_bb .NewCT_TcPr ();};if _bceb .TcBorders ==nil {if _dacc :=_cecfb .TblBorders ;_dacc !=nil {_bceb .TcBorders =_bb .NewCT_TcBorders ();_bceb .TcBorders .Top =_egda (_dacc .Top ,_dacc .InsideH ,_eedgc ==0);_bceb .TcBorders .Bottom =_egda (_dacc .Bottom ,_dacc .InsideH ,_eedgc ==_gfaf -1);_bceb .TcBorders .Left =_egda (_dacc .Left ,_dacc .InsideV ,_cffa ==0);_bceb .TcBorders .Right =_egda (_dacc .Right ,_dacc .InsideV ,_cffa ==_edbc -1);};}else {if _gfbf :=_cecfb .TblBorders ;_gfbf !=nil {if _bceb .TcBorders .Top ==nil {_bceb .TcBorders .Top =_egda (_gfbf .Top ,_gfbf .InsideH ,_eedgc ==0);};if _bceb .TcBorders .Bottom ==nil {_bceb .TcBorders .Bottom =_egda (_gfbf .Bottom ,_gfbf .InsideH ,_eedgc ==_gfaf -1);};if _bceb .TcBorders .Left ==nil {_bceb .TcBorders .Left =_egda (_gfbf .Left ,_gfbf .InsideV ,_cffa ==0);};if _bceb .TcBorders .Right ==nil {_bceb .TcBorders .Right =_egda (_gfbf .Right ,_gfbf .InsideV ,_cffa ==_edbc -1);};};};if _bceb .Shd ==nil {if _gccd :=_cecfb .Shd ;_gccd !=nil {_bceb .Shd =_gccd ;};}else {if _cecfb .Shd !=nil &&_bceb .Shd .FillAttr ==nil {_bceb .Shd .FillAttr =_cecfb .Shd .FillAttr ;};};if _bceb .TcMar ==nil {if _abce :=_cecfb .TblCellMar ;_abce !=nil {_bceb .TcMar =_bb .NewCT_TcMar ();_bceb .TcMar .Left =_abce .Left ;};}else {if _cecfb .TblCellMar !=nil &&_bceb .TcMar .Left ==nil {_bceb .TcMar .Left =_cecfb .TblCellMar .Left ;};};return _bceb ;};func (_dbc *convertContext )addAnchorBlocks (_gcfd []*_bb .EG_PContent ){for _ ,_def :=range _gcfd {for _ ,_cfg :=range _def .EG_ContentRunContent {if _aad :=_cfg .R ;_aad !=nil {for _ ,_acc :=range _aad .EG_RunInnerContent {if _eba :=_acc .Drawing ;_eba !=nil {for _ ,_bcdb :=range _eba .Anchor {var _fdf ,_ced ,_cfa ,_dgc float64 ;_feaa ,_ebad :=_bcdb .PositionH ,_bcdb .PositionV ;if _ebd :=_feaa .Choice ;_ebd !=nil {if _ebd .PosOffset !=nil {_fdf =_ec .FromEMU (int64 (*_ebd .PosOffset ))/_ec .Millimeter ;};};if _bbf :=_ebad .Choice ;_bbf !=nil {if _bbf .PosOffset !=nil {_ced =_ec .FromEMU (int64 (*_bbf .PosOffset ))/_ec .Millimeter ;};};if _afd :=_bcdb .Extent ;_afd !=nil {_dgc =_ec .FromEMU (_afd .CxAttr )/_ec .Millimeter ;_cfa =_ec .FromEMU (_afd .CyAttr )/_ec .Millimeter ;};_ggf :=_dbc ._bcaf ._ebf +_ced ;_fgf :=_ggf +_cfa ;_fecf :=_dbc ._bcaf ._dac +_fdf ;_fdfb :=_fecf +_dgc ;_dba :=_ced +_cfa ;if _dba > _dbc ._bcaf ._ae {_dbc ._bcaf ._ae =_dba ;};if _bcdb .Choice !=nil &&_bcdb .Choice .WrapNone ==nil {_dbc ._bcaf ._gcg =append (_dbc ._bcaf ._gcg ,&zoneToSkip {_cb :&rectangle {_eac :_ggf ,_caf :_fgf ,_deb :_fecf ,_aebb :_fdfb },_ea :_bcdb .Choice });};if _bggd :=_bcdb .Graphic ;_bggd !=nil {if _daac :=_bggd .GraphicData ;_daac !=nil {for _ ,_fce :=range _daac .Any {if _gea ,_gfg :=_fce .(*_be .Pic );_gfg {_dbd ,_fae :=_dbc .makePdfImageFromGraphics (_gea );if _fae !=nil {_e .Println ("\u0043a\u006en\u006f\u0074\u0020\u0072\u0065a\u0064\u0020i\u006d\u0061\u0067\u0065\u003a",_fae );};if _dbd !=nil {_dbd .Scale (_dgc /_dbd .Width (),_cfa /_dbd .Height ());_dbd .SetPos (_fecf ,_ggf );if _bcdb .BehindDocAttr {_dbc ._bcaf ._cc =append (_dbc ._bcaf ._cc ,_dbd );}else {_dbc ._bcaf ._af =append (_dbc ._bcaf ._af ,_dbd );};};}else if _fga ,_cfc :=_fce .(*_a .Chart );_cfc {_gffd ,_ebe :=_dbc .makePdfBlockFromChart (_fga ,_cfa ,_dgc );if _ebe !=nil {_e .Println ("\u0043a\u006en\u006f\u0074\u0020\u0072\u0065a\u0064\u0020b\u006c\u006f\u0063\u006b\u003a",_ebe );};if _gffd !=nil {_aada :=&block {_gff :_gffd ,_gbf :_fecf ,_gaca :_ggf };if _bcdb .BehindDocAttr {_dbc ._bcaf ._gdf =append (_dbc ._bcaf ._gdf ,_aada );}else {_dbc ._bcaf ._cd =append (_dbc ._bcaf ._cd ,_aada );};};};};};};};};};};};};};func _gecc (_cgbb ,_bac float64 )*_gf .Creator {_ggef :=_gf .New ();_ggef .SetPageSize (_gf .PageSize {_cgbb ,_bac });_ggef .SetPageMargins (0,0,0,0);return _ggef ;};var _gcbc =map[int32 ]int32 {61623:8226,61607:8226,61558:9830,61656:8594,61692:8730};type block struct{_gff *_gf .Block ;_gbf float64 ;_gaca float64 ;_adg bool ;_cbg float64 ;_fef _gf .Color ;};func _efce (_bea *_gf .Creator ,_daag *_bd .CT_ShapeProperties ,_bae *rectangle ,_dgbfc float64 ){if _daag !=nil &&_daag .Ln !=nil &&_daag .Ln .SolidFill !=nil &&_daag .Ln .SolidFill .SrgbClr !=nil {_dcab (_bea ,_bae ,_dgbfc ,_gf .ColorRGBFromHex ("\u0023"+_daag .Ln .SolidFill .SrgbClr .ValAttr ));};};func (_geb *convertContext )addAbsoluteCBCs (_age []*_bb .EG_ContentBlockContent ){for _ ,_fdd :=range _age {_geb .addParagraphs (_fdd .P );_geb .addTables (_fdd .Tbl );};};func (_acec *convertContext )currentParagraphOverflowsCurrentPage ()bool {_fbe :=_acec ._bcaf ._ebf +_acec ._bcaf ._fa ._eac +_acec ._bcaf ._fa ._caf ;_cbcd :=_acec ._aadd ._ag ._caf -_acec ._bcaf ._gc ;if len (_acec ._aadd ._gac )==0&&len (_acec ._bcaf ._ada )> 0{_cbcd -=_ad ;};return _fbe +_acec ._bcaf ._gacc > _cbcd ||_fbe +_acec ._bcaf ._ae > _cbcd ;};func (_ecae *convertContext )addAbsoluteRIC (_bbg *_bb .EG_RunInnerContent ,_ecbb *_bb .CT_RPr )bool {var _ddef ,_eed bool ;_fabe :=[]*symbol {};_defg :=false ;if _bbg ==nil {if _ecae ._fbccc !=nil {for _ ,_edf :=range _ecae ._fbccc ._dbac {if _ebfd ,_aagc :=_gcbc [_edf ];_aagc {_eed =_ecae ._fbccc ._bfdfb ;_ecae ._fbccc ._dbac =string (rune (_ebfd ));};};_fabe =_cab (_ecae ._fbccc ._dbac ,"",true ,false );};}else {if _agdd (_bbg ){return true ;}else if _bbg .T !=nil &&_bbg .T .Content !=""{_eaf :=_bbg .T .Content ;if _gfc :=_ecae ._bbbg ;_gfc !=nil &&_gfc .IdAttr !=nil {_defg =true ;_fabe =_cab (_eaf ,_ecae ._ceda .GetTargetByRelId (*_gfc .IdAttr ),false ,false );}else {_fabe =_cab (_eaf ,"",false ,false );};}else if _fdb :=_bbg .EndnoteReference ;_fdb !=nil {_bfd :=_ecae ._ceda .BodySection ().X ();_dag :=_fdb .IdAttr ;_ecab :=_dag ;_dbda :=_bb .ST_NumberFormatLowerRoman ;if _deg :=_bfd .EndnotePr ;_deg !=nil {if _gfdg :=_deg .NumFmt ;_gfdg !=nil {_dbda =_gfdg .ValAttr ;};if _dbaa :=_deg .NumStart ;_dbaa !=nil {_ecab +=_dbaa .ValAttr -1;};};_gce :=_gecd (_ecab ,_dbda );_dgg :=_ecae ._ceda .Endnote (_dag ).X ();if _dgg !=nil {_ecae ._gaffe =append (_ecae ._gaffe ,note {_fb :_gce ,_ggc :_dgg .EG_BlockLevelElts });_fabe =_cab (_gce ,"",true ,false );};}else if _gcdd :=_bbg .FootnoteReference ;_gcdd !=nil {_abcc :=_ecae ._ceda .BodySection ().X ();_ggcf :=_gcdd .IdAttr ;_ddfe :=_ggcf ;_adad :=_bb .ST_NumberFormatDecimal ;if _fca :=_abcc .FootnotePr ;_fca !=nil {if _bfdd :=_fca .NumFmt ;_bfdd !=nil {_adad =_bfdd .ValAttr ;};if _ecde :=_fca .NumStart ;_ecde !=nil {_ddfe +=_ecde .ValAttr -1;};};_eda :=_gecd (_ddfe ,_adad );_acgb :=_ecae ._ceda .Footnote (_ggcf ).X ();if _acgb !=nil {_bgfc :=&note {_fb :_eda ,_ggc :_acgb .EG_BlockLevelElts };_gdff :=[][]*_bb .EG_ContentBlockContent {};for _ ,_agec :=range _acgb .EG_BlockLevelElts {_gdff =append (_gdff ,_agec .EG_ContentBlockContent );};_efbb :=&prefix {_dbac :_eda };_fdc ,_ebc :=_ecae .makePdfBlockFromCBCs (_gdff ,_ecae ._aadd ._ag ._aebb -_ecae ._aadd ._ag ._deb ,1000,nil ,true ,_efbb );if _ebc !=nil {_e .Println ("\u0043a\u006e\u006e\u006f\u0074\u0020\u0063\u006f\u006e\u0076\u0065\u0072t\u0020\u0066\u006f\u006f\u0074\u006e\u006f\u0074\u0065\u003a",_ebc );return false ;};_bgfc ._cgc =_fdc ;_ecae ._bcaf ._ada =append (_ecae ._bcaf ._ada ,_bgfc );_ecae ._bcaf ._gc +=_bgfc ._cgc .Height ();_fabe =_cab (_eda ,"",true ,false );};}else if _aeg :=_bbg .Drawing ;_aeg !=nil {for _ ,_dbad :=range _aeg .Inline {if _dgb :=_dbad .Graphic ;_dgb !=nil {if _fdae :=_dgb .GraphicData ;_fdae !=nil {_cga :=_dbad .Extent ;if _cga ==nil {return false ;};_gaf :=_ec .FromEMU (_cga .CxAttr )/_ec .Millimeter ;_cdeg :=_ec .FromEMU (_cga .CyAttr )/_ec .Millimeter ;for _ ,_gec :=range _fdae .Any {if _ebb ,_aagcc :=_gec .(*_be .Pic );_aagcc {_ebaf :=&symbol {_cef :_cdeg ,_bc :_gaf };_agaf ,_gcfda :=_ecae .makePdfImageFromGraphics (_ebb );if _gcfda !=nil {_e .Println ("\u0043a\u006en\u006f\u0074\u0020\u0072\u0065a\u0064\u0020i\u006d\u0061\u0067\u0065\u003a",_gcfda );};if _agaf ==nil {_ebaf ._dda ="\u0020";}else {_agaf .Scale (_gaf /_agaf .Width (),_cdeg /_agaf .Height ());_ebaf ._cefg =_agaf ;_ddef =true ;};_fabe =[]*symbol {_ebaf };}else if _gagca ,_ceg :=_gec .(*_a .Chart );_ceg {_ebee :=&symbol {_cef :_cdeg ,_bc :_gaf };_cage ,_bggf :=_ecae .makePdfBlockFromChart (_gagca ,_cdeg ,_gaf );if _bggf !=nil {_e .Println ("\u0043a\u006en\u006f\u0074\u0020\u0072\u0065a\u0064\u0020b\u006c\u006f\u0063\u006b\u003a",_bggf );};if _cage ==nil {_ebee ._dda ="\u0020";}else {_ebee ._fcc =&block {_gff :_cage };_ddef =true ;};_fabe =[]*symbol {_ebee };};};};};};};};var _agg _gf .TextStyle ;var _egdf ,_fgg bool ;if !_ddef {_agg ,_egdf ,_fgg =_ecae .makeRunStyle (_ecbb ,false ,false ,false ,_eed ,_defg );};for _ ,_cabb :=range _fabe {if _cabb ._cefg !=nil ||_cabb ._fcc !=nil {_ecae .addInlineSymbol (_cabb );}else {_cabb ._gab =&_agg ;_cabb ._gbe =_egdf ;_cabb ._dccg =_fgg ;_ecae .addTextSymbol (_cabb );};};if _ecae ._fbccc !=nil &&_ecae ._fbccc ._deeg {var _acdb ,_gdda float64 ;for _ ,_cac :=range _fabe {_acdb +=_cac ._bc ;};_fbda :=0;_fddg :=_ecae ._aadd ._ag ._deb ;_dbe :=len (_ecae ._fbccc ._cgdg );_geda :=_ecae ._bcaf ._fc < _acdb ;_bfa :=_ecae ._feefa ._cea +_acdb ;for {var _cbe float64 ;if _geda ||_fbda >=_dbe {_cbe =_edcg ;}else {_cbe =_ecae ._fbccc ._cgdg [_fbda ];_fbda ++;};_fddg +=_cbe ;if _fddg > _bfa {_gdda =_fddg -_bfa ;break ;};};_ecae .addTextSymbol (&symbol {_dda :"\u0020",_bc :_gdda });};return false ;};func (_eefa *convertContext )addTextSymbol (_gee *symbol ){_ace :=_gf .New ();_eefg :=_ace .NewStyledParagraph ();_eefg .SetMargins (0,0,0,0);_ebde :=_eefg .Append (_gee ._dda );_eefg .SetLineHeight (_eefa ._bcaf ._gb );_aedf :=0.0;if _gee ._gab !=nil {_ebde .Style =*_gee ._gab ;if _gee ._gab .CharSpacing !=0{_aedf =_gee ._gab .CharSpacing ;};};_gee ._cef =_eefg .Height ();if _gee ._bc ==0{_gee ._bc =_eefg .Width ()+_aedf ;};if len (_eefa ._gcbb ._bf )> 0{_bafc :=_eefa ._gcbb ._bf [len (_eefa ._gcbb ._bf )-1]._dda ;if (_bafc =="\u0020")!=(_gee ._dda =="\u0020"){_eefa .addCurrentWordToParagraph ();_eefa .newWord ();};};_eefa ._gcbb ._bf =append (_eefa ._gcbb ._bf ,_gee );_gee ._dfc =_eefa ._gcbb ._de ;_eefa ._gcbb ._de +=_gee ._bc ;if _gee ._dda !="\u0020"{_eefa ._gcbb ._gbd =false ;};if _gee ._dda =="\u000d"{_eefa .adjustHeights (_gee ._cef );};};type barSerByOrder []*_a .CT_BarSer ;func (_ega *convertContext )alignSymbolsVertically (){for _ ,_egf :=range _ega ._bcbf {for _ ,_cde :=range _egf ._bbb {for _ ,_gage :=range _cde ._dd {_ecb :=0.0;for _ ,_ac :=range _gage ._fbd {for _ ,_gcbd :=range _ac ._daa {for _ ,_fba :=range _gcbd ._bf {if _fba ._cef > _ecb {_ecb =_fba ._cef ;};};};};for _ ,_edb :=range _gage ._fbd {for _ ,_fega :=range _edb ._daa {for _ ,_egdb :=range _fega ._bf {if _egdb ._cef < _ecb {_egdb ._aa =_ecb -_egdb ._cef ;};};};};};};};};type rectangle struct{_eac float64 ;_caf float64 ;_deb float64 ;_aebb float64 ;};func _cab (_adgf ,_fcge string ,_gbfc ,_faa bool )[]*symbol {_fff :=[]*symbol {};for _ ,_gacg :=range _adgf {_dff :=&symbol {_dda :string (_gacg ),_gbe :_gbfc ,_dccg :_faa ,_dcc :_fcge };_fff =append (_fff ,_dff );};return _fff ;};