//
// Copyright 2020 FoxyUtils ehf. All rights reserved.
//
// This is a commercial product and requires a license to operate.
// A trial license can be obtained at https://unidoc.io
//
// DO NOT EDIT: generated by unitwist Go source code obfuscator.
//
// Use of this source code is governed by the UniDoc End User License Agreement
// terms that can be accessed at https://unidoc.io/eula/

package convert ;import (_bd "bytes";_fa "errors";_f "github.com/unidoc/unioffice/common/logger";_d "github.com/unidoc/unioffice/common/tempstorage";_df "github.com/unidoc/unioffice/document";_ab "github.com/unidoc/unioffice/internal/convertutils";_cf "github.com/unidoc/unioffice/internal/formatutils";_dc "github.com/unidoc/unioffice/measurement";_aa "github.com/unidoc/unioffice/schema/soo/dml";_db "github.com/unidoc/unioffice/schema/soo/dml/chart";_bf "github.com/unidoc/unioffice/schema/soo/dml/picture";_ff "github.com/unidoc/unioffice/schema/soo/ofc/sharedTypes";_eg "github.com/unidoc/unioffice/schema/soo/wml";_bbd "github.com/unidoc/unipdf/v3/creator";_ec "github.com/unidoc/unipdf/v3/model";_bb "io/ioutil";_a "regexp";_c "strconv";_e "strings";);

// RegisterFont makes a PdfFont accessible for using in converting to PDF.
func RegisterFont (name string ,style FontStyle ,font *_ec .PdfFont ){_ab .RegisterFont (name ,style ,font );};func (_gceg *convertContext )addAbsoluteTable (_dcdc *_eg .CT_Tbl ){_gfe :=_dcdc .TblGrid ;if _gfe ==nil {return ;};_ggg :=len (_gfe .GridCol );if _ggg ==0{return ;};_bee :=[]float64 {};_degc :=[]float64 {};_feggg :=0.0;for _ ,_aaeg :=range _gfe .GridCol {_fgdbf :=0.0;if _aaeg .WAttr .ST_UnsignedDecimalNumber !=nil {_fgdbf =_ab .PointsFromTwips (int64 (*_aaeg .WAttr .ST_UnsignedDecimalNumber ));};_bee =append (_bee ,_fgdbf );_feggg +=_fgdbf ;};for _dabe :=0;_dabe < _ggg ;_dabe ++{_degc =append (_degc ,_bee [_dabe ]/_feggg );};_eac :=_gceg ._bbde .NewTable (_ggg );_eac .SetColumnWidths (_degc ...);_gfgg :=_gceg ._bbde .NewTable (_ggg );_gfgg .SetColumnWidths (_degc ...);_fegaec ,_dac ,_feee :=_bege (_gceg ._faec ,_dcdc .TblPr );var _bced []*_eg .CT_TblStylePr ;if _fegaec .TblStyle !=nil {_bced =_gacc (_gceg ._faec ,_fegaec .TblStyle .ValAttr );};_efc :=_efec (_fegaec .TblW ,_gceg ._bbdef ._ag .Right -_gceg ._bbdef ._ag .Left ,0);_eae :=_efec (_fegaec .TblInd ,_gceg ._bbdef ._ag .Right -_gceg ._bbdef ._ag .Left ,0);_fgca :=_gceg ._bbdef ._ag .Bottom -_gceg ._ebdd ._dbf ;_edf :=len (_dcdc .EG_ContentRowContent );for _ceb ,_afc :=range _dcdc .EG_ContentRowContent {if _afc ==nil {continue ;};_geff :=_gceg ._bbde .NewTable (_ggg );_geff .SetColumnWidths (_degc ...);if _bcfa :=_afc .Tr ;len (_bcfa )> 0{_edfg :=_bcfa [0];_gedf :=_edfg .TblPrEx ;for _ccfe ,_egbd :=range _edfg .EG_ContentCellContent {if _ebdb :=_egbd .Tc ;len (_ebdb )> 0{if _ada :=_ebdb [0];_ada !=nil {_gceg .addCellToTable (_gfgg ,_ada ,_fegaec ,_gedf ,_ceb ,_ccfe ,_edf ,_ggg ,_bced ,_dac ,_feee );_gceg .addCellToTable (_geff ,_ada ,_fegaec ,_gedf ,_ceb ,_ccfe ,_edf ,_ggg ,_bced ,_dac ,_feee );};};};var _fgad float64 ;if _gace :=_edfg .TrPr ;_gace !=nil {if len (_gace .TrHeight )!=0{_ggcd :=_gace .TrHeight [0];if _gcbb :=_ggcd .ValAttr ;_gcbb !=nil {if _gcbb .ST_UnsignedDecimalNumber !=nil {_fgad =_ab .PointsFromTwips (int64 (*_gcbb .ST_UnsignedDecimalNumber ));};};};};if _fgad < _geff .Height (){_fgad =_geff .Height ();};if _fgad < _egcd (4){_fgad =_egcd (4);};_gfgg .SetRowHeight (_gfgg .CurRow (),_fgad );_geff .SetRowHeight (_geff .CurRow (),_fgad );if _efc ==0||_efc > _gceg ._bbdef ._ag .Right -_gceg ._bbdef ._ag .Left {_efc =_gceg ._bbdef ._ag .Right -_gceg ._bbdef ._ag .Left ;};_fbab :=_ab .MakeTempCreator (_efc ,_egcd (1000));_fbab .Draw (_gfgg );if _gfgg .Height ()>=_fgca {_gceg .addParagraphWithTable (*_eac ,_efc ,_eae );_gceg .newPage ();*_gfgg =*_geff ;_gfgg .SetRowHeight (_gfgg .CurRow (),_fgad );_fgca =_gceg ._bbdef ._ag .Bottom -_gceg ._bbdef ._ag .Top ;_eac =nil ;}else {if _eac ==nil {_eac =_gceg ._bbde .NewTable (_ggg );_eac .SetColumnWidths (_degc ...);};*_eac =*_gfgg ;};};};if _eac !=nil {_gceg .addParagraphWithTable (*_eac ,_efc ,_eae );};};type prefix struct{_cgg string ;_gfef []float64 ;_daec bool ;_ecbd bool ;};const (FontStyle_Regular FontStyle =0;FontStyle_Bold FontStyle =1;FontStyle_Italic FontStyle =2;FontStyle_BoldItalic FontStyle =3;);func _ggdf (_addf ,_fdee string ,_dcd ,_fdebd bool )[]*symbol {_acdb :=[]*symbol {};for _ ,_egea :=range _addf {_ccef :=&symbol {_bed :string (_egea ),_cad :_dcd ,_abbe :_fdebd ,_ae :_fdee };_acdb =append (_acdb ,_ccef );};return _acdb ;};func _abaa (_efda *_df .Document ,_eafa string ,_gfbed *_eg .CT_TblPr ,_badb *_eg .CT_PPrGeneral ,_afeg *_eg .CT_RPr )(*_eg .CT_TblPr ,*_eg .CT_PPrGeneral ,*_eg .CT_RPr ){if _gfbed .TblStyle !=nil {_eedg :=_efda .GetStyleByID (_eafa );if _eggbg :=_eedg .X ();_eggbg !=nil {if _dfaa :=_eggbg .TblPr ;_dfaa !=nil {_ceg :=_gfbed .TblBorders ;_edgg :=_dfaa .TblBorders ;if _ceg ==nil {_ceg =_edgg ;}else {if _ceg .Top ==nil {_ceg .Top =_edgg .Top ;};if _ceg .Bottom ==nil {_ceg .Bottom =_edgg .Bottom ;};if _ceg .Left ==nil {_ceg .Left =_edgg .Left ;};if _ceg .Right ==nil {_ceg .Right =_edgg .Right ;};if _ceg .InsideH ==nil {_ceg .InsideH =_edgg .InsideH ;};if _ceg .InsideV ==nil {_ceg .InsideV =_edgg .InsideV ;};};_gfbed .TblBorders =_ceg ;_dafd :=_gfbed .Shd ;_gdgg :=_dfaa .Shd ;if _dafd ==nil {_dafd =_gdgg ;}else {if _gdgg !=nil &&_dafd .FillAttr ==nil {_dafd .FillAttr =_gdgg .FillAttr ;};};_gfbed .Shd =_dafd ;_decb :=_gfbed .TblCellMar ;_efaga :=_dfaa .TblCellMar ;if _decb ==nil {_decb =_efaga ;}else {if _efaga !=nil &&_decb .Left ==nil {_decb .Left =_efaga .Left ;};};_gfbed .TblCellMar =_decb ;if _gfbed .TblInd ==nil {_gfbed .TblInd =_dfaa .TblInd ;};if _gfbed .Jc ==nil {_gfbed .Jc =_dfaa .Jc ;};};if _eggbg .PPr !=nil {_badb =_dadc (_eggbg .PPr ,_badb );};if _eggbg .RPr !=nil {_afeg =_bgce (_eggbg .RPr ,_afeg );};if _eeag :=_eggbg .BasedOn ;_eeag !=nil {return _abaa (_efda ,_eeag .ValAttr ,_gfbed ,_badb ,_afeg );};};};return _gfbed ,_badb ,_afeg ;};func (_aaab *convertContext )addRelativeRIC (_bfbe *_eg .EG_RunInnerContent ,_fegd *_eg .CT_RPr ){var _caedf *_bbd .TextChunk ;var _afga ,_ecbdb bool ;_fggee :=false ;if _bfbe ==nil {if _aaab ._eabf !=nil {_afga =true ;_caedf =_aaab ._egggc .Append (_aaab ._eabf ._cgg );};}else {if _bfbe .T !=nil &&_bfbe .T .Content !=""{_gda :=_bfbe .T .Content ;if _cfdb :=_aaab ._bcda ;_cfdb !=nil &&_cfdb .IdAttr !=nil {_fggee =true ;_caedf =_aaab ._egggc .AddExternalLink (_gda ,_aaab ._faec .GetTargetByRelId (*_cfdb .IdAttr ));}else {_caedf =_aaab ._egggc .Append (_gda );};}else if _edeg :=_bfbe .EndnoteReference ;_edeg !=nil {_gcbg :=_aaab ._faec .BodySection ().X ();_afga =true ;_baea :=_edeg .IdAttr ;_dafc :=_baea ;_bbaf :=_eg .ST_NumberFormatLowerRoman ;if _gfcf :=_gcbg .EndnotePr ;_gfcf !=nil {if _ddeg :=_gfcf .NumFmt ;_ddeg !=nil {_bbaf =_ddeg .ValAttr ;};if _cdac :=_gfcf .NumStart ;_cdac !=nil {_dafc +=_cdac .ValAttr -1;};};_cfbbb :=_efcg (_dafc ,_bbaf );_ecbbe :=_aaab ._faec .Endnote (_baea ).X ();if _ecbbe !=nil {_aaab ._acg =append (_aaab ._acg ,note {_cfd :_cfbbb ,_ce :_ecbbe .EG_BlockLevelElts });_caedf =_aaab ._egggc .Append (_cfbbb );};}else if _cbga :=_bfbe .FootnoteReference ;_cbga !=nil {_cagd :=_aaab ._faec .BodySection ().X ();_afga =true ;_fgcf :=_cbga .IdAttr ;_dgf :=_fgcf ;_dacf :=_eg .ST_NumberFormatDecimal ;if _ffeb :=_cagd .FootnotePr ;_ffeb !=nil {if _ebec :=_ffeb .NumFmt ;_ebec !=nil {_dacf =_ebec .ValAttr ;};if _afac :=_ffeb .NumStart ;_afac !=nil {_dgf +=_afac .ValAttr -1;};};_bgaa :=_efcg (_dgf ,_dacf );_caedf =_aaab ._egggc .Append (_bgaa );};};if _caedf !=nil {_caedf .Style ,_ ,_ ,_ =_aaab .makeRunStyle (_fegd ,_afga ,_ecbdb ,true ,false ,_fggee );};};func _bgce (_acda ,_ffdg *_eg .CT_RPr )*_eg .CT_RPr {if _acda ==nil {return _ffdg ;};if _ffdg ==nil {return _acda ;};if _acda .RStyle ==nil {_acda .RStyle =_ffdg .RStyle ;};if _acda .RFonts ==nil {_acda .RFonts =_ffdg .RFonts ;};if _acda .B ==nil {_acda .B =_ffdg .B ;};if _acda .BCs ==nil {_acda .BCs =_ffdg .BCs ;};if _acda .I ==nil {_acda .I =_ffdg .I ;};if _acda .ICs ==nil {_acda .ICs =_ffdg .ICs ;};if _acda .Caps ==nil {_acda .Caps =_ffdg .Caps ;};if _acda .SmallCaps ==nil {_acda .SmallCaps =_ffdg .SmallCaps ;};if _acda .Strike ==nil {_acda .Strike =_ffdg .Strike ;};if _acda .Dstrike ==nil {_acda .Dstrike =_ffdg .Dstrike ;};if _acda .Outline ==nil {_acda .Outline =_ffdg .Outline ;};if _acda .Shadow ==nil {_acda .Shadow =_ffdg .Shadow ;};if _acda .Emboss ==nil {_acda .Emboss =_ffdg .Emboss ;};if _acda .Imprint ==nil {_acda .Imprint =_ffdg .Imprint ;};if _acda .NoProof ==nil {_acda .NoProof =_ffdg .NoProof ;};if _acda .SnapToGrid ==nil {_acda .SnapToGrid =_ffdg .SnapToGrid ;};if _acda .Vanish ==nil {_acda .Vanish =_ffdg .Vanish ;};if _acda .WebHidden ==nil {_acda .WebHidden =_ffdg .WebHidden ;};if _acda .Color ==nil {_acda .Color =_ffdg .Color ;};if _acda .Spacing ==nil {_acda .Spacing =_ffdg .Spacing ;};if _acda .W ==nil {_acda .W =_ffdg .W ;};if _acda .Kern ==nil {_acda .Kern =_ffdg .Kern ;};if _acda .Position ==nil {_acda .Position =_ffdg .Position ;};if _acda .Sz ==nil {_acda .Sz =_ffdg .Sz ;};if _acda .SzCs ==nil {_acda .SzCs =_ffdg .SzCs ;};if _acda .Highlight ==nil {_acda .Highlight =_ffdg .Highlight ;};if _acda .U ==nil {_acda .U =_ffdg .U ;};if _acda .Effect ==nil {_acda .Effect =_ffdg .Effect ;};if _acda .Bdr ==nil {_acda .Bdr =_ffdg .Bdr ;};if _acda .Shd ==nil {_acda .Shd =_ffdg .Shd ;};if _acda .FitText ==nil {_acda .FitText =_ffdg .FitText ;};if _acda .VertAlign ==nil {_acda .VertAlign =_ffdg .VertAlign ;};if _acda .Rtl ==nil {_acda .Rtl =_ffdg .Rtl ;};if _acda .Cs ==nil {_acda .Cs =_ffdg .Cs ;};if _acda .Em ==nil {_acda .Em =_ffdg .Em ;};if _acda .Lang ==nil {_acda .Lang =_ffdg .Lang ;};if _acda .EastAsianLayout ==nil {_acda .EastAsianLayout =_ffdg .EastAsianLayout ;};if _acda .SpecVanish ==nil {_acda .SpecVanish =_ffdg .SpecVanish ;};if _acda .OMath ==nil {_acda .OMath =_ffdg .OMath ;};if _acda .RPrChange ==nil {_acda .RPrChange =_ffdg .RPrChange ;};return _acda ;};type image struct{_bec *_bbd .Image ;_ebf float64 ;_abf float64 ;};func (_fbdf *convertContext )makePdfBlockFromChart (_fef *_db .Chart ,_edbc ,_gdde float64 )(*_bbd .Block ,error ){_dece :=_fef .CT_RelId .IdAttr ;_cbdfc :=_fbdf ._faec .GetChartSpaceByRelId (_dece );if _cbdfc ==nil {return nil ,_fa .New ("\u004e\u006f\u0020\u0063\u0068\u0061\u0072\u0074\u0073\u0070\u0061\u0063\u0065");};var _fcdaf *_aa .Theme ;_bcdb :=_fbdf ._faec .Themes ();if len (_bcdb )> 0{_fcdaf =_bcdb [0];};return _ab .MakeBlockFromChartSpace (_cbdfc ,_edbc ,_gdde ,_fcdaf );};func (_egag *convertContext )addCurrentWordToParagraph (){for {_gde :=_egag ._fcdba ._acbf ;_daa :=_gde +_egag ._beec ._eba ;if _daa > _egag ._fcdba ._abb {_egag .newLine ();};_cccbb :=_egag ._ebdd ._dbf +_egag ._fcdba ._ge ;_edef :=_cccbb +_egag ._fcdba ._dbe ;_ebbe :=false ;_cfe :=append (_egag ._bbdef ._gb ,_egag ._ebdd ._aabd ...);for _ ,_afad :=range _cfe {_ggec :=_afad ._ea ;if ((_cccbb > _ggec .Top &&_cccbb < _ggec .Bottom )||(_edef > _ggec .Top &&_edef < _ggec .Bottom ))&&((_gde > _ggec .Left &&_gde < _ggec .Right )||(_daa > _ggec .Left &&_daa < _ggec .Right )){_ebbe =true ;if _egag ._fcdba ._acbf < _ggec .Right {_egag ._agg ._bae =_ggec .Left ;_egag ._fcdba ._acbf =_ggec .Right ;_egag .newSpan ();};};};if !_ebbe {break ;};};if !_egag ._beec ._bff ||len (_egag ._agg ._dce )> 0{_egag ._beec ._eff =_egag ._fcdba ._acbf ;_egag ._agg ._dce =append (_egag ._agg ._dce ,_egag ._beec );_egag ._fcdba ._acbf +=_egag ._beec ._eba ;for _ ,_gdca :=range _egag ._beec ._afd {_egag .adjustHeights (_gdca ._fg );};};};var _efb =map[int32 ]int32 {61623:8226,61607:8226,61558:9830,61656:8594,61692:8730};func (_gcdf *convertContext )addCellToTable (_cdde *_bbd .Table ,_gaf *_eg .CT_Tc ,_dad *_eg .CT_TblPr ,_cced *_eg .CT_TblPrEx ,_gfgf ,_fafd ,_cdb ,_ggcdb int ,_bbgc []*_eg .CT_TblStylePr ,_gbc *_eg .CT_PPrGeneral ,_edcfa *_eg .CT_RPr ){var _bcgg *_bbd .TableCell ;_gcda :=1;_aabe :=_gaf .TcPr ;for _ ,_eggg :=range _bbgc {if _gfgf ==0&&_eggg .TypeAttr ==_eg .ST_TblStyleOverrideTypeFirstRow {_aabe =_eggf (_aabe ,_eggg .TcPr );_edcfa =_bgce (_edcfa ,_eggg .RPr );break ;};if _fafd ==0&&_eggg .TypeAttr ==_eg .ST_TblStyleOverrideTypeFirstCol {_aabe =_eggf (_aabe ,_eggg .TcPr );_edcfa =_bgce (_edcfa ,_eggg .RPr );};if _gfgf ==_cdb -1&&_eggg .TypeAttr ==_eg .ST_TblStyleOverrideTypeLastRow {_aabe =_eggf (_aabe ,_eggg .TcPr );_edcfa =_bgce (_edcfa ,_eggg .RPr );};if _fafd ==_ggcdb -1&&_eggg .TypeAttr ==_eg .ST_TblStyleOverrideTypeLastCol {_aabe =_eggf (_aabe ,_eggg .TcPr );_edcfa =_bgce (_edcfa ,_eggg .RPr );};if _gfgf %2!=0&&_eggg .TypeAttr ==_eg .ST_TblStyleOverrideTypeBand1Horz {_aabe =_eggf (_aabe ,_eggg .TcPr );if _fafd ==0{_edcfa =_bgce (_edcfa ,_eggg .RPr );}else {_edcfa =_bfeg (_edcfa ,_eggg .RPr );};};if _fafd %2!=0&&_eggg .TypeAttr ==_eg .ST_TblStyleOverrideTypeBand1Vert {_aabe =_eggf (_aabe ,_eggg .TcPr );if _gfgf ==0{_edcfa =_bgce (_edcfa ,_eggg .RPr );}else {_edcfa =_bfeg (_edcfa ,_eggg .RPr );};};if _gfgf %2==0&&_eggg .TypeAttr ==_eg .ST_TblStyleOverrideTypeBand2Horz {_aabe =_eggf (_aabe ,_eggg .TcPr );if _fafd ==_ggcdb -1{_edcfa =_bgce (_edcfa ,_eggg .RPr );}else {_edcfa =_bfeg (_edcfa ,_eggg .RPr );};};if _fafd %2==0&&_eggg .TypeAttr ==_eg .ST_TblStyleOverrideTypeBand2Vert {_aabe =_eggf (_aabe ,_eggg .TcPr );if _gfgf ==_cdb -1{_edcfa =_bgce (_edcfa ,_eggg .RPr );}else {_edcfa =_bfeg (_edcfa ,_eggg .RPr );};};};_ddb :=_baab (_dad ,_cced ,_aabe ,_gfgf ,_fafd ,_cdb ,_ggcdb );_effg :=_fd ;_bca :=_bbd .CellVerticalAlignmentTop ;if _ddb !=nil {if _ddb .GridSpan !=nil {_gcda =int (_ddb .GridSpan .ValAttr );};_bcgg =_cdde .MultiColCell (_gcda );if _fed :=_ddb .TcBorders ;_fed !=nil {if _fbd :=_fed .Left ;_fbd !=nil {_afcb ,_adf ,_dcecc :=_eaaga (_fbd );_bcgg .SetBorder (_bbd .CellBorderSideLeft ,_afcb ,_dcecc );if _adf !=nil &&*_adf !=nil {_bcgg .SetSideBorderColor (_bbd .CellBorderSideLeft ,*_adf );};};if _dgcd :=_fed .Top ;_dgcd !=nil {_addg ,_gfbe ,_ccdd :=_eaaga (_dgcd );_bcgg .SetBorder (_bbd .CellBorderSideTop ,_addg ,_ccdd );if _gfbe !=nil &&*_gfbe !=nil {_bcgg .SetSideBorderColor (_bbd .CellBorderSideTop ,*_gfbe );};};if _gfeb :=_fed .Right ;_gfeb !=nil {_bba ,_befe ,_fdb :=_eaaga (_gfeb );_bcgg .SetBorder (_bbd .CellBorderSideRight ,_bba ,_fdb );if _befe !=nil &&*_befe !=nil {_bcgg .SetSideBorderColor (_bbd .CellBorderSideRight ,*_befe );};};if _bcgc :=_fed .Bottom ;_bcgc !=nil {_dfb ,_fgfb ,_ebe :=_eaaga (_bcgc );_bcgg .SetBorder (_bbd .CellBorderSideBottom ,_dfb ,_ebe );if _fgfb !=nil &&*_fgfb !=nil {_bcgg .SetSideBorderColor (_bbd .CellBorderSideBottom ,*_fgfb );};};}else {_bcgg .SetBorder (_bbd .CellBorderSideAll ,_bbd .CellBorderStyleSingle ,_egcd (0.125));_bcgg .SetBorderColor (_bbd .ColorBlack );};if _ddgg :=_ddb .Shd ;_ddgg !=nil {if _agfc :=_ddgg .FillAttr ;_agfc !=nil {if _beg :=_agfc .ST_HexColorRGB ;_beg !=nil {_abgd :=_bbd .ColorRGBFromHex ("\u0023"+*_beg );_bcgg .SetBackgroundColor (_abgd );};};};if _egef :=_ddb .TcMar ;_egef !=nil {_effg =_efec (_egef .Left ,0,_fd );};if _eaagc :=_ddb .VAlign ;_eaagc !=nil {switch _eaagc .ValAttr {case _eg .ST_VerticalJcCenter :_bca =_bbd .CellVerticalAlignmentMiddle ;case _eg .ST_VerticalJcBottom :_bca =_bbd .CellVerticalAlignmentBottom ;};};};if _bcgg ==nil {_bcgg =_cdde .NewCell ();};_bcgg .SetVerticalAlignment (_bca );_bcgg .SetIndent (_effg );_fgdf :=_gaf .EG_BlockLevelElts ;_eggb :=_gcdf ._bbde .NewStyledParagraph ();_edeb :=false ;for _ ,_cbed :=range _fgdf {for _ ,_ggag :=range _cbed .EG_ContentBlockContent {for _ ,_ded :=range _ggag .P {if _edeb {_dbeg :=_eggb .Append ("\u000a");_ccgf :=_gcdf ._bbde .NewTextStyle ();_ccgf .FontSize =0;_dbeg .Style =_ccgf ;};_ebad ,_ :=_gcdf .combinePPrWithStyles (_ded .PPr );if _gbc !=nil ||_edcfa !=nil {_ebad =_edbcc (_ded .PPr ,_gbc ,_edcfa );};for _ ,_feda :=range _ded .EG_PContent {for _ ,_gcdb :=range _feda .EG_ContentRunContent {if _ffdf :=_gcdb .R ;_ffdf !=nil {_aef :=_cgfb (_gcdf ._faec ,_ffdf .RPr ,_ebad );for _ ,_cbgf :=range _ffdf .EG_RunInnerContent {var _feeea *_bbd .TextChunk ;if _cbgf .T !=nil &&_cbgf .T .Content !=""{_edeb =true ;_feeea =_eggb .Append (_cbgf .T .Content );_feeea .Style ,_ ,_ ,_ =_gcdf .makeRunStyle (_aef ,false ,false ,false ,false ,false );};};};};};if !_edeb {_afe :=_cgfb (_gcdf ._faec ,_eg .NewCT_RPr (),_ebad );_gfbee :=_eggb .Append ("\u0020");_gfbee .Style ,_ ,_ ,_ =_gcdf .makeRunStyle (_afe ,false ,false ,false ,false ,false );};if _eggb !=nil {_gcdf .assignPropsToRelativeParagraph (_ebad ,_eggb );};};};};_bcgg .SetContent (_eggb );};func (_aegcg *convertContext )assignPropsToRelativeParagraph (_cdeg *_eg .CT_PPr ,_efee *_bbd .StyledParagraph )(float64 ,float64 ){_cdeg =_edbcc (_cdeg ,_aegcg ._dccgf ,_aegcg ._effb );_egc :=1.1;if _cdeg ==nil {_efee .SetLineHeight (_egc );return 0,0;};if _cdeg .Jc !=nil {var _cgfa _bbd .TextAlignment ;switch _cdeg .Jc .ValAttr {case _eg .ST_JcRight :_cgfa =_bbd .TextAlignmentRight ;case _eg .ST_JcCenter :_cgfa =_bbd .TextAlignmentCenter ;case _eg .ST_JcBoth :_cgfa =_bbd .TextAlignmentJustify ;default:_cgfa =_bbd .TextAlignmentLeft ;};_efee .SetTextAlignment (_cgfa );};var _defg ,_fge ,_cec ,_cfcf float64 ;if _aged :=_cdeg .Spacing ;_aged !=nil {if _geeb :=_aged .BeforeAttr ;_geeb !=nil {if _geeb .ST_UnsignedDecimalNumber !=nil {_defg =_ab .PointsFromTwips (int64 (*_geeb .ST_UnsignedDecimalNumber ));};};if _cgbg :=_aged .AfterAttr ;_cgbg !=nil {if _cgbg .ST_UnsignedDecimalNumber !=nil {_fge =_ab .PointsFromTwips (int64 (*_cgbg .ST_UnsignedDecimalNumber ));};};if _eabfe :=_aged .LineAttr ;_eabfe !=nil {if _eabfe .Int64 !=nil {_egc =float64 (*_eabfe .Int64 /240);};};};_efee .SetLineHeight (_egc );if _cdag :=_cdeg .Ind ;_cdag !=nil {if _adca :=_cdag .LeftAttr ;_adca !=nil {if _adca .Int64 !=nil {_cec =_ab .PointsFromTwips (*_adca .Int64 );};};if _bcbb :=_cdag .RightAttr ;_bcbb !=nil {if _bcbb .Int64 !=nil {_cfcf =_ab .PointsFromTwips (*_bcbb .Int64 );};};};_efee .SetMargins (_cec ,_cfcf ,_defg -_egc /2,_fge +_egc /2);return _defg ,_cec ;};func _bfeg (_cadf ,_cef *_eg .CT_RPr )*_eg .CT_RPr {if _cadf ==nil {return _cef ;};if _cef ==nil {if _cadf .B !=nil {_cadf .B =nil ;};if _cadf .BCs !=nil {_cadf .BCs =nil ;};if _cadf .I !=nil {_cadf .I =nil ;};if _cadf .ICs !=nil {_cadf .ICs =nil ;};return _cadf ;};if _cadf .RStyle ==nil {_cadf .RStyle =_cef .RStyle ;};if _cadf .RFonts ==nil {_cadf .RFonts =_cef .RFonts ;};if _cadf .B ==nil {_cadf .B =_cef .B ;};if _cadf .BCs ==nil {_cadf .BCs =_cef .BCs ;};if _cadf .I ==nil {_cadf .I =_cef .I ;};if _cadf .ICs ==nil {_cadf .ICs =_cef .ICs ;};if _cadf .Caps ==nil {_cadf .Caps =_cef .Caps ;};if _cadf .SmallCaps ==nil {_cadf .SmallCaps =_cef .SmallCaps ;};if _cadf .Strike ==nil {_cadf .Strike =_cef .Strike ;};if _cadf .Dstrike ==nil {_cadf .Dstrike =_cef .Dstrike ;};if _cadf .Outline ==nil {_cadf .Outline =_cef .Outline ;};if _cadf .Shadow ==nil {_cadf .Shadow =_cef .Shadow ;};if _cadf .Emboss ==nil {_cadf .Emboss =_cef .Emboss ;};if _cadf .Imprint ==nil {_cadf .Imprint =_cef .Imprint ;};if _cadf .NoProof ==nil {_cadf .NoProof =_cef .NoProof ;};if _cadf .SnapToGrid ==nil {_cadf .SnapToGrid =_cef .SnapToGrid ;};if _cadf .Vanish ==nil {_cadf .Vanish =_cef .Vanish ;};if _cadf .WebHidden ==nil {_cadf .WebHidden =_cef .WebHidden ;};if _cadf .Color ==nil {_cadf .Color =_cef .Color ;};if _cadf .Spacing ==nil {_cadf .Spacing =_cef .Spacing ;};if _cadf .W ==nil {_cadf .W =_cef .W ;};if _cadf .Kern ==nil {_cadf .Kern =_cef .Kern ;};if _cadf .Position ==nil {_cadf .Position =_cef .Position ;};if _cadf .Sz ==nil {_cadf .Sz =_cef .Sz ;};if _cadf .SzCs ==nil {_cadf .SzCs =_cef .SzCs ;};if _cadf .Highlight ==nil {_cadf .Highlight =_cef .Highlight ;};if _cadf .U ==nil {_cadf .U =_cef .U ;};if _cadf .Effect ==nil {_cadf .Effect =_cef .Effect ;};if _cadf .Bdr ==nil {_cadf .Bdr =_cef .Bdr ;};if _cadf .Shd ==nil {_cadf .Shd =_cef .Shd ;};if _cadf .FitText ==nil {_cadf .FitText =_cef .FitText ;};if _cadf .VertAlign ==nil {_cadf .VertAlign =_cef .VertAlign ;};if _cadf .Rtl ==nil {_cadf .Rtl =_cef .Rtl ;};if _cadf .Cs ==nil {_cadf .Cs =_cef .Cs ;};if _cadf .Em ==nil {_cadf .Em =_cef .Em ;};if _cadf .Lang ==nil {_cadf .Lang =_cef .Lang ;};if _cadf .EastAsianLayout ==nil {_cadf .EastAsianLayout =_cef .EastAsianLayout ;};if _cadf .SpecVanish ==nil {_cadf .SpecVanish =_cef .SpecVanish ;};if _cadf .OMath ==nil {_cadf .OMath =_cef .OMath ;};if _cadf .RPrChange ==nil {_cadf .RPrChange =_cef .RPrChange ;};return _cadf ;};func (_fbaa *convertContext )adjustHeights (_babg float64 ){if _fbaa ._fcdba ._dbe < _babg {_fbaa ._ebdd ._fde +=(_babg -_fbaa ._fcdba ._dbe );_fbaa ._fcdba ._dbe =_babg ;};};type romanMatch struct{_ffbf int ;_fdefa string ;};func (_eadd *convertContext )addRelativeCBCs (_gabg []*_eg .EG_ContentBlockContent ){for _ ,_fgbg :=range _gabg {_eadd .addHdrFtr (_fgbg .P );};};type word struct{_afd []*symbol ;_eff float64 ;_eba float64 ;_bff bool ;};type zoneToSkip struct{_ea *_ab .Rectangle ;_eeg *_eg .WdEG_WrapTypeChoice ;};func _fbbc (_eagd *_eg .EG_RunInnerContent )bool {if _bdfc :=_eagd .Br ;_bdfc !=nil {return _bdfc .TypeAttr ==_eg .ST_BrTypePage ;};return false ;};func (_ggb *convertContext )addAnchorExtra (_eegc []*_eg .EG_PContent ){for _ ,_gff :=range _eegc {for _ ,_cddc :=range _gff .EG_ContentRunContent {if _ffdb :=_cddc .R ;_ffdb !=nil {for _ ,_bgee :=range _ffdb .Extra {if _geba ,_ecfg :=_bgee .(*_eg .AlternateContentRun );_ecfg {if _dbfb :=_geba .Choice ;_dbfb !=nil {if _gad :=_dbfb .Drawing ;_gad !=nil {for _ ,_feb :=range _gad .Anchor {var _fca ,_baaf ,_edd ,_ggfa float64 ;_bgbb ,_ecbb :=_feb .PositionH ,_feb .PositionV ;if _gee :=_bgbb .Choice ;_gee !=nil {if _gee .PosOffset !=nil {_fca =_dc .FromEMU (int64 (*_gee .PosOffset ));};};if _dffb :=_ecbb .Choice ;_dffb !=nil {if _dffb .PosOffset !=nil {_baaf =_dc .FromEMU (int64 (*_dffb .PosOffset ));};};if _fgcd :=_feb .Extent ;_fgcd !=nil {_ggfa =_dc .FromEMU (_fgcd .CxAttr );_edd =_dc .FromEMU (_fgcd .CyAttr );};_caa :=_ggb ._ebdd ._dbf +_baaf ;_cdaa :=_caa +_edd ;_cfbg :=_ggb ._ebdd ._gfg +_fca ;_ebd :=_cfbg +_ggfa ;_gfb :=_baaf +_edd ;if _gfb > _ggb ._ebdd ._af {_ggb ._ebdd ._af =_gfb ;};if _feb .Choice !=nil &&_feb .Choice .WrapNone ==nil {_ggb ._ebdd ._aabd =append (_ggb ._ebdd ._aabd ,&zoneToSkip {_ea :&_ab .Rectangle {Top :_caa ,Bottom :_cdaa ,Left :_cfbg ,Right :_ebd },_eeg :_feb .Choice });};if _dba :=_feb .Graphic ;_dba !=nil {if _bcbe :=_dba .GraphicData ;_bcbe !=nil {for _ ,_cedf :=range _bcbe .Any {if _dbdf ,_bad :=_cedf .(*_eg .WdWsp );_bad {_fafc ,_eaf :=_ggb .makeBlockFromWdWsp (_dbdf );if _eaf !=nil {_f .Log .Debug ("C\u0061\u006e\u006e\u006ft \u0072e\u0061\u0064\u0020\u0062\u006co\u0063\u006b\u003a\u0020\u0025\u0073",_eaf );};if _fafc !=nil {_fafc ._cca .Scale (_ggfa /_fafc ._cca .Width (),_edd /_fafc ._cca .Height ());_fafc ._abaf =_cfbg ;_fafc ._ace =_caa ;if _feb .BehindDocAttr {_ggb ._ebdd ._cff =append (_ggb ._ebdd ._cff ,_fafc );}else {_ggb ._ebdd ._aab =append (_ggb ._ebdd ._aab ,_fafc );};};};};};};};};};};};};};};};func (_cbb *convertContext )addRelativeCRC (_fecc []*_eg .EG_ContentRunContent ,_egcc *_eg .CT_PPr ){for _ ,_bgec :=range _fecc {if _bage :=_bgec .R ;_bage !=nil {_ebbg :=_cgfb (_cbb ._faec ,_bage .RPr ,_egcc );if _cbb ._eabf !=nil {_cbb .addRelativeRIC (nil ,_ebbg );_cbb ._eabf =nil ;};for _ ,_caaf :=range _bage .EG_RunInnerContent {_cbb .addRelativeRIC (_caaf ,_ebbg );};};};};func (_gcbe *convertContext )makePdfImageFromGraphics (_ceafb *_bf .Pic )(*_bbd .Image ,error ){if _fafee :=_ceafb .BlipFill ;_fafee !=nil {if _fgda :=_fafee .Blip ;_fgda !=nil {if _aefb :=_fgda .EmbedAttr ;_aefb !=nil {_aggc ,_egae :=_gcbe ._faec .GetImageObjByRelId (*_aefb );if _egae !=nil {return nil ,_egae ;};_ddec ,_egae :=_d .Open (_aggc .Path );if _egae !=nil {return nil ,_egae ;};_fcbae ,_egae :=_bb .ReadAll (_ddec );if _egae !=nil {return nil ,_egae ;};_gffc ,_egae :=_gcbe ._bbde .NewImageFromData (_fcbae );if _egae !=nil {return nil ,_egae ;};return _gffc ,nil ;};};};return nil ,nil ;};

// ConvertToPdf converts document to PDF file. This package is beta, breaking changes can take place.
func ConvertToPdf (d *_df .Document )*_bbd .Creator {return ConvertToPdfWithOptions (d ,nil )};func _cgfb (_acfd *_df .Document ,_bedb *_eg .CT_RPr ,_gdgd *_eg .CT_PPr )*_eg .CT_RPr {var _cdfae ,_dgee *_eg .CT_RPr ;if _bedb ==nil {_bedb =_eg .NewCT_RPr ();};var _ddfc *_eg .CT_ParaRPr ;if _gdgd !=nil &&_gdgd .RPr !=nil {_ddfc =_gdgd .RPr ;};if _ddfc ==nil {_ddfc =_eg .NewCT_ParaRPr ();};if _bedb .RStyle !=nil {_cdbd :=_acfd .GetStyleByID (_bedb .RStyle .ValAttr );if _gcaa :=_cdbd .X ();_gcaa !=nil {_cdfae =_gcaa .RPr ;};};if _cdfae ==nil {_cdfae =_eg .NewCT_RPr ();};if _ddfc .RStyle !=nil {_cgaag :=_acfd .GetStyleByID (_ddfc .RStyle .ValAttr );if _eggac :=_cgaag .X ();_eggac !=nil {_dgee =_eggac .RPr ;};};if _dgee ==nil {_dgee =_eg .NewCT_RPr ();};if _bedb .Color ==nil {if _cdfae .Color !=nil {_bedb .Color =_cdfae .Color ;}else if _ddfc .Color !=nil {_bedb .Color =_ddfc .Color ;}else if _dgee .Color !=nil {_bedb .Color =_dgee .Color ;};};if _bedb .Spacing ==nil {if _cdfae .Spacing !=nil {_bedb .Spacing =_cdfae .Spacing ;}else if _ddfc .Spacing !=nil {_bedb .Spacing =_ddfc .Spacing ;}else if _dgee .Spacing !=nil {_bedb .Spacing =_dgee .Spacing ;};};if _bedb .Sz ==nil {if _cdfae .Sz !=nil {_bedb .Sz =_cdfae .Sz ;}else if _ddfc .Sz !=nil {_bedb .Sz =_ddfc .Sz ;}else if _dgee .Sz !=nil {_bedb .Sz =_dgee .Sz ;};};if _bedb .SzCs ==nil {if _cdfae .SzCs !=nil {_bedb .SzCs =_cdfae .SzCs ;}else if _ddfc .SzCs !=nil {_bedb .SzCs =_ddfc .SzCs ;}else if _dgee .SzCs !=nil {_bedb .SzCs =_dgee .SzCs ;};};if _bedb .B ==nil {if _cdfae .B !=nil {_bedb .B =_cdfae .B ;}else if _ddfc .B !=nil {_bedb .B =_ddfc .B ;}else if _dgee .B !=nil {_bedb .B =_dgee .B ;};};if _bedb .I ==nil {if _cdfae .I !=nil {_bedb .I =_cdfae .I ;}else if _ddfc .I !=nil {_bedb .I =_ddfc .I ;}else if _dgee .I !=nil {_bedb .I =_dgee .I ;};};if _bedb .RFonts ==nil {if _cdfae .RFonts !=nil {_bedb .RFonts =_cdfae .RFonts ;}else if _ddfc .RFonts !=nil {_bedb .RFonts =_ddfc .RFonts ;}else if _dgee .RFonts !=nil {_bedb .RFonts =_dgee .RFonts ;};};if _bedb .VertAlign ==nil {if _cdfae .VertAlign !=nil {_bedb .VertAlign =_cdfae .VertAlign ;}else if _ddfc .VertAlign !=nil {_bedb .VertAlign =_ddfc .VertAlign ;}else if _dgee .VertAlign !=nil {_bedb .VertAlign =_dgee .VertAlign ;};};return _bedb ;};func (_affc *convertContext )getStyleProps (_aggf string )(*_eg .CT_PPrGeneral ,*_eg .CT_RPr ){var _abe *_eg .CT_PPrGeneral ;var _fede *_eg .CT_RPr ;_aeef :=_affc ._faec .GetStyleByID (_aggf );if _cfda :=_aeef .X ();_cfda !=nil {_abe =_cfda .PPr ;_fede =_cfda .RPr ;if _fbdb :=_cfda .BasedOn ;_fbdb !=nil {_cgae ,_cfdba :=_affc .getStyleProps (_fbdb .ValAttr );_abe =_dadc (_abe ,_cgae );_fede =_bgce (_fede ,_cfdba );};};return _abe ,_fede ;};func _eddb (_bece ,_gcgd *_eg .CT_HpsMeasure )float64 {var _gcf float64 ;_aeeb :=_ab .DefaultFontSize ;if _bece !=nil {_gcf =float64 (*_bece .ValAttr .ST_UnsignedDecimalNumber );}else if _gcgd !=nil {_gcf =float64 (*_gcgd .ValAttr .ST_UnsignedDecimalNumber );};if _gcf !=0{_aeeb =_gcf /24*_ab .DefaultFontSize ;};return _aeeb ;};

// FontStyle represents a kind of font styling. It can be FontStyle_Regular, FontStyle_Bold, FontStyle_Italic and FontStyle_BoldItalic.
type FontStyle =_ab .FontStyle ;func _efec (_feab *_eg .CT_TblWidth ,_dfc ,_dcgff float64 )float64 {if _feab !=nil {if _gadc :=_feab .WAttr ;_gadc !=nil {if _dfeg :=_gadc .ST_DecimalNumberOrPercent ;_dfeg !=nil {if _gadb :=_dfeg .ST_UnqualifiedPercentage ;_gadb !=nil {switch _feab .TypeAttr {case _eg .ST_TblWidthDxa :return float64 (*_gadb )/56.7;case _eg .ST_TblWidthPct :return float64 (*_gadb )/100*_dfc ;default:return _dcgff ;};};};};};return _dcgff ;};func (_afb *convertContext )adjustRightBoundOfLastSpan (){_def :=_afb ._agg ._bae ;_dbaf :=_afb ._fcdba ._ge +_afb ._ebdd ._dbf ;_gfa :=_dbaf +_afb ._fcdba ._dbe ;for _ ,_ged :=range _afb ._bbdef ._gb {if ((_dbaf > _ged ._ea .Top &&_dbaf < _ged ._ea .Bottom )||(_gfa > _ged ._ea .Top &&_dbaf < _ged ._ea .Bottom ))&&(_def > _ged ._ea .Left ){_def =_ged ._ea .Left ;};};_afb ._agg ._bae =_def ;};func (_ccad *convertContext )moveCurrentParagraphToNewPage (){_ccad .newPage ();_bedf :=_ccad ._ebdd ._dbf -_ccad ._bbdef ._cb ;_ccad ._ebdd ._dbf -=_bedf ;for _ ,_bdcd :=range _ccad ._ebdd ._aabd {_bdcd ._ea .Translate (0,-_bedf );};for _ ,_eegg :=range _ccad ._ebdd ._aab {_eegg ._ace -=_bedf ;};for _ ,_gfab :=range _ccad ._ebdd ._cff {_gfab ._ace -=_bedf ;};for _ ,_ecad :=range _ccad ._ebdd ._acb {_ecad ._abf -=_bedf ;};for _ ,_fbe :=range _ccad ._ebdd ._ba {_fbe ._abf -=_bedf ;};};

// RegisterFontsFromDirectory registers all fonts from the given directory automatically detecting font families and styles. For composite fonts use RegisterCompositeFontsFromDirectory.
func RegisterFontsFromDirectory (dirName string )error {return _ab .RegisterFontsFromDirectory (dirName )};func (_dege *convertContext )makeRunStyle (_bacd *_eg .CT_RPr ,_fdfe ,_ggeg ,_befc ,_fedd ,_cfae bool )(_bbd .TextStyle ,bool ,bool ,*_bbd .Color ){var _bgae *_bbd .Color ;_bbdg :=_dege ._bbde .NewTextStyle ();if _bacd !=nil {_dgb :=_ab .FontStyle_Regular ;_bgeb :=_cdeca (_bacd .B );_gdaf :=_cdeca (_bacd .I );if _bgeb &&_gdaf {_dgb =_ab .FontStyle_BoldItalic ;}else if _bgeb {_dgb =_ab .FontStyle_Bold ;}else if _gdaf {_dgb =_ab .FontStyle_Italic ;};if _fedd {_bbdg .Font =_ab .AssignStdFontByName (_bbdg ,"\u0053\u0079\u006d\u0062\u006f\u006c");}else {_gagc :="\u0064e\u0066\u0061\u0075\u006c\u0074";if _aggcb :=_bacd .RFonts ;_aggcb !=nil {if _bbfc :=_aggcb .AsciiAttr ;_bbfc !=nil {_gagc =*_bbfc ;}else if _ggagg :=_aggcb .HAnsiAttr ;_ggagg !=nil {_gagc =*_ggagg ;}else {_aacf :=_dege ._effb ;if _aacf !=nil {if _gffb :=_aacf .RFonts ;_gffb !=nil {if _fefa :=_aggcb .HintAttr ;_fefa ==_eg .ST_HintEastAsia {if _gffb .EastAsiaAttr !=nil {_gagc =*_aacf .RFonts .EastAsiaAttr ;};}else {if _gdag :=_gffb .AsciiAttr ;_gdag !=nil {_gagc =*_gdag ;}else if _ebbd :=_gffb .HAnsiAttr ;_ebbd !=nil {_gagc =*_ebbd ;};};_befd :="";if _dafgb :=_gffb .AsciiThemeAttr ;_dafgb ==_eg .ST_ThemeMajorAscii ||_dafgb ==_eg .ST_ThemeMajorHAnsi {_befd =_fcdag ;}else if _gbaf :=_gffb .AsciiThemeAttr ;_gbaf ==_eg .ST_ThemeMinorAscii ||_gbaf ==_eg .ST_ThemeMinorHAnsi {_befd =_bffd ;}else {if _bcgbf :=_gffb .HAnsiThemeAttr ;_bcgbf ==_eg .ST_ThemeMajorAscii ||_bcgbf ==_eg .ST_ThemeMajorHAnsi {_befd =_fcdag ;}else if _abbg :=_gffb .HAnsiThemeAttr ;_abbg ==_eg .ST_ThemeMinorAscii ||_abbg ==_eg .ST_ThemeMinorHAnsi {_befd =_bffd ;};};if _befd !=""{_becdg :=_dege ._faec .Themes ();for _ ,_eaeb :=range _becdg {if _eaeb .ThemeElements !=nil {if _afedc :=_eaeb .ThemeElements .FontScheme ;_afedc !=nil {if _afedc .MajorFont !=nil &&_befd ==_fcdag {if _afedc .MajorFont .Latin !=nil {_gagc =_afedc .MajorFont .Latin .TypefaceAttr ;};}else if _afedc .MinorFont !=nil &&_befd ==_bffd {if _afedc .MinorFont .Latin !=nil {_gagc =_afedc .MinorFont .Latin .TypefaceAttr ;};};break ;};};};};};};};};if _eeadd ,_bbddf :=_ab .StdFontsMap [_gagc ];_bbddf {_bbdg .Font =_ab .AssignStdFontByName (_bbdg ,_eeadd [_dgb ]);}else if _gbfe :=_ab .GetRegisteredFont (_gagc ,_dgb );_gbfe !=nil {_bbdg .Font =_gbfe ;}else {_f .Log .Debug ("\u0046\u006f\u006e\u0074\u0020\u0025\u0073\u0020\u0077\u0069\u0074h\u0020\u0073\u0074\u0079\u006c\u0065\u0020\u0025s\u0020i\u0073\u0020\u006e\u006f\u0074\u0020\u0066\u006f\u0075\u006e\u0064\u002c\u0020\u0072\u0065\u0073\u0065\u0074 \u0074\u006f\u0020\u0064\u0065\u0066\u0061\u0075\u006c\u0074\u002e",_gagc ,_dgb );_bbdg .Font =_ab .AssignStdFontByName (_bbdg ,_ab .StdFontsMap ["\u0064e\u0066\u0061\u0075\u006c\u0074"][_dgb ]);};};_eaafb :=_eddb (_bacd .Sz ,_bacd .SzCs );if _bdbf :=_bacd .VertAlign ;_bdbf !=nil {_feed :=_bdbf .ValAttr ;_fdfe =_feed ==_ff .ST_VerticalAlignRunSuperscript ;_ggeg =_feed ==_ff .ST_VerticalAlignRunSubscript ;};if _eaafb > _dege ._ebaf {_dege ._ebaf =_eaafb ;};if _fdfe ||_ggeg {_eaafb *=0.64;};if _befc {if _fdfe {_bbdg .TextRise =1.5;};if _ggeg {_bbdg .TextRise =-1.5;};};_bbdg .FontSize =_eaafb ;_ddgc :=0.0;if _daeg :=_bacd .Spacing ;_daeg !=nil {_ddgc =_ab .PointsFromTwips (*_daeg .ValAttr .Int64 );};_bbdg .CharSpacing =_ddgc ;_edegb :=_bbd .ColorBlack ;if _bacd .Color !=nil {_adaf :=_bacd .Color .ValAttr .ST_HexColorRGB ;if _adaf !=nil {_edegb =_bbd .ColorRGBFromHex ("\u0023"+*_adaf );};};if _befc {_bbb ,_cbbb ,_becge :=_edegb .ToRGB ();_bbb ,_cbbb ,_becge =_ab .Lighten (_bbb ),_ab .Lighten (_cbbb ),_ab .Lighten (_becge );_edegb =_bbd .ColorRGBFromArithmetic (_bbb ,_cbbb ,_becge );};_bbdg .Color =_edegb ;if _cfae {_bgae =&_edegb ;};if _bacd .U !=nil &&_bacd .U .ValAttr !=_eg .ST_UnderlineNone &&!_fedd {_bgae =&_edegb ;if _ccbg :=_bacd .U .ColorAttr ;_ccbg !=nil {if _dfba :=_ccbg .ST_HexColorRGB ;_dfba !=nil {_abggb :=_bbd .ColorRGBFromHex ("\u0023"+*_dfba );_bgae =&_abggb ;};};};};return _bbdg ,_fdfe ,_ggeg ,_bgae ;};func (_egb *convertContext )addParagraphWithTable (_bafa _bbd .Table ,_gebf ,_bebg float64 ){_egb .newParagraph ();_egb ._ebdd ._gc =&_ab .Rectangle {Top :_egcd (2),Bottom :_egcd (2),Left :0,Right :0};_egb ._ebdd ._cd =&tableWrapper {_fda :&_bafa ,_ad :_gebf };_egb ._ebdd ._efg =_bebg ;_egb ._ebdd ._fde =_bafa .Height ();_egb .determineParagraphBounds ();_egb .addCurrentParagraphToCurrentPage ();};func _bcec (_febbc int ,_aad bool )string {_faa :=_bd .NewBuffer ([]byte {});for _ ,_fbba :=range _dbga {for {if _febbc < _fbba ._ffbf {break ;};_faa .WriteString (_fbba ._fdefa );_febbc -=_fbba ._ffbf ;};};_faeec :=_faa .String ();if _aad {_faeec =_e .ToUpper (_faeec );};return _faeec ;};func (_abd *convertContext )addCurrentParagraphToCurrentPage (){_abd ._bbdef ._cb =_abd ._ebdd ._dbf +_abd ._ebdd ._gc .Top +_abd ._ebdd ._fde +_abd ._ebdd ._gc .Bottom ;_abd ._bbdef ._ca =append (_abd ._bbdef ._ca ,_abd ._ebdd ._acb ...);_abd ._bbdef ._gf =append (_abd ._bbdef ._gf ,_abd ._ebdd ._ba ...);_abd ._bbdef ._fe =append (_abd ._bbdef ._fe ,_abd ._ebdd ._aab ...);_abd ._bbdef ._efa =append (_abd ._bbdef ._efa ,_abd ._ebdd ._cff ...);_abd ._bbdef ._gb =append (_abd ._bbdef ._gb ,_abd ._ebdd ._aabd ...);_abd ._bbdef ._be =append (_abd ._bbdef ._be ,_abd ._ebdd );_abd .adjustRightBoundOfLastSpan ();_abd .alignParagraph ();if len (_abd ._bbdef ._ac )==0&&len (_abd ._ebdd ._ga )> 0{_abd ._bbdef ._ag .Bottom -=_ecg ;};_abd ._bbdef ._ac =append (_abd ._bbdef ._ac ,_abd ._ebdd ._ga ...);_abd ._bbdef ._ag .Bottom -=_abd ._ebdd ._fae ;};var _ecg =_egcd (6);const (_bffd ="\u006di\u006e\u006f\u0072\u0046\u006f\u006et";_fcdag ="\u006da\u006a\u006f\u0072\u0046\u006f\u006et";);func _edbcc (_ddcg *_eg .CT_PPr ,_abgf *_eg .CT_PPrGeneral ,_fcgf *_eg .CT_RPr )*_eg .CT_PPr {if _ddcg ==nil {_ddcg =_eg .NewCT_PPr ();};if _abgf !=nil {if _ddcg .Jc ==nil &&_abgf .Jc !=nil {_ddcg .Jc =_abgf .Jc ;};if _ddcg .Spacing ==nil {_ddcg .Spacing =_abgf .Spacing ;}else if _ceaf :=_abgf .Spacing ;_ceaf !=nil {if _ddcg .Spacing .BeforeAttr ==nil {_ddcg .Spacing .BeforeAttr =_ceaf .BeforeAttr ;};if _ddcg .Spacing .AfterAttr ==nil {_ddcg .Spacing .AfterAttr =_ceaf .AfterAttr ;};if _ddcg .Spacing .LineAttr ==nil {_ddcg .Spacing .LineAttr =_ceaf .LineAttr ;};};if _abgf .Ind !=nil {if _ddcg .Ind ==nil {_ddcg .Ind =_abgf .Ind ;}else {_cgbf ,_dda :=_ddcg .Ind .FirstLineAttr ==nil ,_ddcg .Ind .HangingAttr ==nil ;if _cgbf &&_dda &&_abgf .Ind .FirstLineAttr !=nil {_ddcg .Ind .FirstLineAttr =_abgf .Ind .FirstLineAttr ;_cgbf =false ;};if _cgbf &&_dda &&_abgf .Ind .HangingAttr !=nil {_ddcg .Ind .HangingAttr =_abgf .Ind .HangingAttr ;};if _ddcg .Ind .LeftAttr ==nil {_ddcg .Ind .LeftAttr =_abgf .Ind .LeftAttr ;};if _ddcg .Ind .RightAttr ==nil {_ddcg .Ind .RightAttr =_abgf .Ind .RightAttr ;};};};if _ddcg .Tabs ==nil &&_abgf .Tabs !=nil {_ddcg .Tabs =_abgf .Tabs ;};if _abgf .PBdr !=nil {_ddcg .PBdr =_abgf .PBdr ;};};if _fcgf !=nil {var _geed _eg .CT_ParaRPr ;if _ddcg .RPr ==nil {_geed =*_eg .NewCT_ParaRPr ();}else {_geed =*_ddcg .RPr ;};if _geed .Color ==nil &&_fcgf .Color !=nil {_geed .Color =_fcgf .Color ;};if _geed .Spacing ==nil &&_fcgf .Spacing !=nil {_geed .Spacing =_fcgf .Spacing ;};if _geed .Sz ==nil &&_fcgf .Sz !=nil {_geed .Sz =_fcgf .Sz ;};if _geed .SzCs ==nil &&_fcgf .SzCs !=nil {_geed .SzCs =_fcgf .SzCs ;};if _geed .B ==nil &&_fcgf .B !=nil {_geed .B =_fcgf .B ;};if _geed .I ==nil &&_fcgf .I !=nil {_geed .I =_fcgf .I ;};if _geed .RFonts ==nil &&_fcgf .RFonts !=nil {_geed .RFonts =_fcgf .RFonts ;};if _geed .VertAlign ==nil &&_fcgf .VertAlign !=nil {_geed .VertAlign =_fcgf .VertAlign ;};if _geed .Bdr ==nil &&_fcgf .Bdr !=nil {_geed .Bdr =_fcgf .Bdr ;};_ddcg .RPr =&_geed ;};return _ddcg ;};

// ConvertToPdfWithOptions convert the document to PDF with file given options.
func ConvertToPdfWithOptions (d *_df .Document ,opts *Options )*_bbd .Creator {var _ddgb map[string ]string ;if opts !=nil &&opts .ProcessFields {_ddgb =_egaf (d );};var _ebdbf *_eg .CT_PPrGeneral ;var _cfg *_eg .CT_RPr ;if _fgb :=d .Styles .X ().DocDefaults ;_fgb !=nil {if _aafa :=_fgb .PPrDefault ;_aafa !=nil {_ebdbf =_aafa .PPr ;};if _fgaa :=_fgb .RPrDefault ;_fgaa !=nil {_cfg =_fgaa .RPr ;};};_edga ,_baef :=_egcd (210),_egcd (297);_ddbb :=float64 (_dc .Inch *1);_aecg ,_gacd ,_afbe ,_ceadd :=_ddbb ,_ddbb ,_ddbb ,_ddbb ;var _bbcd ,_bbe float64 ;if _ebcgf :=d .BodySection ().X ();_ebcgf !=nil {if _abdc :=_ebcgf .PgMar ;_abdc !=nil {if _abdc .LeftAttr .ST_UnsignedDecimalNumber !=nil {_aecg =_ab .PointsFromTwips (int64 (*_abdc .LeftAttr .ST_UnsignedDecimalNumber ));};if _abdc .LeftAttr .ST_UnsignedDecimalNumber !=nil {_gacd =_ab .PointsFromTwips (int64 (*_abdc .RightAttr .ST_UnsignedDecimalNumber ));};if _abdc .TopAttr .Int64 !=nil {_afbe =_ab .PointsFromTwips (*_abdc .TopAttr .Int64 );};if _abdc .BottomAttr .Int64 !=nil {_ceadd =_ab .PointsFromTwips (*_abdc .BottomAttr .Int64 );};if _abdc .HeaderAttr .ST_UnsignedDecimalNumber !=nil {_bbcd =_ab .PointsFromTwips (int64 (*_abdc .HeaderAttr .ST_UnsignedDecimalNumber ));};if _abdc .FooterAttr .ST_UnsignedDecimalNumber !=nil {_bbe =_ceadd -_ab .PointsFromTwips (int64 (*_abdc .FooterAttr .ST_UnsignedDecimalNumber ));};};if _cdfa :=_ebcgf .PgSz ;_cdfa !=nil {if _cdfa .WAttr !=nil {_edga =_ab .PointsFromTwips (int64 (*_cdfa .WAttr .ST_UnsignedDecimalNumber ));};if _cdfa .HAttr !=nil {_baef =_ab .PointsFromTwips (int64 (*_cdfa .HAttr .ST_UnsignedDecimalNumber ));};};};if d .Settings .X ().DefaultTabStop ==nil {_gggb =_egcd (12.7);}else {_gggb =_ab .PointsFromTwips (int64 (*d .Settings .X ().DefaultTabStop .ValAttr .ST_UnsignedDecimalNumber ));};_bfdc :=_bbd .New ();_bfdc .SetPageSize (_bbd .PageSize {_edga ,_baef });_bfdc .SetPageMargins (_aecg ,_gacd ,_afbe ,_ceadd );for _ ,_eaea :=range d .Headers (){_ddcd :=&convertContext {_bbde :_bfdc ,_faec :d ,_dccgf :_ebdbf ,_effb :_cfg ,_acgc :true ,_edcfe :_aecg ,_cead :_bbcd };_ddcd .addRelativeCBCs (_eaea .X ().EG_ContentBlockContent );};for _ ,_eabc :=range d .Footers (){_cdbgg :=&convertContext {_bbde :_bfdc ,_faec :d ,_dccgf :_ebdbf ,_effb :_cfg ,_cdae :true ,_edcfe :_aecg ,_ebfb :_bbe };_cdbgg .addRelativeCBCs (_eabc .X ().EG_ContentBlockContent );};_cedg :=&convertContext {_bbde :_bfdc ,_faec :d ,_dccgf :_ebdbf ,_effb :_cfg ,_bgf :&_ab .Rectangle {Top :_afbe ,Bottom :_baef -_ceadd ,Left :_aecg ,Right :_edga -_gacd },_acg :[]note {},_bbfe :map[int64 ]map[int64 ]int64 {},_gcegb :_ddgb };for _ ,_efgg :=range d .X ().Body .EG_BlockLevelElts {_cedg .addAbsoluteCBCs (_efgg .EG_ContentBlockContent );};_cedg .addEndnotes ();_cedg .alignSymbolsVertically ();_cedg .drawPages ();return _bfdc ;};func _egaf (_abaeb *_df .Document )map[string ]string {_fdeba :=map[string ]string {};for _ ,_cab :=range _abaeb .Paragraphs (){for _ ,_fag :=range _cab .Runs (){for _ ,_ffgg :=range _fag .X ().EG_RunInnerContent {if _cdaef :=_ffgg .InstrText ;_cdaef !=nil {_ffgb ,_fcfg :=_cdfed (_cdaef .Content );if _ffgb !=""&&_fcfg !=""{_fdeba [_ffgb ]=_fcfg ;};};};};};return _fdeba ;};func (_cfb *convertContext )addAbsoluteCRC (_abg []*_eg .EG_ContentRunContent ,_fdc *_eg .CT_PPr )bool {for _ ,_gac :=range _abg {if _edb :=_gac .R ;_edb !=nil {_ecf :=_cgfb (_cfb ._faec ,_edb .RPr ,_fdc );if _cfb ._eabf !=nil {_cfb .addAbsoluteRIC (nil ,_ecf );_cfb ._eabf =nil ;};for _ ,_ggaa :=range _edb .EG_RunInnerContent {if _cfb .addAbsoluteRIC (_ggaa ,_ecf ){return true ;};};for _ ,_egece :=range _edb .Extra {if _fdad ,_fega :=_egece .(*_eg .AlternateContentRun );_fega {if _add :=_fdad .Choice ;_add !=nil {if _cae :=_add .Drawing ;_cae !=nil {if len (_cae .Inline )> 0{for _ ,_aeb :=range _cae .Inline {_cga :=_aeb .Extent ;if _cga ==nil {return false ;};_acaf :=_dc .FromEMU (_cga .CxAttr );_ecda :=_dc .FromEMU (_cga .CyAttr );if _gag :=_aeb .Graphic ;_gag !=nil {if _edce :=_gag .GraphicData ;_edce !=nil {for _ ,_bded :=range _edce .Any {if _acc ,_geb :=_bded .(*_eg .WdWsp );_geb {_bcgd ,_cdec :=_cfb .makeBlockFromWdWsp (_acc );if _cdec !=nil {_f .Log .Debug ("C\u0061\u006e\u006e\u006ft \u0072e\u0061\u0064\u0020\u0062\u006co\u0063\u006b\u003a\u0020\u0025\u0073",_cdec );};if _bcgd ==nil {continue ;};_bcgd ._cca .Scale (_acaf /_bcgd ._cca .Width (),_ecda /_bcgd ._cca .Height ());_cfb .addInlineSymbol (&symbol {_fg :_ecda ,_acd :_acaf ,_dd :_bcgd });};};};};};};};};};};};};return false ;};func (_ecc *convertContext )alignParagraph (){_ade :=_ecc ._ebdd ;if _ade ._bda ==_bbd .TextAlignmentLeft {return ;};_fab :=len (_ade ._eaa )-1;for _ede ,_dge :=range _ade ._eaa {_dbdb :=len (_dge ._dg )-1;for _efag ,_ddf :=range _dge ._dg {_ffg :=true ;_aff :=len (_ddf ._dce );_fcbg :=0.0;for _ecd :=len (_ddf ._dce )-1;_ecd >=0;_ecd --{_bdd :=_ddf ._dce [_ecd ];if _ffg &&_bdd ._bff {_aff =_ecd ;}else {_ffg =false ;for _ ,_gef :=range _bdd ._afd {_fcbg +=_gef ._acd ;};};};_ddf ._dce =_ddf ._dce [:_aff ];_dcge :=_ddf ._bae -_ddf ._dcg -_fcbg ;switch _ade ._bda {case _bbd .TextAlignmentRight :_ddf .moveRight (_dcge );case _bbd .TextAlignmentCenter :_ddf .moveRight (_dcge /2);case _bbd .TextAlignmentJustify :if _ede !=_fab ||_efag !=_dbdb {_dfed :=[]*word {};for _ ,_bge :=range _ddf ._dce {if _bge ._bff {_dfed =append (_dfed ,_bge );};};_baa :=_dcge /float64 (len (_dfed ));for _ ,_bcb :=range _dfed {_bcb ._eba +=_baa ;};var _cgb *word ;for _ ,_cedd :=range _ddf ._dce {if _cgb !=nil {_cedd ._eff =_cgb ._eff +_cgb ._eba ;};_cgb =_cedd ;};};};};};};func (_edc *convertContext )addAbsoluteCBCs (_bga []*_eg .EG_ContentBlockContent ){for _ ,_gfga :=range _bga {for _ ,_faf :=range _gfga .P {_edc .newParagraph ();_fff :=_edc ._faec .Styles .ParagraphStyles ();for _ ,_cee :=range _fff {if _ggc :=_cee .X ().DefaultAttr ;_ggc !=nil {if _cedb :=_ggc .Bool ;_cedb !=nil &&*_cedb {_faf .PPr =_edbcc (_faf .PPr ,_cee .X ().PPr ,_cee .X ().RPr );};if _aaed :=_ggc .ST_OnOff1 ;_aaed ==_ff .ST_OnOff1On {_faf .PPr =_edbcc (_faf .PPr ,_cee .X ().PPr ,_cee .X ().RPr );};break ;};};_ccd ,_dcc :=_edc .combinePPrWithStyles (_faf .PPr );if _dcc !=nil {_edc ._eabf =_dcc ;};_edc .assignPropsToAbsoluteParagraph (_ccd ,_edc ._ebdd );_edc .determineParagraphBounds ();_edc .newLine ();_edc .newWord ();_aafg :=_faf .EG_PContent ;if len (_aafg )==0{_edc .addEmptyLine ();}else {_edc .addAnchorBlocks (_aafg );_edc .addAnchorExtra (_aafg );if _edc .addAbsoluteEGPC (_aafg ,_ccd ){_edc .newPage ();continue ;};if _edc .currentParagraphOverflowsCurrentPage (){_edc .moveCurrentParagraphToNewPage ();_edc .addAbsoluteEGPC (_aafg ,_ccd );};_edc .addCurrentWordToParagraph ();};_edc .addCurrentParagraphToCurrentPage ();};for _ ,_cea :=range _gfga .Tbl {_edc .addAbsoluteTable (_cea );};};};func _baab (_cabg *_eg .CT_TblPr ,_gedd *_eg .CT_TblPrEx ,_ecga *_eg .CT_TcPr ,_fced ,_bcdad ,_fgfdg ,_bffga int )*_eg .CT_TcPr {if _ecga ==nil {_ecga =_eg .NewCT_TcPr ();};if _ecga ==nil {_ecga =_eg .NewCT_TcPr ();};if _gedd ==nil {_gedd =_eg .NewCT_TblPrEx ();};if _cabg ==nil {_cabg =_eg .NewCT_TblPr ();};if _ecga .TcBorders ==nil {_ecga .TcBorders =_eg .NewCT_TcBorders ();};if _gedd .TblBorders ==nil {_gedd .TblBorders =_eg .NewCT_TblBorders ();};if _cabg .TblBorders ==nil {_cabg .TblBorders =_eg .NewCT_TblBorders ();};if _ecga .TcBorders .Top ==nil {if _gedd .TblBorders .Top ==nil {_ecga .TcBorders .Top =_cecb (_cabg .TblBorders .Top ,_cabg .TblBorders .InsideH ,_fced ==0);}else {_ecga .TcBorders .Top =_cecb (_gedd .TblBorders .Top ,_gedd .TblBorders .InsideH ,_fced ==0);};};if _ecga .TcBorders .Bottom ==nil {if _gedd .TblBorders .Bottom ==nil {_ecga .TcBorders .Bottom =_cecb (_cabg .TblBorders .Bottom ,_cabg .TblBorders .InsideH ,_fced ==_fgfdg -1);}else {_ecga .TcBorders .Bottom =_cecb (_gedd .TblBorders .Bottom ,_gedd .TblBorders .InsideH ,_fced ==_fgfdg -1);};};if _ecga .TcBorders .Left ==nil {if _gedd .TblBorders .Left ==nil {_ecga .TcBorders .Left =_cecb (_cabg .TblBorders .Left ,_cabg .TblBorders .InsideV ,_bcdad ==0);}else {_ecga .TcBorders .Left =_cecb (_gedd .TblBorders .Left ,_gedd .TblBorders .InsideV ,_bcdad ==0);};};if _ecga .TcBorders .Right ==nil {if _gedd .TblBorders .Right ==nil {_ecga .TcBorders .Right =_cecb (_cabg .TblBorders .Right ,_cabg .TblBorders .InsideV ,_bcdad ==_bffga -1);}else {_ecga .TcBorders .Right =_cecb (_gedd .TblBorders .Right ,_gedd .TblBorders .InsideV ,_bcdad ==_bffga -1);};};if _ecga .Shd ==nil {if _fbf :=_cabg .Shd ;_fbf !=nil {_ecga .Shd =_fbf ;};}else {if _cabg .Shd !=nil &&_ecga .Shd .FillAttr ==nil {_ecga .Shd .FillAttr =_cabg .Shd .FillAttr ;};};if _ecga .TcMar ==nil {if _ceed :=_cabg .TblCellMar ;_ceed !=nil {_ecga .TcMar =_eg .NewCT_TcMar ();_ecga .TcMar .Left =_ceed .Left ;};}else {if _cabg .TblCellMar !=nil &&_ecga .TcMar .Left ==nil {_ecga .TcMar .Left =_cabg .TblCellMar .Left ;};};return _ecga ;};func _efcg (_gaee int64 ,_bafaf _eg .ST_NumberFormat )string {_ffbd :=int (_gaee );switch _bafaf {case _eg .ST_NumberFormatDecimal :return _c .Itoa (_ffbd );case _eg .ST_NumberFormatUpperRoman :return _bcec (_ffbd ,true );case _eg .ST_NumberFormatLowerRoman :return _bcec (_ffbd ,false );case _eg .ST_NumberFormatUpperLetter :return _bdgg (_ffbd ,true );case _eg .ST_NumberFormatLowerLetter :return _bdgg (_ffbd ,false );default:return _c .Itoa (_ffbd );};};func (_gaaa *convertContext )addHdrFtr (_bgff []*_eg .CT_P ){for _ ,_daea :=range _bgff {_ecaee :=_gaaa ._bbde .NewStyledParagraph ();_gaaa ._egggc =_ecaee ;_bgffc ,_faff :=_gaaa .combinePPrWithStyles (_daea .PPr );_ebgc ,_dcfgcc :=_gaaa .assignPropsToRelativeParagraph (_bgffc ,_ecaee );_gaaa .addRelativeEGPC (_daea .EG_PContent ,_bgffc ,_faff );if _gaaa ._acgc {_gaaa ._bbde .DrawHeader (func (_afca *_bbd .Block ,_fgbb _bbd .HeaderFunctionArgs ){_ecaee .SetPos (_gaaa ._edcfe +_dcfgcc ,_ebgc +_gaaa ._cead );_afca .Draw (_ecaee );});}else if _gaaa ._cdae {_gaaa ._bbde .DrawFooter (func (_bdbb *_bbd .Block ,_aaggg _bbd .FooterFunctionArgs ){_ecaee .SetPos (_gaaa ._edcfe +_dcfgcc ,_ebgc +_gaaa ._ebfb -_gaaa ._ebaf );_bdbb .Draw (_ecaee );});};};};func (_edcf *convertContext )currentParagraphOverflowsCurrentPage ()bool {_gbda :=_edcf ._ebdd ._dbf +_edcf ._ebdd ._gc .Top +_edcf ._ebdd ._gc .Bottom ;_ecgf :=_edcf ._bbdef ._ag .Bottom -_edcf ._ebdd ._fae ;if len (_edcf ._bbdef ._ac )==0&&len (_edcf ._ebdd ._ga )> 0{_ecgf -=_ecg ;};return _gbda +_edcf ._ebdd ._fde > _ecgf ||_gbda +_edcf ._ebdd ._af > _ecgf ;};func (_aceg *convertContext )makeBlockFromWdWsp (_efcf *_eg .WdWsp )(*block ,error ){if _ebbc :=_efcf .WChoice ;_ebbc !=nil {if _cbca :=_ebbc .Txbx ;_cbca !=nil {if _dafg :=_cbca .TxbxContent ;_dafg !=nil {if _dfef :=_dafg .EG_ContentBlockContent ;len (_dfef )> 0{if _ceff :=_efcf .SpPr ;_ceff !=nil {if _cac :=_ceff .Xfrm ;_cac !=nil {if _gbea :=_cac .Ext ;_gbea !=nil {_cfacf :=_dc .FromEMU (_gbea .CxAttr );_efd :=_dc .FromEMU (_gbea .CyAttr );_egab :=&_ab .Rectangle {Top :_daaa ,Bottom :_daaa ,Left :_daaa ,Right :_daaa };_bcece ,_dafcc :=_aceg .makePdfBlockFromCBCs ([][]*_eg .EG_ContentBlockContent {_dfef },_cfacf ,_efd ,_egab ,false ,nil );if _dafcc !=nil {return nil ,_dafcc ;};var _ccdf bool ;var _afde float64 ;var _dafa _bbd .Color ;if _fafcdb :=_ceff .PrstGeom ;_fafcdb !=nil {if _fafcdb .PrstAttr ==_aa .ST_ShapeTypeRect {if _fabg :=_ceff .Ln ;_fabg !=nil {if _ggfg :=_fabg .WAttr ;_ggfg !=nil {_ccdf =true ;_afde =_dc .FromEMU (int64 (*_ggfg ));_dafa =_bbd .ColorBlack ;if _adfb :=_fabg .SolidFill ;_adfb !=nil {if _gdge :=_adfb .SrgbClr ;_gdge !=nil {_dafa =_bbd .ColorRGBFromHex ("\u0023"+_gdge .ValAttr );};};};};};};_ccfa :=&block {_cca :_bcece ,_gab :_ccdf ,_ffb :_afde ,_bfe :_dafa };return _ccfa ,nil ;};};};};};};};return nil ,nil ;};func _cdeca (_abee *_eg .CT_OnOff )bool {if _abee !=nil {if _dfea :=_abee .ValAttr ;_dfea !=nil {if _cbgb :=_dfea .Bool ;_cbgb !=nil {return *_cbgb ;};return _dfea .ST_OnOff1 ==_ff .ST_OnOff1On ;};return true ;};return false ;};

// Options contains the options for convert process -
// e.g ProcessFields is when document contains fields
// and the value need to be processed also.
type Options struct{

// ProcessFields process the document fields if set to true, default is false.
ProcessFields bool ;};func (_effd *convertContext )addEmptyLine (){_effd .addTextSymbol (&symbol {_bed :"\u000d",_acd :0,_fg :_effd ._ebdd ._gd });};func (_eebf *convertContext )makePdfBlockFromCBCs (_gfd [][]*_eg .EG_ContentBlockContent ,_dbfg ,_bbgb float64 ,_fcdf *_ab .Rectangle ,_egfc bool ,_aeaeb *prefix )(*_bbd .Block ,error ){if _fcdf ==nil {_fcdf =&_ab .Rectangle {};};_ddaa :=&_ab .Rectangle {Top :_fcdf .Top ,Bottom :_bbgb -_fcdf .Bottom ,Left :_fcdf .Left ,Right :_dbfg -_fcdf .Right };_abbf :=_ab .MakeTempCreator (_dbfg ,_bbgb );_abbff :=&convertContext {_bbde :_abbf ,_faec :_eebf ._faec ,_bgf :_ddaa ,_eabf :_aeaeb };for _ ,_bcfb :=range _gfd {_abbff .addAbsoluteCBCs (_bcfb );};if _egfc {_gdeg :=0.0;for _ ,_gcdbf :=range _abbff ._efgb {for _ ,_bdeg :=range _gcdbf ._be {_gdeg +=(_bdeg ._fde +_bdeg ._gc .Top +_bdeg ._gc .Bottom );};};_ddaa .Bottom =_gdeg -_fcdf .Bottom ;_abbf =_ab .MakeTempCreator (_dbfg ,_gdeg );_abbff =&convertContext {_bbde :_abbf ,_faec :_eebf ._faec ,_bgf :_ddaa ,_eabf :_aeaeb };for _ ,_agdfb :=range _gfd {_abbff .addAbsoluteCBCs (_agdfb );};};_abbff .alignSymbolsVertically ();_abbff ._bbde .NewPage ();_abbff .drawPage (_abbff ._efgb [len (_abbff ._efgb )-1]);return _ab .MakeBlockFromCreator (_abbf );};type tableWrapper struct{_fda *_bbd .Table ;_ad float64 ;};func _bdgg (_dbgb int ,_cdffg bool )string {_gaca :=(_dbgb -1)/26+1;_eec :=byte ((_dbgb -1)%26);if _cdffg {_eec +=byte (65);}else {_eec +=byte (97);};_ccfef :=_bd .NewBuffer ([]byte {});for _ecae :=0;_ecae < _gaca ;_ecae ++{_ccfef .Write ([]byte {_eec });};return _ccfef .String ();};type paragraph struct{_efg float64 ;_gc *_ab .Rectangle ;_aba float64 ;_gfg float64 ;_aca float64 ;_dbf float64 ;_fde float64 ;_bda _bbd .TextAlignment ;_gd float64 ;_eaa []*line ;_cd *tableWrapper ;_acb []*image ;_ba []*image ;_aab []*block ;_cff []*block ;_ga []*note ;_fae float64 ;_aabd []*zoneToSkip ;_af float64 ;_aaf bool ;_gfc []*borderLine ;};func _ege (_de *_bbd .Creator ,_fc *image ){_fc ._bec .SetPos (_fc ._ebf ,_fc ._abf );_de .Draw (_fc ._bec )};func (_gbf *convertContext )addAbsoluteRIC (_adg *_eg .EG_RunInnerContent ,_dfa *_eg .CT_RPr )bool {var _acae ,_cgaa bool ;_bbg :=[]*symbol {};_bcc :=false ;if _adg ==nil {if _gbf ._eabf !=nil {for _ ,_ffc :=range _gbf ._eabf ._cgg {if _acf ,_bebf :=_efb [_ffc ];_bebf {_cgaa =_gbf ._eabf ._ecbd ;_gbf ._eabf ._cgg =string (rune (_acf ));};};_bbg =_ggdf (_gbf ._eabf ._cgg ,"",true ,false );};}else {if _fbbc (_adg ){return true ;}else if _adg .T !=nil &&_adg .T .Content !=""{_bgaf :=_adg .T .Content ;if _edg :=_gbf ._bcda ;_edg !=nil &&_edg .IdAttr !=nil {_bcc =true ;_bbg =_ggdf (_bgaf ,_gbf ._faec .GetTargetByRelId (*_edg .IdAttr ),false ,false );}else {_bbg =_ggdf (_bgaf ,"",false ,false );};}else if _gfbf :=_adg .EndnoteReference ;_gfbf !=nil {_cbe :=_gbf ._faec .BodySection ().X ();_ddfa :=_gfbf .IdAttr ;_dag :=_ddfa ;_adb :=_eg .ST_NumberFormatLowerRoman ;if _gfgb :=_cbe .EndnotePr ;_gfgb !=nil {if _aac :=_gfgb .NumFmt ;_aac !=nil {_adb =_aac .ValAttr ;};if _ffbgg :=_gfgb .NumStart ;_ffbgg !=nil {_dag +=_ffbgg .ValAttr -1;};};_abfbb :=_efcg (_dag ,_adb );_gffa :=_gbf ._faec .Endnote (_ddfa ).X ();if _gffa !=nil {_gbf ._acg =append (_gbf ._acg ,note {_cfd :_abfbb ,_ce :_gffa .EG_BlockLevelElts });_bbg =_ggdf (_abfbb ,"",true ,false );};}else if _eed :=_adg .FootnoteReference ;_eed !=nil {_agdc :=_gbf ._faec .BodySection ().X ();_bbf :=_eed .IdAttr ;_dcb :=_bbf ;_ebgg :=_eg .ST_NumberFormatDecimal ;if _cfac :=_agdc .FootnotePr ;_cfac !=nil {if _ebb :=_cfac .NumFmt ;_ebb !=nil {_ebgg =_ebb .ValAttr ;};if _dcfg :=_cfac .NumStart ;_dcfg !=nil {_dcb +=_dcfg .ValAttr -1;};};_acde :=_efcg (_dcb ,_ebgg );_adc :=_gbf ._faec .Footnote (_bbf ).X ();if _adc !=nil {_eddc :=&note {_cfd :_acde ,_ce :_adc .EG_BlockLevelElts };_abc :=[][]*_eg .EG_ContentBlockContent {};for _ ,_ecag :=range _adc .EG_BlockLevelElts {_abc =append (_abc ,_ecag .EG_ContentBlockContent );};_dcec :=&prefix {_cgg :_acde };_abgg ,_edcb :=_gbf .makePdfBlockFromCBCs (_abc ,_gbf ._bbdef ._ag .Right -_gbf ._bbdef ._ag .Left ,_egcd (1000),nil ,true ,_dcec );if _edcb !=nil {_f .Log .Debug ("C\u0061\u006e\u006e\u006f\u0074\u0020c\u006f\u006e\u0076\u0065\u0072\u0074\u0020\u0066\u006fo\u0074\u006e\u006ft\u0065:\u0020\u0025\u0073",_edcb );return false ;};_eddc ._ee =_abgg ;_gbf ._ebdd ._ga =append (_gbf ._ebdd ._ga ,_eddc );_gbf ._ebdd ._fae +=_eddc ._ee .Height ();_bbg =_ggdf (_acde ,"",true ,false );};}else if _ffbgc :=_adg .InstrText ;_ffbgc !=nil {_bdb :=_feca (_ffbgc .Content );if _bdb !=""{_bbg =_ggdf (_gbf ._gcegb [_bdb ],"",false ,false );};}else if _bab :=_adg .Drawing ;_bab !=nil {for _ ,_aga :=range _bab .Inline {if _ecdab :=_aga .Graphic ;_ecdab !=nil {if _facfa :=_ecdab .GraphicData ;_facfa !=nil {_ggaaf :=_aga .Extent ;if _ggaaf ==nil {return false ;};_ddca :=_dc .FromEMU (_ggaaf .CxAttr );_agb :=_dc .FromEMU (_ggaaf .CyAttr );for _ ,_fecb :=range _facfa .Any {if _cbcc ,_gbgc :=_fecb .(*_bf .Pic );_gbgc {_ffa :=&symbol {_fg :_agb ,_acd :_ddca };_bac ,_bdge :=_gbf .makePdfImageFromGraphics (_cbcc );if _bdge !=nil {_f .Log .Debug ("C\u0061\u006e\u006e\u006ft \u0072e\u0061\u0064\u0020\u0069\u006da\u0067\u0065\u003a\u0020\u0025\u0073",_bdge );};if _bac ==nil {_ffa ._bed ="\u0020";}else {_bac .Scale (_ddca /_bac .Width (),_agb /_bac .Height ());_ffa ._ccc =_bac ;_acae =true ;};_bbg =[]*symbol {_ffa };}else if _abafc ,_aceb :=_fecb .(*_db .Chart );_aceb {_dbc :=&symbol {_fg :_agb ,_acd :_ddca };_gfgaa ,_bddfc :=_gbf .makePdfBlockFromChart (_abafc ,_ddca ,_agb );if _bddfc !=nil {_f .Log .Debug ("C\u0061\u006e\u006e\u006ft \u0072e\u0061\u0064\u0020\u0062\u006co\u0063\u006b\u003a\u0020\u0025\u0073",_bddfc );};if _gfgaa ==nil {_dbc ._bed ="\u0020";}else {_dbc ._dd =&block {_cca :_gfgaa };_acae =true ;};_bbg =[]*symbol {_dbc };};};};};};};};var _dceb _bbd .TextStyle ;var _dfff ,_bedc bool ;var _gcdc *_bbd .Color ;if !_acae {_dceb ,_dfff ,_bedc ,_gcdc =_gbf .makeRunStyle (_dfa ,false ,false ,false ,_cgaa ,_bcc );if _dceb .Font !=nil {_gbf ._bbde .EnableFontSubsetting (_dceb .Font );};};for _ ,_bcf :=range _bbg {if _bcf ._ccc !=nil ||_bcf ._dd !=nil {_gbf .addInlineSymbol (_bcf );}else {_bcf ._bc =&_dceb ;_bcf ._cad =_dfff ;_bcf ._abbe =_bedc ;_bcf ._fgd =_gcdc ;_gbf .addTextSymbol (_bcf );};};if _gbf ._eabf !=nil &&_gbf ._eabf ._daec {var _ceee ,_gcg float64 ;for _ ,_bce :=range _bbg {_ceee +=_bce ._acd ;};_bbdd :=0;_ddgd :=_gbf ._bbdef ._ag .Left ;_dbca :=len (_gbf ._eabf ._gfef );_feeb :=_gbf ._ebdd ._efg < _ceee ;_eade :=_gbf ._fcdba ._eb +_ceee ;for {var _aeed float64 ;if _feeb ||_bbdd >=_dbca {_aeed =_gggb ;}else {_aeed =_gbf ._eabf ._gfef [_bbdd ];_bbdd ++;};_ddgd +=_aeed ;if _ddgd > _eade {_gcg =_ddgd -_eade ;break ;};};_gbf .addTextSymbol (&symbol {_bed :"\u0020",_acd :_gcg });};return false ;};func (_gaa *convertContext )drawPages (){for _ ,_dcf :=range _gaa ._efgb {_gaa ._bbde .NewPage ();_gaa .drawPage (_dcf );};};func init (){_dfgg =_a .MustCompile ("\u0053E\u0054 \u0028\u002e\u002b\u0029\u0020\u0022\u0028\u002e\u002b\u0029\u0022");_abdd =_a .MustCompile ("\u0052\u0045\u0046\u0020\u0028\u002e\u002b\u003f\u0029\u0020");};func _cecb (_effa ,_fbdd *_eg .CT_Border ,_eabb bool )*_eg .CT_Border {if _eabb {return _effa ;};return _fbdd ;};func (_ebfd *convertContext )newWord (){_ebfd ._beec =&word {_bff :true ,_eff :_ebfd ._fcdba ._acbf }};func (_cdfd *convertContext )newParagraph (){if _cdfd ._bbdef ==nil {_cdfd .newPage ();};_gcgc :=&paragraph {};_gcgc ._gc =&_ab .Rectangle {};_gcgc ._dbf =_cdfd ._bbdef ._cb ;_cdfd ._ebdd =_gcgc ;};var _dbga =[]romanMatch {romanMatch {1000,"\u006d"},romanMatch {900,"\u0063\u006d"},romanMatch {500,"\u0064"},romanMatch {400,"\u0063\u0064"},romanMatch {100,"\u0063"},romanMatch {90,"\u0078\u0063"},romanMatch {50,"\u006c"},romanMatch {40,"\u0078\u006c"},romanMatch {10,"\u0078"},romanMatch {9,"\u0069\u0078"},romanMatch {5,"\u0076"},romanMatch {4,"\u0069\u0076"},romanMatch {1,"\u0069"}};type block struct{_cca *_bbd .Block ;_abaf float64 ;_ace float64 ;_gab bool ;_ffb float64 ;_bfe _bbd .Color ;};func _bege (_gadge *_df .Document ,_dbac *_eg .CT_TblPr )(*_eg .CT_TblPr ,*_eg .CT_PPrGeneral ,*_eg .CT_RPr ){var _ecaed *_eg .CT_PPrGeneral ;var _dgeeb *_eg .CT_RPr ;if _dbac ==nil {_dbac =_eg .NewCT_TblPr ();};if _dbac .TblStyle !=nil {_dbac ,_ecaed ,_dgeeb =_abaa (_gadge ,_dbac .TblStyle .ValAttr ,_dbac ,_ecaed ,_dgeeb );};return _dbac ,_ecaed ,_dgeeb ;};type borderLine struct{_gg _bbd .Color ;_fb _ab .BorderPosition ;_fgg float64 ;_ced float64 ;_dbee float64 ;};func (_dde *convertContext )addAbsoluteEGPC (_egec []*_eg .EG_PContent ,_efe *_eg .CT_PPr )bool {for _ ,_aaa :=range _egec {for _ ,_bea :=range _aaa .FldSimple {if _bea !=nil {_dde .addAbsoluteEGPC (_bea .EG_PContent ,_efe );};};if _cgf :=_aaa .Hyperlink ;_cgf !=nil {_dde ._bcda =_cgf ;_dde .addAbsoluteCRC (_cgf .EG_ContentRunContent ,_efe );};_dde ._bcda =nil ;if _dde .addAbsoluteCRC (_aaa .EG_ContentRunContent ,_efe ){return true ;};};return false ;};type page struct{_ag *_ab .Rectangle ;_be []*paragraph ;_cb float64 ;_gb []*zoneToSkip ;_ca []*image ;_gf []*image ;_fe []*block ;_efa []*block ;_ac []*note ;_fac bool ;};var _gggb float64 ;func (_bcba *span )moveRight (_abfb float64 ){for _ ,_daf :=range _bcba ._dce {_daf ._eff +=_abfb ;};};func (_ece *convertContext )addEndnotes (){for _febb ,_bffed :=range _ece ._acg {if _febb ==0{_ece .addSeparator ();};_ece ._eabf =&prefix {_cgg :_bffed ._cfd };for _ffbga ,_eccg :=range _bffed ._ce {if _febb !=0||_ffbga !=0{_ece ._cbf =true ;};_ece .addAbsoluteCBCs (_eccg .EG_ContentBlockContent );};};_ece ._cbf =false ;};func _egcd (_eceg float64 )float64 {return _eceg *_dc .Millimeter };type span struct{_dcg float64 ;_bae float64 ;_dce []*word ;};func _eggf (_cfbbg ,_afed *_eg .CT_TcPr )*_eg .CT_TcPr {if _cfbbg ==nil {return _afed ;};if _afed ==nil {return _cfbbg ;};if _cfbbg .CnfStyle ==nil {_cfbbg .CnfStyle =_afed .CnfStyle ;};if _cfbbg .TcW ==nil {_cfbbg .TcW =_afed .TcW ;};if _cfbbg .GridSpan ==nil {_cfbbg .GridSpan =_afed .GridSpan ;};if _cfbbg .HMerge ==nil {_cfbbg .HMerge =_afed .HMerge ;};if _cfbbg .VMerge ==nil {_cfbbg .VMerge =_afed .VMerge ;};if _cfbbg .TcBorders ==nil {_cfbbg .TcBorders =_afed .TcBorders ;};if _cfbbg .Shd ==nil {_cfbbg .Shd =_afed .Shd ;};if _cfbbg .NoWrap ==nil {_cfbbg .NoWrap =_afed .NoWrap ;};if _cfbbg .TcMar ==nil {_cfbbg .TcMar =_afed .TcMar ;};if _cfbbg .TextDirection ==nil {_cfbbg .TextDirection =_afed .TextDirection ;};if _cfbbg .TcFitText ==nil {_cfbbg .TcFitText =_afed .TcFitText ;};if _cfbbg .VAlign ==nil {_cfbbg .VAlign =_afed .VAlign ;};if _cfbbg .HideMark ==nil {_cfbbg .HideMark =_afed .HideMark ;};if _cfbbg .Headers ==nil {_cfbbg .Headers =_afed .Headers ;};if _cfbbg .CellIns ==nil {_cfbbg .CellIns =_afed .CellIns ;};if _cfbbg .CellDel ==nil {_cfbbg .CellDel =_afed .CellDel ;};if _cfbbg .CellMerge ==nil {_cfbbg .CellMerge =_afed .CellMerge ;};if _cfbbg .TcPrChange ==nil {_cfbbg .TcPrChange =_afed .TcPrChange ;};return _cfbbg ;};var _ef =_egcd (0.25);func (_cbg *convertContext )determineParagraphBounds (){_cbg ._ebdd ._gfg =_cbg ._bbdef ._ag .Left +_cbg ._ebdd ._gc .Left ;_cbg ._ebdd ._aba =_cbg ._ebdd ._gfg +_cbg ._ebdd ._efg ;_cbg ._ebdd ._aca =_cbg ._bbdef ._ag .Right -_cbg ._ebdd ._gc .Right ;};func (_afa *convertContext )addAnchorBlocks (_fdef []*_eg .EG_PContent ){for _ ,_agdf :=range _fdef {for _ ,_cbc :=range _agdf .EG_ContentRunContent {if _fffb :=_cbc .R ;_fffb !=nil {for _ ,_ggf :=range _fffb .EG_RunInnerContent {if _ddc :=_ggf .Drawing ;_ddc !=nil {for _ ,_dbea :=range _ddc .Anchor {var _fgce ,_fec ,_cddb ,_gba float64 ;_beb ,_fegae :=_dbea .PositionH ,_dbea .PositionV ;if _gbd :=_beb .Choice ;_gbd !=nil {if _gbd .PosOffset !=nil {_fgce =_dc .FromEMU (int64 (*_gbd .PosOffset ));};};if _bfd :=_fegae .Choice ;_bfd !=nil {if _bfd .PosOffset !=nil {_fec =_dc .FromEMU (int64 (*_bfd .PosOffset ));};};if _dcgf :=_dbea .Extent ;_dcgf !=nil {_gba =_dc .FromEMU (_dcgf .CxAttr );_cddb =_dc .FromEMU (_dcgf .CyAttr );};_caee :=_afa ._ebdd ._dbf +_fec ;_bdab :=_caee +_cddb ;_cda :=_afa ._ebdd ._gfg +_fgce ;_bcgb :=_cda +_gba ;_egg :=_fec +_cddb ;if _egg > _afa ._ebdd ._af {_afa ._ebdd ._af =_egg ;};if _dbea .Choice !=nil &&_dbea .Choice .WrapNone ==nil {_afa ._ebdd ._aabd =append (_afa ._ebdd ._aabd ,&zoneToSkip {_ea :&_ab .Rectangle {Top :_caee ,Bottom :_bdab ,Left :_cda ,Right :_bcgb },_eeg :_dbea .Choice });};if _gdce :=_dbea .Graphic ;_gdce !=nil {if _gaag :=_gdce .GraphicData ;_gaag !=nil {for _ ,_dcee :=range _gaag .Any {if _bgb ,_eeaf :=_dcee .(*_bf .Pic );_eeaf {_bddf ,_ffd :=_afa .makePdfImageFromGraphics (_bgb );if _ffd !=nil {_f .Log .Debug ("C\u0061\u006e\u006e\u006ft \u0072e\u0061\u0064\u0020\u0069\u006da\u0067\u0065\u003a\u0020\u0025\u0073",_ffd );};if _bddf !=nil {_bddf .Scale (_gba /_bddf .Width (),_cddb /_bddf .Height ());_gcb :=&image {_bec :_bddf ,_ebf :_cda ,_abf :_caee };if _dbea .BehindDocAttr {_afa ._ebdd ._ba =append (_afa ._ebdd ._ba ,_gcb );}else {_afa ._ebdd ._acb =append (_afa ._ebdd ._acb ,_gcb );};};}else if _bef ,_fdfb :=_dcee .(*_db .Chart );_fdfb {_ega ,_dabg :=_afa .makePdfBlockFromChart (_bef ,_gba ,_cddb );if _dabg !=nil {_f .Log .Debug ("C\u0061\u006e\u006e\u006ft \u0072e\u0061\u0064\u0020\u0062\u006co\u0063\u006b\u003a\u0020\u0025\u0073",_dabg );};if _ega !=nil {_agf :=&block {_cca :_ega ,_abaf :_cda ,_ace :_caee };if _dbea .BehindDocAttr {_afa ._ebdd ._cff =append (_afa ._ebdd ._cff ,_agf );}else {_afa ._ebdd ._aab =append (_afa ._ebdd ._aab ,_agf );};};};};};};};};};};};};};func (_eee *convertContext )newSpan (){_bgc :=&span {_dcg :_eee ._fcdba ._acbf ,_bae :_eee ._fcdba ._abb };_eee ._agg =_bgc ;_eee ._fcdba ._dg =append (_eee ._fcdba ._dg ,_bgc );};var _fd =_egcd (1.9);const _g =0.67;var _daaa =_egcd (2.5);func (_bfa *convertContext )assignPropsToAbsoluteParagraph (_aaaa *_eg .CT_PPr ,_ebggc *paragraph )(float64 ,float64 ){_aaaa =_edbcc (_aaaa ,_bfa ._dccgf ,_bfa ._effb );_gcdad :=12.4;if _aaaa ==nil {return 0,0;};if _dccg :=_aaaa .RPr ;_dccg !=nil {_dagc :=_eddb (_dccg .Sz ,_dccg .SzCs );if _gcdad <=_dagc {_gcdad =_dagc ;};};if _aaaa .Jc !=nil {switch _aaaa .Jc .ValAttr {case _eg .ST_JcRight :_ebggc ._bda =_bbd .TextAlignmentRight ;case _eg .ST_JcCenter :_ebggc ._bda =_bbd .TextAlignmentCenter ;case _eg .ST_JcBoth :_ebggc ._bda =_bbd .TextAlignmentJustify ;default:_ebggc ._bda =_bbd .TextAlignmentLeft ;};};var _bbad ,_fea ,_ggeb ,_abae ,_abfg float64 ;if _edeba :=_aaaa .Spacing ;_edeba !=nil {if _ddcc :=_edeba .BeforeAttr ;_ddcc !=nil {if _ddcc .ST_UnsignedDecimalNumber !=nil {_bbad =_ab .PointsFromTwips (int64 (*_ddcc .ST_UnsignedDecimalNumber ));};};if _fcda :=_edeba .AfterAttr ;_fcda !=nil {if _fcda .ST_UnsignedDecimalNumber !=nil {_fea =_ab .PointsFromTwips (int64 (*_fcda .ST_UnsignedDecimalNumber ));};};if _dcfgc :=_edeba .LineAttr ;_dcfgc !=nil {if _dcfgc .Int64 !=nil &&*_dcfgc .Int64 !=0{_gcdad =float64 (*_dcfgc .Int64 )/20;};};};_ebggc ._gd =_gcdad ;if _ffbe :=_aaaa .Ind ;_ffbe !=nil {if _dada :=_ffbe .FirstLineAttr ;_dada !=nil {if _dada .ST_UnsignedDecimalNumber !=nil {_abfg =_ab .PointsFromTwips (int64 (*_dada .ST_UnsignedDecimalNumber ));};};if _aeae :=_ffbe .HangingAttr ;_aeae !=nil {if _aeae .ST_UnsignedDecimalNumber !=nil {_abfg -=_ab .PointsFromTwips (int64 (*_aeae .ST_UnsignedDecimalNumber ));};};if _gedc :=_ffbe .LeftAttr ;_gedc !=nil {if _gedc .Int64 !=nil {_ggeb =_ab .PointsFromTwips (*_gedc .Int64 );};};if _cag :=_ffbe .RightAttr ;_cag !=nil {if _cag .Int64 !=nil {_abae =_ab .PointsFromTwips (*_cag .Int64 );};};};if _aaaa .PBdr !=nil {_bbdb :=_bfa ._bbdef ._ag .Right -_bfa ._bbdef ._ag .Left ;_cedba :=_bfa ._bbdef ._ag .Bottom -_bfa ._bbdef ._ag .Top ;if _ggca :=_aaaa .PBdr .Top ;_ggca !=nil {_cdbg :=0.0;if _ebcg :=_ggca .SzAttr ;_ebcg !=nil {_cdbg =float64 (*_ebcg )*_bbdb /4;};_ggcdf :=0.0;if _adge :=_ggca .SpaceAttr ;_adge !=nil {_ggcdf =float64 (*_adge )*_dc .Pixel72 ;};var _ggce _bbd .Color ;if _gafe :=_ggca .ColorAttr ;_gafe !=nil {if _adcg :=_gafe .ST_HexColorAuto ;_adcg ==_eg .ST_HexColorAutoAuto {_ggce =_bbd .ColorBlack ;};if _feba :=_gafe .ST_HexColorRGB ;_feba !=nil {_ggce =_bbd .ColorRGBFromHex ("\u0023"+*_feba );};};_aag :=&borderLine {_fgg :_cdbg ,_fb :_ab .BorderPositionTop ,_dbee :1.0,_gg :_ggce ,_ced :_ggcdf };_ebggc ._gfc =append (_ebggc ._gfc ,_aag );};if _bace :=_aaaa .PBdr .Left ;_bace !=nil {_bged :=0.0;if _aacd :=_bace .SzAttr ;_aacd !=nil {_bged =float64 (*_aacd )*_cedba /4;};_becg :=0.0;if _fbb :=_bace .SpaceAttr ;_fbb !=nil {_becg =float64 (*_fbb )*_dc .Pixel72 ;};var _eafg _bbd .Color ;if _ccgd :=_bace .ColorAttr ;_ccgd !=nil {if _fbca :=_ccgd .ST_HexColorAuto ;_fbca ==_eg .ST_HexColorAutoAuto {_eafg =_bbd .ColorBlack ;};if _aagg :=_ccgd .ST_HexColorRGB ;_aagg !=nil {_eafg =_bbd .ColorRGBFromHex ("\u0023"+*_aagg );};};_fgdd :=&borderLine {_fb :_ab .BorderPositionLeft ,_fgg :1.0,_dbee :_bged ,_gg :_eafg ,_ced :_becg };_ebggc ._gfc =append (_ebggc ._gfc ,_fgdd );};if _acea :=_aaaa .PBdr .Right ;_acea !=nil {_fegb :=0.0;if _gbae :=_acea .SzAttr ;_gbae !=nil {_fegb =float64 (*_gbae )*_cedba /4;};_afbf :=0.0;if _aegc :=_acea .SpaceAttr ;_aegc !=nil {_afbf =float64 (*_aegc )*_dc .Pixel72 ;};var _cfca _bbd .Color ;if _fgge :=_acea .ColorAttr ;_fgge !=nil {if _dccf :=_fgge .ST_HexColorAuto ;_dccf ==_eg .ST_HexColorAutoAuto {_cfca =_bbd .ColorBlack ;};if _aece :=_fgge .ST_HexColorRGB ;_aece !=nil {_cfca =_bbd .ColorRGBFromHex ("\u0023"+*_aece );};};_ecgg :=&borderLine {_fb :_ab .BorderPositionRight ,_fgg :1.0,_dbee :_fegb ,_gg :_cfca ,_ced :_afbf };_ebggc ._gfc =append (_ebggc ._gfc ,_ecgg );};if _badd :=_aaaa .PBdr .Bottom ;_badd !=nil {_cdg :=0.0;if _bbcg :=_badd .SzAttr ;_bbcg !=nil {_cdg =float64 (*_bbcg )*_bbdb /4;};_gbdd :=0.0;if _baca :=_badd .SpaceAttr ;_baca !=nil {_gbdd =float64 (*_baca )*_dc .Pixel72 ;};var _daed _bbd .Color ;if _cdfe :=_badd .ColorAttr ;_cdfe !=nil {if _cdff :=_cdfe .ST_HexColorAuto ;_cdff ==_eg .ST_HexColorAutoAuto {_daed =_bbd .ColorBlack ;};if _bebff :=_cdfe .ST_HexColorRGB ;_bebff !=nil {_daed =_bbd .ColorRGBFromHex ("\u0023"+*_bebff );};};_fedb :=&borderLine {_fb :_ab .BorderPositionBottom ,_fgg :_cdg ,_dbee :1.0,_gg :_daed ,_ced :_gbdd };_ebggc ._gfc =append (_ebggc ._gfc ,_fedb );};};_cebg :=_bfa ._bbdef ._be ;if len (_cebg )> 0{_bbad -=_cebg [len (_cebg )-1]._gc .Bottom ;if _bbad < 0{_bbad =0;};};_ebggc ._gc =&_ab .Rectangle {Top :_bbad ,Bottom :_fea ,Left :_ggeb ,Right :_abae };_ebggc ._efg =_abfg ;return _bbad ,_ggeb ;};func (_da *convertContext )drawPage (_faee *page ){if _faee ._fac {_ggd :=_faee ._ag .Top +_ecg *_g ;_fgf :=_faee ._ag .Left ;_cbd :=_faee ._ag .Right ;_ab .DrawLine (_da ._bbde ,_fgf ,_ggd ,_cbd ,_ggd ,_ef ,_bbd .ColorBlack );};for _ ,_deg :=range _faee ._gf {_ege (_da ._bbde ,_deg );};for _ ,_aae :=range _faee ._efa {_egf (_da ._bbde ,_aae );};for _ ,_ffbg :=range _faee ._be {if _ffbg ._aaf {_fga :=_ffbg ._dbf +_ecg *_g ;_bede :=_faee ._ag .Left ;_ccg :=_bede +_egcd (50);_ab .DrawLine (_da ._bbde ,_bede ,_fga ,_ccg ,_fga ,_ef ,_bbd .ColorBlack );}else {for _ ,_ed :=range _ffbg ._eaa {for _ ,_ebc :=range _ed ._dg {for _ ,_bde :=range _ebc ._dce {for _ ,_afg :=range _bde ._afd {if _afg ._ccc !=nil {_afg ._ccc .SetPos (_bde ._eff +_afg ._cc ,_ffbg ._dbf +_ed ._ge );_da ._bbde .Draw (_afg ._ccc );}else if _afg ._dd !=nil {_afg ._dd ._abaf =_bde ._eff +_afg ._cc ;_afg ._dd ._ace =_ffbg ._dbf +_ed ._ge ;_egf (_da ._bbde ,_afg ._dd );}else {_gdf :=_da ._bbde .NewStyledParagraph ();if _afg ._cad {_afg ._dgc =0;}else if _afg ._abbe {_afg ._dgc =1.2*_ed ._dbe -_afg ._fg ;};_bbc :=_bde ._eff +_afg ._cc ;_bg :=_ffbg ._dbf +_ed ._ge +_afg ._dgc ;_gdf .SetPos (_bbc ,_bg );var _fcb *_bbd .TextChunk ;if _afg ._ae !=""{_fcb =_gdf .AddExternalLink (_afg ._bed ,_afg ._ae );}else {_fcb =_gdf .Append (_afg ._bed );};if _afg ._bc !=nil {_fcb .Style =*_afg ._bc ;};_da ._bbde .Draw (_gdf );if _afg ._fgd !=nil {_eca :=_bg +_afg ._gbg +2.0;_ab .DrawLine (_da ._bbde ,_bbc ,_eca ,_bbc +_afg ._acd ,_eca ,1,*_afg ._fgd );};};};};};};if _ffbg ._cd !=nil {_deb :=_bbd .NewBlock (_ffbg ._cd ._ad ,_ffbg ._gc .Top +_ffbg ._fde +_ffbg ._gc .Bottom );_deb .SetPos (_ffbg ._aba ,_ffbg ._dbf +_ffbg ._gc .Top );_deb .Draw (_ffbg ._cd ._fda );_da ._bbde .Draw (_deb );};if _ffbg ._gfc !=nil {_dbd :=(_faee ._ag .Left /_ab .DefaultFontSize -1);_bcg :=1.5;for _ ,_gga :=range _ffbg ._gfc {switch _gga ._fb {case _ab .BorderPositionTop :_dff :=_ffbg ._dbf +_gga ._ced ;_ab .DrawLine (_da ._bbde ,_ffbg ._gfg -_dbd ,_dff ,_ffbg ._gfg +_gga ._fgg +_dbd ,_dff ,_gga ._dbee ,_gga ._gg );case _ab .BorderPositionLeft :_debg :=_ffbg ._dbf +_ffbg ._fde -_ffbg ._gc .Top -_ffbg ._gc .Bottom -_gga ._ced -_bcg ;_bdcb :=_debg +_ffbg ._fde +_ffbg ._gc .Top +_ffbg ._gc .Bottom ;_eeb :=_ffbg ._gfg -_dbd ;_ab .DrawLine (_da ._bbde ,_eeb ,_debg ,_eeb ,_bdcb ,_gga ._fgg ,_gga ._gg );case _ab .BorderPositionBottom :_fcd :=_ffbg ._dbf +_gga ._ced +_ffbg ._gc .Top +_ffbg ._fde +_ffbg ._gc .Bottom ;_ab .DrawLine (_da ._bbde ,_ffbg ._gfg -_dbd ,_fcd ,_ffbg ._gfg +_gga ._fgg +_dbd ,_fcd ,_gga ._dbee ,_gga ._gg );case _ab .BorderPositionRight :_ebg :=_ffbg ._dbf +_ffbg ._fde -_ffbg ._gc .Top -_ffbg ._gc .Bottom -_gga ._ced -_bcg ;_facf :=_ebg +_ffbg ._fde +_ffbg ._gc .Top +_ffbg ._gc .Bottom ;_dbg :=_ffbg ._aca +_dbd ;_ab .DrawLine (_da ._bbde ,_dbg ,_ebg ,_dbg ,_facf ,_gga ._fgg ,_gga ._gg );};};};};};for _ ,_ccf :=range _faee ._ca {_ege (_da ._bbde ,_ccf );};for _ ,_aea :=range _faee ._fe {_egf (_da ._bbde ,_aea );};if len (_faee ._ac )> 0{_bbca :=_faee ._ag .Bottom +_ecg *_g ;_fce :=_faee ._ag .Left ;_dgca :=_fce +_egcd (50);_ab .DrawLine (_da ._bbde ,_fce ,_bbca ,_dgca ,_bbca ,_ef ,_bbd .ColorBlack );_dec :=_faee ._ag .Bottom +_ecg ;for _ ,_gdc :=range _faee ._ac {_gdc ._ee .SetPos (_faee ._ag .Left ,_dec );_da ._bbde .Draw (_gdc ._ee );_dec +=_gdc ._ee .Height ();};};};func (_gdff *convertContext )addRelativeEGPC (_gaaf []*_eg .EG_PContent ,_aead *_eg .CT_PPr ,_dgg *prefix ){if len (_gaaf )==0{_gdff ._egggc .Append ("\u000d");return ;};if _dgg !=nil {_gdff ._eabf =_dgg ;};for _ ,_dddd :=range _gaaf {for _ ,_edfc :=range _dddd .FldSimple {if _edfc !=nil {_gdff .addRelativeEGPC (_edfc .EG_PContent ,_aead ,_dgg );};};if _gca :=_dddd .Hyperlink ;_gca !=nil {_gdff ._bcda =_gca ;_gdff .addRelativeCRC (_gca .EG_ContentRunContent ,_aead );};_gdff ._bcda =nil ;_gdff .addRelativeCRC (_dddd .EG_ContentRunContent ,_aead );};};func (_efad *convertContext )addTextSymbol (_bdf *symbol ){_afgb :=_bbd .New ();_gefd :=_afgb .NewStyledParagraph ();_gefd .SetMargins (0,0,0,0);_gabb :=_gefd .Append (_bdf ._bed );_adcf :=0.0;if _bdf ._bc !=nil {_gabb .Style =*_bdf ._bc ;if _bdf ._bc .CharSpacing !=0{_adcf =_bdf ._bc .CharSpacing ;};};if _bdf ._dd ==nil &&_bdf ._ccc ==nil {_bdf ._fg =_gefd .Height ()*1.2;_bdf ._gbg =_gefd .Height ();};if _bdf ._fg < _efad ._ebdd ._gd {_bdf ._fg =_efad ._ebdd ._gd ;};if _bdf ._acd ==0{_bdf ._acd =_gefd .Width ()+_adcf ;};if len (_efad ._beec ._afd )> 0{_gebc :=_efad ._beec ._afd [len (_efad ._beec ._afd )-1]._bed ;if _ab .IsNoSpaceLanguage (_gebc )||(_gebc =="\u0020")!=(_bdf ._bed =="\u0020"){_efad .addCurrentWordToParagraph ();_efad .newWord ();};};_efad ._beec ._afd =append (_efad ._beec ._afd ,_bdf );_bdf ._cc =_efad ._beec ._eba ;_efad ._beec ._eba +=_bdf ._acd ;if _bdf ._bed !="\u0020"{_efad ._beec ._bff =false ;};if _bdf ._bed =="\u000d"{_efad .adjustHeights (_bdf ._fg *1.13);_efad .adjustHeights (_bdf ._fg );};};func _egf (_eaag *_bbd .Creator ,_bdc *block ){_bdc ._cca .SetPos (_bdc ._abaf ,_bdc ._ace );_eaag .Draw (_bdc ._cca );if _bdc ._gab {_ab .DrawRectangle (_eaag ,&_ab .Rectangle {Top :_bdc ._ace ,Bottom :_bdc ._ace +_bdc ._cca .Height (),Left :_bdc ._abaf ,Right :_bdc ._abaf +_bdc ._cca .Width ()},_bdc ._ffb ,_bdc ._bfe );};};func _gacc (_dbgg *_df .Document ,_bbaee string )[]*_eg .CT_TblStylePr {_ggga :=_dbgg .GetStyleByID (_bbaee );var _bgfb []*_eg .CT_TblStylePr ;if _bccd :=_ggga .X ();_bccd !=nil {if _agcf :=_bccd .BasedOn ;_agcf !=nil {_gacc (_dbgg ,_agcf .ValAttr );};if len (_bccd .TblStylePr )> 0{_bgfb =_bccd .TblStylePr ;};};return _bgfb ;};func _feca (_becd string )string {_cgff :=_abdd .FindStringSubmatch (_becd );if len (_cgff )< 2{return "";};return _cgff [1];};type convertContext struct{_bbde *_bbd .Creator ;_faec *_df .Document ;_dccgf *_eg .CT_PPrGeneral ;_effb *_eg .CT_RPr ;_egggc *_bbd .StyledParagraph ;_efgb []*page ;_bbdef *page ;_bgf *_ab .Rectangle ;_ebdd *paragraph ;_fcdba *line ;_agg *span ;_beec *word ;_bcda *_eg .CT_Hyperlink ;_cbda *_eg .CT_ParaRPr ;_acg []note ;_eabf *prefix ;_bfb bool ;_acgc bool ;_cdae bool ;_edcfe float64 ;_cead float64 ;_ebfb float64 ;_ebaf float64 ;_cbf bool ;_bbfe map[int64 ]map[int64 ]int64 ;_gcegb map[string ]string ;};func (_aeg *convertContext )alignSymbolsVertically (){for _ ,_cccb :=range _aeg ._efgb {for _ ,_gge :=range _cccb ._be {for _ ,_cbdf :=range _gge ._eaa {_fcdb :=0.0;for _ ,_fdeb :=range _cbdf ._dg {for _ ,_dab :=range _fdeb ._dce {for _ ,_cccc :=range _dab ._afd {if _cccc ._fg > _fcdb {_fcdb =_cccc ._fg ;};};};};for _ ,_ggef :=range _cbdf ._dg {for _ ,_fcg :=range _ggef ._dce {for _ ,_cde :=range _fcg ._afd {if _cde ._gbg < _fcdb {_cde ._dgc =_fcdb -_cde ._gbg ;};};};};};};};};func (_addb *convertContext )combinePPrWithStyles (_fgea *_eg .CT_PPr )(*_eg .CT_PPr ,*prefix ){if _fgea ==nil {return nil ,nil ;};var _gbdc *prefix ;if _fgea !=nil &&_fgea .NumPr !=nil {if _egga ,_fbda :=_fgea .NumPr .Ilvl ,_fgea .NumPr .NumId ;_egga !=nil &&_fbda !=nil {if _afcfa :=_addb ._faec .GetNumberingLevelByIds (_fbda .ValAttr ,_egga .ValAttr ).X ();_afcfa !=nil {_fgea =_edbcc (_fgea ,_afcfa .PPr ,_afcfa .RPr );if _dagg :=_afcfa .NumFmt ;_dagg !=nil {if _gae :=_dagg .ValAttr ;_gae ==_eg .ST_NumberFormatBullet ||_gae ==_eg .ST_NumberFormatDecimal {var _aafga []float64 ;if _cffd :=_fgea .Tabs ;_cffd !=nil &&len (_cffd .Tab )!=0{for _ ,_fcba :=range _cffd .Tab {_aafga =append (_aafga ,_ab .PointsFromTwips (*_fcba .PosAttr .Int64 ));};};_gbdc =&prefix {_gfef :_aafga ,_daec :true };if _gae ==_eg .ST_NumberFormatBullet {if _cfgc :=_afcfa .LvlText ;_cfgc !=nil {if _cfcc :=_cfgc .ValAttr ;_cfcc !=nil &&*_cfcc !=""{_gbdc ._cgg =*_cfcc ;_gbdc ._ecbd =true ;};};}else {_fgfd ,_ccb :=_fbda .ValAttr ,_egga .ValAttr ;if _ ,_gdab :=_addb ._bbfe [_fgfd ];!_gdab {_addb ._bbfe [_fgfd ]=map[int64 ]int64 {};};if _ ,_bedfg :=_addb ._bbfe [_fgfd ][_ccb ];!_bedfg {_addb ._bbfe [_fgfd ][_ccb ]=1;};_ddda :=_addb ._bbfe [_fgfd ][_ccb ];_fgab :=_cf .FormatNumberingText (int64 (_ddda ),_afcfa .IlvlAttr ,*_afcfa .LvlText .ValAttr ,_afcfa .NumFmt ,_addb ._bbfe [_fgfd ]);_addb ._bbfe [_fgfd ][_ccb ]++;_gbdc ._cgg =_fgab ;};};};};};};if _fgea !=nil &&_fgea .PStyle !=nil {_bgcg ,_faca :=_addb .getStyleProps (_fgea .PStyle .ValAttr );_fgea =_edbcc (_fgea ,_bgcg ,_faca );};return _fgea ,_gbdc ;};func (_ggdg *convertContext )newPage (){_bcgea :=&page {};_bcgea ._ag =_ggdg ._bgf ;_bcgea ._cb =_bcgea ._ag .Top ;if _ggdg ._cbf {_bcgea ._fac =true ;_bcgea ._cb +=_ecg ;};_ggdg ._efgb =append (_ggdg ._efgb ,_bcgea );_ggdg ._bbdef =_bcgea ;};func _cdfed (_aaeb string )(string ,string ){_bbcf :=_dfgg .FindStringSubmatch (_aaeb );if len (_bbcf )< 3{return "","";};return _bbcf [1],_bbcf [2];};type symbol struct{_bed string ;_cc float64 ;_dgc float64 ;_acd float64 ;_fg float64 ;_gbg float64 ;_bc *_bbd .TextStyle ;_ccc *_bbd .Image ;_dd *block ;_ae string ;_cad bool ;_abbe bool ;_fgd *_bbd .Color ;};type line struct{_ge float64 ;_eb float64 ;_abb float64 ;_acbf float64 ;_dbe float64 ;_dg []*span ;};func _dadc (_acga ,_fdd *_eg .CT_PPrGeneral )*_eg .CT_PPrGeneral {if _acga ==nil {return _acga ;};if _fdd ==nil {return _acga ;};if _acga .PStyle ==nil {_acga .PStyle =_fdd .PStyle ;};if _acga .KeepNext ==nil {_acga .KeepNext =_fdd .KeepNext ;};if _acga .KeepLines ==nil {_acga .KeepLines =_fdd .KeepLines ;};if _acga .PageBreakBefore ==nil {_acga .PageBreakBefore =_fdd .PageBreakBefore ;};if _acga .FramePr ==nil {_acga .FramePr =_fdd .FramePr ;};if _acga .WidowControl ==nil {_acga .WidowControl =_fdd .WidowControl ;};if _acga .NumPr ==nil {_acga .NumPr =_fdd .NumPr ;};if _acga .SuppressLineNumbers ==nil {_acga .SuppressLineNumbers =_fdd .SuppressLineNumbers ;};if _acga .PBdr ==nil {_acga .PBdr =_fdd .PBdr ;};if _acga .Shd ==nil {_acga .Shd =_fdd .Shd ;};if _acga .Tabs ==nil {_acga .Tabs =_fdd .Tabs ;};if _acga .SuppressAutoHyphens ==nil {_acga .SuppressAutoHyphens =_fdd .SuppressAutoHyphens ;};if _acga .Kinsoku ==nil {_acga .Kinsoku =_fdd .Kinsoku ;};if _acga .WordWrap ==nil {_acga .WordWrap =_fdd .WordWrap ;};if _acga .OverflowPunct ==nil {_acga .OverflowPunct =_fdd .OverflowPunct ;};if _acga .TopLinePunct ==nil {_acga .TopLinePunct =_fdd .TopLinePunct ;};if _acga .AutoSpaceDE ==nil {_acga .AutoSpaceDE =_fdd .AutoSpaceDE ;};if _acga .AutoSpaceDN ==nil {_acga .AutoSpaceDN =_fdd .AutoSpaceDN ;};if _acga .Bidi ==nil {_acga .Bidi =_fdd .Bidi ;};if _acga .AdjustRightInd ==nil {_acga .AdjustRightInd =_fdd .AdjustRightInd ;};if _acga .SnapToGrid ==nil {_acga .SnapToGrid =_fdd .SnapToGrid ;};if _acga .Spacing ==nil {_acga .Spacing =_fdd .Spacing ;};if _acga .Ind ==nil {_acga .Ind =_fdd .Ind ;};if _acga .ContextualSpacing ==nil {_acga .ContextualSpacing =_fdd .ContextualSpacing ;};if _acga .MirrorIndents ==nil {_acga .MirrorIndents =_fdd .MirrorIndents ;};if _acga .SuppressOverlap ==nil {_acga .SuppressOverlap =_fdd .SuppressOverlap ;};if _acga .Jc ==nil {_acga .Jc =_fdd .Jc ;};if _acga .TextDirection ==nil {_acga .TextDirection =_fdd .TextDirection ;};if _acga .TextAlignment ==nil {_acga .TextAlignment =_fdd .TextAlignment ;};if _acga .TextboxTightWrap ==nil {_acga .TextboxTightWrap =_fdd .TextboxTightWrap ;};if _acga .OutlineLvl ==nil {_acga .OutlineLvl =_fdd .OutlineLvl ;};if _acga .DivId ==nil {_acga .DivId =_fdd .DivId ;};if _acga .CnfStyle ==nil {_acga .CnfStyle =_fdd .CnfStyle ;};if _acga .PPrChange ==nil {_acga .PPrChange =_fdd .PPrChange ;};return _acga ;};func (_bfdd *convertContext )newLine (){if _bfdd ._ebdd ==nil {_bfdd .newParagraph ();};_gffd :=_bfdd ._ebdd ._fde +_bfdd ._ebdd ._gc .Top ;_degb :=&line {};if len (_bfdd ._ebdd ._eaa )==0{_degb ._eb =_bfdd ._ebdd ._aba ;}else {_degb ._eb =_bfdd ._ebdd ._gfg ;};_degb ._abb =_bfdd ._ebdd ._aca ;_degb ._acbf =_degb ._eb ;_degb ._ge =_gffd ;_bfdd ._ebdd ._eaa =append (_bfdd ._ebdd ._eaa ,_degb );_bfdd ._fcdba =_degb ;_bfdd .newSpan ();};var _ffe ,_dfgg ,_abdd *_a .Regexp ;func _eaaga (_gbee *_eg .CT_Border )(_bbd .CellBorderStyle ,*_bbd .Color ,float64 ){if _gbee ==nil {return _bbd .CellBorderStyleNone ,nil ,0;};var _fegc _bbd .CellBorderStyle ;switch _gbee .ValAttr {case _eg .ST_BorderSingle :_fegc =_bbd .CellBorderStyleSingle ;case _eg .ST_BorderDouble :_fegc =_bbd .CellBorderStyleDouble ;default:_fegc =_bbd .CellBorderStyleNone ;};var _aefee _bbd .Color ;if _cece :=_gbee .ColorAttr ;_cece !=nil {if _cgca :=_cece .ST_HexColorRGB ;_cgca !=nil {_aefee =_bbd .ColorRGBFromHex ("\u0023"+*_cgca );};};_cfdd :=0.0;if _ebcf :=_gbee .SzAttr ;_ebcf !=nil {_cfdd =float64 (*_ebcf )/8;};return _fegc ,&_aefee ,_cfdd ;};func (_bdgd *convertContext )addSeparator (){_bdgd .newParagraph ();_bdgd ._ebdd ._aaf =true ;_bdgd ._ebdd ._fde =_ecg ;if _bdgd .currentParagraphOverflowsCurrentPage (){_bdgd .moveCurrentParagraphToNewPage ();};_bdgd .addCurrentParagraphToCurrentPage ();};type note struct{_cfd string ;_ce []*_eg .EG_BlockLevelElts ;_ee *_bbd .Block ;};func (_gddd *convertContext )addInlineSymbol (_cfbb *symbol ){if len (_gddd ._beec ._afd )> 0{_cgd :=_gddd ._beec ._afd [len (_gddd ._beec ._afd )-1]._bed ;if _cgd =="\u0020"{_gddd .addCurrentWordToParagraph ();_gddd .newWord ();};};_gddd ._beec ._afd =append (_gddd ._beec ._afd ,_cfbb );_cfbb ._cc =_gddd ._beec ._eba ;_gddd ._beec ._eba +=_cfbb ._acd ;_gddd ._beec ._bff =false ;_gddd .adjustHeights (_cfbb ._fg );};