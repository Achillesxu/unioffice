//
// Copyright 2020 FoxyUtils ehf. All rights reserved.
//
// This is a commercial product and requires a license to operate.
// A trial license can be obtained at https://unidoc.io
//
// DO NOT EDIT: generated by unitwist Go source code obfuscator.
//
// Use of this source code is governed by the UniDoc End User License Agreement
// terms that can be accessed at https://unidoc.io/eula/

package convert ;import (_gc "bytes";_fg "errors";_b "github.com/unidoc/unioffice/common/tempstorage";_e "github.com/unidoc/unioffice/document";_a "github.com/unidoc/unioffice/internal/convertutils";_ca "github.com/unidoc/unioffice/measurement";_cd "github.com/unidoc/unioffice/schema/soo/dml";_df "github.com/unidoc/unioffice/schema/soo/dml/chart";_bc "github.com/unidoc/unioffice/schema/soo/dml/picture";_gf "github.com/unidoc/unioffice/schema/soo/ofc/sharedTypes";_ab "github.com/unidoc/unioffice/schema/soo/wml";_gd "github.com/unidoc/unipdf/v3/creator";_ef "github.com/unidoc/unipdf/v3/model";_c "io/ioutil";_d "log";_f "strconv";_ge "strings";);type note struct{_gg string ;_ag []*_ab .EG_BlockLevelElts ;_ba *_gd .Block ;};func (_dbba *convertContext )addRelativeRIC (_dce *_ab .EG_RunInnerContent ,_gfg *_ab .CT_RPr ){var _fbbc *_gd .TextChunk ;var _abbf ,_faaf bool ;_add :=false ;if _dce ==nil {if _dbba ._egag !=nil {_abbf =true ;_fbbc =_dbba ._ggcc .Append (_dbba ._egag ._aff );};}else {if _dce .T !=nil &&_dce .T .Content !=""{_fedg :=_dce .T .Content ;if _fgbg :=_dbba ._aacb ;_fgbg !=nil &&_fgbg .IdAttr !=nil {_add =true ;_fbbc =_dbba ._ggcc .AddExternalLink (_fedg ,_dbba ._gggc .GetTargetByRelId (*_fgbg .IdAttr ));}else {_fbbc =_dbba ._ggcc .Append (_fedg );};}else if _fede :=_dce .EndnoteReference ;_fede !=nil {_bfee :=_dbba ._gggc .BodySection ().X ();_abbf =true ;_cbbcd :=_fede .IdAttr ;_adef :=_cbbcd ;_ffbf :=_ab .ST_NumberFormatLowerRoman ;if _bebb :=_bfee .EndnotePr ;_bebb !=nil {if _dfagc :=_bebb .NumFmt ;_dfagc !=nil {_ffbf =_dfagc .ValAttr ;};if _gfec :=_bebb .NumStart ;_gfec !=nil {_adef +=_gfec .ValAttr -1;};};_dbg :=_fcfc (_adef ,_ffbf );_dffd :=_dbba ._gggc .Endnote (_cbbcd ).X ();if _dffd !=nil {_dbba ._adg =append (_dbba ._adg ,note {_gg :_dbg ,_ag :_dffd .EG_BlockLevelElts });_fbbc =_dbba ._ggcc .Append (_dbg );};}else if _cafc :=_dce .FootnoteReference ;_cafc !=nil {_eccg :=_dbba ._gggc .BodySection ().X ();_abbf =true ;_cefd :=_cafc .IdAttr ;_aefea :=_cefd ;_acde :=_ab .ST_NumberFormatDecimal ;if _fdfa :=_eccg .FootnotePr ;_fdfa !=nil {if _dfgca :=_fdfa .NumFmt ;_dfgca !=nil {_acde =_dfgca .ValAttr ;};if _affd :=_fdfa .NumStart ;_affd !=nil {_aefea +=_affd .ValAttr -1;};};_afgf :=_fcfc (_aefea ,_acde );_fbbc =_dbba ._ggcc .Append (_afgf );};};if _fbbc !=nil {_fbbc .Style ,_ ,_ =_dbba .makeRunStyle (_gfg ,_abbf ,_faaf ,true ,false ,_add );};};func _adac (_ecbd float64 )float64 {return _ecbd *_ca .Millimeter };var _ccdc =_adac (2.5);func (_abc *convertContext )drawPage (_gdc *page ){if _gdc ._ga {_cae :=_gdc ._cb .Top +_ed *_ae ;_fba :=_gdc ._cb .Left ;_be :=_gdc ._cb .Right ;_a .DrawLine (_abc ._caea ,_fba ,_cae ,_be ,_cae ,_dfe ,_gd .ColorBlack );};for _ ,_ddb :=range _gdc ._eg {_abc ._caea .Draw (_ddb );};for _ ,_ffg :=range _gdc ._cbf {_fbf (_abc ._caea ,_ffg );};for _ ,_bbc :=range _gdc ._bca {if _bbc ._agca {_ffc :=_bbc ._de +_ed *_ae ;_fgf :=_gdc ._cb .Left ;_fbb :=_fgf +_adac (50);_a .DrawLine (_abc ._caea ,_fgf ,_ffc ,_fbb ,_ffc ,_dfe ,_gd .ColorBlack );}else {for _ ,_gbc :=range _bbc ._af {for _ ,_abg :=range _gbc ._acc {for _ ,_edb :=range _abg ._bcb {for _ ,_abe :=range _edb ._bb {if _abe ._bcf !=nil {_abe ._bcf .SetPos (_edb ._gfb +_abe ._agd ,_bbc ._de +_gbc ._fa +_abe ._egf );_abc ._caea .Draw (_abe ._bcf );}else if _abe ._cgd !=nil {_abe ._cgd ._ede =_edb ._gfb +_abe ._agd ;_abe ._cgd ._bdd =_bbc ._de +_gbc ._fa +_abe ._egf ;_fbf (_abc ._caea ,_abe ._cgd );}else {_gde :=_abc ._caea .NewStyledParagraph ();if _abe ._bfb {_abe ._egf =0;}else if _abe ._dcd {_abe ._egf =1.2*_gbc ._bfe -_abe ._geb ;};_eb :=_edb ._gfb +_abe ._agd ;_aaa :=_bbc ._de +_gbc ._fa +_abe ._egf ;_gde .SetPos (_eb ,_aaa );var _abga *_gd .TextChunk ;if _abe ._fb !=""{_abga =_gde .AddExternalLink (_abe ._ege ,_abe ._fb );}else {_abga =_gde .Append (_abe ._ege );};if _abe ._ggd !=nil {_abga .Style =*_abe ._ggd ;};_abc ._caea .Draw (_gde );};};};};};if _bbc ._aeg !=nil {_ecd :=_gd .NewBlock (_bbc ._aeg ._egd ,_bbc ._ccc .Top +_bbc ._ec +_bbc ._ccc .Bottom );_ecd .SetPos (_bbc ._aad ,_bbc ._de +_bbc ._ccc .Top );_ecd .Draw (_bbc ._aeg ._ee );_abc ._caea .Draw (_ecd );};};};for _ ,_edeg :=range _gdc ._cga {_abc ._caea .Draw (_edeg );};for _ ,_dfa :=range _gdc ._dfg {_fbf (_abc ._caea ,_dfa );};if len (_gdc ._cc )> 0{_dacg :=_gdc ._cb .Bottom +_ed *_ae ;_agag :=_gdc ._cb .Left ;_bed :=_agag +_adac (50);_a .DrawLine (_abc ._caea ,_agag ,_dacg ,_bed ,_dacg ,_dfe ,_gd .ColorBlack );_egea :=_gdc ._cb .Bottom +_ed ;for _ ,_cad :=range _gdc ._cc {_cad ._ba .SetPos (_gdc ._cb .Left ,_egea );_abc ._caea .Draw (_cad ._ba );_egea +=_cad ._ba .Height ();};};};func (_ebgge *convertContext )makeBlockFromWdWsp (_eacd *_ab .WdWsp )(*block ,error ){if _bffd :=_eacd .WChoice ;_bffd !=nil {if _cgf :=_bffd .Txbx ;_cgf !=nil {if _fefc :=_cgf .TxbxContent ;_fefc !=nil {if _cbbf :=_fefc .EG_ContentBlockContent ;len (_cbbf )> 0{if _cgfg :=_eacd .SpPr ;_cgfg !=nil {if _ddae :=_cgfg .Xfrm ;_ddae !=nil {if _ebcb :=_ddae .Ext ;_ebcb !=nil {_gcb :=_ca .FromEMU (_ebcb .CxAttr );_begb :=_ca .FromEMU (_ebcb .CyAttr );_efda :=&_a .Rectangle {Top :_ccdc ,Bottom :_ccdc ,Left :_ccdc ,Right :_ccdc };_cfdb ,_age :=_ebgge .makePdfBlockFromCBCs ([][]*_ab .EG_ContentBlockContent {_cbbf },_gcb ,_begb ,_efda ,false ,nil );if _age !=nil {return nil ,_age ;};var _bebe bool ;var _egcb float64 ;var _eefa _gd .Color ;if _dbbc :=_cgfg .PrstGeom ;_dbbc !=nil {if _dbbc .PrstAttr ==_cd .ST_ShapeTypeRect {if _ccbd :=_cgfg .Ln ;_ccbd !=nil {if _bbdg :=_ccbd .WAttr ;_bbdg !=nil {_bebe =true ;_egcb =_ca .FromEMU (int64 (*_bbdg ));_eefa =_gd .ColorBlack ;if _dgba :=_ccbd .SolidFill ;_dgba !=nil {if _eeb :=_dgba .SrgbClr ;_eeb !=nil {_eefa =_gd .ColorRGBFromHex ("\u0023"+_eeb .ValAttr );};};};};};};_fbbdc :=&block {_ff :_cfdb ,_egg :_bebe ,_baf :_egcb ,_fe :_eefa };return _fbbdc ,nil ;};};};};};};};return nil ,nil ;};var _aaae =[]romanMatch {romanMatch {1000,"\u006d"},romanMatch {900,"\u0063\u006d"},romanMatch {500,"\u0064"},romanMatch {400,"\u0063\u0064"},romanMatch {100,"\u0063"},romanMatch {90,"\u0078\u0063"},romanMatch {50,"\u006c"},romanMatch {40,"\u0078\u006c"},romanMatch {10,"\u0078"},romanMatch {9,"\u0069\u0078"},romanMatch {5,"\u0076"},romanMatch {4,"\u0069\u0076"},romanMatch {1,"\u0069"}};type convertContext struct{_caea *_gd .Creator ;_gggc *_e .Document ;_ggcc *_gd .StyledParagraph ;_bddb []*page ;_cagc *page ;_cceg *_a .Rectangle ;_fgcg *paragraph ;_gfcg *_a .Rectangle ;_efeb *line ;_gacf *span ;_fefeb *word ;_aacb *_ab .CT_Hyperlink ;_bbgg *_ab .CT_ParaRPr ;_adg []note ;_egag *prefix ;_cbd bool ;_gfaf bool ;_edd bool ;_bbaa float64 ;_dfag float64 ;_cgbdg float64 ;_acagc float64 ;_bbcaf bool ;_ggf map[int64 ]map[int64 ]int ;};func (_agb *convertContext )addHdrFtr (_bgage []*_ab .CT_P ){for _ ,_bag :=range _bgage {_cfe :=_agb ._caea .NewStyledParagraph ();_agb ._ggcc =_cfe ;_bfbb ,_gcgf :=_agb .combinePPrWithStyles (_bag .PPr );_eccb ,_agbc :=_fda (_bfbb ,_cfe );_agb .addRelativeEGPC (_bag .EG_PContent ,_bfbb ,_gcgf );if _agb ._gfaf {_agb ._caea .DrawHeader (func (_ecea *_gd .Block ,_ffbb _gd .HeaderFunctionArgs ){_cfe .SetPos (_agb ._bbaa +_agbc ,_eccb +_agb ._dfag );_ecea .Draw (_cfe );});}else if _agb ._edd {_agb ._caea .DrawFooter (func (_gcge *_gd .Block ,_ggdc _gd .FooterFunctionArgs ){_cfe .SetPos (_agb ._bbaa +_agbc ,_eccb +_agb ._cgbdg -_agb ._acagc );_gcge .Draw (_cfe );});};};};const _ae =0.67;func (_gcfc *convertContext )addSeparator (){_gcfc .newParagraph ();_gcfc ._fgcg ._agca =true ;_gcfc ._fgcg ._ec =_ed ;if _gcfc .currentParagraphOverflowsCurrentPage (){_gcfc .newPage ();_gcfc ._fgcg ._de =_gcfc ._cagc ._cf ;};_gcfc .addCurrentParagraphToCurrentPage ();};func (_cgg *convertContext )addCurrentWordToParagraph (){for {_gaga :=_cgg ._efeb ._bf ;_acdb :=_gaga +_cgg ._fefeb ._aac ;if _acdb > _cgg ._efeb ._dd {_cgg .newLine ();};_adfg :=_cgg ._fgcg ._de +_cgg ._efeb ._fa ;_dbfb :=_adfg +_cgg ._efeb ._bfe ;_fbbga :=false ;_cab :=append (_cgg ._cagc ._dfc ,_cgg ._fgcg ._acb ...);for _ ,_dffa :=range _cab {_gcfd :=_dffa ._bg ;if ((_adfg > _gcfd .Top &&_adfg < _gcfd .Bottom )||(_dbfb > _gcfd .Top &&_dbfb < _gcfd .Bottom ))&&((_gaga > _gcfd .Left &&_gaga < _gcfd .Right )||(_acdb > _gcfd .Left &&_acdb < _gcfd .Right )){_fbbga =true ;if _cgg ._efeb ._bf < _gcfd .Right {_cgg ._gacf ._afa =_gcfd .Left ;_cgg ._efeb ._bf =_gcfd .Right ;_cgg .newSpan ();};};};if !_fbbga {break ;};};if !_cgg ._fefeb ._dc ||len (_cgg ._gacf ._bcb )> 0{_cgg ._fefeb ._gfb =_cgg ._efeb ._bf ;_cgg ._gacf ._bcb =append (_cgg ._gacf ._bcb ,_cgg ._fefeb );_cgg ._efeb ._bf +=_cgg ._fefeb ._aac ;for _ ,_bae :=range _cgg ._fefeb ._bb {_cgg .adjustHeights (_bae ._geb );};};};func (_ccg *convertContext )addParagraphWithTable (_adc _gd .Table ,_efc ,_aea float64 ){_ccg .newParagraph ();_ccg ._fgcg ._ccc =&_a .Rectangle {Top :_adac (2),Bottom :_adac (2),Left :0,Right :0};_ccg ._fgcg ._aeg =&tableWrapper {_ee :&_adc ,_egd :_efc };_ccg ._fgcg ._aa =_aea ;_ccg ._fgcg ._ec =_adc .Height ();_ccg .determineParagraphBounds ();_ccg .addCurrentParagraphToCurrentPage ();};type word struct{_bb []*symbol ;_gfb float64 ;_aac float64 ;_dc bool ;};func _dabd (_fagf int ,_eacb bool )string {_fdbd :=(_fagf -1)/26+1;_fdgg :=byte ((_fagf -1)%26);if _eacb {_fdgg +=byte (65);}else {_fdgg +=byte (97);};_gacd :=_gc .NewBuffer ([]byte {});for _dfbe :=0;_dfbe < _fdbd ;_dfbe ++{_gacd .Write ([]byte {_fdgg });};return _gacd .String ();};func _fcfg (_eceb *_ab .CT_TblPr ,_efbd *_ab .CT_TblPrEx ,_becf *_ab .CT_TcPr ,_dbgg ,_cdae ,_geabe ,_acee int )*_ab .CT_TcPr {if _becf ==nil {_becf =_ab .NewCT_TcPr ();};if _becf ==nil {_becf =_ab .NewCT_TcPr ();};if _efbd ==nil {_efbd =_ab .NewCT_TblPrEx ();};if _eceb ==nil {_eceb =_ab .NewCT_TblPr ();};if _becf .TcBorders ==nil {_becf .TcBorders =_ab .NewCT_TcBorders ();};if _efbd .TblBorders ==nil {_efbd .TblBorders =_ab .NewCT_TblBorders ();};if _eceb .TblBorders ==nil {_eceb .TblBorders =_ab .NewCT_TblBorders ();};if _becf .TcBorders .Top ==nil {if _efbd .TblBorders .Top ==nil {_becf .TcBorders .Top =_febg (_eceb .TblBorders .Top ,_eceb .TblBorders .InsideH ,_dbgg ==0);}else {_becf .TcBorders .Top =_febg (_efbd .TblBorders .Top ,_efbd .TblBorders .InsideH ,_dbgg ==0);};};if _becf .TcBorders .Bottom ==nil {if _efbd .TblBorders .Bottom ==nil {_becf .TcBorders .Bottom =_febg (_eceb .TblBorders .Bottom ,_eceb .TblBorders .InsideH ,_dbgg ==0);}else {_becf .TcBorders .Bottom =_febg (_efbd .TblBorders .Bottom ,_efbd .TblBorders .InsideH ,_dbgg ==0);};};if _becf .TcBorders .Left ==nil {if _efbd .TblBorders .Left ==nil {_becf .TcBorders .Left =_febg (_eceb .TblBorders .Left ,_eceb .TblBorders .InsideV ,_dbgg ==0);}else {_becf .TcBorders .Left =_febg (_efbd .TblBorders .Left ,_efbd .TblBorders .InsideV ,_dbgg ==0);};};if _becf .TcBorders .Right ==nil {if _efbd .TblBorders .Right ==nil {_becf .TcBorders .Right =_febg (_eceb .TblBorders .Right ,_eceb .TblBorders .InsideV ,_dbgg ==0);}else {_becf .TcBorders .Right =_febg (_efbd .TblBorders .Right ,_efbd .TblBorders .InsideV ,_dbgg ==0);};};if _becf .Shd ==nil {if _fafe :=_eceb .Shd ;_fafe !=nil {_becf .Shd =_fafe ;};}else {if _eceb .Shd !=nil &&_becf .Shd .FillAttr ==nil {_becf .Shd .FillAttr =_eceb .Shd .FillAttr ;};};if _becf .TcMar ==nil {if _bccc :=_eceb .TblCellMar ;_bccc !=nil {_becf .TcMar =_ab .NewCT_TcMar ();_becf .TcMar .Left =_bccc .Left ;};}else {if _eceb .TblCellMar !=nil &&_becf .TcMar .Left ==nil {_becf .TcMar .Left =_eceb .TblCellMar .Left ;};};return _becf ;};func (_aacg *convertContext )adjustHeights (_dfgf float64 ){if _aacg ._efeb ._bfe < _dfgf {_aacg ._fgcg ._ec +=(_dfgf -_aacg ._efeb ._bfe );_aacg ._efeb ._bfe =_dfgf ;};};func _fgeb (_feb *_ab .CT_TblWidth ,_caaa ,_eceag float64 )float64 {if _feb !=nil {if _bfde :=_feb .WAttr ;_bfde !=nil {if _gafe :=_bfde .ST_DecimalNumberOrPercent ;_gafe !=nil {if _egaf :=_gafe .ST_UnqualifiedPercentage ;_egaf !=nil {switch _feb .TypeAttr {case _ab .ST_TblWidthDxa :return float64 (*_egaf )/56.7;case _ab .ST_TblWidthPct :return float64 (*_egaf )/100*_caaa ;default:return _eceag ;};};};};};return _eceag ;};func (_cea *convertContext )addAbsoluteEGPC (_accf []*_ab .EG_PContent ,_aee *_ab .CT_PPr ,_bff *prefix )bool {_cea .newParagraph ();_aafg (_aee ,_cea ._fgcg );_cea .determineParagraphBounds ();_cea .addAnchorBlocks (_accf );_cea .addAnchorExtra (_accf );_cea .newLine ();_cea .newWord ();if len (_accf )==0{_cea .addEmptyLine ();return false ;};if _bff !=nil {_cea ._egag =_bff ;};for _ ,_bcbg :=range _accf {for _ ,_dff :=range _bcbg .FldSimple {if _dff !=nil {_cea .addAbsoluteEGPC (_dff .EG_PContent ,_aee ,_bff );};};if _fec :=_bcbg .Hyperlink ;_fec !=nil {_cea ._aacb =_fec ;_cea .addAbsoluteCRC (_fec .EG_ContentRunContent ,_aee );};_cea ._aacb =nil ;if _cea .addAbsoluteCRC (_bcbg .EG_ContentRunContent ,_aee ){return true ;};};_cea .addCurrentWordToParagraph ();return false ;};func (_edba *convertContext )newParagraph (){if _edba ._cagc ==nil {_edba .newPage ();};_dbbg :=&paragraph {};_dbbg ._ccc =&_a .Rectangle {};_dbbg ._de =_edba ._cagc ._cf ;_edba ._fgcg =_dbbg ;};type symbol struct{_ege string ;_agd float64 ;_geb float64 ;_egf float64 ;_fca float64 ;_ggd *_gd .TextStyle ;_bcf *_gd .Image ;_cgd *block ;_fb string ;_bfb bool ;_dcd bool ;};func (_deba *convertContext )newPage (){_ebf :=&page {};_ebf ._cb =_deba ._cceg ;_ebf ._cf =_ebf ._cb .Top ;if _deba ._bbcaf {_ebf ._ga =true ;_ebf ._cf +=_ed ;};_deba ._bddb =append (_deba ._bddb ,_ebf );_deba ._cagc =_ebf ;};func (_cbff *convertContext )addAnchorExtra (_ddc []*_ab .EG_PContent ){for _ ,_dddc :=range _ddc {for _ ,_bbge :=range _dddc .EG_ContentRunContent {if _bfdc :=_bbge .R ;_bfdc !=nil {for _ ,_bffg :=range _bfdc .Extra {if _efb ,_cde :=_bffg .(*_ab .AlternateContentRun );_cde {if _fabf :=_efb .Choice ;_fabf !=nil {if _gecb :=_fabf .Drawing ;_gecb !=nil {for _ ,_bdcd :=range _gecb .Anchor {var _gaf ,_gga ,_gade ,_gebc float64 ;_bcgc ,_ecca :=_bdcd .PositionH ,_bdcd .PositionV ;if _fcf :=_bcgc .Choice ;_fcf !=nil {if _fcf .PosOffset !=nil {_gaf =_ca .FromEMU (int64 (*_fcf .PosOffset ));};};if _egge :=_ecca .Choice ;_egge !=nil {if _egge .PosOffset !=nil {_gga =_ca .FromEMU (int64 (*_egge .PosOffset ));};};if _abgd :=_bdcd .Extent ;_abgd !=nil {_gebc =_ca .FromEMU (_abgd .CxAttr );_gade =_ca .FromEMU (_abgd .CyAttr );};_dffe :=_cbff ._fgcg ._de +_gga ;_dda :=_dffe +_gade ;_fabd :=_cbff ._fgcg ._fd +_gaf ;_gcc :=_fabd +_gebc ;_bbbe :=_gga +_gade ;if _bbbe > _cbff ._fgcg ._agc {_cbff ._fgcg ._agc =_bbbe ;};if _bdcd .Choice !=nil &&_bdcd .Choice .WrapNone ==nil {_cbff ._fgcg ._acb =append (_cbff ._fgcg ._acb ,&zoneToSkip {_bg :&_a .Rectangle {Top :_dffe ,Bottom :_dda ,Left :_fabd ,Right :_gcc },_cgaa :_bdcd .Choice });};if _ffbga :=_bdcd .Graphic ;_ffbga !=nil {if _debg :=_ffbga .GraphicData ;_debg !=nil {for _ ,_aadd :=range _debg .Any {if _dbe ,_edf :=_aadd .(*_ab .WdWsp );_edf {_afb ,_bgad :=_cbff .makeBlockFromWdWsp (_dbe );if _bgad !=nil {_d .Println ("\u0043a\u006en\u006f\u0074\u0020\u0072\u0065a\u0064\u0020b\u006c\u006f\u0063\u006b\u003a",_bgad );};if _afb !=nil {_afb ._ff .Scale (_gebc /_afb ._ff .Width (),_gade /_afb ._ff .Height ());_afb ._ede =_fabd ;_afb ._bdd =_dffe ;if _bdcd .BehindDocAttr {_cbff ._fgcg ._dac =append (_cbff ._fgcg ._dac ,_afb );}else {_cbff ._fgcg ._da =append (_cbff ._fgcg ._da ,_afb );};};};};};};};};};};};};};};};func (_eecb *convertContext )addAnchorBlocks (_dacc []*_ab .EG_PContent ){for _ ,_eeg :=range _dacc {for _ ,_aba :=range _eeg .EG_ContentRunContent {if _ceab :=_aba .R ;_ceab !=nil {for _ ,_ea :=range _ceab .EG_RunInnerContent {if _bea :=_ea .Drawing ;_bea !=nil {for _ ,_gdeb :=range _bea .Anchor {var _gae ,_cbfb ,_ecc ,_ccb float64 ;_bfg ,_ffbe :=_gdeb .PositionH ,_gdeb .PositionV ;if _gge :=_bfg .Choice ;_gge !=nil {if _gge .PosOffset !=nil {_gae =_ca .FromEMU (int64 (*_gge .PosOffset ));};};if _aecd :=_ffbe .Choice ;_aecd !=nil {if _aecd .PosOffset !=nil {_cbfb =_ca .FromEMU (int64 (*_aecd .PosOffset ));};};if _gagc :=_gdeb .Extent ;_gagc !=nil {_ccb =_ca .FromEMU (_gagc .CxAttr );_ecc =_ca .FromEMU (_gagc .CyAttr );};_ggee :=_eecb ._fgcg ._de +_cbfb ;_bcg :=_ggee +_ecc ;_cbe :=_eecb ._fgcg ._fd +_gae ;_cdc :=_cbe +_ccb ;_ebb :=_cbfb +_ecc ;if _ebb > _eecb ._fgcg ._agc {_eecb ._fgcg ._agc =_ebb ;};if _gdeb .Choice !=nil &&_gdeb .Choice .WrapNone ==nil {_eecb ._fgcg ._acb =append (_eecb ._fgcg ._acb ,&zoneToSkip {_bg :&_a .Rectangle {Top :_ggee ,Bottom :_bcg ,Left :_cbe ,Right :_cdc },_cgaa :_gdeb .Choice });};if _gdcb :=_gdeb .Graphic ;_gdcb !=nil {if _dace :=_gdcb .GraphicData ;_dace !=nil {for _ ,_cfa :=range _dace .Any {if _bdf ,_bgc :=_cfa .(*_bc .Pic );_bgc {_eed ,_bde :=_eecb .makePdfImageFromGraphics (_bdf );if _bde !=nil {_d .Println ("\u0043a\u006en\u006f\u0074\u0020\u0072\u0065a\u0064\u0020i\u006d\u0061\u0067\u0065\u003a",_bde );};if _eed !=nil {_eed .Scale (_ccb /_eed .Width (),_ecc /_eed .Height ());_eed .SetPos (_cbe ,_ggee );if _gdeb .BehindDocAttr {_eecb ._fgcg ._bd =append (_eecb ._fgcg ._bd ,_eed );}else {_eecb ._fgcg ._agg =append (_eecb ._fgcg ._agg ,_eed );};};}else if _bdb ,_dbf :=_cfa .(*_df .Chart );_dbf {_afg ,_gea :=_eecb .makePdfBlockFromChart (_bdb ,_ecc ,_ccb );if _gea !=nil {_d .Println ("\u0043a\u006en\u006f\u0074\u0020\u0072\u0065a\u0064\u0020b\u006c\u006f\u0063\u006b\u003a",_gea );};if _afg !=nil {_eab :=&block {_ff :_afg ,_ede :_cbe ,_bdd :_ggee };if _gdeb .BehindDocAttr {_eecb ._fgcg ._dac =append (_eecb ._fgcg ._dac ,_eab );}else {_eecb ._fgcg ._da =append (_eecb ._fgcg ._da ,_eab );};};};};};};};};};};};};};func (_abd *convertContext )addTextSymbol (_bbdf *symbol ){_dfac :=_gd .New ();_dcg :=_dfac .NewStyledParagraph ();_dcg .SetMargins (0,0,0,0);_fge :=_dcg .Append (_bbdf ._ege );_dcg .SetLineHeight (_abd ._fgcg ._ac );_fegf :=0.0;if _bbdf ._ggd !=nil {_fge .Style =*_bbdf ._ggd ;if _bbdf ._ggd .CharSpacing !=0{_fegf =_bbdf ._ggd .CharSpacing ;};};_bbdf ._geb =_dcg .Height ();if _bbdf ._fca ==0{_bbdf ._fca =_dcg .Width ()+_fegf ;};if len (_abd ._fefeb ._bb )> 0{_gcf :=_abd ._fefeb ._bb [len (_abd ._fefeb ._bb )-1]._ege ;if _a .IsNoSpaceLanguage (_gcf )||(_gcf =="\u0020")!=(_bbdf ._ege =="\u0020"){_abd .addCurrentWordToParagraph ();_abd .newWord ();};};_abd ._fefeb ._bb =append (_abd ._fefeb ._bb ,_bbdf );_bbdf ._agd =_abd ._fefeb ._aac ;_abd ._fefeb ._aac +=_bbdf ._fca ;if _bbdf ._ege !="\u0020"{_abd ._fefeb ._dc =false ;};if _bbdf ._ege =="\u000d"{_abd .adjustHeights (_bbdf ._geb );};};type prefix struct{_aff string ;_fad []float64 ;_dffaf bool ;_gagb bool ;};func (_cdfe *convertContext )addAbsoluteTable (_cade *_ab .CT_Tbl ){_cdeb :=_cade .TblGrid ;if _cdeb ==nil {return ;};_dgaf :=len (_cdeb .GridCol );if _dgaf ==0{return ;};_dbc :=[]float64 {};_acdc :=[]float64 {};_fcad :=0.0;for _ ,_dgbd :=range _cdeb .GridCol {_ddag :=0.0;if _dgbd .WAttr .ST_UnsignedDecimalNumber !=nil {_ddag =_a .PointsFromTwips (int64 (*_dgbd .WAttr .ST_UnsignedDecimalNumber ));};_dbc =append (_dbc ,_ddag );_fcad +=_ddag ;};for _fbdab :=0;_fbdab < _dgaf ;_fbdab ++{_acdc =append (_acdc ,_dbc [_fbdab ]/_fcad );};_gdca :=_cdfe ._caea .NewTable (_dgaf );_gdca .SetColumnWidths (_acdc ...);_bgaf :=_cdfe ._caea .NewTable (_dgaf );_bgaf .SetColumnWidths (_acdc ...);_cbg :=_cbac (_cdfe ._gggc ,_cade .TblPr );_dbbd :=_fgeb (_cbg .TblW ,_cdfe ._cagc ._cb .Right -_cdfe ._cagc ._cb .Left ,0);_bee :=_fgeb (_cbg .TblInd ,_cdfe ._cagc ._cb .Right -_cdfe ._cagc ._cb .Left ,0);_cbbc :=_cdfe ._cagc ._cb .Bottom -_cdfe ._fgcg ._de ;_ebd :=len (_cade .EG_ContentRowContent );for _cdec ,_fac :=range _cade .EG_ContentRowContent {if _fac ==nil {continue ;};_gab :=_cdfe ._caea .NewTable (_dgaf );_gab .SetColumnWidths (_acdc ...);if _fff :=_fac .Tr ;len (_fff )> 0{_abdg :=_fff [0];_ddg :=_abdg .TblPrEx ;for _aaf ,_gabb :=range _abdg .EG_ContentCellContent {if _fabc :=_gabb .Tc ;len (_fabc )> 0{if _fcc :=_fabc [0];_fcc !=nil {_cdfe .addCellToTable (_bgaf ,_fcc ,_cbg ,_ddg ,_cdec ,_aaf ,_ebd ,_dgaf );_cdfe .addCellToTable (_gab ,_fcc ,_cbg ,_ddg ,_cdec ,_aaf ,_ebd ,_dgaf );};};};var _edcf float64 ;if _ddagf :=_abdg .TrPr ;_ddagf !=nil {if len (_ddagf .TrHeight )!=0{_cfac :=_ddagf .TrHeight [0];if _ddef :=_cfac .ValAttr ;_ddef !=nil {if _ddef .ST_UnsignedDecimalNumber !=nil {_edcf =_a .PointsFromTwips (int64 (*_ddef .ST_UnsignedDecimalNumber ));};};};};if _edcf < _adac (4){_edcf =_adac (4);};_bgaf .SetRowHeight (_bgaf .CurRow (),_edcf );if _dbbd ==0{_dbbd =_cdfe ._cagc ._cb .Right -_cdfe ._cagc ._cb .Left ;};_badd :=_a .MakeTempCreator (_dbbd ,_adac (1000));_badd .Draw (_bgaf );if _bgaf .Height ()>=_cbbc {_cdfe .addParagraphWithTable (*_gdca ,_dbbd ,_bee );_cdfe .newPage ();*_bgaf =*_gab ;_bgaf .SetRowHeight (_bgaf .CurRow (),_edcf );_cbbc =_cdfe ._cagc ._cb .Bottom -_cdfe ._cagc ._cb .Top ;_gdca =nil ;}else {if _gdca ==nil {_gdca =_cdfe ._caea .NewTable (_dgaf );_gdca .SetColumnWidths (_acdc ...);};*_gdca =*_bgaf ;};};};if _gdca !=nil {_cdfe .addParagraphWithTable (*_gdca ,_dbbd ,_bee );};};

// RegisterFont makes a PdfFont accessible for using in converting to PDF.
func RegisterFont (name string ,style FontStyle ,font *_ef .PdfFont ){_a .RegisterFont (name ,style ,font );};var _dfe =_adac (0.25);func (_beda *convertContext )addRelativeCRC (_ceabc []*_ab .EG_ContentRunContent ,_bbgb *_ab .CT_PPr ){for _ ,_beeb :=range _ceabc {if _aefd :=_beeb .R ;_aefd !=nil {_eag :=_dfce (_beda ._gggc ,_aefd .RPr ,_bbgb );if _beda ._egag !=nil {_beda .addRelativeRIC (nil ,_eag );_beda ._egag =nil ;};for _ ,_bcdc :=range _aefd .EG_RunInnerContent {_beda .addRelativeRIC (_bcdc ,_eag );};};};};type zoneToSkip struct{_bg *_a .Rectangle ;_cgaa *_ab .WdEG_WrapTypeChoice ;};func (_cdda *convertContext )addEndnotes (){for _fgdg ,_ega :=range _cdda ._adg {if _fgdg ==0{_cdda .addSeparator ();};_cdda ._egag =&prefix {_aff :_ega ._gg };for _eefbb ,_bgag :=range _ega ._ag {if _fgdg !=0||_eefbb !=0{_cdda ._bbcaf =true ;};_cdda .addAbsoluteCBCs (_bgag .EG_ContentBlockContent );};};_cdda ._bbcaf =false ;};func (_fdb *convertContext )addTables (_acag []*_ab .CT_Tbl ){for _ ,_cag :=range _acag {_fdb .addAbsoluteTable (_cag );};};type span struct{_fc float64 ;_afa float64 ;_bcb []*word ;};func (_gebce *convertContext )addCellToTable (_def *_gd .Table ,_abb *_ab .CT_Tc ,_cbgf *_ab .CT_TblPr ,_ccgd *_ab .CT_TblPrEx ,_faf ,_bbbd ,_fcef ,_caag int ){var _acac *_gd .TableCell ;_fbcc :=1;_gfac :=_fcfg (_cbgf ,_ccgd ,_abb .TcPr ,_faf ,_bbbd ,_fcef ,_caag );_gaae :=_cg ;_adfc :=_gd .CellVerticalAlignmentTop ;if _gfac !=nil {if _gfac .GridSpan !=nil {_fbcc =int (_gfac .GridSpan .ValAttr );};_acac =_def .MultiColCell (_fbcc );if _gcfb :=_gfac .TcBorders ;_gcfb !=nil {if _fefe :=_gcfb .Left ;_fefe !=nil {_fbbd ,_ece ,_ccae :=_cgdd (_fefe );_acac .SetBorder (_gd .CellBorderSideLeft ,_fbbd ,_ccae );if _ece !=nil &&*_ece !=nil {_acac .SetSideBorderColor (_gd .CellBorderSideLeft ,*_ece );};};if _cead :=_gcfb .Top ;_cead !=nil {_ebdc ,_bdbg ,_bfcg :=_cgdd (_cead );_acac .SetBorder (_gd .CellBorderSideTop ,_ebdc ,_bfcg );if _bdbg !=nil &&*_bdbg !=nil {_acac .SetSideBorderColor (_gd .CellBorderSideTop ,*_bdbg );};};if _ccac :=_gcfb .Right ;_ccac !=nil {_deae ,_gdcf ,_cef :=_cgdd (_ccac );_acac .SetBorder (_gd .CellBorderSideRight ,_deae ,_cef );if _gdcf !=nil &&*_gdcf !=nil {_acac .SetSideBorderColor (_gd .CellBorderSideRight ,*_gdcf );};};if _bcea :=_gcfb .Bottom ;_bcea !=nil {_dgbb ,_bedd ,_bbae :=_cgdd (_bcea );_acac .SetBorder (_gd .CellBorderSideBottom ,_dgbb ,_bbae );if _bedd !=nil &&*_bedd !=nil {_acac .SetSideBorderColor (_gd .CellBorderSideBottom ,*_bedd );};};}else {_acac .SetBorder (_gd .CellBorderSideAll ,_gd .CellBorderStyleSingle ,_adac (0.125));_acac .SetBorderColor (_gd .ColorBlack );};if _dad :=_gfac .Shd ;_dad !=nil {if _bbca :=_dad .FillAttr ;_bbca !=nil {if _aebe :=_bbca .ST_HexColorRGB ;_aebe !=nil {_afc :=_gd .ColorRGBFromHex ("\u0023"+*_aebe );_acac .SetBackgroundColor (_afc );};};};if _afdd :=_gfac .TcMar ;_afdd !=nil {_gaae =_fgeb (_afdd .Left ,0,_cg );};if _agga :=_gfac .VAlign ;_agga !=nil {switch _agga .ValAttr {case _ab .ST_VerticalJcCenter :_adfc =_gd .CellVerticalAlignmentMiddle ;case _ab .ST_VerticalJcBottom :_adfc =_gd .CellVerticalAlignmentBottom ;};};};if _acac ==nil {_acac =_def .NewCell ();};_acac .SetVerticalAlignment (_adfc );_acac .SetIndent (_gaae );_dfacb :=_abb .EG_BlockLevelElts ;_cdb :=_gebce ._caea .NewStyledParagraph ();_bgg :=false ;for _ ,_eefd :=range _dfacb {for _ ,_ddcg :=range _eefd .EG_ContentBlockContent {_eaff :=true ;for _ ,_gdea :=range _ddcg .P {_bbac ,_ :=_gebce .combinePPrWithStyles (_gdea .PPr );for _ ,_ecdd :=range _gdea .EG_PContent {for _ ,_geac :=range _ecdd .EG_ContentRunContent {if _ffbde :=_geac .R ;_ffbde !=nil {_cgag :=_dfce (_gebce ._gggc ,_ffbde .RPr ,_bbac );for _ ,_gfba :=range _ffbde .EG_RunInnerContent {var _dbcb *_gd .TextChunk ;if _gfba .T !=nil &&_gfba .T .Content !=""{if _bgg {if _eaff {_egba :=_cdb .Append ("\u000a");_ebab :=_gebce ._caea .NewTextStyle ();_ebab .FontSize =0;_egba .Style =_ebab ;_eaff =false ;};}else {_bgg =true ;};_dbcb =_cdb .Append (_gfba .T .Content );_dbcb .Style ,_ ,_ =_gebce .makeRunStyle (_cgag ,false ,false ,false ,false ,false );};};};};};if _cdb !=nil {_fda (_bbac ,_cdb );};};};};_acac .SetContent (_cdb );};func (_cda *convertContext )addAbsoluteCBCs (_cgc []*_ab .EG_ContentBlockContent ){for _ ,_caeg :=range _cgc {_cda .addParagraphs (_caeg .P );_cda .addTables (_caeg .Tbl );};};func (_fbbg *convertContext )addInlineSymbol (_bcgcf *symbol ){if len (_fbbg ._fefeb ._bb )> 0{_aefee :=_fbbg ._fefeb ._bb [len (_fbbg ._fefeb ._bb )-1]._ege ;if _aefee =="\u0020"{_fbbg .addCurrentWordToParagraph ();_fbbg .newWord ();};};_fbbg ._fefeb ._bb =append (_fbbg ._fefeb ._bb ,_bcgcf );_bcgcf ._agd =_fbbg ._fefeb ._aac ;_fbbg ._fefeb ._aac +=_bcgcf ._fca ;_fbbg ._fefeb ._dc =false ;if _fbbg ._efeb ._bfe < _bcgcf ._geb {_fbbg ._fgcg ._ec +=(_bcgcf ._geb -_fbbg ._efeb ._bfe );_fbbg ._efeb ._bfe =_bcgcf ._geb ;};};var _cg =_adac (1.9);func _dfce (_abdd *_e .Document ,_eecf *_ab .CT_RPr ,_bdee *_ab .CT_PPr )*_ab .CT_RPr {var _ecff ,_gedf *_ab .CT_RPr ;if _eecf ==nil {_eecf =_ab .NewCT_RPr ();};var _efagd *_ab .CT_ParaRPr ;if _bdee !=nil &&_bdee .RPr !=nil {_efagd =_bdee .RPr ;};if _efagd ==nil {_efagd =_ab .NewCT_ParaRPr ();};if _eecf .RStyle !=nil {_eecc :=_abdd .GetStyleByID (_eecf .RStyle .ValAttr );if _dccg :=_eecc .X ();_dccg !=nil {_ecff =_dccg .RPr ;};};if _ecff ==nil {_ecff =_ab .NewCT_RPr ();};if _efagd .RStyle !=nil {_dba :=_abdd .GetStyleByID (_efagd .RStyle .ValAttr );if _gfga :=_dba .X ();_gfga !=nil {_gedf =_gfga .RPr ;};};if _gedf ==nil {_gedf =_ab .NewCT_RPr ();};if _eecf .Color ==nil {if _ecff .Color !=nil {_eecf .Color =_ecff .Color ;}else if _efagd .Color !=nil {_eecf .Color =_efagd .Color ;}else if _gedf .Color !=nil {_eecf .Color =_gedf .Color ;};};if _eecf .Spacing ==nil {if _ecff .Spacing !=nil {_eecf .Spacing =_ecff .Spacing ;}else if _efagd .Spacing !=nil {_eecf .Spacing =_efagd .Spacing ;}else if _gedf .Spacing !=nil {_eecf .Spacing =_gedf .Spacing ;};};if _eecf .Sz ==nil {if _ecff .Sz !=nil {_eecf .Sz =_ecff .Sz ;}else if _efagd .Sz !=nil {_eecf .Sz =_efagd .Sz ;}else if _gedf .Sz !=nil {_eecf .Sz =_gedf .Sz ;};};if _eecf .SzCs ==nil {if _ecff .SzCs !=nil {_eecf .SzCs =_ecff .SzCs ;}else if _efagd .SzCs !=nil {_eecf .SzCs =_efagd .SzCs ;}else if _gedf .SzCs !=nil {_eecf .SzCs =_gedf .SzCs ;};};if _eecf .B ==nil {if _ecff .B !=nil {_eecf .B =_ecff .B ;}else if _efagd .B !=nil {_eecf .B =_efagd .B ;}else if _gedf .B !=nil {_eecf .B =_gedf .B ;};};if _eecf .I ==nil {if _ecff .I !=nil {_eecf .I =_ecff .I ;}else if _efagd .I !=nil {_eecf .I =_efagd .I ;}else if _gedf .I !=nil {_eecf .I =_gedf .I ;};};if _eecf .RFonts ==nil {if _ecff .RFonts !=nil {_eecf .RFonts =_ecff .RFonts ;}else if _efagd .RFonts !=nil {_eecf .RFonts =_efagd .RFonts ;}else if _gedf .RFonts !=nil {_eecf .RFonts =_gedf .RFonts ;};};if _eecf .VertAlign ==nil {if _ecff .VertAlign !=nil {_eecf .VertAlign =_ecff .VertAlign ;}else if _efagd .VertAlign !=nil {_eecf .VertAlign =_efagd .VertAlign ;}else if _gedf .VertAlign !=nil {_eecf .VertAlign =_gedf .VertAlign ;};};return _eecf ;};func (_fcaa *convertContext )adjustRightBoundOfLastSpan (){_gfbd :=_fcaa ._gacf ._afa ;_egee :=_fcaa ._efeb ._fa +_fcaa ._fgcg ._de ;_afac :=_egee +_fcaa ._efeb ._bfe ;for _ ,_fea :=range _fcaa ._cagc ._dfc {if ((_egee > _fea ._bg .Top &&_egee < _fea ._bg .Bottom )||(_afac > _fea ._bg .Top &&_egee < _fea ._bg .Bottom ))&&(_gfbd > _fea ._bg .Left ){_gfbd =_fea ._bg .Left ;};};_fcaa ._gacf ._afa =_gfbd ;};type line struct{_fa float64 ;_ad float64 ;_dd float64 ;_bf float64 ;_bfe float64 ;_acc []*span ;};var _ed =_adac (6);type paragraph struct{_aa float64 ;_ccc *_a .Rectangle ;_aad float64 ;_fd float64 ;_dfee float64 ;_de float64 ;_ec float64 ;_bge _gd .TextAlignment ;_ac float64 ;_af []*line ;_aeg *tableWrapper ;_agg []*_gd .Image ;_bd []*_gd .Image ;_da []*block ;_dac []*block ;_db []*note ;_dee float64 ;_acb []*zoneToSkip ;_agc float64 ;_agca bool ;};func (_ebca *convertContext )newSpan (){_fbda :=&span {_fc :_ebca ._efeb ._bf ,_afa :_ebca ._efeb ._dd };_ebca ._gacf =_fbda ;_ebca ._efeb ._acc =append (_ebca ._efeb ._acc ,_fbda );};func (_gfd *convertContext )addAbsoluteCRC (_debe []*_ab .EG_ContentRunContent ,_adag *_ab .CT_PPr )bool {for _ ,_eba :=range _debe {if _cfb :=_eba .R ;_cfb !=nil {_dfcd :=_dfce (_gfd ._gggc ,_cfb .RPr ,_adag );if _gfd ._egag !=nil {_gfd .addAbsoluteRIC (nil ,_dfcd );_gfd ._egag =nil ;};for _ ,_gfbe :=range _cfb .EG_RunInnerContent {if _gfd .addAbsoluteRIC (_gfbe ,_dfcd ){return true ;};};for _ ,_fab :=range _cfb .Extra {if _ggg ,_ecf :=_fab .(*_ab .AlternateContentRun );_ecf {if _agaf :=_ggg .Choice ;_agaf !=nil {if _fce :=_agaf .Drawing ;_fce !=nil {if len (_fce .Inline )> 0{for _ ,_cgec :=range _fce .Inline {_acf :=_cgec .Extent ;if _acf ==nil {return false ;};_bgb :=_ca .FromEMU (_acf .CxAttr );_bfd :=_ca .FromEMU (_acf .CyAttr );if _aega :=_cgec .Graphic ;_aega !=nil {if _bga :=_aega .GraphicData ;_bga !=nil {for _ ,_cadd :=range _bga .Any {if _aeec ,_ffbg :=_cadd .(*_ab .WdWsp );_ffbg {_dde ,_ffd :=_gfd .makeBlockFromWdWsp (_aeec );if _ffd !=nil {_d .Println ("\u0043a\u006en\u006f\u0074\u0020\u0072\u0065a\u0064\u0020b\u006c\u006f\u0063\u006b\u003a",_ffd );};if _dde ==nil {continue ;};_dde ._ff .Scale (_bgb /_dde ._ff .Width (),_bfd /_dde ._ff .Height ());_gfd .addInlineSymbol (&symbol {_geb :_bfd ,_fca :_bgb ,_cgd :_dde });};};};};};};};};};};};};return false ;};

// ConvertToPdf converts document to PDF file. This package is beta, breaking changes can take place.
func ConvertToPdf (d *_e .Document )*_gd .Creator {_ddf :=d .BodySection ().X ();var _cage ,_gdf ,_gdd ,_cadf ,_dbd ,_ded float64 ;_ggdg :=_ddf .PgMar ;if _ggdg .LeftAttr .ST_UnsignedDecimalNumber !=nil {_cage =_a .PointsFromTwips (int64 (*_ggdg .LeftAttr .ST_UnsignedDecimalNumber ));};if _ggdg .LeftAttr .ST_UnsignedDecimalNumber !=nil {_gdf =_a .PointsFromTwips (int64 (*_ggdg .RightAttr .ST_UnsignedDecimalNumber ));};if _ggdg .TopAttr .Int64 !=nil {_gdd =_a .PointsFromTwips (*_ggdg .TopAttr .Int64 );};if _ggdg .BottomAttr .Int64 !=nil {_cadf =_a .PointsFromTwips (*_ggdg .BottomAttr .Int64 );};_gabg :=_ddf .PgSz ;_cgba ,_bec :=_adac (210),_adac (297);if _gabg .WAttr !=nil {_cgba =_a .PointsFromTwips (int64 (*_gabg .WAttr .ST_UnsignedDecimalNumber ));};if _gabg .HAttr !=nil {_bec =_a .PointsFromTwips (int64 (*_gabg .HAttr .ST_UnsignedDecimalNumber ));};if _ggdg .HeaderAttr .ST_UnsignedDecimalNumber !=nil {_dbd =_a .PointsFromTwips (int64 (*_ggdg .HeaderAttr .ST_UnsignedDecimalNumber ));};if _ggdg .FooterAttr .ST_UnsignedDecimalNumber !=nil {_ded =_cadf -_a .PointsFromTwips (int64 (*_ggdg .FooterAttr .ST_UnsignedDecimalNumber ));};if d .Settings .X ().DefaultTabStop ==nil {_cfab =_adac (12.7);}else {_cfab =_a .PointsFromTwips (int64 (*d .Settings .X ().DefaultTabStop .ValAttr .ST_UnsignedDecimalNumber ));};_efag :=_gd .New ();_efag .SetPageSize (_gd .PageSize {_cgba ,_bec });_efag .SetPageMargins (_cage ,_gdf ,_gdd ,_cadf );for _ ,_ffee :=range d .Headers (){_ffaf :=&convertContext {_caea :_efag ,_gggc :d ,_gfaf :true ,_bbaa :_cage ,_dfag :_dbd };_ffaf .addRelativeCBCs (_ffee .X ().EG_ContentBlockContent );};for _ ,_faa :=range d .Footers (){_gfe :=&convertContext {_caea :_efag ,_gggc :d ,_edd :true ,_bbaa :_cage ,_cgbdg :_ded };_gfe .addRelativeCBCs (_faa .X ().EG_ContentBlockContent );};_beab :=&convertContext {_caea :_efag ,_gggc :d ,_cceg :&_a .Rectangle {Top :_gdd ,Bottom :_bec -_cadf ,Left :_cage ,Right :_cgba -_gdf },_adg :[]note {}};for _ ,_dgfg :=range d .X ().Body .EG_BlockLevelElts {_beab .addAbsoluteCBCs (_dgfg .EG_ContentBlockContent );};_beab .addEndnotes ();_beab .alignSymbolsVertically ();_beab .drawPages ();return _efag ;};

// RegisterFontsFromDirectory registers all fonts from the given directory automatically detecting font families and styles. For composite fonts use RegisterCompositeFontsFromDirectory.
func RegisterFontsFromDirectory (dirName string )error {return _a .RegisterFontsFromDirectory (dirName )};func (_dfgc *convertContext )currentParagraphOverflowsCurrentPage ()bool {_aae :=_dfgc ._fgcg ._de +_dfgc ._fgcg ._ccc .Top +_dfgc ._fgcg ._ccc .Bottom ;_eaf :=_dfgc ._cagc ._cb .Bottom -_dfgc ._fgcg ._dee ;if len (_dfgc ._cagc ._cc )==0&&len (_dfgc ._fgcg ._db )> 0{_eaf -=_ed ;};return _aae +_dfgc ._fgcg ._ec > _eaf ||_aae +_dfgc ._fgcg ._agc > _eaf ;};func _cgdd (_afad *_ab .CT_Border )(_gd .CellBorderStyle ,*_gd .Color ,float64 ){if _afad ==nil {return _gd .CellBorderStyleNone ,nil ,0;};var _eefad _gd .CellBorderStyle ;switch _afad .ValAttr {case _ab .ST_BorderSingle :_eefad =_gd .CellBorderStyleSingle ;case _ab .ST_BorderDouble :_eefad =_gd .CellBorderStyleDouble ;default:_eefad =_gd .CellBorderStyleNone ;};var _aecgb _gd .Color ;if _bagg :=_afad .ColorAttr ;_bagg !=nil {if _eedf :=_bagg .ST_HexColorRGB ;_eedf !=nil {_aecgb =_gd .ColorRGBFromHex ("\u0023"+*_eedf );};};_bacf :=0.0;if _cfbg :=_afad .SzAttr ;_cfbg !=nil {_bacf =float64 (*_cfbg )/8;};return _eefad ,&_aecgb ,_bacf ;};func _fda (_gca *_ab .CT_PPr ,_acg *_gd .StyledParagraph )(float64 ,float64 ){_bdeg :=1.1;if _gca ==nil {_acg .SetLineHeight (_bdeg );return 0,0;};if _gca .Jc !=nil {var _cddad _gd .TextAlignment ;switch _gca .Jc .ValAttr {case _ab .ST_JcRight :_cddad =_gd .TextAlignmentRight ;case _ab .ST_JcCenter :_cddad =_gd .TextAlignmentCenter ;case _ab .ST_JcBoth :_cddad =_gd .TextAlignmentJustify ;default:_cddad =_gd .TextAlignmentLeft ;};_acg .SetTextAlignment (_cddad );};var _gdba ,_fbg ,_agae ,_abbd float64 ;if _ddgd :=_gca .Spacing ;_ddgd !=nil {if _geab :=_ddgd .BeforeAttr ;_geab !=nil {if _geab .ST_UnsignedDecimalNumber !=nil {_gdba =_a .PointsFromTwips (int64 (*_geab .ST_UnsignedDecimalNumber ));};};if _ecgd :=_ddgd .AfterAttr ;_ecgd !=nil {if _ecgd .ST_UnsignedDecimalNumber !=nil {_fbg =_a .PointsFromTwips (int64 (*_ecgd .ST_UnsignedDecimalNumber ));};};if _aeff :=_ddgd .LineAttr ;_aeff !=nil {if _aeff .Int64 !=nil {_bdeg =float64 (*_aeff .Int64 /240);};};};_acg .SetLineHeight (_bdeg );if _cfcb :=_gca .Ind ;_cfcb !=nil {if _cdbab :=_cfcb .LeftAttr ;_cdbab !=nil {if _cdbab .Int64 !=nil {_agae =_a .PointsFromTwips (*_cdbab .Int64 );};};if _fabb :=_cfcb .RightAttr ;_fabb !=nil {if _fabb .Int64 !=nil {_abbd =_a .PointsFromTwips (*_fabb .Int64 );};};};_acg .SetMargins (_agae ,_abbd ,_gdba -_bdeg /2,_fbg +_bdeg /2);return _gdba ,_agae ;};func _fcfc (_acab int64 ,_gega _ab .ST_NumberFormat )string {_face :=int (_acab );switch _gega {case _ab .ST_NumberFormatDecimal :return _f .Itoa (_face );case _ab .ST_NumberFormatUpperRoman :return _fgfd (_face ,true );case _ab .ST_NumberFormatLowerRoman :return _fgfd (_face ,false );case _ab .ST_NumberFormatUpperLetter :return _dabd (_face ,true );case _ab .ST_NumberFormatLowerLetter :return _dabd (_face ,false );default:return _f .Itoa (_face );};};var _cfab float64 ;func (_ddda *convertContext )makePdfImageFromGraphics (_ffadb *_bc .Pic )(*_gd .Image ,error ){if _gdef :=_ffadb .BlipFill ;_gdef !=nil {if _ddad :=_gdef .Blip ;_ddad !=nil {if _adgb :=_ddad .EmbedAttr ;_adgb !=nil {_dbcbb ,_acff :=_ddda ._gggc .GetImageObjByRelId (*_adgb );if _acff !=nil {return nil ,_acff ;};_agbcg ,_acff :=_b .Open (_dbcbb .Path );if _acff !=nil {return nil ,_acff ;};_ecb ,_acff :=_c .ReadAll (_agbcg );if _acff !=nil {return nil ,_acff ;};_defg ,_acff :=_ddda ._caea .NewImageFromData (_ecb );if _acff !=nil {return nil ,_acff ;};return _defg ,nil ;};};};return nil ,nil ;};func (_gegb *convertContext )addRelativeEGPC (_dgc []*_ab .EG_PContent ,_dbff *_ab .CT_PPr ,_adad *prefix ){if len (_dgc )==0{_gegb ._ggcc .Append ("\u000d");return ;};if _adad !=nil {_gegb ._egag =_adad ;};for _ ,_faff :=range _dgc {for _ ,_cebab :=range _faff .FldSimple {if _cebab !=nil {_gegb .addRelativeEGPC (_cebab .EG_PContent ,_dbff ,_adad );};};if _cafa :=_faff .Hyperlink ;_cafa !=nil {_gegb ._aacb =_cafa ;_gegb .addRelativeCRC (_cafa .EG_ContentRunContent ,_dbff );};_gegb ._aacb =nil ;_gegb .addRelativeCRC (_faff .EG_ContentRunContent ,_dbff );};};func (_eagf *convertContext )makeRunStyle (_fffg *_ab .CT_RPr ,_egda ,_eda ,_ccgfd ,_bfa ,_fagfg bool )(_gd .TextStyle ,bool ,bool ){_bdea :=_eagf ._caea .NewTextStyle ();if _fffg !=nil {_baag :=_a .FontStyle_Regular ;_edde :=_cfbb (_fffg .B );_dbbcf :=_cfbb (_fffg .I );if _edde &&_dbbcf {_baag =_a .FontStyle_BoldItalic ;}else if _edde {_baag =_a .FontStyle_Bold ;}else if _dbbcf {_baag =_a .FontStyle_Italic ;};if _fagfg {_bdea .Underline =true ;_bdea .UnderlineStyle =_gd .TextDecorationLineStyle {Offset :_adac (0.5),Thickness :_adac (1/32)};};if _fffg .U !=nil &&_fffg .U .ValAttr !=_ab .ST_UnderlineNone &&!_bfa {_bdea .Underline =true ;_bdea .UnderlineStyle =_gd .TextDecorationLineStyle {Offset :_adac (0.5),Thickness :_adac (1/32)};if _fdaa :=_fffg .U .ColorAttr ;_fdaa !=nil {if _bggg :=_fdaa .ST_HexColorRGB ;_bggg !=nil {_bdea .UnderlineStyle .Color =_gd .ColorRGBFromHex ("\u0023"+*_bggg );};};};if _bfa {_bdea .Font =_a .AssignStdFontByName (_bdea ,"\u0053\u0079\u006d\u0062\u006f\u006c");}else {_eefaa :="\u0064e\u0066\u0061\u0075\u006c\u0074";if _fga :=_fffg .RFonts ;_fga !=nil {if _dgbe :=_fga .AsciiAttr ;_dgbe !=nil {_eefaa =*_dgbe ;}else if _fbdee :=_fga .HAnsiAttr ;_fbdee !=nil {_eefaa =*_fbdee ;}else {_bgaa :=_eagf ._gggc .Styles .X ().DocDefaults ;if _bgaa .RPrDefault !=nil &&_bgaa .RPrDefault .RPr !=nil {if _gbdc :=_bgaa .RPrDefault .RPr .RFonts ;_gbdc !=nil {if _eabd :=_fga .HintAttr ;_eabd ==_ab .ST_HintEastAsia {if _gbdc .EastAsiaAttr !=nil {_eefaa =*_bgaa .RPrDefault .RPr .RFonts .EastAsiaAttr ;};}else {if _bgfc :=_gbdc .AsciiAttr ;_bgfc !=nil {_eefaa =*_bgfc ;}else if _gabd :=_gbdc .HAnsiAttr ;_gabd !=nil {_eefaa =*_gabd ;};};};};};};if _gggd ,_cdebd :=_a .StdFontsMap [_eefaa ];_cdebd {_bdea .Font =_a .AssignStdFontByName (_bdea ,_gggd [_baag ]);}else if _feda :=_a .GetRegisteredFont (_eefaa ,_baag );_feda !=nil {_bdea .Font =_feda ;}else {_d .Printf ("\u0046\u006f\u006e\u0074\u0020\u0025\u0073\u0020\u0077\u0069\u0074\u0068\u0020\u0073\u0074y\u006c\u0065\u0020\u0025\u0073\u0020\u0069\u0073\u0020\u006e\u006f\u0074\u0020f\u006f\u0075\u006e\u0064\u002c\u0020\u0072\u0065\u0073\u0065\u0074\u0020to\u0020\u0064\u0065\u0066\u0061\u0075\u006c\u0074\u002e\u000a",_eefaa ,_baag );_bdea .Font =_a .AssignStdFontByName (_bdea ,_a .StdFontsMap ["\u0064e\u0066\u0061\u0075\u006c\u0074"][_baag ]);};};var _efga float64 ;_abfd :=_a .DefaultFontSize ;if _aaec :=_fffg .Sz ;_aaec !=nil {_efga =float64 (*_aaec .ValAttr .ST_UnsignedDecimalNumber );}else if _faegc :=_fffg .SzCs ;_faegc !=nil {_efga =float64 (*_faegc .ValAttr .ST_UnsignedDecimalNumber );};if _efga !=0{_abfd =_efga /24*_a .DefaultFontSize ;};if _addf :=_fffg .VertAlign ;_addf !=nil {_efgad :=_addf .ValAttr ;_egda =_efgad ==_gf .ST_VerticalAlignRunSuperscript ;_eda =_efgad ==_gf .ST_VerticalAlignRunSubscript ;};if _abfd > _eagf ._acagc {_eagf ._acagc =_abfd ;};if _egda ||_eda {_abfd *=0.64;};if _ccgfd {if _egda {_bdea .TextRise =1.5;};if _eda {_bdea .TextRise =-1.5;};};_bdea .FontSize =_abfd ;_dgg :=0.0;if _fgfe :=_fffg .Spacing ;_fgfe !=nil {_dgg =_a .PointsFromTwips (*_fgfe .ValAttr .Int64 );};_bdea .CharSpacing =_dgg ;_cfabe :=_gd .ColorBlack ;if _fffg .Color !=nil {_fagfd :=_fffg .Color .ValAttr .ST_HexColorRGB ;if _fagfd !=nil {_cfabe =_gd .ColorRGBFromHex ("\u0023"+*_fagfd );};};if _ccgfd {_gaab ,_fcada ,_dgfd :=_cfabe .ToRGB ();_gaab ,_fcada ,_dgfd =_a .Lighten (_gaab ),_a .Lighten (_fcada ),_a .Lighten (_dgfd );_cfabe =_gd .ColorRGBFromArithmetic (_gaab ,_fcada ,_dgfd );};_bdea .Color =_cfabe ;};return _bdea ,_egda ,_eda ;};var _cdf =map[int32 ]int32 {61623:8226,61607:8226,61558:9830,61656:8594,61692:8730};func _fbf (_eded *_gd .Creator ,_gdb *block ){_gdb ._ff .SetPos (_gdb ._ede ,_gdb ._bdd );_eded .Draw (_gdb ._ff );if _gdb ._egg {_a .DrawRectangle (_eded ,&_a .Rectangle {Top :_gdb ._bdd ,Bottom :_gdb ._bdd +_gdb ._ff .Height (),Left :_gdb ._ede ,Right :_gdb ._ede +_gdb ._ff .Width ()},_gdb ._baf ,_gdb ._fe );};};func (_geg *convertContext )alignParagraph (){_ced :=_geg ._fgcg ;if _ced ._bge ==_gd .TextAlignmentLeft {return ;};_edeb :=len (_ced ._af )-1;for _gag ,_abgc :=range _ced ._af {_fae :=len (_abgc ._acc )-1;for _dfge ,_bbb :=range _abgc ._acc {_edea :=true ;_bad :=len (_bbb ._bcb );_deb :=0.0;for _eef :=len (_bbb ._bcb )-1;_eef >=0;_eef --{_dca :=_bbb ._bcb [_eef ];if _edea &&_dca ._dc {_bad =_eef ;}else {_edea =false ;for _ ,_abgaa :=range _dca ._bb {_deb +=_abgaa ._fca ;};};};_bbb ._bcb =_bbb ._bcb [:_bad ];_ace :=_bbb ._afa -_bbb ._fc -_deb ;switch _ced ._bge {case _gd .TextAlignmentRight :_bbb .moveRight (_ace );case _gd .TextAlignmentCenter :_bbb .moveRight (_ace /2);case _gd .TextAlignmentJustify :if _gag !=_edeb ||_dfge !=_fae {_ffgd :=[]*word {};for _ ,_cgbd :=range _bbb ._bcb {if _cgbd ._dc {_ffgd =append (_ffgd ,_cgbd );};};_ffa :=_ace /float64 (len (_ffgd ));for _ ,_eggd :=range _ffgd {_eggd ._aac +=_ffa ;};var _bdc *word ;for _ ,_ceaf :=range _bbb ._bcb {if _bdc !=nil {_ceaf ._gfb =_bdc ._gfb +_bdc ._aac ;};_bdc =_ceaf ;};};};};};};const (FontStyle_Regular FontStyle =0;FontStyle_Bold FontStyle =1;FontStyle_Italic FontStyle =2;FontStyle_BoldItalic FontStyle =3;);func (_aeecd *convertContext )combinePPrWithStyles (_fcff *_ab .CT_PPr )(*_ab .CT_PPr ,*prefix ){if _fcff ==nil {return nil ,nil ;};var _gdga *prefix ;if _fcff !=nil &&_fcff .NumPr !=nil {if _cecg ,_bgbcb :=_fcff .NumPr .Ilvl ,_fcff .NumPr .NumId ;_cecg !=nil &&_bgbcb !=nil {_dfbf :=_aeecd ._gggc .GetNumberingLevelByIds (_bgbcb .ValAttr ,_cecg .ValAttr ).X ();_fcff =_faea (_fcff ,_dfbf .PPr ,_dfbf .RPr );if _abgca :=_dfbf .NumFmt ;_abgca !=nil {if _ggab :=_abgca .ValAttr ;_ggab ==_ab .ST_NumberFormatBullet ||_ggab ==_ab .ST_NumberFormatDecimal {var _dcb []float64 ;if _fcbb :=_fcff .Tabs ;_fcbb !=nil &&len (_fcbb .Tab )!=0{for _ ,_bfbd :=range _fcbb .Tab {_dcb =append (_dcb ,_a .PointsFromTwips (*_bfbd .PosAttr .Int64 ));};};_gdga =&prefix {_fad :_dcb ,_dffaf :true };if _ggab ==_ab .ST_NumberFormatBullet {if _cbfe :=_dfbf .LvlText ;_cbfe !=nil {if _aaca :=_cbfe .ValAttr ;_aaca !=nil &&*_aaca !=""{_gdga ._aff =*_aaca ;_gdga ._gagb =true ;};};}else {_dfgb ,_cdcf :=_bgbcb .ValAttr ,_cecg .ValAttr ;if _ ,_ebcg :=_aeecd ._ggf [_dfgb ];!_ebcg {_aeecd ._ggf [_dfgb ]=map[int64 ]int {};};if _ ,_feeg :=_aeecd ._ggf [_dfgb ][_cdcf ];!_feeg {_aeecd ._ggf [_dfgb ][_cdcf ]=1;};_gegc :=_aeecd ._ggf [_dfgb ][_cdcf ];_aeecd ._ggf [_dfgb ][_cdcf ]++;_gdga ._aff =_f .Itoa (_gegc )+"\u002e";};};};};};if _fcff !=nil &&_fcff .PStyle !=nil {_gdab :=_aeecd ._gggc .GetStyleByID (_fcff .PStyle .ValAttr );if _aeca :=_gdab .X ();_aeca !=nil {_fcff =_faea (_fcff ,_aeca .PPr ,_aeca .RPr );};};return _fcff ,_gdga ;};func (_eff *convertContext )addRelativeCBCs (_fbae []*_ab .EG_ContentBlockContent ){for _ ,_debc :=range _fbae {_eff .addHdrFtr (_debc .P );};};type tableWrapper struct{_ee *_gd .Table ;_egd float64 ;};func (_fdf *convertContext )drawPages (){for _ ,_gfa :=range _fdf ._bddb {_fdf ._caea .NewPage ();_fdf .drawPage (_gfa );};};func (_dga *convertContext )addCurrentParagraphToCurrentPage (){_dga ._cagc ._cf =_dga ._fgcg ._de +_dga ._fgcg ._ccc .Top +_dga ._fgcg ._ec +_dga ._fgcg ._ccc .Bottom ;_dga ._cagc ._cga =append (_dga ._cagc ._cga ,_dga ._fgcg ._agg ...);_dga ._cagc ._eg =append (_dga ._cagc ._eg ,_dga ._fgcg ._bd ...);_dga ._cagc ._dfg =append (_dga ._cagc ._dfg ,_dga ._fgcg ._da ...);_dga ._cagc ._cbf =append (_dga ._cagc ._cbf ,_dga ._fgcg ._dac ...);_dga ._cagc ._dfc =append (_dga ._cagc ._dfc ,_dga ._fgcg ._acb ...);_dga ._cagc ._bca =append (_dga ._cagc ._bca ,_dga ._fgcg );_dga .adjustRightBoundOfLastSpan ();_dga .alignParagraph ();if len (_dga ._cagc ._cc )==0&&len (_dga ._fgcg ._db )> 0{_dga ._cagc ._cb .Bottom -=_ed ;};_dga ._cagc ._cc =append (_dga ._cagc ._cc ,_dga ._fgcg ._db ...);_dga ._cagc ._cb .Bottom -=_dga ._fgcg ._dee ;};type block struct{_ff *_gd .Block ;_ede float64 ;_bdd float64 ;_egg bool ;_baf float64 ;_fe _gd .Color ;};

// FontStyle represents a kind of font styling. It can be FontStyle_Regular, FontStyle_Bold, FontStyle_Italic and FontStyle_BoldItalic.
type FontStyle =_a .FontStyle ;func _dae (_cgfgd *_ab .EG_RunInnerContent )bool {if _dbfg :=_cgfgd .Br ;_dbfg !=nil {return _dbfg .TypeAttr ==_ab .ST_BrTypePage ;};return false ;};type page struct{_cb *_a .Rectangle ;_bca []*paragraph ;_cf float64 ;_dfc []*zoneToSkip ;_cga []*_gd .Image ;_eg []*_gd .Image ;_dfg []*block ;_cbf []*block ;_cc []*note ;_ga bool ;};func (_gddc *convertContext )makePdfBlockFromCBCs (_bagd [][]*_ab .EG_ContentBlockContent ,_fegg ,_gcd float64 ,_bgbb *_a .Rectangle ,_bgbbc bool ,_ddaa *prefix )(*_gd .Block ,error ){if _bgbb ==nil {_bgbb =&_a .Rectangle {};};_bef :=&_a .Rectangle {Top :_bgbb .Top ,Bottom :_gcd -_bgbb .Bottom ,Left :_bgbb .Left ,Right :_fegg -_bgbb .Right };_eecg :=_a .MakeTempCreator (_fegg ,_gcd );_bbdd :=&convertContext {_caea :_eecg ,_gggc :_gddc ._gggc ,_cceg :_bef ,_egag :_ddaa };for _ ,_bgd :=range _bagd {_bbdd .addAbsoluteCBCs (_bgd );};if _bgbbc {_aaaa :=0.0;for _ ,_gdae :=range _bbdd ._bddb {for _ ,_eefg :=range _gdae ._bca {_aaaa +=(_eefg ._ec +_eefg ._ccc .Top +_eefg ._ccc .Bottom );};};_bef .Bottom =_aaaa -_bgbb .Bottom ;_eecg =_a .MakeTempCreator (_fegg ,_aaaa );_bbdd =&convertContext {_caea :_eecg ,_gggc :_gddc ._gggc ,_cceg :_bef ,_egag :_ddaa };for _ ,_gbdf :=range _bagd {_bbdd .addAbsoluteCBCs (_gbdf );};};_bbdd .alignSymbolsVertically ();_bbdd .drawPage (_bbdd ._bddb [0]);return _a .MakeBlockFromCreator (_eecg );};func _gadb (_gee ,_ffga string ,_cbb ,_bcc bool )[]*symbol {_gggg :=[]*symbol {};for _ ,_ffdc :=range _gee {_gfdd :=&symbol {_ege :string (_ffdc ),_bfb :_cbb ,_dcd :_bcc ,_fb :_ffga };_gggg =append (_gggg ,_gfdd );};return _gggg ;};func (_dcf *convertContext )addEmptyLine (){_dcf .addTextSymbol (&symbol {_ege :"\u000d",_fca :0})};func (_edebd *convertContext )newLine (){_fbfc :=0.0;if _edebd ._fgcg ==nil {_edebd .newParagraph ();};_fbfc =_edebd ._fgcg ._ec +_edebd ._fgcg ._ccc .Top ;_gaa :=&line {};if len (_edebd ._fgcg ._af )==0{_gaa ._ad =_edebd ._fgcg ._aad ;}else {_gaa ._ad =_edebd ._fgcg ._fd ;};_gaa ._dd =_edebd ._fgcg ._dfee ;_gaa ._bf =_gaa ._ad ;_gaa ._fa =_fbfc ;_edebd ._fgcg ._af =append (_edebd ._fgcg ._af ,_gaa );_edebd ._efeb =_gaa ;_edebd .newSpan ();};func (_gbd *convertContext )makePdfBlockFromChart (_geda *_df .Chart ,_ccgf ,_cdg float64 )(*_gd .Block ,error ){_bdg :=_geda .CT_RelId .IdAttr ;_abf :=_gbd ._gggc .GetChartSpaceByRelId (_bdg );if _abf ==nil {return nil ,_fg .New ("\u004e\u006f\u0020\u0063\u0068\u0061\u0072\u0074\u0073\u0070\u0061\u0063\u0065");};var _ccd *_cd .Theme ;_caf :=_gbd ._gggc .Themes ();if len (_caf )> 0{_ccd =_caf [0];};return _a .MakeBlockFromChartSpace (_abf ,_ccgf ,_cdg ,_ccd );};func _aafg (_aag *_ab .CT_PPr ,_gecf *paragraph )(float64 ,float64 ){_gdcc :=1.1;if _aag ==nil {_gecf ._ac =_gdcc ;return 0,0;};if _aag .Jc !=nil {switch _aag .Jc .ValAttr {case _ab .ST_JcRight :_gecf ._bge =_gd .TextAlignmentRight ;case _ab .ST_JcCenter :_gecf ._bge =_gd .TextAlignmentCenter ;case _ab .ST_JcBoth :_gecf ._bge =_gd .TextAlignmentJustify ;default:_gecf ._bge =_gd .TextAlignmentLeft ;};};var _fcea ,_ceba ,_cdba ,_beb ,_ebdb float64 ;if _dgfc :=_aag .Spacing ;_dgfc !=nil {if _eeda :=_dgfc .BeforeAttr ;_eeda !=nil {if _eeda .ST_UnsignedDecimalNumber !=nil {_fcea =_a .PointsFromTwips (int64 (*_eeda .ST_UnsignedDecimalNumber ));};};if _cebg :=_dgfc .AfterAttr ;_cebg !=nil {if _cebg .ST_UnsignedDecimalNumber !=nil {_ceba =_a .PointsFromTwips (int64 (*_cebg .ST_UnsignedDecimalNumber ));};};if _ggc :=_dgfc .LineAttr ;_ggc !=nil {if _ggc .Int64 !=nil &&*_ggc .Int64 !=0{_gdcc =float64 (*_ggc .Int64 /240);};};};_gecf ._ac =_gdcc ;if _bdcg :=_aag .Ind ;_bdcg !=nil {if _bcda :=_bdcg .FirstLineAttr ;_bcda !=nil {if _bcda .ST_UnsignedDecimalNumber !=nil {_ebdb =_a .PointsFromTwips (int64 (*_bcda .ST_UnsignedDecimalNumber ));};};if _bbff :=_bdcg .HangingAttr ;_bbff !=nil {if _bbff .ST_UnsignedDecimalNumber !=nil {_ebdb -=_a .PointsFromTwips (int64 (*_bbff .ST_UnsignedDecimalNumber ));};};if _fdg :=_bdcg .LeftAttr ;_fdg !=nil {if _fdg .Int64 !=nil {_cdba =_a .PointsFromTwips (*_fdg .Int64 );};};if _fgef :=_bdcg .RightAttr ;_fgef !=nil {if _fgef .Int64 !=nil {_beb =_a .PointsFromTwips (*_fgef .Int64 );};};};_gecf ._ccc =&_a .Rectangle {Top :_fcea ,Bottom :_ceba ,Left :_cdba ,Right :_beb };_gecf ._aa =_ebdb ;return _fcea ,_cdba ;};func (_cge *convertContext )determineParagraphBounds (){_cge ._fgcg ._fd =_cge ._cagc ._cb .Left +_cge ._fgcg ._ccc .Left ;_cge ._fgcg ._aad =_cge ._fgcg ._fd +_cge ._fgcg ._aa ;_cge ._fgcg ._dfee =_cge ._cagc ._cb .Right -_cge ._fgcg ._ccc .Right ;};func _faea (_bgeb *_ab .CT_PPr ,_ffad *_ab .CT_PPrGeneral ,_decd *_ab .CT_RPr )*_ab .CT_PPr {if _ffad !=nil {if _bgeb .Jc ==nil &&_ffad .Jc !=nil {_bgeb .Jc =_ffad .Jc ;};if _bgeb .Spacing ==nil &&_ffad .Spacing !=nil {_bgeb .Spacing =_ffad .Spacing ;};if _ffad .Ind !=nil {if _bgeb .Ind ==nil {_bgeb .Ind =_ffad .Ind ;}else {_aecgd ,_fbcf :=_bgeb .Ind .FirstLineAttr ==nil ,_bgeb .Ind .HangingAttr ==nil ;if _aecgd &&_fbcf &&_ffad .Ind .FirstLineAttr !=nil {_bgeb .Ind .FirstLineAttr =_ffad .Ind .FirstLineAttr ;_aecgd =false ;};if _aecgd &&_fbcf &&_ffad .Ind .HangingAttr !=nil {_bgeb .Ind .HangingAttr =_ffad .Ind .HangingAttr ;};if _bgeb .Ind .LeftAttr ==nil {_bgeb .Ind .LeftAttr =_ffad .Ind .LeftAttr ;};if _bgeb .Ind .RightAttr ==nil {_bgeb .Ind .RightAttr =_ffad .Ind .RightAttr ;};};};if _bgeb .Tabs ==nil &&_ffad .Tabs !=nil {_bgeb .Tabs =_ffad .Tabs ;};};if _decd !=nil {var _gegf _ab .CT_ParaRPr ;if _bgeb .RPr ==nil {_gegf =*_ab .NewCT_ParaRPr ();}else {_gegf =*_bgeb .RPr ;};if _gegf .Color ==nil &&_decd .Color !=nil {_gegf .Color =_decd .Color ;};if _gegf .Spacing ==nil &&_decd .Spacing !=nil {_gegf .Spacing =_decd .Spacing ;};if _gegf .Sz ==nil &&_decd .Sz !=nil {_gegf .Sz =_decd .Sz ;};if _gegf .SzCs ==nil &&_decd .SzCs !=nil {_gegf .SzCs =_decd .SzCs ;};if _gegf .B ==nil &&_decd .B !=nil {_gegf .B =_decd .B ;};if _gegf .I ==nil &&_decd .I !=nil {_gegf .I =_decd .I ;};if _gegf .RFonts ==nil &&_decd .RFonts !=nil {_gegf .RFonts =_decd .RFonts ;};if _gegf .VertAlign ==nil &&_decd .VertAlign !=nil {_gegf .VertAlign =_decd .VertAlign ;};_bgeb .RPr =&_gegf ;};return _bgeb ;};func _fgfd (_faeg int ,_fcca bool )string {_fbde :=_gc .NewBuffer ([]byte {});for _ ,_ggaa :=range _aaae {for {if _faeg < _ggaa ._gcg {break ;};_fbde .WriteString (_ggaa ._cffa );_faeg -=_ggaa ._gcg ;};};_gece :=_fbde .String ();if _fcca {_gece =_ge .ToUpper (_gece );};return _gece ;};func (_ceb *convertContext )newWord (){_ceb ._fefeb =&word {_dc :true ,_gfb :_ceb ._efeb ._bf }};func _cbac (_bda *_e .Document ,_bffb *_ab .CT_TblPr )*_ab .CT_TblPr {if _bffb ==nil {_bffb =_ab .NewCT_TblPr ();};if _bffb .TblStyle !=nil {_edbad :=_bda .GetStyleByID (_bffb .TblStyle .ValAttr );if _abcf :=_edbad .X ();_abcf !=nil {if _fcg :=_abcf .TblPr ;_fcg !=nil {_bgcf :=_bffb .TblBorders ;_gff :=_fcg .TblBorders ;if _bgcf ==nil {_bgcf =_gff ;}else {if _bgcf .Top ==nil {_bgcf .Top =_gff .Top ;};if _bgcf .Bottom ==nil {_bgcf .Bottom =_gff .Bottom ;};if _bgcf .Left ==nil {_bgcf .Left =_gff .Left ;};if _bgcf .Right ==nil {_bgcf .Right =_gff .Right ;};if _bgcf .InsideH ==nil {_bgcf .InsideH =_gff .InsideH ;};if _bgcf .InsideV ==nil {_bgcf .InsideV =_gff .InsideV ;};};_cfeg :=_bffb .Shd ;_gcdg :=_fcg .Shd ;if _cfeg ==nil {_cfeg =_gcdg ;}else {if _gcdg !=nil &&_cfeg .FillAttr ==nil {_cfeg .FillAttr =_gcdg .FillAttr ;};};_gce :=_bffb .TblCellMar ;_ddfc :=_fcg .TblCellMar ;if _gce ==nil {_gce =_ddfc ;}else {if _ddfc !=nil &&_gce .Left ==nil {_gce .Left =_ddfc .Left ;};};if _bffb .TblInd ==nil {_bffb .TblInd =_fcg .TblInd ;};if _bffb .Jc ==nil {_bffb .Jc =_fcg .Jc ;};};};};return _bffb ;};func _febg (_dgcg ,_fdac *_ab .CT_Border ,_gcfg bool )*_ab .CT_Border {if _gcfg {return _dgcg ;};return _fdac ;};func (_acd *convertContext )alignSymbolsVertically (){for _ ,_dbb :=range _acd ._bddb {for _ ,_bcd :=range _dbb ._bca {for _ ,_feg :=range _bcd ._af {_dacd :=0.0;for _ ,_gac :=range _feg ._acc {for _ ,_cce :=range _gac ._bcb {for _ ,_ffb :=range _cce ._bb {if _ffb ._geb > _dacd {_dacd =_ffb ._geb ;};};};};for _ ,_fgb :=range _feg ._acc {for _ ,_ade :=range _fgb ._bcb {for _ ,_cfc :=range _ade ._bb {if _cfc ._geb < _dacd {_cfc ._egf =_dacd -_cfc ._geb ;};};};};};};};};func (_gdbg *convertContext )addParagraphs (_ada []*_ab .CT_P ){for _ ,_ce :=range _ada {_fbe ,_cac :=_gdbg .combinePPrWithStyles (_ce .PPr );if _gdbg .addAbsoluteEGPC (_ce .EG_PContent ,_fbe ,_cac ){_gdbg .newPage ();continue ;};if _gdbg .currentParagraphOverflowsCurrentPage (){_gdbg .newPage ();_gdbg .addAbsoluteEGPC (_ce .EG_PContent ,_fbe ,_cac );};_gdbg .addCurrentParagraphToCurrentPage ();};};type romanMatch struct{_gcg int ;_cffa string ;};func _cfbb (_babf *_ab .CT_OnOff )bool {if _babf !=nil {if _fdba :=_babf .ValAttr ;_fdba !=nil {if _fdbc :=_fdba .Bool ;_fdbc !=nil {return *_fdbc ;};return _fdba .ST_OnOff1 ==_gf .ST_OnOff1On ;};return true ;};return false ;};func (_dg *span )moveRight (_gec float64 ){for _ ,_agf :=range _dg ._bcb {_agf ._gfb +=_gec ;};};func (_dcad *convertContext )addAbsoluteRIC (_egb *_ab .EG_RunInnerContent ,_bfdf *_ab .CT_RPr )bool {var _edbf ,_cgef bool ;_eac :=[]*symbol {};_gfdg :=false ;if _egb ==nil {if _dcad ._egag !=nil {for _ ,_cacd :=range _dcad ._egag ._aff {if _eccaf ,_edbc :=_cdf [_cacd ];_edbc {_cgef =_dcad ._egag ._gagb ;_dcad ._egag ._aff =string (rune (_eccaf ));};};_eac =_gadb (_dcad ._egag ._aff ,"",true ,false );};}else {if _dae (_egb ){return true ;}else if _egb .T !=nil &&_egb .T .Content !=""{_fega :=_egb .T .Content ;if _caa :=_dcad ._aacb ;_caa !=nil &&_caa .IdAttr !=nil {_gfdg =true ;_eac =_gadb (_fega ,_dcad ._gggc .GetTargetByRelId (*_caa .IdAttr ),false ,false );}else {_eac =_gadb (_fega ,"",false ,false );};}else if _ebcf :=_egb .EndnoteReference ;_ebcf !=nil {_afd :=_dcad ._gggc .BodySection ().X ();_bcde :=_ebcf .IdAttr ;_fed :=_bcde ;_eea :=_ab .ST_NumberFormatLowerRoman ;if _efe :=_afd .EndnotePr ;_efe !=nil {if _baad :=_efe .NumFmt ;_baad !=nil {_eea =_baad .ValAttr ;};if _bgf :=_efe .NumStart ;_bgf !=nil {_fed +=_bgf .ValAttr -1;};};_dcag :=_fcfc (_fed ,_eea );_ddac :=_dcad ._gggc .Endnote (_bcde ).X ();if _ddac !=nil {_dcad ._adg =append (_dcad ._adg ,note {_gg :_dcag ,_ag :_ddac .EG_BlockLevelElts });_eac =_gadb (_dcag ,"",true ,false );};}else if _accb :=_egb .FootnoteReference ;_accb !=nil {_bafe :=_dcad ._gggc .BodySection ().X ();_edc :=_accb .IdAttr ;_efa :=_edc ;_gged :=_ab .ST_NumberFormatDecimal ;if _ecg :=_bafe .FootnotePr ;_ecg !=nil {if _aef :=_ecg .NumFmt ;_aef !=nil {_gged =_aef .ValAttr ;};if _fef :=_ecg .NumStart ;_fef !=nil {_efa +=_fef .ValAttr -1;};};_dbbb :=_fcfc (_efa ,_gged );_ffe :=_dcad ._gggc .Footnote (_edc ).X ();if _ffe !=nil {_aca :=&note {_gg :_dbbb ,_ag :_ffe .EG_BlockLevelElts };_bac :=[][]*_ab .EG_ContentBlockContent {};for _ ,_fgc :=range _ffe .EG_BlockLevelElts {_bac =append (_bac ,_fgc .EG_ContentBlockContent );};_daccb :=&prefix {_aff :_dbbb };_gfc ,_cca :=_dcad .makePdfBlockFromCBCs (_bac ,_dcad ._cagc ._cb .Right -_dcad ._cagc ._cb .Left ,_adac (1000),nil ,true ,_daccb );if _cca !=nil {_d .Println ("\u0043a\u006e\u006e\u006f\u0074\u0020\u0063\u006f\u006e\u0076\u0065\u0072t\u0020\u0066\u006f\u006f\u0074\u006e\u006f\u0074\u0065\u003a",_cca );return false ;};_aca ._ba =_gfc ;_dcad ._fgcg ._db =append (_dcad ._fgcg ._db ,_aca );_dcad ._fgcg ._dee +=_aca ._ba .Height ();_eac =_gadb (_dbbb ,"",true ,false );};}else if _eefb :=_egb .Drawing ;_eefb !=nil {for _ ,_gfcc :=range _eefb .Inline {if _acad :=_gfcc .Graphic ;_acad !=nil {if _bdbf :=_acad .GraphicData ;_bdbf !=nil {_bce :=_gfcc .Extent ;if _bce ==nil {return false ;};_dcc :=_ca .FromEMU (_bce .CxAttr );_dfb :=_ca .FromEMU (_bce .CyAttr );for _ ,_dgb :=range _bdbf .Any {if _acbg ,_fgd :=_dgb .(*_bc .Pic );_fgd {_aefe :=&symbol {_geb :_dfb ,_fca :_dcc };_agdg ,_cff :=_dcad .makePdfImageFromGraphics (_acbg );if _cff !=nil {_d .Println ("\u0043a\u006en\u006f\u0074\u0020\u0072\u0065a\u0064\u0020i\u006d\u0061\u0067\u0065\u003a",_cff );};if _agdg ==nil {_aefe ._ege ="\u0020";}else {_agdg .Scale (_dcc /_agdg .Width (),_dfb /_agdg .Height ());_aefe ._bcf =_agdg ;_edbf =true ;};_eac =[]*symbol {_aefe };}else if _cdcc ,_abad :=_dgb .(*_df .Chart );_abad {_adf :=&symbol {_geb :_dfb ,_fca :_dcc };_daf ,_bbe :=_dcad .makePdfBlockFromChart (_cdcc ,_dfb ,_dcc );if _bbe !=nil {_d .Println ("\u0043a\u006en\u006f\u0074\u0020\u0072\u0065a\u0064\u0020b\u006c\u006f\u0063\u006b\u003a",_bbe );};if _daf ==nil {_adf ._ege ="\u0020";}else {_adf ._cgd =&block {_ff :_daf };_edbf =true ;};_eac =[]*symbol {_adf };};};};};};};};var _aecg _gd .TextStyle ;var _dab ,_fgce bool ;if !_edbf {_aecg ,_dab ,_fgce =_dcad .makeRunStyle (_bfdf ,false ,false ,false ,_cgef ,_gfdg );};for _ ,_ffeb :=range _eac {if _ffeb ._bcf !=nil ||_ffeb ._cgd !=nil {_dcad .addInlineSymbol (_ffeb );}else {_ffeb ._ggd =&_aecg ;_ffeb ._bfb =_dab ;_ffeb ._dcd =_fgce ;_dcad .addTextSymbol (_ffeb );};};if _dcad ._egag !=nil &&_dcad ._egag ._dffaf {var _gda ,_gdg float64 ;for _ ,_dgf :=range _eac {_gda +=_dgf ._fca ;};_fcb :=0;_fbd :=_dcad ._cagc ._cb .Left ;_ccef :=len (_dcad ._egag ._fad );_gef :=_dcad ._fgcg ._aa < _gda ;_afbc :=_dcad ._efeb ._ad +_gda ;for {var _edff float64 ;if _gef ||_fcb >=_ccef {_edff =_cfab ;}else {_edff =_dcad ._egag ._fad [_fcb ];_fcb ++;};_fbd +=_edff ;if _fbd > _afbc {_gdg =_fbd -_afbc ;break ;};};_dcad .addTextSymbol (&symbol {_ege :"\u0020",_fca :_gdg });};return false ;};