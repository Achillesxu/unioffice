//
// Copyright 2020 FoxyUtils ehf. All rights reserved.
//
// This is a commercial product and requires a license to operate.
// A trial license can be obtained at https://unidoc.io
//
// DO NOT EDIT: generated by unitwist Go source code obfuscator.
//
// Use of this source code is governed by the UniDoc End User License Agreement
// terms that can be accessed at https://unidoc.io/eula/

package convertutils ;import (_db "bytes";_gg "errors";_f "fmt";_gf "github.com/unidoc/unioffice/common/logger";_fc "github.com/unidoc/unioffice/measurement";_c "github.com/unidoc/unioffice/schema/soo/dml";_bd "github.com/unidoc/unioffice/schema/soo/dml/chart";_be "github.com/unidoc/unioffice/spreadsheet/format";_ag "github.com/unidoc/unipdf/v3/creator";_ee "github.com/unidoc/unipdf/v3/model";_fe "github.com/unidoc/unipdf/v3/render";_ea "github.com/unidoc/unitype";_fb "image";_d "math";_dd "os";_bb "sort";_b "strconv";_g "strings";_a "sync";_dc "unicode";);var _ffc =_gbedg (7.5);func _cab (_bggc *_bd .ChartSpace ,_dae ,_aeg float64 ,_bba *_c .Theme ,_bbb bool )(*_ag .Creator ,error ){_gad :=1.0;if _bbb {_gad =8.0;};_cfg :=&Rectangle {};_gdb :=&Rectangle {Top :_cfg .Top ,Bottom :_aeg -_cfg .Bottom ,Left :_cfg .Left ,Right :_dae -_cfg .Right };_efbc :=MakeTempCreator (_dae *_gad +1,_aeg *_gad +1);_gde :=&creatorContext {_abe :_efbc ,_cbba :_bba ,_eegc :_gad };var _bgfd bool ;if _gbd :=_bggc .Chart ;_gbd !=nil {_af :=_gbd .PlotArea ;if _af ==nil {return nil ,_gg .New ("\u004e\u006f\u0020p\u006c\u006f\u0074\u0020\u0061\u0072\u0065\u0061");};_ddd :=&Rectangle {Top :_gbedg (10),Bottom :_gdb .Bottom -_gbedg (15),Left :_gbedg (10),Right :_gdb .Right -_gbedg (10)};var _adb *Rectangle ;_gcd :=_gbd .Legend ;if _gcd !=nil {_cgbc :=_gcd .Overlay !=nil &&_gcd .Overlay .ValAttr !=nil &&*_gcd .Overlay .ValAttr ;if _abf :=_gcd .LegendPos ;_abf !=nil {switch _abf .ValAttr {case _bd .ST_LegendPosTr :if !_cgbc {_ddd =&Rectangle {Top :_gbedg (25),Bottom :_gdb .Bottom -_gbedg (10),Left :_gbedg (10),Right :_gdb .Right -_gbedg (25)};};_adb =&Rectangle {Top :_gbedg (2.5),Bottom :_gbedg (22.5),Left :_gdb .Right -_gbedg (22.5),Right :_gdb .Right -_gbedg (2.5)};case _bd .ST_LegendPosT :_adb =&Rectangle {Top :_gbedg (2.5),Bottom :_gbedg (7.5),Left :(_gdb .Right -_gdb .Left )*0.25,Right :(_gdb .Right -_gdb .Left )*0.75};if !_cgbc {_ddd =&Rectangle {Top :_gbedg (12.5),Bottom :_gdb .Bottom -_gbedg (15),Left :_gbedg (10),Right :_gdb .Right -_gbedg (5)};};_bgfd =true ;case _bd .ST_LegendPosB :_adb =&Rectangle {Top :_gdb .Bottom -_gbedg (7.5),Bottom :_gdb .Bottom -_gbedg (2.5),Left :(_gdb .Right -_gdb .Left )*0.25,Right :(_gdb .Right -_gdb .Left )*0.75};if !_cgbc {_ddd =&Rectangle {Top :_gbedg (5),Bottom :_gdb .Bottom -_gbedg (15),Left :_gbedg (10),Right :_gdb .Right -_gbedg (5)};};_bgfd =true ;case _bd .ST_LegendPosR :_adb =&Rectangle {Top :(_gdb .Bottom -_gdb .Top )/2-_gbedg (10),Bottom :(_gdb .Bottom -_gdb .Top )/2+_gbedg (10),Left :_gdb .Right -_gbedg (22.5),Right :_gdb .Right -_gbedg (2.5)};if !_cgbc {_ddd =&Rectangle {Top :_gbedg (5),Bottom :_gdb .Bottom -_gbedg (12.5),Left :_gbedg (10),Right :_gdb .Right -_gbedg (25)};};case _bd .ST_LegendPosL :_adb =&Rectangle {Top :(_gdb .Bottom -_gdb .Top )/2-_gbedg (10),Bottom :(_gdb .Bottom -_gdb .Top )/2+_gbedg (10),Left :_gbedg (2.5),Right :_gbedg (22.5)};if !_cgbc {_ddd =&Rectangle {Top :_gbedg (5),Bottom :_gdb .Bottom -_gbedg (12.5),Left :_gbedg (30),Right :_gdb .Right -_gbedg (5)};};default:_adb =&Rectangle {Top :(_gdb .Bottom -_gdb .Top )/2-_gbedg (10),Bottom :(_gdb .Bottom -_gdb .Top )/2+_gbedg (10),Left :_gdb .Right -_gbedg (25),Right :_gdb .Right -_gbedg (5)};if !_cgbc {_ddd =&Rectangle {Top :_gbedg (5),Bottom :_gdb .Bottom -_gbedg (12.5),Left :_gbedg (100),Right :_gdb .Right -_gbedg (25)};};};};};_ddd .scale (_gad );_gde .drawBorderWithProps (_af .SpPr ,_ddd ,_cafb );_dfa :=[]*legendItem {};var _agb error ;_caa :=_af .CChoice ;for _ ,_ggc :=range _af .Choice {if _gac :=_ggc .BarChart ;_gac !=nil {_dfa ,_agb =_gde .drawBarChart (_gac ,_ddd ,_caa );if _agb !=nil {return nil ,_agb ;};};};if _gcd !=nil {_adb .scale (_gad );_gde .drawBorderWithProps (_gcd .SpPr ,_adb ,_cafb );if len (_dfa )!=0{_gde .drawLegend (_adb ,_dfa ,_bgfd );};};};_gdb .scale (_gad );_gde .drawBorderWithProps (_bggc .SpPr ,_gdb ,_cafb );return _efbc ,nil ;};func Lighten (clr float64 )float64 {return 0.6+0.4*clr };func (_acc *creatorContext )drawLineWithProps (_cbbf *_c .CT_ShapeProperties ,_bddc ,_beeg ,_babb ,_dac float64 ,_aad bool ){if _cbbf !=nil {if _ded :=_cbbf .Ln ;_ded !=nil {_efab :=_acc .getPdfColorFromSolidFill (_ded .SolidFill );if _efab ==nil &&_aad {_efab =_ag .ColorBlack ;};if _efab !=nil {var _bdga float64 ;if _cegd :=_ded .WAttr ;_cegd !=nil {_bdga =_fc .FromEMU (int64 (*_cegd ));}else {_bdga =_cafb ;};DrawLine (_acc ._abe ,_bddc ,_beeg ,_babb ,_dac ,_bdga ,_efab );};};};};func _bcc (_dgga *_bd .CT_SerAx )(uint32 ,_bd .ST_AxPos ,_bd .ST_TickMark ,_bd .ST_TickLblPos ,*_bd .CT_ChartLines ,uint32 ,*_c .CT_ShapeProperties ,error ){var _cgd ,_bbea uint32 ;var _bfff _bd .ST_AxPos ;var _gccc _bd .ST_TickMark ;var _egab *_bd .CT_ChartLines ;var _ecf _bd .ST_TickLblPos ;if _dgga .AxId ==nil {return _cgd ,_bfff ,_gccc ,_ecf ,_egab ,_bbea ,_dgga .SpPr ,_gg .New ("\u004e\u006f\u0020x\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");}else {_cgd =_dgga .AxId .ValAttr ;};if _dgga .AxPos ==nil {return _cgd ,_bfff ,_gccc ,_ecf ,_egab ,_bbea ,_dgga .SpPr ,_gg .New ("\u004eo\u0020x\u0020\u0061\u0078\u0069\u0073 \u0070\u006fs\u0069\u0074\u0069\u006f\u006e");}else {_bfff =_dgga .AxPos .ValAttr ;};if _dgga .MajorTickMark !=nil {_gccc =_dgga .MajorTickMark .ValAttr ;};if _dgga .TickLblPos !=nil {_ecf =_dgga .TickLblPos .ValAttr ;};if _dgga .CrossAx ==nil {return _cgd ,_bfff ,_gccc ,_ecf ,_egab ,_bbea ,_dgga .SpPr ,_gg .New ("\u004e\u006f \u0063\u0072\u006fs\u0073\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");}else {_bbea =_dgga .CrossAx .ValAttr ;};_egab =_dgga .MajorGridlines ;return _cgd ,_bfff ,_gccc ,_ecf ,_egab ,_bbea ,_dgga .SpPr ,nil ;};func _cca (_bgcd ,_bcge ,_ebcg float64 )float64 {if _bgcd *6< 1{return _ebcg +(_bcge -_ebcg )*6*_bgcd ;}else if _bgcd *2< 1{return _bcge ;}else if _bgcd *3< 2{return _ebcg +(_bcge -_ebcg )*(2.0/3.0-_bgcd )*6;}else {return _ebcg ;};};func _aba (_fae *_bd .CT_CatAx )(uint32 ,_bd .ST_AxPos ,_bd .ST_TickMark ,_bd .ST_TickLblPos ,*_bd .CT_ChartLines ,uint32 ,*_c .CT_ShapeProperties ,error ){var _deec ,_efa uint32 ;var _dcb _bd .ST_AxPos ;var _abfd _bd .ST_TickMark ;var _addf *_bd .CT_ChartLines ;var _gbg _bd .ST_TickLblPos ;if _fae .AxId ==nil {return _deec ,_dcb ,_abfd ,_gbg ,_addf ,_efa ,_fae .SpPr ,_gg .New ("\u004e\u006f\u0020x\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");}else {_deec =_fae .AxId .ValAttr ;};if _fae .AxPos ==nil {return _deec ,_dcb ,_abfd ,_gbg ,_addf ,_efa ,_fae .SpPr ,_gg .New ("\u004eo\u0020x\u0020\u0061\u0078\u0069\u0073 \u0070\u006fs\u0069\u0074\u0069\u006f\u006e");}else {_dcb =_fae .AxPos .ValAttr ;};if _fae .MajorTickMark !=nil {_abfd =_fae .MajorTickMark .ValAttr ;};if _fae .TickLblPos !=nil {_gbg =_fae .TickLblPos .ValAttr ;};if _fae .CrossAx ==nil {return _deec ,_dcb ,_abfd ,_gbg ,_addf ,_efa ,_fae .SpPr ,_gg .New ("\u004e\u006f \u0063\u0072\u006fs\u0073\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");}else {_efa =_fae .CrossAx .ValAttr ;};_addf =_fae .MajorGridlines ;return _deec ,_dcb ,_abfd ,_gbg ,_addf ,_efa ,_fae .SpPr ,nil ;};func _acg (_fdac ,_ceg ,_ccgb float64 )(uint8 ,uint8 ,uint8 ){var _afec float64 ;if _ccgb < 0.5{_afec =_ccgb *(1+_ceg );}else {_afec =_ccgb +_ceg -_ccgb *_ceg ;};_ecb :=_ccgb *2-_afec ;_fdac /=360.0;_bda :=_bdgg (_fdac +1.0/3.0);_gfa :=_bdgg (_fdac );_cgfg :=_bdgg (_fdac -1.0/3.0);_fab :=_cca (_bda ,_afec ,_ecb );_gdeg :=_cca (_gfa ,_afec ,_ecb );_befa :=_cca (_cgfg ,_afec ,_ecb );return uint8 (255*_fab ),uint8 (255*_gdeg ),uint8 (255*_befa );};var _ddf =_gbedg (2);type Rectangle struct{Top float64 ;Bottom float64 ;Left float64 ;Right float64 ;};var _fga =_gbedg (1.5);func AdjustColorByLumMod (colorStr string ,lum float64 )string {var _gdc ,_cbfe ,_aecg uint8 ;_daf ,_ :=_f .Sscanf (colorStr ,"\u0025\u0030\u0032x\u0025\u0030\u0032\u0078\u0025\u0030\u0032\u0078",&_gdc ,&_cbfe ,&_aecg );if _daf !=3{return "";};_edbg ,_eegd ,_cbef :=_gdf (_gdc ,_cbfe ,_aecg );_cbef =lum *_cbef ;_gdc ,_cbfe ,_aecg =_acg (_edbg ,_eegd ,_cbef );return _f .Sprintf ("\u0025\u0030\u0032x\u0025\u0030\u0032\u0078\u0025\u0030\u0032\u0078",_gdc ,_cbfe ,_aecg );};var _bab =map[string ]FontStyle {"\u0052e\u0067\u0075\u006c\u0061\u0072":FontStyle_Regular ,"\u0042\u006f\u006c\u0064":FontStyle_Bold ,"\u0049\u0074\u0061\u006c\u0069\u0063":FontStyle_Italic ,"B\u006f\u006c\u0064\u0020\u0049\u0074\u0061\u006c\u0069\u0063":FontStyle_BoldItalic };func (_fea FontStyle )String ()string {return []string {"\u0052e\u0067\u0075\u006c\u0061\u0072","\u0042\u006f\u006c\u0064","\u0049\u0074\u0061\u006c\u0069\u0063","\u0042\u006f\u006c\u0064\u0049\u0074\u0061\u006c\u0069\u0063"}[int (_fea )];};func _abdb (_cabed string )error {if !_g .HasSuffix (_cabed ,"\u002e\u0074\u0074\u0066"){_gf .Log .Debug ("\u0055\u006es\u0075\u0070\u0070\u006f\u0072\u0074\u0065\u0064\u0020\u0066\u006f\u006e\u0074\u0020\u0066\u0069\u006c\u0065\u0020\u0066\u006f\u0072ma\u0074\u002e");return _f .Errorf ("\u0055\u006e\u0073\u0075\u0070\u0070o\u0072\u0074\u0065\u0064\u0020f\u006f\u006e\u0074\u0020\u0066\u0069l\u0065\u0020\u0066\u006f\u0072m\u0061\u0074\u002c\u0020\u0063\u0075\u0072\u0072\u0065\u006e\u0074\u006cy\u0020\u006f\u006e\u006c\u0079\u0020\u0073\u0075\u0070\u0070\u006f\u0072\u0074\u0020\u0054T\u0046\u0020\u0066\u006f\u006e\u0074\u0020\u0066i\u006c\u0065\u002e");};_ccf ,_acf :=_ea .ParseFile (_cabed );if _acf !=nil {_gf .Log .Debug ("\u0043a\u006e\u006e\u006f\u0074\u0020\u0070\u0061\u0072\u0073\u0065\u0020T\u0054\u0046\u0020\u0066\u0069\u006c\u0065\u0020\u0025\u0073",_acf );return _acf ;};_cad ,_acf :=_ee .NewCompositePdfFontFromTTFFile (_cabed );if _acf !=nil {return _acf ;};_fbcff :=_ccf .GetNameRecords ();for _ ,_cffg :=range _fbcff {_abcb :=_cffg [1];if _abcb ==""{return _f .Errorf ("\u004e\u006f\u0020\u0066\u006fn\u0074\u0020\u0066\u0061\u006d\u0069\u006c\u0079\u0020\u0069\u006e\u0066\u006fr\u006d\u0061\u0074\u0069\u006f\u006e\u0020\u0069\u006e\u0020\u0074\u0068\u0065\u0020\u0066\u0069\u006c\u0065\u0020\u0025\u0073",_cabed );};_dbg :=make ([]byte ,0);for _ebe :=0;_ebe < len (_abcb );_ebe ++{if _abcb [_ebe ]==39||_abcb [_ebe ]==92{continue ;};_gdbe :=4;if _ebe +_gdbe < len (_abcb ){if _abcb [_ebe :_ebe +_gdbe ]=="\u0000"{_ebe =_ebe +_gdbe +1;continue ;};};_dbg =append (_dbg ,_abcb [_ebe ]);};_abcb =_g .Replace (string (_dbg ),"\u0078\u0030\u0030","",-1);_fdb :=_cffg [2];if _fdb ==""{return _f .Errorf ("N\u006f\u0020\u0073\u0074\u0079\u006ce\u0020\u0069\u006e\u0066\u006f\u0072m\u0061\u0074\u0069\u006f\u006e\u0020\u0069n\u0020\u0074\u0068\u0065\u0020\u0066\u0069\u006c\u0065\u0020%\u0073",_cabed );};_dbg =make ([]byte ,0);for _afb :=0;_afb < len (_fdb );_afb ++{if _fdb [_afb ]==39||_fdb [_afb ]==92{continue ;};_cgc :=4;if _afb +_cgc < len (_fdb ){if _fdb [_afb :_afb +_cgc ]=="\u0000"{_afb =_afb +_cgc +1;continue ;};};_dbg =append (_dbg ,_fdb [_afb ]);};_fdb =_g .Replace (string (_dbg ),"\u0078\u0030\u0030","",-1);RegisterFont (_abcb ,_bab [_fdb ],_cad );};return nil ;};func _gdf (_efbcg ,_eccd ,_bcce uint8 )(float64 ,float64 ,float64 ){_geg ,_efe ,_gdda :=float64 (_efbcg )/255,float64 (_eccd )/255,float64 (_bcce )/255;_cfe :=_geg ;if _efe < _cfe {_cfe =_efe ;};if _gdda < _cfe {_cfe =_gdda ;};var _ecff ,_ggb bool ;_dde :=_geg ;if _efe > _dde {_dde =_efe ;_ecff =true ;};if _gdda > _dde {_dde =_gdda ;_ecff =false ;_ggb =true ;};_abd :=(_cfe +_dde )/2;var _bffd float64 ;if _cfe !=_dde {if _abd <=0.5{_bffd =(_dde -_cfe )/(_dde +_cfe );}else {_bffd =(_dde -_cfe )/(2.0-_dde -_cfe );};};var _bdgb float64 ;if _cfe !=_dde {if _ecff {_bdgb =2.0+(_gdda -_geg )/(_dde -_cfe );}else if _ggb {_bdgb =4.0+(_geg -_efe )/(_dde -_cfe );}else {_bdgb =(_efe -_gdda )/(_dde -_cfe );};_bdgb *=60;if _bdgb < 0{_bdgb +=360;};};return _bdgb ,_bffd ,_abd ;};func IsNoSpaceLanguage (symbol string )bool {for _ ,_feca :=range symbol {if _dc .Is (_dc .Han ,_feca ){return true ;};};return false ;};var StdFontsMap =map[string ][]string {"\u0048e\u006c\u0076\u0065\u0074\u0069\u0063a":[]string {"\u0048e\u006c\u0076\u0065\u0074\u0069\u0063a","\u0048\u0065\u006c\u0076\u0065\u0074\u0069\u0063\u0061-\u0042\u006f\u006c\u0064","\u0048\u0065\u006c\u0076\u0065\u0074\u0069\u0063\u0061\u002d\u004f\u0062l\u0069\u0071\u0075\u0065","H\u0065\u006c\u0076\u0065ti\u0063a\u002d\u0042\u006f\u006c\u0064O\u0062\u006c\u0069\u0071\u0075\u0065"},"\u0043o\u0075\u0072\u0069\u0065\u0072":[]string {"\u0043o\u0075\u0072\u0069\u0065\u0072","\u0043\u006f\u0075r\u0069\u0065\u0072\u002d\u0042\u006f\u006c\u0064","\u0043o\u0075r\u0069\u0065\u0072\u002d\u004f\u0062\u006c\u0069\u0071\u0075\u0065","\u0043\u006f\u0075\u0072ie\u0072\u002d\u0042\u006f\u006c\u0064\u004f\u0062\u006c\u0069\u0071\u0075\u0065"},"\u0054i\u006de\u0073\u0020\u004e\u0065\u0077\u0020\u0052\u006f\u006d\u0061\u006e":[]string {"T\u0069\u006d\u0065\u0073\u002d\u0052\u006f\u006d\u0061\u006e","\u0054\u0069\u006d\u0065\u0073\u002d\u0042\u006f\u006c\u0064","\u0054\u0069\u006de\u0073\u002d\u0049\u0074\u0061\u006c\u0069\u0063","\u0054\u0069m\u0065\u0073\u002dB\u006f\u006c\u0064\u0049\u0074\u0061\u006c\u0069\u0063"},"\u0064e\u0066\u0061\u0075\u006c\u0074":[]string {"\u0048e\u006c\u0076\u0065\u0074\u0069\u0063a","\u0048\u0065\u006c\u0076\u0065\u0074\u0069\u0063\u0061-\u0042\u006f\u006c\u0064","\u0048\u0065\u006c\u0076\u0065\u0074\u0069\u0063\u0061\u002d\u004f\u0062l\u0069\u0071\u0075\u0065","H\u0065\u006c\u0076\u0065ti\u0063a\u002d\u0042\u006f\u006c\u0064O\u0062\u006c\u0069\u0071\u0075\u0065"}};func AdjustColorByTint (colorStr string ,tint float64 )string {var _gagd ,_fgef ,_cgf uint8 ;_bad ,_ :=_f .Sscanf (colorStr ,"\u0025\u0030\u0032x\u0025\u0030\u0032\u0078\u0025\u0030\u0032\u0078",&_gagd ,&_fgef ,&_cgf );if _bad !=3{return "";};return _bcbd (_gagd ,tint )+_bcbd (_fgef ,tint )+_bcbd (_cgf ,tint );};func _bgfdd (_gag *_bd .CT_ValAx )(uint32 ,_bd .ST_AxPos ,_bd .ST_TickMark ,_bd .ST_TickLblPos ,*_bd .CT_ChartLines ,uint32 ,*_c .CT_ShapeProperties ,error ){var _cga ,_bbg uint32 ;var _beac _bd .ST_AxPos ;var _eee _bd .ST_TickMark ;var _aeab *_bd .CT_ChartLines ;var _eeed _bd .ST_TickLblPos ;if _gag .AxId ==nil {return _cga ,_beac ,_eee ,_eeed ,_aeab ,_bbg ,_gag .SpPr ,_gg .New ("\u004e\u006f\u0020x\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");}else {_cga =_gag .AxId .ValAttr ;};if _gag .AxPos ==nil {return _cga ,_beac ,_eee ,_eeed ,_aeab ,_bbg ,_gag .SpPr ,_gg .New ("\u004eo\u0020x\u0020\u0061\u0078\u0069\u0073 \u0070\u006fs\u0069\u0074\u0069\u006f\u006e");}else {_beac =_gag .AxPos .ValAttr ;};if _gag .MajorTickMark !=nil {_eee =_gag .MajorTickMark .ValAttr ;};if _gag .TickLblPos !=nil {_eeed =_gag .TickLblPos .ValAttr ;};if _gag .CrossAx ==nil {return _cga ,_beac ,_eee ,_eeed ,_aeab ,_bbg ,_gag .SpPr ,_gg .New ("\u004e\u006f \u0063\u0072\u006fs\u0073\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");}else {_bbg =_gag .CrossAx .ValAttr ;};_aeab =_gag .MajorGridlines ;return _cga ,_beac ,_eee ,_eeed ,_aeab ,_bbg ,_gag .SpPr ,nil ;};func (_efdc barSerByOrder )Len ()int {return len (_efdc )};func _ddfd (_aee *_bd .CT_DateAx )(uint32 ,_bd .ST_AxPos ,_bd .ST_TickMark ,_bd .ST_TickLblPos ,*_bd .CT_ChartLines ,uint32 ,*_c .CT_ShapeProperties ,error ){var _abab ,_fcda uint32 ;var _eag _bd .ST_AxPos ;var _bfg _bd .ST_TickMark ;var _aeaa *_bd .CT_ChartLines ;var _cabd _bd .ST_TickLblPos ;if _aee .AxId ==nil {return _abab ,_eag ,_bfg ,_cabd ,_aeaa ,_fcda ,_aee .SpPr ,_gg .New ("\u004e\u006f\u0020x\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");}else {_abab =_aee .AxId .ValAttr ;};if _aee .AxPos ==nil {return _abab ,_eag ,_bfg ,_cabd ,_aeaa ,_fcda ,_aee .SpPr ,_gg .New ("\u004eo\u0020x\u0020\u0061\u0078\u0069\u0073 \u0070\u006fs\u0069\u0074\u0069\u006f\u006e");}else {_eag =_aee .AxPos .ValAttr ;};if _aee .MajorTickMark !=nil {_bfg =_aee .MajorTickMark .ValAttr ;};if _aee .TickLblPos !=nil {_cabd =_aee .TickLblPos .ValAttr ;};if _aee .CrossAx ==nil {return _abab ,_eag ,_bfg ,_cabd ,_aeaa ,_fcda ,_aee .SpPr ,_gg .New ("\u004e\u006f \u0063\u0072\u006fs\u0073\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");}else {_fcda =_aee .CrossAx .ValAttr ;};_aeaa =_aee .MajorGridlines ;return _abab ,_eag ,_bfg ,_cabd ,_aeaa ,_fcda ,_aee .SpPr ,nil ;};func AssignStdFontByName (style _ag .TextStyle ,fontName string )*_ee .PdfFont {_gff :=_ee .StdFontName (fontName );return _ee .NewStandard14FontMustCompile (_gff );};var _bef =_gbedg (1.5);const _ge =6.0;func DrawLine (c *_ag .Creator ,x0 ,y0 ,x1 ,y1 ,width float64 ,color _ag .Color ){if color ==nil {return ;};_gbe :=c .NewLine (x0 ,y0 ,x1 ,y1 );_gbe .SetLineWidth (width );_gbe .SetColor (color );c .Draw (_gbe );};func GetDataFromXfrm (xfrm *_c .CT_Transform2D )(float64 ,float64 ,float64 ,float64 ){var _effb ,_gafb ,_cbdc ,_cfcb float64 ;if _aegd :=xfrm .Off ;_aegd !=nil {_effb =_fc .FromEMU (FromSTCoordinate (_aegd .XAttr ));_gafb =_fc .FromEMU (FromSTCoordinate (_aegd .YAttr ));};if _aed :=xfrm .Ext ;_aed !=nil {_cbdc =_fc .FromEMU (_aed .CxAttr );_cfcb =_fc .FromEMU (_aed .CyAttr );};return _effb ,_gafb ,_cbdc ,_cfcb ;};func (_dabe barSerByOrder )Swap (i ,j int ){_dabe [i ],_dabe [j ]=_dabe [j ],_dabe [i ]};func _bdgg (_ffba float64 )float64 {if _ffba < 0{_ffba +=float64 (-int (_ffba )+1);}else if _ffba > 1{_ffba -=float64 (int (_ffba ));};return _ffba ;};func (_gged barSerByOrder )Less (i ,j int )bool {return _gged [i ].Order .ValAttr < _gged [j ].Order .ValAttr ;};func (_cbdf *Rectangle )scale (_fdc float64 ){_cbdf .Top *=_fdc ;_cbdf .Bottom *=_fdc ;_cbdf .Left *=_fdc ;_cbdf .Right *=_fdc ;};func TwipsFromPoints (points float64 )float64 {return points /_fc .Twips };func (_cbbb *creatorContext )drawBorderWithProps (_agc *_c .CT_ShapeProperties ,_fggc *Rectangle ,_cfed float64 ){if _fggc !=nil &&_agc !=nil &&_agc .Ln !=nil &&_agc .Ln .SolidFill !=nil {_abfg :=_cbbb .getPdfColorFromSolidFill (_agc .Ln .SolidFill );DrawRectangle (_cbbb ._abe ,_fggc ,_cfed ,_abfg );};};func (_eca *creatorContext )drawAxes (_cbd *_bd .CT_PlotAreaChoice1 ,_eaeg ,_baa ,_fbeg float64 ,_ffb []string ,_aaf *Rectangle ,_cbfg bool )error {_fcfe :=_eca ._abe ;_bff :=_eca ._eegc ;if _cbd ==nil {return _gg .New ("\u004e\u006f\u0020\u0061xi\u0073\u0020\u0069\u006e\u0066\u006f\u0072\u006d\u0061\u0074\u0069\u006f\u006e");};if len (_cbd .ValAx )==0||(len (_cbd .CatAx )==0&&len (_cbd .DateAx )==0&&len (_cbd .SerAx )==0){return _gg .New ("\u004e\u006f\u0020\u0078\u0020\u006f\u0072\u0020\u0079 \u0061\u0078\u0069\u0073");};var _cea ,_bfb ,_dcd ,_gef uint32 ;var _abg ,_abfb _bd .ST_AxPos ;var _dggb ,_agdg _bd .ST_TickMark ;var _dcf ,_febc *_bd .CT_ChartLines ;var _fed ,_gca _bd .ST_TickLblPos ;var _cdd ,_gbdc *_c .CT_ShapeProperties ;var _bee error ;_fcff :=_aaf .Right -_aaf .Left ;_ecec :=_aaf .Bottom -_aaf .Top ;if len (_cbd .ValAx )> 0{_bfb ,_abfb ,_agdg ,_gca ,_febc ,_gef ,_gbdc ,_bee =_bgfdd (_cbd .ValAx [0]);};if _abfb !=_bd .ST_AxPosL &&_abfb !=_bd .ST_AxPosB {return _gg .New ("\u004f\u006e\u006c\u0079\u0020l\u0065\u0066\u0074\u0020\u006f\u0072\u0020\u0062\u006f\u0074\u0074\u006f\u006d \u0079\u0020\u0061\u0078\u0069\u0073\u0020\u0073\u0075\u0070\u0070\u006f\u0072\u0074\u0020\u0073\u006f\u0020\u0066\u0061\u0072");};_ceb :=_baa -_eaeg ;_bgc :=int (_ceb /_fbeg )+1;var _baga ,_add float64 ;switch _agdg {case _bd .ST_TickMarkIn :_baga ,_add =_dga ,0;case _bd .ST_TickMarkOut :_baga ,_add =0,_dga ;case _bd .ST_TickMarkCross :_baga ,_add =_dga ,_dga ;};_baga =_baga *_bff ;_add =_add *_bff ;var _ecg *_c .CT_ShapeProperties ;if _febc !=nil {_ecg =_febc .SpPr ;};_bfd ,_edd :=_fed !=_bd .ST_TickLblPosNone ,_gca !=_bd .ST_TickLblPosNone ;_gbfe :=_eaeg ;if len (_cbd .CatAx )> 0{_cea ,_abg ,_dggb ,_fed ,_dcf ,_dcd ,_cdd ,_bee =_aba (_cbd .CatAx [0]);}else if len (_cbd .DateAx )> 0{_cea ,_abg ,_dggb ,_fed ,_dcf ,_dcd ,_cdd ,_bee =_ddfd (_cbd .DateAx [0]);}else if len (_cbd .SerAx )> 0{_cea ,_abg ,_dggb ,_fed ,_dcf ,_dcd ,_cdd ,_bee =_bcc (_cbd .SerAx [0]);};if _bee !=nil {return _bee ;};if _abg !=_bd .ST_AxPosL &&_abg !=_bd .ST_AxPosB {return _gg .New ("\u004f\u006e\u006c\u0079\u0020l\u0065\u0066\u0074\u0020\u006f\u0072\u0020\u0062\u006f\u0074\u0074\u006f\u006d \u0078\u0020\u0061\u0078\u0069\u0073\u0020\u0073\u0075\u0070\u0070\u006f\u0072\u0074\u0020\u0073\u006f\u0020\u0066\u0061\u0072");};if _cea !=_gef ||_bfb !=_dcd {return _gg .New ("a\u0078i\u0073\u0020\u0069\u0064\u0073\u0020\u0064\u006fn\u0027\u0074\u0020\u006dat\u0063\u0068");};_cbbc :=len (_ffb )+1;var _eaac ,_eff float64 ;switch _dggb {case _bd .ST_TickMarkIn :_eaac ,_eff =_dga ,0;case _bd .ST_TickMarkOut :_eaac ,_eff =0,_dga ;case _bd .ST_TickMarkCross :_eaac ,_eff =_dga ,_dga ;};_eaac =_eaac *_bff ;_eff =_eff *_bff ;var _acae *_c .CT_ShapeProperties ;if _dcf !=nil {_acae =_dcf .SpPr ;};if _cbfg {_gcf :=_ecec /float64 (len (_ffb ));_degf :=_aaf .Left -_eaeg *_fcff /_ceb ;_ebb :=_degf -_ffc *_bff ;if _bfd {var _geb float64 ;for _edba :=0;_edba < _cbbc ;_edba ++{_gcc :=_aaf .Bottom -float64 (_edba )*_gcf ;if _edba < _cbbc -1{_egb :=_fcfe .NewParagraph (_ffb [_edba ]);_egb .SetFontSize (_ge *_bff );_egb .SetPos (_ebb ,_gcc -_gcf /2-_gfbg *_bff );_fcfe .Draw (_egb );_fgg :=(_egb .Width ()/1000-_ffc )*_bff ;if _fgg > 0&&_fgg > _geb {_geb =_fgg ;};};};if _geb > 0{_aaf .Left +=_geb +_ddf ;_degf =_aaf .Left -_eaeg *_fcff /_ceb ;_fcff =_aaf .Right -_aaf .Left ;};};_eafa :=_degf -_eff ;_ccc :=_degf +_eaac ;_daea :=_aaf .Left ;_bdd :=_aaf .Right ;for _baf :=0;_baf < _cbbc ;_baf ++{_gaf :=_aaf .Bottom -float64 (_baf )*_gcf ;_eca .drawLineWithProps (_cdd ,_eafa ,_gaf ,_ccc ,_gaf ,true );_eca .drawLineWithProps (_acae ,_daea ,_gaf ,_bdd ,_gaf ,true );};_fecf :=_fcff /_ceb ;_cbe :=_aaf .Bottom -_baga ;_ege :=_aaf .Bottom +_add ;_dee :=_aaf .Top ;_bac :=_aaf .Bottom ;for _bge :=0;_bge < _bgc ;_bge ++{_fde :=_aaf .Left +(_gbfe -_eaeg )*_fecf ;_eca .drawLineWithProps (_gbdc ,_fde ,_cbe ,_fde ,_ege ,true );_eca .drawLineWithProps (_ecg ,_fde ,_dee ,_fde ,_bac ,true );if _edd {_aaff :=_fcfe .NewParagraph (_b .FormatFloat (_gbfe ,'g',-1,64));_aaff .SetFontSize (_ge *_bff );_aaff .SetPos (_fde -_ade *_bff ,_bac +_bef *_bff );_fcfe .Draw (_aaff );};_gbfe +=_fbeg ;};}else {_fac :=_ecec /_ceb ;_eadc :=_aaf .Left ;if _edd {var _cabe float64 ;for _fgge :=0;_fgge < _bgc ;_fgge ++{_bbc :=_aaf .Bottom -(_gbfe -_eaeg )*_fac ;_eddd :=_fcfe .NewParagraph (_b .FormatFloat (_gbfe ,'g',-1,64));_eddd .SetFontSize (_ge *_bff );_eddd .SetPos (_eadc -_ffc *_bff ,_bbc -_gfbg *_bff );_fcfe .Draw (_eddd );_fcea :=(_eddd .Width ()/1000-_ffc )*_bff ;if _fcea > 0&&_fcea > _cabe {_cabe =_fcea ;};_gbfe +=_fbeg ;};if _cabe > 0{_aaf .Left +=_cabe +_ddf ;_fcff =_aaf .Right -_aaf .Left ;};};_gbfe =_eaeg ;_gdd :=_aaf .Left -_add ;_dce :=_aaf .Left +_baga ;_eadc =_aaf .Left ;_dcff :=_aaf .Right ;for _fge :=0;_fge < _bgc ;_fge ++{_ddde :=_aaf .Bottom -(_gbfe -_eaeg )*_fac ;_eca .drawLineWithProps (_gbdc ,_gdd ,_ddde ,_dce ,_ddde ,true );_eca .drawLineWithProps (_ecg ,_eadc ,_ddde ,_dcff ,_ddde ,true );_gbfe +=_fbeg ;};_fgb :=_fcff /float64 (len (_ffb ));_agbb :=_aaf .Bottom +_eaeg *_ecec /_ceb ;_fgga :=_agbb -_eaac ;_ebdg :=_agbb +_eff ;_bbcg :=_aaf .Top ;_cba :=_aaf .Bottom ;_ged :=_agbb +_bef *_bff ;for _dgag :=0;_dgag < _cbbc ;_dgag ++{_aea :=_aaf .Left +float64 (_dgag )*_fgb ;_eca .drawLineWithProps (_cdd ,_aea ,_fgga ,_aea ,_ebdg ,true );_eca .drawLineWithProps (_acae ,_aea ,_bbcg ,_aea ,_cba ,true );if _bfd &&_dgag < _cbbc -1{_bae :=_fcfe .NewParagraph (_ffb [_dgag ]);_bae .SetFontSize (_ge *_bff );_bae .SetPos (_aea +_dbcb *_bff ,_ged );_fcfe .Draw (_bae );};};};return nil ;};var _gfbg =_gbedg (1.5);func AdjustColorByShade (colorStr string ,shade float64 )string {var _fbff ,_egdg ,_aecd uint8 ;_bfa ,_ :=_f .Sscanf (colorStr ,"\u0025\u0030\u0032x\u0025\u0030\u0032\u0078\u0025\u0030\u0032\u0078",&_fbff ,&_egdg ,&_aecd );if _bfa !=3{return "";};return _dda (_fbff ,shade )+_dda (_egdg ,shade )+_dda (_aecd ,shade );};func (_edgc *creatorContext )drawRectangleWithProps (_bcgg *_c .CT_ShapeProperties ,_dbe ,_eegdf ,_acfa ,_eagd float64 ,_dbd bool ){_egbc :=_edgc ._abe .NewRectangle (_dbe ,_eegdf ,_acfa ,_eagd );if _bcgg ==nil {if _dbd {_egbc .SetBorderWidth (_cafb );}else {return ;};}else {_fca :=_edgc .getPdfColorFromSolidFill (_bcgg .SolidFill );if _fca !=nil {_egbc .SetFillColor (_fca );};if _fcgg :=_bcgg .Ln ;_fcgg !=nil {if _bbf :=_fcgg .WAttr ;_bbf !=nil {_cgg :=_fc .FromEMU (int64 (*_bbf ));_egbc .SetBorderWidth (_cgg );if _aff :=_fcgg .SolidFill ;_aff !=nil {_gbed :=_edgc .getPdfColorFromSolidFill (_aff );if _gbed !=nil {_egbc .SetBorderColor (_gbed );};};}else {_egbc .SetBorderWidth (0);};};};_edgc ._abe .Draw (_egbc );};type barSerByOrder []*_bd .CT_BarSer ;var _dga =_gbedg (1);type creatorContext struct{_abe *_ag .Creator ;_cbba *_c .Theme ;_eegc float64 ;};func RegisterFontsFromFiles (files []string )error {for _ ,_eddb :=range files {if _g .HasSuffix (_eddb ,"\u002e\u0074\u0074\u0066"){_cebc :=_abdb (_eddb );if _cebc !=nil {_gf .Log .Debug ("\u0075\u006ea\u0062\u006c\u0065\u0020\u0074o\u0020\u0070\u0072\u006f\u0063e\u0073\u0073\u0020\u0061\u006e\u0064\u0020\u0072\u0065\u0067\u0069\u0073\u0074\u0065\u0072\u0020\u0066\u006f\u006e\u0074\u0020\u0066\u0072\u006f\u006d\u0020\u0054\u0054\u0046\u0020\u0066\u0069\u006c\u0065\u0020\u0025\u0073",_cebc );continue ;};};};return nil ;};func PointsFromTwips (twips int64 )float64 {return float64 (int64 (float64 (twips )*_fc .Twips *10+0.5))/10;};func _bcbd (_ace uint8 ,_gefa float64 )string {_cbdb :=float64 (_ace );var _cebb float64 ;if _gefa < 0{_cebb =_cbdb *(1+_gefa );}else {_cebb =_cbdb +(255-_cbdb )*_gefa ;};return _f .Sprintf ("\u0025\u0030\u0032\u0078",int (_cebb ));};const (BorderPositionTop BorderPosition =0;BorderPositionLeft BorderPosition =1;BorderPositionBottom BorderPosition =2;BorderPositionRight BorderPosition =3;);func MakeBlockFromCreator (c *_ag .Creator )(*_ag .Block ,error ){_ffag ,_gcad :=GetPageFromCreator (c );if _gcad !=nil {return nil ,_gcad ;};_gbbc ,_gcad :=_ag .NewBlockFromPage (_ffag );if _gcad !=nil {return nil ,_gcad ;};return _gbbc ,nil ;};const DefaultFontSize =12.0;func RegisterFontsFromDirectory (dirName string )error {_ecfc ,_dfee :=_dd .Open (dirName );if _dfee !=nil {return _dfee ;};defer _ecfc .Close ();_gaca ,_dfee :=_ecfc .Readdirnames (0);if _dfee !=nil {return _dfee ;};for _ ,_ccab :=range _gaca {if _g .HasSuffix (_ccab ,"\u002e\u0074\u0074\u0066"){_edg :=dirName +"\u002f"+_ccab ;_eeda :=_abdb (_edg );if _eeda !=nil {_gf .Log .Debug ("\u0075\u006ea\u0062\u006c\u0065\u0020\u0074o\u0020\u0070\u0072\u006f\u0063e\u0073\u0073\u0020\u0061\u006e\u0064\u0020\u0072\u0065\u0067\u0069\u0073\u0074\u0065\u0072\u0020\u0066\u006f\u006e\u0074\u0020\u0066\u0072\u006f\u006d\u0020\u0054\u0054\u0046\u0020\u0066\u0069\u006c\u0065\u0020\u0025\u0073",_eeda );continue ;};};};return nil ;};func _gbedg (_fgee float64 )float64 {return _fgee *_fc .Millimeter };func (_gaa *Rectangle )Translate (x ,y float64 ){_gaa .Left +=x ;_gaa .Right +=x ;_gaa .Top +=y ;_gaa .Bottom +=y ;};var _dbcb =_gbedg (5);func FromSTCoordinate32 (st _c .ST_Coordinate32 )int64 {if _dggba :=st .ST_Coordinate32Unqualified ;_dggba !=nil {return int64 (*_dggba );};return 0;};func MakeBlockFromChartSpace (cs *_bd .ChartSpace ,width ,height float64 ,theme *_c .Theme )(*_ag .Block ,error ){_gbf ,_egd :=_cab (cs ,width ,height ,theme ,false );if _egd !=nil {return nil ,_egd ;};_aec ,_egd :=GetPageFromCreator (_gbf );if _egd !=nil {return nil ,_egd ;};_egdf ,_egd :=_ag .NewBlockFromPage (_aec );if _egd !=nil {return nil ,_egd ;};return _egdf ,nil ;};func GetRegisteredFont (name string ,style FontStyle )*_ee .PdfFont {_dffd ._feg .Lock ();defer _dffd ._feg .Unlock ();if _febce ,_badd :=_dffd ._fcfd [name ];_badd {if _aecf ,_dfe :=_febce [style ];_dfe {return _aecf ;};};return nil ;};func GetColorStringFromDmlColor (dmlColor *_c .CT_Color )string {var _dcag string ;if _afe :=dmlColor .SrgbClr ;_afe !=nil {_dcag =_afe .ValAttr ;}else if _dcg :=dmlColor .SysClr ;_dcg !=nil {return "\u0030\u0030\u0030\u0030\u0030\u0030";};return _dcag ;};func GetOpacityFromColorTransform (trs []*_c .EG_ColorTransform )float64 {for _ ,_ebf :=range trs {if _ebf !=nil {if _gbgg :=_ebf .Alpha ;_gbgg !=nil {if _fedf :=_gbgg .ValAttr .ST_PositiveFixedPercentageDecimal ;_fedf !=nil {return float64 (*_fedf )/100000;};};};};return 1.0;};func MakeTempCreator (width ,height float64 )*_ag .Creator {_dfdc :=_ag .New ();_dfdc .SetPageSize (_ag .PageSize {width ,height });_dfdc .SetPageMargins (0,0,0,0);return _dfdc ;};func DrawRectangle (c *_ag .Creator ,r *Rectangle ,w float64 ,color _ag .Color ){if color ==nil {return ;};DrawLine (c ,r .Left ,r .Top ,r .Right ,r .Top ,w ,color );DrawLine (c ,r .Left ,r .Top ,r .Left ,r .Bottom ,w ,color );DrawLine (c ,r .Left ,r .Bottom ,r .Right ,r .Bottom ,w ,color );DrawLine (c ,r .Right ,r .Top ,r .Right ,r .Bottom ,w ,color );};type serCategory struct{_dgb string ;_bdg []serValue ;};func (_bfe *creatorContext )drawLegend (_eae *Rectangle ,_fcdc []*legendItem ,_cfgg bool ){_ebc :=_bfe ._eegc ;_fbe :=_gbedg (2.5)*_ebc ;_cff :=_fga *_ebc ;_edf :=(_fbe -_cff )/2;_dbc :=float64 (len (_fcdc ));if _cfgg {_aca :=&Rectangle {Top :_eae .Top +_gbedg (1)*_ebc ,Bottom :_eae .Bottom -_gbedg (1)*_ebc ,Left :_eae .Left +_gbedg (2.5)*_ebc ,Right :_eae .Right -_gbedg (2.5)*_ebc };var _faa float64 ;if _dbc > 1{_faa =(_aca .Right -_aca .Left )/_dbc ;};_eab :=_aca .Left ;_afg :=_aca .Top ;for _ ,_gab :=range _fcdc {if _dca :=_gab ._ae ;_dca !=nil {_bfe .drawRectangleWithProps (_dca ,_eab ,_afg +_edf ,_cff ,_cff ,false );_ce :=_eab +_cff *2;_fbcf :=_bfe ._abe .NewStyledParagraph ();_fbcf .SetPos (_ce ,_afg );_bcf :=_fbcf .Append (_gab ._gc );_gfb ,_fgc :=_ee .NewStandard14Font (_ee .HelveticaName );if _fgc ==nil {_bcf .Style =_ag .TextStyle {FontSize :_fbe ,Font :_gfb ,TextRise :0.4};_bfe ._abe .Draw (_fbcf );};};_eab +=_faa ;};}else {_acdf :=&Rectangle {Top :_eae .Top +_gbedg (2.5)*_ebc ,Bottom :_eae .Bottom -_gbedg (2.5)*_ebc ,Left :_eae .Left +_gbedg (2.5)*_ebc ,Right :_eae .Right -_gbedg (2.5)*_ebc };var _ddgd float64 ;if _dbc > 1{_ddgd =(_acdf .Bottom -_acdf .Top -_fbe )/(_dbc -1);};_dfag :=_acdf .Top ;_ggce :=_acdf .Left ;_edbe :=_ggce +_cff *2;for _ ,_caff :=range _fcdc {if _daa :=_caff ._ae ;_daa !=nil {_bfe .drawRectangleWithProps (_daa ,_ggce ,_dfag +_edf ,_cff ,_cff ,false );_ede :=_bfe ._abe .NewStyledParagraph ();_ede .SetPos (_edbe ,_dfag );_dcc :=_ede .Append (_caff ._gc );_eac ,_ecc :=_ee .NewStandard14Font (_ee .HelveticaName );if _ecc ==nil {_dcc .Style =_ag .TextStyle {FontSize :_fbe ,Font :_eac ,TextRise :0.4};_bfe ._abe .Draw (_ede );};};_dfag +=_ddgd ;};};};func _bbbe (_ggfe _c .ST_SchemeColorVal ,_ecad *_c .Theme )string {if _bcb :=_ecad .ThemeElements ;_bcb !=nil {if _adf :=_bcb .ClrScheme ;_adf !=nil {switch _ggfe {case _c .ST_SchemeColorValLt1 :return GetColorStringFromDmlColor (_adf .Lt1 );case _c .ST_SchemeColorValDk1 ,_c .ST_SchemeColorValTx1 :return GetColorStringFromDmlColor (_adf .Dk1 );case _c .ST_SchemeColorValLt2 :return GetColorStringFromDmlColor (_adf .Lt2 );case _c .ST_SchemeColorValDk2 :return GetColorStringFromDmlColor (_adf .Dk2 );case _c .ST_SchemeColorValAccent1 :return GetColorStringFromDmlColor (_adf .Accent1 );case _c .ST_SchemeColorValAccent2 :return GetColorStringFromDmlColor (_adf .Accent2 );case _c .ST_SchemeColorValAccent3 :return GetColorStringFromDmlColor (_adf .Accent3 );case _c .ST_SchemeColorValAccent4 :return GetColorStringFromDmlColor (_adf .Accent4 );case _c .ST_SchemeColorValAccent5 :return GetColorStringFromDmlColor (_adf .Accent5 );case _c .ST_SchemeColorValAccent6 :return GetColorStringFromDmlColor (_adf .Accent6 );};};};return "";};func MakeImageFromChartSpace (cs *_bd .ChartSpace ,width ,height float64 ,theme *_c .Theme )(_fb .Image ,error ){_feb ,_ab :=_cab (cs ,width ,height ,theme ,true );if _ab !=nil {return nil ,_ab ;};_fda ,_ab :=GetPageFromCreator (_feb );if _ab !=nil {return nil ,_ab ;};return _fe .NewImageDevice ().Render (_fda );};var _ade =_gbedg (0.5);type ImgPart byte ;type BorderPosition byte ;const (ImgPart_whole ImgPart =0;ImgPart_t ImgPart =1;ImgPart_b ImgPart =2;ImgPart_l ImgPart =3;ImgPart_r ImgPart =4;ImgPart_lt ImgPart =5;ImgPart_rt ImgPart =6;ImgPart_lb ImgPart =7;ImgPart_rb ImgPart =8;);const (FontStyle_Regular FontStyle =0;FontStyle_Bold FontStyle =1;FontStyle_Italic FontStyle =2;FontStyle_BoldItalic FontStyle =3;);type serValue struct{_fba string ;_bea float64 ;_eec *_c .CT_ShapeProperties ;};type FontStyle byte ;func RegisterFont (name string ,style FontStyle ,font *_ee .PdfFont ){_dffd ._feg .Lock ();if _dffd ._fcfd [name ]==nil {_dffd ._fcfd [name ]=map[FontStyle ]*_ee .PdfFont {};};_dffd ._fcfd [name ][style ]=font ;_dffd ._feg .Unlock ();};func CropImageByRect (sourceImg _fb .Image ,rect _fb .Rectangle )_fb .Image {_aadb ,_dgca ,_bcff ,_egge :=rect .Min .X ,rect .Min .Y ,rect .Max .X ,rect .Max .Y ;_eecc :=_fb .NewNRGBA (_fb .Rect (0,0,_bcff -_aadb ,_egge -_dgca ));for _fcag :=_aadb ;_fcag < _bcff ;_fcag ++{for _dbgf :=_dgca ;_dbgf < _egge ;_dbgf ++{_eecc .Set (_fcag -_aadb ,_dbgf -_dgca ,sourceImg .At (_fcag ,_dbgf ));};};return _eecc ;};func _dda (_gcb uint8 ,_defc float64 )string {_abc :=float64 (_gcb );return _f .Sprintf ("\u0025\u0030\u0032\u0078",int (_abc *_defc ));};func GetImage (c *_ag .Creator ,goImg _fb .Image ,imgHeight ,imgWidth ,left ,top ,dividerX ,dividerY float64 ,part ImgPart )(*_ag .Image ,error ){if goImg ==nil {return nil ,nil ;};_cfb :=goImg .Bounds ().Size ();_cae :=_cfb .X ;_deef :=_cfb .Y ;if dividerX !=0{dividerX =dividerX /imgWidth *float64 (_cae );};if dividerY !=0{dividerY =dividerY /imgHeight *float64 (_deef );};var _cdad _fb .Rectangle ;switch part {case ImgPart_t :_cdad =_fb .Rect (0,0,_cae ,int (dividerY ));case ImgPart_b :_cdad =_fb .Rect (0,int (dividerY ),_cae ,_deef );case ImgPart_l :_cdad =_fb .Rect (0,0,int (dividerX ),_deef );case ImgPart_r :_cdad =_fb .Rect (int (dividerX ),0,_cae ,_deef );case ImgPart_lt :_cdad =_fb .Rect (0,0,int (dividerX ),int (dividerY ));case ImgPart_rt :_cdad =_fb .Rect (int (dividerX ),0,_cae ,int (dividerY ));case ImgPart_lb :_cdad =_fb .Rect (0,int (dividerY ),int (dividerX ),_deef );case ImgPart_rb :_cdad =_fb .Rect (int (dividerX ),int (dividerY ),_cae ,_deef );default:_cdad =_fb .Rect (0,0,_cae ,_deef );};_agf :=CropImageByRect (goImg ,_cdad );_bfcd ,_bfeb :=c .NewImageFromGoImage (_agf );if _bfeb !=nil {return nil ,_bfeb ;};_bfcd .Scale (imgWidth /float64 (_cae ),imgHeight /float64 (_deef ));_bfcd .SetPos (left ,top );return _bfcd ,nil ;};type legendItem struct{_gc string ;_ae *_c .CT_ShapeProperties ;};func FromSTCoordinate (st _c .ST_Coordinate )int64 {if _agg :=st .ST_CoordinateUnqualified ;_agg !=nil {return *_agg ;};return 0;};var _cafb =_gbedg (0.125);type fontsMap struct{_feg *_a .Mutex ;_fcfd map[string ]map[FontStyle ]*_ee .PdfFont ;};func GetPageFromCreator (c *_ag .Creator )(*_ee .PdfPage ,error ){_efeg :=_db .NewBuffer ([]byte {});_edbd :=c .Write (_efeg );if _edbd !=nil {return nil ,_edbd ;};_gaab :=_db .NewReader (_efeg .Bytes ());_eafe ,_edbd :=_ee .NewPdfReader (_gaab );if _edbd !=nil {return nil ,_edbd ;};return _eafe .GetPage (1);};var _dffd =fontsMap {_feg :&_a .Mutex {},_fcfd :map[string ]map[FontStyle ]*_ee .PdfFont {}};func (_cb *creatorContext )drawBarChart (_ef *_bd .CT_BarChart ,_cbb *Rectangle ,_cf *_bd .CT_PlotAreaChoice1 )([]*legendItem ,error ){var _ad bool ;if _df :=_ef .BarDir ;_df !=nil {_ad =_df .ValAttr ==_bd .ST_BarDirBar ;};_gb :=_ef .Ser ;_bb .Sort (barSerByOrder (_gb ));_ba :=map[string ]serCategory {};_fcd :=[]string {};_de :=[]*legendItem {};_ead :=_d .Inf (1);_bf :=_d .Inf (-1);for _ ,_dg :=range _gb {var _fcg string ;if _fbc :=_dg .Tx ;_fbc !=nil {if _fa :=_fbc .Choice ;_fa !=nil {if _fa .V !=nil {_fcg =*_fa .V ;}else if _cbf :=_fa .StrRef ;_cbf !=nil {if _cc :=_cbf .StrCache ;_cc !=nil {for _ ,_ccb :=range _cc .Pt {_fcg =_ccb .V ;};};};};};if _efd :=_dg .Cat ;_efd !=nil {if _eg :=_efd .Choice ;_eg !=nil {if _deg :=_eg .StrRef ;_deg !=nil {if _dea :=_deg .StrCache ;_dea !=nil {for _ ,_fcf :=range _dea .Pt {_fbf :=_fcf .V ;if _ ,_ff :=_ba [_fbf ];!_ff {_ba [_fbf ]=serCategory {_dgb :_fbf ,_bdg :[]serValue {}};_fcd =append (_fcd ,_fbf );};};};}else if _fd :=_eg .NumRef ;_fd !=nil {if _dgc :=_fd .NumCache ;_dgc !=nil {var _cfc string ;if _dgc .FormatCode !=nil {_cfc =*_dgc .FormatCode ;};for _ ,_ac :=range _dgc .Pt {var _agd string ;if _ac .FormatCodeAttr ==nil {_agd =_cfc ;}else {_agd =*_ac .FormatCodeAttr ;};var _ca string ;_eb ,_gfe :=_b .ParseFloat (_ac .V ,64);if _gfe !=nil {_ca =_ac .V ;}else {_ca =_be .Number (_eb ,_agd );};if _ ,_cfa :=_ba [_ca ];!_cfa {_ba [_ca ]=serCategory {_dgb :_ca ,_bdg :[]serValue {}};_fcd =append (_fcd ,_ca );};};};};};};if _ggg :=_dg .Val ;_ggg !=nil {if _aa :=_ggg .Choice ;_aa !=nil {if _ega :=_aa .NumRef ;_ega !=nil {if _ga :=_ega .NumCache ;_ga !=nil {for _ddg ,_bg :=range _ga .Pt {_ed ,_fce :=_b .ParseFloat (_bg .V ,64);if _fce !=nil {_ed =0;_gf .Log .Debug ("\u0070a\u0072s\u0065\u0020\u0065\u0072\u0072\u006f\u0072\u003a\u0020\u0025\u0073",_fce );};if _ed > _bf {_bf =_ed ;};if _ed < _ead {_ead =_ed ;};_dgg :=_ba [_fcd [_ddg ]];_dgg ._bdg =append (_dgg ._bdg ,serValue {_fba :_fcg ,_bea :_ed ,_eec :_dg .SpPr });_ba [_fcd [_ddg ]]=_dgg ;};};};};};_de =append (_de ,&legendItem {_gc :_fcg ,_ae :_dg .SpPr });};var _bfc float64 ;var _bdc ,_cbbg float64 ;if _bf ==0&&_ead ==0{_bfc =0.2;_cbbg =0;_bdc =1;}else {var _gd float64 ;if _def :=_d .Abs (_ead );_bf < _def {_gd =_def ;}else {_gd =_bf ;};_aga :=_d .Pow (10,_d .Floor (_d .Log10 (_gd )));_ebg :=_gd /_aga ;if _ebg >=1.715&&_ebg < 4.29{_bfc =0.5;}else if _ebg >=4.29&&_ebg < 8.58{_bfc =1;}else {_bfc =2;};_bfc *=_aga ;if _bf <=0{_bdc =0;}else {_bdc =(_d .Ceil (_bf /_bfc )+1)*_bfc ;};if _ead >=0{_cbbg =0;}else {_cbbg =(_d .Floor (_ead /_bfc )-1)*_bfc ;};};_edc :=_cb .drawAxes (_cf ,_cbbg ,_bdc ,_bfc ,_fcd ,_cbb ,_ad );if _edc !=nil {return nil ,_edc ;};_fdf :=0.0;if _ef .GapWidth !=nil {if _fec :=_ef .GapWidth .ValAttr ;_fec !=nil {if _cgb :=_fec .ST_GapAmountUShort ;_cgb !=nil {_fdf =float64 (*_cgb )/100.0;};};};_ccg :=_cbb .Right -_cbb .Left ;_aae :=_cbb .Bottom -_cbb .Top ;_edb :=float64 (len (_fcd ));if _ad {_dbf :=_bdc /(_bdc -_cbbg )*_ccg ;_bc :=-_cbbg /(_bdc -_cbbg )*_ccg ;_acd :=_cbb .Left +_bc ;_bgg :=_aae /_edb ;for _fcec ,_cd :=range _fcd {_bcg :=_ba [_cd ];_eeg :=float64 (len (_bcg ._bdg ))+_fdf ;_eaa :=_bgg /_eeg ;_bbe :=_eaa *_fdf ;_da :=_cbb .Bottom -float64 (_fcec )*_bgg -_bbe /2-_eaa ;for _ ,_fdfd :=range _bcg ._bdg {if _fdfd ._bea ==0{continue ;};var _ffa ,_cbbgb float64 ;if _fdfd ._bea > 0{_cbbgb =_fdfd ._bea /_bdc *_dbf ;_cb .drawRectangleWithProps (_fdfd ._eec ,_acd ,_da ,_cbbgb ,_eaa ,false );}else {_cbbgb =_fdfd ._bea /_cbbg *_bc ;_ffa =_acd -_cbbgb ;_cb .drawRectangleWithProps (_fdfd ._eec ,_ffa ,_da ,_cbbgb ,_eaa ,false );};_da -=_eaa ;};};}else {_efb :=_bdc /(_bdc -_cbbg )*_aae ;_bgf :=-_cbbg /(_bdc -_cbbg )*_aae ;_cda :=_cbb .Top +_efb ;_caf :=_ccg /_edb ;for _dfd ,_dab :=range _fcd {_fdfde :=_ba [_dab ];_fcgc :=float64 (len (_fdfde ._bdg ))+_fdf ;_ec :=_caf /_fcgc ;_fg :=_ec *_fdf ;_gge :=_cbb .Left +float64 (_dfd )*_caf +_fg /2;for _ ,_ece :=range _fdfde ._bdg {var _ebdc ,_dfcd float64 ;if _ece ._bea > 0{_dfcd =_ece ._bea /_bdc *_efb ;_ebdc =_cda -_dfcd ;_cb .drawRectangleWithProps (_ece ._eec ,_gge ,_ebdc ,_ec ,_dfcd ,false );}else {_dfcd =_ece ._bea /_cbbg *_bgf ;_cb .drawRectangleWithProps (_ece ._eec ,_gge ,_cda ,_ec ,_dfcd ,false );};_gge +=_ec ;};};};return _de ,nil ;};func AdjustColor (colorStr string ,EG_ColorTransform []*_c .EG_ColorTransform )string {for _ ,_ggff :=range EG_ColorTransform {if _daaf :=_ggff .Tint ;_daaf !=nil {if _ggcd :=_daaf .ValAttr .ST_PositiveFixedPercentageDecimal ;_ggcd !=nil {colorStr =AdjustColorByTint (colorStr ,float64 (*_ggcd )/100000);};};if _gadd :=_ggff .Shade ;_gadd !=nil {if _defa :=_gadd .ValAttr .ST_PositiveFixedPercentageDecimal ;_defa !=nil {colorStr =AdjustColorByShade (colorStr ,float64 (*_defa )/100000);};};if _eed :=_ggff .LumMod ;_eed !=nil {if _dgea :=_eed .ValAttr .ST_PercentageDecimal ;_dgea !=nil {colorStr =AdjustColorByLumMod (colorStr ,float64 (*_dgea )/100000);};};};return colorStr ;};func _aeb (_aebe _c .ST_SchemeColorVal ,_cdab *_c .Theme )string {if _aef :=_cdab .ThemeElements ;_aef !=nil {if _dag :=_aef .ClrScheme ;_dag !=nil {switch _aebe {case _c .ST_SchemeColorValLt1 :return GetColorStringFromDmlColor (_dag .Lt1 );case _c .ST_SchemeColorValDk1 ,_c .ST_SchemeColorValTx1 :return GetColorStringFromDmlColor (_dag .Dk1 );case _c .ST_SchemeColorValLt2 :return GetColorStringFromDmlColor (_dag .Lt2 );case _c .ST_SchemeColorValDk2 :return GetColorStringFromDmlColor (_dag .Dk2 );case _c .ST_SchemeColorValAccent1 :return GetColorStringFromDmlColor (_dag .Accent1 );case _c .ST_SchemeColorValAccent2 :return GetColorStringFromDmlColor (_dag .Accent2 );case _c .ST_SchemeColorValAccent3 :return GetColorStringFromDmlColor (_dag .Accent3 );case _c .ST_SchemeColorValAccent4 :return GetColorStringFromDmlColor (_dag .Accent4 );case _c .ST_SchemeColorValAccent5 :return GetColorStringFromDmlColor (_dag .Accent5 );case _c .ST_SchemeColorValAccent6 :return GetColorStringFromDmlColor (_dag .Accent6 );};};};return "";};func (_fcee *creatorContext )getPdfColorFromSolidFill (_eaff *_c .CT_SolidColorFillProperties )_ag .Color {if _eaff ==nil {return nil ;};_cgda :="";if _dbfb :=_eaff .SrgbClr ;_dbfb !=nil {_cgda =_dbfb .ValAttr ;}else if _bdaf :=_eaff .SchemeClr ;_bdaf !=nil {_cgda =_aeb (_bdaf .ValAttr ,_fcee ._cbba );};if _cgda ==""{return nil ;};return _ag .ColorRGBFromHex ("\u0023"+_cgda );};func FromSTPercentage (st *_c .ST_Percentage )float64 {if _baba :=st .ST_PercentageDecimal ;_baba !=nil {return float64 (*_baba )/100000;};return 0;};