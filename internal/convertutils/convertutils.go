//
// Copyright 2020 FoxyUtils ehf. All rights reserved.
//
// This is a commercial product and requires a license to operate.
// A trial license can be obtained at https://unidoc.io
//
// DO NOT EDIT: generated by unitwist Go source code obfuscator.
//
// Use of this source code is governed by the UniDoc End User License Agreement
// terms that can be accessed at https://unidoc.io/eula/

package convertutils ;import (_g "bytes";_ac "errors";_e "fmt";_fg "github.com/unidoc/unioffice/common/logger";_c "github.com/unidoc/unioffice/measurement";_db "github.com/unidoc/unioffice/schema/soo/dml";_eg "github.com/unidoc/unioffice/schema/soo/dml/chart";_cc "github.com/unidoc/unioffice/spreadsheet/format";_cf "github.com/unidoc/unipdf/v3/creator";_bee "github.com/unidoc/unipdf/v3/model";_bed "github.com/unidoc/unipdf/v3/render";_be "github.com/unidoc/unitype";_ab "image";_d "math";_ad "os";_b "sort";_fa "strconv";_dg "strings";_dc "sync";_f "unicode";);type legendItem struct{_bba string ;_bgd *_db .CT_ShapeProperties ;};const DefaultFontSize =12.0;var _cef =_agac (1);func (_fbf FontStyle )String ()string {return []string {"\u0052e\u0067\u0075\u006c\u0061\u0072","\u0042\u006f\u006c\u0064","\u0049\u0074\u0061\u006c\u0069\u0063","\u0042\u006f\u006c\u0064\u0049\u0074\u0061\u006c\u0069\u0063"}[int (_fbf )];};func RegisterFontsFromDirectory (dirName string )error {_cbcad ,_gcgg :=_ad .Open (dirName );if _gcgg !=nil {return _gcgg ;};defer _cbcad .Close ();_gcfd ,_gcgg :=_cbcad .Readdirnames (0);if _gcgg !=nil {return _gcgg ;};for _ ,_beddg :=range _gcfd {if _dg .HasSuffix (_beddg ,"\u002e\u0074\u0074\u0066"){_efd :=dirName +"\u002f"+_beddg ;_gdecd :=_cbbc (_efd );if _gdecd !=nil {_fg .Log .Debug ("\u0075\u006ea\u0062\u006c\u0065\u0020\u0074o\u0020\u0070\u0072\u006f\u0063e\u0073\u0073\u0020\u0061\u006e\u0064\u0020\u0072\u0065\u0067\u0069\u0073\u0074\u0065\u0072\u0020\u0066\u006f\u006e\u0074\u0020\u0066\u0072\u006f\u006d\u0020\u0054\u0054\u0046\u0020\u0066\u0069\u006c\u0065\u0020\u0025\u0073",_gdecd );continue ;};};};return nil ;};func _baaf (_fbc uint8 ,_cffa float64 )string {_gdf :=float64 (_fbc );var _gac float64 ;if _cffa < 0{_gac =_gdf *(1+_cffa );}else {_gac =_gdf +(255-_gdf )*_cffa ;};return _e .Sprintf ("\u0025\u0030\u0032\u0078",int (_gac ));};func _bebf (_aee float64 )float64 {if _aee < 0{_aee +=float64 (-int (_aee )+1);}else if _aee > 1{_aee -=float64 (int (_aee ));};return _aee ;};func FromSTPercentage (st *_db .ST_Percentage )float64 {if _bfed :=st .ST_PercentageDecimal ;_bfed !=nil {return float64 (*_bfed )/100000;};return 0;};func GetRegisteredFont (name string ,style FontStyle )*_bee .PdfFont {_bbb ._adbc .Lock ();defer _bbb ._adbc .Unlock ();if _dddg ,_eda :=_bbb ._bgb [name ];_eda {if _eeff ,_acdff :=_dddg [style ];_acdff {return _eeff ;};};return nil ;};func _fbd (_afbg _db .ST_SchemeColorVal ,_cfb *_db .Theme )string {if _ccfb :=_cfb .ThemeElements ;_ccfb !=nil {if _bae :=_ccfb .ClrScheme ;_bae !=nil {switch _afbg {case _db .ST_SchemeColorValLt1 :return GetColorStringFromDmlColor (_bae .Lt1 );case _db .ST_SchemeColorValDk1 ,_db .ST_SchemeColorValTx1 :return GetColorStringFromDmlColor (_bae .Dk1 );case _db .ST_SchemeColorValLt2 :return GetColorStringFromDmlColor (_bae .Lt2 );case _db .ST_SchemeColorValDk2 :return GetColorStringFromDmlColor (_bae .Dk2 );case _db .ST_SchemeColorValAccent1 :return GetColorStringFromDmlColor (_bae .Accent1 );case _db .ST_SchemeColorValAccent2 :return GetColorStringFromDmlColor (_bae .Accent2 );case _db .ST_SchemeColorValAccent3 :return GetColorStringFromDmlColor (_bae .Accent3 );case _db .ST_SchemeColorValAccent4 :return GetColorStringFromDmlColor (_bae .Accent4 );case _db .ST_SchemeColorValAccent5 :return GetColorStringFromDmlColor (_bae .Accent5 );case _db .ST_SchemeColorValAccent6 :return GetColorStringFromDmlColor (_bae .Accent6 );};};};return "";};const (ImgPart_whole ImgPart =0;ImgPart_t ImgPart =1;ImgPart_b ImgPart =2;ImgPart_l ImgPart =3;ImgPart_r ImgPart =4;ImgPart_lt ImgPart =5;ImgPart_rt ImgPart =6;ImgPart_lb ImgPart =7;ImgPart_rb ImgPart =8;);func (_gfcb *creatorContext )drawLineWithProps (_bcb *_db .CT_ShapeProperties ,_fddg ,_fdbcg ,_ceff ,_begb float64 ,_ggdf bool ){if _bcb !=nil {if _dcbb :=_bcb .Ln ;_dcbb !=nil {_ggfd :=_gfcb .getPdfColorFromSolidFill (_dcbb .SolidFill );if _ggfd ==nil &&_ggdf {_ggfd =_cf .ColorBlack ;};if _ggfd !=nil {var _gfaf float64 ;if _ccaa :=_dcbb .WAttr ;_ccaa !=nil {_gfaf =_c .FromEMU (int64 (*_ccaa ));}else {_gfaf =_ceg ;};DrawLine (_gfcb ._gaea ,_fddg ,_fdbcg ,_ceff ,_begb ,_gfaf ,_ggfd );};};};};func (_ff barSerByOrder )Swap (i ,j int ){_ff [i ],_ff [j ]=_ff [j ],_ff [i ]};func _agac (_eabb float64 )float64 {return _eabb *_c .Millimeter };func GetPageFromCreator (c *_cf .Creator )(*_bee .PdfPage ,error ){_abcg :=_g .NewBuffer ([]byte {});_ebc :=c .Write (_abcg );if _ebc !=nil {return nil ,_ebc ;};_eaec :=_g .NewReader (_abcg .Bytes ());_cdgb ,_ebc :=_bee .NewPdfReader (_eaec );if _ebc !=nil {return nil ,_ebc ;};return _cdgb .GetPage (1);};func MakeBlockFromChartSpace (cs *_eg .ChartSpace ,width ,height float64 ,theme *_db .Theme )(*_cf .Block ,error ){_bd ,_ece :=_cbc (cs ,width ,height ,theme ,false );if _ece !=nil {return nil ,_ece ;};_cgg ,_ece :=GetPageFromCreator (_bd );if _ece !=nil {return nil ,_ece ;};_cb ,_ece :=_cf .NewBlockFromPage (_cgg );if _ece !=nil {return nil ,_ece ;};return _cb ,nil ;};func (_gacg *Rectangle )Translate (x ,y float64 ){_gacg .Left +=x ;_gacg .Right +=x ;_gacg .Top +=y ;_gacg .Bottom +=y ;};func (_ccaeb *creatorContext )drawBorderWithProps (_abga *_db .CT_ShapeProperties ,_ffbe *Rectangle ,_gacc float64 ){if _ffbe !=nil &&_abga !=nil &&_abga .Ln !=nil &&_abga .Ln .SolidFill !=nil {_dac :=_ccaeb .getPdfColorFromSolidFill (_abga .Ln .SolidFill );DrawRectangle (_ccaeb ._gaea ,_ffbe ,_gacc ,_dac );};};func (_daf *creatorContext )drawLegend (_aag *Rectangle ,_afe []*legendItem ,_cbd bool ){_ggce :=_daf ._geb ;_dbe :=_agac (2.5)*_ggce ;_fda :=_agga *_ggce ;_gge :=(_dbe -_fda )/2;_ccca :=float64 (len (_afe ));if _cbd {_efe :=&Rectangle {Top :_aag .Top +_agac (1)*_ggce ,Bottom :_aag .Bottom -_agac (1)*_ggce ,Left :_aag .Left +_agac (2.5)*_ggce ,Right :_aag .Right -_agac (2.5)*_ggce };var _cba float64 ;if _ccca > 1{_cba =(_efe .Right -_efe .Left )/_ccca ;};_eae :=_efe .Left ;_fac :=_efe .Top ;for _ ,_bbf :=range _afe {if _dcg :=_bbf ._bgd ;_dcg !=nil {_daf .drawRectangleWithProps (_dcg ,_eae ,_fac +_gge ,_fda ,_fda ,false );_efbc :=_eae +_fda *2;_cea :=_daf ._gaea .NewStyledParagraph ();_cea .SetPos (_efbc ,_fac );_ecc :=_cea .Append (_bbf ._bba );_acgg ,_fde :=_bee .NewStandard14Font (_bee .HelveticaName );if _fde ==nil {_ecc .Style =_cf .TextStyle {FontSize :_dbe ,Font :_acgg ,TextRise :0.4};_daf ._gaea .Draw (_cea );};};_eae +=_cba ;};}else {_dgbg :=&Rectangle {Top :_aag .Top +_agac (2.5)*_ggce ,Bottom :_aag .Bottom -_agac (2.5)*_ggce ,Left :_aag .Left +_agac (2.5)*_ggce ,Right :_aag .Right -_agac (2.5)*_ggce };var _fae float64 ;if _ccca > 1{_fae =(_dgbg .Bottom -_dgbg .Top -_dbe )/(_ccca -1);};_acfg :=_dgbg .Top ;_deb :=_dgbg .Left ;_egdb :=_deb +_fda *2;for _ ,_cda :=range _afe {if _dcac :=_cda ._bgd ;_dcac !=nil {_daf .drawRectangleWithProps (_dcac ,_deb ,_acfg +_gge ,_fda ,_fda ,false );_aea :=_daf ._gaea .NewStyledParagraph ();_aea .SetPos (_egdb ,_acfg );_gfe :=_aea .Append (_cda ._bba );_gcg ,_egf :=_bee .NewStandard14Font (_bee .HelveticaName );if _egf ==nil {_gfe .Style =_cf .TextStyle {FontSize :_dbe ,Font :_gcg ,TextRise :0.4};_daf ._gaea .Draw (_aea );};};_acfg +=_fae ;};};};func GetOpacityFromColorTransform (trs []*_db .EG_ColorTransform )float64 {for _ ,_efcf :=range trs {if _efcf !=nil {if _fdbb :=_efcf .Alpha ;_fdbb !=nil {if _cacgc :=_fdbb .ValAttr .ST_PositiveFixedPercentageDecimal ;_cacgc !=nil {return float64 (*_cacgc )/100000;};};};};return 1.0;};const (BorderPositionTop BorderPosition =0;BorderPositionLeft BorderPosition =1;BorderPositionBottom BorderPosition =2;BorderPositionRight BorderPosition =3;);var _ddcc =_agac (5);func FromSTCoordinate32 (st _db .ST_Coordinate32 )int64 {if _adbd :=st .ST_Coordinate32Unqualified ;_adbd !=nil {return int64 (*_adbd );};return 0;};func _cgc (_caf *_eg .CT_DateAx )(uint32 ,_eg .ST_AxPos ,_eg .ST_TickMark ,_eg .ST_TickLblPos ,*_eg .CT_ChartLines ,uint32 ,*_db .CT_ShapeProperties ,error ){var _gfed ,_dege uint32 ;var _efff _eg .ST_AxPos ;var _abdf _eg .ST_TickMark ;var _bbg *_eg .CT_ChartLines ;var _cdbf _eg .ST_TickLblPos ;if _caf .AxId ==nil {return _gfed ,_efff ,_abdf ,_cdbf ,_bbg ,_dege ,_caf .SpPr ,_ac .New ("\u004e\u006f\u0020x\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");}else {_gfed =_caf .AxId .ValAttr ;};if _caf .AxPos ==nil {return _gfed ,_efff ,_abdf ,_cdbf ,_bbg ,_dege ,_caf .SpPr ,_ac .New ("\u004eo\u0020x\u0020\u0061\u0078\u0069\u0073 \u0070\u006fs\u0069\u0074\u0069\u006f\u006e");}else {_efff =_caf .AxPos .ValAttr ;};if _caf .MajorTickMark !=nil {_abdf =_caf .MajorTickMark .ValAttr ;};if _caf .TickLblPos !=nil {_cdbf =_caf .TickLblPos .ValAttr ;};if _caf .CrossAx ==nil {return _gfed ,_efff ,_abdf ,_cdbf ,_bbg ,_dege ,_caf .SpPr ,_ac .New ("\u004e\u006f \u0063\u0072\u006fs\u0073\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");}else {_dege =_caf .CrossAx .ValAttr ;};_bbg =_caf .MajorGridlines ;return _gfed ,_efff ,_abdf ,_cdbf ,_bbg ,_dege ,_caf .SpPr ,nil ;};type serValue struct{_ebd string ;_dde float64 ;_bac *_db .CT_ShapeProperties ;};func TwipsFromPoints (points float64 )float64 {return points /_c .Twips };func Lighten (clr float64 )float64 {return 0.6+0.4*clr };var _cdb =_agac (1.5);func (_gfb *Rectangle )scale (_ccfc float64 ){_gfb .Top *=_ccfc ;_gfb .Bottom *=_ccfc ;_gfb .Left *=_ccfc ;_gfb .Right *=_ccfc ;};func _gbde (_eefc *_eg .CT_CatAx )(uint32 ,_eg .ST_AxPos ,_eg .ST_TickMark ,_eg .ST_TickLblPos ,*_eg .CT_ChartLines ,uint32 ,*_db .CT_ShapeProperties ,error ){var _gecb ,_ace uint32 ;var _ebfe _eg .ST_AxPos ;var _efea _eg .ST_TickMark ;var _cag *_eg .CT_ChartLines ;var _cgde _eg .ST_TickLblPos ;if _eefc .AxId ==nil {return _gecb ,_ebfe ,_efea ,_cgde ,_cag ,_ace ,_eefc .SpPr ,_ac .New ("\u004e\u006f\u0020x\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");}else {_gecb =_eefc .AxId .ValAttr ;};if _eefc .AxPos ==nil {return _gecb ,_ebfe ,_efea ,_cgde ,_cag ,_ace ,_eefc .SpPr ,_ac .New ("\u004eo\u0020x\u0020\u0061\u0078\u0069\u0073 \u0070\u006fs\u0069\u0074\u0069\u006f\u006e");}else {_ebfe =_eefc .AxPos .ValAttr ;};if _eefc .MajorTickMark !=nil {_efea =_eefc .MajorTickMark .ValAttr ;};if _eefc .TickLblPos !=nil {_cgde =_eefc .TickLblPos .ValAttr ;};if _eefc .CrossAx ==nil {return _gecb ,_ebfe ,_efea ,_cgde ,_cag ,_ace ,_eefc .SpPr ,_ac .New ("\u004e\u006f \u0063\u0072\u006fs\u0073\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");}else {_ace =_eefc .CrossAx .ValAttr ;};_cag =_eefc .MajorGridlines ;return _gecb ,_ebfe ,_efea ,_cgde ,_cag ,_ace ,_eefc .SpPr ,nil ;};func (_de barSerByOrder )Less (i ,j int )bool {return _de [i ].Order .ValAttr < _de [j ].Order .ValAttr };var _bgeg =_agac (0.5);func AssignStdFontByName (style _cf .TextStyle ,fontName string )*_bee .PdfFont {_gdga :=_bee .StdFontName (fontName );return _bee .NewStandard14FontMustCompile (_gdga );};func CropImageByRect (sourceImg _ab .Image ,rect _ab .Rectangle )_ab .Image {_eaa ,_aca ,_cbeg ,_bcgd :=rect .Min .X ,rect .Min .Y ,rect .Max .X ,rect .Max .Y ;_gffg :=_ab .NewNRGBA (_ab .Rect (0,0,_cbeg -_eaa ,_bcgd -_aca ));for _aegb :=_eaa ;_aegb < _cbeg ;_aegb ++{for _edb :=_aca ;_edb < _bcgd ;_edb ++{_gffg .Set (_aegb -_eaa ,_edb -_aca ,sourceImg .At (_aegb ,_edb ));};};return _gffg ;};var _agga =_agac (1.5);func DrawRectangle (c *_cf .Creator ,r *Rectangle ,w float64 ,color _cf .Color ){if color ==nil {return ;};DrawLine (c ,r .Left ,r .Top ,r .Right ,r .Top ,w ,color );DrawLine (c ,r .Left ,r .Top ,r .Left ,r .Bottom ,w ,color );DrawLine (c ,r .Left ,r .Bottom ,r .Right ,r .Bottom ,w ,color );DrawLine (c ,r .Right ,r .Top ,r .Right ,r .Bottom ,w ,color );};func FromSTCoordinate (st _db .ST_Coordinate )int64 {if _fcf :=st .ST_CoordinateUnqualified ;_fcf !=nil {return *_fcf ;};return 0;};var StdFontsMap =map[string ][]string {"\u0048e\u006c\u0076\u0065\u0074\u0069\u0063a":[]string {"\u0048e\u006c\u0076\u0065\u0074\u0069\u0063a","\u0048\u0065\u006c\u0076\u0065\u0074\u0069\u0063\u0061-\u0042\u006f\u006c\u0064","\u0048\u0065\u006c\u0076\u0065\u0074\u0069\u0063\u0061\u002d\u004f\u0062l\u0069\u0071\u0075\u0065","H\u0065\u006c\u0076\u0065ti\u0063a\u002d\u0042\u006f\u006c\u0064O\u0062\u006c\u0069\u0071\u0075\u0065"},"\u0043o\u0075\u0072\u0069\u0065\u0072":[]string {"\u0043o\u0075\u0072\u0069\u0065\u0072","\u0043\u006f\u0075r\u0069\u0065\u0072\u002d\u0042\u006f\u006c\u0064","\u0043o\u0075r\u0069\u0065\u0072\u002d\u004f\u0062\u006c\u0069\u0071\u0075\u0065","\u0043\u006f\u0075\u0072ie\u0072\u002d\u0042\u006f\u006c\u0064\u004f\u0062\u006c\u0069\u0071\u0075\u0065"},"\u0054i\u006de\u0073\u0020\u004e\u0065\u0077\u0020\u0052\u006f\u006d\u0061\u006e":[]string {"T\u0069\u006d\u0065\u0073\u002d\u0052\u006f\u006d\u0061\u006e","\u0054\u0069\u006d\u0065\u0073\u002d\u0042\u006f\u006c\u0064","\u0054\u0069\u006de\u0073\u002d\u0049\u0074\u0061\u006c\u0069\u0063","\u0054\u0069m\u0065\u0073\u002dB\u006f\u006c\u0064\u0049\u0074\u0061\u006c\u0069\u0063"},"\u0064e\u0066\u0061\u0075\u006c\u0074":[]string {"\u0048e\u006c\u0076\u0065\u0074\u0069\u0063a","\u0048\u0065\u006c\u0076\u0065\u0074\u0069\u0063\u0061-\u0042\u006f\u006c\u0064","\u0048\u0065\u006c\u0076\u0065\u0074\u0069\u0063\u0061\u002d\u004f\u0062l\u0069\u0071\u0075\u0065","H\u0065\u006c\u0076\u0065ti\u0063a\u002d\u0042\u006f\u006c\u0064O\u0062\u006c\u0069\u0071\u0075\u0065"}};func GetImage (c *_cf .Creator ,goImg _ab .Image ,imgHeight ,imgWidth ,left ,top ,dividerX ,dividerY float64 ,part ImgPart )(*_cf .Image ,error ){if goImg ==nil {return nil ,nil ;};_bbff :=goImg .Bounds ().Size ();_aeg :=_bbff .X ;_beda :=_bbff .Y ;if dividerX !=0{dividerX =dividerX /imgWidth *float64 (_aeg );};if dividerY !=0{dividerY =dividerY /imgHeight *float64 (_beda );};var _fdg _ab .Rectangle ;switch part {case ImgPart_t :_fdg =_ab .Rect (0,0,_aeg ,int (dividerY ));case ImgPart_b :_fdg =_ab .Rect (0,int (dividerY ),_aeg ,_beda );case ImgPart_l :_fdg =_ab .Rect (0,0,int (dividerX ),_beda );case ImgPart_r :_fdg =_ab .Rect (int (dividerX ),0,_aeg ,_beda );case ImgPart_lt :_fdg =_ab .Rect (0,0,int (dividerX ),int (dividerY ));case ImgPart_rt :_fdg =_ab .Rect (int (dividerX ),0,_aeg ,int (dividerY ));case ImgPart_lb :_fdg =_ab .Rect (0,int (dividerY ),int (dividerX ),_beda );case ImgPart_rb :_fdg =_ab .Rect (int (dividerX ),int (dividerY ),_aeg ,_beda );default:_fdg =_ab .Rect (0,0,_aeg ,_beda );};_caae :=CropImageByRect (goImg ,_fdg );_efad ,_dgac :=c .NewImageFromGoImage (_caae );if _dgac !=nil {return nil ,_dgac ;};_efad .Scale (imgWidth /float64 (_aeg ),imgHeight /float64 (_beda ));_efad .SetPos (left ,top );return _efad ,nil ;};type Rectangle struct{Top float64 ;Bottom float64 ;Left float64 ;Right float64 ;};var _dgdg =map[string ]FontStyle {"\u0052e\u0067\u0075\u006c\u0061\u0072":FontStyle_Regular ,"\u0042\u006f\u006c\u0064":FontStyle_Bold ,"\u0049\u0074\u0061\u006c\u0069\u0063":FontStyle_Italic ,"B\u006f\u006c\u0064\u0020\u0049\u0074\u0061\u006c\u0069\u0063":FontStyle_BoldItalic };func _agaa (_ccdd *_eg .CT_ValAx )(uint32 ,_eg .ST_AxPos ,_eg .ST_TickMark ,_eg .ST_TickLblPos ,*_eg .CT_ChartLines ,uint32 ,*_db .CT_ShapeProperties ,error ){var _fb ,_aff uint32 ;var _eea _eg .ST_AxPos ;var _cagb _eg .ST_TickMark ;var _fff *_eg .CT_ChartLines ;var _dbfe _eg .ST_TickLblPos ;if _ccdd .AxId ==nil {return _fb ,_eea ,_cagb ,_dbfe ,_fff ,_aff ,_ccdd .SpPr ,_ac .New ("\u004e\u006f\u0020x\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");}else {_fb =_ccdd .AxId .ValAttr ;};if _ccdd .AxPos ==nil {return _fb ,_eea ,_cagb ,_dbfe ,_fff ,_aff ,_ccdd .SpPr ,_ac .New ("\u004eo\u0020x\u0020\u0061\u0078\u0069\u0073 \u0070\u006fs\u0069\u0074\u0069\u006f\u006e");}else {_eea =_ccdd .AxPos .ValAttr ;};if _ccdd .MajorTickMark !=nil {_cagb =_ccdd .MajorTickMark .ValAttr ;};if _ccdd .TickLblPos !=nil {_dbfe =_ccdd .TickLblPos .ValAttr ;};if _ccdd .CrossAx ==nil {return _fb ,_eea ,_cagb ,_dbfe ,_fff ,_aff ,_ccdd .SpPr ,_ac .New ("\u004e\u006f \u0063\u0072\u006fs\u0073\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");}else {_aff =_ccdd .CrossAx .ValAttr ;};_fff =_ccdd .MajorGridlines ;return _fb ,_eea ,_cagb ,_dbfe ,_fff ,_aff ,_ccdd .SpPr ,nil ;};func _dfd (_ccf _db .ST_SchemeColorVal ,_dadb *_db .Theme )string {if _dec :=_dadb .ThemeElements ;_dec !=nil {if _bga :=_dec .ClrScheme ;_bga !=nil {switch _ccf {case _db .ST_SchemeColorValLt1 :return GetColorStringFromDmlColor (_bga .Lt1 );case _db .ST_SchemeColorValDk1 ,_db .ST_SchemeColorValTx1 :return GetColorStringFromDmlColor (_bga .Dk1 );case _db .ST_SchemeColorValLt2 :return GetColorStringFromDmlColor (_bga .Lt2 );case _db .ST_SchemeColorValDk2 :return GetColorStringFromDmlColor (_bga .Dk2 );case _db .ST_SchemeColorValAccent1 :return GetColorStringFromDmlColor (_bga .Accent1 );case _db .ST_SchemeColorValAccent2 :return GetColorStringFromDmlColor (_bga .Accent2 );case _db .ST_SchemeColorValAccent3 :return GetColorStringFromDmlColor (_bga .Accent3 );case _db .ST_SchemeColorValAccent4 :return GetColorStringFromDmlColor (_bga .Accent4 );case _db .ST_SchemeColorValAccent5 :return GetColorStringFromDmlColor (_bga .Accent5 );case _db .ST_SchemeColorValAccent6 :return GetColorStringFromDmlColor (_bga .Accent6 );};};};return "";};func AdjustColor (colorStr string ,EG_ColorTransform []*_db .EG_ColorTransform )string {for _ ,_abee :=range EG_ColorTransform {if _cfaa :=_abee .Tint ;_cfaa !=nil {if _cbb :=_cfaa .ValAttr .ST_PositiveFixedPercentageDecimal ;_cbb !=nil {colorStr =AdjustColorByTint (colorStr ,float64 (*_cbb )/100000);};};if _cee :=_abee .Shade ;_cee !=nil {if _gcca :=_cee .ValAttr .ST_PositiveFixedPercentageDecimal ;_gcca !=nil {colorStr =AdjustColorByShade (colorStr ,float64 (*_gcca )/100000);};};if _bfca :=_abee .LumMod ;_bfca !=nil {if _abda :=_bfca .ValAttr .ST_PercentageDecimal ;_abda !=nil {colorStr =AdjustColorByLumMod (colorStr ,float64 (*_abda )/100000);};};};return colorStr ;};func MakeTempCreator (width ,height float64 )*_cf .Creator {_cdd :=_cf .New ();_cdd .SetPageSize (_cf .PageSize {width ,height });_cdd .SetPageMargins (0,0,0,0);return _cdd ;};func IsNoSpaceLanguage (symbol string )bool {for _ ,_afaf :=range symbol {if _f .Is (_f .Han ,_afaf ){return true ;};};return false ;};type ImgPart byte ;type fontsMap struct{_adbc *_dc .Mutex ;_bgb map[string ]map[FontStyle ]*_bee .PdfFont ;};func RegisterFontsFromFiles (files []string )error {for _ ,_gdg :=range files {if _dg .HasSuffix (_gdg ,"\u002e\u0074\u0074\u0066"){_gee :=_cbbc (_gdg );if _gee !=nil {_fg .Log .Debug ("\u0075\u006ea\u0062\u006c\u0065\u0020\u0074o\u0020\u0070\u0072\u006f\u0063e\u0073\u0073\u0020\u0061\u006e\u0064\u0020\u0072\u0065\u0067\u0069\u0073\u0074\u0065\u0072\u0020\u0066\u006f\u006e\u0074\u0020\u0066\u0072\u006f\u006d\u0020\u0054\u0054\u0046\u0020\u0066\u0069\u006c\u0065\u0020\u0025\u0073",_gee );continue ;};};};return nil ;};func GetColorStringFromDmlColor (dmlColor *_db .CT_Color )string {var _effb string ;if _adb :=dmlColor .SrgbClr ;_adb !=nil {_effb =_adb .ValAttr ;}else if _cfc :=dmlColor .SysClr ;_cfc !=nil {return "\u0030\u0030\u0030\u0030\u0030\u0030";};return _effb ;};func (_ba *creatorContext )drawBarChart (_ec *_eg .CT_BarChart ,_gg *Rectangle ,_bede *_eg .CT_PlotAreaChoice1 )([]*legendItem ,error ){var _af bool ;if _ef :=_ec .BarDir ;_ef !=nil {_af =_ef .ValAttr ==_eg .ST_BarDirBar ;};_aa :=_ec .Ser ;_b .Sort (barSerByOrder (_aa ));_acg :=map[string ]serCategory {};_eb :=[]string {};_gd :=[]*legendItem {};_acgf :=_d .Inf (1);_ee :=_d .Inf (-1);for _ ,_ae :=range _aa {var _df string ;if _acd :=_ae .Tx ;_acd !=nil {if _dca :=_acd .Choice ;_dca !=nil {if _dca .V !=nil {_df =*_dca .V ;}else if _abg :=_dca .StrRef ;_abg !=nil {if _gde :=_abg .StrCache ;_gde !=nil {for _ ,_fgf :=range _gde .Pt {_df =_fgf .V ;};};};};};if _dd :=_ae .Cat ;_dd !=nil {if _fgc :=_dd .Choice ;_fgc !=nil {if _ccd :=_fgc .StrRef ;_ccd !=nil {if _bg :=_ccd .StrCache ;_bg !=nil {for _ ,_da :=range _bg .Pt {_ddf :=_da .V ;if _ ,_acdf :=_acg [_ddf ];!_acdf {_acg [_ddf ]=serCategory {_ccb :_ddf ,_bcc :[]serValue {}};_eb =append (_eb ,_ddf );};};};}else if _gb :=_fgc .NumRef ;_gb !=nil {if _dff :=_gb .NumCache ;_dff !=nil {var _cff string ;if _dff .FormatCode !=nil {_cff =*_dff .FormatCode ;};for _ ,_cg :=range _dff .Pt {var _ccg string ;if _cg .FormatCodeAttr ==nil {_ccg =_cff ;}else {_ccg =*_cg .FormatCodeAttr ;};var _ccc string ;_fd ,_cca :=_fa .ParseFloat (_cg .V ,64);if _cca !=nil {_ccc =_cg .V ;}else {_ccc =_cc .Number (_fd ,_ccg );};if _ ,_ebf :=_acg [_ccc ];!_ebf {_acg [_ccc ]=serCategory {_ccb :_ccc ,_bcc :[]serValue {}};_eb =append (_eb ,_ccc );};};};};};};if _acdc :=_ae .Val ;_acdc !=nil {if _ga :=_acdc .Choice ;_ga !=nil {if _ag :=_ga .NumRef ;_ag !=nil {if _dge :=_ag .NumCache ;_dge !=nil {for _dbf ,_dad :=range _dge .Pt {_ca ,_agb :=_fa .ParseFloat (_dad .V ,64);if _agb !=nil {_ca =0;_fg .Log .Debug ("\u0070a\u0072s\u0065\u0020\u0065\u0072\u0072\u006f\u0072\u003a\u0020\u0025\u0073",_agb );};if _ca > _ee {_ee =_ca ;};if _ca < _acgf {_acgf =_ca ;};_cgb :=_acg [_eb [_dbf ]];_cgb ._bcc =append (_cgb ._bcc ,serValue {_ebd :_df ,_dde :_ca ,_bac :_ae .SpPr });_acg [_eb [_dbf ]]=_cgb ;};};};};};_gd =append (_gd ,&legendItem {_bba :_df ,_bgd :_ae .SpPr });};var _eba float64 ;var _dbc ,_aga float64 ;if _ee ==0&&_acgf ==0{_eba =0.2;_aga =0;_dbc =1;}else {var _ecb float64 ;if _eee :=_d .Abs (_acgf );_ee < _eee {_ecb =_eee ;}else {_ecb =_ee ;};_ea :=_d .Pow (10,_d .Floor (_d .Log10 (_ecb )));_efc :=_ecb /_ea ;if _efc >=1.715&&_efc < 4.29{_eba =0.5;}else if _efc >=4.29&&_efc < 8.58{_eba =1;}else {_eba =2;};_eba *=_ea ;if _ee <=0{_dbc =0;}else {_dbc =(_d .Ceil (_ee /_eba )+1)*_eba ;};if _acgf >=0{_aga =0;}else {_aga =(_d .Floor (_acgf /_eba )-1)*_eba ;};};_fdb :=_ba .drawAxes (_bede ,_aga ,_dbc ,_eba ,_eb ,_gg ,_af );if _fdb !=nil {return nil ,_fdb ;};_bb :=0.0;if _ec .GapWidth !=nil {if _egd :=_ec .GapWidth .ValAttr ;_egd !=nil {if _baf :=_egd .ST_GapAmountUShort ;_baf !=nil {_bb =float64 (*_baf )/100.0;};};};_cad :=_gg .Right -_gg .Left ;_abc :=_gg .Bottom -_gg .Top ;_dfg :=float64 (len (_eb ));if _af {_cd :=_dbc /(_dbc -_aga )*_cad ;_abf :=-_aga /(_dbc -_aga )*_cad ;_cade :=_gg .Left +_abf ;_bf :=_abc /_dfg ;for _ggc ,_agg :=range _eb {_dcf :=_acg [_agg ];_ggg :=float64 (len (_dcf ._bcc ))+_bb ;_eeg :=_bf /_ggg ;_bce :=_eeg *_bb ;_dgd :=_gg .Bottom -float64 (_ggc )*_bf -_bce /2-_eeg ;for _ ,_aeb :=range _dcf ._bcc {if _aeb ._dde ==0{continue ;};var _bgf ,_cdg float64 ;if _aeb ._dde > 0{_cdg =_aeb ._dde /_dbc *_cd ;_ba .drawRectangleWithProps (_aeb ._bac ,_cade ,_dgd ,_cdg ,_eeg ,false );}else {_cdg =_aeb ._dde /_aga *_abf ;_bgf =_cade -_cdg ;_ba .drawRectangleWithProps (_aeb ._bac ,_bgf ,_dgd ,_cdg ,_eeg ,false );};_dgd -=_eeg ;};};}else {_beec :=_dbc /(_dbc -_aga )*_abc ;_ggd :=-_aga /(_dbc -_aga )*_abc ;_gec :=_gg .Top +_beec ;_ccae :=_cad /_dfg ;for _agd ,_fc :=range _eb {_ed :=_acg [_fc ];_dag :=float64 (len (_ed ._bcc ))+_bb ;_eege :=_ccae /_dag ;_abge :=_eege *_bb ;_egg :=_gg .Left +float64 (_agd )*_ccae +_abge /2;for _ ,_eff :=range _ed ._bcc {var _gc ,_ecf float64 ;if _eff ._dde > 0{_ecf =_eff ._dde /_dbc *_beec ;_gc =_gec -_ecf ;_ba .drawRectangleWithProps (_eff ._bac ,_egg ,_gc ,_eege ,_ecf ,false );}else {_ecf =_eff ._dde /_aga *_ggd ;_ba .drawRectangleWithProps (_eff ._bac ,_egg ,_gec ,_eege ,_ecf ,false );};_egg +=_eege ;};};};return _gd ,nil ;};func DrawLine (c *_cf .Creator ,x0 ,y0 ,x1 ,y1 ,width float64 ,color _cf .Color ){if color ==nil {return ;};_dgde :=c .NewLine (x0 ,y0 ,x1 ,y1 );_dgde .SetLineWidth (width );_dgde .SetColor (color );c .Draw (_dgde );};type creatorContext struct{_gaea *_cf .Creator ;_fdfg *_db .Theme ;_geb float64 ;};func RegisterFont (name string ,style FontStyle ,font *_bee .PdfFont ){_bbb ._adbc .Lock ();if _bbb ._bgb [name ]==nil {_bbb ._bgb [name ]=map[FontStyle ]*_bee .PdfFont {};};_bbb ._bgb [name ][style ]=font ;_bbb ._adbc .Unlock ();};func (_cbbf *creatorContext )drawRectangleWithProps (_eddf *_db .CT_ShapeProperties ,_bccd ,_ebcg ,_gbe ,_add float64 ,_aeee bool ){_cdbbe :=_cbbf ._gaea .NewRectangle (_bccd ,_ebcg ,_gbe ,_add );if _eddf ==nil {if _aeee {_cdbbe .SetBorderWidth (_ceg );}else {return ;};}else {_dcaf :=_cbbf .getPdfColorFromSolidFill (_eddf .SolidFill );if _dcaf !=nil {_cdbbe .SetFillColor (_dcaf );};if _age :=_eddf .Ln ;_age !=nil {if _ccba :=_age .WAttr ;_ccba !=nil {_bade :=_c .FromEMU (int64 (*_ccba ));_cdbbe .SetBorderWidth (_bade );if _bfee :=_age .SolidFill ;_bfee !=nil {_cbbcb :=_cbbf .getPdfColorFromSolidFill (_bfee );if _cbbcb !=nil {_cdbbe .SetBorderColor (_cbbcb );};};}else {_cdbbe .SetBorderWidth (0);};};};_cbbf ._gaea .Draw (_cdbbe );};func AdjustColorByTint (colorStr string ,tint float64 )string {var _dcc ,_dega ,_fafb uint8 ;_fadf ,_ :=_e .Sscanf (colorStr ,"\u0025\u0030\u0032x\u0025\u0030\u0032\u0078\u0025\u0030\u0032\u0078",&_dcc ,&_dega ,&_fafb );if _fadf !=3{return "";};return _baaf (_dcc ,tint )+_baaf (_dega ,tint )+_baaf (_fafb ,tint );};func AdjustColorByLumMod (colorStr string ,lum float64 )string {var _gdfc ,_ggdb ,_cab uint8 ;_fga ,_ :=_e .Sscanf (colorStr ,"\u0025\u0030\u0032x\u0025\u0030\u0032\u0078\u0025\u0030\u0032\u0078",&_gdfc ,&_ggdb ,&_cab );if _fga !=3{return "";};_bdc ,_ggef ,_dfe :=_affd (_gdfc ,_ggdb ,_cab );_dfe =lum *_dfe ;_gdfc ,_ggdb ,_cab =_dadf (_bdc ,_ggef ,_dfe );return _e .Sprintf ("\u0025\u0030\u0032x\u0025\u0030\u0032\u0078\u0025\u0030\u0032\u0078",_gdfc ,_ggdb ,_cab );};func _cdgd (_fbcf uint8 ,_cggb float64 )string {_bbfb :=float64 (_fbcf );return _e .Sprintf ("\u0025\u0030\u0032\u0078",int (_bbfb *_cggb ));};func AdjustColorByShade (colorStr string ,shade float64 )string {var _bcef ,_fadd ,_cecc uint8 ;_gcf ,_ :=_e .Sscanf (colorStr ,"\u0025\u0030\u0032x\u0025\u0030\u0032\u0078\u0025\u0030\u0032\u0078",&_bcef ,&_fadd ,&_cecc );if _gcf !=3{return "";};return _cdgd (_bcef ,shade )+_cdgd (_fadd ,shade )+_cdgd (_cecc ,shade );};func (_gbb *creatorContext )drawAxes (_eabc *_eg .CT_PlotAreaChoice1 ,_gbf ,_ege ,_cdbc float64 ,_dagg []string ,_ceb *Rectangle ,_fdc bool )error {_gea :=_gbb ._gaea ;_fcb :=_gbb ._geb ;if _eabc ==nil {return _ac .New ("\u004e\u006f\u0020\u0061xi\u0073\u0020\u0069\u006e\u0066\u006f\u0072\u006d\u0061\u0074\u0069\u006f\u006e");};if len (_eabc .ValAx )==0||(len (_eabc .CatAx )==0&&len (_eabc .DateAx )==0&&len (_eabc .SerAx )==0){return _ac .New ("\u004e\u006f\u0020\u0078\u0020\u006f\u0072\u0020\u0079 \u0061\u0078\u0069\u0073");};var _ccbf ,_bcf ,_cbca ,_ccdc uint32 ;var _bacf ,_bfc _eg .ST_AxPos ;var _cga ,_cae _eg .ST_TickMark ;var _fcg ,_bgg *_eg .CT_ChartLines ;var _ega ,_gdec _eg .ST_TickLblPos ;var _cec ,_eggd *_db .CT_ShapeProperties ;var _acda error ;_edd :=_ceb .Right -_ceb .Left ;_fee :=_ceb .Bottom -_ceb .Top ;if len (_eabc .ValAx )> 0{_bcf ,_bfc ,_cae ,_gdec ,_bgg ,_ccdc ,_eggd ,_acda =_agaa (_eabc .ValAx [0]);};if _bfc !=_eg .ST_AxPosL &&_bfc !=_eg .ST_AxPosB {return _ac .New ("\u004f\u006e\u006c\u0079\u0020l\u0065\u0066\u0074\u0020\u006f\u0072\u0020\u0062\u006f\u0074\u0074\u006f\u006d \u0079\u0020\u0061\u0078\u0069\u0073\u0020\u0073\u0075\u0070\u0070\u006f\u0072\u0074\u0020\u0073\u006f\u0020\u0066\u0061\u0072");};_dcb :=_ege -_gbf ;_gdd :=int (_dcb /_cdbc )+1;var _cecg ,_abgc float64 ;switch _cae {case _eg .ST_TickMarkIn :_cecg ,_abgc =_cef ,0;case _eg .ST_TickMarkOut :_cecg ,_abgc =0,_cef ;case _eg .ST_TickMarkCross :_cecg ,_abgc =_cef ,_cef ;};_cecg =_cecg *_fcb ;_abgc =_abgc *_fcb ;var _gbc *_db .CT_ShapeProperties ;if _bgg !=nil {_gbc =_bgg .SpPr ;};_cada ,_deg :=_ega !=_eg .ST_TickLblPosNone ,_gdec !=_eg .ST_TickLblPosNone ;_gca :=_gbf ;if len (_eabc .CatAx )> 0{_ccbf ,_bacf ,_cga ,_ega ,_fcg ,_cbca ,_cec ,_acda =_gbde (_eabc .CatAx [0]);}else if len (_eabc .DateAx )> 0{_ccbf ,_bacf ,_cga ,_ega ,_fcg ,_cbca ,_cec ,_acda =_cgc (_eabc .DateAx [0]);}else if len (_eabc .SerAx )> 0{_ccbf ,_bacf ,_cga ,_ega ,_fcg ,_cbca ,_cec ,_acda =_ddd (_eabc .SerAx [0]);};if _acda !=nil {return _acda ;};if _bacf !=_eg .ST_AxPosL &&_bacf !=_eg .ST_AxPosB {return _ac .New ("\u004f\u006e\u006c\u0079\u0020l\u0065\u0066\u0074\u0020\u006f\u0072\u0020\u0062\u006f\u0074\u0074\u006f\u006d \u0078\u0020\u0061\u0078\u0069\u0073\u0020\u0073\u0075\u0070\u0070\u006f\u0072\u0074\u0020\u0073\u006f\u0020\u0066\u0061\u0072");};if _ccbf !=_ccdc ||_bcf !=_cbca {return _ac .New ("a\u0078i\u0073\u0020\u0069\u0064\u0073\u0020\u0064\u006fn\u0027\u0074\u0020\u006dat\u0063\u0068");};_ggeg :=len (_dagg )+1;var _cac ,_dfb float64 ;switch _cga {case _eg .ST_TickMarkIn :_cac ,_dfb =_cef ,0;case _eg .ST_TickMarkOut :_cac ,_dfb =0,_cef ;case _eg .ST_TickMarkCross :_cac ,_dfb =_cef ,_cef ;};_cac =_cac *_fcb ;_dfb =_dfb *_fcb ;var _afef *_db .CT_ShapeProperties ;if _fcg !=nil {_afef =_fcg .SpPr ;};if _fdc {_eega :=_fee /float64 (len (_dagg ));_dga :=_ceb .Left -_gbf *_edd /_dcb ;_gdc :=_dga -_fdf *_fcb ;if _cada {var _cgf float64 ;for _abae :=0;_abae < _ggeg ;_abae ++{_adf :=_ceb .Bottom -float64 (_abae )*_eega ;if _abae < _ggeg -1{_cdge :=_gea .NewParagraph (_dagg [_abae ]);_cdge .SetFontSize (_cgdf *_fcb );_cdge .SetPos (_gdc ,_adf -_eega /2-_cdb *_fcb );_gea .Draw (_cdge );_ffe :=(_cdge .Width ()/1000-_fdf )*_fcb ;if _ffe > 0&&_ffe > _cgf {_cgf =_ffe ;};};};if _cgf > 0{_ceb .Left +=_cgf +_gad ;_dga =_ceb .Left -_gbf *_edd /_dcb ;_edd =_ceb .Right -_ceb .Left ;};};_ffb :=_dga -_dfb ;_abd :=_dga +_cac ;_dbcc :=_ceb .Left ;_egdg :=_ceb .Right ;for _gfa :=0;_gfa < _ggeg ;_gfa ++{_agdf :=_ceb .Bottom -float64 (_gfa )*_eega ;_gbb .drawLineWithProps (_cec ,_ffb ,_agdf ,_abd ,_agdf ,true );_gbb .drawLineWithProps (_afef ,_dbcc ,_agdf ,_egdg ,_agdf ,true );};_egad :=_edd /_dcb ;_cdbg :=_ceb .Bottom -_cecg ;_gae :=_ceb .Bottom +_abgc ;_cacg :=_ceb .Top ;_baa :=_ceb .Bottom ;for _eef :=0;_eef < _gdd ;_eef ++{_adg :=_ceb .Left +(_gca -_gbf )*_egad ;_gbb .drawLineWithProps (_eggd ,_adg ,_cdbg ,_adg ,_gae ,true );_gbb .drawLineWithProps (_gbc ,_adg ,_cacg ,_adg ,_baa ,true );if _deg {_ede :=_gea .NewParagraph (_fa .FormatFloat (_gca ,'g',-1,64));_ede .SetFontSize (_cgdf *_fcb );_ede .SetPos (_adg -_bgeg *_fcb ,_baa +_dgc *_fcb );_gea .Draw (_ede );};_gca +=_cdbc ;};}else {_ggga :=_fee /_dcb ;_ffeg :=_ceb .Left ;if _deg {var _bfa float64 ;for _abe :=0;_abe < _gdd ;_abe ++{_ada :=_ceb .Bottom -(_gca -_gbf )*_ggga ;_egge :=_gea .NewParagraph (_fa .FormatFloat (_gca ,'g',-1,64));_egge .SetFontSize (_cgdf *_fcb );_egge .SetPos (_ffeg -_fdf *_fcb ,_ada -_cdb *_fcb );_gea .Draw (_egge );_ccbfe :=(_egge .Width ()/1000-_fdf )*_fcb ;if _ccbfe > 0&&_ccbfe > _bfa {_bfa =_ccbfe ;};_gca +=_cdbc ;};if _bfa > 0{_ceb .Left +=_bfa +_gad ;_edd =_ceb .Right -_ceb .Left ;};};_gca =_gbf ;_fge :=_ceb .Left -_abgc ;_ccdg :=_ceb .Left +_cecg ;_ffeg =_ceb .Left ;_fad :=_ceb .Right ;for _ggcd :=0;_ggcd < _gdd ;_ggcd ++{_afb :=_ceb .Bottom -(_gca -_gbf )*_ggga ;_gbb .drawLineWithProps (_eggd ,_fge ,_afb ,_ccdg ,_afb ,true );_gbb .drawLineWithProps (_gbc ,_ffeg ,_afb ,_fad ,_afb ,true );_gca +=_cdbc ;};_dcbc :=_edd /float64 (len (_dagg ));_gfc :=_ceb .Bottom +_gbf *_fee /_dcb ;_gbd :=_gfc -_cac ;_bafg :=_gfc +_dfb ;_dae :=_ceb .Top ;_bad :=_ceb .Bottom ;_ccgf :=_gfc +_dgc *_fcb ;for _agbf :=0;_agbf < _ggeg ;_agbf ++{_cccc :=_ceb .Left +float64 (_agbf )*_dcbc ;_gbb .drawLineWithProps (_cec ,_cccc ,_gbd ,_cccc ,_bafg ,true );_gbb .drawLineWithProps (_afef ,_cccc ,_dae ,_cccc ,_bad ,true );if _cada &&_agbf < _ggeg -1{_fgea :=_gea .NewParagraph (_dagg [_agbf ]);_fgea .SetFontSize (_cgdf *_fcb );_fgea .SetPos (_cccc +_ddcc *_fcb ,_ccgf );_gea .Draw (_fgea );};};};return nil ;};func PointsFromTwips (twips int64 )float64 {return float64 (int64 (float64 (twips )*_c .Twips *10+0.5))/10};type barSerByOrder []*_eg .CT_BarSer ;type FontStyle byte ;func (_acf barSerByOrder )Len ()int {return len (_acf )};type serCategory struct{_ccb string ;_bcc []serValue ;};const (FontStyle_Regular FontStyle =0;FontStyle_Bold FontStyle =1;FontStyle_Italic FontStyle =2;FontStyle_BoldItalic FontStyle =3;);var _fdf =_agac (7.5);func GetDataFromXfrm (xfrm *_db .CT_Transform2D )(float64 ,float64 ,float64 ,float64 ){var _cgfc ,_dgga ,_efgd ,_cbfa float64 ;if _ccag :=xfrm .Off ;_ccag !=nil {_cgfc =_c .FromEMU (FromSTCoordinate (_ccag .XAttr ));_dgga =_c .FromEMU (FromSTCoordinate (_ccag .YAttr ));};if _gcgd :=xfrm .Ext ;_gcgd !=nil {_efgd =_c .FromEMU (_gcgd .CxAttr );_cbfa =_c .FromEMU (_gcgd .CyAttr );};return _cgfc ,_dgga ,_efgd ,_cbfa ;};func MakeBlockFromCreator (c *_cf .Creator )(*_cf .Block ,error ){_geeb ,_fdbc :=GetPageFromCreator (c );if _fdbc !=nil {return nil ,_fdbc ;};_cfbg ,_fdbc :=_cf .NewBlockFromPage (_geeb );if _fdbc !=nil {return nil ,_fdbc ;};return _cfbg ,nil ;};type BorderPosition byte ;func _cbbc (_gcag string )error {if !_dg .HasSuffix (_gcag ,"\u002e\u0074\u0074\u0066"){_fg .Log .Debug ("\u0055\u006es\u0075\u0070\u0070\u006f\u0072\u0074\u0065\u0064\u0020\u0066\u006f\u006e\u0074\u0020\u0066\u0069\u006c\u0065\u0020\u0066\u006f\u0072ma\u0074\u002e");return _e .Errorf ("\u0055\u006e\u0073\u0075\u0070\u0070o\u0072\u0074\u0065\u0064\u0020f\u006f\u006e\u0074\u0020\u0066\u0069l\u0065\u0020\u0066\u006f\u0072m\u0061\u0074\u002c\u0020\u0063\u0075\u0072\u0072\u0065\u006e\u0074\u006cy\u0020\u006f\u006e\u006c\u0079\u0020\u0073\u0075\u0070\u0070\u006f\u0072\u0074\u0020\u0054T\u0046\u0020\u0066\u006f\u006e\u0074\u0020\u0066i\u006c\u0065\u002e");};_aagb ,_fgfg :=_be .ParseFile (_gcag );if _fgfg !=nil {_fg .Log .Debug ("\u0043a\u006e\u006e\u006f\u0074\u0020\u0070\u0061\u0072\u0073\u0065\u0020T\u0054\u0046\u0020\u0066\u0069\u006c\u0065\u0020\u0025\u0073",_fgfg );return _fgfg ;};_bgab ,_fgfg :=_bee .NewCompositePdfFontFromTTFFile (_gcag );if _fgfg !=nil {return _fgfg ;};_bcdd :=_aagb .GetNameRecords ();for _ ,_afa :=range _bcdd {_bdb :=_afa [1];if _bdb ==""{return _e .Errorf ("\u004e\u006f\u0020\u0066\u006fn\u0074\u0020\u0066\u0061\u006d\u0069\u006c\u0079\u0020\u0069\u006e\u0066\u006fr\u006d\u0061\u0074\u0069\u006f\u006e\u0020\u0069\u006e\u0020\u0074\u0068\u0065\u0020\u0066\u0069\u006c\u0065\u0020\u0025\u0073",_gcag );};_aad :=make ([]byte ,0);for _eegg :=0;_eegg < len (_bdb );_eegg ++{if _bdb [_eegg ]==39||_bdb [_eegg ]==92{continue ;};_cgad :=4;if _eegg +_cgad < len (_bdb ){if _bdb [_eegg :_eegg +_cgad ]=="\u0000"{_eegg =_eegg +_cgad +1;continue ;};};_aad =append (_aad ,_bdb [_eegg ]);};_bdb =_dg .Replace (string (_aad ),"\u0078\u0030\u0030","",-1);_bgdf :=_afa [2];if _bgdf ==""{return _e .Errorf ("N\u006f\u0020\u0073\u0074\u0079\u006ce\u0020\u0069\u006e\u0066\u006f\u0072m\u0061\u0074\u0069\u006f\u006e\u0020\u0069n\u0020\u0074\u0068\u0065\u0020\u0066\u0069\u006c\u0065\u0020%\u0073",_gcag );};_aad =make ([]byte ,0);for _cbf :=0;_cbf < len (_bgdf );_cbf ++{if _bgdf [_cbf ]==39||_bgdf [_cbf ]==92{continue ;};_fcgd :=4;if _cbf +_fcgd < len (_bgdf ){if _bgdf [_cbf :_cbf +_fcgd ]=="\u0000"{_cbf =_cbf +_fcgd +1;continue ;};};_aad =append (_aad ,_bgdf [_cbf ]);};_bgdf =_dg .Replace (string (_aad ),"\u0078\u0030\u0030","",-1);RegisterFont (_bdb ,_dgdg [_bgdf ],_bgab );};return nil ;};var _bbb =fontsMap {_adbc :&_dc .Mutex {},_bgb :map[string ]map[FontStyle ]*_bee .PdfFont {}};func _ddd (_beg *_eg .CT_SerAx )(uint32 ,_eg .ST_AxPos ,_eg .ST_TickMark ,_eg .ST_TickLblPos ,*_eg .CT_ChartLines ,uint32 ,*_db .CT_ShapeProperties ,error ){var _bafc ,_cfaf uint32 ;var _gcb _eg .ST_AxPos ;var _faf _eg .ST_TickMark ;var _ecfa *_eg .CT_ChartLines ;var _aebc _eg .ST_TickLblPos ;if _beg .AxId ==nil {return _bafc ,_gcb ,_faf ,_aebc ,_ecfa ,_cfaf ,_beg .SpPr ,_ac .New ("\u004e\u006f\u0020x\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");}else {_bafc =_beg .AxId .ValAttr ;};if _beg .AxPos ==nil {return _bafc ,_gcb ,_faf ,_aebc ,_ecfa ,_cfaf ,_beg .SpPr ,_ac .New ("\u004eo\u0020x\u0020\u0061\u0078\u0069\u0073 \u0070\u006fs\u0069\u0074\u0069\u006f\u006e");}else {_gcb =_beg .AxPos .ValAttr ;};if _beg .MajorTickMark !=nil {_faf =_beg .MajorTickMark .ValAttr ;};if _beg .TickLblPos !=nil {_aebc =_beg .TickLblPos .ValAttr ;};if _beg .CrossAx ==nil {return _bafc ,_gcb ,_faf ,_aebc ,_ecfa ,_cfaf ,_beg .SpPr ,_ac .New ("\u004e\u006f \u0063\u0072\u006fs\u0073\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");}else {_cfaf =_beg .CrossAx .ValAttr ;};_ecfa =_beg .MajorGridlines ;return _bafc ,_gcb ,_faf ,_aebc ,_ecfa ,_cfaf ,_beg .SpPr ,nil ;};const _cgdf =6.0;var _gad =_agac (2);func MakeImageFromChartSpace (cs *_eg .ChartSpace ,width ,height float64 ,theme *_db .Theme )(_ab .Image ,error ){_ebg ,_bge :=_cbc (cs ,width ,height ,theme ,true );if _bge !=nil {return nil ,_bge ;};_aae ,_bge :=GetPageFromCreator (_ebg );if _bge !=nil {return nil ,_bge ;};return _bed .NewImageDevice ().Render (_aae );};func _affd (_cdbb ,_ffd ,_fdba uint8 )(float64 ,float64 ,float64 ){_gff ,_caa ,_ced :=float64 (_cdbb )/255,float64 (_ffd )/255,float64 (_fdba )/255;_cdc :=_gff ;if _caa < _cdc {_cdc =_caa ;};if _ced < _cdc {_cdc =_ced ;};var _ccab ,_bgdc bool ;_fce :=_gff ;if _caa > _fce {_fce =_caa ;_ccab =true ;};if _ced > _fce {_fce =_ced ;_ccab =false ;_bgdc =true ;};_ffg :=(_cdc +_fce )/2;var _dbcb float64 ;if _cdc !=_fce {if _ffg <=0.5{_dbcb =(_fce -_cdc )/(_fce +_cdc );}else {_dbcb =(_fce -_cdc )/(2.0-_fce -_cdc );};};var _bcg float64 ;if _cdc !=_fce {if _ccab {_bcg =2.0+(_ced -_gff )/(_fce -_cdc );}else if _bgdc {_bcg =4.0+(_gff -_caa )/(_fce -_cdc );}else {_bcg =(_caa -_ced )/(_fce -_cdc );};_bcg *=60;if _bcg < 0{_bcg +=360;};};return _bcg ,_dbcb ,_ffg ;};func _afff (_cadg ,_fgb ,_fcge float64 )float64 {if _cadg *6< 1{return _fcge +(_fgb -_fcge )*6*_cadg ;}else if _cadg *2< 1{return _fgb ;}else if _cadg *3< 2{return _fcge +(_fgb -_fcge )*(2.0/3.0-_cadg )*6;}else {return _fcge ;};};func _dadf (_cbda ,_bbc ,_gab float64 )(uint8 ,uint8 ,uint8 ){var _adff float64 ;if _gab < 0.5{_adff =_gab *(1+_bbc );}else {_adff =_gab +_bbc -_gab *_bbc ;};_gaca :=_gab *2-_adff ;_cbda /=360.0;_fced :=_bebf (_cbda +1.0/3.0);_aef :=_bebf (_cbda );_eed :=_bebf (_cbda -1.0/3.0);_cbg :=_afff (_fced ,_adff ,_gaca );_bedd :=_afff (_aef ,_adff ,_gaca );_dbab :=_afff (_eed ,_adff ,_gaca );return uint8 (255*_cbg ),uint8 (255*_bedd ),uint8 (255*_dbab );};func (_febg *creatorContext )getPdfColorFromSolidFill (_gebg *_db .CT_SolidColorFillProperties )_cf .Color {if _gebg ==nil {return nil ;};_bfeg :="";if _efa :=_gebg .SrgbClr ;_efa !=nil {_bfeg =_efa .ValAttr ;}else if _ead :=_gebg .SchemeClr ;_ead !=nil {_bfeg =_dfd (_ead .ValAttr ,_febg ._fdfg );};if _bfeg ==""{return nil ;};return _cf .ColorRGBFromHex ("\u0023"+_bfeg );};var _dgc =_agac (1.5);func _cbc (_fe *_eg .ChartSpace ,_afd ,_gaa float64 ,_bfb *_db .Theme ,_bcd bool )(*_cf .Creator ,error ){_ebdc :=1.0;if _bcd {_ebdc =8.0;};_fec :=&Rectangle {};_dgg :=&Rectangle {Top :_fec .Top ,Bottom :_gaa -_fec .Bottom ,Left :_fec .Left ,Right :_afd -_fec .Right };_aba :=MakeTempCreator (_afd *_ebdc +1,_gaa *_ebdc +1);_efb :=&creatorContext {_gaea :_aba ,_fdfg :_bfb ,_geb :_ebdc };var _gdb bool ;if _eab :=_fe .Chart ;_eab !=nil {_ebb :=_eab .PlotArea ;if _ebb ==nil {return nil ,_ac .New ("\u004e\u006f\u0020p\u006c\u006f\u0074\u0020\u0061\u0072\u0065\u0061");};_gag :=&Rectangle {Top :_agac (10),Bottom :_dgg .Bottom -_agac (15),Left :_agac (10),Right :_dgg .Right -_agac (10)};var _fdd *Rectangle ;_fab :=_eab .Legend ;if _fab !=nil {_cgd :=_fab .Overlay !=nil &&_fab .Overlay .ValAttr !=nil &&*_fab .Overlay .ValAttr ;if _feb :=_fab .LegendPos ;_feb !=nil {switch _feb .ValAttr {case _eg .ST_LegendPosTr :if !_cgd {_gag =&Rectangle {Top :_agac (25),Bottom :_dgg .Bottom -_agac (10),Left :_agac (10),Right :_dgg .Right -_agac (25)};};_fdd =&Rectangle {Top :_agac (2.5),Bottom :_agac (22.5),Left :_dgg .Right -_agac (22.5),Right :_dgg .Right -_agac (2.5)};case _eg .ST_LegendPosT :_fdd =&Rectangle {Top :_agac (2.5),Bottom :_agac (7.5),Left :(_dgg .Right -_dgg .Left )*0.25,Right :(_dgg .Right -_dgg .Left )*0.75};if !_cgd {_gag =&Rectangle {Top :_agac (12.5),Bottom :_dgg .Bottom -_agac (15),Left :_agac (10),Right :_dgg .Right -_agac (5)};};_gdb =true ;case _eg .ST_LegendPosB :_fdd =&Rectangle {Top :_dgg .Bottom -_agac (7.5),Bottom :_dgg .Bottom -_agac (2.5),Left :(_dgg .Right -_dgg .Left )*0.25,Right :(_dgg .Right -_dgg .Left )*0.75};if !_cgd {_gag =&Rectangle {Top :_agac (5),Bottom :_dgg .Bottom -_agac (15),Left :_agac (10),Right :_dgg .Right -_agac (5)};};_gdb =true ;case _eg .ST_LegendPosR :_fdd =&Rectangle {Top :(_dgg .Bottom -_dgg .Top )/2-_agac (10),Bottom :(_dgg .Bottom -_dgg .Top )/2+_agac (10),Left :_dgg .Right -_agac (22.5),Right :_dgg .Right -_agac (2.5)};if !_cgd {_gag =&Rectangle {Top :_agac (5),Bottom :_dgg .Bottom -_agac (12.5),Left :_agac (10),Right :_dgg .Right -_agac (25)};};case _eg .ST_LegendPosL :_fdd =&Rectangle {Top :(_dgg .Bottom -_dgg .Top )/2-_agac (10),Bottom :(_dgg .Bottom -_dgg .Top )/2+_agac (10),Left :_agac (2.5),Right :_agac (22.5)};if !_cgd {_gag =&Rectangle {Top :_agac (5),Bottom :_dgg .Bottom -_agac (12.5),Left :_agac (30),Right :_dgg .Right -_agac (5)};};default:_fdd =&Rectangle {Top :(_dgg .Bottom -_dgg .Top )/2-_agac (10),Bottom :(_dgg .Bottom -_dgg .Top )/2+_agac (10),Left :_dgg .Right -_agac (25),Right :_dgg .Right -_agac (5)};if !_cgd {_gag =&Rectangle {Top :_agac (5),Bottom :_dgg .Bottom -_agac (12.5),Left :_agac (100),Right :_dgg .Right -_agac (25)};};};};};_gag .scale (_ebdc );_efb .drawBorderWithProps (_ebb .SpPr ,_gag ,_ceg );_ddc :=[]*legendItem {};var _gcc error ;_dgb :=_ebb .CChoice ;for _ ,_cbe :=range _ebb .Choice {if _cfa :=_cbe .BarChart ;_cfa !=nil {_ddc ,_gcc =_efb .drawBarChart (_cfa ,_gag ,_dgb );if _gcc !=nil {return nil ,_gcc ;};};};if _fab !=nil {_fdd .scale (_ebdc );_efb .drawBorderWithProps (_fab .SpPr ,_fdd ,_ceg );if len (_ddc )!=0{_efb .drawLegend (_fdd ,_ddc ,_gdb );};};};_dgg .scale (_ebdc );_efb .drawBorderWithProps (_fe .SpPr ,_dgg ,_ceg );return _aba ,nil ;};var _ceg =_agac (0.125);