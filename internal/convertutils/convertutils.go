//
// Copyright 2020 FoxyUtils ehf. All rights reserved.
//
// This is a commercial product and requires a license to operate.
// A trial license can be obtained at https://unidoc.io
//
// DO NOT EDIT: generated by unitwist Go source code obfuscator.
//
// Use of this source code is governed by the UniDoc End User License Agreement
// terms that can be accessed at https://unidoc.io/eula/

package convertutils ;import (_c "bytes";_db "errors";_d "fmt";_dg "github.com/unidoc/unioffice/measurement";_bg "github.com/unidoc/unioffice/schema/soo/dml";_ef "github.com/unidoc/unioffice/schema/soo/dml/chart";_ae "github.com/unidoc/unioffice/spreadsheet/format";_dfdb "github.com/unidoc/unipdf/v3/creator";_adg "github.com/unidoc/unipdf/v3/model";_fg "github.com/unidoc/unipdf/v3/render";_bc "github.com/unidoc/unitype";_e "image";_f "log";_cg "math";_ad "os";_dfd "sort";_ade "strconv";_cd "strings";_df "sync";_a "unicode";);func (_bagf *creatorContext )drawLineWithProps (_fage *_bg .CT_ShapeProperties ,_fegf ,_bbce ,_ccgd ,_egd float64 ,_face bool ){if _fage !=nil {if _dffd :=_fage .Ln ;_dffd !=nil {_egcg :=_bagf .getPdfColorFromSolidFill (_dffd .SolidFill );if _egcg ==nil &&_face {_egcg =_dfdb .ColorBlack ;};if _egcg !=nil {var _dac float64 ;if _bdbd :=_dffd .WAttr ;_bdbd !=nil {_dac =_dg .FromEMU (int64 (*_bdbd ));}else {_dac =_cce ;};DrawLine (_bagf ._daee ,_fegf ,_bbce ,_ccgd ,_egd ,_dac ,_egcg );};};};};func _fefg (_affg *_ef .CT_ValAx )(uint32 ,_ef .ST_AxPos ,_ef .ST_TickMark ,_ef .ST_TickLblPos ,*_ef .CT_ChartLines ,uint32 ,*_bg .CT_ShapeProperties ,error ){var _daf ,_cec uint32 ;var _bfef _ef .ST_AxPos ;var _dfgf _ef .ST_TickMark ;var _aecdb *_ef .CT_ChartLines ;var _bce _ef .ST_TickLblPos ;if _affg .AxId ==nil {return _daf ,_bfef ,_dfgf ,_bce ,_aecdb ,_cec ,_affg .SpPr ,_db .New ("\u004e\u006f\u0020x\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");}else {_daf =_affg .AxId .ValAttr ;};if _affg .AxPos ==nil {return _daf ,_bfef ,_dfgf ,_bce ,_aecdb ,_cec ,_affg .SpPr ,_db .New ("\u004eo\u0020x\u0020\u0061\u0078\u0069\u0073 \u0070\u006fs\u0069\u0074\u0069\u006f\u006e");}else {_bfef =_affg .AxPos .ValAttr ;};if _affg .MajorTickMark !=nil {_dfgf =_affg .MajorTickMark .ValAttr ;};if _affg .TickLblPos !=nil {_bce =_affg .TickLblPos .ValAttr ;};if _affg .CrossAx ==nil {return _daf ,_bfef ,_dfgf ,_bce ,_aecdb ,_cec ,_affg .SpPr ,_db .New ("\u004e\u006f \u0063\u0072\u006fs\u0073\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");}else {_cec =_affg .CrossAx .ValAttr ;};_aecdb =_affg .MajorGridlines ;return _daf ,_bfef ,_dfgf ,_bce ,_aecdb ,_cec ,_affg .SpPr ,nil ;};type creatorContext struct{_daee *_dfdb .Creator ;_aac *_bg .Theme ;_aadd float64 ;};func _aag (_ddcde float64 )float64 {return _ddcde *_dg .Millimeter };type barSerByOrder []*_ef .CT_BarSer ;const (FontStyle_Regular FontStyle =0;FontStyle_Bold FontStyle =1;FontStyle_Italic FontStyle =2;FontStyle_BoldItalic FontStyle =3;);func TwipsFromPoints (points float64 )float64 {return points /_dg .Twips };var _faa =fontsMap {_adgf :&_df .Mutex {},_dad :map[string ]map[FontStyle ]*_adg .PdfFont {}};func AssignStdFontByName (style _dfdb .TextStyle ,fontName string )*_adg .PdfFont {_dcbd :=_adg .StdFontName (fontName );return _adg .NewStandard14FontMustCompile (_dcbd );};func GetColorStringFromDmlColor (dmlColor *_bg .CT_Color )string {var _dff string ;if _edca :=dmlColor .SrgbClr ;_edca !=nil {_dff =_edca .ValAttr ;}else if _bdc :=dmlColor .SysClr ;_bdc !=nil {return "\u0030\u0030\u0030\u0030\u0030\u0030";};return _dff ;};func (_fbc FontStyle )String ()string {return []string {"\u0052e\u0067\u0075\u006c\u0061\u0072","\u0042\u006f\u006c\u0064","\u0049\u0074\u0061\u006c\u0069\u0063","\u0042\u006f\u006c\u0064\u0049\u0074\u0061\u006c\u0069\u0063"}[int (_fbc )];};func (_bad barSerByOrder )Len ()int {return len (_bad )};func DrawLine (c *_dfdb .Creator ,x0 ,y0 ,x1 ,y1 ,width float64 ,color _dfdb .Color ){if color ==nil {return ;};_beg :=c .NewLine (x0 ,y0 ,x1 ,y1 );_beg .SetLineWidth (width );_beg .SetColor (color );c .Draw (_beg );};func DrawRectangle (c *_dfdb .Creator ,r *Rectangle ,w float64 ,color _dfdb .Color ){if color ==nil {return ;};DrawLine (c ,r .Left ,r .Top ,r .Right ,r .Top ,w ,color );DrawLine (c ,r .Left ,r .Top ,r .Left ,r .Bottom ,w ,color );DrawLine (c ,r .Left ,r .Bottom ,r .Right ,r .Bottom ,w ,color );DrawLine (c ,r .Right ,r .Top ,r .Right ,r .Bottom ,w ,color );};type fontsMap struct{_adgf *_df .Mutex ;_dad map[string ]map[FontStyle ]*_adg .PdfFont ;};func _befd (_cfe *_dfdb .Creator )(*_adg .PdfPage ,error ){_bec :=_c .NewBuffer ([]byte {});_egce :=_cfe .Write (_bec );if _egce !=nil {return nil ,_egce ;};_ddeea :=_c .NewReader (_bec .Bytes ());_dbfca ,_egce :=_adg .NewPdfReader (_ddeea );if _egce !=nil {return nil ,_egce ;};return _dbfca .GetPage (1);};func PointsFromTwips (twips int64 )float64 {return float64 (int64 (float64 (twips )*_dg .Twips *10+0.5))/10;};func MakeImageFromChartSpace (cs *_ef .ChartSpace ,height ,width float64 ,theme *_bg .Theme )(_e .Image ,error ){_fff ,_ecd :=_gcc (cs ,height ,width ,theme ,true );if _ecd !=nil {return nil ,_ecd ;};_acfe ,_ecd :=_befd (_fff );if _ecd !=nil {return nil ,_ecd ;};return _fg .NewImageDevice ().Render (_acfe );};func (_fbdd barSerByOrder )Swap (i ,j int ){_fbdd [i ],_fbdd [j ]=_fbdd [j ],_fbdd [i ]};func GetRegisteredFont (name string ,style FontStyle )*_adg .PdfFont {_faa ._adgf .Lock ();defer _faa ._adgf .Unlock ();if _edg ,_bgba :=_faa ._dad [name ];_bgba {if _acdb ,_gea :=_edg [style ];_gea {return _acdb ;};};return nil ;};func Lighten (clr float64 )float64 {return 0.6+0.4*clr };func AdjustColorByTint (colorStr string ,tint float64 )string {var _bbd ,_cee ,_fdga uint8 ;_cfd ,_ :=_d .Sscanf (colorStr ,"\u0025\u0030\u0032x\u0025\u0030\u0032\u0078\u0025\u0030\u0032\u0078",&_bbd ,&_cee ,&_fdga );if _cfd !=3{return "";};return _bebb (_bbd ,tint )+_bebb (_cee ,tint )+_bebb (_fdga ,tint );};var _fcgb =map[string ]FontStyle {"\u0052e\u0067\u0075\u006c\u0061\u0072":FontStyle_Regular ,"\u0042\u006f\u006c\u0064":FontStyle_Bold ,"\u0049\u0074\u0061\u006c\u0069\u0063":FontStyle_Italic ,"B\u006f\u006c\u0064\u0020\u0049\u0074\u0061\u006c\u0069\u0063":FontStyle_BoldItalic };const DefaultFontSize =12.0;type legendItem struct{_acc string ;_fegg *_bg .CT_ShapeProperties ;};func RegisterFont (name string ,style FontStyle ,font *_adg .PdfFont ){_faa ._adgf .Lock ();if _faa ._dad [name ]==nil {_faa ._dad [name ]=map[FontStyle ]*_adg .PdfFont {};};_faa ._dad [name ][style ]=font ;_faa ._adgf .Unlock ();};func (_fe *creatorContext )drawBarChart (_bf *_ef .CT_BarChart ,_bd *Rectangle ,_fee *_ef .CT_PlotAreaChoice1 )([]*legendItem ,error ){var _da bool ;if _fa :=_bf .BarDir ;_fa !=nil {_da =_fa .ValAttr ==_ef .ST_BarDirBar ;};_g :=_bf .Ser ;_dfd .Sort (barSerByOrder (_g ));_dgg :=map[string ]serCategory {};_bge :=[]string {};_feg :=[]*legendItem {};_dbf :=_cg .Inf (1);_dc :=_cg .Inf (-1);for _ ,_gb :=range _g {var _ge string ;if _fd :=_gb .Tx ;_fd !=nil {if _de :=_fd .Choice ;_de !=nil {if _de .V !=nil {_ge =*_de .V ;}else if _dfe :=_de .StrRef ;_dfe !=nil {if _ed :=_dfe .StrCache ;_ed !=nil {for _ ,_ca :=range _ed .Pt {_ge =_ca .V ;};};};};};if _fc :=_gb .Cat ;_fc !=nil {if _bdg :=_fc .Choice ;_bdg !=nil {if _gd :=_bdg .StrRef ;_gd !=nil {if _bdgc :=_gd .StrCache ;_bdgc !=nil {for _ ,_ce :=range _bdgc .Pt {_ab :=_ce .V ;if _ ,_deb :=_dgg [_ab ];!_deb {_dgg [_ab ]=serCategory {_bed :_ab ,_edc :[]serValue {}};_bge =append (_bge ,_ab );};};};}else if _dag :=_bdg .NumRef ;_dag !=nil {if _dbb :=_dag .NumCache ;_dbb !=nil {var _dcb string ;if _dbb .FormatCode !=nil {_dcb =*_dbb .FormatCode ;};for _ ,_aec :=range _dbb .Pt {var _ag string ;if _aec .FormatCodeAttr ==nil {_ag =_dcb ;}else {_ag =*_aec .FormatCodeAttr ;};var _bb string ;_eg ,_gbc :=_ade .ParseFloat (_aec .V ,64);if _gbc !=nil {_bb =_aec .V ;}else {_bb =_ae .Number (_eg ,_ag );};if _ ,_bcg :=_dgg [_bb ];!_bcg {_dgg [_bb ]=serCategory {_bed :_bb ,_edc :[]serValue {}};_bge =append (_bge ,_bb );};};};};};};if _bgb :=_gb .Val ;_bgb !=nil {if _cdc :=_bgb .Choice ;_cdc !=nil {if _be :=_cdc .NumRef ;_be !=nil {if _gbd :=_be .NumCache ;_gbd !=nil {for _cc ,_ee :=range _gbd .Pt {_fda ,_cag :=_ade .ParseFloat (_ee .V ,64);if _cag !=nil {_fda =0;_f .Println ("\u0070\u0061\u0072s\u0065\u0020\u0065\u0072\u0072\u006f\u0072\u003a",_cag );};if _fda > _dc {_dc =_fda ;};if _fda < _dbf {_dbf =_fda ;};_acf :=_dgg [_bge [_cc ]];_acf ._edc =append (_acf ._edc ,serValue {_gg :_ge ,_cdd :_fda ,_bag :_gb .SpPr });_dgg [_bge [_cc ]]=_acf ;};};};};};_feg =append (_feg ,&legendItem {_acc :_ge ,_fegg :_gb .SpPr });};var _cgff float64 ;var _gbdf ,_bfe float64 ;if _dc ==0&&_dbf ==0{_cgff =0.2;_bfe =0;_gbdf =1;}else {var _ff float64 ;if _ba :=_cg .Abs (_dbf );_dc < _ba {_ff =_ba ;}else {_ff =_dc ;};_adeb :=_cg .Pow (10,_cg .Floor (_cg .Log10 (_ff )));_aa :=_ff /_adeb ;if _aa >=1.715&&_aa < 4.29{_cgff =0.5;}else if _aa >=4.29&&_aa < 8.58{_cgff =1;}else {_cgff =2;};_cgff *=_adeb ;if _dc <=0{_gbdf =0;}else {_gbdf =(_cg .Ceil (_dc /_cgff )+1)*_cgff ;};if _dbf >=0{_bfe =0;}else {_bfe =(_cg .Floor (_dbf /_cgff )-1)*_cgff ;};};_cb :=_fe .drawAxes (_fee ,_bfe ,_gbdf ,_cgff ,_bge ,_bd ,_da );if _cb !=nil {return nil ,_cb ;};_ea :=0.0;if _bf .GapWidth !=nil {if _ccg :=_bf .GapWidth .ValAttr ;_ccg !=nil {if _eea :=_ccg .ST_GapAmountUShort ;_eea !=nil {_ea =float64 (*_eea )/100.0;};};};_fb :=_bd .Right -_bd .Left ;_bab :=_bd .Bottom -_bd .Top ;_bdga :=float64 (len (_bge ));if _da {_gbcc :=_gbdf /(_gbdf -_bfe )*_fb ;_bbf :=-_bfe /(_gbdf -_bfe )*_fb ;_ffe :=_bd .Left +_bbf ;_cf :=_bab /_bdga ;for _dd ,_dde :=range _bge {_gde :=_dgg [_dde ];_dcc :=float64 (len (_gde ._edc ))+_ea ;_feeb :=_cf /_dcc ;_bbg :=_feeb *_ea ;_fgc :=_bd .Bottom -float64 (_dd )*_cf -_bbg /2-_feeb ;for _ ,_dea :=range _gde ._edc {if _dea ._cdd ==0{continue ;};var _dbe ,_gc float64 ;if _dea ._cdd > 0{_gc =_dea ._cdd /_gbdf *_gbcc ;_fe .drawRectangleWithProps (_dea ._bag ,_ffe ,_fgc ,_gc ,_feeb ,false );}else {_gc =_dea ._cdd /_bfe *_bbf ;_dbe =_ffe -_gc ;_fe .drawRectangleWithProps (_dea ._bag ,_dbe ,_fgc ,_gc ,_feeb ,false );};_fgc -=_feeb ;};};}else {_bgbg :=_gbdf /(_gbdf -_bfe )*_bab ;_aee :=-_bfe /(_gbdf -_bfe )*_bab ;_aecd :=_bd .Top +_bgbg ;_gce :=_fb /_bdga ;for _bga ,_dec :=range _bge {_dcbc :=_dgg [_dec ];_cbf :=float64 (len (_dcbc ._edc ))+_ea ;_cgg :=_gce /_cbf ;_gf :=_cgg *_ea ;_ec :=_bd .Left +float64 (_bga )*_gce +_gf /2;for _ ,_fbd :=range _dcbc ._edc {var _geg ,_cdf float64 ;if _fbd ._cdd > 0{_cdf =_fbd ._cdd /_gbdf *_bgbg ;_geg =_aecd -_cdf ;_fe .drawRectangleWithProps (_fbd ._bag ,_ec ,_geg ,_cgg ,_cdf ,false );}else {_cdf =_fbd ._cdd /_bfe *_aee ;_fe .drawRectangleWithProps (_fbd ._bag ,_ec ,_aecd ,_cgg ,_cdf ,false );};_ec +=_cgg ;};};};return _feg ,nil ;};func (_cbe *creatorContext )drawLegend (_gge *Rectangle ,_gcg []*legendItem ,_cfg bool ){_ggf :=_cbe ._aadd ;_bdd :=_aag (2.5)*_ggf ;_cde :=_aag (1.5)*_ggf ;_ace :=(_bdd -_cde )/2;_fdgc :=float64 (len (_gcg ));if _cfg {_gebe :=&Rectangle {Top :_gge .Top +_aag (1)*_ggf ,Bottom :_gge .Bottom -_aag (1)*_ggf ,Left :_gge .Left +_aag (2.5)*_ggf ,Right :_gge .Right -_aag (2.5)*_ggf };var _fagg float64 ;if _fdgc > 1{_fagg =(_gebe .Right -_gebe .Left )/_fdgc ;};_aeg :=_gebe .Left ;_dfdc :=_gebe .Top ;for _ ,_dbbd :=range _gcg {if _dcf :=_dbbd ._fegg ;_dcf !=nil {_cbe .drawRectangleWithProps (_dcf ,_aeg ,_dfdc +_ace ,_cde ,_cde ,false );_cggd :=_aeg +_cde *2;_gged :=_cbe ._daee .NewStyledParagraph ();_gged .SetPos (_cggd ,_dfdc );_eac :=_gged .Append (_dbbd ._acc );_abf ,_dga :=_adg .NewStandard14Font (_adg .HelveticaName );if _dga ==nil {_eac .Style =_dfdb .TextStyle {FontSize :_bdd ,Font :_abf ,TextRise :0.4};_cbe ._daee .Draw (_gged );};};_aeg +=_fagg ;};}else {_acge :=&Rectangle {Top :_gge .Top +_aag (2.5)*_ggf ,Bottom :_gge .Bottom -_aag (2.5)*_ggf ,Left :_gge .Left +_aag (2.5)*_ggf ,Right :_gge .Right -_aag (2.5)*_ggf };var _faca float64 ;if _fdgc > 1{_faca =(_acge .Bottom -_acge .Top -_bdd )/(_fdgc -1);};_abfc :=_acge .Top ;_dbfc :=_acge .Left ;_gec :=_dbfc +_cde *2;for _ ,_egb :=range _gcg {if _cbc :=_egb ._fegg ;_cbc !=nil {_cbe .drawRectangleWithProps (_cbc ,_dbfc ,_abfc +_ace ,_cde ,_cde ,false );_efc :=_cbe ._daee .NewStyledParagraph ();_efc .SetPos (_gec ,_abfc );_ddee :=_efc .Append (_egb ._acc );_dfga ,_dce :=_adg .NewStandard14Font (_adg .HelveticaName );if _dce ==nil {_ddee .Style =_dfdb .TextStyle {FontSize :_bdd ,Font :_dfga ,TextRise :0.4};_cbe ._daee .Draw (_efc );};};_abfc +=_faca ;};};};func (_bdda *creatorContext )drawBorderWithProps (_cef *_bg .CT_ShapeProperties ,_agb *Rectangle ,_dfda float64 ){if _agb !=nil &&_cef !=nil &&_cef .Ln !=nil &&_cef .Ln .SolidFill !=nil {_gfe :=_bdda .getPdfColorFromSolidFill (_cef .Ln .SolidFill );DrawRectangle (_bdda ._daee ,_agb ,_dfda ,_gfe );};};func (_adgd barSerByOrder )Less (i ,j int )bool {return _adgd [i ].Order .ValAttr < _adgd [j ].Order .ValAttr ;};func MakeBlockFromCreator (c *_dfdb .Creator )(*_dfdb .Block ,error ){_cagb ,_fbb :=_befd (c );if _fbb !=nil {return nil ,_fbb ;};_feb ,_fbb :=_dfdb .NewBlockFromPage (_cagb );if _fbb !=nil {return nil ,_fbb ;};return _feb ,nil ;};func MakeBlockFromChartSpace (cs *_ef .ChartSpace ,height ,width float64 ,theme *_bg .Theme )(*_dfdb .Block ,error ){_cda ,_gbcd :=_gcc (cs ,height ,width ,theme ,false );if _gbcd !=nil {return nil ,_gbcd ;};_bef ,_gbcd :=_befd (_cda );if _gbcd !=nil {return nil ,_gbcd ;};_cae ,_gbcd :=_dfdb .NewBlockFromPage (_bef );if _gbcd !=nil {return nil ,_gbcd ;};return _cae ,nil ;};func _fce (_aff *_ef .CT_DateAx )(uint32 ,_ef .ST_AxPos ,_ef .ST_TickMark ,_ef .ST_TickLblPos ,*_ef .CT_ChartLines ,uint32 ,*_bg .CT_ShapeProperties ,error ){var _bbc ,_afd uint32 ;var _ebg _ef .ST_AxPos ;var _aga _ef .ST_TickMark ;var _ceb *_ef .CT_ChartLines ;var _ddeb _ef .ST_TickLblPos ;if _aff .AxId ==nil {return _bbc ,_ebg ,_aga ,_ddeb ,_ceb ,_afd ,_aff .SpPr ,_db .New ("\u004e\u006f\u0020x\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");}else {_bbc =_aff .AxId .ValAttr ;};if _aff .AxPos ==nil {return _bbc ,_ebg ,_aga ,_ddeb ,_ceb ,_afd ,_aff .SpPr ,_db .New ("\u004eo\u0020x\u0020\u0061\u0078\u0069\u0073 \u0070\u006fs\u0069\u0074\u0069\u006f\u006e");}else {_ebg =_aff .AxPos .ValAttr ;};if _aff .MajorTickMark !=nil {_aga =_aff .MajorTickMark .ValAttr ;};if _aff .TickLblPos !=nil {_ddeb =_aff .TickLblPos .ValAttr ;};if _aff .CrossAx ==nil {return _bbc ,_ebg ,_aga ,_ddeb ,_ceb ,_afd ,_aff .SpPr ,_db .New ("\u004e\u006f \u0063\u0072\u006fs\u0073\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");}else {_afd =_aff .CrossAx .ValAttr ;};_ceb =_aff .MajorGridlines ;return _bbc ,_ebg ,_aga ,_ddeb ,_ceb ,_afd ,_aff .SpPr ,nil ;};func FromSTCoordinate (st _bg .ST_Coordinate )int64 {if _gbb :=st .ST_CoordinateUnqualified ;_gbb !=nil {return *_gbb ;};return 0;};func MakeTempCreator (width ,height float64 )*_dfdb .Creator {_beda :=_dfdb .New ();_beda .SetPageSize (_dfdb .PageSize {width ,height });_beda .SetPageMargins (0,0,0,0);return _beda ;};var _cce =_aag (0.125);func _ecc (_acd _bg .ST_SchemeColorVal ,_bgd *_bg .Theme )string {if _beef :=_bgd .ThemeElements ;_beef !=nil {if _fcf :=_beef .ClrScheme ;_fcf !=nil {switch _acd {case _bg .ST_SchemeColorValLt1 :return GetColorStringFromDmlColor (_fcf .Lt1 );case _bg .ST_SchemeColorValDk1 ,_bg .ST_SchemeColorValTx1 :return GetColorStringFromDmlColor (_fcf .Dk1 );case _bg .ST_SchemeColorValLt2 :return GetColorStringFromDmlColor (_fcf .Lt2 );case _bg .ST_SchemeColorValDk2 :return GetColorStringFromDmlColor (_fcf .Dk2 );case _bg .ST_SchemeColorValAccent1 :return GetColorStringFromDmlColor (_fcf .Accent1 );case _bg .ST_SchemeColorValAccent2 :return GetColorStringFromDmlColor (_fcf .Accent2 );case _bg .ST_SchemeColorValAccent3 :return GetColorStringFromDmlColor (_fcf .Accent3 );case _bg .ST_SchemeColorValAccent4 :return GetColorStringFromDmlColor (_fcf .Accent4 );case _bg .ST_SchemeColorValAccent5 :return GetColorStringFromDmlColor (_fcf .Accent5 );case _bg .ST_SchemeColorValAccent6 :return GetColorStringFromDmlColor (_fcf .Accent6 );};};};return "";};type serCategory struct{_bed string ;_edc []serValue ;};func _gcc (_bcgf *_ef .ChartSpace ,_cbb ,_af float64 ,_fag *_bg .Theme ,_dfg bool )(*_dfdb .Creator ,error ){_cdfc :=1.0;if _dfg {_cdfc =8.0;};_dgf :=&Rectangle {};_acg :=&Rectangle {Top :_dgf .Top ,Bottom :_cbb -_dgf .Bottom ,Left :_dgf .Left ,Right :_af -_dgf .Right };_gff :=MakeTempCreator (_af *_cdfc +1,_cbb *_cdfc +1);_fdg :=&creatorContext {_daee :_gff ,_aac :_fag ,_aadd :_cdfc };var _aca bool ;if _ddb :=_bcgf .Chart ;_ddb !=nil {_fdb :=_ddb .PlotArea ;if _fdb ==nil {return nil ,_db .New ("\u004e\u006f\u0020p\u006c\u006f\u0074\u0020\u0061\u0072\u0065\u0061");};_gbfa :=&Rectangle {Top :_aag (10),Bottom :_acg .Bottom -_aag (15),Left :_aag (10),Right :_acg .Right -_aag (10)};var _cdfb *Rectangle ;_gcf :=_ddb .Legend ;if _gcf !=nil {_ga :=_gcf .Overlay !=nil &&_gcf .Overlay .ValAttr !=nil &&*_gcf .Overlay .ValAttr ;if _fac :=_gcf .LegendPos ;_fac !=nil {switch _fac .ValAttr {case _ef .ST_LegendPosTr :if !_ga {_gbfa =&Rectangle {Top :_aag (25),Bottom :_acg .Bottom -_aag (10),Left :_aag (10),Right :_acg .Right -_aag (25)};};_cdfb =&Rectangle {Top :_aag (2.5),Bottom :_aag (22.5),Left :_acg .Right -_aag (22.5),Right :_acg .Right -_aag (2.5)};case _ef .ST_LegendPosT :_cdfb =&Rectangle {Top :_aag (2.5),Bottom :_aag (7.5),Left :(_acg .Right -_acg .Left )*0.25,Right :(_acg .Right -_acg .Left )*0.75};if !_ga {_gbfa =&Rectangle {Top :_aag (12.5),Bottom :_acg .Bottom -_aag (15),Left :_aag (10),Right :_acg .Right -_aag (5)};};_aca =true ;case _ef .ST_LegendPosB :_cdfb =&Rectangle {Top :_acg .Bottom -_aag (7.5),Bottom :_acg .Bottom -_aag (2.5),Left :(_acg .Right -_acg .Left )*0.25,Right :(_acg .Right -_acg .Left )*0.75};if !_ga {_gbfa =&Rectangle {Top :_aag (5),Bottom :_acg .Bottom -_aag (15),Left :_aag (10),Right :_acg .Right -_aag (5)};};_aca =true ;case _ef .ST_LegendPosR :_cdfb =&Rectangle {Top :(_acg .Bottom -_acg .Top )/2-_aag (10),Bottom :(_acg .Bottom -_acg .Top )/2+_aag (10),Left :_acg .Right -_aag (22.5),Right :_acg .Right -_aag (2.5)};if !_ga {_gbfa =&Rectangle {Top :_aag (5),Bottom :_acg .Bottom -_aag (12.5),Left :_aag (10),Right :_acg .Right -_aag (25)};};case _ef .ST_LegendPosL :_cdfb =&Rectangle {Top :(_acg .Bottom -_acg .Top )/2-_aag (10),Bottom :(_acg .Bottom -_acg .Top )/2+_aag (10),Left :_aag (2.5),Right :_aag (22.5)};if !_ga {_gbfa =&Rectangle {Top :_aag (5),Bottom :_acg .Bottom -_aag (12.5),Left :_aag (30),Right :_acg .Right -_aag (5)};};default:_cdfb =&Rectangle {Top :(_acg .Bottom -_acg .Top )/2-_aag (10),Bottom :(_acg .Bottom -_acg .Top )/2+_aag (10),Left :_acg .Right -_aag (25),Right :_acg .Right -_aag (5)};if !_ga {_gbfa =&Rectangle {Top :_aag (5),Bottom :_acg .Bottom -_aag (12.5),Left :_aag (100),Right :_acg .Right -_aag (25)};};};};};_gbfa .scale (_cdfc );_fdg .drawBorderWithProps (_fdb .SpPr ,_gbfa ,_cce );_aae :=[]*legendItem {};var _eed error ;_baa :=_fdb .CChoice ;for _ ,_ccd :=range _fdb .Choice {if _eab :=_ccd .BarChart ;_eab !=nil {_aae ,_eed =_fdg .drawBarChart (_eab ,_gbfa ,_baa );if _eed !=nil {return nil ,_eed ;};};};if _gcf !=nil {_cdfb .scale (_cdfc );_fdg .drawBorderWithProps (_gcf .SpPr ,_cdfb ,_cce );if len (_aae )!=0{_fdg .drawLegend (_cdfb ,_aae ,_aca );};};};_acg .scale (_cdfc );_fdg .drawBorderWithProps (_bcgf .SpPr ,_acg ,_cce );return _gff ,nil ;};func (_dgdb *Rectangle )scale (_bcbb float64 ){_dgdb .Top *=_bcbb ;_dgdb .Bottom *=_bcbb ;_dgdb .Left *=_bcbb ;_dgdb .Right *=_bcbb ;};func (_abff *creatorContext )drawAxes (_bfb *_ef .CT_PlotAreaChoice1 ,_fcg ,_eb ,_ggea float64 ,_dgb []string ,_eca *Rectangle ,_eeac bool )error {_bbe :=_abff ._daee ;_eag :=_abff ._aadd ;if _bfb ==nil {return _db .New ("\u004e\u006f\u0020\u0061xi\u0073\u0020\u0069\u006e\u0066\u006f\u0072\u006d\u0061\u0074\u0069\u006f\u006e");};if len (_bfb .ValAx )==0||(len (_bfb .CatAx )==0&&len (_bfb .DateAx )==0&&len (_bfb .SerAx )==0){return _db .New ("\u004e\u006f\u0020\u0078\u0020\u006f\u0072\u0020\u0079 \u0061\u0078\u0069\u0073");};var _cge ,_fec ,_dca ,_egbf uint32 ;var _ggd ,_bcde _ef .ST_AxPos ;var _fgd ,_ccee _ef .ST_TickMark ;var _gba ,_cff *_ef .CT_ChartLines ;var _ebd ,_cgfa _ef .ST_TickLblPos ;var _baag ,_dfb *_bg .CT_ShapeProperties ;var _baagd error ;if len (_bfb .ValAx )> 0{_fec ,_bcde ,_ccee ,_cgfa ,_cff ,_egbf ,_dfb ,_baagd =_fefg (_bfb .ValAx [0]);};if _bcde !=_ef .ST_AxPosL &&_bcde !=_ef .ST_AxPosB {return _db .New ("\u004f\u006e\u006c\u0079\u0020l\u0065\u0066\u0074\u0020\u006f\u0072\u0020\u0062\u006f\u0074\u0074\u006f\u006d \u0079\u0020\u0061\u0078\u0069\u0073\u0020\u0073\u0075\u0070\u0070\u006f\u0072\u0074\u0020\u0073\u006f\u0020\u0066\u0061\u0072");};_ccf :=_eca .Right -_eca .Left ;_gbfg :=_eca .Bottom -_eca .Top ;_gege :=_eb -_fcg ;_fba :=int (_gege /_ggea )+1;var _bdb ,_fge float64 ;switch _ccee {case _ef .ST_TickMarkIn :_bdb ,_fge =1,0;case _ef .ST_TickMarkOut :_bdb ,_fge =0,1;case _ef .ST_TickMarkCross :_bdb ,_fge =1,1;};_bdb =_aag (_bdb )*_eag ;_fge =_aag (_fge )*_eag ;var _fcc *_bg .CT_ShapeProperties ;if _cff !=nil {_fcc =_cff .SpPr ;};_fbf ,_bba :=_ebd !=_ef .ST_TickLblPosNone ,_cgfa !=_ef .ST_TickLblPosNone ;_ddc :=_fcg ;if _eeac {_ebc :=_ccf /_gege ;_ecag :=_eca .Bottom -_bdb ;_efg :=_eca .Bottom +_fge ;_aad :=_eca .Top ;_dee :=_eca .Bottom ;for _afe :=0;_afe < _fba ;_afe ++{_efe :=_eca .Left +(_ddc -_fcg )*_ebc ;_abff .drawLineWithProps (_dfb ,_efe ,_ecag ,_efe ,_efg ,true );_abff .drawLineWithProps (_fcc ,_efe ,_aad ,_efe ,_dee ,true );if _bba {_facg :=_bbe .NewParagraph (_ade .FormatFloat (_ddc ,'g',-1,64));_facg .SetFontSize (6*_eag );_facg .SetPos (_efe -_aag (0.5)*_eag ,_dee +_aag (1.5)*_eag );_bbe .Draw (_facg );};_ddc +=_ggea ;};}else {_cdb :=_gbfg /_gege ;_gfc :=_eca .Left -_fge ;_eeb :=_eca .Left +_bdb ;_fbddd :=_eca .Left ;_bee :=_eca .Right ;for _aega :=0;_aega < _fba ;_aega ++{_addc :=_eca .Bottom -(_ddc -_fcg )*_cdb ;_abff .drawLineWithProps (_dfb ,_gfc ,_addc ,_eeb ,_addc ,true );_abff .drawLineWithProps (_fcc ,_fbddd ,_addc ,_bee ,_addc ,true );if _bba {_ggeg :=_bbe .NewParagraph (_ade .FormatFloat (_ddc ,'g',-1,64));_ggeg .SetFontSize (6*_eag );_ggeg .SetPos (_fbddd -_aag (5)*_eag ,_addc -_aag (1.5)*_eag );_bbe .Draw (_ggeg );};_ddc +=_ggea ;};};if len (_bfb .CatAx )> 0{_cge ,_ggd ,_fgd ,_ebd ,_gba ,_dca ,_baag ,_baagd =_efed (_bfb .CatAx [0]);}else if len (_bfb .DateAx )> 0{_cge ,_ggd ,_fgd ,_ebd ,_gba ,_dca ,_baag ,_baagd =_fce (_bfb .DateAx [0]);}else if len (_bfb .SerAx )> 0{_cge ,_ggd ,_fgd ,_ebd ,_gba ,_dca ,_baag ,_baagd =_eace (_bfb .SerAx [0]);};if _baagd !=nil {return _baagd ;};if _ggd !=_ef .ST_AxPosL &&_ggd !=_ef .ST_AxPosB {return _db .New ("\u004f\u006e\u006c\u0079\u0020l\u0065\u0066\u0074\u0020\u006f\u0072\u0020\u0062\u006f\u0074\u0074\u006f\u006d \u0078\u0020\u0061\u0078\u0069\u0073\u0020\u0073\u0075\u0070\u0070\u006f\u0072\u0074\u0020\u0073\u006f\u0020\u0066\u0061\u0072");};if _cge !=_egbf ||_fec !=_dca {return _db .New ("a\u0078i\u0073\u0020\u0069\u0064\u0073\u0020\u0064\u006fn\u0027\u0074\u0020\u006dat\u0063\u0068");};_bdba :=len (_dgb )+1;var _deba ,_agg float64 ;switch _fgd {case _ef .ST_TickMarkIn :_deba ,_agg =1,0;case _ef .ST_TickMarkOut :_deba ,_agg =0,1;case _ef .ST_TickMarkCross :_deba ,_agg =1,1;};_deba =_aag (_deba )*_eag ;_agg =_aag (_agg )*_eag ;var _ggg *_bg .CT_ShapeProperties ;if _gba !=nil {_ggg =_gba .SpPr ;};if _eeac {_dccc :=_gbfg /float64 (len (_dgb ));_egbg :=_eca .Left -_fcg *_ccf /_gege ;_bbea :=_egbg -_agg ;_fcd :=_egbg +_deba ;_ebcf :=_eca .Left ;_ccge :=_eca .Right ;_def :=_egbg -_aag (7.5)*_eag ;for _dae :=0;_dae < _bdba ;_dae ++{_bda :=_eca .Bottom -float64 (_dae )*_dccc ;_abff .drawLineWithProps (_baag ,_bbea ,_bda ,_fcd ,_bda ,true );_abff .drawLineWithProps (_ggg ,_ebcf ,_bda ,_ccge ,_bda ,true );if _fbf &&_dae < _bdba -1{_ddcd :=_bbe .NewParagraph (_dgb [_dae ]);_ddcd .SetFontSize (6*_eag );_ddcd .SetPos (_def ,_bda -_dccc /2-2*_eag );_bbe .Draw (_ddcd );};};}else {_fcb :=_ccf /float64 (len (_dgb ));_dgga :=_eca .Bottom +_fcg *_gbfg /_gege ;_bcge :=_dgga -_deba ;_bfeg :=_dgga +_agg ;_ebe :=_eca .Top ;_dgd :=_eca .Bottom ;_beb :=_dgga +_aag (1.5)*_eag ;for _baaf :=0;_baaf < _bdba ;_baaf ++{_bea :=_eca .Left +float64 (_baaf )*_fcb ;_abff .drawLineWithProps (_baag ,_bea ,_bcge ,_bea ,_bfeg ,true );_abff .drawLineWithProps (_ggg ,_bea ,_ebe ,_bea ,_dgd ,true );if _fbf &&_baaf < _bdba -1{_eeacg :=_bbe .NewParagraph (_dgb [_baaf ]);_eeacg .SetFontSize (6*_eag );_eeacg .SetPos (_bea +_aag (5)*_eag ,_beb );_bbe .Draw (_eeacg );};};};return nil ;};type Rectangle struct{Top float64 ;Bottom float64 ;Left float64 ;Right float64 ;};func _bebb (_agf uint8 ,_fbaa float64 )string {_bca :=float64 (_agf );var _caa float64 ;if _fbaa < 0{_caa =_bca *(1+_fbaa );}else {_caa =_bca +(255-_bca )*_fbaa ;};return _d .Sprintf ("\u0025\u0030\u0032\u0078",int (_caa ));};func IsNoSpaceLanguage (symbol string )bool {for _ ,_cdae :=range symbol {if _a .Is (_a .Han ,_cdae ){return true ;};};return false ;};func RegisterFontsFromDirectory (dirName string )error {_aba ,_fabd :=_ad .Open (dirName );if _fabd !=nil {return _fabd ;};defer _aba .Close ();_ebeb ,_fabd :=_aba .Readdirnames (0);if _fabd !=nil {return _fabd ;};for _ ,_caeb :=range _ebeb {if _cd .HasSuffix (_caeb ,"\u002e\u0074\u0074\u0066"){_caf :=dirName +"\u002f"+_caeb ;_bdbf ,_ddf :=_bc .ParseFile (_caf );if _ddf !=nil {_f .Printf ("\u0043a\u006e\u006e\u006f\u0074 \u0070\u0061\u0072\u0073\u0065 \u0054T\u0046 \u0066\u0069\u006c\u0065\u0020\u0025\u0073\n",_ddf );continue ;};_cgfae :=_bdbf .GetNameByID (1);if _cgfae ==""{_f .Printf ("\u004e\u006f\u0020f\u006f\u006e\u0074\u0020\u0066\u0061\u006d\u0069\u006c\u0079\u0020\u0069\u006e\u0066\u006f\u0072\u006d\u0061\u0074\u0069\u006f\u006e\u0020\u0069\u006e\u0020\u0074\u0068\u0065 \u0066\u0069\u006c\u0065\u0020\u0025\u0073\u000a",_caf );continue ;};_ggfg :=_bdbf .GetNameByID (2);if _ggfg ==""{_f .Printf ("N\u006f\u0020\u0073\u0074\u0079\u006ce\u0020\u0069\u006e\u0066\u006f\u0072m\u0061\u0074\u0069\u006f\u006e\u0020\u0069n\u0020\u0074\u0068\u0065\u0020\u0066\u0069\u006c\u0065\u0020%\u0073",_caf );continue ;};_fbe ,_ddf :=_adg .NewCompositePdfFontFromTTFFile (_caf );if _ddf !=nil {_f .Printf ("\u0043\u0061nn\u006f\u0074\u0020m\u0061\u006b\u0065\u0020a f\u006fnt\u0020\u0066\u0072\u006f\u006d\u0020\u0054TF\u0020\u0066\u0069\u006c\u0065\u0020\u0025s\u000a",_ddf );continue ;};RegisterFont (_cgfae ,_fcgb [_ggfg ],_fbe );};};return nil ;};func _eace (_gdg *_ef .CT_SerAx )(uint32 ,_ef .ST_AxPos ,_ef .ST_TickMark ,_ef .ST_TickLblPos ,*_ef .CT_ChartLines ,uint32 ,*_bg .CT_ShapeProperties ,error ){var _fgbc ,_egc uint32 ;var _gdb _ef .ST_AxPos ;var _bcb _ef .ST_TickMark ;var _dbba *_ef .CT_ChartLines ;var _facf _ef .ST_TickLblPos ;if _gdg .AxId ==nil {return _fgbc ,_gdb ,_bcb ,_facf ,_dbba ,_egc ,_gdg .SpPr ,_db .New ("\u004e\u006f\u0020x\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");}else {_fgbc =_gdg .AxId .ValAttr ;};if _gdg .AxPos ==nil {return _fgbc ,_gdb ,_bcb ,_facf ,_dbba ,_egc ,_gdg .SpPr ,_db .New ("\u004eo\u0020x\u0020\u0061\u0078\u0069\u0073 \u0070\u006fs\u0069\u0074\u0069\u006f\u006e");}else {_gdb =_gdg .AxPos .ValAttr ;};if _gdg .MajorTickMark !=nil {_bcb =_gdg .MajorTickMark .ValAttr ;};if _gdg .TickLblPos !=nil {_facf =_gdg .TickLblPos .ValAttr ;};if _gdg .CrossAx ==nil {return _fgbc ,_gdb ,_bcb ,_facf ,_dbba ,_egc ,_gdg .SpPr ,_db .New ("\u004e\u006f \u0063\u0072\u006fs\u0073\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");}else {_egc =_gdg .CrossAx .ValAttr ;};_dbba =_gdg .MajorGridlines ;return _fgbc ,_gdb ,_bcb ,_facf ,_dbba ,_egc ,_gdg .SpPr ,nil ;};func (_gbad *creatorContext )drawRectangleWithProps (_fccc *_bg .CT_ShapeProperties ,_aege ,_eae ,_bfca ,_bfa float64 ,_gcff bool ){_gced :=_gbad ._daee .NewRectangle (_aege ,_eae ,_bfca ,_bfa );if _fccc ==nil {if _gcff {_gced .SetBorderWidth (_cce );}else {return ;};}else {_ead :=_gbad .getPdfColorFromSolidFill (_fccc .SolidFill );if _ead !=nil {_gced .SetFillColor (_ead );};if _eadg :=_fccc .Ln ;_eadg !=nil {if _fad :=_eadg .WAttr ;_fad !=nil {_ddd :=_dg .FromEMU (int64 (*_fad ));_gced .SetBorderWidth (_ddd );if _eaa :=_eadg .SolidFill ;_eaa !=nil {_fecg :=_gbad .getPdfColorFromSolidFill (_eaa );if _fecg !=nil {_gced .SetBorderColor (_fecg );};};}else {_gced .SetBorderWidth (0);};};};_gbad ._daee .Draw (_gced );};func (_bbcc *creatorContext )getPdfColorFromSolidFill (_gca *_bg .CT_SolidColorFillProperties )_dfdb .Color {if _gca ==nil {return nil ;};_bfcc :="";if _caea :=_gca .SrgbClr ;_caea !=nil {_bfcc =_caea .ValAttr ;}else if _dfa :=_gca .SchemeClr ;_dfa !=nil {_bfcc =_ecc (_dfa .ValAttr ,_bbcc ._aac );};if _bfcc ==""{return nil ;};return _dfdb .ColorRGBFromHex ("\u0023"+_bfcc );};type serValue struct{_gg string ;_cdd float64 ;_bag *_bg .CT_ShapeProperties ;};var StdFontsMap =map[string ][]string {"\u0048e\u006c\u0076\u0065\u0074\u0069\u0063a":[]string {"\u0048e\u006c\u0076\u0065\u0074\u0069\u0063a","\u0048\u0065\u006c\u0076\u0065\u0074\u0069\u0063\u0061-\u0042\u006f\u006c\u0064","\u0048\u0065\u006c\u0076\u0065\u0074\u0069\u0063\u0061\u002d\u004f\u0062l\u0069\u0071\u0075\u0065","H\u0065\u006c\u0076\u0065ti\u0063a\u002d\u0042\u006f\u006c\u0064O\u0062\u006c\u0069\u0071\u0075\u0065"},"\u0043o\u0075\u0072\u0069\u0065\u0072":[]string {"\u0043o\u0075\u0072\u0069\u0065\u0072","\u0043\u006f\u0075r\u0069\u0065\u0072\u002d\u0042\u006f\u006c\u0064","\u0043o\u0075r\u0069\u0065\u0072\u002d\u004f\u0062\u006c\u0069\u0071\u0075\u0065","\u0043\u006f\u0075\u0072ie\u0072\u002d\u0042\u006f\u006c\u0064\u004f\u0062\u006c\u0069\u0071\u0075\u0065"},"\u0054i\u006de\u0073\u0020\u004e\u0065\u0077\u0020\u0052\u006f\u006d\u0061\u006e":[]string {"T\u0069\u006d\u0065\u0073\u002d\u0052\u006f\u006d\u0061\u006e","\u0054\u0069\u006d\u0065\u0073\u002d\u0042\u006f\u006c\u0064","\u0054\u0069\u006de\u0073\u002d\u0049\u0074\u0061\u006c\u0069\u0063","\u0054\u0069m\u0065\u0073\u002dB\u006f\u006c\u0064\u0049\u0074\u0061\u006c\u0069\u0063"},"\u0064e\u0066\u0061\u0075\u006c\u0074":[]string {"\u0048e\u006c\u0076\u0065\u0074\u0069\u0063a","\u0048\u0065\u006c\u0076\u0065\u0074\u0069\u0063\u0061-\u0042\u006f\u006c\u0064","\u0048\u0065\u006c\u0076\u0065\u0074\u0069\u0063\u0061\u002d\u004f\u0062l\u0069\u0071\u0075\u0065","H\u0065\u006c\u0076\u0065ti\u0063a\u002d\u0042\u006f\u006c\u0064O\u0062\u006c\u0069\u0071\u0075\u0065"}};func _efed (_bfc *_ef .CT_CatAx )(uint32 ,_ef .ST_AxPos ,_ef .ST_TickMark ,_ef .ST_TickLblPos ,*_ef .CT_ChartLines ,uint32 ,*_bg .CT_ShapeProperties ,error ){var _fde ,_eead uint32 ;var _cgb _ef .ST_AxPos ;var _abb _ef .ST_TickMark ;var _aaeb *_ef .CT_ChartLines ;var _fab _ef .ST_TickLblPos ;if _bfc .AxId ==nil {return _fde ,_cgb ,_abb ,_fab ,_aaeb ,_eead ,_bfc .SpPr ,_db .New ("\u004e\u006f\u0020x\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");}else {_fde =_bfc .AxId .ValAttr ;};if _bfc .AxPos ==nil {return _fde ,_cgb ,_abb ,_fab ,_aaeb ,_eead ,_bfc .SpPr ,_db .New ("\u004eo\u0020x\u0020\u0061\u0078\u0069\u0073 \u0070\u006fs\u0069\u0074\u0069\u006f\u006e");}else {_cgb =_bfc .AxPos .ValAttr ;};if _bfc .MajorTickMark !=nil {_abb =_bfc .MajorTickMark .ValAttr ;};if _bfc .TickLblPos !=nil {_fab =_bfc .TickLblPos .ValAttr ;};if _bfc .CrossAx ==nil {return _fde ,_cgb ,_abb ,_fab ,_aaeb ,_eead ,_bfc .SpPr ,_db .New ("\u004e\u006f \u0063\u0072\u006fs\u0073\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");}else {_eead =_bfc .CrossAx .ValAttr ;};_aaeb =_bfc .MajorGridlines ;return _fde ,_cgb ,_abb ,_fab ,_aaeb ,_eead ,_bfc .SpPr ,nil ;};type FontStyle byte ;