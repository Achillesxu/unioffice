//
// Copyright 2020 FoxyUtils ehf. All rights reserved.
//
// This is a commercial product and requires a license to operate.
// A trial license can be obtained at https://unidoc.io
//
// DO NOT EDIT: generated by unitwist Go source code obfuscator.
//
// Use of this source code is governed by the UniDoc End User License Agreement
// terms that can be accessed at https://unidoc.io/eula/

package convertutils ;import (_ef "bytes";_fb "errors";_fc "fmt";_bc "github.com/unidoc/unioffice/common/logger";_efb "github.com/unidoc/unioffice/measurement";_cc "github.com/unidoc/unioffice/schema/soo/dml";_ad "github.com/unidoc/unioffice/schema/soo/dml/chart";_bg "github.com/unidoc/unioffice/spreadsheet/format";_ce "github.com/unidoc/unipdf/v3/creator";_eb "github.com/unidoc/unipdf/v3/model";_d "github.com/unidoc/unipdf/v3/render";_bf "github.com/unidoc/unitype";_bb "image";_e "math";_f "os";_be "sort";_efc "strconv";_ac "strings";_c "sync";_b "unicode";);func _dgg (_bgbb *_ad .CT_DateAx )(uint32 ,_ad .ST_AxPos ,_ad .ST_TickMark ,_ad .ST_TickLblPos ,*_ad .CT_ChartLines ,uint32 ,*_cc .CT_ShapeProperties ,error ){var _gdbb ,_ffg uint32 ;var _fdbe _ad .ST_AxPos ;var _fga _ad .ST_TickMark ;var _bgc *_ad .CT_ChartLines ;var _gffb _ad .ST_TickLblPos ;if _bgbb .AxId ==nil {return _gdbb ,_fdbe ,_fga ,_gffb ,_bgc ,_ffg ,_bgbb .SpPr ,_fb .New ("\u004e\u006f\u0020x\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");}else {_gdbb =_bgbb .AxId .ValAttr ;};if _bgbb .AxPos ==nil {return _gdbb ,_fdbe ,_fga ,_gffb ,_bgc ,_ffg ,_bgbb .SpPr ,_fb .New ("\u004eo\u0020x\u0020\u0061\u0078\u0069\u0073 \u0070\u006fs\u0069\u0074\u0069\u006f\u006e");}else {_fdbe =_bgbb .AxPos .ValAttr ;};if _bgbb .MajorTickMark !=nil {_fga =_bgbb .MajorTickMark .ValAttr ;};if _bgbb .TickLblPos !=nil {_gffb =_bgbb .TickLblPos .ValAttr ;};if _bgbb .CrossAx ==nil {return _gdbb ,_fdbe ,_fga ,_gffb ,_bgc ,_ffg ,_bgbb .SpPr ,_fb .New ("\u004e\u006f \u0063\u0072\u006fs\u0073\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");}else {_ffg =_bgbb .CrossAx .ValAttr ;};_bgc =_bgbb .MajorGridlines ;return _gdbb ,_fdbe ,_fga ,_gffb ,_bgc ,_ffg ,_bgbb .SpPr ,nil ;};func _gbfgc (_cgag *_ad .CT_CatAx )(uint32 ,_ad .ST_AxPos ,_ad .ST_TickMark ,_ad .ST_TickLblPos ,*_ad .CT_ChartLines ,uint32 ,*_cc .CT_ShapeProperties ,error ){var _cfce ,_bccf uint32 ;var _fdf _ad .ST_AxPos ;var _gdff _ad .ST_TickMark ;var _dfg *_ad .CT_ChartLines ;var _cfb _ad .ST_TickLblPos ;if _cgag .AxId ==nil {return _cfce ,_fdf ,_gdff ,_cfb ,_dfg ,_bccf ,_cgag .SpPr ,_fb .New ("\u004e\u006f\u0020x\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");}else {_cfce =_cgag .AxId .ValAttr ;};if _cgag .AxPos ==nil {return _cfce ,_fdf ,_gdff ,_cfb ,_dfg ,_bccf ,_cgag .SpPr ,_fb .New ("\u004eo\u0020x\u0020\u0061\u0078\u0069\u0073 \u0070\u006fs\u0069\u0074\u0069\u006f\u006e");}else {_fdf =_cgag .AxPos .ValAttr ;};if _cgag .MajorTickMark !=nil {_gdff =_cgag .MajorTickMark .ValAttr ;};if _cgag .TickLblPos !=nil {_cfb =_cgag .TickLblPos .ValAttr ;};if _cgag .CrossAx ==nil {return _cfce ,_fdf ,_gdff ,_cfb ,_dfg ,_bccf ,_cgag .SpPr ,_fb .New ("\u004e\u006f \u0063\u0072\u006fs\u0073\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");}else {_bccf =_cgag .CrossAx .ValAttr ;};_dfg =_cgag .MajorGridlines ;return _cfce ,_fdf ,_gdff ,_cfb ,_dfg ,_bccf ,_cgag .SpPr ,nil ;};var _ddff =fontsMap {_dgcd :&_c .Mutex {},_fca :map[string ]map[FontStyle ]*_eb .PdfFont {}};type creatorContext struct{_dae *_ce .Creator ;_bfgd *_cc .Theme ;_badb float64 ;};const (ImgPart_whole ImgPart =0;ImgPart_t ImgPart =1;ImgPart_b ImgPart =2;ImgPart_l ImgPart =3;ImgPart_r ImgPart =4;ImgPart_lt ImgPart =5;ImgPart_rt ImgPart =6;ImgPart_lb ImgPart =7;ImgPart_rb ImgPart =8;);func _ggd (_ccdg string )error {if !_ac .HasSuffix (_ccdg ,"\u002e\u0074\u0074\u0066"){_bc .Log .Debug ("\u0055\u006es\u0075\u0070\u0070\u006f\u0072\u0074\u0065\u0064\u0020\u0066\u006f\u006e\u0074\u0020\u0066\u0069\u006c\u0065\u0020\u0066\u006f\u0072ma\u0074\u002e");return _fc .Errorf ("\u0055\u006e\u0073\u0075\u0070\u0070o\u0072\u0074\u0065\u0064\u0020f\u006f\u006e\u0074\u0020\u0066\u0069l\u0065\u0020\u0066\u006f\u0072m\u0061\u0074\u002c\u0020\u0063\u0075\u0072\u0072\u0065\u006e\u0074\u006cy\u0020\u006f\u006e\u006c\u0079\u0020\u0073\u0075\u0070\u0070\u006f\u0072\u0074\u0020\u0054T\u0046\u0020\u0066\u006f\u006e\u0074\u0020\u0066i\u006c\u0065\u002e");};_afdb ,_agfg :=_bf .ParseFile (_ccdg );if _agfg !=nil {_bc .Log .Debug ("\u0043a\u006e\u006e\u006f\u0074\u0020\u0070\u0061\u0072\u0073\u0065\u0020T\u0054\u0046\u0020\u0066\u0069\u006c\u0065\u0020\u0025\u0073",_agfg );return _agfg ;};_ceb ,_agfg :=_eb .NewCompositePdfFontFromTTFFile (_ccdg );if _agfg !=nil {return _agfg ;};_egfg :=_afdb .GetNameRecords ();for _ ,_eaba :=range _egfg {_ebc :=_eaba [1];if _ebc ==""{return _fc .Errorf ("\u004e\u006f\u0020\u0066\u006fn\u0074\u0020\u0066\u0061\u006d\u0069\u006c\u0079\u0020\u0069\u006e\u0066\u006fr\u006d\u0061\u0074\u0069\u006f\u006e\u0020\u0069\u006e\u0020\u0074\u0068\u0065\u0020\u0066\u0069\u006c\u0065\u0020\u0025\u0073",_ccdg );};_baa :=make ([]byte ,0);for _cff :=0;_cff < len (_ebc );_cff ++{if _ebc [_cff ]==39||_ebc [_cff ]==92{continue ;};_ceg :=4;if _cff +_ceg < len (_ebc ){if _ebc [_cff :_cff +_ceg ]=="\u0000"{_cff =_cff +_ceg +1;continue ;};};_baa =append (_baa ,_ebc [_cff ]);};_ebc =_ac .Replace (string (_baa ),"\u0078\u0030\u0030","",-1);_dgf :=_eaba [2];if _dgf ==""{return _fc .Errorf ("N\u006f\u0020\u0073\u0074\u0079\u006ce\u0020\u0069\u006e\u0066\u006f\u0072m\u0061\u0074\u0069\u006f\u006e\u0020\u0069n\u0020\u0074\u0068\u0065\u0020\u0066\u0069\u006c\u0065\u0020%\u0073",_ccdg );};_baa =make ([]byte ,0);for _efdb :=0;_efdb < len (_dgf );_efdb ++{if _dgf [_efdb ]==39||_dgf [_efdb ]==92{continue ;};_abf :=4;if _efdb +_abf < len (_dgf ){if _dgf [_efdb :_efdb +_abf ]=="\u0000"{_efdb =_efdb +_abf +1;continue ;};};_baa =append (_baa ,_dgf [_efdb ]);};_dgf =_ac .Replace (string (_baa ),"\u0078\u0030\u0030","",-1);RegisterFont (_ebc ,_bbfd [_dgf ],_ceb );};return nil ;};var _bca =_gcb (1.5);var _begf =_gcb (1);func GetRegisteredFont (name string ,style FontStyle )*_eb .PdfFont {_ddff ._dgcd .Lock ();defer _ddff ._dgcd .Unlock ();if _fcbc ,_cdag :=_ddff ._fca [name ];_cdag {if _deef ,_gbeb :=_fcbc [style ];_gbeb {return _deef ;};};return nil ;};func RegisterFont (name string ,style FontStyle ,font *_eb .PdfFont ){_ddff ._dgcd .Lock ();if _ddff ._fca [name ]==nil {_ddff ._fca [name ]=map[FontStyle ]*_eb .PdfFont {};};_ddff ._fca [name ][style ]=font ;_ddff ._dgcd .Unlock ();};func FromSTCoordinate (st _cc .ST_Coordinate )int64 {if _bgf :=st .ST_CoordinateUnqualified ;_bgf !=nil {return *_bgf ;};return 0;};type serCategory struct{_fge string ;_fgb []serValue ;};func (_cgde *creatorContext )drawLegend (_bac *Rectangle ,_ffee []*legendItem ,_fbc bool ){_gag :=_cgde ._badb ;_afb :=_gcb (2.5)*_gag ;_feb :=_eaa *_gag ;_cge :=(_afb -_feb )/2;_dba :=float64 (len (_ffee ));if _fbc {_gcee :=&Rectangle {Top :_bac .Top +_gcb (1)*_gag ,Bottom :_bac .Bottom -_gcb (1)*_gag ,Left :_bac .Left +_gcb (2.5)*_gag ,Right :_bac .Right -_gcb (2.5)*_gag };var _baf float64 ;if _dba > 1{_baf =(_gcee .Right -_gcee .Left )/_dba ;};_eab :=_gcee .Left ;_bbc :=_gcee .Top ;for _ ,_fffd :=range _ffee {if _daa :=_fffd ._cae ;_daa !=nil {_cgde .drawRectangleWithProps (_daa ,_eab ,_bbc +_cge ,_feb ,_feb ,false );_fac :=_eab +_feb *2;_gfg :=_cgde ._dae .NewStyledParagraph ();_gfg .SetPos (_fac ,_bbc );_aae :=_gfg .Append (_fffd ._fgc );_eca ,_cad :=_eb .NewStandard14Font (_eb .HelveticaName );if _cad ==nil {_aae .Style =_ce .TextStyle {FontSize :_afb ,Font :_eca ,TextRise :0.4};_cgde ._dae .Draw (_gfg );};};_eab +=_baf ;};}else {_ddbe :=&Rectangle {Top :_bac .Top +_gcb (2.5)*_gag ,Bottom :_bac .Bottom -_gcb (2.5)*_gag ,Left :_bac .Left +_gcb (2.5)*_gag ,Right :_bac .Right -_gcb (2.5)*_gag };var _ecgg float64 ;if _dba > 1{_ecgg =(_ddbe .Bottom -_ddbe .Top -_afb )/(_dba -1);};_bcc :=_ddbe .Top ;_eag :=_ddbe .Left ;_aefe :=_eag +_feb *2;for _ ,_edb :=range _ffee {if _fdga :=_edb ._cae ;_fdga !=nil {_cgde .drawRectangleWithProps (_fdga ,_eag ,_bcc +_cge ,_feb ,_feb ,false );_ge :=_cgde ._dae .NewStyledParagraph ();_ge .SetPos (_aefe ,_bcc );_dcg :=_ge .Append (_edb ._fgc );_ccce ,_cdgg :=_eb .NewStandard14Font (_eb .HelveticaName );if _cdgg ==nil {_dcg .Style =_ce .TextStyle {FontSize :_afb ,Font :_ccce ,TextRise :0.4};_cgde ._dae .Draw (_ge );};};_bcc +=_ecgg ;};};};func DrawLine (c *_ce .Creator ,x0 ,y0 ,x1 ,y1 ,width float64 ,color _ce .Color ){if color ==nil {return ;};_aefg :=c .NewLine (x0 ,y0 ,x1 ,y1 );_aefg .SetLineWidth (width );_aefg .SetColor (color );c .Draw (_aefg );};func (_cfcf *creatorContext )drawBorderWithProps (_gcea *_cc .CT_ShapeProperties ,_ddce *Rectangle ,_adag float64 ){if _ddce !=nil &&_gcea !=nil &&_gcea .Ln !=nil &&_gcea .Ln .SolidFill !=nil {_cgae :=_cfcf .getPdfColorFromSolidFill (_gcea .Ln .SolidFill );DrawRectangle (_cfcf ._dae ,_ddce ,_adag ,_cgae );};};func MakeBlockFromCreator (c *_ce .Creator )(*_ce .Block ,error ){_abba ,_bfb :=GetPageFromCreator (c );if _bfb !=nil {return nil ,_bfb ;};_fafb ,_bfb :=_ce .NewBlockFromPage (_abba );if _bfb !=nil {return nil ,_bfb ;};return _fafb ,nil ;};var _bacf =_gcb (1.5);func AdjustColorByTint (colorStr string ,tint float64 )string {var _fcd ,_fbce ,_aecf uint8 ;_bef ,_ :=_fc .Sscanf (colorStr ,"\u0025\u0030\u0032x\u0025\u0030\u0032\u0078\u0025\u0030\u0032\u0078",&_fcd ,&_fbce ,&_aecf );if _bef !=3{return "";};return _deb (_fcd ,tint )+_deb (_fbce ,tint )+_deb (_aecf ,tint );};type legendItem struct{_fgc string ;_cae *_cc .CT_ShapeProperties ;};func IsNoSpaceLanguage (symbol string )bool {for _ ,_cbeg :=range symbol {if _b .Is (_b .Han ,_cbeg ){return true ;};};return false ;};func AdjustColor (colorStr string ,EG_ColorTransform []*_cc .EG_ColorTransform )string {for _ ,_gad :=range EG_ColorTransform {if _cage :=_gad .Tint ;_cage !=nil {if _aaca :=_cage .ValAttr .ST_PositiveFixedPercentageDecimal ;_aaca !=nil {colorStr =AdjustColorByTint (colorStr ,float64 (*_aaca )/100000);};};if _gbgf :=_gad .Shade ;_gbgf !=nil {if _bda :=_gbgf .ValAttr .ST_PositiveFixedPercentageDecimal ;_bda !=nil {colorStr =AdjustColorByShade (colorStr ,float64 (*_bda )/100000);};};if _ccfe :=_gad .LumMod ;_ccfe !=nil {if _bfde :=_ccfe .ValAttr .ST_PercentageDecimal ;_bfde !=nil {colorStr =AdjustColorByLumMod (colorStr ,float64 (*_bfde )/100000);};};};return colorStr ;};func GetPageFromCreator (c *_ce .Creator )(*_eb .PdfPage ,error ){_aead :=_ef .NewBuffer ([]byte {});_bggb :=c .Write (_aead );if _bggb !=nil {return nil ,_bggb ;};_dagf :=_ef .NewReader (_aead .Bytes ());_bdd ,_bggb :=_eb .NewPdfReader (_dagf );if _bggb !=nil {return nil ,_bggb ;};return _bdd .GetPage (1);};func _dfa (_eaec ,_ffae ,_aeag float64 )(uint8 ,uint8 ,uint8 ){var _cgfe float64 ;if _aeag < 0.5{_cgfe =_aeag *(1+_ffae );}else {_cgfe =_aeag +_ffae -_aeag *_ffae ;};_fffc :=_aeag *2-_cgfe ;_eaec /=360.0;_fgad :=_agg (_eaec +1.0/3.0);_abeg :=_agg (_eaec );_fagg :=_agg (_eaec -1.0/3.0);_cdeb :=_geeg (_fgad ,_cgfe ,_fffc );_dec :=_geeg (_abeg ,_cgfe ,_fffc );_bggd :=_geeg (_fagg ,_cgfe ,_fffc );return uint8 (255*_cdeb ),uint8 (255*_dec ),uint8 (255*_bggd );};func _feae (_cdb _cc .ST_SchemeColorVal ,_abg *_cc .Theme )string {if _bdc :=_abg .ThemeElements ;_bdc !=nil {if _aecc :=_bdc .ClrScheme ;_aecc !=nil {switch _cdb {case _cc .ST_SchemeColorValLt1 :return GetColorStringFromDmlColor (_aecc .Lt1 );case _cc .ST_SchemeColorValDk1 ,_cc .ST_SchemeColorValTx1 :return GetColorStringFromDmlColor (_aecc .Dk1 );case _cc .ST_SchemeColorValLt2 :return GetColorStringFromDmlColor (_aecc .Lt2 );case _cc .ST_SchemeColorValDk2 :return GetColorStringFromDmlColor (_aecc .Dk2 );case _cc .ST_SchemeColorValAccent1 :return GetColorStringFromDmlColor (_aecc .Accent1 );case _cc .ST_SchemeColorValAccent2 :return GetColorStringFromDmlColor (_aecc .Accent2 );case _cc .ST_SchemeColorValAccent3 :return GetColorStringFromDmlColor (_aecc .Accent3 );case _cc .ST_SchemeColorValAccent4 :return GetColorStringFromDmlColor (_aecc .Accent4 );case _cc .ST_SchemeColorValAccent5 :return GetColorStringFromDmlColor (_aecc .Accent5 );case _cc .ST_SchemeColorValAccent6 :return GetColorStringFromDmlColor (_aecc .Accent6 );};};};return "";};func AdjustColorByShade (colorStr string ,shade float64 )string {var _edba ,_ddf ,_faf uint8 ;_eac ,_ :=_fc .Sscanf (colorStr ,"\u0025\u0030\u0032x\u0025\u0030\u0032\u0078\u0025\u0030\u0032\u0078",&_edba ,&_ddf ,&_faf );if _eac !=3{return "";};return _dda (_edba ,shade )+_dda (_ddf ,shade )+_dda (_faf ,shade );};var _fecd =_gcb (2);func TwipsFromPoints (points float64 )float64 {return points /_efb .Twips };func (_dde barSerByOrder )Len ()int {return len (_dde )};type BorderPosition byte ;func FromSTCoordinate32 (st _cc .ST_Coordinate32 )int64 {if _eccb :=st .ST_Coordinate32Unqualified ;_eccb !=nil {return int64 (*_eccb );};return 0;};var _aaa =_gcb (7.5);func (_dce *creatorContext )drawLineWithProps (_bbff *_cc .CT_ShapeProperties ,_bgce ,_efcf ,_aca ,_faca float64 ,_fdge bool ){if _bbff !=nil {if _efde :=_bbff .Ln ;_efde !=nil {_deec :=_dce .getPdfColorFromSolidFill (_efde .SolidFill );if _deec ==nil &&_fdge {_deec =_ce .ColorBlack ;};if _deec !=nil {var _eeceg float64 ;if _fgd :=_efde .WAttr ;_fgd !=nil {_eeceg =_efb .FromEMU (int64 (*_fgd ));}else {_eeceg =_gdd ;};DrawLine (_dce ._dae ,_bgce ,_efcf ,_aca ,_faca ,_eeceg ,_deec );};};};};func (_fcb barSerByOrder )Swap (i ,j int ){_fcb [i ],_fcb [j ]=_fcb [j ],_fcb [i ]};type serValue struct{_gcc string ;_fff float64 ;_cab *_cc .CT_ShapeProperties ;};func (_agd *creatorContext )getPdfColorFromSolidFill (_edga *_cc .CT_SolidColorFillProperties )_ce .Color {if _edga ==nil {return nil ;};_bgfb :="";if _bafg :=_edga .SrgbClr ;_bafg !=nil {_bgfb =_bafg .ValAttr ;}else if _gdee :=_edga .SchemeClr ;_gdee !=nil {_bgfb =_feae (_gdee .ValAttr ,_agd ._bfgd );};if _bgfb ==""{return nil ;};return _ce .ColorRGBFromHex ("\u0023"+_bgfb );};type barSerByOrder []*_ad .CT_BarSer ;func GetImage (c *_ce .Creator ,goImg _bb .Image ,imgHeight ,imgWidth ,left ,top ,dividerX ,dividerY float64 ,part ImgPart )(*_ce .Image ,error ){if goImg ==nil {return nil ,nil ;};_gceg :=goImg .Bounds ().Size ();_gagf :=_gceg .X ;_feacc :=_gceg .Y ;if dividerX !=0{dividerX =dividerX /imgWidth *float64 (_gagf );};if dividerY !=0{dividerY =dividerY /imgHeight *float64 (_feacc );};var _deea _bb .Rectangle ;switch part {case ImgPart_t :_deea =_bb .Rect (0,0,_gagf ,int (dividerY ));case ImgPart_b :_deea =_bb .Rect (0,int (dividerY ),_gagf ,_feacc );case ImgPart_l :_deea =_bb .Rect (0,0,int (dividerX ),_feacc );case ImgPart_r :_deea =_bb .Rect (int (dividerX ),0,_gagf ,_feacc );case ImgPart_lt :_deea =_bb .Rect (0,0,int (dividerX ),int (dividerY ));case ImgPart_rt :_deea =_bb .Rect (int (dividerX ),0,_gagf ,int (dividerY ));case ImgPart_lb :_deea =_bb .Rect (0,int (dividerY ),int (dividerX ),_feacc );case ImgPart_rb :_deea =_bb .Rect (int (dividerX ),int (dividerY ),_gagf ,_feacc );default:_deea =_bb .Rect (0,0,_gagf ,_feacc );};_fdgf :=CropImageByRect (goImg ,_deea );_egdf ,_cedd :=c .NewImageFromGoImage (_fdgf );if _cedd !=nil {return nil ,_cedd ;};_egdf .Scale (imgWidth /float64 (_gagf ),imgHeight /float64 (_feacc ));_egdf .SetPos (left ,top );return _egdf ,nil ;};var StdFontsMap =map[string ][]string {"\u0048e\u006c\u0076\u0065\u0074\u0069\u0063a":[]string {"\u0048e\u006c\u0076\u0065\u0074\u0069\u0063a","\u0048\u0065\u006c\u0076\u0065\u0074\u0069\u0063\u0061-\u0042\u006f\u006c\u0064","\u0048\u0065\u006c\u0076\u0065\u0074\u0069\u0063\u0061\u002d\u004f\u0062l\u0069\u0071\u0075\u0065","H\u0065\u006c\u0076\u0065ti\u0063a\u002d\u0042\u006f\u006c\u0064O\u0062\u006c\u0069\u0071\u0075\u0065"},"\u0043o\u0075\u0072\u0069\u0065\u0072":[]string {"\u0043o\u0075\u0072\u0069\u0065\u0072","\u0043\u006f\u0075r\u0069\u0065\u0072\u002d\u0042\u006f\u006c\u0064","\u0043o\u0075r\u0069\u0065\u0072\u002d\u004f\u0062\u006c\u0069\u0071\u0075\u0065","\u0043\u006f\u0075\u0072ie\u0072\u002d\u0042\u006f\u006c\u0064\u004f\u0062\u006c\u0069\u0071\u0075\u0065"},"\u0054i\u006de\u0073\u0020\u004e\u0065\u0077\u0020\u0052\u006f\u006d\u0061\u006e":[]string {"T\u0069\u006d\u0065\u0073\u002d\u0052\u006f\u006d\u0061\u006e","\u0054\u0069\u006d\u0065\u0073\u002d\u0042\u006f\u006c\u0064","\u0054\u0069\u006de\u0073\u002d\u0049\u0074\u0061\u006c\u0069\u0063","\u0054\u0069m\u0065\u0073\u002dB\u006f\u006c\u0064\u0049\u0074\u0061\u006c\u0069\u0063"},"\u0064e\u0066\u0061\u0075\u006c\u0074":[]string {"\u0048e\u006c\u0076\u0065\u0074\u0069\u0063a","\u0048\u0065\u006c\u0076\u0065\u0074\u0069\u0063\u0061-\u0042\u006f\u006c\u0064","\u0048\u0065\u006c\u0076\u0065\u0074\u0069\u0063\u0061\u002d\u004f\u0062l\u0069\u0071\u0075\u0065","H\u0065\u006c\u0076\u0065ti\u0063a\u002d\u0042\u006f\u006c\u0064O\u0062\u006c\u0069\u0071\u0075\u0065"}};func Lighten (clr float64 )float64 {return 0.6+0.4*clr };var _gdd =_gcb (0.125);func _dda (_dcgd uint8 ,_gbaa float64 )string {_gfbd :=float64 (_dcgd );return _fc .Sprintf ("\u0025\u0030\u0032\u0078",int (_gfbd *_gbaa ));};const _eea =6.0;var _eaa =_gcb (1.5);func (_gffc FontStyle )String ()string {return []string {"\u0052e\u0067\u0075\u006c\u0061\u0072","\u0042\u006f\u006c\u0064","\u0049\u0074\u0061\u006c\u0069\u0063","\u0042\u006f\u006c\u0064\u0049\u0074\u0061\u006c\u0069\u0063"}[int (_gffc )];};func DrawRectangle (c *_ce .Creator ,r *Rectangle ,w float64 ,color _ce .Color ){if color ==nil {return ;};DrawLine (c ,r .Left ,r .Top ,r .Right ,r .Top ,w ,color );DrawLine (c ,r .Left ,r .Top ,r .Left ,r .Bottom ,w ,color );DrawLine (c ,r .Left ,r .Bottom ,r .Right ,r .Bottom ,w ,color );DrawLine (c ,r .Right ,r .Top ,r .Right ,r .Bottom ,w ,color );};type Rectangle struct{Top float64 ;Bottom float64 ;Left float64 ;Right float64 ;};func (_ag barSerByOrder )Less (i ,j int )bool {return _ag [i ].Order .ValAttr < _ag [j ].Order .ValAttr };const (BorderPositionTop BorderPosition =0;BorderPositionLeft BorderPosition =1;BorderPositionBottom BorderPosition =2;BorderPositionRight BorderPosition =3;);var _facb =_gcb (0.5);func _gcb (_gbbe float64 )float64 {return _gbbe *_efb .Millimeter };func GetDataFromXfrm (xfrm *_cc .CT_Transform2D )(float64 ,float64 ,float64 ,float64 ){var _agb ,_gbaf ,_cdec ,_eeb float64 ;if _dbf :=xfrm .Off ;_dbf !=nil {_agb =_efb .FromEMU (FromSTCoordinate (_dbf .XAttr ));_gbaf =_efb .FromEMU (FromSTCoordinate (_dbf .YAttr ));};if _gfe :=xfrm .Ext ;_gfe !=nil {_cdec =_efb .FromEMU (_gfe .CxAttr );_eeb =_efb .FromEMU (_gfe .CyAttr );};return _agb ,_gbaf ,_cdec ,_eeb ;};func (_gcgc *Rectangle )Translate (x ,y float64 ){_gcgc .Left +=x ;_gcgc .Right +=x ;_gcgc .Top +=y ;_gcgc .Bottom +=y ;};func _bdf (_fgac *_ad .CT_SerAx )(uint32 ,_ad .ST_AxPos ,_ad .ST_TickMark ,_ad .ST_TickLblPos ,*_ad .CT_ChartLines ,uint32 ,*_cc .CT_ShapeProperties ,error ){var _dac ,_gaeec uint32 ;var _aaae _ad .ST_AxPos ;var _gef _ad .ST_TickMark ;var _fgea *_ad .CT_ChartLines ;var _aded _ad .ST_TickLblPos ;if _fgac .AxId ==nil {return _dac ,_aaae ,_gef ,_aded ,_fgea ,_gaeec ,_fgac .SpPr ,_fb .New ("\u004e\u006f\u0020x\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");}else {_dac =_fgac .AxId .ValAttr ;};if _fgac .AxPos ==nil {return _dac ,_aaae ,_gef ,_aded ,_fgea ,_gaeec ,_fgac .SpPr ,_fb .New ("\u004eo\u0020x\u0020\u0061\u0078\u0069\u0073 \u0070\u006fs\u0069\u0074\u0069\u006f\u006e");}else {_aaae =_fgac .AxPos .ValAttr ;};if _fgac .MajorTickMark !=nil {_gef =_fgac .MajorTickMark .ValAttr ;};if _fgac .TickLblPos !=nil {_aded =_fgac .TickLblPos .ValAttr ;};if _fgac .CrossAx ==nil {return _dac ,_aaae ,_gef ,_aded ,_fgea ,_gaeec ,_fgac .SpPr ,_fb .New ("\u004e\u006f \u0063\u0072\u006fs\u0073\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");}else {_gaeec =_fgac .CrossAx .ValAttr ;};_fgea =_fgac .MajorGridlines ;return _dac ,_aaae ,_gef ,_aded ,_fgea ,_gaeec ,_fgac .SpPr ,nil ;};const (FontStyle_Regular FontStyle =0;FontStyle_Bold FontStyle =1;FontStyle_Italic FontStyle =2;FontStyle_BoldItalic FontStyle =3;);func _geeg (_ecdb ,_dbg ,_baga float64 )float64 {if _ecdb *6< 1{return _baga +(_dbg -_baga )*6*_ecdb ;}else if _ecdb *2< 1{return _dbg ;}else if _ecdb *3< 2{return _baga +(_dbg -_baga )*(2.0/3.0-_ecdb )*6;}else {return _baga ;};};func (_bec *Rectangle )scale (_aabec float64 ){_bec .Top *=_aabec ;_bec .Bottom *=_aabec ;_bec .Left *=_aabec ;_bec .Right *=_aabec ;};var _gbfg =_gcb (5);func RegisterFontsFromFiles (files []string )error {for _ ,_fffa :=range files {if _ac .HasSuffix (_fffa ,"\u002e\u0074\u0074\u0066"){_gga :=_ggd (_fffa );if _gga !=nil {_bc .Log .Debug ("\u0075\u006ea\u0062\u006c\u0065\u0020\u0074o\u0020\u0070\u0072\u006f\u0063e\u0073\u0073\u0020\u0061\u006e\u0064\u0020\u0072\u0065\u0067\u0069\u0073\u0074\u0065\u0072\u0020\u0066\u006f\u006e\u0074\u0020\u0066\u0072\u006f\u006d\u0020\u0054\u0054\u0046\u0020\u0066\u0069\u006c\u0065\u0020\u0025\u0073",_gga );continue ;};};};return nil ;};func AdjustColorByLumMod (colorStr string ,lum float64 )string {var _gbga ,_eacc ,_dcbfc uint8 ;_efcd ,_ :=_fc .Sscanf (colorStr ,"\u0025\u0030\u0032x\u0025\u0030\u0032\u0078\u0025\u0030\u0032\u0078",&_gbga ,&_eacc ,&_dcbfc );if _efcd !=3{return "";};_eedd ,_aabe ,_acb :=_gcg (_gbga ,_eacc ,_dcbfc );_acb =lum *_acb ;_gbga ,_eacc ,_dcbfc =_dfa (_eedd ,_aabe ,_acb );return _fc .Sprintf ("\u0025\u0030\u0032x\u0025\u0030\u0032\u0078\u0025\u0030\u0032\u0078",_gbga ,_eacc ,_dcbfc );};func MakeTempCreator (width ,height float64 )*_ce .Creator {_gfga :=_ce .New ();_gfga .SetPageSize (_ce .PageSize {width ,height });_gfga .SetPageMargins (0,0,0,0);return _gfga ;};func _dfb (_afce _cc .ST_SchemeColorVal ,_dcf *_cc .Theme )string {if _agf :=_dcf .ThemeElements ;_agf !=nil {if _dgd :=_agf .ClrScheme ;_dgd !=nil {switch _afce {case _cc .ST_SchemeColorValLt1 :return GetColorStringFromDmlColor (_dgd .Lt1 );case _cc .ST_SchemeColorValDk1 ,_cc .ST_SchemeColorValTx1 :return GetColorStringFromDmlColor (_dgd .Dk1 );case _cc .ST_SchemeColorValLt2 :return GetColorStringFromDmlColor (_dgd .Lt2 );case _cc .ST_SchemeColorValDk2 :return GetColorStringFromDmlColor (_dgd .Dk2 );case _cc .ST_SchemeColorValAccent1 :return GetColorStringFromDmlColor (_dgd .Accent1 );case _cc .ST_SchemeColorValAccent2 :return GetColorStringFromDmlColor (_dgd .Accent2 );case _cc .ST_SchemeColorValAccent3 :return GetColorStringFromDmlColor (_dgd .Accent3 );case _cc .ST_SchemeColorValAccent4 :return GetColorStringFromDmlColor (_dgd .Accent4 );case _cc .ST_SchemeColorValAccent5 :return GetColorStringFromDmlColor (_dgd .Accent5 );case _cc .ST_SchemeColorValAccent6 :return GetColorStringFromDmlColor (_dgd .Accent6 );};};};return "";};func _deb (_dge uint8 ,_cgaag float64 )string {_dgc :=float64 (_dge );var _geee float64 ;if _cgaag < 0{_geee =_dgc *(1+_cgaag );}else {_geee =_dgc +(255-_dgc )*_cgaag ;};return _fc .Sprintf ("\u0025\u0030\u0032\u0078",int (_geee ));};func _bag (_gaf *_ad .CT_ValAx )(uint32 ,_ad .ST_AxPos ,_ad .ST_TickMark ,_ad .ST_TickLblPos ,*_ad .CT_ChartLines ,uint32 ,*_cc .CT_ShapeProperties ,error ){var _dggd ,_bdfc uint32 ;var _ceae _ad .ST_AxPos ;var _ccd _ad .ST_TickMark ;var _efge *_ad .CT_ChartLines ;var _ada _ad .ST_TickLblPos ;if _gaf .AxId ==nil {return _dggd ,_ceae ,_ccd ,_ada ,_efge ,_bdfc ,_gaf .SpPr ,_fb .New ("\u004e\u006f\u0020x\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");}else {_dggd =_gaf .AxId .ValAttr ;};if _gaf .AxPos ==nil {return _dggd ,_ceae ,_ccd ,_ada ,_efge ,_bdfc ,_gaf .SpPr ,_fb .New ("\u004eo\u0020x\u0020\u0061\u0078\u0069\u0073 \u0070\u006fs\u0069\u0074\u0069\u006f\u006e");}else {_ceae =_gaf .AxPos .ValAttr ;};if _gaf .MajorTickMark !=nil {_ccd =_gaf .MajorTickMark .ValAttr ;};if _gaf .TickLblPos !=nil {_ada =_gaf .TickLblPos .ValAttr ;};if _gaf .CrossAx ==nil {return _dggd ,_ceae ,_ccd ,_ada ,_efge ,_bdfc ,_gaf .SpPr ,_fb .New ("\u004e\u006f \u0063\u0072\u006fs\u0073\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");}else {_bdfc =_gaf .CrossAx .ValAttr ;};_efge =_gaf .MajorGridlines ;return _dggd ,_ceae ,_ccd ,_ada ,_efge ,_bdfc ,_gaf .SpPr ,nil ;};func FromSTPercentage (st *_cc .ST_Percentage )float64 {if _eeab :=st .ST_PercentageDecimal ;_eeab !=nil {return float64 (*_eeab )/100000;};return 0;};func GetOpacityFromColorTransform (trs []*_cc .EG_ColorTransform )float64 {for _ ,_febb :=range trs {if _febb !=nil {if _fae :=_febb .Alpha ;_fae !=nil {if _dbef :=_fae .ValAttr .ST_PositiveFixedPercentageDecimal ;_dbef !=nil {return float64 (*_dbef )/100000;};};};};return 1.0;};func AssignStdFontByName (style _ce .TextStyle ,fontName string )*_eb .PdfFont {_fce :=_eb .StdFontName (fontName );return _eb .NewStandard14FontMustCompile (_fce );};func RegisterFontsFromDirectory (dirName string )error {_efff ,_dffb :=_f .Open (dirName );if _dffb !=nil {return _dffb ;};defer _efff .Close ();_gfbc ,_dffb :=_efff .Readdirnames (0);if _dffb !=nil {return _dffb ;};for _ ,_bafd :=range _gfbc {if _ac .HasSuffix (_bafd ,"\u002e\u0074\u0074\u0066"){_bgcf :=dirName +"\u002f"+_bafd ;_ebd :=_ggd (_bgcf );if _ebd !=nil {_bc .Log .Debug ("\u0075\u006ea\u0062\u006c\u0065\u0020\u0074o\u0020\u0070\u0072\u006f\u0063e\u0073\u0073\u0020\u0061\u006e\u0064\u0020\u0072\u0065\u0067\u0069\u0073\u0074\u0065\u0072\u0020\u0066\u006f\u006e\u0074\u0020\u0066\u0072\u006f\u006d\u0020\u0054\u0054\u0046\u0020\u0066\u0069\u006c\u0065\u0020\u0025\u0073",_ebd );continue ;};};};return nil ;};func _efd (_fcbb *_ad .ChartSpace ,_fcge ,_dc float64 ,_abe *_cc .Theme ,_fcgd bool )(*_ce .Creator ,error ){_dga :=1.0;if _fcgd {_dga =8.0;};_fdg :=&Rectangle {};_gfc :=&Rectangle {Top :_fdg .Top ,Bottom :_dc -_fdg .Bottom ,Left :_fdg .Left ,Right :_fcge -_fdg .Right };_cccg :=MakeTempCreator (_fcge *_dga +1,_dc *_dga +1);_fecf :=&creatorContext {_dae :_cccg ,_bfgd :_abe ,_badb :_dga };var _aab bool ;if _eeg :=_fcbb .Chart ;_eeg !=nil {_ecb :=_eeg .PlotArea ;if _ecb ==nil {return nil ,_fb .New ("\u004e\u006f\u0020p\u006c\u006f\u0074\u0020\u0061\u0072\u0065\u0061");};_dca :=&Rectangle {Top :_gcb (10),Bottom :_gfc .Bottom -_gcb (15),Left :_gcb (10),Right :_gfc .Right -_gcb (10)};var _caf *Rectangle ;_gbf :=_eeg .Legend ;if _gbf !=nil {_gab :=_gbf .Overlay !=nil &&_gbf .Overlay .ValAttr !=nil &&*_gbf .Overlay .ValAttr ;if _dee :=_gbf .LegendPos ;_dee !=nil {switch _dee .ValAttr {case _ad .ST_LegendPosTr :if !_gab {_dca =&Rectangle {Top :_gcb (25),Bottom :_gfc .Bottom -_gcb (10),Left :_gcb (10),Right :_gfc .Right -_gcb (25)};};_caf =&Rectangle {Top :_gcb (2.5),Bottom :_gcb (22.5),Left :_gfc .Right -_gcb (22.5),Right :_gfc .Right -_gcb (2.5)};case _ad .ST_LegendPosT :_caf =&Rectangle {Top :_gcb (2.5),Bottom :_gcb (7.5),Left :(_gfc .Right -_gfc .Left )*0.25,Right :(_gfc .Right -_gfc .Left )*0.75};if !_gab {_dca =&Rectangle {Top :_gcb (12.5),Bottom :_gfc .Bottom -_gcb (15),Left :_gcb (10),Right :_gfc .Right -_gcb (5)};};_aab =true ;case _ad .ST_LegendPosB :_caf =&Rectangle {Top :_gfc .Bottom -_gcb (7.5),Bottom :_gfc .Bottom -_gcb (2.5),Left :(_gfc .Right -_gfc .Left )*0.25,Right :(_gfc .Right -_gfc .Left )*0.75};if !_gab {_dca =&Rectangle {Top :_gcb (5),Bottom :_gfc .Bottom -_gcb (15),Left :_gcb (10),Right :_gfc .Right -_gcb (5)};};_aab =true ;case _ad .ST_LegendPosR :_caf =&Rectangle {Top :(_gfc .Bottom -_gfc .Top )/2-_gcb (10),Bottom :(_gfc .Bottom -_gfc .Top )/2+_gcb (10),Left :_gfc .Right -_gcb (22.5),Right :_gfc .Right -_gcb (2.5)};if !_gab {_dca =&Rectangle {Top :_gcb (5),Bottom :_gfc .Bottom -_gcb (12.5),Left :_gcb (10),Right :_gfc .Right -_gcb (25)};};case _ad .ST_LegendPosL :_caf =&Rectangle {Top :(_gfc .Bottom -_gfc .Top )/2-_gcb (10),Bottom :(_gfc .Bottom -_gfc .Top )/2+_gcb (10),Left :_gcb (2.5),Right :_gcb (22.5)};if !_gab {_dca =&Rectangle {Top :_gcb (5),Bottom :_gfc .Bottom -_gcb (12.5),Left :_gcb (30),Right :_gfc .Right -_gcb (5)};};default:_caf =&Rectangle {Top :(_gfc .Bottom -_gfc .Top )/2-_gcb (10),Bottom :(_gfc .Bottom -_gfc .Top )/2+_gcb (10),Left :_gfc .Right -_gcb (25),Right :_gfc .Right -_gcb (5)};if !_gab {_dca =&Rectangle {Top :_gcb (5),Bottom :_gfc .Bottom -_gcb (12.5),Left :_gcb (100),Right :_gfc .Right -_gcb (25)};};};};};_dca .scale (_dga );_fecf .drawBorderWithProps (_ecb .SpPr ,_dca ,_gdd );_cga :=[]*legendItem {};var _cag error ;_dbe :=_ecb .CChoice ;for _ ,_ced :=range _ecb .Choice {if _gce :=_ced .BarChart ;_gce !=nil {_cga ,_cag =_fecf .drawBarChart (_gce ,_dca ,_dbe );if _cag !=nil {return nil ,_cag ;};};};if _gbf !=nil {_caf .scale (_dga );_fecf .drawBorderWithProps (_gbf .SpPr ,_caf ,_gdd );if len (_cga )!=0{_fecf .drawLegend (_caf ,_cga ,_aab );};};};_gfc .scale (_dga );_fecf .drawBorderWithProps (_fcbb .SpPr ,_gfc ,_gdd );return _cccg ,nil ;};func CropImageByRect (sourceImg _bb .Image ,rect _bb .Rectangle )_bb .Image {_acg ,_fef ,_gbgad ,_cgeb :=rect .Min .X ,rect .Min .Y ,rect .Max .X ,rect .Max .Y ;_dbad :=_bb .NewNRGBA (_bb .Rect (0,0,_gbgad -_acg ,_cgeb -_fef ));for _afcee :=_acg ;_afcee < _gbgad ;_afcee ++{for _addc :=_fef ;_addc < _cgeb ;_addc ++{_dbad .Set (_afcee -_acg ,_addc -_fef ,sourceImg .At (_afcee ,_addc ));};};return _dbad ;};func (_efda *creatorContext )drawRectangleWithProps (_aagc *_cc .CT_ShapeProperties ,_dgdb ,_aee ,_ffeg ,_afe float64 ,_fcc bool ){_bbfa :=_efda ._dae .NewRectangle (_dgdb ,_aee ,_ffeg ,_afe );if _aagc ==nil {if _fcc {_bbfa .SetBorderWidth (_gdd );}else {return ;};}else {_dbc :=_efda .getPdfColorFromSolidFill (_aagc .SolidFill );if _dbc !=nil {_bbfa .SetFillColor (_dbc );};if _aeaa :=_aagc .Ln ;_aeaa !=nil {if _aeb :=_aeaa .WAttr ;_aeb !=nil {_ccfc :=_efb .FromEMU (int64 (*_aeb ));_bbfa .SetBorderWidth (_ccfc );if _dagc :=_aeaa .SolidFill ;_dagc !=nil {_daad :=_efda .getPdfColorFromSolidFill (_dagc );if _daad !=nil {_bbfa .SetBorderColor (_daad );};};}else {_bbfa .SetBorderWidth (0);};};};_efda ._dae .Draw (_bbfa );};type fontsMap struct{_dgcd *_c .Mutex ;_fca map[string ]map[FontStyle ]*_eb .PdfFont ;};type FontStyle byte ;func PointsFromTwips (twips int64 )float64 {return float64 (int64 (float64 (twips )*_efb .Twips *10+0.5))/10;};func MakeBlockFromChartSpace (cs *_ad .ChartSpace ,width ,height float64 ,theme *_cc .Theme )(*_ce .Block ,error ){_cefg ,_fdd :=_efd (cs ,width ,height ,theme ,false );if _fdd !=nil {return nil ,_fdd ;};_abb ,_fdd :=GetPageFromCreator (_cefg );if _fdd !=nil {return nil ,_fdd ;};_bceg ,_fdd :=_ce .NewBlockFromPage (_abb );if _fdd !=nil {return nil ,_fdd ;};return _bceg ,nil ;};func (_abd *creatorContext )drawAxes (_gdb *_ad .CT_PlotAreaChoice1 ,_bbde ,_cdef ,_eegb float64 ,_bade []string ,_cgf *Rectangle ,_gac bool )error {_ddd :=_abd ._dae ;_efg :=_abd ._badb ;if _gdb ==nil {return _fb .New ("\u004e\u006f\u0020\u0061xi\u0073\u0020\u0069\u006e\u0066\u006f\u0072\u006d\u0061\u0074\u0069\u006f\u006e");};if len (_gdb .ValAx )==0||(len (_gdb .CatAx )==0&&len (_gdb .DateAx )==0&&len (_gdb .SerAx )==0){return _fb .New ("\u004e\u006f\u0020\u0078\u0020\u006f\u0072\u0020\u0079 \u0061\u0078\u0069\u0073");};var _bbf ,_dag ,_ebf ,_aec uint32 ;var _gda ,_eff _ad .ST_AxPos ;var _gbb ,_fddd _ad .ST_TickMark ;var _edf ,_dcb *_ad .CT_ChartLines ;var _bggg ,_cbe _ad .ST_TickLblPos ;var _fde ,_eecf *_cc .CT_ShapeProperties ;var _cfc error ;_ccg :=_cgf .Right -_cgf .Left ;_cgc :=_cgf .Bottom -_cgf .Top ;if len (_gdb .ValAx )> 0{_dag ,_eff ,_fddd ,_cbe ,_dcb ,_aec ,_eecf ,_cfc =_bag (_gdb .ValAx [0]);};if _eff !=_ad .ST_AxPosL &&_eff !=_ad .ST_AxPosB {return _fb .New ("\u004f\u006e\u006c\u0079\u0020l\u0065\u0066\u0074\u0020\u006f\u0072\u0020\u0062\u006f\u0074\u0074\u006f\u006d \u0079\u0020\u0061\u0078\u0069\u0073\u0020\u0073\u0075\u0070\u0070\u006f\u0072\u0074\u0020\u0073\u006f\u0020\u0066\u0061\u0072");};_dcbf :=_cdef -_bbde ;_aff :=int (_dcbf /_eegb )+1;var _ebe ,_afcg float64 ;switch _fddd {case _ad .ST_TickMarkIn :_ebe ,_afcg =_begf ,0;case _ad .ST_TickMarkOut :_ebe ,_afcg =0,_begf ;case _ad .ST_TickMarkCross :_ebe ,_afcg =_begf ,_begf ;};_ebe =_ebe *_efg ;_afcg =_afcg *_efg ;var _cgaa *_cc .CT_ShapeProperties ;if _dcb !=nil {_cgaa =_dcb .SpPr ;};_ade ,_efbb :=_bggg !=_ad .ST_TickLblPosNone ,_cbe !=_ad .ST_TickLblPosNone ;_gae :=_bbde ;if len (_gdb .CatAx )> 0{_bbf ,_gda ,_gbb ,_bggg ,_edf ,_ebf ,_fde ,_cfc =_gbfgc (_gdb .CatAx [0]);}else if len (_gdb .DateAx )> 0{_bbf ,_gda ,_gbb ,_bggg ,_edf ,_ebf ,_fde ,_cfc =_dgg (_gdb .DateAx [0]);}else if len (_gdb .SerAx )> 0{_bbf ,_gda ,_gbb ,_bggg ,_edf ,_ebf ,_fde ,_cfc =_bdf (_gdb .SerAx [0]);};if _cfc !=nil {return _cfc ;};if _gda !=_ad .ST_AxPosL &&_gda !=_ad .ST_AxPosB {return _fb .New ("\u004f\u006e\u006c\u0079\u0020l\u0065\u0066\u0074\u0020\u006f\u0072\u0020\u0062\u006f\u0074\u0074\u006f\u006d \u0078\u0020\u0061\u0078\u0069\u0073\u0020\u0073\u0075\u0070\u0070\u006f\u0072\u0074\u0020\u0073\u006f\u0020\u0066\u0061\u0072");};if _bbf !=_aec ||_dag !=_ebf {return _fb .New ("a\u0078i\u0073\u0020\u0069\u0064\u0073\u0020\u0064\u006fn\u0027\u0074\u0020\u006dat\u0063\u0068");};_fecfg :=len (_bade )+1;var _ddde ,_cbcg float64 ;switch _gbb {case _ad .ST_TickMarkIn :_ddde ,_cbcg =_begf ,0;case _ad .ST_TickMarkOut :_ddde ,_cbcg =0,_begf ;case _ad .ST_TickMarkCross :_ddde ,_cbcg =_begf ,_begf ;};_ddde =_ddde *_efg ;_cbcg =_cbcg *_efg ;var _gdf *_cc .CT_ShapeProperties ;if _edf !=nil {_gdf =_edf .SpPr ;};if _gac {_dfc :=_cgc /float64 (len (_bade ));_eef :=_cgf .Left -_bbde *_ccg /_dcbf ;_ecd :=_eef -_aaa *_efg ;if _ade {var _aea float64 ;for _gaee :=0;_gaee < _fecfg ;_gaee ++{_ccf :=_cgf .Bottom -float64 (_gaee )*_dfc ;if _gaee < _fecfg -1{_edfa :=_ddd .NewParagraph (_bade [_gaee ]);_edfa .SetFontSize (_eea *_efg );_edfa .SetPos (_ecd ,_ccf -_dfc /2-_bacf *_efg );_ddd .Draw (_edfa );_bdb :=(_edfa .Width ()/1000-_aaa )*_efg ;if _bdb > 0&&_bdb > _aea {_aea =_bdb ;};};};if _aea > 0{_cgf .Left +=_aea +_fecd ;_eef =_cgf .Left -_bbde *_ccg /_dcbf ;_ccg =_cgf .Right -_cgf .Left ;};};_cgda :=_eef -_cbcg ;_bga :=_eef +_ddde ;_fgge :=_cgf .Left ;_ffeeg :=_cgf .Right ;for _gbe :=0;_gbe < _fecfg ;_gbe ++{_feac :=_cgf .Bottom -float64 (_gbe )*_dfc ;_abd .drawLineWithProps (_fde ,_cgda ,_feac ,_bga ,_feac ,true );_abd .drawLineWithProps (_gdf ,_fgge ,_feac ,_ffeeg ,_feac ,true );};_gddc :=_ccg /_dcbf ;_gfb :=_cgf .Bottom -_ebe ;_ffeec :=_cgf .Bottom +_afcg ;_cda :=_cgf .Top ;_gacc :=_cgf .Bottom ;for _cbca :=0;_cbca < _aff ;_cbca ++{_acc :=_cgf .Left +(_gae -_bbde )*_gddc ;_abd .drawLineWithProps (_eecf ,_acc ,_gfb ,_acc ,_ffeec ,true );_abd .drawLineWithProps (_cgaa ,_acc ,_cda ,_acc ,_gacc ,true );if _efbb {_cfe :=_ddd .NewParagraph (_efc .FormatFloat (_gae ,'g',-1,64));_cfe .SetFontSize (_eea *_efg );_cfe .SetPos (_acc -_facb *_efg ,_gacc +_bca *_efg );_ddd .Draw (_cfe );};_gae +=_eegb ;};}else {_ffb :=_cgc /_dcbf ;_gfcd :=_cgf .Left ;if _efbb {var _fcga float64 ;for _ebg :=0;_ebg < _aff ;_ebg ++{_afdd :=_cgf .Bottom -(_gae -_bbde )*_ffb ;_adg :=_ddd .NewParagraph (_efc .FormatFloat (_gae ,'g',-1,64));_adg .SetFontSize (_eea *_efg );_adg .SetPos (_gfcd -_aaa *_efg ,_afdd -_bacf *_efg );_ddd .Draw (_adg );_dab :=(_adg .Width ()/1000-_aaa )*_efg ;if _dab > 0&&_dab > _fcga {_fcga =_dab ;};_gae +=_eegb ;};if _fcga > 0{_cgf .Left +=_fcga +_fecd ;_ccg =_cgf .Right -_cgf .Left ;};};_gae =_bbde ;_agc :=_cgf .Left -_afcg ;_ffcc :=_cgf .Left +_ebe ;_gfcd =_cgf .Left ;_fdbb :=_cgf .Right ;for _ecf :=0;_ecf < _aff ;_ecf ++{_afg :=_cgf .Bottom -(_gae -_bbde )*_ffb ;_abd .drawLineWithProps (_eecf ,_agc ,_afg ,_ffcc ,_afg ,true );_abd .drawLineWithProps (_cgaa ,_gfcd ,_afg ,_fdbb ,_afg ,true );_gae +=_eegb ;};_cgff :=_ccg /float64 (len (_bade ));_eccf :=_cgf .Bottom +_bbde *_cgc /_dcbf ;_agca :=_eccf -_ddde ;_bcdc :=_eccf +_cbcg ;_edbc :=_cgf .Top ;_gee :=_cgf .Bottom ;_bgad :=_eccf +_bca *_efg ;for _ged :=0;_ged < _fecfg ;_ged ++{_dfd :=_cgf .Left +float64 (_ged )*_cgff ;_abd .drawLineWithProps (_fde ,_dfd ,_agca ,_dfd ,_bcdc ,true );_abd .drawLineWithProps (_gdf ,_dfd ,_edbc ,_dfd ,_gee ,true );if _ade &&_ged < _fecfg -1{_fbd :=_ddd .NewParagraph (_bade [_ged ]);_fbd .SetFontSize (_eea *_efg );_fbd .SetPos (_dfd +_gbfg *_efg ,_bgad );_ddd .Draw (_fbd );};};};return nil ;};func _agg (_eece float64 )float64 {if _eece < 0{_eece +=float64 (-int (_eece )+1);}else if _eece > 1{_eece -=float64 (int (_eece ));};return _eece ;};func GetColorStringFromDmlColor (dmlColor *_cc .CT_Color )string {var _aagf string ;if _gbc :=dmlColor .SrgbClr ;_gbc !=nil {_aagf =_gbc .ValAttr ;}else if _cefc :=dmlColor .SysClr ;_cefc !=nil {return "\u0030\u0030\u0030\u0030\u0030\u0030";};return _aagf ;};type ImgPart byte ;func MakeImageFromChartSpace (cs *_ad .ChartSpace ,width ,height float64 ,theme *_cc .Theme )(_bb .Image ,error ){_edc ,_gde :=_efd (cs ,width ,height ,theme ,true );if _gde !=nil {return nil ,_gde ;};_fdb ,_gde :=GetPageFromCreator (_edc );if _gde !=nil {return nil ,_gde ;};return _d .NewImageDevice ().Render (_fdb );};func (_db *creatorContext )drawBarChart (_cd *_ad .CT_BarChart ,_g *Rectangle ,_dd *_ad .CT_PlotAreaChoice1 )([]*legendItem ,error ){var _ea bool ;if _eg :=_cd .BarDir ;_eg !=nil {_ea =_eg .ValAttr ==_ad .ST_BarDirBar ;};_ee :=_cd .Ser ;_be .Sort (barSerByOrder (_ee ));_gb :=map[string ]serCategory {};_cg :=[]string {};_fg :=[]*legendItem {};_bfa :=_e .Inf (1);_bfd :=_e .Inf (-1);for _ ,_eed :=range _ee {var _aac string ;if _ccc :=_eed .Tx ;_ccc !=nil {if _ba :=_ccc .Choice ;_ba !=nil {if _ba .V !=nil {_aac =*_ba .V ;}else if _ddg :=_ba .StrRef ;_ddg !=nil {if _bae :=_ddg .StrCache ;_bae !=nil {for _ ,_aag :=range _bae .Pt {_aac =_aag .V ;};};};};};if _bgg :=_eed .Cat ;_bgg !=nil {if _eba :=_bgg .Choice ;_eba !=nil {if _fe :=_eba .StrRef ;_fe !=nil {if _ae :=_fe .StrCache ;_ae !=nil {for _ ,_cb :=range _ae .Pt {_da :=_cb .V ;if _ ,_fec :=_gb [_da ];!_fec {_gb [_da ]=serCategory {_fge :_da ,_fgb :[]serValue {}};_cg =append (_cg ,_da );};};};}else if _gg :=_eba .NumRef ;_gg !=nil {if _fd :=_gg .NumCache ;_fd !=nil {var _ed string ;if _fd .FormatCode !=nil {_ed =*_fd .FormatCode ;};for _ ,_aage :=range _fd .Pt {var _cde string ;if _aage .FormatCodeAttr ==nil {_cde =_ed ;}else {_cde =*_aage .FormatCodeAttr ;};var _bgb string ;_aaf ,_cdc :=_efc .ParseFloat (_aage .V ,64);if _cdc !=nil {_bgb =_aage .V ;}else {_bgb =_bg .Number (_aaf ,_cde );};if _ ,_af :=_gb [_bgb ];!_af {_gb [_bgb ]=serCategory {_fge :_bgb ,_fgb :[]serValue {}};_cg =append (_cg ,_bgb );};};};};};};if _bce :=_eed .Val ;_bce !=nil {if _cgg :=_bce .Choice ;_cgg !=nil {if _bee :=_cgg .NumRef ;_bee !=nil {if _de :=_bee .NumCache ;_de !=nil {for _cbc ,_gc :=range _de .Pt {_cbf ,_ff :=_efc .ParseFloat (_gc .V ,64);if _ff !=nil {_cbf =0;_bc .Log .Debug ("\u0070a\u0072s\u0065\u0020\u0065\u0072\u0072\u006f\u0072\u003a\u0020\u0025\u0073",_ff );};if _cbf > _bfd {_bfd =_cbf ;};if _cbf < _bfa {_bfa =_cbf ;};_cef :=_gb [_cg [_cbc ]];_cef ._fgb =append (_cef ._fgb ,serValue {_gcc :_aac ,_fff :_cbf ,_cab :_eed .SpPr });_gb [_cg [_cbc ]]=_cef ;};};};};};_fg =append (_fg ,&legendItem {_fgc :_aac ,_cae :_eed .SpPr });};var _cea float64 ;var _egf ,_aef float64 ;if _bfd ==0&&_bfa ==0{_cea =0.2;_aef =0;_egf =1;}else {var _afc float64 ;if _cdg :=_e .Abs (_bfa );_bfd < _cdg {_afc =_cdg ;}else {_afc =_bfd ;};_eec :=_e .Pow (10,_e .Floor (_e .Log10 (_afc )));_df :=_afc /_eec ;if _df >=1.715&&_df < 4.29{_cea =0.5;}else if _df >=4.29&&_df < 8.58{_cea =1;}else {_cea =2;};_cea *=_eec ;if _bfd <=0{_egf =0;}else {_egf =(_e .Ceil (_bfd /_cea )+1)*_cea ;};if _bfa >=0{_aef =0;}else {_aef =(_e .Floor (_bfa /_cea )-1)*_cea ;};};_fea :=_db .drawAxes (_dd ,_aef ,_egf ,_cea ,_cg ,_g ,_ea );if _fea !=nil {return nil ,_fea ;};_deg :=0.0;if _cd .GapWidth !=nil {if _ga :=_cd .GapWidth .ValAttr ;_ga !=nil {if _bd :=_ga .ST_GapAmountUShort ;_bd !=nil {_deg =float64 (*_bd )/100.0;};};};_ffc :=_g .Right -_g .Left ;_egd :=_g .Bottom -_g .Top ;_gge :=float64 (len (_cg ));if _ea {_ec :=_egf /(_egf -_aef )*_ffc ;_fag :=-_aef /(_egf -_aef )*_ffc ;_edd :=_g .Left +_fag ;_ecc :=_egd /_gge ;for _add ,_gba :=range _cg {_ddb :=_gb [_gba ];_ffa :=float64 (len (_ddb ._fgb ))+_deg ;_cf :=_ecc /_ffa ;_gf :=_cf *_deg ;_afd :=_g .Bottom -float64 (_add )*_ecc -_gf /2-_cf ;for _ ,_ecg :=range _ddb ._fgb {if _ecg ._fff ==0{continue ;};var _ddc ,_dg float64 ;if _ecg ._fff > 0{_dg =_ecg ._fff /_egf *_ec ;_db .drawRectangleWithProps (_ecg ._cab ,_edd ,_afd ,_dg ,_cf ,false );}else {_dg =_ecg ._fff /_aef *_fag ;_ddc =_edd -_dg ;_db .drawRectangleWithProps (_ecg ._cab ,_ddc ,_afd ,_dg ,_cf ,false );};_afd -=_cf ;};};}else {_edg :=_egf /(_egf -_aef )*_egd ;_aacd :=-_aef /(_egf -_aef )*_egd ;_cgd :=_g .Top +_edg ;_acf :=_ffc /_gge ;for _gff ,_daf :=range _cg {_ffe :=_gb [_daf ];_ab :=float64 (len (_ffe ._fgb ))+_deg ;_cfd :=_acf /_ab ;_bcd :=_cfd *_deg ;_fgg :=_g .Left +float64 (_gff )*_acf +_bcd /2;for _ ,_ddga :=range _ffe ._fgb {var _bbd ,_def float64 ;if _ddga ._fff > 0{_def =_ddga ._fff /_egf *_edg ;_bbd =_cgd -_def ;_db .drawRectangleWithProps (_ddga ._cab ,_fgg ,_bbd ,_cfd ,_def ,false );}else {_def =_ddga ._fff /_aef *_aacd ;_db .drawRectangleWithProps (_ddga ._cab ,_fgg ,_cgd ,_cfd ,_def ,false );};_fgg +=_cfd ;};};};return _fg ,nil ;};var _bbfd =map[string ]FontStyle {"\u0052e\u0067\u0075\u006c\u0061\u0072":FontStyle_Regular ,"\u0042\u006f\u006c\u0064":FontStyle_Bold ,"\u0049\u0074\u0061\u006c\u0069\u0063":FontStyle_Italic ,"B\u006f\u006c\u0064\u0020\u0049\u0074\u0061\u006c\u0069\u0063":FontStyle_BoldItalic };func _gcg (_ffac ,_ffcd ,_ebfe uint8 )(float64 ,float64 ,float64 ){_fdeb ,_edfe ,_fcbbc :=float64 (_ffac )/255,float64 (_ffcd )/255,float64 (_ebfe )/255;_acbe :=_fdeb ;if _edfe < _acbe {_acbe =_edfe ;};if _fcbbc < _acbe {_acbe =_fcbbc ;};var _ebfa ,_geb bool ;_dcgb :=_fdeb ;if _edfe > _dcgb {_dcgb =_edfe ;_ebfa =true ;};if _fcbbc > _dcgb {_dcgb =_fcbbc ;_ebfa =false ;_geb =true ;};_debd :=(_acbe +_dcgb )/2;var _cedg float64 ;if _acbe !=_dcgb {if _debd <=0.5{_cedg =(_dcgb -_acbe )/(_dcgb +_acbe );}else {_cedg =(_dcgb -_acbe )/(2.0-_dcgb -_acbe );};};var _fgbe float64 ;if _acbe !=_dcgb {if _ebfa {_fgbe =2.0+(_fcbbc -_fdeb )/(_dcgb -_acbe );}else if _geb {_fgbe =4.0+(_fdeb -_edfe )/(_dcgb -_acbe );}else {_fgbe =(_edfe -_fcbbc )/(_dcgb -_acbe );};_fgbe *=60;if _fgbe < 0{_fgbe +=360;};};return _fgbe ,_cedg ,_debd ;};const DefaultFontSize =12.0;