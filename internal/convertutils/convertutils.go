//
// Copyright 2020 FoxyUtils ehf. All rights reserved.
//
// This is a commercial product and requires a license to operate.
// A trial license can be obtained at https://unidoc.io
//
// DO NOT EDIT: generated by unitwist Go source code obfuscator.
//
// Use of this source code is governed by the UniDoc End User License Agreement
// terms that can be accessed at https://unidoc.io/eula/

package convertutils ;import (_c "bytes";_fg "errors";_cd "fmt";_aa "github.com/unidoc/unioffice/common/logger";_ag "github.com/unidoc/unioffice/measurement";_g "github.com/unidoc/unioffice/schema/soo/dml";_bf "github.com/unidoc/unioffice/schema/soo/dml/chart";
_da "github.com/unidoc/unioffice/spreadsheet/format";_fb "github.com/unidoc/unipdf/v3/creator";_ca "github.com/unidoc/unipdf/v3/model";_fe "github.com/unidoc/unipdf/v3/render";_ff "github.com/unidoc/unitype";_eb "image";_b "math";_f "os";_dd "sort";_ef "strconv";
_ad "strings";_d "sync";_e "unicode";);type creatorContext struct{_gae *_fb .Creator ;_agfb *_g .Theme ;_dafd float64 ;};func _adge (_cfa float64 )float64 {if _cfa < 0{_cfa +=float64 (-int (_cfa )+1);}else if _cfa > 1{_cfa -=float64 (int (_cfa ));};return _cfa ;
};var _beg =_bfab (0.5);type serCategory struct{_gf string ;_aag []serValue ;};const (ImgPart_whole ImgPart =0;ImgPart_t ImgPart =1;ImgPart_b ImgPart =2;ImgPart_l ImgPart =3;ImgPart_r ImgPart =4;ImgPart_lt ImgPart =5;ImgPart_rt ImgPart =6;ImgPart_lb ImgPart =7;
ImgPart_rb ImgPart =8;);func FromSTCoordinate (st _g .ST_Coordinate )int64 {if _abage :=st .ST_CoordinateUnqualified ;_abage !=nil {return *_abage ;};return 0;};func (_gce *creatorContext )getPdfColorFromSolidFill (_afcb *_g .CT_SolidColorFillProperties )_fb .Color {if _afcb ==nil {return nil ;
};_ccac :="";if _efa :=_afcb .SrgbClr ;_efa !=nil {_ccac =_efa .ValAttr ;}else if _aadd :=_afcb .SchemeClr ;_aadd !=nil {_ccac =_aggg (_aadd .ValAttr ,_gce ._agfb );};if _ccac ==""{return nil ;};return _fb .ColorRGBFromHex ("\u0023"+_ccac );};func AdjustColor (colorStr string ,EG_ColorTransform []*_g .EG_ColorTransform )string {for _ ,_gfb :=range EG_ColorTransform {if _deec :=_gfb .Tint ;
_deec !=nil {if _dac :=_deec .ValAttr .ST_PositiveFixedPercentageDecimal ;_dac !=nil {colorStr =AdjustColorByTint (colorStr ,float64 (*_dac )/100000);};};if _cge :=_gfb .Shade ;_cge !=nil {if _cgd :=_cge .ValAttr .ST_PositiveFixedPercentageDecimal ;_cgd !=nil {colorStr =AdjustColorByShade (colorStr ,float64 (*_cgd )/100000);
};};if _cca :=_gfb .LumMod ;_cca !=nil {if _abaf :=_cca .ValAttr .ST_PercentageDecimal ;_abaf !=nil {colorStr =AdjustColorByLumMod (colorStr ,float64 (*_abaf )/100000);};};};return colorStr ;};func _cgca (_dgg ,_affg ,_afbe float64 )float64 {if _dgg *6< 1{return _afbe +(_affg -_afbe )*6*_dgg ;
}else if _dgg *2< 1{return _affg ;}else if _dgg *3< 2{return _afbe +(_affg -_afbe )*(2.0/3.0-_dgg )*6;}else {return _afbe ;};};func (_dcdg *creatorContext )drawLineWithProps (_cbggf *_g .CT_ShapeProperties ,_bgda ,_gedb ,_efdd ,_adec float64 ,_fccg bool ){if _cbggf !=nil {if _cbd :=_cbggf .Ln ;
_cbd !=nil {_ddcc :=_dcdg .getPdfColorFromSolidFill (_cbd .SolidFill );if _ddcc ==nil &&_fccg {_ddcc =_fb .ColorBlack ;};if _ddcc !=nil {var _gbfb float64 ;if _acea :=_cbd .WAttr ;_acea !=nil {_gbfb =_ag .FromEMU (int64 (*_acea ));}else {_gbfb =_cdd ;};
DrawLine (_dcdg ._gae ,_bgda ,_gedb ,_efdd ,_adec ,_gbfb ,_ddcc );};};};};func (_ggef *creatorContext )drawRectangleWithProps (_eegf *_g .CT_ShapeProperties ,_accb ,_faeb ,_cag ,_affe float64 ,_gdgd bool ){_aca :=_ggef ._gae .NewRectangle (_accb ,_faeb ,_cag ,_affe );
if _eegf ==nil {if _gdgd {_aca .SetBorderWidth (_cdd );}else {return ;};}else {_eafg :=_ggef .getPdfColorFromSolidFill (_eegf .SolidFill );if _eafg !=nil {_aca .SetFillColor (_eafg );};if _cgde :=_eegf .Ln ;_cgde !=nil {if _gda :=_cgde .WAttr ;_gda !=nil {_bdeg :=_ag .FromEMU (int64 (*_gda ));
_aca .SetBorderWidth (_bdeg );if _dbc :=_cgde .SolidFill ;_dbc !=nil {_cdde :=_ggef .getPdfColorFromSolidFill (_dbc );if _cdde !=nil {_aca .SetBorderColor (_cdde );};};}else {_aca .SetBorderWidth (0);};};};_ggef ._gae .Draw (_aca );};var StdFontsMap =map[string ][]string {"\u0048e\u006c\u0076\u0065\u0074\u0069\u0063a":[]string {"\u0048e\u006c\u0076\u0065\u0074\u0069\u0063a","\u0048\u0065\u006c\u0076\u0065\u0074\u0069\u0063\u0061-\u0042\u006f\u006c\u0064","\u0048\u0065\u006c\u0076\u0065\u0074\u0069\u0063\u0061\u002d\u004f\u0062l\u0069\u0071\u0075\u0065","H\u0065\u006c\u0076\u0065ti\u0063a\u002d\u0042\u006f\u006c\u0064O\u0062\u006c\u0069\u0071\u0075\u0065"},"\u0043o\u0075\u0072\u0069\u0065\u0072":[]string {"\u0043o\u0075\u0072\u0069\u0065\u0072","\u0043\u006f\u0075r\u0069\u0065\u0072\u002d\u0042\u006f\u006c\u0064","\u0043o\u0075r\u0069\u0065\u0072\u002d\u004f\u0062\u006c\u0069\u0071\u0075\u0065","\u0043\u006f\u0075\u0072ie\u0072\u002d\u0042\u006f\u006c\u0064\u004f\u0062\u006c\u0069\u0071\u0075\u0065"},"\u0054i\u006de\u0073\u0020\u004e\u0065\u0077\u0020\u0052\u006f\u006d\u0061\u006e":[]string {"T\u0069\u006d\u0065\u0073\u002d\u0052\u006f\u006d\u0061\u006e","\u0054\u0069\u006d\u0065\u0073\u002d\u0042\u006f\u006c\u0064","\u0054\u0069\u006de\u0073\u002d\u0049\u0074\u0061\u006c\u0069\u0063","\u0054\u0069m\u0065\u0073\u002dB\u006f\u006c\u0064\u0049\u0074\u0061\u006c\u0069\u0063"},"\u0064e\u0066\u0061\u0075\u006c\u0074":[]string {"\u0048e\u006c\u0076\u0065\u0074\u0069\u0063a","\u0048\u0065\u006c\u0076\u0065\u0074\u0069\u0063\u0061-\u0042\u006f\u006c\u0064","\u0048\u0065\u006c\u0076\u0065\u0074\u0069\u0063\u0061\u002d\u004f\u0062l\u0069\u0071\u0075\u0065","H\u0065\u006c\u0076\u0065ti\u0063a\u002d\u0042\u006f\u006c\u0064O\u0062\u006c\u0069\u0071\u0075\u0065"}};
var _ecf =_bfab (2);type serValue struct{_gc string ;_bac float64 ;_eed *_g .CT_ShapeProperties ;};func Lighten (clr float64 )float64 {return 0.6+0.4*clr };func (_gbcb *creatorContext )drawLegend (_ccb *Rectangle ,_cafd []*legendItem ,_fff bool ){_bbf :=_gbcb ._dafd ;
_ecg :=_bfab (2.5)*_bbf ;_bda :=_dce *_bbf ;_cfff :=(_ecg -_bda )/2;_cce :=float64 (len (_cafd ));if _fff {_cceb :=&Rectangle {Top :_ccb .Top +_bfab (1)*_bbf ,Bottom :_ccb .Bottom -_bfab (1)*_bbf ,Left :_ccb .Left +_bfab (2.5)*_bbf ,Right :_ccb .Right -_bfab (2.5)*_bbf };
var _efg float64 ;if _cce > 1{_efg =(_cceb .Right -_cceb .Left )/_cce ;};_dgc :=_cceb .Left ;_acf :=_cceb .Top ;for _ ,_acc :=range _cafd {if _cbg :=_acc ._ceb ;_cbg !=nil {_gbcb .drawRectangleWithProps (_cbg ,_dgc ,_acf +_cfff ,_bda ,_bda ,false );_fde :=_dgc +_bda *2;
_cdda :=_gbcb ._gae .NewStyledParagraph ();_cdda .SetPos (_fde ,_acf );_aaab :=_cdda .Append (_acc ._gdf );_dcd ,_dcag :=_ca .NewStandard14Font (_ca .HelveticaName );if _dcag ==nil {_dced :=_gbcb ._gae .NewTextStyle ();_dced .Font =_dcd ;_dced .FontSize =_ecg ;
_dced .TextRise =0.4;_aaab .Style =_dced ;_gbcb ._gae .Draw (_cdda );};};_dgc +=_efg ;};}else {_dbe :=&Rectangle {Top :_ccb .Top +_bfab (2.5)*_bbf ,Bottom :_ccb .Bottom -_bfab (2.5)*_bbf ,Left :_ccb .Left +_bfab (2.5)*_bbf ,Right :_ccb .Right -_bfab (2.5)*_bbf };
var _dee float64 ;if _cce > 1{_dee =(_dbe .Bottom -_dbe .Top -_ecg )/(_cce -1);};_aba :=_dbe .Top ;_fca :=_dbe .Left ;_eca :=_fca +_bda *2;for _ ,_cbgg :=range _cafd {if _fdg :=_cbgg ._ceb ;_fdg !=nil {_gbcb .drawRectangleWithProps (_fdg ,_fca ,_aba +_cfff ,_bda ,_bda ,false );
_aef :=_gbcb ._gae .NewStyledParagraph ();_aef .SetPos (_eca ,_aba );_afdd :=_aef .Append (_cbgg ._gdf );_fga ,_acfb :=_ca .NewStandard14Font (_ca .HelveticaName );if _acfb ==nil {_bdec :=_gbcb ._gae .NewTextStyle ();_bdec .Font =_fga ;_bdec .FontSize =_ecg ;
_bdec .TextRise =0.4;_afdd .Style =_bdec ;_gbcb ._gae .Draw (_aef );};};_aba +=_dee ;};};};func (_ceg barSerByOrder )Len ()int {return len (_ceg )};func (_ed *creatorContext )drawBarChart (_ba *_bf .CT_BarChart ,_cf *Rectangle ,_cff *_bf .CT_PlotAreaChoice1 )([]*legendItem ,error ){var _bb bool ;
if _gd :=_ba .BarDir ;_gd !=nil {_bb =_gd .ValAttr ==_bf .ST_BarDirBar ;};_ddf :=_ba .Ser ;_dd .Sort (barSerByOrder (_ddf ));_af :=map[string ]serCategory {};_daa :=[]string {};_df :=[]*legendItem {};_eg :=_b .Inf (1);_afa :=_b .Inf (-1);for _ ,_ea :=range _ddf {var _ce string ;
if _fc :=_ea .Tx ;_fc !=nil {if _bad :=_fc .Choice ;_bad !=nil {if _bad .V !=nil {_ce =*_bad .V ;}else if _bag :=_bad .StrRef ;_bag !=nil {if _fa :=_bag .StrCache ;_fa !=nil {for _ ,_ddb :=range _fa .Pt {_ce =_ddb .V ;};};};};};if _cde :=_ea .Cat ;_cde !=nil {if _db :=_cde .Choice ;
_db !=nil {if _bc :=_db .StrRef ;_bc !=nil {if _de :=_bc .StrCache ;_de !=nil {for _ ,_ge :=range _de .Pt {_bg :=_ge .V ;if _ ,_cfb :=_af [_bg ];!_cfb {_af [_bg ]=serCategory {_gf :_bg ,_aag :[]serValue {}};_daa =append (_daa ,_bg );};};};}else if _ae :=_db .NumRef ;
_ae !=nil {if _cc :=_ae .NumCache ;_cc !=nil {var _fge string ;if _cc .FormatCode !=nil {_fge =*_cc .FormatCode ;};for _ ,_cg :=range _cc .Pt {var _gef string ;if _cg .FormatCodeAttr ==nil {_gef =_fge ;}else {_gef =*_cg .FormatCodeAttr ;};var _cdb string ;
_dag ,_agf :=_ef .ParseFloat (_cg .V ,64);if _agf !=nil {_cdb =_cg .V ;}else {_cdb =_da .Number (_dag ,_gef );};if _ ,_cfg :=_af [_cdb ];!_cfg {_af [_cdb ]=serCategory {_gf :_cdb ,_aag :[]serValue {}};_daa =append (_daa ,_cdb );};};};};};};if _bec :=_ea .Val ;
_bec !=nil {if _ffb :=_bec .Choice ;_ffb !=nil {if _cad :=_ffb .NumRef ;_cad !=nil {if _bcf :=_cad .NumCache ;_bcf !=nil {for _fef ,_ab :=range _bcf .Pt {_fac ,_aed :=_ef .ParseFloat (_ab .V ,64);if _aed !=nil {_fac =0;_aa .Log .Debug ("\u0070a\u0072s\u0065\u0020\u0065\u0072\u0072\u006f\u0072\u003a\u0020\u0025\u0073",_aed );
};if _fac > _afa {_afa =_fac ;};if _fac < _eg {_eg =_fac ;};_cga :=_af [_daa [_fef ]];_cga ._aag =append (_cga ._aag ,serValue {_gc :_ce ,_bac :_fac ,_eed :_ea .SpPr });_af [_daa [_fef ]]=_cga ;};};};};};_df =append (_df ,&legendItem {_gdf :_ce ,_ceb :_ea .SpPr });
};var _ebd float64 ;var _ac ,_fcc float64 ;if _afa ==0&&_eg ==0{_ebd =0.2;_fcc =0;_ac =1;}else {var _cgb float64 ;if _deb :=_b .Abs (_eg );_afa < _deb {_cgb =_deb ;}else {_cgb =_afa ;};_aee :=_b .Pow (10,_b .Floor (_b .Log10 (_cgb )));_cgae :=_cgb /_aee ;
if _cgae >=1.715&&_cgae < 4.29{_ebd =0.5;}else if _cgae >=4.29&&_cgae < 8.58{_ebd =1;}else {_ebd =2;};_ebd *=_aee ;if _afa <=0{_ac =0;}else {_ac =(_b .Ceil (_afa /_ebd )+1)*_ebd ;};if _eg >=0{_fcc =0;}else {_fcc =(_b .Floor (_eg /_ebd )-1)*_ebd ;};};_cb :=_ed .drawAxes (_cff ,_fcc ,_ac ,_ebd ,_daa ,_cf ,_bb );
if _cb !=nil {return nil ,_cb ;};_geg :=0.0;if _ba .GapWidth !=nil {if _fgb :=_ba .GapWidth .ValAttr ;_fgb !=nil {if _ddbb :=_fgb .ST_GapAmountUShort ;_ddbb !=nil {_geg =float64 (*_ddbb )/100.0;};};};_gdc :=_cf .Right -_cf .Left ;_fd :=_cf .Bottom -_cf .Top ;
_bd :=float64 (len (_daa ));if _bb {_cgba :=_ac /(_ac -_fcc )*_gdc ;_ade :=-_fcc /(_ac -_fcc )*_gdc ;_dc :=_cf .Left +_ade ;_dda :=_fd /_bd ;for _dbf ,_dfb :=range _daa {_agfg :=_af [_dfb ];_adfa :=float64 (len (_agfg ._aag ))+_geg ;_ga :=_dda /_adfa ;
_gb :=_ga *_geg ;_aad :=_cf .Bottom -float64 (_dbf )*_dda -_gb /2-_ga ;for _ ,_bbe :=range _agfg ._aag {if _bbe ._bac ==0{continue ;};var _ec ,_gbd float64 ;if _bbe ._bac > 0{_gbd =_bbe ._bac /_ac *_cgba ;_ed .drawRectangleWithProps (_bbe ._eed ,_dc ,_aad ,_gbd ,_ga ,false );
}else {_gbd =_bbe ._bac /_fcc *_ade ;_ec =_dc -_gbd ;_ed .drawRectangleWithProps (_bbe ._eed ,_ec ,_aad ,_gbd ,_ga ,false );};_aad -=_ga ;};};}else {_aaa :=_ac /(_ac -_fcc )*_fd ;_fdd :=-_fcc /(_ac -_fcc )*_fd ;_ebb :=_cf .Top +_aaa ;_gbc :=_gdc /_bd ;
for _acb ,_ee :=range _daa {_gefb :=_af [_ee ];_bcc :=float64 (len (_gefb ._aag ))+_geg ;_bcfa :=_gbc /_bcc ;_baa :=_bcfa *_geg ;_bab :=_cf .Left +float64 (_acb )*_gbc +_baa /2;for _ ,_cadf :=range _gefb ._aag {var _dca ,_abf float64 ;if _cadf ._bac > 0{_abf =_cadf ._bac /_ac *_aaa ;
_dca =_ebb -_abf ;_ed .drawRectangleWithProps (_cadf ._eed ,_bab ,_dca ,_bcfa ,_abf ,false );}else {_abf =_cadf ._bac /_fcc *_fdd ;_ed .drawRectangleWithProps (_cadf ._eed ,_bab ,_ebb ,_bcfa ,_abf ,false );};_bab +=_bcfa ;};};};return _df ,nil ;};var _dcg =_bfab (7.5);
const DefaultFontSize =12.0;func MakeBlockFromChartSpace (cs *_bf .ChartSpace ,width ,height float64 ,theme *_g .Theme )(*_fb .Block ,error ){_cab ,_fae :=_dg (cs ,width ,height ,theme ,false );if _fae !=nil {return nil ,_fae ;};_bgb ,_fae :=GetPageFromCreator (_cab );
if _fae !=nil {return nil ,_fae ;};_bdd ,_fae :=_fb .NewBlockFromPage (_bgb );if _fae !=nil {return nil ,_fae ;};return _bdd ,nil ;};const _bcb =6.0;func _adb (_gfa *_bf .CT_ValAx )(uint32 ,_bf .ST_AxPos ,_bf .ST_TickMark ,_bf .ST_TickLblPos ,*_bf .CT_ChartLines ,uint32 ,*_g .CT_ShapeProperties ,error ){var _ecgc ,_afe uint32 ;
var _gcg _bf .ST_AxPos ;var _cebf _bf .ST_TickMark ;var _debca *_bf .CT_ChartLines ;var _cda _bf .ST_TickLblPos ;if _gfa .AxId ==nil {return _ecgc ,_gcg ,_cebf ,_cda ,_debca ,_afe ,_gfa .SpPr ,_fg .New ("\u004e\u006f\u0020x\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");
}else {_ecgc =_gfa .AxId .ValAttr ;};if _gfa .AxPos ==nil {return _ecgc ,_gcg ,_cebf ,_cda ,_debca ,_afe ,_gfa .SpPr ,_fg .New ("\u004eo\u0020x\u0020\u0061\u0078\u0069\u0073 \u0070\u006fs\u0069\u0074\u0069\u006f\u006e");}else {_gcg =_gfa .AxPos .ValAttr ;
};if _gfa .MajorTickMark !=nil {_cebf =_gfa .MajorTickMark .ValAttr ;};if _gfa .TickLblPos !=nil {_cda =_gfa .TickLblPos .ValAttr ;};if _gfa .CrossAx ==nil {return _ecgc ,_gcg ,_cebf ,_cda ,_debca ,_afe ,_gfa .SpPr ,_fg .New ("\u004e\u006f \u0063\u0072\u006fs\u0073\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");
}else {_afe =_gfa .CrossAx .ValAttr ;};_debca =_gfa .MajorGridlines ;return _ecgc ,_gcg ,_cebf ,_cda ,_debca ,_afe ,_gfa .SpPr ,nil ;};func _dcf (_gag *_bf .CT_SerAx )(uint32 ,_bf .ST_AxPos ,_bf .ST_TickMark ,_bf .ST_TickLblPos ,*_bf .CT_ChartLines ,uint32 ,*_g .CT_ShapeProperties ,error ){var _cdeb ,_dcc uint32 ;
var _ffgg _bf .ST_AxPos ;var _ddba _bf .ST_TickMark ;var _ece *_bf .CT_ChartLines ;var _eega _bf .ST_TickLblPos ;if _gag .AxId ==nil {return _cdeb ,_ffgg ,_ddba ,_eega ,_ece ,_dcc ,_gag .SpPr ,_fg .New ("\u004e\u006f\u0020x\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");
}else {_cdeb =_gag .AxId .ValAttr ;};if _gag .AxPos ==nil {return _cdeb ,_ffgg ,_ddba ,_eega ,_ece ,_dcc ,_gag .SpPr ,_fg .New ("\u004eo\u0020x\u0020\u0061\u0078\u0069\u0073 \u0070\u006fs\u0069\u0074\u0069\u006f\u006e");}else {_ffgg =_gag .AxPos .ValAttr ;
};if _gag .MajorTickMark !=nil {_ddba =_gag .MajorTickMark .ValAttr ;};if _gag .TickLblPos !=nil {_eega =_gag .TickLblPos .ValAttr ;};if _gag .CrossAx ==nil {return _cdeb ,_ffgg ,_ddba ,_eega ,_ece ,_dcc ,_gag .SpPr ,_fg .New ("\u004e\u006f \u0063\u0072\u006fs\u0073\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");
}else {_dcc =_gag .CrossAx .ValAttr ;};_ece =_gag .MajorGridlines ;return _cdeb ,_ffgg ,_ddba ,_eega ,_ece ,_dcc ,_gag .SpPr ,nil ;};func (_bdag *creatorContext )drawAxes (_bgc *_bf .CT_PlotAreaChoice1 ,_bge ,_gdga ,_afddb float64 ,_eegg []string ,_ebfe *Rectangle ,_afb bool )error {_ccd :=_bdag ._gae ;
_ebbd :=_bdag ._dafd ;if _bgc ==nil {return _fg .New ("\u004e\u006f\u0020\u0061xi\u0073\u0020\u0069\u006e\u0066\u006f\u0072\u006d\u0061\u0074\u0069\u006f\u006e");};if len (_bgc .ValAx )==0||(len (_bgc .CatAx )==0&&len (_bgc .DateAx )==0&&len (_bgc .SerAx )==0){return _fg .New ("\u004e\u006f\u0020\u0078\u0020\u006f\u0072\u0020\u0079 \u0061\u0078\u0069\u0073");
};var _ggc ,_ged ,_debc ,_bdb uint32 ;var _ega ,_acfd _bf .ST_AxPos ;var _ebg ,_cgf _bf .ST_TickMark ;var _geff ,_cae *_bf .CT_ChartLines ;var _dfc ,_gca _bf .ST_TickLblPos ;var _aagc ,_caed *_g .CT_ShapeProperties ;var _fcb error ;_bbd :=_ebfe .Right -_ebfe .Left ;
_dcae :=_ebfe .Bottom -_ebfe .Top ;if len (_bgc .ValAx )> 0{_ged ,_acfd ,_cgf ,_gca ,_cae ,_bdb ,_caed ,_fcb =_adb (_bgc .ValAx [0]);};if _acfd !=_bf .ST_AxPosL &&_acfd !=_bf .ST_AxPosB {return _fg .New ("\u004f\u006e\u006c\u0079\u0020l\u0065\u0066\u0074\u0020\u006f\u0072\u0020\u0062\u006f\u0074\u0074\u006f\u006d \u0079\u0020\u0061\u0078\u0069\u0073\u0020\u0073\u0075\u0070\u0070\u006f\u0072\u0074\u0020\u0073\u006f\u0020\u0066\u0061\u0072");
};_gbe :=_gdga -_bge ;_ffa :=int (_gbe /_afddb )+1;var _deg ,_fdcb float64 ;switch _cgf {case _bf .ST_TickMarkIn :_deg ,_fdcb =_cfgc ,0;case _bf .ST_TickMarkOut :_deg ,_fdcb =0,_cfgc ;case _bf .ST_TickMarkCross :_deg ,_fdcb =_cfgc ,_cfgc ;};_deg =_deg *_ebbd ;
_fdcb =_fdcb *_ebbd ;var _cceg *_g .CT_ShapeProperties ;if _cae !=nil {_cceg =_cae .SpPr ;};_badg ,_faf :=_dfc !=_bf .ST_TickLblPosNone ,_gca !=_bf .ST_TickLblPosNone ;_aac :=_bge ;if len (_bgc .CatAx )> 0{_ggc ,_ega ,_ebg ,_dfc ,_geff ,_debc ,_aagc ,_fcb =_egg (_bgc .CatAx [0]);
}else if len (_bgc .DateAx )> 0{_ggc ,_ega ,_ebg ,_dfc ,_geff ,_debc ,_aagc ,_fcb =_acfda (_bgc .DateAx [0]);}else if len (_bgc .SerAx )> 0{_ggc ,_ega ,_ebg ,_dfc ,_geff ,_debc ,_aagc ,_fcb =_dcf (_bgc .SerAx [0]);};if _fcb !=nil {return _fcb ;};if _ega !=_bf .ST_AxPosL &&_ega !=_bf .ST_AxPosB {return _fg .New ("\u004f\u006e\u006c\u0079\u0020l\u0065\u0066\u0074\u0020\u006f\u0072\u0020\u0062\u006f\u0074\u0074\u006f\u006d \u0078\u0020\u0061\u0078\u0069\u0073\u0020\u0073\u0075\u0070\u0070\u006f\u0072\u0074\u0020\u0073\u006f\u0020\u0066\u0061\u0072");
};if _ggc !=_bdb ||_ged !=_debc {return _fg .New ("a\u0078i\u0073\u0020\u0069\u0064\u0073\u0020\u0064\u006fn\u0027\u0074\u0020\u006dat\u0063\u0068");};_egf :=len (_eegg )+1;var _dcge ,_cbb float64 ;switch _ebg {case _bf .ST_TickMarkIn :_dcge ,_cbb =_cfgc ,0;
case _bf .ST_TickMarkOut :_dcge ,_cbb =0,_cfgc ;case _bf .ST_TickMarkCross :_dcge ,_cbb =_cfgc ,_cfgc ;};_dcge =_dcge *_ebbd ;_cbb =_cbb *_ebbd ;var _agg *_g .CT_ShapeProperties ;if _geff !=nil {_agg =_geff .SpPr ;};if _afb {_fec :=_dcae /float64 (len (_eegg ));
_ccc :=_ebfe .Left -_bge *_bbd /_gbe ;_gcf :=_ccc -_dcg *_ebbd ;if _badg {var _gbbc float64 ;for _bdea :=0;_bdea < _egf ;_bdea ++{_cdbg :=_ebfe .Bottom -float64 (_bdea )*_fec ;if _bdea < _egf -1{_eab :=_ccd .NewParagraph (_eegg [_bdea ]);_eab .SetFontSize (_bcb *_ebbd );
_eab .SetPos (_gcf ,_cdbg -_fec /2-_fad *_ebbd );_ccd .Draw (_eab );_dfge :=(_eab .Width ()/1000-_dcg )*_ebbd ;if _dfge > 0&&_dfge > _gbbc {_gbbc =_dfge ;};};};if _gbbc > 0{_ebfe .Left +=_gbbc +_ecf ;_ccc =_ebfe .Left -_bge *_bbd /_gbe ;_bbd =_ebfe .Right -_ebfe .Left ;
};};_aece :=_ccc -_cbb ;_cabc :=_ccc +_dcge ;_feg :=_ebfe .Left ;_aff :=_ebfe .Right ;for _dfcd :=0;_dfcd < _egf ;_dfcd ++{_dea :=_ebfe .Bottom -float64 (_dfcd )*_fec ;_bdag .drawLineWithProps (_aagc ,_aece ,_dea ,_cabc ,_dea ,true );_bdag .drawLineWithProps (_agg ,_feg ,_dea ,_aff ,_dea ,true );
};_bbdf :=_bbd /_gbe ;_gege :=_ebfe .Bottom -_deg ;_fdb :=_ebfe .Bottom +_fdcb ;_gedc :=_ebfe .Top ;_acfa :=_ebfe .Bottom ;for _aab :=0;_aab < _ffa ;_aab ++{_dbfb :=_ebfe .Left +(_aac -_bge )*_bbdf ;_bdag .drawLineWithProps (_caed ,_dbfb ,_gege ,_dbfb ,_fdb ,true );
_bdag .drawLineWithProps (_cceg ,_dbfb ,_gedc ,_dbfb ,_acfa ,true );if _faf {_eff :=_ccd .NewParagraph (_ef .FormatFloat (_aac ,'g',-1,64));_eff .SetFontSize (_bcb *_ebbd );_eff .SetPos (_dbfb -_beg *_ebbd ,_acfa +_gbb *_ebbd );_ccd .Draw (_eff );};_aac +=_afddb ;
};}else {_aacf :=_dcae /_gbe ;_dcad :=_ebfe .Left ;if _faf {var _aabf float64 ;for _aedf :=0;_aedf < _ffa ;_aedf ++{_fcaf :=_ebfe .Bottom -(_aac -_bge )*_aacf ;_fdf :=_ccd .NewParagraph (_ef .FormatFloat (_aac ,'g',-1,64));_fdf .SetFontSize (_bcb *_ebbd );
_fdf .SetPos (_dcad -_dcg *_ebbd ,_fcaf -_fad *_ebbd );_ccd .Draw (_fdf );_aaf :=(_fdf .Width ()/1000-_dcg )*_ebbd ;if _aaf > 0&&_aaf > _aabf {_aabf =_aaf ;};_aac +=_afddb ;};if _aabf > 0{_ebfe .Left +=_aabf +_ecf ;_bbd =_ebfe .Right -_ebfe .Left ;};};
_aac =_bge ;_dcadf :=_ebfe .Left -_fdcb ;_gfg :=_ebfe .Left +_deg ;_dcad =_ebfe .Left ;_acfdg :=_ebfe .Right ;for _gcfa :=0;_gcfa < _ffa ;_gcfa ++{_gaa :=_ebfe .Bottom -(_aac -_bge )*_aacf ;_bdag .drawLineWithProps (_caed ,_dcadf ,_gaa ,_gfg ,_gaa ,true );
_bdag .drawLineWithProps (_cceg ,_dcad ,_gaa ,_acfdg ,_gaa ,true );_aac +=_afddb ;};_ffg :=_bbd /float64 (len (_eegg ));_gbf :=_ebfe .Bottom +_bge *_dcae /_gbe ;_bca :=_gbf -_dcge ;_afag :=_gbf +_cbb ;_bdda :=_ebfe .Top ;_bgf :=_ebfe .Bottom ;_bfbf :=_gbf +_gbb *_ebbd ;
for _bece :=0;_bece < _egf ;_bece ++{_eec :=_ebfe .Left +float64 (_bece )*_ffg ;_bdag .drawLineWithProps (_aagc ,_eec ,_bca ,_eec ,_afag ,true );_bdag .drawLineWithProps (_agg ,_eec ,_bdda ,_eec ,_bgf ,true );if _badg &&_bece < _egf -1{_geb :=_ccd .NewParagraph (_eegg [_bece ]);
_geb .SetFontSize (_bcb *_ebbd );_geb .SetPos (_eec +_aec *_ebbd ,_bfbf );_ccd .Draw (_geb );};};};return nil ;};func MakeBlockFromCreator (c *_fb .Creator )(*_fb .Block ,error ){_eede ,_efd :=GetPageFromCreator (c );if _efd !=nil {return nil ,_efd ;};
_dgcc ,_efd :=_fb .NewBlockFromPage (_eede );if _efd !=nil {return nil ,_efd ;};return _dgcc ,nil ;};func IsNoSpaceLanguage (symbol string )bool {for _ ,_fgf :=range symbol {if _e .Is (_e .Han ,_fgf ){return true ;};};return false ;};func GetRegisteredFont (name string ,style FontStyle )*_ca .PdfFont {_fefa ._dfa .Lock ();
defer _fefa ._dfa .Unlock ();if _eggf ,_dcgf :=_fefa ._bgcb [name ];_dcgf {if _ecac ,_fda :=_eggf [style ];_fda {return _ecac ;};};return nil ;};func MakeImageFromChartSpace (cs *_bf .ChartSpace ,width ,height float64 ,theme *_g .Theme )(_eb .Image ,error ){_ggg ,_feb :=_dg (cs ,width ,height ,theme ,true );
if _feb !=nil {return nil ,_feb ;};_cac ,_feb :=GetPageFromCreator (_ggg );if _feb !=nil {return nil ,_feb ;};return _fe .NewImageDevice ().Render (_cac );};func TwipsFromPoints (points float64 )float64 {return points /_ag .Twips };type BorderPosition byte ;
var _egc =map[string ]FontStyle {"\u0052e\u0067\u0075\u006c\u0061\u0072":FontStyle_Regular ,"\u0042\u006f\u006c\u0064":FontStyle_Bold ,"\u0049\u0074\u0061\u006c\u0069\u0063":FontStyle_Italic ,"B\u006f\u006c\u0064\u0020\u0049\u0074\u0061\u006c\u0069\u0063":FontStyle_BoldItalic };
type legendItem struct{_gdf string ;_ceb *_g .CT_ShapeProperties ;};func DrawRectangle (c *_fb .Creator ,r *Rectangle ,w float64 ,color _fb .Color ){if color ==nil {return ;};DrawLine (c ,r .Left ,r .Top ,r .Right ,r .Top ,w ,color );DrawLine (c ,r .Left ,r .Top ,r .Left ,r .Bottom ,w ,color );
DrawLine (c ,r .Left ,r .Bottom ,r .Right ,r .Bottom ,w ,color );DrawLine (c ,r .Right ,r .Top ,r .Right ,r .Bottom ,w ,color );};func GetOpacityFromColorTransform (trs []*_g .EG_ColorTransform )float64 {for _ ,_fcf :=range trs {if _fcf !=nil {if _eedg :=_fcf .Alpha ;
_eedg !=nil {if _ecfd :=_eedg .ValAttr .ST_PositiveFixedPercentageDecimal ;_ecfd !=nil {return float64 (*_ecfd )/100000;};};};};return 1.0;};func _aggg (_deeb _g .ST_SchemeColorVal ,_abe *_g .Theme )string {if _gbdg :=_abe .ThemeElements ;_gbdg !=nil {if _daf :=_gbdg .ClrScheme ;
_daf !=nil {switch _deeb {case _g .ST_SchemeColorValLt1 :return GetColorStringFromDmlColor (_daf .Lt1 );case _g .ST_SchemeColorValDk1 ,_g .ST_SchemeColorValTx1 :return GetColorStringFromDmlColor (_daf .Dk1 );case _g .ST_SchemeColorValLt2 :return GetColorStringFromDmlColor (_daf .Lt2 );
case _g .ST_SchemeColorValDk2 :return GetColorStringFromDmlColor (_daf .Dk2 );case _g .ST_SchemeColorValAccent1 :return GetColorStringFromDmlColor (_daf .Accent1 );case _g .ST_SchemeColorValAccent2 :return GetColorStringFromDmlColor (_daf .Accent2 );case _g .ST_SchemeColorValAccent3 :return GetColorStringFromDmlColor (_daf .Accent3 );
case _g .ST_SchemeColorValAccent4 :return GetColorStringFromDmlColor (_daf .Accent4 );case _g .ST_SchemeColorValAccent5 :return GetColorStringFromDmlColor (_daf .Accent5 );case _g .ST_SchemeColorValAccent6 :return GetColorStringFromDmlColor (_daf .Accent6 );
};};};return "";};func _cgbg (_dgf ,_fcfa ,_gfd uint8 )(float64 ,float64 ,float64 ){_gff ,_gge ,_egae :=float64 (_dgf )/255,float64 (_fcfa )/255,float64 (_gfd )/255;_afc :=_gff ;if _gge < _afc {_afc =_gge ;};if _egae < _afc {_afc =_egae ;};var _fbb ,_fegg bool ;
_caeg :=_gff ;if _gge > _caeg {_caeg =_gge ;_fbb =true ;};if _egae > _caeg {_caeg =_egae ;_fbb =false ;_fegg =true ;};_abg :=(_afc +_caeg )/2;var _dafg float64 ;if _afc !=_caeg {if _abg <=0.5{_dafg =(_caeg -_afc )/(_caeg +_afc );}else {_dafg =(_caeg -_afc )/(2.0-_caeg -_afc );
};};var _bfc float64 ;if _afc !=_caeg {if _fbb {_bfc =2.0+(_egae -_gff )/(_caeg -_afc );}else if _fegg {_bfc =4.0+(_gff -_gge )/(_caeg -_afc );}else {_bfc =(_gge -_egae )/(_caeg -_afc );};_bfc *=60;if _bfc < 0{_bfc +=360;};};return _bfc ,_dafg ,_abg ;};
func _egg (_eaa *_bf .CT_CatAx )(uint32 ,_bf .ST_AxPos ,_bf .ST_TickMark ,_bf .ST_TickLblPos ,*_bf .CT_ChartLines ,uint32 ,*_g .CT_ShapeProperties ,error ){var _dga ,_bfe uint32 ;var _cgaa _bf .ST_AxPos ;var _egfb _bf .ST_TickMark ;var _cgg *_bf .CT_ChartLines ;
var _bee _bf .ST_TickLblPos ;if _eaa .AxId ==nil {return _dga ,_cgaa ,_egfb ,_bee ,_cgg ,_bfe ,_eaa .SpPr ,_fg .New ("\u004e\u006f\u0020x\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");}else {_dga =_eaa .AxId .ValAttr ;};if _eaa .AxPos ==nil {return _dga ,_cgaa ,_egfb ,_bee ,_cgg ,_bfe ,_eaa .SpPr ,_fg .New ("\u004eo\u0020x\u0020\u0061\u0078\u0069\u0073 \u0070\u006fs\u0069\u0074\u0069\u006f\u006e");
}else {_cgaa =_eaa .AxPos .ValAttr ;};if _eaa .MajorTickMark !=nil {_egfb =_eaa .MajorTickMark .ValAttr ;};if _eaa .TickLblPos !=nil {_bee =_eaa .TickLblPos .ValAttr ;};if _eaa .CrossAx ==nil {return _dga ,_cgaa ,_egfb ,_bee ,_cgg ,_bfe ,_eaa .SpPr ,_fg .New ("\u004e\u006f \u0063\u0072\u006fs\u0073\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");
}else {_bfe =_eaa .CrossAx .ValAttr ;};_cgg =_eaa .MajorGridlines ;return _dga ,_cgaa ,_egfb ,_bee ,_cgg ,_bfe ,_eaa .SpPr ,nil ;};func (_bgg FontStyle )String ()string {return []string {"\u0052e\u0067\u0075\u006c\u0061\u0072","\u0042\u006f\u006c\u0064","\u0049\u0074\u0061\u006c\u0069\u0063","\u0042\u006f\u006c\u0064\u0049\u0074\u0061\u006c\u0069\u0063"}[int (_bgg )];
};func _dae (_agd ,_bdad ,_fbae float64 )(uint8 ,uint8 ,uint8 ){var _baaa float64 ;if _fbae < 0.5{_baaa =_fbae *(1+_bdad );}else {_baaa =_fbae +_bdad -_fbae *_bdad ;};_cdbf :=_fbae *2-_baaa ;_agd /=360.0;_gffe :=_adge (_agd +1.0/3.0);_ddbd :=_adge (_agd );
_ege :=_adge (_agd -1.0/3.0);_fgd :=_cgca (_gffe ,_baaa ,_cdbf );_dede :=_cgca (_ddbd ,_baaa ,_cdbf );_ace :=_cgca (_ege ,_baaa ,_cdbf );return uint8 (255*_fgd ),uint8 (255*_dede ),uint8 (255*_ace );};func GetPageFromCreator (c *_fb .Creator )(*_ca .PdfPage ,error ){_bgge :=_c .NewBuffer ([]byte {});
_edg :=c .Write (_bgge );if _edg !=nil {return nil ,_edg ;};_gage :=_c .NewReader (_bgge .Bytes ());_cdc ,_edg :=_ca .NewPdfReader (_gage );if _edg !=nil {return nil ,_edg ;};return _cdc .GetPage (1);};func _add (_dfce string )error {if !_ad .HasSuffix (_dfce ,"\u002e\u0074\u0074\u0066"){_aa .Log .Debug ("\u0055\u006es\u0075\u0070\u0070\u006f\u0072\u0074\u0065\u0064\u0020\u0066\u006f\u006e\u0074\u0020\u0066\u0069\u006c\u0065\u0020\u0066\u006f\u0072ma\u0074\u002e");
return _cd .Errorf ("\u0055\u006e\u0073\u0075\u0070\u0070o\u0072\u0074\u0065\u0064\u0020f\u006f\u006e\u0074\u0020\u0066\u0069l\u0065\u0020\u0066\u006f\u0072m\u0061\u0074\u002c\u0020\u0063\u0075\u0072\u0072\u0065\u006e\u0074\u006cy\u0020\u006f\u006e\u006c\u0079\u0020\u0073\u0075\u0070\u0070\u006f\u0072\u0074\u0020\u0054T\u0046\u0020\u0066\u006f\u006e\u0074\u0020\u0066i\u006c\u0065\u002e");
};_bef ,_ebad :=_ff .ParseFile (_dfce );if _ebad !=nil {_aa .Log .Debug ("\u0043a\u006e\u006e\u006f\u0074\u0020\u0070\u0061\u0072\u0073\u0065\u0020T\u0054\u0046\u0020\u0066\u0069\u006c\u0065\u0020\u0025\u0073",_ebad );return _ebad ;};_edc ,_ebad :=_ca .NewCompositePdfFontFromTTFFile (_dfce );
if _ebad !=nil {return _ebad ;};_dcb :=_bef .GetNameRecords ();for _ ,_fce :=range _dcb {_afaa :=_fce [1];if _afaa ==""{return _cd .Errorf ("\u004e\u006f\u0020\u0066\u006fn\u0074\u0020\u0066\u0061\u006d\u0069\u006c\u0079\u0020\u0069\u006e\u0066\u006fr\u006d\u0061\u0074\u0069\u006f\u006e\u0020\u0069\u006e\u0020\u0074\u0068\u0065\u0020\u0066\u0069\u006c\u0065\u0020\u0025\u0073",_dfce );
};_afdc :=make ([]byte ,0);for _gaaf :=0;_gaaf < len (_afaa );_gaaf ++{if _afaa [_gaaf ]==39||_afaa [_gaaf ]==92{continue ;};_gegd :=4;if _gaaf +_gegd < len (_afaa ){if _afaa [_gaaf :_gaaf +_gegd ]=="\u0000"{_gaaf =_gaaf +_gegd +1;continue ;};};_afdc =append (_afdc ,_afaa [_gaaf ]);
};_afaa =_ad .Replace (string (_afdc ),"\u0078\u0030\u0030","",-1);_bgd :=_fce [2];if _bgd ==""{return _cd .Errorf ("N\u006f\u0020\u0073\u0074\u0079\u006ce\u0020\u0069\u006e\u0066\u006f\u0072m\u0061\u0074\u0069\u006f\u006e\u0020\u0069n\u0020\u0074\u0068\u0065\u0020\u0066\u0069\u006c\u0065\u0020%\u0073",_dfce );
};_afdc =make ([]byte ,0);for _gegeb :=0;_gegeb < len (_bgd );_gegeb ++{if _bgd [_gegeb ]==39||_bgd [_gegeb ]==92{continue ;};_aeb :=4;if _gegeb +_aeb < len (_bgd ){if _bgd [_gegeb :_gegeb +_aeb ]=="\u0000"{_gegeb =_gegeb +_aeb +1;continue ;};};_afdc =append (_afdc ,_bgd [_gegeb ]);
};_bgd =_ad .Replace (string (_afdc ),"\u0078\u0030\u0030","",-1);RegisterFont (_afaa ,_egc [_bgd ],_edc );};return nil ;};func (_defd *Rectangle )Translate (x ,y float64 ){_defd .Left +=x ;_defd .Right +=x ;_defd .Top +=y ;_defd .Bottom +=y ;};var _cfgc =_bfab (1);
var _gbb =_bfab (1.5);func (_dcagf *Rectangle )scale (_beb float64 ){_dcagf .Top *=_beb ;_dcagf .Bottom *=_beb ;_dcagf .Left *=_beb ;_dcagf .Right *=_beb ;};func (_bfa *creatorContext )drawBorderWithProps (_gbed *_g .CT_ShapeProperties ,_ddd *Rectangle ,_cee float64 ){if _ddd !=nil &&_gbed !=nil &&_gbed .Ln !=nil &&_gbed .Ln .SolidFill !=nil {_acbg :=_bfa .getPdfColorFromSolidFill (_gbed .Ln .SolidFill );
DrawRectangle (_bfa ._gae ,_ddd ,_cee ,_acbg );};};var _aec =_bfab (5);func AssignStdFontByName (style _fb .TextStyle ,fontName string )*_ca .PdfFont {_ggd :=_ca .StdFontName (fontName );return _ca .NewStandard14FontMustCompile (_ggd );};func _fed (_agfe uint8 ,_ccf float64 )string {_fba :=float64 (_agfe );
var _afaf float64 ;if _ccf < 0{_afaf =_fba *(1+_ccf );}else {_afaf =_fba +(255-_fba )*_ccf ;};return _cd .Sprintf ("\u0025\u0030\u0032\u0078",int (_afaf ));};func AdjustColorByTint (colorStr string ,tint float64 )string {var _eaf ,_dad ,_gadf uint8 ;_eabd ,_ :=_cd .Sscanf (colorStr ,"\u0025\u0030\u0032x\u0025\u0030\u0032\u0078\u0025\u0030\u0032\u0078",&_eaf ,&_dad ,&_gadf );
if _eabd !=3{return "";};return _fed (_eaf ,tint )+_fed (_dad ,tint )+_fed (_gadf ,tint );};func RegisterFontsFromDirectory (dirName string )error {_fbf ,_bagc :=_f .Open (dirName );if _bagc !=nil {return _bagc ;};defer _fbf .Close ();_cgcf ,_bagc :=_fbf .Readdirnames (0);
if _bagc !=nil {return _bagc ;};for _ ,_fdeb :=range _cgcf {if _ad .HasSuffix (_fdeb ,"\u002e\u0074\u0074\u0066"){_fee :=dirName +"\u002f"+_fdeb ;_bed :=_add (_fee );if _bed !=nil {_aa .Log .Debug ("\u0075\u006ea\u0062\u006c\u0065\u0020\u0074o\u0020\u0070\u0072\u006f\u0063e\u0073\u0073\u0020\u0061\u006e\u0064\u0020\u0072\u0065\u0067\u0069\u0073\u0074\u0065\u0072\u0020\u0066\u006f\u006e\u0074\u0020\u0066\u0072\u006f\u006d\u0020\u0054\u0054\u0046\u0020\u0066\u0069\u006c\u0065\u0020\u0025\u0073",_bed );
continue ;};};};return nil ;};func AdjustColorByLumMod (colorStr string ,lum float64 )string {var _dbfd ,_egb ,_cacde uint8 ;_agfc ,_ :=_cd .Sscanf (colorStr ,"\u0025\u0030\u0032x\u0025\u0030\u0032\u0078\u0025\u0030\u0032\u0078",&_dbfd ,&_egb ,&_cacde );
if _agfc !=3{return "";};_bfea ,_aae ,_aeef :=_cgbg (_dbfd ,_egb ,_cacde );_aeef =lum *_aeef ;_dbfd ,_egb ,_cacde =_dae (_bfea ,_aae ,_aeef );return _cd .Sprintf ("\u0025\u0030\u0032x\u0025\u0030\u0032\u0078\u0025\u0030\u0032\u0078",_dbfd ,_egb ,_cacde );
};func _acfda (_bcd *_bf .CT_DateAx )(uint32 ,_bf .ST_AxPos ,_bf .ST_TickMark ,_bf .ST_TickLblPos ,*_bf .CT_ChartLines ,uint32 ,*_g .CT_ShapeProperties ,error ){var _cbgd ,_cbf uint32 ;var _ded _bf .ST_AxPos ;var _gefd _bf .ST_TickMark ;var _dfbe *_bf .CT_ChartLines ;
var _aadg _bf .ST_TickLblPos ;if _bcd .AxId ==nil {return _cbgd ,_ded ,_gefd ,_aadg ,_dfbe ,_cbf ,_bcd .SpPr ,_fg .New ("\u004e\u006f\u0020x\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");}else {_cbgd =_bcd .AxId .ValAttr ;};if _bcd .AxPos ==nil {return _cbgd ,_ded ,_gefd ,_aadg ,_dfbe ,_cbf ,_bcd .SpPr ,_fg .New ("\u004eo\u0020x\u0020\u0061\u0078\u0069\u0073 \u0070\u006fs\u0069\u0074\u0069\u006f\u006e");
}else {_ded =_bcd .AxPos .ValAttr ;};if _bcd .MajorTickMark !=nil {_gefd =_bcd .MajorTickMark .ValAttr ;};if _bcd .TickLblPos !=nil {_aadg =_bcd .TickLblPos .ValAttr ;};if _bcd .CrossAx ==nil {return _cbgd ,_ded ,_gefd ,_aadg ,_dfbe ,_cbf ,_bcd .SpPr ,_fg .New ("\u004e\u006f \u0063\u0072\u006fs\u0073\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");
}else {_cbf =_bcd .CrossAx .ValAttr ;};_dfbe =_bcd .MajorGridlines ;return _cbgd ,_ded ,_gefd ,_aadg ,_dfbe ,_cbf ,_bcd .SpPr ,nil ;};type FontStyle byte ;func FromSTCoordinate32 (st _g .ST_Coordinate32 )int64 {if _afde :=st .ST_Coordinate32Unqualified ;
_afde !=nil {return int64 (*_afde );};return 0;};func RegisterFontsFromFiles (files []string )error {for _ ,_faec :=range files {if _ad .HasSuffix (_faec ,"\u002e\u0074\u0074\u0066"){_bga :=_add (_faec );if _bga !=nil {_aa .Log .Debug ("\u0075\u006ea\u0062\u006c\u0065\u0020\u0074o\u0020\u0070\u0072\u006f\u0063e\u0073\u0073\u0020\u0061\u006e\u0064\u0020\u0072\u0065\u0067\u0069\u0073\u0074\u0065\u0072\u0020\u0066\u006f\u006e\u0074\u0020\u0066\u0072\u006f\u006d\u0020\u0054\u0054\u0046\u0020\u0066\u0069\u006c\u0065\u0020\u0025\u0073",_bga );
continue ;};};};return nil ;};type fontsMap struct{_dfa *_d .Mutex ;_bgcb map[string ]map[FontStyle ]*_ca .PdfFont ;};type Rectangle struct{Top float64 ;Bottom float64 ;Left float64 ;Right float64 ;};func AdjustColorByShade (colorStr string ,shade float64 )string {var _ada ,_bgbe ,_def uint8 ;
_ggb ,_ :=_cd .Sscanf (colorStr ,"\u0025\u0030\u0032x\u0025\u0030\u0032\u0078\u0025\u0030\u0032\u0078",&_ada ,&_bgbe ,&_def );if _ggb !=3{return "";};return _cea (_ada ,shade )+_cea (_bgbe ,shade )+_cea (_def ,shade );};type barSerByOrder []*_bf .CT_BarSer ;
type ImgPart byte ;const (BorderPositionTop BorderPosition =0;BorderPositionLeft BorderPosition =1;BorderPositionBottom BorderPosition =2;BorderPositionRight BorderPosition =3;);func MakeTempCreator (width ,height float64 )*_fb .Creator {_accc :=_fb .New ();
_accc .SetPageSize (_fb .PageSize {width ,height });_accc .SetPageMargins (0,0,0,0);return _accc ;};func (_efc barSerByOrder )Swap (i ,j int ){_efc [i ],_efc [j ]=_efc [j ],_efc [i ]};func DrawLine (c *_fb .Creator ,x0 ,y0 ,x1 ,y1 ,width float64 ,color _fb .Color ){if color ==nil {return ;
};_dge :=c .NewLine (x0 ,y0 ,x1 ,y1 );_dge .SetLineWidth (width );_dge .SetColor (color );c .Draw (_dge );};func GetDataFromXfrm (xfrm *_g .CT_Transform2D )(float64 ,float64 ,float64 ,float64 ){var _gfbb ,_ced ,_geba ,_fafe float64 ;if _cbbg :=xfrm .Off ;
_cbbg !=nil {_gfbb =_ag .FromEMU (FromSTCoordinate (_cbbg .XAttr ));_ced =_ag .FromEMU (FromSTCoordinate (_cbbg .YAttr ));};if _eafe :=xfrm .Ext ;_eafe !=nil {_geba =_ag .FromEMU (_eafe .CxAttr );_fafe =_ag .FromEMU (_eafe .CyAttr );};return _gfbb ,_ced ,_geba ,_fafe ;
};var _cdd =_bfab (0.125);func RegisterFont (name string ,style FontStyle ,font *_ca .PdfFont ){_fefa ._dfa .Lock ();if _fefa ._bgcb [name ]==nil {_fefa ._bgcb [name ]=map[FontStyle ]*_ca .PdfFont {};};_fefa ._bgcb [name ][style ]=font ;_fefa ._dfa .Unlock ();
};func _dg (_gad *_bf .ChartSpace ,_fdc ,_faed float64 ,_adeg *_g .Theme ,_cgc bool )(*_fb .Creator ,error ){_cacd :=1.0;if _cgc {_cacd =8.0;};_afd :=&Rectangle {};_dfg :=&Rectangle {Top :_afd .Top ,Bottom :_faed -_afd .Bottom ,Left :_afd .Left ,Right :_fdc -_afd .Right };
_gee :=MakeTempCreator (_fdc *_cacd +1,_faed *_cacd +1);_caf :=&creatorContext {_gae :_gee ,_agfb :_adeg ,_dafd :_cacd };var _ebf bool ;if _bdc :=_gad .Chart ;_bdc !=nil {_bde :=_bdc .PlotArea ;if _bde ==nil {return nil ,_fg .New ("\u004e\u006f\u0020p\u006c\u006f\u0074\u0020\u0061\u0072\u0065\u0061");
};_eeg :=&Rectangle {Top :_bfab (10),Bottom :_dfg .Bottom -_bfab (15),Left :_bfab (10),Right :_dfg .Right -_bfab (10)};var _bfg *Rectangle ;_bfb :=_bdc .Legend ;if _bfb !=nil {_gcc :=_bfb .Overlay !=nil &&_bfb .Overlay .ValAttr !=nil &&*_bfb .Overlay .ValAttr ;
if _dec :=_bfb .LegendPos ;_dec !=nil {switch _dec .ValAttr {case _bf .ST_LegendPosTr :if !_gcc {_eeg =&Rectangle {Top :_bfab (25),Bottom :_dfg .Bottom -_bfab (10),Left :_bfab (10),Right :_dfg .Right -_bfab (25)};};_bfg =&Rectangle {Top :_bfab (2.5),Bottom :_bfab (22.5),Left :_dfg .Right -_bfab (22.5),Right :_dfg .Right -_bfab (2.5)};
case _bf .ST_LegendPosT :_bfg =&Rectangle {Top :_bfab (2.5),Bottom :_bfab (7.5),Left :(_dfg .Right -_dfg .Left )*0.25,Right :(_dfg .Right -_dfg .Left )*0.75};if !_gcc {_eeg =&Rectangle {Top :_bfab (12.5),Bottom :_dfg .Bottom -_bfab (15),Left :_bfab (10),Right :_dfg .Right -_bfab (5)};
};_ebf =true ;case _bf .ST_LegendPosB :_bfg =&Rectangle {Top :_dfg .Bottom -_bfab (7.5),Bottom :_dfg .Bottom -_bfab (2.5),Left :(_dfg .Right -_dfg .Left )*0.25,Right :(_dfg .Right -_dfg .Left )*0.75};if !_gcc {_eeg =&Rectangle {Top :_bfab (5),Bottom :_dfg .Bottom -_bfab (15),Left :_bfab (10),Right :_dfg .Right -_bfab (5)};
};_ebf =true ;case _bf .ST_LegendPosR :_bfg =&Rectangle {Top :(_dfg .Bottom -_dfg .Top )/2-_bfab (10),Bottom :(_dfg .Bottom -_dfg .Top )/2+_bfab (10),Left :_dfg .Right -_bfab (22.5),Right :_dfg .Right -_bfab (2.5)};if !_gcc {_eeg =&Rectangle {Top :_bfab (5),Bottom :_dfg .Bottom -_bfab (12.5),Left :_bfab (10),Right :_dfg .Right -_bfab (25)};
};case _bf .ST_LegendPosL :_bfg =&Rectangle {Top :(_dfg .Bottom -_dfg .Top )/2-_bfab (10),Bottom :(_dfg .Bottom -_dfg .Top )/2+_bfab (10),Left :_bfab (2.5),Right :_bfab (22.5)};if !_gcc {_eeg =&Rectangle {Top :_bfab (5),Bottom :_dfg .Bottom -_bfab (12.5),Left :_bfab (30),Right :_dfg .Right -_bfab (5)};
};default:_bfg =&Rectangle {Top :(_dfg .Bottom -_dfg .Top )/2-_bfab (10),Bottom :(_dfg .Bottom -_dfg .Top )/2+_bfab (10),Left :_dfg .Right -_bfab (25),Right :_dfg .Right -_bfab (5)};if !_gcc {_eeg =&Rectangle {Top :_bfab (5),Bottom :_dfg .Bottom -_bfab (12.5),Left :_bfab (100),Right :_dfg .Right -_bfab (25)};
};};};};_eeg .scale (_cacd );_caf .drawBorderWithProps (_bde .SpPr ,_eeg ,_cdd );_aged :=[]*legendItem {};var _eae error ;_bea :=_bde .CChoice ;for _ ,_fgg :=range _bde .Choice {if _caff :=_fgg .BarChart ;_caff !=nil {_aged ,_eae =_caf .drawBarChart (_caff ,_eeg ,_bea );
if _eae !=nil {return nil ,_eae ;};};};if _bfb !=nil {_bfg .scale (_cacd );_caf .drawBorderWithProps (_bfb .SpPr ,_bfg ,_cdd );if len (_aged )!=0{_caf .drawLegend (_bfg ,_aged ,_ebf );};};};_dfg .scale (_cacd );_caf .drawBorderWithProps (_gad .SpPr ,_dfg ,_cdd );
return _gee ,nil ;};var _fad =_bfab (1.5);var _fefa =fontsMap {_dfa :&_d .Mutex {},_bgcb :map[string ]map[FontStyle ]*_ca .PdfFont {}};func PointsFromTwips (twips int64 )float64 {return float64 (int64 (float64 (twips )*_ag .Twips *10+0.5))/10;};func FromSTPercentage (st *_g .ST_Percentage )float64 {if _gec :=st .ST_PercentageDecimal ;
_gec !=nil {return float64 (*_gec )/100000;};return 0;};func _bdg (_abfa _g .ST_SchemeColorVal ,_egab *_g .Theme )string {if _gbg :=_egab .ThemeElements ;_gbg !=nil {if _eea :=_gbg .ClrScheme ;_eea !=nil {switch _abfa {case _g .ST_SchemeColorValLt1 :return GetColorStringFromDmlColor (_eea .Lt1 );
case _g .ST_SchemeColorValDk1 ,_g .ST_SchemeColorValTx1 :return GetColorStringFromDmlColor (_eea .Dk1 );case _g .ST_SchemeColorValLt2 :return GetColorStringFromDmlColor (_eea .Lt2 );case _g .ST_SchemeColorValDk2 :return GetColorStringFromDmlColor (_eea .Dk2 );
case _g .ST_SchemeColorValAccent1 :return GetColorStringFromDmlColor (_eea .Accent1 );case _g .ST_SchemeColorValAccent2 :return GetColorStringFromDmlColor (_eea .Accent2 );case _g .ST_SchemeColorValAccent3 :return GetColorStringFromDmlColor (_eea .Accent3 );
case _g .ST_SchemeColorValAccent4 :return GetColorStringFromDmlColor (_eea .Accent4 );case _g .ST_SchemeColorValAccent5 :return GetColorStringFromDmlColor (_eea .Accent5 );case _g .ST_SchemeColorValAccent6 :return GetColorStringFromDmlColor (_eea .Accent6 );
};};};return "";};func _bfab (_gfge float64 )float64 {return _gfge *_ag .Millimeter };func CropImageByRect (sourceImg _eb .Image ,rect _eb .Rectangle )_eb .Image {_eef ,_fea ,_bbb ,_abad :=rect .Min .X ,rect .Min .Y ,rect .Max .X ,rect .Max .Y ;_bgbc :=_eb .NewNRGBA (_eb .Rect (0,0,_bbb -_eef ,_abad -_fea ));
for _eag :=_eef ;_eag < _bbb ;_eag ++{for _gggc :=_fea ;_gggc < _abad ;_gggc ++{_bgbc .Set (_eag -_eef ,_gggc -_fea ,sourceImg .At (_eag ,_gggc ));};};return _bgbc ;};func GetImage (c *_fb .Creator ,goImg _eb .Image ,imgHeight ,imgWidth ,left ,top ,dividerX ,dividerY float64 ,part ImgPart )(*_fb .Image ,error ){if goImg ==nil {return nil ,nil ;
};_ebac :=goImg .Bounds ().Size ();_cfgg :=_ebac .X ;_gcb :=_ebac .Y ;if dividerX !=0{dividerX =dividerX /imgWidth *float64 (_cfgg );};if dividerY !=0{dividerY =dividerY /imgHeight *float64 (_gcb );};var _fgfe _eb .Rectangle ;switch part {case ImgPart_t :_fgfe =_eb .Rect (0,0,_cfgg ,int (dividerY ));
case ImgPart_b :_fgfe =_eb .Rect (0,int (dividerY ),_cfgg ,_gcb );case ImgPart_l :_fgfe =_eb .Rect (0,0,int (dividerX ),_gcb );case ImgPart_r :_fgfe =_eb .Rect (int (dividerX ),0,_cfgg ,_gcb );case ImgPart_lt :_fgfe =_eb .Rect (0,0,int (dividerX ),int (dividerY ));
case ImgPart_rt :_fgfe =_eb .Rect (int (dividerX ),0,_cfgg ,int (dividerY ));case ImgPart_lb :_fgfe =_eb .Rect (0,int (dividerY ),int (dividerX ),_gcb );case ImgPart_rb :_fgfe =_eb .Rect (int (dividerX ),int (dividerY ),_cfgg ,_gcb );default:_fgfe =_eb .Rect (0,0,_cfgg ,_gcb );
};_bdf :=CropImageByRect (goImg ,_fgfe );_fbab ,_abae :=c .NewImageFromGoImage (_bdf );if _abae !=nil {return nil ,_abae ;};_fbab .Scale (imgWidth /float64 (_cfgg ),imgHeight /float64 (_gcb ));_fbab .SetPos (left ,top );return _fbab ,nil ;};var _dce =_bfab (1.5);
func (_eba barSerByOrder )Less (i ,j int )bool {return _eba [i ].Order .ValAttr < _eba [j ].Order .ValAttr };func _cea (_fgge uint8 ,_baf float64 )string {_ageg :=float64 (_fgge );return _cd .Sprintf ("\u0025\u0030\u0032\u0078",int (_ageg *_baf ));};const (FontStyle_Regular FontStyle =0;
FontStyle_Bold FontStyle =1;FontStyle_Italic FontStyle =2;FontStyle_BoldItalic FontStyle =3;);func GetColorStringFromDmlColor (dmlColor *_g .CT_Color )string {var _fbc string ;if _bgef :=dmlColor .SrgbClr ;_bgef !=nil {_fbc =_bgef .ValAttr ;}else if _fece :=dmlColor .SysClr ;
_fece !=nil {return "\u0030\u0030\u0030\u0030\u0030\u0030";};return _fbc ;};