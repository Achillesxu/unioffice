//
// Copyright 2020 FoxyUtils ehf. All rights reserved.
//
// This is a commercial product and requires a license to operate.
// A trial license can be obtained at https://unidoc.io
//
// DO NOT EDIT: generated by unitwist Go source code obfuscator.
//
// Use of this source code is governed by the UniDoc End User License Agreement
// terms that can be accessed at https://unidoc.io/eula/

package convertutils ;import (_ad "bytes";_ae "errors";_adg "fmt";_ag "github.com/unidoc/unioffice/common/logger";_b "github.com/unidoc/unioffice/measurement";_fda "github.com/unidoc/unioffice/schema/soo/dml";_ac "github.com/unidoc/unioffice/schema/soo/dml/chart";_fd "github.com/unidoc/unioffice/spreadsheet/format";_cb "github.com/unidoc/unipdf/v3/creator";_afb "github.com/unidoc/unipdf/v3/model";_bf "github.com/unidoc/unipdf/v3/render";_aef "github.com/unidoc/unitype";_d "image";_g "math";_c "os";_ca "sort";_e "strconv";_ge "strings";_af "sync";_f "unicode";);func (_bbda FontStyle )String ()string {return []string {"\u0052e\u0067\u0075\u006c\u0061\u0072","\u0042\u006f\u006c\u0064","\u0049\u0074\u0061\u006c\u0069\u0063","\u0042\u006f\u006c\u0064\u0049\u0074\u0061\u006c\u0069\u0063"}[int (_bbda )];};var _gfb =_gde (1);func AdjustColorByLumMod (colorStr string ,lum float64 )string {var _bbdg ,_gefg ,_ddde uint8 ;_fca ,_ :=_adg .Sscanf (colorStr ,"\u0025\u0030\u0032x\u0025\u0030\u0032\u0078\u0025\u0030\u0032\u0078",&_bbdg ,&_gefg ,&_ddde );if _fca !=3{return "";};_fedc ,_babb ,_fdac :=_eae (_bbdg ,_gefg ,_ddde );_fdac =lum *_fdac ;_bbdg ,_gefg ,_ddde =_cfc (_fedc ,_babb ,_fdac );return _adg .Sprintf ("\u0025\u0030\u0032x\u0025\u0030\u0032\u0078\u0025\u0030\u0032\u0078",_bbdg ,_gefg ,_ddde );};var _fga =_gde (0.5);func GetRegisteredFont (name string ,style FontStyle )*_afb .PdfFont {_dfgb ._add .Lock ();defer _dfgb ._add .Unlock ();if _aeg ,_aedb :=_dfgb ._eccb [name ];_aedb {if _bfad ,_dbdd :=_aeg [style ];_dbdd {return _bfad ;};};return nil ;};func CropImageByRect (sourceImg _d .Image ,rect _d .Rectangle )_d .Image {_bcgc ,_bbdb ,_eeebc ,_befb :=rect .Min .X ,rect .Min .Y ,rect .Max .X ,rect .Max .Y ;_cac :=_d .NewNRGBA (_d .Rect (0,0,_eeebc -_bcgc ,_befb -_bbdb ));for _addf :=_bcgc ;_addf < _eeebc ;_addf ++{for _cdfe :=_bbdb ;_cdfe < _befb ;_cdfe ++{_cac .Set (_addf -_bcgc ,_cdfe -_bbdb ,sourceImg .At (_addf ,_cdfe ));};};return _cac ;};func Lighten (clr float64 )float64 {return 0.6+0.4*clr };func _dceb (_abfc uint8 ,_dfg float64 )string {_gbe :=float64 (_abfc );var _gecf float64 ;if _dfg < 0{_gecf =_gbe *(1+_dfg );}else {_gecf =_gbe +(255-_gbe )*_dfg ;};return _adg .Sprintf ("\u0025\u0030\u0032\u0078",int (_gecf ));};func (_aac *creatorContext )drawLegend (_geb *Rectangle ,_gcg []*legendItem ,_acb bool ){_fdf :=_aac ._bggg ;_fae :=_gde (2.5)*_fdf ;_ged :=_ebda *_fdf ;_dee :=(_fae -_ged )/2;_aba :=float64 (len (_gcg ));if _acb {_cgb :=&Rectangle {Top :_geb .Top +_gde (1)*_fdf ,Bottom :_geb .Bottom -_gde (1)*_fdf ,Left :_geb .Left +_gde (2.5)*_fdf ,Right :_geb .Right -_gde (2.5)*_fdf };var _fadd float64 ;if _aba > 1{_fadd =(_cgb .Right -_cgb .Left )/_aba ;};_accd :=_cgb .Left ;_adga :=_cgb .Top ;for _ ,_dca :=range _gcg {if _dge :=_dca ._fffb ;_dge !=nil {_aac .drawRectangleWithProps (_dge ,_accd ,_adga +_dee ,_ged ,_ged ,false );_fadb :=_accd +_ged *2;_cdd :=_aac ._ddb .NewStyledParagraph ();_cdd .SetPos (_fadb ,_adga );_aae :=_cdd .Append (_dca ._ccd );_gae ,_ecc :=_afb .NewStandard14Font (_afb .HelveticaName );if _ecc ==nil {_aae .Style =_cb .TextStyle {FontSize :_fae ,Font :_gae ,TextRise :0.4};_aac ._ddb .Draw (_cdd );};};_accd +=_fadd ;};}else {_eecg :=&Rectangle {Top :_geb .Top +_gde (2.5)*_fdf ,Bottom :_geb .Bottom -_gde (2.5)*_fdf ,Left :_geb .Left +_gde (2.5)*_fdf ,Right :_geb .Right -_gde (2.5)*_fdf };var _gff float64 ;if _aba > 1{_gff =(_eecg .Bottom -_eecg .Top -_fae )/(_aba -1);};_abfa :=_eecg .Top ;_cdbg :=_eecg .Left ;_edd :=_cdbg +_ged *2;for _ ,_dbd :=range _gcg {if _cdf :=_dbd ._fffb ;_cdf !=nil {_aac .drawRectangleWithProps (_cdf ,_cdbg ,_abfa +_dee ,_ged ,_ged ,false );_dbg :=_aac ._ddb .NewStyledParagraph ();_dbg .SetPos (_edd ,_abfa );_bag :=_dbg .Append (_dbd ._ccd );_bbf ,_fcb :=_afb .NewStandard14Font (_afb .HelveticaName );if _fcb ==nil {_bag .Style =_cb .TextStyle {FontSize :_fae ,Font :_bbf ,TextRise :0.4};_aac ._ddb .Draw (_dbg );};};_abfa +=_gff ;};};};func (_edcd *Rectangle )scale (_cefd float64 ){_edcd .Top *=_cefd ;_edcd .Bottom *=_cefd ;_edcd .Left *=_cefd ;_edcd .Right *=_cefd ;};const (ImgPart_whole ImgPart =0;ImgPart_t ImgPart =1;ImgPart_b ImgPart =2;ImgPart_l ImgPart =3;ImgPart_r ImgPart =4;ImgPart_lt ImgPart =5;ImgPart_rt ImgPart =6;ImgPart_lb ImgPart =7;ImgPart_rb ImgPart =8;);func MakeBlockFromChartSpace (cs *_ac .ChartSpace ,width ,height float64 ,theme *_fda .Theme )(*_cb .Block ,error ){_afa ,_efd :=_agbd (cs ,width ,height ,theme ,false );if _efd !=nil {return nil ,_efd ;};_beg ,_efd :=GetPageFromCreator (_afa );if _efd !=nil {return nil ,_efd ;};_bae ,_efd :=_cb .NewBlockFromPage (_beg );if _efd !=nil {return nil ,_efd ;};return _bae ,nil ;};type FontStyle byte ;var StdFontsMap =map[string ][]string {"\u0048e\u006c\u0076\u0065\u0074\u0069\u0063a":[]string {"\u0048e\u006c\u0076\u0065\u0074\u0069\u0063a","\u0048\u0065\u006c\u0076\u0065\u0074\u0069\u0063\u0061-\u0042\u006f\u006c\u0064","\u0048\u0065\u006c\u0076\u0065\u0074\u0069\u0063\u0061\u002d\u004f\u0062l\u0069\u0071\u0075\u0065","H\u0065\u006c\u0076\u0065ti\u0063a\u002d\u0042\u006f\u006c\u0064O\u0062\u006c\u0069\u0071\u0075\u0065"},"\u0043o\u0075\u0072\u0069\u0065\u0072":[]string {"\u0043o\u0075\u0072\u0069\u0065\u0072","\u0043\u006f\u0075r\u0069\u0065\u0072\u002d\u0042\u006f\u006c\u0064","\u0043o\u0075r\u0069\u0065\u0072\u002d\u004f\u0062\u006c\u0069\u0071\u0075\u0065","\u0043\u006f\u0075\u0072ie\u0072\u002d\u0042\u006f\u006c\u0064\u004f\u0062\u006c\u0069\u0071\u0075\u0065"},"\u0054i\u006de\u0073\u0020\u004e\u0065\u0077\u0020\u0052\u006f\u006d\u0061\u006e":[]string {"T\u0069\u006d\u0065\u0073\u002d\u0052\u006f\u006d\u0061\u006e","\u0054\u0069\u006d\u0065\u0073\u002d\u0042\u006f\u006c\u0064","\u0054\u0069\u006de\u0073\u002d\u0049\u0074\u0061\u006c\u0069\u0063","\u0054\u0069m\u0065\u0073\u002dB\u006f\u006c\u0064\u0049\u0074\u0061\u006c\u0069\u0063"},"\u0064e\u0066\u0061\u0075\u006c\u0074":[]string {"\u0048e\u006c\u0076\u0065\u0074\u0069\u0063a","\u0048\u0065\u006c\u0076\u0065\u0074\u0069\u0063\u0061-\u0042\u006f\u006c\u0064","\u0048\u0065\u006c\u0076\u0065\u0074\u0069\u0063\u0061\u002d\u004f\u0062l\u0069\u0071\u0075\u0065","H\u0065\u006c\u0076\u0065ti\u0063a\u002d\u0042\u006f\u006c\u0064O\u0062\u006c\u0069\u0071\u0075\u0065"}};func GetOpacityFromColorTransform (trs []*_fda .EG_ColorTransform )float64 {for _ ,_cbf :=range trs {if _cbf !=nil {if _beba :=_cbf .Alpha ;_beba !=nil {if _eadc :=_beba .ValAttr .ST_PositiveFixedPercentageDecimal ;_eadc !=nil {return float64 (*_eadc )/100000;};};};};return 1.0;};const (FontStyle_Regular FontStyle =0;FontStyle_Bold FontStyle =1;FontStyle_Italic FontStyle =2;FontStyle_BoldItalic FontStyle =3;);var _aedg =_gde (5);func IsNoSpaceLanguage (symbol string )bool {for _ ,_eabf :=range symbol {if _f .Is (_f .Han ,_eabf ){return true ;};};return false ;};var _dag =_gde (7.5);func AdjustColor (colorStr string ,EG_ColorTransform []*_fda .EG_ColorTransform )string {for _ ,_ffc :=range EG_ColorTransform {if _gaeg :=_ffc .Tint ;_gaeg !=nil {if _dcgd :=_gaeg .ValAttr .ST_PositiveFixedPercentageDecimal ;_dcgd !=nil {colorStr =AdjustColorByTint (colorStr ,float64 (*_dcgd )/100000);};};if _cfeg :=_ffc .Shade ;_cfeg !=nil {if _acbd :=_cfeg .ValAttr .ST_PositiveFixedPercentageDecimal ;_acbd !=nil {colorStr =AdjustColorByShade (colorStr ,float64 (*_acbd )/100000);};};if _eeeb :=_ffc .LumMod ;_eeeb !=nil {if _bfa :=_eeeb .ValAttr .ST_PercentageDecimal ;_bfa !=nil {colorStr =AdjustColorByLumMod (colorStr ,float64 (*_bfa )/100000);};};};return colorStr ;};func _dded (_gebe *_ac .CT_ValAx )(uint32 ,_ac .ST_AxPos ,_ac .ST_TickMark ,_ac .ST_TickLblPos ,*_ac .CT_ChartLines ,uint32 ,*_fda .CT_ShapeProperties ,error ){var _dgee ,_gbd uint32 ;var _bcfa _ac .ST_AxPos ;var _gcd _ac .ST_TickMark ;var _gfc *_ac .CT_ChartLines ;var _affg _ac .ST_TickLblPos ;if _gebe .AxId ==nil {return _dgee ,_bcfa ,_gcd ,_affg ,_gfc ,_gbd ,_gebe .SpPr ,_ae .New ("\u004e\u006f\u0020x\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");}else {_dgee =_gebe .AxId .ValAttr ;};if _gebe .AxPos ==nil {return _dgee ,_bcfa ,_gcd ,_affg ,_gfc ,_gbd ,_gebe .SpPr ,_ae .New ("\u004eo\u0020x\u0020\u0061\u0078\u0069\u0073 \u0070\u006fs\u0069\u0074\u0069\u006f\u006e");}else {_bcfa =_gebe .AxPos .ValAttr ;};if _gebe .MajorTickMark !=nil {_gcd =_gebe .MajorTickMark .ValAttr ;};if _gebe .TickLblPos !=nil {_affg =_gebe .TickLblPos .ValAttr ;};if _gebe .CrossAx ==nil {return _dgee ,_bcfa ,_gcd ,_affg ,_gfc ,_gbd ,_gebe .SpPr ,_ae .New ("\u004e\u006f \u0063\u0072\u006fs\u0073\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");}else {_gbd =_gebe .CrossAx .ValAttr ;};_gfc =_gebe .MajorGridlines ;return _dgee ,_bcfa ,_gcd ,_affg ,_gfc ,_gbd ,_gebe .SpPr ,nil ;};func MakeImageFromChartSpace (cs *_ac .ChartSpace ,width ,height float64 ,theme *_fda .Theme )(_d .Image ,error ){_cdb ,_dg :=_agbd (cs ,width ,height ,theme ,true );if _dg !=nil {return nil ,_dg ;};_cca ,_dg :=GetPageFromCreator (_cdb );if _dg !=nil {return nil ,_dg ;};return _bf .NewImageDevice ().Render (_cca );};func (_gc barSerByOrder )Less (i ,j int )bool {return _gc [i ].Order .ValAttr < _gc [j ].Order .ValAttr };func _dagf (_egc _fda .ST_SchemeColorVal ,_dbe *_fda .Theme )string {if _dedd :=_dbe .ThemeElements ;_dedd !=nil {if _gaba :=_dedd .ClrScheme ;_gaba !=nil {switch _egc {case _fda .ST_SchemeColorValLt1 :return GetColorStringFromDmlColor (_gaba .Lt1 );case _fda .ST_SchemeColorValDk1 ,_fda .ST_SchemeColorValTx1 :return GetColorStringFromDmlColor (_gaba .Dk1 );case _fda .ST_SchemeColorValLt2 :return GetColorStringFromDmlColor (_gaba .Lt2 );case _fda .ST_SchemeColorValDk2 :return GetColorStringFromDmlColor (_gaba .Dk2 );case _fda .ST_SchemeColorValAccent1 :return GetColorStringFromDmlColor (_gaba .Accent1 );case _fda .ST_SchemeColorValAccent2 :return GetColorStringFromDmlColor (_gaba .Accent2 );case _fda .ST_SchemeColorValAccent3 :return GetColorStringFromDmlColor (_gaba .Accent3 );case _fda .ST_SchemeColorValAccent4 :return GetColorStringFromDmlColor (_gaba .Accent4 );case _fda .ST_SchemeColorValAccent5 :return GetColorStringFromDmlColor (_gaba .Accent5 );case _fda .ST_SchemeColorValAccent6 :return GetColorStringFromDmlColor (_gaba .Accent6 );};};};return "";};func (_cbg *creatorContext )drawRectangleWithProps (_acgd *_fda .CT_ShapeProperties ,_befa ,_eedd ,_fag ,_fggg float64 ,_gcfa bool ){_fage :=_cbg ._ddb .NewRectangle (_befa ,_eedd ,_fag ,_fggg );if _acgd ==nil {if _gcfa {_fage .SetBorderWidth (_acf );}else {return ;};}else {_ffcd :=_cbg .getPdfColorFromSolidFill (_acgd .SolidFill );if _ffcd !=nil {_fage .SetFillColor (_ffcd );};if _caf :=_acgd .Ln ;_caf !=nil {if _befd :=_caf .WAttr ;_befd !=nil {_affd :=_b .FromEMU (int64 (*_befd ));_fage .SetBorderWidth (_affd );if _daea :=_caf .SolidFill ;_daea !=nil {_acef :=_cbg .getPdfColorFromSolidFill (_daea );if _acef !=nil {_fage .SetBorderColor (_acef );};};}else {_fage .SetBorderWidth (0);};};};_cbg ._ddb .Draw (_fage );};func (_aea *creatorContext )getPdfColorFromSolidFill (_feb *_fda .CT_SolidColorFillProperties )_cb .Color {if _feb ==nil {return nil ;};_acff :="";if _fcbf :=_feb .SrgbClr ;_fcbf !=nil {_acff =_fcbf .ValAttr ;}else if _edfa :=_feb .SchemeClr ;_edfa !=nil {_acff =_dagf (_edfa .ValAttr ,_aea ._cgc );};if _acff ==""{return nil ;};return _cb .ColorRGBFromHex ("\u0023"+_acff );};var _ebda =_gde (1.5);func (_ff *creatorContext )drawBarChart (_fe *_ac .CT_BarChart ,_ce *Rectangle ,_ba *_ac .CT_PlotAreaChoice1 )([]*legendItem ,error ){var _bc bool ;if _eb :=_fe .BarDir ;_eb !=nil {_bc =_eb .ValAttr ==_ac .ST_BarDirBar ;};_fc :=_fe .Ser ;_ca .Sort (barSerByOrder (_fc ));_bg :=map[string ]serCategory {};_be :=[]string {};_fb :=[]*legendItem {};_cbb :=_g .Inf (1);_gb :=_g .Inf (-1);for _ ,_ef :=range _fc {var _ed string ;if _bfg :=_ef .Tx ;_bfg !=nil {if _aff :=_bfg .Choice ;_aff !=nil {if _aff .V !=nil {_ed =*_aff .V ;}else if _bea :=_aff .StrRef ;_bea !=nil {if _ebd :=_bea .StrCache ;_ebd !=nil {for _ ,_dc :=range _ebd .Pt {_ed =_dc .V ;};};};};};if _cg :=_ef .Cat ;_cg !=nil {if _eg :=_cg .Choice ;_eg !=nil {if _ffb :=_eg .StrRef ;_ffb !=nil {if _bb :=_ffb .StrCache ;_bb !=nil {for _ ,_aca :=range _bb .Pt {_fdaa :=_aca .V ;if _ ,_bab :=_bg [_fdaa ];!_bab {_bg [_fdaa ]=serCategory {_fde :_fdaa ,_eec :[]serValue {}};_be =append (_be ,_fdaa );};};};}else if _fg :=_eg .NumRef ;_fg !=nil {if _ffd :=_fg .NumCache ;_ffd !=nil {var _cba string ;if _ffd .FormatCode !=nil {_cba =*_ffd .FormatCode ;};for _ ,_bd :=range _ffd .Pt {var _fbb string ;if _bd .FormatCodeAttr ==nil {_fbb =_cba ;}else {_fbb =*_bd .FormatCodeAttr ;};var _cbbg string ;_beag ,_fff :=_e .ParseFloat (_bd .V ,64);if _fff !=nil {_cbbg =_bd .V ;}else {_cbbg =_fd .Number (_beag ,_fbb );};if _ ,_ga :=_bg [_cbbg ];!_ga {_bg [_cbbg ]=serCategory {_fde :_cbbg ,_eec :[]serValue {}};_be =append (_be ,_cbbg );};};};};};};if _fdb :=_ef .Val ;_fdb !=nil {if _cbd :=_fdb .Choice ;_cbd !=nil {if _fbd :=_cbd .NumRef ;_fbd !=nil {if _eff :=_fbd .NumCache ;_eff !=nil {for _dd ,_cd :=range _eff .Pt {_bcb ,_fec :=_e .ParseFloat (_cd .V ,64);if _fec !=nil {_bcb =0;_ag .Log .Debug ("\u0070a\u0072s\u0065\u0020\u0065\u0072\u0072\u006f\u0072\u003a\u0020\u0025\u0073",_fec );};if _bcb > _gb {_gb =_bcb ;};if _bcb < _cbb {_cbb =_bcb ;};_bcf :=_bg [_be [_dd ]];_bcf ._eec =append (_bcf ._eec ,serValue {_fed :_ed ,_fbag :_bcb ,_fbdf :_ef .SpPr });_bg [_be [_dd ]]=_bcf ;};};};};};_fb =append (_fb ,&legendItem {_ccd :_ed ,_fffb :_ef .SpPr });};var _bcd float64 ;var _ee ,_df float64 ;if _gb ==0&&_cbb ==0{_bcd =0.2;_df =0;_ee =1;}else {var _bdc float64 ;if _db :=_g .Abs (_cbb );_gb < _db {_bdc =_db ;}else {_bdc =_gb ;};_ebc :=_g .Pow (10,_g .Floor (_g .Log10 (_bdc )));_ceg :=_bdc /_ebc ;if _ceg >=1.715&&_ceg < 4.29{_bcd =0.5;}else if _ceg >=4.29&&_ceg < 8.58{_bcd =1;}else {_bcd =2;};_bcd *=_ebc ;if _gb <=0{_ee =0;}else {_ee =(_g .Ceil (_gb /_bcd )+1)*_bcd ;};if _cbb >=0{_df =0;}else {_df =(_g .Floor (_cbb /_bcd )-1)*_bcd ;};};_cea :=_ff .drawAxes (_ba ,_df ,_ee ,_bcd ,_be ,_ce ,_bc );if _cea !=nil {return nil ,_cea ;};_efb :=0.0;if _fe .GapWidth !=nil {if _affc :=_fe .GapWidth .ValAttr ;_affc !=nil {if _cgd :=_affc .ST_GapAmountUShort ;_cgd !=nil {_efb =float64 (*_cgd )/100.0;};};};_gee :=_ce .Right -_ce .Left ;_gec :=_ce .Bottom -_ce .Top ;_aag :=float64 (len (_be ));if _bc {_agb :=_ee /(_ee -_df )*_gee ;_fbf :=-_df /(_ee -_df )*_gee ;_edc :=_ce .Left +_fbf ;_de :=_gec /_aag ;for _bgf ,_fad :=range _be {_cc :=_bg [_fad ];_cf :=float64 (len (_cc ._eec ))+_efb ;_acg :=_de /_cf ;_bga :=_acg *_efb ;_bdf :=_ce .Bottom -float64 (_bgf )*_de -_bga /2-_acg ;for _ ,_fba :=range _cc ._eec {if _fba ._fbag ==0{continue ;};var _acc ,_feg float64 ;if _fba ._fbag > 0{_feg =_fba ._fbag /_ee *_agb ;_ff .drawRectangleWithProps (_fba ._fbdf ,_edc ,_bdf ,_feg ,_acg ,false );}else {_feg =_fba ._fbag /_df *_fbf ;_acc =_edc -_feg ;_ff .drawRectangleWithProps (_fba ._fbdf ,_acc ,_bdf ,_feg ,_acg ,false );};_bdf -=_acg ;};};}else {_aed :=_ee /(_ee -_df )*_gec ;_afg :=-_df /(_ee -_df )*_gec ;_dfe :=_ce .Top +_aed ;_ab :=_gee /_aag ;for _dfa ,_ea :=range _be {_dfab :=_bg [_ea ];_ec :=float64 (len (_dfab ._eec ))+_efb ;_cad :=_ab /_ec ;_fef :=_cad *_efb ;_ccg :=_ce .Left +float64 (_dfa )*_ab +_fef /2;for _ ,_fgg :=range _dfab ._eec {var _ebdg ,_fbe float64 ;if _fgg ._fbag > 0{_fbe =_fgg ._fbag /_ee *_aed ;_ebdg =_dfe -_fbe ;_ff .drawRectangleWithProps (_fgg ._fbdf ,_ccg ,_ebdg ,_cad ,_fbe ,false );}else {_fbe =_fgg ._fbag /_df *_afg ;_ff .drawRectangleWithProps (_fgg ._fbdf ,_ccg ,_dfe ,_cad ,_fbe ,false );};_ccg +=_cad ;};};};return _fb ,nil ;};func AdjustColorByTint (colorStr string ,tint float64 )string {var _dec ,_ffe ,_ega uint8 ;_gade ,_ :=_adg .Sscanf (colorStr ,"\u0025\u0030\u0032x\u0025\u0030\u0032\u0078\u0025\u0030\u0032\u0078",&_dec ,&_ffe ,&_ega );if _gade !=3{return "";};return _dceb (_dec ,tint )+_dceb (_ffe ,tint )+_dceb (_ega ,tint );};func _gfg (_ebcc ,_ffeb ,_bbbg float64 )float64 {if _ebcc *6< 1{return _bbbg +(_ffeb -_bbbg )*6*_ebcc ;}else if _ebcc *2< 1{return _ffeb ;}else if _ebcc *3< 2{return _bbbg +(_ffeb -_bbbg )*(2.0/3.0-_ebcc )*6;}else {return _bbbg ;};};func _agbd (_abf *_ac .ChartSpace ,_fade ,_ddg float64 ,_ebf *_fda .Theme ,_ddgc bool )(*_cb .Creator ,error ){_cef :=1.0;if _ddgc {_cef =8.0;};_fcd :=&Rectangle {};_dgf :=&Rectangle {Top :_fcd .Top ,Bottom :_ddg -_fcd .Bottom ,Left :_fcd .Left ,Right :_fade -_fcd .Right };_ffdd :=MakeTempCreator (_fade *_cef +1,_ddg *_cef +1);_fgf :=&creatorContext {_ddb :_ffdd ,_cgc :_ebf ,_bggg :_cef };var _agg bool ;if _ffg :=_abf .Chart ;_ffg !=nil {_bee :=_ffg .PlotArea ;if _bee ==nil {return nil ,_ae .New ("\u004e\u006f\u0020p\u006c\u006f\u0074\u0020\u0061\u0072\u0065\u0061");};_def :=&Rectangle {Top :_gde (10),Bottom :_dgf .Bottom -_gde (15),Left :_gde (10),Right :_dgf .Right -_gde (10)};var _edcb *Rectangle ;_fecc :=_ffg .Legend ;if _fecc !=nil {_dda :=_fecc .Overlay !=nil &&_fecc .Overlay .ValAttr !=nil &&*_fecc .Overlay .ValAttr ;if _gbc :=_fecc .LegendPos ;_gbc !=nil {switch _gbc .ValAttr {case _ac .ST_LegendPosTr :if !_dda {_def =&Rectangle {Top :_gde (25),Bottom :_dgf .Bottom -_gde (10),Left :_gde (10),Right :_dgf .Right -_gde (25)};};_edcb =&Rectangle {Top :_gde (2.5),Bottom :_gde (22.5),Left :_dgf .Right -_gde (22.5),Right :_dgf .Right -_gde (2.5)};case _ac .ST_LegendPosT :_edcb =&Rectangle {Top :_gde (2.5),Bottom :_gde (7.5),Left :(_dgf .Right -_dgf .Left )*0.25,Right :(_dgf .Right -_dgf .Left )*0.75};if !_dda {_def =&Rectangle {Top :_gde (12.5),Bottom :_dgf .Bottom -_gde (15),Left :_gde (10),Right :_dgf .Right -_gde (5)};};_agg =true ;case _ac .ST_LegendPosB :_edcb =&Rectangle {Top :_dgf .Bottom -_gde (7.5),Bottom :_dgf .Bottom -_gde (2.5),Left :(_dgf .Right -_dgf .Left )*0.25,Right :(_dgf .Right -_dgf .Left )*0.75};if !_dda {_def =&Rectangle {Top :_gde (5),Bottom :_dgf .Bottom -_gde (15),Left :_gde (10),Right :_dgf .Right -_gde (5)};};_agg =true ;case _ac .ST_LegendPosR :_edcb =&Rectangle {Top :(_dgf .Bottom -_dgf .Top )/2-_gde (10),Bottom :(_dgf .Bottom -_dgf .Top )/2+_gde (10),Left :_dgf .Right -_gde (22.5),Right :_dgf .Right -_gde (2.5)};if !_dda {_def =&Rectangle {Top :_gde (5),Bottom :_dgf .Bottom -_gde (12.5),Left :_gde (10),Right :_dgf .Right -_gde (25)};};case _ac .ST_LegendPosL :_edcb =&Rectangle {Top :(_dgf .Bottom -_dgf .Top )/2-_gde (10),Bottom :(_dgf .Bottom -_dgf .Top )/2+_gde (10),Left :_gde (2.5),Right :_gde (22.5)};if !_dda {_def =&Rectangle {Top :_gde (5),Bottom :_dgf .Bottom -_gde (12.5),Left :_gde (30),Right :_dgf .Right -_gde (5)};};default:_edcb =&Rectangle {Top :(_dgf .Bottom -_dgf .Top )/2-_gde (10),Bottom :(_dgf .Bottom -_dgf .Top )/2+_gde (10),Left :_dgf .Right -_gde (25),Right :_dgf .Right -_gde (5)};if !_dda {_def =&Rectangle {Top :_gde (5),Bottom :_dgf .Bottom -_gde (12.5),Left :_gde (100),Right :_dgf .Right -_gde (25)};};};};};_def .scale (_cef );_fgf .drawBorderWithProps (_bee .SpPr ,_def ,_acf );_gad :=[]*legendItem {};var _bfc error ;_bad :=_bee .CChoice ;for _ ,_afc :=range _bee .Choice {if _bba :=_afc .BarChart ;_bba !=nil {_gad ,_bfc =_fgf .drawBarChart (_bba ,_def ,_bad );if _bfc !=nil {return nil ,_bfc ;};};};if _fecc !=nil {_edcb .scale (_cef );_fgf .drawBorderWithProps (_fecc .SpPr ,_edcb ,_acf );if len (_gad )!=0{_fgf .drawLegend (_edcb ,_gad ,_agg );};};};_dgf .scale (_cef );_fgf .drawBorderWithProps (_abf .SpPr ,_dgf ,_acf );return _ffdd ,nil ;};func GetImage (c *_cb .Creator ,goImg _d .Image ,imgHeight ,imgWidth ,left ,top ,dividerX ,dividerY float64 ,part ImgPart )(*_cb .Image ,error ){if goImg ==nil {return nil ,nil ;};_bbfc :=goImg .Bounds ().Size ();_bdb :=_bbfc .X ;_gbcg :=_bbfc .Y ;if dividerX !=0{dividerX =dividerX /imgWidth *float64 (_bdb );};if dividerY !=0{dividerY =dividerY /imgHeight *float64 (_gbcg );};var _deef _d .Rectangle ;switch part {case ImgPart_t :_deef =_d .Rect (0,0,_bdb ,int (dividerY ));case ImgPart_b :_deef =_d .Rect (0,int (dividerY ),_bdb ,_gbcg );case ImgPart_l :_deef =_d .Rect (0,0,int (dividerX ),_gbcg );case ImgPart_r :_deef =_d .Rect (int (dividerX ),0,_bdb ,_gbcg );case ImgPart_lt :_deef =_d .Rect (0,0,int (dividerX ),int (dividerY ));case ImgPart_rt :_deef =_d .Rect (int (dividerX ),0,_bdb ,int (dividerY ));case ImgPart_lb :_deef =_d .Rect (0,int (dividerY ),int (dividerX ),_gbcg );case ImgPart_rb :_deef =_d .Rect (int (dividerX ),int (dividerY ),_bdb ,_gbcg );default:_deef =_d .Rect (0,0,_bdb ,_gbcg );};_cbeg :=CropImageByRect (goImg ,_deef );_cgbc ,_bgcd :=c .NewImageFromGoImage (_cbeg );if _bgcd !=nil {return nil ,_bgcd ;};_cgbc .Scale (imgWidth /float64 (_bdb ),imgHeight /float64 (_gbcg ));_cgbc .SetPos (left ,top );return _cgbc ,nil ;};var _eef =map[string ]FontStyle {"\u0052e\u0067\u0075\u006c\u0061\u0072":FontStyle_Regular ,"\u0042\u006f\u006c\u0064":FontStyle_Bold ,"\u0049\u0074\u0061\u006c\u0069\u0063":FontStyle_Italic ,"B\u006f\u006c\u0064\u0020\u0049\u0074\u0061\u006c\u0069\u0063":FontStyle_BoldItalic };type BorderPosition byte ;func GetDataFromXfrm (xfrm *_fda .CT_Transform2D )(float64 ,float64 ,float64 ,float64 ){var _afbd ,_cfde ,_dcdc ,_fdd float64 ;if _bce :=xfrm .Off ;_bce !=nil {_afbd =_b .FromEMU (FromSTCoordinate (_bce .XAttr ));_cfde =_b .FromEMU (FromSTCoordinate (_bce .YAttr ));};if _bagf :=xfrm .Ext ;_bagf !=nil {_dcdc =_b .FromEMU (_bagf .CxAttr );_fdd =_b .FromEMU (_bagf .CyAttr );};return _afbd ,_cfde ,_dcdc ,_fdd ;};func RegisterFont (name string ,style FontStyle ,font *_afb .PdfFont ){_dfgb ._add .Lock ();if _dfgb ._eccb [name ]==nil {_dfgb ._eccb [name ]=map[FontStyle ]*_afb .PdfFont {};};_dfgb ._eccb [name ][style ]=font ;_dfgb ._add .Unlock ();};func TwipsFromPoints (points float64 )float64 {return points /_b .Twips };func _gag (_efba string )error {if !_ge .HasSuffix (_efba ,"\u002e\u0074\u0074\u0066"){_ag .Log .Debug ("\u0055\u006es\u0075\u0070\u0070\u006f\u0072\u0074\u0065\u0064\u0020\u0066\u006f\u006e\u0074\u0020\u0066\u0069\u006c\u0065\u0020\u0066\u006f\u0072ma\u0074\u002e");return _adg .Errorf ("\u0055\u006e\u0073\u0075\u0070\u0070o\u0072\u0074\u0065\u0064\u0020f\u006f\u006e\u0074\u0020\u0066\u0069l\u0065\u0020\u0066\u006f\u0072m\u0061\u0074\u002c\u0020\u0063\u0075\u0072\u0072\u0065\u006e\u0074\u006cy\u0020\u006f\u006e\u006c\u0079\u0020\u0073\u0075\u0070\u0070\u006f\u0072\u0074\u0020\u0054T\u0046\u0020\u0066\u006f\u006e\u0074\u0020\u0066i\u006c\u0065\u002e");};_acdg ,_cfba :=_aef .ParseFile (_efba );if _cfba !=nil {_ag .Log .Debug ("\u0043a\u006e\u006e\u006f\u0074\u0020\u0070\u0061\u0072\u0073\u0065\u0020T\u0054\u0046\u0020\u0066\u0069\u006c\u0065\u0020\u0025\u0073",_cfba );return _cfba ;};_ecb ,_cfba :=_afb .NewCompositePdfFontFromTTFFile (_efba );if _cfba !=nil {return _cfba ;};_cec :=_acdg .GetNameRecords ();for _ ,_cae :=range _cec {_gcf :=_cae [1];if _gcf ==""{return _adg .Errorf ("\u004e\u006f\u0020\u0066\u006fn\u0074\u0020\u0066\u0061\u006d\u0069\u006c\u0079\u0020\u0069\u006e\u0066\u006fr\u006d\u0061\u0074\u0069\u006f\u006e\u0020\u0069\u006e\u0020\u0074\u0068\u0065\u0020\u0066\u0069\u006c\u0065\u0020\u0025\u0073",_efba );};_abfg :=make ([]byte ,0);for _eeda :=0;_eeda < len (_gcf );_eeda ++{if _gcf [_eeda ]==39||_gcf [_eeda ]==92{continue ;};_dfd :=4;if _eeda +_dfd < len (_gcf ){if _gcf [_eeda :_eeda +_dfd ]=="\u0000"{_eeda =_eeda +_dfd +1;continue ;};};_abfg =append (_abfg ,_gcf [_eeda ]);};_gcf =_ge .Replace (string (_abfg ),"\u0078\u0030\u0030","",-1);_dddb :=_cae [2];if _dddb ==""{return _adg .Errorf ("N\u006f\u0020\u0073\u0074\u0079\u006ce\u0020\u0069\u006e\u0066\u006f\u0072m\u0061\u0074\u0069\u006f\u006e\u0020\u0069n\u0020\u0074\u0068\u0065\u0020\u0066\u0069\u006c\u0065\u0020%\u0073",_efba );};_abfg =make ([]byte ,0);for _dbc :=0;_dbc < len (_dddb );_dbc ++{if _dddb [_dbc ]==39||_dddb [_dbc ]==92{continue ;};_dae :=4;if _dbc +_dae < len (_dddb ){if _dddb [_dbc :_dbc +_dae ]=="\u0000"{_dbc =_dbc +_dae +1;continue ;};};_abfg =append (_abfg ,_dddb [_dbc ]);};_dddb =_ge .Replace (string (_abfg ),"\u0078\u0030\u0030","",-1);RegisterFont (_gcf ,_eef [_dddb ],_ecb );};return nil ;};func AssignStdFontByName (style _cb .TextStyle ,fontName string )*_afb .PdfFont {_babd :=_afb .StdFontName (fontName );return _afb .NewStandard14FontMustCompile (_babd );};func (_agaae *creatorContext )drawBorderWithProps (_aebb *_fda .CT_ShapeProperties ,_bbeg *Rectangle ,_faf float64 ){if _bbeg !=nil &&_aebb !=nil &&_aebb .Ln !=nil &&_aebb .Ln .SolidFill !=nil {_fab :=_agaae .getPdfColorFromSolidFill (_aebb .Ln .SolidFill );DrawRectangle (_agaae ._ddb ,_bbeg ,_faf ,_fab );};};type serCategory struct{_fde string ;_eec []serValue ;};var _acd =_gde (1.5);func DrawRectangle (c *_cb .Creator ,r *Rectangle ,w float64 ,color _cb .Color ){if color ==nil {return ;};DrawLine (c ,r .Left ,r .Top ,r .Right ,r .Top ,w ,color );DrawLine (c ,r .Left ,r .Top ,r .Left ,r .Bottom ,w ,color );DrawLine (c ,r .Left ,r .Bottom ,r .Right ,r .Bottom ,w ,color );DrawLine (c ,r .Right ,r .Top ,r .Right ,r .Bottom ,w ,color );};var _dfgb =fontsMap {_add :&_af .Mutex {},_eccb :map[string ]map[FontStyle ]*_afb .PdfFont {}};func FromSTCoordinate32 (st _fda .ST_Coordinate32 )int64 {if _cgf :=st .ST_Coordinate32Unqualified ;_cgf !=nil {return int64 (*_cgf );};return 0;};func RegisterFontsFromFiles (files []string )error {for _ ,_bec :=range files {if _ge .HasSuffix (_bec ,"\u002e\u0074\u0074\u0066"){_bed :=_gag (_bec );if _bed !=nil {_ag .Log .Debug ("\u0075\u006ea\u0062\u006c\u0065\u0020\u0074o\u0020\u0070\u0072\u006f\u0063e\u0073\u0073\u0020\u0061\u006e\u0064\u0020\u0072\u0065\u0067\u0069\u0073\u0074\u0065\u0072\u0020\u0066\u006f\u006e\u0074\u0020\u0066\u0072\u006f\u006d\u0020\u0054\u0054\u0046\u0020\u0066\u0069\u006c\u0065\u0020\u0025\u0073",_bed );continue ;};};};return nil ;};func _bcag (_gef uint8 ,_ddge float64 )string {_bgc :=float64 (_gef );return _adg .Sprintf ("\u0025\u0030\u0032\u0078",int (_bgc *_ddge ));};func MakeTempCreator (width ,height float64 )*_cb .Creator {_gcef :=_cb .New ();_gcef .SetPageSize (_cb .PageSize {width ,height });_gcef .SetPageMargins (0,0,0,0);return _gcef ;};func _cfc (_baf ,_gbda ,_gfec float64 )(uint8 ,uint8 ,uint8 ){var _agaa float64 ;if _gfec < 0.5{_agaa =_gfec *(1+_gbda );}else {_agaa =_gfec +_gbda -_gfec *_gbda ;};_cbcc :=_gfec *2-_agaa ;_baf /=360.0;_feab :=_ggg (_baf +1.0/3.0);_gbdb :=_ggg (_baf );_bdgd :=_ggg (_baf -1.0/3.0);_dddc :=_gfg (_feab ,_agaa ,_cbcc );_bdfb :=_gfg (_gbdb ,_agaa ,_cbcc );_faac :=_gfg (_bdgd ,_agaa ,_cbcc );return uint8 (255*_dddc ),uint8 (255*_bdfb ),uint8 (255*_faac );};func DrawLine (c *_cb .Creator ,x0 ,y0 ,x1 ,y1 ,width float64 ,color _cb .Color ){if color ==nil {return ;};_gedf :=c .NewLine (x0 ,y0 ,x1 ,y1 );_gedf .SetLineWidth (width );_gedf .SetColor (color );c .Draw (_gedf );};type ImgPart byte ;type creatorContext struct{_ddb *_cb .Creator ;_cgc *_fda .Theme ;_bggg float64 ;};func _eae (_bacd ,_ace ,_fcba uint8 )(float64 ,float64 ,float64 ){_eaf ,_eafd ,_ccc :=float64 (_bacd )/255,float64 (_ace )/255,float64 (_fcba )/255;_agbdd :=_eaf ;if _eafd < _agbdd {_agbdd =_eafd ;};if _ccc < _agbdd {_agbdd =_ccc ;};var _adb ,_afdg bool ;_afe :=_eaf ;if _eafd > _afe {_afe =_eafd ;_adb =true ;};if _ccc > _afe {_afe =_ccc ;_adb =false ;_afdg =true ;};_aggf :=(_agbdd +_afe )/2;var _edf float64 ;if _agbdd !=_afe {if _aggf <=0.5{_edf =(_afe -_agbdd )/(_afe +_agbdd );}else {_edf =(_afe -_agbdd )/(2.0-_afe -_agbdd );};};var _dgd float64 ;if _agbdd !=_afe {if _adb {_dgd =2.0+(_ccc -_eaf )/(_afe -_agbdd );}else if _afdg {_dgd =4.0+(_eaf -_eafd )/(_afe -_agbdd );}else {_dgd =(_eafd -_ccc )/(_afe -_agbdd );};_dgd *=60;if _dgd < 0{_dgd +=360;};};return _dgd ,_edf ,_aggf ;};func _gce (_adaa *_ac .CT_DateAx )(uint32 ,_ac .ST_AxPos ,_ac .ST_TickMark ,_ac .ST_TickLblPos ,*_ac .CT_ChartLines ,uint32 ,*_fda .CT_ShapeProperties ,error ){var _dac ,_bbe uint32 ;var _dff _ac .ST_AxPos ;var _eed _ac .ST_TickMark ;var _ddee *_ac .CT_ChartLines ;var _cfbg _ac .ST_TickLblPos ;if _adaa .AxId ==nil {return _dac ,_dff ,_eed ,_cfbg ,_ddee ,_bbe ,_adaa .SpPr ,_ae .New ("\u004e\u006f\u0020x\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");}else {_dac =_adaa .AxId .ValAttr ;};if _adaa .AxPos ==nil {return _dac ,_dff ,_eed ,_cfbg ,_ddee ,_bbe ,_adaa .SpPr ,_ae .New ("\u004eo\u0020x\u0020\u0061\u0078\u0069\u0073 \u0070\u006fs\u0069\u0074\u0069\u006f\u006e");}else {_dff =_adaa .AxPos .ValAttr ;};if _adaa .MajorTickMark !=nil {_eed =_adaa .MajorTickMark .ValAttr ;};if _adaa .TickLblPos !=nil {_cfbg =_adaa .TickLblPos .ValAttr ;};if _adaa .CrossAx ==nil {return _dac ,_dff ,_eed ,_cfbg ,_ddee ,_bbe ,_adaa .SpPr ,_ae .New ("\u004e\u006f \u0063\u0072\u006fs\u0073\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");}else {_bbe =_adaa .CrossAx .ValAttr ;};_ddee =_adaa .MajorGridlines ;return _dac ,_dff ,_eed ,_cfbg ,_ddee ,_bbe ,_adaa .SpPr ,nil ;};type serValue struct{_fed string ;_fbag float64 ;_fbdf *_fda .CT_ShapeProperties ;};const _bfce =6.0;type Rectangle struct{Top float64 ;Bottom float64 ;Left float64 ;Right float64 ;};func (_adbf *Rectangle )Translate (x ,y float64 ){_adbf .Left +=x ;_adbf .Right +=x ;_adbf .Top +=y ;_adbf .Bottom +=y ;};const (BorderPositionTop BorderPosition =0;BorderPositionLeft BorderPosition =1;BorderPositionBottom BorderPosition =2;BorderPositionRight BorderPosition =3;);type fontsMap struct{_add *_af .Mutex ;_eccb map[string ]map[FontStyle ]*_afb .PdfFont ;};func _fbdc (_cfea *_ac .CT_CatAx )(uint32 ,_ac .ST_AxPos ,_ac .ST_TickMark ,_ac .ST_TickLblPos ,*_ac .CT_ChartLines ,uint32 ,*_fda .CT_ShapeProperties ,error ){var _bcc ,_dcd uint32 ;var _ead _ac .ST_AxPos ;var _bge _ac .ST_TickMark ;var _aaf *_ac .CT_ChartLines ;var _begb _ac .ST_TickLblPos ;if _cfea .AxId ==nil {return _bcc ,_ead ,_bge ,_begb ,_aaf ,_dcd ,_cfea .SpPr ,_ae .New ("\u004e\u006f\u0020x\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");}else {_bcc =_cfea .AxId .ValAttr ;};if _cfea .AxPos ==nil {return _bcc ,_ead ,_bge ,_begb ,_aaf ,_dcd ,_cfea .SpPr ,_ae .New ("\u004eo\u0020x\u0020\u0061\u0078\u0069\u0073 \u0070\u006fs\u0069\u0074\u0069\u006f\u006e");}else {_ead =_cfea .AxPos .ValAttr ;};if _cfea .MajorTickMark !=nil {_bge =_cfea .MajorTickMark .ValAttr ;};if _cfea .TickLblPos !=nil {_begb =_cfea .TickLblPos .ValAttr ;};if _cfea .CrossAx ==nil {return _bcc ,_ead ,_bge ,_begb ,_aaf ,_dcd ,_cfea .SpPr ,_ae .New ("\u004e\u006f \u0063\u0072\u006fs\u0073\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");}else {_dcd =_cfea .CrossAx .ValAttr ;};_aaf =_cfea .MajorGridlines ;return _bcc ,_ead ,_bge ,_begb ,_aaf ,_dcd ,_cfea .SpPr ,nil ;};func RegisterFontsFromDirectory (dirName string )error {_faed ,_gac :=_c .Open (dirName );if _gac !=nil {return _gac ;};defer _faed .Close ();_bff ,_gac :=_faed .Readdirnames (0);if _gac !=nil {return _gac ;};for _ ,_agbf :=range _bff {if _ge .HasSuffix (_agbf ,"\u002e\u0074\u0074\u0066"){_eedg :=dirName +"\u002f"+_agbf ;_aaee :=_gag (_eedg );if _aaee !=nil {_ag .Log .Debug ("\u0075\u006ea\u0062\u006c\u0065\u0020\u0074o\u0020\u0070\u0072\u006f\u0063e\u0073\u0073\u0020\u0061\u006e\u0064\u0020\u0072\u0065\u0067\u0069\u0073\u0074\u0065\u0072\u0020\u0066\u006f\u006e\u0074\u0020\u0066\u0072\u006f\u006d\u0020\u0054\u0054\u0046\u0020\u0066\u0069\u006c\u0065\u0020\u0025\u0073",_aaee );continue ;};};};return nil ;};func (_cbbgd barSerByOrder )Len ()int {return len (_cbbgd )};func AdjustColorByShade (colorStr string ,shade float64 )string {var _abb ,_aebf ,_daa uint8 ;_dab ,_ :=_adg .Sscanf (colorStr ,"\u0025\u0030\u0032x\u0025\u0030\u0032\u0078\u0025\u0030\u0032\u0078",&_abb ,&_aebf ,&_daa );if _dab !=3{return "";};return _bcag (_abb ,shade )+_bcag (_aebf ,shade )+_bcag (_daa ,shade );};func FromSTPercentage (st *_fda .ST_Percentage )float64 {if _egeg :=st .ST_PercentageDecimal ;_egeg !=nil {return float64 (*_egeg )/100000;};return 0;};type legendItem struct{_ccd string ;_fffb *_fda .CT_ShapeProperties ;};var _acf =_gde (0.125);func _gde (_deb float64 )float64 {return _deb *_b .Millimeter };func PointsFromTwips (twips int64 )float64 {return float64 (int64 (float64 (twips )*_b .Twips *10+0.5))/10};func (_cdfa *creatorContext )drawLineWithProps (_bdfba *_fda .CT_ShapeProperties ,_ggd ,_ege ,_ecf ,_dfed float64 ,_bbea bool ){if _bdfba !=nil {if _fbee :=_bdfba .Ln ;_fbee !=nil {_gge :=_cdfa .getPdfColorFromSolidFill (_fbee .SolidFill );if _gge ==nil &&_bbea {_gge =_cb .ColorBlack ;};if _gge !=nil {var _cga float64 ;if _ddc :=_fbee .WAttr ;_ddc !=nil {_cga =_b .FromEMU (int64 (*_ddc ));}else {_cga =_acf ;};DrawLine (_cdfa ._ddb ,_ggd ,_ege ,_ecf ,_dfed ,_cga ,_gge );};};};};func _gdc (_daf *_ac .CT_SerAx )(uint32 ,_ac .ST_AxPos ,_ac .ST_TickMark ,_ac .ST_TickLblPos ,*_ac .CT_ChartLines ,uint32 ,*_fda .CT_ShapeProperties ,error ){var _cdc ,_ecg uint32 ;var _eda _ac .ST_AxPos ;var _abc _ac .ST_TickMark ;var _bdcf *_ac .CT_ChartLines ;var _egdb _ac .ST_TickLblPos ;if _daf .AxId ==nil {return _cdc ,_eda ,_abc ,_egdb ,_bdcf ,_ecg ,_daf .SpPr ,_ae .New ("\u004e\u006f\u0020x\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");}else {_cdc =_daf .AxId .ValAttr ;};if _daf .AxPos ==nil {return _cdc ,_eda ,_abc ,_egdb ,_bdcf ,_ecg ,_daf .SpPr ,_ae .New ("\u004eo\u0020x\u0020\u0061\u0078\u0069\u0073 \u0070\u006fs\u0069\u0074\u0069\u006f\u006e");}else {_eda =_daf .AxPos .ValAttr ;};if _daf .MajorTickMark !=nil {_abc =_daf .MajorTickMark .ValAttr ;};if _daf .TickLblPos !=nil {_egdb =_daf .TickLblPos .ValAttr ;};if _daf .CrossAx ==nil {return _cdc ,_eda ,_abc ,_egdb ,_bdcf ,_ecg ,_daf .SpPr ,_ae .New ("\u004e\u006f \u0063\u0072\u006fs\u0073\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");}else {_ecg =_daf .CrossAx .ValAttr ;};_bdcf =_daf .MajorGridlines ;return _cdc ,_eda ,_abc ,_egdb ,_bdcf ,_ecg ,_daf .SpPr ,nil ;};var _egd =_gde (1.5);func GetPageFromCreator (c *_cb .Creator )(*_afb .PdfPage ,error ){_gggd :=_ad .NewBuffer ([]byte {});_fcc :=c .Write (_gggd );if _fcc !=nil {return nil ,_fcc ;};_ddab :=_ad .NewReader (_gggd .Bytes ());_bbdd ,_fcc :=_afb .NewPdfReader (_ddab );if _fcc !=nil {return nil ,_fcc ;};return _bbdd .GetPage (1);};func MakeBlockFromCreator (c *_cb .Creator )(*_cb .Block ,error ){_abae ,_cdbf :=GetPageFromCreator (c );if _cdbf !=nil {return nil ,_cdbf ;};_accb ,_cdbf :=_cb .NewBlockFromPage (_abae );if _cdbf !=nil {return nil ,_cdbf ;};return _accb ,nil ;};type barSerByOrder []*_ac .CT_BarSer ;func (_eeb *creatorContext )drawAxes (_bde *_ac .CT_PlotAreaChoice1 ,_bcdf ,_fbde ,_bef float64 ,_fcg []string ,_fggb *Rectangle ,_bca bool )error {_bfd :=_eeb ._ddb ;_cbe :=_eeb ._bggg ;if _bde ==nil {return _ae .New ("\u004e\u006f\u0020\u0061xi\u0073\u0020\u0069\u006e\u0066\u006f\u0072\u006d\u0061\u0074\u0069\u006f\u006e");};if len (_bde .ValAx )==0||(len (_bde .CatAx )==0&&len (_bde .DateAx )==0&&len (_bde .SerAx )==0){return _ae .New ("\u004e\u006f\u0020\u0078\u0020\u006f\u0072\u0020\u0079 \u0061\u0078\u0069\u0073");};var _fffd ,_cge ,_fdc ,_bac uint32 ;var _dfb ,_efdd _ac .ST_AxPos ;var _cege ,_baga _ac .ST_TickMark ;var _ddga ,_fgc *_ac .CT_ChartLines ;var _ebe ,_effc _ac .ST_TickLblPos ;var _cbba ,_fac *_fda .CT_ShapeProperties ;var _gfe error ;_dfad :=_fggb .Right -_fggb .Left ;_aad :=_fggb .Bottom -_fggb .Top ;if len (_bde .ValAx )> 0{_cge ,_efdd ,_baga ,_effc ,_fgc ,_bac ,_fac ,_gfe =_dded (_bde .ValAx [0]);};if _efdd !=_ac .ST_AxPosL &&_efdd !=_ac .ST_AxPosB {return _ae .New ("\u004f\u006e\u006c\u0079\u0020l\u0065\u0066\u0074\u0020\u006f\u0072\u0020\u0062\u006f\u0074\u0074\u006f\u006d \u0079\u0020\u0061\u0078\u0069\u0073\u0020\u0073\u0075\u0070\u0070\u006f\u0072\u0074\u0020\u0073\u006f\u0020\u0066\u0061\u0072");};_ffa :=_fbde -_bcdf ;_ffab :=int (_ffa /_bef )+1;var _ebfd ,_eecb float64 ;switch _baga {case _ac .ST_TickMarkIn :_ebfd ,_eecb =_gfb ,0;case _ac .ST_TickMarkOut :_ebfd ,_eecb =0,_gfb ;case _ac .ST_TickMarkCross :_ebfd ,_eecb =_gfb ,_gfb ;};_ebfd =_ebfd *_cbe ;_eecb =_eecb *_cbe ;var _afd *_fda .CT_ShapeProperties ;if _fgc !=nil {_afd =_fgc .SpPr ;};_aeb ,_cfb :=_ebe !=_ac .ST_TickLblPosNone ,_effc !=_ac .ST_TickLblPosNone ;_dea :=_bcdf ;if len (_bde .CatAx )> 0{_fffd ,_dfb ,_cege ,_ebe ,_ddga ,_fdc ,_cbba ,_gfe =_fbdc (_bde .CatAx [0]);}else if len (_bde .DateAx )> 0{_fffd ,_dfb ,_cege ,_ebe ,_ddga ,_fdc ,_cbba ,_gfe =_gce (_bde .DateAx [0]);}else if len (_bde .SerAx )> 0{_fffd ,_dfb ,_cege ,_ebe ,_ddga ,_fdc ,_cbba ,_gfe =_gdc (_bde .SerAx [0]);};if _gfe !=nil {return _gfe ;};if _dfb !=_ac .ST_AxPosL &&_dfb !=_ac .ST_AxPosB {return _ae .New ("\u004f\u006e\u006c\u0079\u0020l\u0065\u0066\u0074\u0020\u006f\u0072\u0020\u0062\u006f\u0074\u0074\u006f\u006d \u0078\u0020\u0061\u0078\u0069\u0073\u0020\u0073\u0075\u0070\u0070\u006f\u0072\u0074\u0020\u0073\u006f\u0020\u0066\u0061\u0072");};if _fffd !=_bac ||_cge !=_fdc {return _ae .New ("a\u0078i\u0073\u0020\u0069\u0064\u0073\u0020\u0064\u006fn\u0027\u0074\u0020\u006dat\u0063\u0068");};_ddd :=len (_fcg )+1;var _faa ,_gebd float64 ;switch _cege {case _ac .ST_TickMarkIn :_faa ,_gebd =_gfb ,0;case _ac .ST_TickMarkOut :_faa ,_gebd =0,_gfb ;case _ac .ST_TickMarkCross :_faa ,_gebd =_gfb ,_gfb ;};_faa =_faa *_cbe ;_gebd =_gebd *_cbe ;var _dcg *_fda .CT_ShapeProperties ;if _ddga !=nil {_dcg =_ddga .SpPr ;};if _bca {_efe :=_aad /float64 (len (_fcg ));_bbfd :=_fggb .Left -_bcdf *_dfad /_ffa ;_agc :=_bbfd -_dag *_cbe ;if _aeb {var _fada float64 ;for _ddf :=0;_ddf < _ddd ;_ddf ++{_bbfg :=_fggb .Bottom -float64 (_ddf )*_efe ;if _ddf < _ddd -1{_eeg :=_bfd .NewParagraph (_fcg [_ddf ]);_eeg .SetFontSize (_bfce *_cbe );_eeg .SetPos (_agc ,_bbfg -_efe /2-_acd *_cbe );_bfd .Draw (_eeg );_fggc :=(_eeg .Width ()/1000-_dag )*_cbe ;if _fggc > 0&&_fggc > _fada {_fada =_fggc ;};};};if _fada > 0{_fggb .Left +=_fada +_dga ;_bbfd =_fggb .Left -_bcdf *_dfad /_ffa ;_dfad =_fggb .Right -_fggb .Left ;};};_cdfd :=_bbfd -_gebd ;_eab :=_bbfd +_faa ;_bdg :=_fggb .Left ;_adaf :=_fggb .Right ;for _cbc :=0;_cbc < _ddd ;_cbc ++{_defa :=_fggb .Bottom -float64 (_cbc )*_efe ;_eeb .drawLineWithProps (_cbba ,_cdfd ,_defa ,_eab ,_defa ,true );_eeb .drawLineWithProps (_dcg ,_bdg ,_defa ,_adaf ,_defa ,true );};_bgfa :=_dfad /_ffa ;_gdd :=_fggb .Bottom -_ebfd ;_affb :=_fggb .Bottom +_eecb ;_dbf :=_fggb .Top ;_feac :=_fggb .Bottom ;for _cfd :=0;_cfd < _ffab ;_cfd ++{_eee :=_fggb .Left +(_dea -_bcdf )*_bgfa ;_eeb .drawLineWithProps (_fac ,_eee ,_gdd ,_eee ,_affb ,true );_eeb .drawLineWithProps (_afd ,_eee ,_dbf ,_eee ,_feac ,true );if _cfb {_cfe :=_bfd .NewParagraph (_e .FormatFloat (_dea ,'g',-1,64));_cfe .SetFontSize (_bfce *_cbe );_cfe .SetPos (_eee -_fga *_cbe ,_feac +_egd *_cbe );_bfd .Draw (_cfe );};_dea +=_bef ;};}else {_gg :=_aad /_ffa ;_bdcd :=_fggb .Left ;if _cfb {var _acgc float64 ;for _caa :=0;_caa < _ffab ;_caa ++{_cfa :=_fggb .Bottom -(_dea -_bcdf )*_gg ;_dde :=_bfd .NewParagraph (_e .FormatFloat (_dea ,'g',-1,64));_dde .SetFontSize (_bfce *_cbe );_dde .SetPos (_bdcd -_dag *_cbe ,_cfa -_acd *_cbe );_bfd .Draw (_dde );_gba :=(_dde .Width ()/1000-_dag )*_cbe ;if _gba > 0&&_gba > _acgc {_acgc =_gba ;};_dea +=_bef ;};if _acgc > 0{_fggb .Left +=_acgc +_dga ;_dfad =_fggb .Right -_fggb .Left ;};};_dea =_bcdf ;_bbb :=_fggb .Left -_eecb ;_bbd :=_fggb .Left +_ebfd ;_bdcd =_fggb .Left ;_gab :=_fggb .Right ;for _ccgf :=0;_ccgf < _ffab ;_ccgf ++{_aga :=_fggb .Bottom -(_dea -_bcdf )*_gg ;_eeb .drawLineWithProps (_fac ,_bbb ,_aga ,_bbd ,_aga ,true );_eeb .drawLineWithProps (_afd ,_bdcd ,_aga ,_gab ,_aga ,true );_dea +=_bef ;};_baeb :=_dfad /float64 (len (_fcg ));_bcg :=_fggb .Bottom +_bcdf *_aad /_ffa ;_cfab :=_bcg -_faa ;_gabe :=_bcg +_gebd ;_dagc :=_fggb .Top ;_bbc :=_fggb .Bottom ;_dcac :=_bcg +_egd *_cbe ;for _ded :=0;_ded < _ddd ;_ded ++{_eabg :=_fggb .Left +float64 (_ded )*_baeb ;_eeb .drawLineWithProps (_cbba ,_eabg ,_cfab ,_eabg ,_gabe ,true );_eeb .drawLineWithProps (_dcg ,_eabg ,_dagc ,_eabg ,_bbc ,true );if _aeb &&_ded < _ddd -1{_ede :=_bfd .NewParagraph (_fcg [_ded ]);_ede .SetFontSize (_bfce *_cbe );_ede .SetPos (_eabg +_aedg *_cbe ,_dcac );_bfd .Draw (_ede );};};};return nil ;};func _ggg (_effg float64 )float64 {if _effg < 0{_effg +=float64 (-int (_effg )+1);}else if _effg > 1{_effg -=float64 (int (_effg ));};return _effg ;};func GetColorStringFromDmlColor (dmlColor *_fda .CT_Color )string {var _ffbb string ;if _dgae :=dmlColor .SrgbClr ;_dgae !=nil {_ffbb =_dgae .ValAttr ;}else if _bda :=dmlColor .SysClr ;_bda !=nil {return "\u0030\u0030\u0030\u0030\u0030\u0030";};return _ffbb ;};func FromSTCoordinate (st _fda .ST_Coordinate )int64 {if _cgg :=st .ST_CoordinateUnqualified ;_cgg !=nil {return *_cgg ;};return 0;};func _fgb (_bbcg _fda .ST_SchemeColorVal ,_gdb *_fda .Theme )string {if _fce :=_gdb .ThemeElements ;_fce !=nil {if _bbde :=_fce .ClrScheme ;_bbde !=nil {switch _bbcg {case _fda .ST_SchemeColorValLt1 :return GetColorStringFromDmlColor (_bbde .Lt1 );case _fda .ST_SchemeColorValDk1 ,_fda .ST_SchemeColorValTx1 :return GetColorStringFromDmlColor (_bbde .Dk1 );case _fda .ST_SchemeColorValLt2 :return GetColorStringFromDmlColor (_bbde .Lt2 );case _fda .ST_SchemeColorValDk2 :return GetColorStringFromDmlColor (_bbde .Dk2 );case _fda .ST_SchemeColorValAccent1 :return GetColorStringFromDmlColor (_bbde .Accent1 );case _fda .ST_SchemeColorValAccent2 :return GetColorStringFromDmlColor (_bbde .Accent2 );case _fda .ST_SchemeColorValAccent3 :return GetColorStringFromDmlColor (_bbde .Accent3 );case _fda .ST_SchemeColorValAccent4 :return GetColorStringFromDmlColor (_bbde .Accent4 );case _fda .ST_SchemeColorValAccent5 :return GetColorStringFromDmlColor (_bbde .Accent5 );case _fda .ST_SchemeColorValAccent6 :return GetColorStringFromDmlColor (_bbde .Accent6 );};};};return "";};var _dga =_gde (2);func (_bgg barSerByOrder )Swap (i ,j int ){_bgg [i ],_bgg [j ]=_bgg [j ],_bgg [i ]};const DefaultFontSize =12.0;