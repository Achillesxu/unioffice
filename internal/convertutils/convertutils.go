//
// Copyright 2020 FoxyUtils ehf. All rights reserved.
//
// This is a commercial product and requires a license to operate.
// A trial license can be obtained at https://unidoc.io
//
// DO NOT EDIT: generated by unitwist Go source code obfuscator.
//
// Use of this source code is governed by the UniDoc End User License Agreement
// terms that can be accessed at https://unidoc.io/eula/

package convertutils ;import (_b "bytes";_f "errors";_e "fmt";_ac "github.com/unidoc/unioffice/measurement";_d "github.com/unidoc/unioffice/schema/soo/dml";_da "github.com/unidoc/unioffice/schema/soo/dml/chart";_aab "github.com/unidoc/unioffice/spreadsheet/format";_aa "github.com/unidoc/unipdf/v3/creator";_fe "github.com/unidoc/unipdf/v3/model";_gd "github.com/unidoc/unipdf/v3/render";_ce "github.com/unidoc/unitype";_gb "image";_g "log";_cgdc "math";_cc "os";_cgd "sort";_cg "strconv";_a "strings";_gc "sync";_bc "unicode";);func _ccd (_cbc ,_abc ,_fae uint8 )(float64 ,float64 ,float64 ){_gac ,_dce ,_agaa :=float64 (_cbc )/255,float64 (_abc )/255,float64 (_fae )/255;_ebcc :=_gac ;if _dce < _ebcc {_ebcc =_dce ;};if _agaa < _ebcc {_ebcc =_agaa ;};var _ccbb ,_cfbbe bool ;_fgbc :=_gac ;if _dce > _fgbc {_fgbc =_dce ;_ccbb =true ;};if _agaa > _fgbc {_fgbc =_agaa ;_ccbb =false ;_cfbbe =true ;};_bede :=(_ebcc +_fgbc )/2;var _aabc float64 ;if _ebcc !=_fgbc {if _bede <=0.5{_aabc =(_fgbc -_ebcc )/(_fgbc +_ebcc );}else {_aabc =(_fgbc -_ebcc )/(2.0-_fgbc -_ebcc );};};var _bdcb float64 ;if _ebcc !=_fgbc {if _ccbb {_bdcb =2.0+(_agaa -_gac )/(_fgbc -_ebcc );}else if _cfbbe {_bdcb =4.0+(_gac -_dce )/(_fgbc -_ebcc );}else {_bdcb =(_dce -_agaa )/(_fgbc -_ebcc );};_bdcb *=60;if _bdcb < 0{_bdcb +=360;};};return _bdcb ,_aabc ,_bede ;};const _acf =6.0;func _ffgb (_abef uint8 ,_aac float64 )string {_fbfg :=float64 (_abef );return _e .Sprintf ("\u0025\u0030\u0032\u0078",int (_fbfg *_aac ));};func _edeb (_adde *_da .CT_CatAx )(uint32 ,_da .ST_AxPos ,_da .ST_TickMark ,_da .ST_TickLblPos ,*_da .CT_ChartLines ,uint32 ,*_d .CT_ShapeProperties ,error ){var _dfc ,_gfdf uint32 ;var _afad _da .ST_AxPos ;var _daa _da .ST_TickMark ;var _fccc *_da .CT_ChartLines ;var _bedg _da .ST_TickLblPos ;if _adde .AxId ==nil {return _dfc ,_afad ,_daa ,_bedg ,_fccc ,_gfdf ,_adde .SpPr ,_f .New ("\u004e\u006f\u0020x\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");}else {_dfc =_adde .AxId .ValAttr ;};if _adde .AxPos ==nil {return _dfc ,_afad ,_daa ,_bedg ,_fccc ,_gfdf ,_adde .SpPr ,_f .New ("\u004eo\u0020x\u0020\u0061\u0078\u0069\u0073 \u0070\u006fs\u0069\u0074\u0069\u006f\u006e");}else {_afad =_adde .AxPos .ValAttr ;};if _adde .MajorTickMark !=nil {_daa =_adde .MajorTickMark .ValAttr ;};if _adde .TickLblPos !=nil {_bedg =_adde .TickLblPos .ValAttr ;};if _adde .CrossAx ==nil {return _dfc ,_afad ,_daa ,_bedg ,_fccc ,_gfdf ,_adde .SpPr ,_f .New ("\u004e\u006f \u0063\u0072\u006fs\u0073\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");}else {_gfdf =_adde .CrossAx .ValAttr ;};_fccc =_adde .MajorGridlines ;return _dfc ,_afad ,_daa ,_bedg ,_fccc ,_gfdf ,_adde .SpPr ,nil ;};var _bbf =_bcg (7.5);func (_cafd *Rectangle )scale (_cdd float64 ){_cafd .Top *=_cdd ;_cafd .Bottom *=_cdd ;_cafd .Left *=_cdd ;_cafd .Right *=_cdd ;};const (ImgPart_whole ImgPart =0;ImgPart_t ImgPart =1;ImgPart_b ImgPart =2;ImgPart_l ImgPart =3;ImgPart_r ImgPart =4;ImgPart_lt ImgPart =5;ImgPart_rt ImgPart =6;ImgPart_lb ImgPart =7;ImgPart_rb ImgPart =8;);type legendItem struct{_feec string ;_efb *_d .CT_ShapeProperties ;};func TwipsFromPoints (points float64 )float64 {return points /_ac .Twips };func _bdb (_dcd *_da .ChartSpace ,_bgab ,_aage float64 ,_bda *_d .Theme ,_ffa bool )(*_aa .Creator ,error ){_afa :=1.0;if _ffa {_afa =8.0;};_gfc :=&Rectangle {};_ebc :=&Rectangle {Top :_gfc .Top ,Bottom :_aage -_gfc .Bottom ,Left :_gfc .Left ,Right :_bgab -_gfc .Right };_dec :=MakeTempCreator (_bgab *_afa +1,_aage *_afa +1);_bed :=&creatorContext {_geb :_dec ,_cebg :_bda ,_deaa :_afa };var _fdfd bool ;if _faad :=_dcd .Chart ;_faad !=nil {_bdad :=_faad .PlotArea ;if _bdad ==nil {return nil ,_f .New ("\u004e\u006f\u0020p\u006c\u006f\u0074\u0020\u0061\u0072\u0065\u0061");};_acg :=&Rectangle {Top :_bcg (10),Bottom :_ebc .Bottom -_bcg (15),Left :_bcg (10),Right :_ebc .Right -_bcg (10)};var _agd *Rectangle ;_dbdg :=_faad .Legend ;if _dbdg !=nil {_gae :=_dbdg .Overlay !=nil &&_dbdg .Overlay .ValAttr !=nil &&*_dbdg .Overlay .ValAttr ;if _cdfe :=_dbdg .LegendPos ;_cdfe !=nil {switch _cdfe .ValAttr {case _da .ST_LegendPosTr :if !_gae {_acg =&Rectangle {Top :_bcg (25),Bottom :_ebc .Bottom -_bcg (10),Left :_bcg (10),Right :_ebc .Right -_bcg (25)};};_agd =&Rectangle {Top :_bcg (2.5),Bottom :_bcg (22.5),Left :_ebc .Right -_bcg (22.5),Right :_ebc .Right -_bcg (2.5)};case _da .ST_LegendPosT :_agd =&Rectangle {Top :_bcg (2.5),Bottom :_bcg (7.5),Left :(_ebc .Right -_ebc .Left )*0.25,Right :(_ebc .Right -_ebc .Left )*0.75};if !_gae {_acg =&Rectangle {Top :_bcg (12.5),Bottom :_ebc .Bottom -_bcg (15),Left :_bcg (10),Right :_ebc .Right -_bcg (5)};};_fdfd =true ;case _da .ST_LegendPosB :_agd =&Rectangle {Top :_ebc .Bottom -_bcg (7.5),Bottom :_ebc .Bottom -_bcg (2.5),Left :(_ebc .Right -_ebc .Left )*0.25,Right :(_ebc .Right -_ebc .Left )*0.75};if !_gae {_acg =&Rectangle {Top :_bcg (5),Bottom :_ebc .Bottom -_bcg (15),Left :_bcg (10),Right :_ebc .Right -_bcg (5)};};_fdfd =true ;case _da .ST_LegendPosR :_agd =&Rectangle {Top :(_ebc .Bottom -_ebc .Top )/2-_bcg (10),Bottom :(_ebc .Bottom -_ebc .Top )/2+_bcg (10),Left :_ebc .Right -_bcg (22.5),Right :_ebc .Right -_bcg (2.5)};if !_gae {_acg =&Rectangle {Top :_bcg (5),Bottom :_ebc .Bottom -_bcg (12.5),Left :_bcg (10),Right :_ebc .Right -_bcg (25)};};case _da .ST_LegendPosL :_agd =&Rectangle {Top :(_ebc .Bottom -_ebc .Top )/2-_bcg (10),Bottom :(_ebc .Bottom -_ebc .Top )/2+_bcg (10),Left :_bcg (2.5),Right :_bcg (22.5)};if !_gae {_acg =&Rectangle {Top :_bcg (5),Bottom :_ebc .Bottom -_bcg (12.5),Left :_bcg (30),Right :_ebc .Right -_bcg (5)};};default:_agd =&Rectangle {Top :(_ebc .Bottom -_ebc .Top )/2-_bcg (10),Bottom :(_ebc .Bottom -_ebc .Top )/2+_bcg (10),Left :_ebc .Right -_bcg (25),Right :_ebc .Right -_bcg (5)};if !_gae {_acg =&Rectangle {Top :_bcg (5),Bottom :_ebc .Bottom -_bcg (12.5),Left :_bcg (100),Right :_ebc .Right -_bcg (25)};};};};};_acg .scale (_afa );_bed .drawBorderWithProps (_bdad .SpPr ,_acg ,_bga );_gbg :=[]*legendItem {};var _gfg error ;_def :=_bdad .CChoice ;for _ ,_ggg :=range _bdad .Choice {if _fgg :=_ggg .BarChart ;_fgg !=nil {_gbg ,_gfg =_bed .drawBarChart (_fgg ,_acg ,_def );if _gfg !=nil {return nil ,_gfg ;};};};if _dbdg !=nil {_agd .scale (_afa );_bed .drawBorderWithProps (_dbdg .SpPr ,_agd ,_bga );if len (_gbg )!=0{_bed .drawLegend (_agd ,_gbg ,_fdfd );};};};_ebc .scale (_afa );_bed .drawBorderWithProps (_dcd .SpPr ,_ebc ,_bga );return _dec ,nil ;};func PointsFromTwips (twips int64 )float64 {return float64 (int64 (float64 (twips )*_ac .Twips *10+0.5))/10;};var _fba =_bcg (1);func AdjustColor (colorStr string ,EG_ColorTransform []*_d .EG_ColorTransform )string {for _ ,_bdg :=range EG_ColorTransform {if _deed :=_bdg .Tint ;_deed !=nil {if _dba :=_deed .ValAttr .ST_PositiveFixedPercentageDecimal ;_dba !=nil {colorStr =AdjustColorByTint (colorStr ,float64 (*_dba )/100000);};};if _ece :=_bdg .Shade ;_ece !=nil {if _bdf :=_ece .ValAttr .ST_PositiveFixedPercentageDecimal ;_bdf !=nil {colorStr =AdjustColorByShade (colorStr ,float64 (*_bdf )/100000);};};if _edgc :=_bdg .LumMod ;_edgc !=nil {if _degf :=_edgc .ValAttr .ST_PercentageDecimal ;_degf !=nil {colorStr =AdjustColorByLumMod (colorStr ,float64 (*_degf )/100000);};};};return colorStr ;};func _feb (_acba uint8 ,_ebec float64 )string {_cea :=float64 (_acba );var _ccfc float64 ;if _ebec < 0{_ccfc =_cea *(1+_ebec );}else {_ccfc =_cea +(255-_cea )*_ebec ;};return _e .Sprintf ("\u0025\u0030\u0032\u0078",int (_ccfc ));};func _bcg (_dbf float64 )float64 {return _dbf *_ac .Millimeter };var _ged =_bcg (1.5);func (_fdc barSerByOrder )Len ()int {return len (_fdc )};func FromSTCoordinate (st _d .ST_Coordinate )int64 {if _afbb :=st .ST_CoordinateUnqualified ;_afbb !=nil {return *_afbb ;};return 0;};func _bfea (_eefa _d .ST_SchemeColorVal ,_cgc *_d .Theme )string {if _dag :=_cgc .ThemeElements ;_dag !=nil {if _bbg :=_dag .ClrScheme ;_bbg !=nil {switch _eefa {case _d .ST_SchemeColorValLt1 :return GetColorStringFromDmlColor (_bbg .Lt1 );case _d .ST_SchemeColorValDk1 ,_d .ST_SchemeColorValTx1 :return GetColorStringFromDmlColor (_bbg .Dk1 );case _d .ST_SchemeColorValLt2 :return GetColorStringFromDmlColor (_bbg .Lt2 );case _d .ST_SchemeColorValDk2 :return GetColorStringFromDmlColor (_bbg .Dk2 );case _d .ST_SchemeColorValAccent1 :return GetColorStringFromDmlColor (_bbg .Accent1 );case _d .ST_SchemeColorValAccent2 :return GetColorStringFromDmlColor (_bbg .Accent2 );case _d .ST_SchemeColorValAccent3 :return GetColorStringFromDmlColor (_bbg .Accent3 );case _d .ST_SchemeColorValAccent4 :return GetColorStringFromDmlColor (_bbg .Accent4 );case _d .ST_SchemeColorValAccent5 :return GetColorStringFromDmlColor (_bbg .Accent5 );case _d .ST_SchemeColorValAccent6 :return GetColorStringFromDmlColor (_bbg .Accent6 );};};};return "";};func AssignStdFontByName (style _aa .TextStyle ,fontName string )*_fe .PdfFont {_dgebe :=_fe .StdFontName (fontName );return _fe .NewStandard14FontMustCompile (_dgebe );};type fontsMap struct{_dbc *_gc .Mutex ;_abaa map[string ]map[FontStyle ]*_fe .PdfFont ;};func MakeBlockFromCreator (c *_aa .Creator )(*_aa .Block ,error ){_fbd ,_dab :=GetPageFromCreator (c );if _dab !=nil {return nil ,_dab ;};_acec ,_dab :=_aa .NewBlockFromPage (_fbd );if _dab !=nil {return nil ,_dab ;};return _acec ,nil ;};var _dgb =_bcg (0.5);func (_gbdb *creatorContext )drawLineWithProps (_ggf *_d .CT_ShapeProperties ,_age ,_gcgg ,_beda ,_cfea float64 ,_gbde bool ){if _ggf !=nil {if _ecee :=_ggf .Ln ;_ecee !=nil {_gefb :=_gbdb .getPdfColorFromSolidFill (_ecee .SolidFill );if _gefb ==nil &&_gbde {_gefb =_aa .ColorBlack ;};if _gefb !=nil {var _ddfe float64 ;if _baa :=_ecee .WAttr ;_baa !=nil {_ddfe =_ac .FromEMU (int64 (*_baa ));}else {_ddfe =_bga ;};DrawLine (_gbdb ._geb ,_age ,_gcgg ,_beda ,_cfea ,_ddfe ,_gefb );};};};};func (_bcaf FontStyle )String ()string {return []string {"\u0052e\u0067\u0075\u006c\u0061\u0072","\u0042\u006f\u006c\u0064","\u0049\u0074\u0061\u006c\u0069\u0063","\u0042\u006f\u006c\u0064\u0049\u0074\u0061\u006c\u0069\u0063"}[int (_bcaf )];};func DrawRectangle (c *_aa .Creator ,r *Rectangle ,w float64 ,color _aa .Color ){if color ==nil {return ;};DrawLine (c ,r .Left ,r .Top ,r .Right ,r .Top ,w ,color );DrawLine (c ,r .Left ,r .Top ,r .Left ,r .Bottom ,w ,color );DrawLine (c ,r .Left ,r .Bottom ,r .Right ,r .Bottom ,w ,color );DrawLine (c ,r .Right ,r .Top ,r .Right ,r .Bottom ,w ,color );};func (_ga *creatorContext )drawBarChart (_cb *_da .CT_BarChart ,_ba *Rectangle ,_ef *_da .CT_PlotAreaChoice1 )([]*legendItem ,error ){var _ab bool ;if _gg :=_cb .BarDir ;_gg !=nil {_ab =_gg .ValAttr ==_da .ST_BarDirBar ;};_dc :=_cb .Ser ;_cgd .Sort (barSerByOrder (_dc ));_gdf :=map[string ]serCategory {};_abe :=[]string {};_bd :=[]*legendItem {};_bae :=_cgdc .Inf (1);_ee :=_cgdc .Inf (-1);for _ ,_ggd :=range _dc {var _eff string ;if _eec :=_ggd .Tx ;_eec !=nil {if _bb :=_eec .Choice ;_bb !=nil {if _bb .V !=nil {_eff =*_bb .V ;}else if _dg :=_bb .StrRef ;_dg !=nil {if _ag :=_dg .StrCache ;_ag !=nil {for _ ,_cf :=range _ag .Pt {_eff =_cf .V ;};};};};};if _cd :=_ggd .Cat ;_cd !=nil {if _gda :=_cd .Choice ;_gda !=nil {if _abeb :=_gda .StrRef ;_abeb !=nil {if _cgb :=_abeb .StrCache ;_cgb !=nil {for _ ,_ae :=range _cgb .Pt {_caf :=_ae .V ;if _ ,_bfe :=_gdf [_caf ];!_bfe {_gdf [_caf ]=serCategory {_eaa :_caf ,_eae :[]serValue {}};_abe =append (_abe ,_caf );};};};}else if _fa :=_gda .NumRef ;_fa !=nil {if _ea :=_fa .NumCache ;_ea !=nil {var _eecc string ;if _ea .FormatCode !=nil {_eecc =*_ea .FormatCode ;};for _ ,_fee :=range _ea .Pt {var _ed string ;if _fee .FormatCodeAttr ==nil {_ed =_eecc ;}else {_ed =*_fee .FormatCodeAttr ;};var _aag string ;_af ,_eg :=_cg .ParseFloat (_fee .V ,64);if _eg !=nil {_aag =_fee .V ;}else {_aag =_aab .Number (_af ,_ed );};if _ ,_cde :=_gdf [_aag ];!_cde {_gdf [_aag ]=serCategory {_eaa :_aag ,_eae :[]serValue {}};_abe =append (_abe ,_aag );};};};};};};if _fg :=_ggd .Val ;_fg !=nil {if _fab :=_fg .Choice ;_fab !=nil {if _feae :=_fab .NumRef ;_feae !=nil {if _ad :=_feae .NumCache ;_ad !=nil {for _db ,_ge :=range _ad .Pt {_bfb ,_abb :=_cg .ParseFloat (_ge .V ,64);if _abb !=nil {_bfb =0;_g .Println ("\u0070\u0061\u0072s\u0065\u0020\u0065\u0072\u0072\u006f\u0072\u003a",_abb );};if _bfb > _ee {_ee =_bfb ;};if _bfb < _bae {_bae =_bfb ;};_egc :=_gdf [_abe [_db ]];_egc ._eae =append (_egc ._eae ,serValue {_gfda :_eff ,_ddb :_bfb ,_cfdf :_ggd .SpPr });_gdf [_abe [_db ]]=_egc ;};};};};};_bd =append (_bd ,&legendItem {_feec :_eff ,_efb :_ggd .SpPr });};var _be float64 ;var _gf ,_ec float64 ;if _ee ==0&&_bae ==0{_be =0.2;_ec =0;_gf =1;}else {var _dcc float64 ;if _cgg :=_cgdc .Abs (_bae );_ee < _cgg {_dcc =_cgg ;}else {_dcc =_ee ;};_gba :=_cgdc .Pow (10,_cgdc .Floor (_cgdc .Log10 (_dcc )));_ddc :=_dcc /_gba ;if _ddc >=1.715&&_ddc < 4.29{_be =0.5;}else if _ddc >=4.29&&_ddc < 8.58{_be =1;}else {_be =2;};_be *=_gba ;if _ee <=0{_gf =0;}else {_gf =(_cgdc .Ceil (_ee /_be )+1)*_be ;};if _bae >=0{_ec =0;}else {_ec =(_cgdc .Floor (_bae /_be )-1)*_be ;};};_gfd :=_ga .drawAxes (_ef ,_ec ,_gf ,_be ,_abe ,_ba ,_ab );if _gfd !=nil {return nil ,_gfd ;};_bg :=0.0;if _cb .GapWidth !=nil {if _de :=_cb .GapWidth .ValAttr ;_de !=nil {if _cfa :=_de .ST_GapAmountUShort ;_cfa !=nil {_bg =float64 (*_cfa )/100.0;};};};_eb :=_ba .Right -_ba .Left ;_cbf :=_ba .Bottom -_ba .Top ;_dcf :=float64 (len (_abe ));if _ab {_fb :=_gf /(_gf -_ec )*_eb ;_dbd :=-_ec /(_gf -_ec )*_eb ;_dcfe :=_ba .Left +_dbd ;_fd :=_cbf /_dcf ;for _beb ,_df :=range _abe {_bdc :=_gdf [_df ];_efd :=float64 (len (_bdc ._eae ))+_bg ;_cgde :=_fd /_efd ;_ff :=_cgde *_bg ;_gfa :=_ba .Bottom -float64 (_beb )*_fd -_ff /2-_cgde ;for _ ,_edd :=range _bdc ._eae {if _edd ._ddb ==0{continue ;};var _dac ,_ced float64 ;if _edd ._ddb > 0{_ced =_edd ._ddb /_gf *_fb ;_ga .drawRectangleWithProps (_edd ._cfdf ,_dcfe ,_gfa ,_ced ,_cgde ,false );}else {_ced =_edd ._ddb /_ec *_dbd ;_dac =_dcfe -_ced ;_ga .drawRectangleWithProps (_edd ._cfdf ,_dac ,_gfa ,_ced ,_cgde ,false );};_gfa -=_cgde ;};};}else {_cec :=_gf /(_gf -_ec )*_cbf ;_efda :=-_ec /(_gf -_ec )*_cbf ;_eddb :=_ba .Top +_cec ;_dee :=_eb /_dcf ;for _ddcc ,_cdf :=range _abe {_cfd :=_gdf [_cdf ];_ddf :=float64 (len (_cfd ._eae ))+_bg ;_dacb :=_dee /_ddf ;_aga :=_dacb *_bg ;_fc :=_ba .Left +float64 (_ddcc )*_dee +_aga /2;for _ ,_egb :=range _cfd ._eae {var _gab ,_cbe float64 ;if _egb ._ddb > 0{_cbe =_egb ._ddb /_gf *_cec ;_gab =_eddb -_cbe ;_ga .drawRectangleWithProps (_egb ._cfdf ,_fc ,_gab ,_dacb ,_cbe ,false );}else {_cbe =_egb ._ddb /_ec *_efda ;_ga .drawRectangleWithProps (_egb ._cfdf ,_fc ,_eddb ,_dacb ,_cbe ,false );};_fc +=_dacb ;};};};return _bd ,nil ;};func (_cad barSerByOrder )Swap (i ,j int ){_cad [i ],_cad [j ]=_cad [j ],_cad [i ]};var _fbc =fontsMap {_dbc :&_gc .Mutex {},_abaa :map[string ]map[FontStyle ]*_fe .PdfFont {}};func AdjustColorByTint (colorStr string ,tint float64 )string {var _cfbb ,_ggac ,_agcf uint8 ;_ebd ,_ :=_e .Sscanf (colorStr ,"\u0025\u0030\u0032x\u0025\u0030\u0032\u0078\u0025\u0030\u0032\u0078",&_cfbb ,&_ggac ,&_agcf );if _ebd !=3{return "";};return _feb (_cfbb ,tint )+_feb (_ggac ,tint )+_feb (_agcf ,tint );};func GetOpacityFromColorTransform (trs []*_d .EG_ColorTransform )float64 {for _ ,_afc :=range trs {if _afc !=nil {if _faf :=_afc .Alpha ;_faf !=nil {if _gfb :=_faf .ValAttr .ST_PositiveFixedPercentageDecimal ;_gfb !=nil {return float64 (*_gfb )/100000;};};};};return 1.0;};func CropImageByRect (sourceImg _gb .Image ,rect _gb .Rectangle )_gb .Image {_eab ,_fedd ,_eecb ,_abbcb :=rect .Min .X ,rect .Min .Y ,rect .Max .X ,rect .Max .Y ;_ffb :=_gb .NewNRGBA (_gb .Rect (0,0,_eecb -_eab ,_abbcb -_fedd ));for _ccc :=_eab ;_ccc < _eecb ;_ccc ++{for _ecfg :=_fedd ;_ecfg < _abbcb ;_ecfg ++{_ffb .Set (_ccc -_eab ,_ecfg -_fedd ,sourceImg .At (_ccc ,_ecfg ));};};return _ffb ;};const (FontStyle_Regular FontStyle =0;FontStyle_Bold FontStyle =1;FontStyle_Italic FontStyle =2;FontStyle_BoldItalic FontStyle =3;);func MakeImageFromChartSpace (cs *_da .ChartSpace ,width ,height float64 ,theme *_d .Theme )(_gb .Image ,error ){_afga ,_bcd :=_bdb (cs ,width ,height ,theme ,true );if _bcd !=nil {return nil ,_bcd ;};_gcd ,_bcd :=GetPageFromCreator (_afga );if _bcd !=nil {return nil ,_bcd ;};return _gd .NewImageDevice ().Render (_gcd );};func (_dgf *creatorContext )getPdfColorFromSolidFill (_aedg *_d .CT_SolidColorFillProperties )_aa .Color {if _aedg ==nil {return nil ;};_ffed :="";if _bcf :=_aedg .SrgbClr ;_bcf !=nil {_ffed =_bcf .ValAttr ;}else if _fde :=_aedg .SchemeClr ;_fde !=nil {_ffed =_bfea (_fde .ValAttr ,_dgf ._cebg );};if _ffed ==""{return nil ;};return _aa .ColorRGBFromHex ("\u0023"+_ffed );};func (_aecg *creatorContext )drawAxes (_efe *_da .CT_PlotAreaChoice1 ,_aaa ,_cff ,_fabe float64 ,_dfd []string ,_ggde *Rectangle ,_ceb bool )error {_cedb :=_aecg ._geb ;_adf :=_aecg ._deaa ;if _efe ==nil {return _f .New ("\u004e\u006f\u0020\u0061xi\u0073\u0020\u0069\u006e\u0066\u006f\u0072\u006d\u0061\u0074\u0069\u006f\u006e");};if len (_efe .ValAx )==0||(len (_efe .CatAx )==0&&len (_efe .DateAx )==0&&len (_efe .SerAx )==0){return _f .New ("\u004e\u006f\u0020\u0078\u0020\u006f\u0072\u0020\u0079 \u0061\u0078\u0069\u0073");};var _gdge ,_gaa ,_fcf ,_eaga uint32 ;var _bdd ,_agf _da .ST_AxPos ;var _dca ,_aca _da .ST_TickMark ;var _dgeb ,_egcc *_da .CT_ChartLines ;var _ggdb ,_eba _da .ST_TickLblPos ;var _fgf ,_gdca *_d .CT_ShapeProperties ;var _ecce error ;_decg :=_ggde .Right -_ggde .Left ;_dgcc :=_ggde .Bottom -_ggde .Top ;if len (_efe .ValAx )> 0{_gaa ,_agf ,_aca ,_eba ,_egcc ,_eaga ,_gdca ,_ecce =_gcbf (_efe .ValAx [0]);};if _agf !=_da .ST_AxPosL &&_agf !=_da .ST_AxPosB {return _f .New ("\u004f\u006e\u006c\u0079\u0020l\u0065\u0066\u0074\u0020\u006f\u0072\u0020\u0062\u006f\u0074\u0074\u006f\u006d \u0079\u0020\u0061\u0078\u0069\u0073\u0020\u0073\u0075\u0070\u0070\u006f\u0072\u0074\u0020\u0073\u006f\u0020\u0066\u0061\u0072");};_cfcd :=_cff -_aaa ;_aef :=int (_cfcd /_fabe )+1;var _bbe ,_fcbd float64 ;switch _aca {case _da .ST_TickMarkIn :_bbe ,_fcbd =_fba ,0;case _da .ST_TickMarkOut :_bbe ,_fcbd =0,_fba ;case _da .ST_TickMarkCross :_bbe ,_fcbd =_fba ,_fba ;};_bbe =_bbe *_adf ;_fcbd =_fcbd *_adf ;var _acgc *_d .CT_ShapeProperties ;if _egcc !=nil {_acgc =_egcc .SpPr ;};_fbe ,_gbd :=_ggdb !=_da .ST_TickLblPosNone ,_eba !=_da .ST_TickLblPosNone ;_fbf :=_aaa ;if len (_efe .CatAx )> 0{_gdge ,_bdd ,_dca ,_ggdb ,_dgeb ,_fcf ,_fgf ,_ecce =_edeb (_efe .CatAx [0]);}else if len (_efe .DateAx )> 0{_gdge ,_bdd ,_dca ,_ggdb ,_dgeb ,_fcf ,_fgf ,_ecce =_fbbg (_efe .DateAx [0]);}else if len (_efe .SerAx )> 0{_gdge ,_bdd ,_dca ,_ggdb ,_dgeb ,_fcf ,_fgf ,_ecce =_bddc (_efe .SerAx [0]);};if _ecce !=nil {return _ecce ;};if _bdd !=_da .ST_AxPosL &&_bdd !=_da .ST_AxPosB {return _f .New ("\u004f\u006e\u006c\u0079\u0020l\u0065\u0066\u0074\u0020\u006f\u0072\u0020\u0062\u006f\u0074\u0074\u006f\u006d \u0078\u0020\u0061\u0078\u0069\u0073\u0020\u0073\u0075\u0070\u0070\u006f\u0072\u0074\u0020\u0073\u006f\u0020\u0066\u0061\u0072");};if _gdge !=_eaga ||_gaa !=_fcf {return _f .New ("a\u0078i\u0073\u0020\u0069\u0064\u0073\u0020\u0064\u006fn\u0027\u0074\u0020\u006dat\u0063\u0068");};_dfde :=len (_dfd )+1;var _adb ,_gbga float64 ;switch _dca {case _da .ST_TickMarkIn :_adb ,_gbga =_fba ,0;case _da .ST_TickMarkOut :_adb ,_gbga =0,_fba ;case _da .ST_TickMarkCross :_adb ,_gbga =_fba ,_fba ;};_adb =_adb *_adf ;_gbga =_gbga *_adf ;var _dad *_d .CT_ShapeProperties ;if _dgeb !=nil {_dad =_dgeb .SpPr ;};if _ceb {_abd :=_dgcc /float64 (len (_dfd ));_aaf :=_ggde .Left -_aaa *_decg /_cfcd ;_gfe :=_aaf -_bbf *_adf ;if _fbe {var _cag float64 ;for _fgd :=0;_fgd < _dfde ;_fgd ++{_gddd :=_ggde .Bottom -float64 (_fgd )*_abd ;if _fgd < _dfde -1{_fgb :=_cedb .NewParagraph (_dfd [_fgd ]);_fgb .SetFontSize (_acf *_adf );_fgb .SetPos (_gfe ,_gddd -_abd /2-_efa *_adf );_cedb .Draw (_fgb );_gga :=(_fgb .Width ()/1000-_bbf )*_adf ;if _gga > 0&&_gga > _cag {_cag =_gga ;};};};if _cag > 0{_ggde .Left +=_cag +_aed ;_aaf =_ggde .Left -_aaa *_decg /_cfcd ;_decg =_ggde .Right -_ggde .Left ;};};_ebe :=_aaf -_gbga ;_dcab :=_aaf +_adb ;_feaa :=_ggde .Left ;_fcc :=_ggde .Right ;for _aae :=0;_aae < _dfde ;_aae ++{_fabd :=_ggde .Bottom -float64 (_aae )*_abd ;_aecg .drawLineWithProps (_fgf ,_ebe ,_fabd ,_dcab ,_fabd ,true );_aecg .drawLineWithProps (_dad ,_feaa ,_fabd ,_fcc ,_fabd ,true );};_egbc :=_decg /_cfcd ;_ecf :=_ggde .Bottom -_bbe ;_cfb :=_ggde .Bottom +_fcbd ;_cdb :=_ggde .Top ;_ede :=_ggde .Bottom ;for _eef :=0;_eef < _aef ;_eef ++{_dcdb :=_ggde .Left +(_fbf -_aaa )*_egbc ;_aecg .drawLineWithProps (_gdca ,_dcdb ,_ecf ,_dcdb ,_cfb ,true );_aecg .drawLineWithProps (_acgc ,_dcdb ,_cdb ,_dcdb ,_ede ,true );if _gbd {_gcb :=_cedb .NewParagraph (_cg .FormatFloat (_fbf ,'g',-1,64));_gcb .SetFontSize (_acf *_adf );_gcb .SetPos (_dcdb -_dgb *_adf ,_ede +_gdg *_adf );_cedb .Draw (_gcb );};_fbf +=_fabe ;};}else {_cdfb :=_dgcc /_cfcd ;_ecfa :=_ggde .Left ;if _gbd {var _dgcb float64 ;for _bfa :=0;_bfa < _aef ;_bfa ++{_fcg :=_ggde .Bottom -(_fbf -_aaa )*_cdfb ;_fda :=_cedb .NewParagraph (_cg .FormatFloat (_fbf ,'g',-1,64));_fda .SetFontSize (_acf *_adf );_fda .SetPos (_ecfa -_bbf *_adf ,_fcg -_efa *_adf );_cedb .Draw (_fda );_deg :=(_fda .Width ()/1000-_bbf )*_adf ;if _deg > 0&&_deg > _dgcb {_dgcb =_deg ;};_fbf +=_fabe ;};if _dgcb > 0{_ggde .Left +=_dgcb +_aed ;_decg =_ggde .Right -_ggde .Left ;};};_fbf =_aaa ;_gea :=_ggde .Left -_fcbd ;_cbec :=_ggde .Left +_bbe ;_ecfa =_ggde .Left ;_beg :=_ggde .Right ;for _ccf :=0;_ccf < _aef ;_ccf ++{_fed :=_ggde .Bottom -(_fbf -_aaa )*_cdfb ;_aecg .drawLineWithProps (_gdca ,_gea ,_fed ,_cbec ,_fed ,true );_aecg .drawLineWithProps (_acgc ,_ecfa ,_fed ,_beg ,_fed ,true );_fbf +=_fabe ;};_ffg :=_decg /float64 (len (_dfd ));_acfe :=_ggde .Bottom +_aaa *_dgcc /_cfcd ;_cdc :=_acfe -_adb ;_add :=_acfe +_gbga ;_deb :=_ggde .Top ;_dbdb :=_ggde .Bottom ;_acc :=_acfe +_gdg *_adf ;for _fbb :=0;_fbb < _dfde ;_fbb ++{_fcgd :=_ggde .Left +float64 (_fbb )*_ffg ;_aecg .drawLineWithProps (_fgf ,_fcgd ,_cdc ,_fcgd ,_add ,true );_aecg .drawLineWithProps (_dad ,_fcgd ,_deb ,_fcgd ,_dbdb ,true );if _fbe &&_fbb < _dfde -1{_geaa :=_cedb .NewParagraph (_dfd [_fbb ]);_geaa .SetFontSize (_acf *_adf );_geaa .SetPos (_fcgd +_fdfe *_adf ,_acc );_cedb .Draw (_geaa );};};};return nil ;};type creatorContext struct{_geb *_aa .Creator ;_cebg *_d .Theme ;_deaa float64 ;};var _fdfe =_bcg (5);func AdjustColorByLumMod (colorStr string ,lum float64 )string {var _bef ,_bac ,_geae uint8 ;_aeef ,_ :=_e .Sscanf (colorStr ,"\u0025\u0030\u0032x\u0025\u0030\u0032\u0078\u0025\u0030\u0032\u0078",&_bef ,&_bac ,&_geae );if _aeef !=3{return "";};_cbb ,_egd ,_aeg :=_ccd (_bef ,_bac ,_geae );_aeg =lum *_aeg ;_bef ,_bac ,_geae =_gfdc (_cbb ,_egd ,_aeg );return _e .Sprintf ("\u0025\u0030\u0032x\u0025\u0030\u0032\u0078\u0025\u0030\u0032\u0078",_bef ,_bac ,_geae );};func _eeg (_gggb float64 )float64 {if _gggb < 0{_gggb +=float64 (-int (_gggb )+1);}else if _gggb > 1{_gggb -=float64 (int (_gggb ));};return _gggb ;};type Rectangle struct{Top float64 ;Bottom float64 ;Left float64 ;Right float64 ;};func _fbbg (_bfbb *_da .CT_DateAx )(uint32 ,_da .ST_AxPos ,_da .ST_TickMark ,_da .ST_TickLblPos ,*_da .CT_ChartLines ,uint32 ,*_d .CT_ShapeProperties ,error ){var _gabg ,_dae uint32 ;var _fcccd _da .ST_AxPos ;var _afd _da .ST_TickMark ;var _begb *_da .CT_ChartLines ;var _ffac _da .ST_TickLblPos ;if _bfbb .AxId ==nil {return _gabg ,_fcccd ,_afd ,_ffac ,_begb ,_dae ,_bfbb .SpPr ,_f .New ("\u004e\u006f\u0020x\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");}else {_gabg =_bfbb .AxId .ValAttr ;};if _bfbb .AxPos ==nil {return _gabg ,_fcccd ,_afd ,_ffac ,_begb ,_dae ,_bfbb .SpPr ,_f .New ("\u004eo\u0020x\u0020\u0061\u0078\u0069\u0073 \u0070\u006fs\u0069\u0074\u0069\u006f\u006e");}else {_fcccd =_bfbb .AxPos .ValAttr ;};if _bfbb .MajorTickMark !=nil {_afd =_bfbb .MajorTickMark .ValAttr ;};if _bfbb .TickLblPos !=nil {_ffac =_bfbb .TickLblPos .ValAttr ;};if _bfbb .CrossAx ==nil {return _gabg ,_fcccd ,_afd ,_ffac ,_begb ,_dae ,_bfbb .SpPr ,_f .New ("\u004e\u006f \u0063\u0072\u006fs\u0073\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");}else {_dae =_bfbb .CrossAx .ValAttr ;};_begb =_bfbb .MajorGridlines ;return _gabg ,_fcccd ,_afd ,_ffac ,_begb ,_dae ,_bfbb .SpPr ,nil ;};func (_dgc *creatorContext )drawLegend (_bdcg *Rectangle ,_bee []*legendItem ,_eee bool ){_afb :=_dgc ._deaa ;_fgge :=_bcg (2.5)*_afb ;_aba :=_ged *_afb ;_bfef :=(_fgge -_aba )/2;_gdc :=float64 (len (_bee ));if _eee {_bca :=&Rectangle {Top :_bdcg .Top +_bcg (1)*_afb ,Bottom :_bdcg .Bottom -_bcg (1)*_afb ,Left :_bdcg .Left +_bcg (2.5)*_afb ,Right :_bdcg .Right -_bcg (2.5)*_afb };var _fce float64 ;if _gdc > 1{_fce =(_bca .Right -_bca .Left )/_gdc ;};_ffe :=_bca .Left ;_eagb :=_bca .Top ;for _ ,_aff :=range _bee {if _gabb :=_aff ._efb ;_gabb !=nil {_dgc .drawRectangleWithProps (_gabb ,_ffe ,_eagb +_bfef ,_aba ,_aba ,false );_ecc :=_ffe +_aba *2;_gce :=_dgc ._geb .NewStyledParagraph ();_gce .SetPos (_ecc ,_eagb );_gbe :=_gce .Append (_aff ._feec );_eaea ,_edf :=_fe .NewStandard14Font (_fe .HelveticaName );if _edf ==nil {_gbe .Style =_aa .TextStyle {FontSize :_fgge ,Font :_eaea ,TextRise :0.4};_dgc ._geb .Draw (_gce );};};_ffe +=_fce ;};}else {_cfc :=&Rectangle {Top :_bdcg .Top +_bcg (2.5)*_afb ,Bottom :_bdcg .Bottom -_bcg (2.5)*_afb ,Left :_bdcg .Left +_bcg (2.5)*_afb ,Right :_bdcg .Right -_bcg (2.5)*_afb };var _aec float64 ;if _gdc > 1{_aec =(_cfc .Bottom -_cfc .Top -_fgge )/(_gdc -1);};_fcb :=_cfc .Top ;_dge :=_cfc .Left ;_gbfc :=_dge +_aba *2;for _ ,_bba :=range _bee {if _gbb :=_bba ._efb ;_gbb !=nil {_dgc .drawRectangleWithProps (_gbb ,_dge ,_fcb +_bfef ,_aba ,_aba ,false );_gbab :=_dgc ._geb .NewStyledParagraph ();_gbab .SetPos (_gbfc ,_fcb );_gca :=_gbab .Append (_bba ._feec );_gdd ,_acb :=_fe .NewStandard14Font (_fe .HelveticaName );if _acb ==nil {_gca .Style =_aa .TextStyle {FontSize :_fgge ,Font :_gdd ,TextRise :0.4};_dgc ._geb .Draw (_gbab );};};_fcb +=_aec ;};};};func MakeBlockFromChartSpace (cs *_da .ChartSpace ,width ,height float64 ,theme *_d .Theme )(*_aa .Block ,error ){_afg ,_fdg :=_bdb (cs ,width ,height ,theme ,false );if _fdg !=nil {return nil ,_fdg ;};_aee ,_fdg :=GetPageFromCreator (_afg );if _fdg !=nil {return nil ,_fdg ;};_faa ,_fdg :=_aa .NewBlockFromPage (_aee );if _fdg !=nil {return nil ,_fdg ;};return _faa ,nil ;};func RegisterFont (name string ,style FontStyle ,font *_fe .PdfFont ){_fbc ._dbc .Lock ();if _fbc ._abaa [name ]==nil {_fbc ._abaa [name ]=map[FontStyle ]*_fe .PdfFont {};};_fbc ._abaa [name ][style ]=font ;_fbc ._dbc .Unlock ();};type FontStyle byte ;func _feg (_cfe ,_fff ,_cce float64 )float64 {if _cfe *6< 1{return _cce +(_fff -_cce )*6*_cfe ;}else if _cfe *2< 1{return _fff ;}else if _cfe *3< 2{return _cce +(_fff -_cce )*(2.0/3.0-_cfe )*6;}else {return _cce ;};};func GetColorStringFromDmlColor (dmlColor *_d .CT_Color )string {var _fef string ;if _ceg :=dmlColor .SrgbClr ;_ceg !=nil {_fef =_ceg .ValAttr ;}else if _bdac :=dmlColor .SysClr ;_bdac !=nil {return "\u0030\u0030\u0030\u0030\u0030\u0030";};return _fef ;};var StdFontsMap =map[string ][]string {"\u0048e\u006c\u0076\u0065\u0074\u0069\u0063a":[]string {"\u0048e\u006c\u0076\u0065\u0074\u0069\u0063a","\u0048\u0065\u006c\u0076\u0065\u0074\u0069\u0063\u0061-\u0042\u006f\u006c\u0064","\u0048\u0065\u006c\u0076\u0065\u0074\u0069\u0063\u0061\u002d\u004f\u0062l\u0069\u0071\u0075\u0065","H\u0065\u006c\u0076\u0065ti\u0063a\u002d\u0042\u006f\u006c\u0064O\u0062\u006c\u0069\u0071\u0075\u0065"},"\u0043o\u0075\u0072\u0069\u0065\u0072":[]string {"\u0043o\u0075\u0072\u0069\u0065\u0072","\u0043\u006f\u0075r\u0069\u0065\u0072\u002d\u0042\u006f\u006c\u0064","\u0043o\u0075r\u0069\u0065\u0072\u002d\u004f\u0062\u006c\u0069\u0071\u0075\u0065","\u0043\u006f\u0075\u0072ie\u0072\u002d\u0042\u006f\u006c\u0064\u004f\u0062\u006c\u0069\u0071\u0075\u0065"},"\u0054i\u006de\u0073\u0020\u004e\u0065\u0077\u0020\u0052\u006f\u006d\u0061\u006e":[]string {"T\u0069\u006d\u0065\u0073\u002d\u0052\u006f\u006d\u0061\u006e","\u0054\u0069\u006d\u0065\u0073\u002d\u0042\u006f\u006c\u0064","\u0054\u0069\u006de\u0073\u002d\u0049\u0074\u0061\u006c\u0069\u0063","\u0054\u0069m\u0065\u0073\u002dB\u006f\u006c\u0064\u0049\u0074\u0061\u006c\u0069\u0063"},"\u0064e\u0066\u0061\u0075\u006c\u0074":[]string {"\u0048e\u006c\u0076\u0065\u0074\u0069\u0063a","\u0048\u0065\u006c\u0076\u0065\u0074\u0069\u0063\u0061-\u0042\u006f\u006c\u0064","\u0048\u0065\u006c\u0076\u0065\u0074\u0069\u0063\u0061\u002d\u004f\u0062l\u0069\u0071\u0075\u0065","H\u0065\u006c\u0076\u0065ti\u0063a\u002d\u0042\u006f\u006c\u0064O\u0062\u006c\u0069\u0071\u0075\u0065"}};func AdjustColorByShade (colorStr string ,shade float64 )string {var _dgae ,_eed ,_fag uint8 ;_baeg ,_ :=_e .Sscanf (colorStr ,"\u0025\u0030\u0032x\u0025\u0030\u0032\u0078\u0025\u0030\u0032\u0078",&_dgae ,&_eed ,&_fag );if _baeg !=3{return "";};return _ffgb (_dgae ,shade )+_ffgb (_eed ,shade )+_ffgb (_fag ,shade );};func RegisterFontsFromDirectory (dirName string )error {_abea ,_efbd :=_cc .Open (dirName );if _efbd !=nil {return _efbd ;};defer _abea .Close ();_fbg ,_efbd :=_abea .Readdirnames (0);if _efbd !=nil {return _efbd ;};for _ ,_feecb :=range _fbg {if _a .HasSuffix (_feecb ,"\u002e\u0074\u0074\u0066"){_dccaa :=dirName +"\u002f"+_feecb ;_bde ,_eefab :=_ce .ParseFile (_dccaa );if _eefab !=nil {_g .Printf ("\u0043a\u006e\u006e\u006f\u0074 \u0070\u0061\u0072\u0073\u0065 \u0054T\u0046 \u0066\u0069\u006c\u0065\u0020\u0025\u0073\n",_eefab );continue ;};_gcg :=_bde .GetNameByID (1);if _gcg ==""{_g .Printf ("\u004e\u006f\u0020f\u006f\u006e\u0074\u0020\u0066\u0061\u006d\u0069\u006c\u0079\u0020\u0069\u006e\u0066\u006f\u0072\u006d\u0061\u0074\u0069\u006f\u006e\u0020\u0069\u006e\u0020\u0074\u0068\u0065 \u0066\u0069\u006c\u0065\u0020\u0025\u0073\u000a",_dccaa );continue ;};_cffa :=_bde .GetNameByID (2);if _cffa ==""{_g .Printf ("N\u006f\u0020\u0073\u0074\u0079\u006ce\u0020\u0069\u006e\u0066\u006f\u0072m\u0061\u0074\u0069\u006f\u006e\u0020\u0069n\u0020\u0074\u0068\u0065\u0020\u0066\u0069\u006c\u0065\u0020%\u0073",_dccaa );continue ;};_gad ,_eefab :=_fe .NewCompositePdfFontFromTTFFile (_dccaa );if _eefab !=nil {_g .Printf ("\u0043\u0061nn\u006f\u0074\u0020m\u0061\u006b\u0065\u0020a f\u006fnt\u0020\u0066\u0072\u006f\u006d\u0020\u0054TF\u0020\u0066\u0069\u006c\u0065\u0020\u0025s\u000a",_eefab );continue ;};RegisterFont (_gcg ,_abbc [_cffa ],_gad );};};return nil ;};func _bddc (_debd *_da .CT_SerAx )(uint32 ,_da .ST_AxPos ,_da .ST_TickMark ,_da .ST_TickLblPos ,*_da .CT_ChartLines ,uint32 ,*_d .CT_ShapeProperties ,error ){var _acd ,_eeca uint32 ;var _gcf _da .ST_AxPos ;var _afff _da .ST_TickMark ;var _acca *_da .CT_ChartLines ;var _cge _da .ST_TickLblPos ;if _debd .AxId ==nil {return _acd ,_gcf ,_afff ,_cge ,_acca ,_eeca ,_debd .SpPr ,_f .New ("\u004e\u006f\u0020x\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");}else {_acd =_debd .AxId .ValAttr ;};if _debd .AxPos ==nil {return _acd ,_gcf ,_afff ,_cge ,_acca ,_eeca ,_debd .SpPr ,_f .New ("\u004eo\u0020x\u0020\u0061\u0078\u0069\u0073 \u0070\u006fs\u0069\u0074\u0069\u006f\u006e");}else {_gcf =_debd .AxPos .ValAttr ;};if _debd .MajorTickMark !=nil {_afff =_debd .MajorTickMark .ValAttr ;};if _debd .TickLblPos !=nil {_cge =_debd .TickLblPos .ValAttr ;};if _debd .CrossAx ==nil {return _acd ,_gcf ,_afff ,_cge ,_acca ,_eeca ,_debd .SpPr ,_f .New ("\u004e\u006f \u0063\u0072\u006fs\u0073\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");}else {_eeca =_debd .CrossAx .ValAttr ;};_acca =_debd .MajorGridlines ;return _acd ,_gcf ,_afff ,_cge ,_acca ,_eeca ,_debd .SpPr ,nil ;};func Lighten (clr float64 )float64 {return 0.6+0.4*clr };func IsNoSpaceLanguage (symbol string )bool {for _ ,_bfbbd :=range symbol {if _bc .Is (_bc .Han ,_bfbbd ){return true ;};};return false ;};var _abbc =map[string ]FontStyle {"\u0052e\u0067\u0075\u006c\u0061\u0072":FontStyle_Regular ,"\u0042\u006f\u006c\u0064":FontStyle_Bold ,"\u0049\u0074\u0061\u006c\u0069\u0063":FontStyle_Italic ,"B\u006f\u006c\u0064\u0020\u0049\u0074\u0061\u006c\u0069\u0063":FontStyle_BoldItalic };var _bga =_bcg (0.125);func _gcbf (_adda *_da .CT_ValAx )(uint32 ,_da .ST_AxPos ,_da .ST_TickMark ,_da .ST_TickLblPos ,*_da .CT_ChartLines ,uint32 ,*_d .CT_ShapeProperties ,error ){var _gef ,_bege uint32 ;var _cgdg _da .ST_AxPos ;var _ead _da .ST_TickMark ;var _gfag *_da .CT_ChartLines ;var _bcb _da .ST_TickLblPos ;if _adda .AxId ==nil {return _gef ,_cgdg ,_ead ,_bcb ,_gfag ,_bege ,_adda .SpPr ,_f .New ("\u004e\u006f\u0020x\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");}else {_gef =_adda .AxId .ValAttr ;};if _adda .AxPos ==nil {return _gef ,_cgdg ,_ead ,_bcb ,_gfag ,_bege ,_adda .SpPr ,_f .New ("\u004eo\u0020x\u0020\u0061\u0078\u0069\u0073 \u0070\u006fs\u0069\u0074\u0069\u006f\u006e");}else {_cgdg =_adda .AxPos .ValAttr ;};if _adda .MajorTickMark !=nil {_ead =_adda .MajorTickMark .ValAttr ;};if _adda .TickLblPos !=nil {_bcb =_adda .TickLblPos .ValAttr ;};if _adda .CrossAx ==nil {return _gef ,_cgdg ,_ead ,_bcb ,_gfag ,_bege ,_adda .SpPr ,_f .New ("\u004e\u006f \u0063\u0072\u006fs\u0073\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");}else {_bege =_adda .CrossAx .ValAttr ;};_gfag =_adda .MajorGridlines ;return _gef ,_cgdg ,_ead ,_bcb ,_gfag ,_bege ,_adda .SpPr ,nil ;};func MakeTempCreator (width ,height float64 )*_aa .Creator {_fggb :=_aa .New ();_fggb .SetPageSize (_aa .PageSize {width ,height });_fggb .SetPageMargins (0,0,0,0);return _fggb ;};func FromSTPercentage (st *_d .ST_Percentage )float64 {if _geda :=st .ST_PercentageDecimal ;_geda !=nil {return float64 (*_geda )/100000;};return 0;};var _gdg =_bcg (1.5);func (_fcfd *creatorContext )drawBorderWithProps (_gabgb *_d .CT_ShapeProperties ,_dde *Rectangle ,_gfca float64 ){if _dde !=nil &&_gabgb !=nil &&_gabgb .Ln !=nil &&_gabgb .Ln .SolidFill !=nil {_gbc :=_fcfd .getPdfColorFromSolidFill (_gabgb .Ln .SolidFill );DrawRectangle (_fcfd ._geb ,_dde ,_gfca ,_gbc );};};type ImgPart byte ;var _aed =_bcg (2);type barSerByOrder []*_da .CT_BarSer ;func FromSTCoordinate32 (st _d .ST_Coordinate32 )int64 {if _gde :=st .ST_Coordinate32Unqualified ;_gde !=nil {return int64 (*_gde );};return 0;};func GetImage (c *_aa .Creator ,goImg _gb .Image ,imgHeight ,imgWidth ,left ,top ,dividerX ,dividerY float64 ,part ImgPart )(*_aa .Image ,error ){if goImg ==nil {return nil ,nil ;};_addd :=goImg .Bounds ().Size ();_fge :=_addd .X ;_dgaf :=_addd .Y ;if dividerX !=0{dividerX =dividerX /imgWidth *float64 (_fge );};if dividerY !=0{dividerY =dividerY /imgHeight *float64 (_dgaf );};var _aefa _gb .Rectangle ;switch part {case ImgPart_t :_aefa =_gb .Rect (0,0,_fge ,int (dividerY ));case ImgPart_b :_aefa =_gb .Rect (0,int (dividerY ),_fge ,_dgaf );case ImgPart_l :_aefa =_gb .Rect (0,0,int (dividerX ),_dgaf );case ImgPart_r :_aefa =_gb .Rect (int (dividerX ),0,_fge ,_dgaf );case ImgPart_lt :_aefa =_gb .Rect (0,0,int (dividerX ),int (dividerY ));case ImgPart_rt :_aefa =_gb .Rect (int (dividerX ),0,_fge ,int (dividerY ));case ImgPart_lb :_aefa =_gb .Rect (0,int (dividerY ),int (dividerX ),_dgaf );case ImgPart_rb :_aefa =_gb .Rect (int (dividerX ),int (dividerY ),_fge ,_dgaf );default:_aefa =_gb .Rect (0,0,_fge ,_dgaf );};_efge :=CropImageByRect (goImg ,_aefa );_cbee ,_deca :=c .NewImageFromGoImage (_efge );if _deca !=nil {return nil ,_deca ;};_cbee .Scale (imgWidth /float64 (_fge ),imgHeight /float64 (_dgaf ));_cbee .SetPos (left ,top );return _cbee ,nil ;};func (_eag barSerByOrder )Less (i ,j int )bool {return _eag [i ].Order .ValAttr < _eag [j ].Order .ValAttr };func _gfdc (_ace ,_gaab ,_cac float64 )(uint8 ,uint8 ,uint8 ){var _deeb float64 ;if _cac < 0.5{_deeb =_cac *(1+_gaab );}else {_deeb =_cac +_gaab -_cac *_gaab ;};_cfdg :=_cac *2-_deeb ;_ace /=360.0;_cgbf :=_eeg (_ace +1.0/3.0);_acag :=_eeg (_ace );_efff :=_eeg (_ace -1.0/3.0);_aeb :=_feg (_cgbf ,_deeb ,_cfdg );_dfa :=_feg (_acag ,_deeb ,_cfdg );_cba :=_feg (_efff ,_deeb ,_cfdg );return uint8 (255*_aeb ),uint8 (255*_dfa ),uint8 (255*_cba );};type serCategory struct{_eaa string ;_eae []serValue ;};func GetPageFromCreator (c *_aa .Creator )(*_fe .PdfPage ,error ){_efaf :=_b .NewBuffer ([]byte {});_agfd :=c .Write (_efaf );if _agfd !=nil {return nil ,_agfd ;};_fdgg :=_b .NewReader (_efaf .Bytes ());_dafg ,_agfd :=_fe .NewPdfReader (_fdgg );if _agfd !=nil {return nil ,_agfd ;};return _dafg .GetPage (1);};var _efa =_bcg (1.5);func GetDataFromXfrm (xfrm *_d .CT_Transform2D )(float64 ,float64 ,float64 ,float64 ){var _geaf ,_eefg ,_dbac ,_afe float64 ;if _cab :=xfrm .Off ;_cab !=nil {_geaf =_ac .FromEMU (FromSTCoordinate (_cab .XAttr ));_eefg =_ac .FromEMU (FromSTCoordinate (_cab .YAttr ));};if _ceba :=xfrm .Ext ;_ceba !=nil {_dbac =_ac .FromEMU (_ceba .CxAttr );_afe =_ac .FromEMU (_ceba .CyAttr );};return _geaf ,_eefg ,_dbac ,_afe ;};func DrawLine (c *_aa .Creator ,x0 ,y0 ,x1 ,y1 ,width float64 ,color _aa .Color ){if color ==nil {return ;};_dafge :=c .NewLine (x0 ,y0 ,x1 ,y1 );_dafge .SetLineWidth (width );_dafge .SetColor (color );c .Draw (_dafge );};const DefaultFontSize =12.0;func _bfbf (_cfac _d .ST_SchemeColorVal ,_ega *_d .Theme )string {if _bbga :=_ega .ThemeElements ;_bbga !=nil {if _gee :=_bbga .ClrScheme ;_gee !=nil {switch _cfac {case _d .ST_SchemeColorValLt1 :return GetColorStringFromDmlColor (_gee .Lt1 );case _d .ST_SchemeColorValDk1 ,_d .ST_SchemeColorValTx1 :return GetColorStringFromDmlColor (_gee .Dk1 );case _d .ST_SchemeColorValLt2 :return GetColorStringFromDmlColor (_gee .Lt2 );case _d .ST_SchemeColorValDk2 :return GetColorStringFromDmlColor (_gee .Dk2 );case _d .ST_SchemeColorValAccent1 :return GetColorStringFromDmlColor (_gee .Accent1 );case _d .ST_SchemeColorValAccent2 :return GetColorStringFromDmlColor (_gee .Accent2 );case _d .ST_SchemeColorValAccent3 :return GetColorStringFromDmlColor (_gee .Accent3 );case _d .ST_SchemeColorValAccent4 :return GetColorStringFromDmlColor (_gee .Accent4 );case _d .ST_SchemeColorValAccent5 :return GetColorStringFromDmlColor (_gee .Accent5 );case _d .ST_SchemeColorValAccent6 :return GetColorStringFromDmlColor (_gee .Accent6 );};};};return "";};type serValue struct{_gfda string ;_ddb float64 ;_cfdf *_d .CT_ShapeProperties ;};func (_adbd *creatorContext )drawRectangleWithProps (_egdg *_d .CT_ShapeProperties ,_dbaf ,_gfbd ,_aad ,_cga float64 ,_bdag bool ){_fgbb :=_adbd ._geb .NewRectangle (_dbaf ,_gfbd ,_aad ,_cga );if _egdg ==nil {if _bdag {_fgbb .SetBorderWidth (_bga );}else {return ;};}else {_aabb :=_adbd .getPdfColorFromSolidFill (_egdg .SolidFill );if _aabb !=nil {_fgbb .SetFillColor (_aabb );};if _bdde :=_egdg .Ln ;_bdde !=nil {if _gbfe :=_bdde .WAttr ;_gbfe !=nil {_cfcf :=_ac .FromEMU (int64 (*_gbfe ));_fgbb .SetBorderWidth (_cfcf );if _defe :=_bdde .SolidFill ;_defe !=nil {_gced :=_adbd .getPdfColorFromSolidFill (_defe );if _gced !=nil {_fgbb .SetBorderColor (_gced );};};}else {_fgbb .SetBorderWidth (0);};};};_adbd ._geb .Draw (_fgbb );};func GetRegisteredFont (name string ,style FontStyle )*_fe .PdfFont {_fbc ._dbc .Lock ();defer _fbc ._dbc .Unlock ();if _gdb ,_bgg :=_fbc ._abaa [name ];_bgg {if _dea ,_efg :=_gdb [style ];_efg {return _dea ;};};return nil ;};