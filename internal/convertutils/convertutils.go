//
// Copyright 2020 FoxyUtils ehf. All rights reserved.
//
// This is a commercial product and requires a license to operate.
// A trial license can be obtained at https://unidoc.io
//
// DO NOT EDIT: generated by unitwist Go source code obfuscator.
//
// Use of this source code is governed by the UniDoc End User License Agreement
// terms that can be accessed at https://unidoc.io/eula/

package convertutils ;import (_g "bytes";_c "errors";_f "fmt";_a "github.com/unidoc/unioffice/common/logger";_cb "github.com/unidoc/unioffice/measurement";_bb "github.com/unidoc/unioffice/schema/soo/dml";_ea "github.com/unidoc/unioffice/schema/soo/dml/chart";_dc "github.com/unidoc/unioffice/spreadsheet/format";_ga "github.com/unidoc/unipdf/v3/creator";_ffe "github.com/unidoc/unipdf/v3/model";_gd "github.com/unidoc/unipdf/v3/render";_ff "github.com/unidoc/unitype";_dg "image";_eg "math";_d "os";_ebc "sort";_ba "strconv";_eb "strings";_b "sync";_ee "unicode";);type ImgPart byte ;func GetColorStringFromDmlColor (dmlColor *_bb .CT_Color )string {var _daea string ;if _cbc :=dmlColor .SrgbClr ;_cbc !=nil {_daea =_cbc .ValAttr ;}else if _aeba :=dmlColor .SysClr ;_aeba !=nil {return "\u0030\u0030\u0030\u0030\u0030\u0030";};return _daea ;};func FromSTCoordinate32 (st _bb .ST_Coordinate32 )int64 {if _ccfd :=st .ST_Coordinate32Unqualified ;_ccfd !=nil {return int64 (*_ccfd );};return 0;};func _eef (_bae *_ea .ChartSpace ,_ecdb ,_gcef float64 ,_cfg *_bb .Theme ,_gae bool )(*_ga .Creator ,error ){_bde :=1.0;if _gae {_bde =8.0;};_fb :=&Rectangle {};_gfe :=&Rectangle {Top :_fb .Top ,Bottom :_gcef -_fb .Bottom ,Left :_fb .Left ,Right :_ecdb -_fb .Right };_eca :=MakeTempCreator (_ecdb *_bde +1,_gcef *_bde +1);_cdd :=&creatorContext {_dbgg :_eca ,_bge :_cfg ,_afb :_bde };var _bdf bool ;if _cbd :=_bae .Chart ;_cbd !=nil {_ecdf :=_cbd .PlotArea ;if _ecdf ==nil {return nil ,_c .New ("\u004e\u006f\u0020p\u006c\u006f\u0074\u0020\u0061\u0072\u0065\u0061");};_bffa :=&Rectangle {Top :_acde (10),Bottom :_gfe .Bottom -_acde (15),Left :_acde (10),Right :_gfe .Right -_acde (10)};var _dd *Rectangle ;_fda :=_cbd .Legend ;if _fda !=nil {_cfgb :=_fda .Overlay !=nil &&_fda .Overlay .ValAttr !=nil &&*_fda .Overlay .ValAttr ;if _bafd :=_fda .LegendPos ;_bafd !=nil {switch _bafd .ValAttr {case _ea .ST_LegendPosTr :if !_cfgb {_bffa =&Rectangle {Top :_acde (25),Bottom :_gfe .Bottom -_acde (10),Left :_acde (10),Right :_gfe .Right -_acde (25)};};_dd =&Rectangle {Top :_acde (2.5),Bottom :_acde (22.5),Left :_gfe .Right -_acde (22.5),Right :_gfe .Right -_acde (2.5)};case _ea .ST_LegendPosT :_dd =&Rectangle {Top :_acde (2.5),Bottom :_acde (7.5),Left :(_gfe .Right -_gfe .Left )*0.25,Right :(_gfe .Right -_gfe .Left )*0.75};if !_cfgb {_bffa =&Rectangle {Top :_acde (12.5),Bottom :_gfe .Bottom -_acde (15),Left :_acde (10),Right :_gfe .Right -_acde (5)};};_bdf =true ;case _ea .ST_LegendPosB :_dd =&Rectangle {Top :_gfe .Bottom -_acde (7.5),Bottom :_gfe .Bottom -_acde (2.5),Left :(_gfe .Right -_gfe .Left )*0.25,Right :(_gfe .Right -_gfe .Left )*0.75};if !_cfgb {_bffa =&Rectangle {Top :_acde (5),Bottom :_gfe .Bottom -_acde (15),Left :_acde (10),Right :_gfe .Right -_acde (5)};};_bdf =true ;case _ea .ST_LegendPosR :_dd =&Rectangle {Top :(_gfe .Bottom -_gfe .Top )/2-_acde (10),Bottom :(_gfe .Bottom -_gfe .Top )/2+_acde (10),Left :_gfe .Right -_acde (22.5),Right :_gfe .Right -_acde (2.5)};if !_cfgb {_bffa =&Rectangle {Top :_acde (5),Bottom :_gfe .Bottom -_acde (12.5),Left :_acde (10),Right :_gfe .Right -_acde (25)};};case _ea .ST_LegendPosL :_dd =&Rectangle {Top :(_gfe .Bottom -_gfe .Top )/2-_acde (10),Bottom :(_gfe .Bottom -_gfe .Top )/2+_acde (10),Left :_acde (2.5),Right :_acde (22.5)};if !_cfgb {_bffa =&Rectangle {Top :_acde (5),Bottom :_gfe .Bottom -_acde (12.5),Left :_acde (30),Right :_gfe .Right -_acde (5)};};default:_dd =&Rectangle {Top :(_gfe .Bottom -_gfe .Top )/2-_acde (10),Bottom :(_gfe .Bottom -_gfe .Top )/2+_acde (10),Left :_gfe .Right -_acde (25),Right :_gfe .Right -_acde (5)};if !_cfgb {_bffa =&Rectangle {Top :_acde (5),Bottom :_gfe .Bottom -_acde (12.5),Left :_acde (100),Right :_gfe .Right -_acde (25)};};};};};_bffa .scale (_bde );_cdd .drawBorderWithProps (_ecdf .SpPr ,_bffa ,_deg );_befd :=[]*legendItem {};var _dfgg error ;_geb :=_ecdf .CChoice ;for _ ,_cfbf :=range _ecdf .Choice {if _bbb :=_cfbf .BarChart ;_bbb !=nil {_befd ,_dfgg =_cdd .drawBarChart (_bbb ,_bffa ,_geb );if _dfgg !=nil {return nil ,_dfgg ;};};};if _fda !=nil {_dd .scale (_bde );_cdd .drawBorderWithProps (_fda .SpPr ,_dd ,_deg );if len (_befd )!=0{_cdd .drawLegend (_dd ,_befd ,_bdf );};};};_gfe .scale (_bde );_cdd .drawBorderWithProps (_bae .SpPr ,_gfe ,_deg );return _eca ,nil ;};func _abfc (_dcfe ,_bgd ,_afac float64 )float64 {if _dcfe *6< 1{return _afac +(_bgd -_afac )*6*_dcfe ;}else if _dcfe *2< 1{return _bgd ;}else if _dcfe *3< 2{return _afac +(_bgd -_afac )*(2.0/3.0-_dcfe )*6;}else {return _afac ;};};var _dge =_acde (0.5);func DrawLine (c *_ga .Creator ,x0 ,y0 ,x1 ,y1 ,width float64 ,color _ga .Color ){if color ==nil {return ;};_cgd :=c .NewLine (x0 ,y0 ,x1 ,y1 );_cgd .SetLineWidth (width );_cgd .SetColor (color );c .Draw (_cgd );};var _fbg =_acde (1.5);type Rectangle struct{Top float64 ;Bottom float64 ;Left float64 ;Right float64 ;};func _fga (_bag ,_aeg ,_cbbe uint8 )(float64 ,float64 ,float64 ){_beg ,_cdbaa ,_gca :=float64 (_bag )/255,float64 (_aeg )/255,float64 (_cbbe )/255;_cda :=_beg ;if _cdbaa < _cda {_cda =_cdbaa ;};if _gca < _cda {_cda =_gca ;};var _efed ,_fcab bool ;_fef :=_beg ;if _cdbaa > _fef {_fef =_cdbaa ;_efed =true ;};if _gca > _fef {_fef =_gca ;_efed =false ;_fcab =true ;};_dgfe :=(_cda +_fef )/2;var _gaee float64 ;if _cda !=_fef {if _dgfe <=0.5{_gaee =(_fef -_cda )/(_fef +_cda );}else {_gaee =(_fef -_cda )/(2.0-_fef -_cda );};};var _ddfc float64 ;if _cda !=_fef {if _efed {_ddfc =2.0+(_gca -_beg )/(_fef -_cda );}else if _fcab {_ddfc =4.0+(_beg -_cdbaa )/(_fef -_cda );}else {_ddfc =(_cdbaa -_gca )/(_fef -_cda );};_ddfc *=60;if _ddfc < 0{_ddfc +=360;};};return _ddfc ,_gaee ,_dgfe ;};func RegisterFont (name string ,style FontStyle ,font *_ffe .PdfFont ){_gdgf ._bea .Lock ();if _gdgf ._ccbc [name ]==nil {_gdgf ._ccbc [name ]=map[FontStyle ]*_ffe .PdfFont {};};_gdgf ._ccbc [name ][style ]=font ;_gdgf ._bea .Unlock ();};func GetPageFromCreator (c *_ga .Creator )(*_ffe .PdfPage ,error ){_dea :=_g .NewBuffer ([]byte {});_bbf :=c .Write (_dea );if _bbf !=nil {return nil ,_bbf ;};_ggff :=_g .NewReader (_dea .Bytes ());_aagd ,_bbf :=_ffe .NewPdfReader (_ggff );if _bbf !=nil {return nil ,_bbf ;};return _aagd .GetPage (1);};func (_adcc *creatorContext )drawAxes (_egd *_ea .CT_PlotAreaChoice1 ,_bdb ,_aff ,_feg float64 ,_dbff []string ,_cgg *Rectangle ,_ggb bool )error {_eefa :=_adcc ._dbgg ;_eefg :=_adcc ._afb ;if _egd ==nil {return _c .New ("\u004e\u006f\u0020\u0061xi\u0073\u0020\u0069\u006e\u0066\u006f\u0072\u006d\u0061\u0074\u0069\u006f\u006e");};if len (_egd .ValAx )==0||(len (_egd .CatAx )==0&&len (_egd .DateAx )==0&&len (_egd .SerAx )==0){return _c .New ("\u004e\u006f\u0020\u0078\u0020\u006f\u0072\u0020\u0079 \u0061\u0078\u0069\u0073");};var _aeac ,_bfa ,_bcfb ,_gec uint32 ;var _adcf ,_dbg _ea .ST_AxPos ;var _cgf ,_cbe _ea .ST_TickMark ;var _dfd ,_afd *_ea .CT_ChartLines ;var _cbgc ,_abb _ea .ST_TickLblPos ;var _cbgcg ,_afg *_bb .CT_ShapeProperties ;var _cecb error ;_afgd :=_cgg .Right -_cgg .Left ;_abga :=_cgg .Bottom -_cgg .Top ;if len (_egd .ValAx )> 0{_bfa ,_dbg ,_cbe ,_abb ,_afd ,_gec ,_afg ,_cecb =_cdb (_egd .ValAx [0]);};if _dbg !=_ea .ST_AxPosL &&_dbg !=_ea .ST_AxPosB {return _c .New ("\u004f\u006e\u006c\u0079\u0020l\u0065\u0066\u0074\u0020\u006f\u0072\u0020\u0062\u006f\u0074\u0074\u006f\u006d \u0079\u0020\u0061\u0078\u0069\u0073\u0020\u0073\u0075\u0070\u0070\u006f\u0072\u0074\u0020\u0073\u006f\u0020\u0066\u0061\u0072");};_cdgc :=_aff -_bdb ;_addb :=int (_cdgc /_feg )+1;var _fdd ,_gdd float64 ;switch _cbe {case _ea .ST_TickMarkIn :_fdd ,_gdd =_cdg ,0;case _ea .ST_TickMarkOut :_fdd ,_gdd =0,_cdg ;case _ea .ST_TickMarkCross :_fdd ,_gdd =_cdg ,_cdg ;};_fdd =_fdd *_eefg ;_gdd =_gdd *_eefg ;var _aaf *_bb .CT_ShapeProperties ;if _afd !=nil {_aaf =_afd .SpPr ;};_agb ,_ggbe :=_cbgc !=_ea .ST_TickLblPosNone ,_abb !=_ea .ST_TickLblPosNone ;_eag :=_bdb ;if len (_egd .CatAx )> 0{_aeac ,_adcf ,_cgf ,_cbgc ,_dfd ,_bcfb ,_cbgcg ,_cecb =_dff (_egd .CatAx [0]);}else if len (_egd .DateAx )> 0{_aeac ,_adcf ,_cgf ,_cbgc ,_dfd ,_bcfb ,_cbgcg ,_cecb =_eecf (_egd .DateAx [0]);}else if len (_egd .SerAx )> 0{_aeac ,_adcf ,_cgf ,_cbgc ,_dfd ,_bcfb ,_cbgcg ,_cecb =_cefa (_egd .SerAx [0]);};if _cecb !=nil {return _cecb ;};if _adcf !=_ea .ST_AxPosL &&_adcf !=_ea .ST_AxPosB {return _c .New ("\u004f\u006e\u006c\u0079\u0020l\u0065\u0066\u0074\u0020\u006f\u0072\u0020\u0062\u006f\u0074\u0074\u006f\u006d \u0078\u0020\u0061\u0078\u0069\u0073\u0020\u0073\u0075\u0070\u0070\u006f\u0072\u0074\u0020\u0073\u006f\u0020\u0066\u0061\u0072");};if _aeac !=_gec ||_bfa !=_bcfb {return _c .New ("a\u0078i\u0073\u0020\u0069\u0064\u0073\u0020\u0064\u006fn\u0027\u0074\u0020\u006dat\u0063\u0068");};_acbg :=len (_dbff )+1;var _cbdf ,_dba float64 ;switch _cgf {case _ea .ST_TickMarkIn :_cbdf ,_dba =_cdg ,0;case _ea .ST_TickMarkOut :_cbdf ,_dba =0,_cdg ;case _ea .ST_TickMarkCross :_cbdf ,_dba =_cdg ,_cdg ;};_cbdf =_cbdf *_eefg ;_dba =_dba *_eefg ;var _ebcc *_bb .CT_ShapeProperties ;if _dfd !=nil {_ebcc =_dfd .SpPr ;};if _ggb {_cge :=_abga /float64 (len (_dbff ));_cce :=_cgg .Left -_bdb *_afgd /_cdgc ;_dce :=_cce -_gda *_eefg ;if _agb {var _aae float64 ;for _abe :=0;_abe < _acbg ;_abe ++{_gge :=_cgg .Bottom -float64 (_abe )*_cge ;if _abe < _acbg -1{_cgee :=_eefa .NewParagraph (_dbff [_abe ]);_cgee .SetFontSize (_agef *_eefg );_cgee .SetPos (_dce ,_gge -_cge /2-_fbg *_eefg );_eefa .Draw (_cgee );_cfgbe :=(_cgee .Width ()/1000-_gda )*_eefg ;if _cfgbe > 0&&_cfgbe > _aae {_aae =_cfgbe ;};};};if _aae > 0{_cgg .Left +=_aae +_fea ;_cce =_cgg .Left -_bdb *_afgd /_cdgc ;_afgd =_cgg .Right -_cgg .Left ;};};_afdd :=_cce -_dba ;_bcb :=_cce +_cbdf ;_fad :=_cgg .Left ;_gfbg :=_cgg .Right ;for _ageb :=0;_ageb < _acbg ;_ageb ++{_gcec :=_cgg .Bottom -float64 (_ageb )*_cge ;_adcc .drawLineWithProps (_cbgcg ,_afdd ,_gcec ,_bcb ,_gcec ,true );_adcc .drawLineWithProps (_ebcc ,_fad ,_gcec ,_gfbg ,_gcec ,true );};_bdg :=_afgd /_cdgc ;_abc :=_cgg .Bottom -_fdd ;_ggcd :=_cgg .Bottom +_gdd ;_ffc :=_cgg .Top ;_faca :=_cgg .Bottom ;for _gfee :=0;_gfee < _addb ;_gfee ++{_dcf :=_cgg .Left +(_eag -_bdb )*_bdg ;_adcc .drawLineWithProps (_afg ,_dcf ,_abc ,_dcf ,_ggcd ,true );_adcc .drawLineWithProps (_aaf ,_dcf ,_ffc ,_dcf ,_faca ,true );if _ggbe {_gbf :=_eefa .NewParagraph (_ba .FormatFloat (_eag ,'g',-1,64));_gbf .SetFontSize (_agef *_eefg );_gbf .SetPos (_dcf -_dge *_eefg ,_faca +_gfb *_eefg );_eefa .Draw (_gbf );};_eag +=_feg ;};}else {_fgc :=_abga /_cdgc ;_eeb :=_cgg .Left ;if _ggbe {var _aaga float64 ;for _cgbg :=0;_cgbg < _addb ;_cgbg ++{_ca :=_cgg .Bottom -(_eag -_bdb )*_fgc ;_bg :=_eefa .NewParagraph (_ba .FormatFloat (_eag ,'g',-1,64));_bg .SetFontSize (_agef *_eefg );_bg .SetPos (_eeb -_gda *_eefg ,_ca -_fbg *_eefg );_eefa .Draw (_bg );_ddd :=(_bg .Width ()/1000-_gda )*_eefg ;if _ddd > 0&&_ddd > _aaga {_aaga =_ddd ;};_eag +=_feg ;};if _aaga > 0{_cgg .Left +=_aaga +_fea ;_afgd =_cgg .Right -_cgg .Left ;};};_eag =_bdb ;_cad :=_cgg .Left -_gdd ;_abbc :=_cgg .Left +_fdd ;_eeb =_cgg .Left ;_ddf :=_cgg .Right ;for _gdgg :=0;_gdgg < _addb ;_gdgg ++{_edgf :=_cgg .Bottom -(_eag -_bdb )*_fgc ;_adcc .drawLineWithProps (_afg ,_cad ,_edgf ,_abbc ,_edgf ,true );_adcc .drawLineWithProps (_aaf ,_eeb ,_edgf ,_ddf ,_edgf ,true );_eag +=_feg ;};_bac :=_afgd /float64 (len (_dbff ));_ddce :=_cgg .Bottom +_bdb *_abga /_cdgc ;_ggcdc :=_ddce -_cbdf ;_dcb :=_ddce +_dba ;_cba :=_cgg .Top ;_agee :=_cgg .Bottom ;_bdga :=_ddce +_gfb *_eefg ;for _bgg :=0;_bgg < _acbg ;_bgg ++{_facc :=_cgg .Left +float64 (_bgg )*_bac ;_adcc .drawLineWithProps (_cbgcg ,_facc ,_ggcdc ,_facc ,_dcb ,true );_adcc .drawLineWithProps (_ebcc ,_facc ,_cba ,_facc ,_agee ,true );if _agb &&_bgg < _acbg -1{_fdg :=_eefa .NewParagraph (_dbff [_bgg ]);_fdg .SetFontSize (_agef *_eefg );_fdg .SetPos (_facc +_afce *_eefg ,_bdga );_eefa .Draw (_fdg );};};};return nil ;};func _caag (_ddg uint8 ,_gfg float64 )string {_bcc :=float64 (_ddg );return _f .Sprintf ("\u0025\u0030\u0032\u0078",int (_bcc *_gfg ));};func (_ccfb *creatorContext )getPdfColorFromSolidFill (_bdeb *_bb .CT_SolidColorFillProperties )_ga .Color {if _bdeb ==nil {return nil ;};_bbdb :="";if _aca :=_bdeb .SrgbClr ;_aca !=nil {_bbdb =_aca .ValAttr ;}else if _gadd :=_bdeb .SchemeClr ;_gadd !=nil {_bbdb =_aggd (_gadd .ValAttr ,_ccfb ._bge );};if _bbdb ==""{return nil ;};return _ga .ColorRGBFromHex ("\u0023"+_bbdb );};var _gdgf =fontsMap {_bea :&_b .Mutex {},_ccbc :map[string ]map[FontStyle ]*_ffe .PdfFont {}};func _eecf (_bba *_ea .CT_DateAx )(uint32 ,_ea .ST_AxPos ,_ea .ST_TickMark ,_ea .ST_TickLblPos ,*_ea .CT_ChartLines ,uint32 ,*_bb .CT_ShapeProperties ,error ){var _becc ,_beeg uint32 ;var _cae _ea .ST_AxPos ;var _feb _ea .ST_TickMark ;var _ecc *_ea .CT_ChartLines ;var _abef _ea .ST_TickLblPos ;if _bba .AxId ==nil {return _becc ,_cae ,_feb ,_abef ,_ecc ,_beeg ,_bba .SpPr ,_c .New ("\u004e\u006f\u0020x\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");}else {_becc =_bba .AxId .ValAttr ;};if _bba .AxPos ==nil {return _becc ,_cae ,_feb ,_abef ,_ecc ,_beeg ,_bba .SpPr ,_c .New ("\u004eo\u0020x\u0020\u0061\u0078\u0069\u0073 \u0070\u006fs\u0069\u0074\u0069\u006f\u006e");}else {_cae =_bba .AxPos .ValAttr ;};if _bba .MajorTickMark !=nil {_feb =_bba .MajorTickMark .ValAttr ;};if _bba .TickLblPos !=nil {_abef =_bba .TickLblPos .ValAttr ;};if _bba .CrossAx ==nil {return _becc ,_cae ,_feb ,_abef ,_ecc ,_beeg ,_bba .SpPr ,_c .New ("\u004e\u006f \u0063\u0072\u006fs\u0073\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");}else {_beeg =_bba .CrossAx .ValAttr ;};_ecc =_bba .MajorGridlines ;return _becc ,_cae ,_feb ,_abef ,_ecc ,_beeg ,_bba .SpPr ,nil ;};func DrawRectangle (c *_ga .Creator ,r *Rectangle ,w float64 ,color _ga .Color ){if color ==nil {return ;};DrawLine (c ,r .Left ,r .Top ,r .Right ,r .Top ,w ,color );DrawLine (c ,r .Left ,r .Top ,r .Left ,r .Bottom ,w ,color );DrawLine (c ,r .Left ,r .Bottom ,r .Right ,r .Bottom ,w ,color );DrawLine (c ,r .Right ,r .Top ,r .Right ,r .Bottom ,w ,color );};type legendItem struct{_fcd string ;_age *_bb .CT_ShapeProperties ;};func PointsFromTwips (twips int64 )float64 {return float64 (int64 (float64 (twips )*_cb .Twips *10+0.5))/10;};var _dgc =_acde (1.5);const DefaultFontSize =12.0;func TwipsFromPoints (points float64 )float64 {return points /_cb .Twips };func AdjustColorByTint (colorStr string ,tint float64 )string {var _bddg ,_abea ,_eaa uint8 ;_ffgb ,_ :=_f .Sscanf (colorStr ,"\u0025\u0030\u0032x\u0025\u0030\u0032\u0078\u0025\u0030\u0032\u0078",&_bddg ,&_abea ,&_eaa );if _ffgb !=3{return "";};return _agd (_bddg ,tint )+_agd (_abea ,tint )+_agd (_eaa ,tint );};var _fea =_acde (2);var _gda =_acde (7.5);func GetImage (c *_ga .Creator ,goImg _dg .Image ,imgHeight ,imgWidth ,left ,top ,dividerX ,dividerY float64 ,part ImgPart )(*_ga .Image ,error ){if goImg ==nil {return nil ,nil ;};_dagd :=goImg .Bounds ().Size ();_cea :=_dagd .X ;_dga :=_dagd .Y ;if dividerX !=0{dividerX =dividerX /imgWidth *float64 (_cea );};if dividerY !=0{dividerY =dividerY /imgHeight *float64 (_dga );};var _gbgc _dg .Rectangle ;switch part {case ImgPart_t :_gbgc =_dg .Rect (0,0,_cea ,int (dividerY ));case ImgPart_b :_gbgc =_dg .Rect (0,int (dividerY ),_cea ,_dga );case ImgPart_l :_gbgc =_dg .Rect (0,0,int (dividerX ),_dga );case ImgPart_r :_gbgc =_dg .Rect (int (dividerX ),0,_cea ,_dga );case ImgPart_lt :_gbgc =_dg .Rect (0,0,int (dividerX ),int (dividerY ));case ImgPart_rt :_gbgc =_dg .Rect (int (dividerX ),0,_cea ,int (dividerY ));case ImgPart_lb :_gbgc =_dg .Rect (0,int (dividerY ),int (dividerX ),_dga );case ImgPart_rb :_gbgc =_dg .Rect (int (dividerX ),int (dividerY ),_cea ,_dga );default:_gbgc =_dg .Rect (0,0,_cea ,_dga );};_fgcf :=CropImageByRect (goImg ,_gbgc );_cbbaf ,_dabdf :=c .NewImageFromGoImage (_fgcf );if _dabdf !=nil {return nil ,_dabdf ;};_cbbaf .Scale (imgWidth /float64 (_cea ),imgHeight /float64 (_dga ));_cbbaf .SetPos (left ,top );return _cbbaf ,nil ;};func _agd (_adaf uint8 ,_cbbf float64 )string {_cff :=float64 (_adaf );var _gbe float64 ;if _cbbf < 0{_gbe =_cff *(1+_cbbf );}else {_gbe =_cff +(255-_cff )*_cbbf ;};return _f .Sprintf ("\u0025\u0030\u0032\u0078",int (_gbe ));};type barSerByOrder []*_ea .CT_BarSer ;type FontStyle byte ;var _ecf =map[string ]FontStyle {"\u0052e\u0067\u0075\u006c\u0061\u0072":FontStyle_Regular ,"\u0042\u006f\u006c\u0064":FontStyle_Bold ,"\u0049\u0074\u0061\u006c\u0069\u0063":FontStyle_Italic ,"B\u006f\u006c\u0064\u0020\u0049\u0074\u0061\u006c\u0069\u0063":FontStyle_BoldItalic };func (_cfd *creatorContext )drawRectangleWithProps (_cede *_bb .CT_ShapeProperties ,_cfe ,_adf ,_ebfe ,_ged float64 ,_ebbe bool ){_bgc :=_cfd ._dbgg .NewRectangle (_cfe ,_adf ,_ebfe ,_ged );if _cede ==nil {if _ebbe {_bgc .SetBorderWidth (_deg );}else {return ;};}else {_egc :=_cfd .getPdfColorFromSolidFill (_cede .SolidFill );if _egc !=nil {_bgc .SetFillColor (_egc );};if _bfgg :=_cede .Ln ;_bfgg !=nil {if _abda :=_bfgg .WAttr ;_abda !=nil {_fdb :=_cb .FromEMU (int64 (*_abda ));_bgc .SetBorderWidth (_fdb );if _dda :=_bfgg .SolidFill ;_dda !=nil {_fdf :=_cfd .getPdfColorFromSolidFill (_dda );if _fdf !=nil {_bgc .SetBorderColor (_fdf );};};}else {_bgc .SetBorderWidth (0);};};};_cfd ._dbgg .Draw (_bgc );};func (_abf barSerByOrder )Len ()int {return len (_abf )};var _cdg =_acde (1);func (_dfb *creatorContext )drawLegend (_ffbd *Rectangle ,_cegb []*legendItem ,_dad bool ){_fed :=_dfb ._afb ;_fdc :=_acde (2.5)*_fed ;_bec :=_dgc *_fed ;_cege :=(_fdc -_bec )/2;_befc :=float64 (len (_cegb ));if _dad {_deeg :=&Rectangle {Top :_ffbd .Top +_acde (1)*_fed ,Bottom :_ffbd .Bottom -_acde (1)*_fed ,Left :_ffbd .Left +_acde (2.5)*_fed ,Right :_ffbd .Right -_acde (2.5)*_fed };var _gdea float64 ;if _befc > 1{_gdea =(_deeg .Right -_deeg .Left )/_befc ;};_dabd :=_deeg .Left ;_fbb :=_deeg .Top ;for _ ,_gage :=range _cegb {if _faa :=_gage ._age ;_faa !=nil {_dfb .drawRectangleWithProps (_faa ,_dabd ,_fbb +_cege ,_bec ,_bec ,false );_ef :=_dabd +_bec *2;_cfa :=_dfb ._dbgg .NewStyledParagraph ();_cfa .SetPos (_ef ,_fbb );_cgc :=_cfa .Append (_gage ._fcd );_dac ,_dfga :=_ffe .NewStandard14Font (_ffe .HelveticaName );if _dfga ==nil {_cgc .Style =_ga .TextStyle {FontSize :_fdc ,Font :_dac ,TextRise :0.4};_dfb ._dbgg .Draw (_cfa );};};_dabd +=_gdea ;};}else {_dec :=&Rectangle {Top :_ffbd .Top +_acde (2.5)*_fed ,Bottom :_ffbd .Bottom -_acde (2.5)*_fed ,Left :_ffbd .Left +_acde (2.5)*_fed ,Right :_ffbd .Right -_acde (2.5)*_fed };var _ddc float64 ;if _befc > 1{_ddc =(_dec .Bottom -_dec .Top -_fdc )/(_befc -1);};_eda :=_dec .Top ;_gea :=_dec .Left ;_bab :=_gea +_bec *2;for _ ,_gdgc :=range _cegb {if _ageg :=_gdgc ._age ;_ageg !=nil {_dfb .drawRectangleWithProps (_ageg ,_gea ,_eda +_cege ,_bec ,_bec ,false );_accg :=_dfb ._dbgg .NewStyledParagraph ();_accg .SetPos (_bab ,_eda );_acb :=_accg .Append (_gdgc ._fcd );_fag ,_afc :=_ffe .NewStandard14Font (_ffe .HelveticaName );if _afc ==nil {_acb .Style =_ga .TextStyle {FontSize :_fdc ,Font :_fag ,TextRise :0.4};_dfb ._dbgg .Draw (_accg );};};_eda +=_ddc ;};};};var _gfb =_acde (1.5);func _afff (_gef ,_aba ,_dgb float64 )(uint8 ,uint8 ,uint8 ){var _ddced float64 ;if _dgb < 0.5{_ddced =_dgb *(1+_aba );}else {_ddced =_dgb +_aba -_dgb *_aba ;};_gfa :=_dgb *2-_ddced ;_gef /=360.0;_fgdfc :=_dbb (_gef +1.0/3.0);_aaed :=_dbb (_gef );_gfd :=_dbb (_gef -1.0/3.0);_egbb :=_abfc (_fgdfc ,_ddced ,_gfa );_aaa :=_abfc (_aaed ,_ddced ,_gfa );_ebea :=_abfc (_gfd ,_ddced ,_gfa );return uint8 (255*_egbb ),uint8 (255*_aaa ),uint8 (255*_ebea );};func _dbb (_bdbc float64 )float64 {if _bdbc < 0{_bdbc +=float64 (-int (_bdbc )+1);}else if _bdbc > 1{_bdbc -=float64 (int (_bdbc ));};return _bdbc ;};func GetOpacityFromColorTransform (trs []*_bb .EG_ColorTransform )float64 {for _ ,_dag :=range trs {if _dag !=nil {if _dgcb :=_dag .Alpha ;_dgcb !=nil {if _cab :=_dgcb .ValAttr .ST_PositiveFixedPercentageDecimal ;_cab !=nil {return float64 (*_cab )/100000;};};};};return 1.0;};func RegisterFontsFromDirectory (dirName string )error {_gcad ,_gaeg :=_d .Open (dirName );if _gaeg !=nil {return _gaeg ;};defer _gcad .Close ();_bfgd ,_gaeg :=_gcad .Readdirnames (0);if _gaeg !=nil {return _gaeg ;};for _ ,_gbeg :=range _bfgd {if _eb .HasSuffix (_gbeg ,"\u002e\u0074\u0074\u0066"){_cbba :=dirName +"\u002f"+_gbeg ;_gac ,_aaeb :=_cefg (_cbba );if _gac ==""||_aaeb ==""{continue ;};_bbda ,_geaf :=_ffe .NewCompositePdfFontFromTTFFile (_cbba );if _geaf !=nil {_a .Log .Debug ("C\u0061\u006e\u006e\u006f\u0074\u0020m\u0061\u006b\u0065\u0020\u0061\u0020f\u006f\u006e\u0074\u0020\u0066\u0072\u006fm\u0020\u0054\u0054\u0046\u0020\u0066\u0069\u006c\u0065\u0020%\u0073",_geaf );continue ;};RegisterFont (_gac ,_ecf [_aaeb ],_bbda );};};return nil ;};func (_ccg *creatorContext )drawBorderWithProps (_fcg *_bb .CT_ShapeProperties ,_baef *Rectangle ,_ebfef float64 ){if _baef !=nil &&_fcg !=nil &&_fcg .Ln !=nil &&_fcg .Ln .SolidFill !=nil {_dfbd :=_ccg .getPdfColorFromSolidFill (_fcg .Ln .SolidFill );DrawRectangle (_ccg ._dbgg ,_baef ,_ebfef ,_dfbd );};};func (_ccb barSerByOrder )Swap (i ,j int ){_ccb [i ],_ccb [j ]=_ccb [j ],_ccb [i ]};func GetRegisteredFont (name string ,style FontStyle )*_ffe .PdfFont {_gdgf ._bea .Lock ();defer _gdgf ._bea .Unlock ();if _gecc ,_dbffe :=_gdgf ._ccbc [name ];_dbffe {if _cbge ,_cag :=_gecc [style ];_cag {return _cbge ;};};return nil ;};func MakeImageFromChartSpace (cs *_ea .ChartSpace ,width ,height float64 ,theme *_bb .Theme )(_dg .Image ,error ){_add ,_aab :=_eef (cs ,width ,height ,theme ,true );if _aab !=nil {return nil ,_aab ;};_dbf ,_aab :=GetPageFromCreator (_add );if _aab !=nil {return nil ,_aab ;};return _gd .NewImageDevice ().Render (_dbf );};func _cefg (_edaf string )(string ,string ){if !_eb .HasSuffix (_edaf ,"\u002e\u0074\u0074\u0066"){_a .Log .Debug ("\u0055\u006es\u0075\u0070\u0070\u006f\u0072\u0074\u0065\u0064\u0020\u0066\u006f\u006e\u0074\u0020\u0066\u0069\u006c\u0065\u0020\u0066\u006f\u0072ma\u0074\u002e");return "","";};_acfb ,_ggfa :=_ff .ParseFile (_edaf );if _ggfa !=nil {_a .Log .Debug ("\u0043a\u006e\u006e\u006f\u0074\u0020\u0070\u0061\u0072\u0073\u0065\u0020T\u0054\u0046\u0020\u0066\u0069\u006c\u0065\u0020\u0025\u0073",_ggfa );return "","";};_gdb :=_acfb .GetNameByID (1);if _gdb ==""{_a .Log .Debug ("\u004e\u006f\u0020\u0066\u006fn\u0074\u0020\u0066\u0061\u006d\u0069\u006c\u0079\u0020\u0069\u006e\u0066\u006fr\u006d\u0061\u0074\u0069\u006f\u006e\u0020\u0069\u006e\u0020\u0074\u0068\u0065\u0020\u0066\u0069\u006c\u0065\u0020\u0025\u0073",_edaf );return "","";};_dadd :=make ([]byte ,0);for _gad :=0;_gad < len (_gdb );_gad ++{if _gdb [_gad ]==39||_gdb [_gad ]==92{continue ;};_bebg :=4;if _gad +_bebg < len (_gdb ){if _gdb [_gad :_gad +_bebg ]=="\u0000"{_gad =_gad +_bebg +1;continue ;};};_dadd =append (_dadd ,_gdb [_gad ]);};_gdb =_eb .Replace (string (_dadd ),"\u0078\u0030\u0030","",-1);_deea :=_acfb .GetNameByID (2);if _deea ==""{_a .Log .Debug ("N\u006f\u0020\u0073\u0074\u0079\u006ce\u0020\u0069\u006e\u0066\u006f\u0072m\u0061\u0074\u0069\u006f\u006e\u0020\u0069n\u0020\u0074\u0068\u0065\u0020\u0066\u0069\u006c\u0065\u0020%\u0073",_edaf );return "","";};_dadd =make ([]byte ,0);for _cefae :=0;_cefae < len (_deea );_cefae ++{if _deea [_cefae ]==39||_deea [_cefae ]==92{continue ;};_faf :=4;if _cefae +_faf < len (_deea ){if _deea [_cefae :_cefae +_faf ]=="\u0000"{_cefae =_cefae +_faf +1;continue ;};};_dadd =append (_dadd ,_deea [_cefae ]);};_deea =_eb .Replace (string (_dadd ),"\u0078\u0030\u0030","",-1);return _gdb ,_deea ;};const (FontStyle_Regular FontStyle =0;FontStyle_Bold FontStyle =1;FontStyle_Italic FontStyle =2;FontStyle_BoldItalic FontStyle =3;);func MakeBlockFromCreator (c *_ga .Creator )(*_ga .Block ,error ){_aad ,_geba :=GetPageFromCreator (c );if _geba !=nil {return nil ,_geba ;};_abfcg ,_geba :=_ga .NewBlockFromPage (_aad );if _geba !=nil {return nil ,_geba ;};return _abfcg ,nil ;};type serValue struct{_acf string ;_aea float64 ;_gdg *_bb .CT_ShapeProperties ;};func Lighten (clr float64 )float64 {return 0.6+0.4*clr };func _aggd (_caa _bb .ST_SchemeColorVal ,_bcfa *_bb .Theme )string {if _cdf :=_bcfa .ThemeElements ;_cdf !=nil {if _dcfd :=_cdf .ClrScheme ;_dcfd !=nil {switch _caa {case _bb .ST_SchemeColorValLt1 :return GetColorStringFromDmlColor (_dcfd .Lt1 );case _bb .ST_SchemeColorValDk1 ,_bb .ST_SchemeColorValTx1 :return GetColorStringFromDmlColor (_dcfd .Dk1 );case _bb .ST_SchemeColorValLt2 :return GetColorStringFromDmlColor (_dcfd .Lt2 );case _bb .ST_SchemeColorValDk2 :return GetColorStringFromDmlColor (_dcfd .Dk2 );case _bb .ST_SchemeColorValAccent1 :return GetColorStringFromDmlColor (_dcfd .Accent1 );case _bb .ST_SchemeColorValAccent2 :return GetColorStringFromDmlColor (_dcfd .Accent2 );case _bb .ST_SchemeColorValAccent3 :return GetColorStringFromDmlColor (_dcfd .Accent3 );case _bb .ST_SchemeColorValAccent4 :return GetColorStringFromDmlColor (_dcfd .Accent4 );case _bb .ST_SchemeColorValAccent5 :return GetColorStringFromDmlColor (_dcfd .Accent5 );case _bb .ST_SchemeColorValAccent6 :return GetColorStringFromDmlColor (_dcfd .Accent6 );};};};return "";};func IsNoSpaceLanguage (symbol string )bool {for _ ,_bcfd :=range symbol {if _ee .Is (_ee .Han ,_bcfd ){return true ;};};return false ;};func _cefa (_gbg *_ea .CT_SerAx )(uint32 ,_ea .ST_AxPos ,_ea .ST_TickMark ,_ea .ST_TickLblPos ,*_ea .CT_ChartLines ,uint32 ,*_bb .CT_ShapeProperties ,error ){var _cade ,_afda uint32 ;var _fdaf _ea .ST_AxPos ;var _dcbe _ea .ST_TickMark ;var _fgb *_ea .CT_ChartLines ;var _dgf _ea .ST_TickLblPos ;if _gbg .AxId ==nil {return _cade ,_fdaf ,_dcbe ,_dgf ,_fgb ,_afda ,_gbg .SpPr ,_c .New ("\u004e\u006f\u0020x\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");}else {_cade =_gbg .AxId .ValAttr ;};if _gbg .AxPos ==nil {return _cade ,_fdaf ,_dcbe ,_dgf ,_fgb ,_afda ,_gbg .SpPr ,_c .New ("\u004eo\u0020x\u0020\u0061\u0078\u0069\u0073 \u0070\u006fs\u0069\u0074\u0069\u006f\u006e");}else {_fdaf =_gbg .AxPos .ValAttr ;};if _gbg .MajorTickMark !=nil {_dcbe =_gbg .MajorTickMark .ValAttr ;};if _gbg .TickLblPos !=nil {_dgf =_gbg .TickLblPos .ValAttr ;};if _gbg .CrossAx ==nil {return _cade ,_fdaf ,_dcbe ,_dgf ,_fgb ,_afda ,_gbg .SpPr ,_c .New ("\u004e\u006f \u0063\u0072\u006fs\u0073\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");}else {_afda =_gbg .CrossAx .ValAttr ;};_fgb =_gbg .MajorGridlines ;return _cade ,_fdaf ,_dcbe ,_dgf ,_fgb ,_afda ,_gbg .SpPr ,nil ;};func (_gbc FontStyle )String ()string {return []string {"\u0052e\u0067\u0075\u006c\u0061\u0072","\u0042\u006f\u006c\u0064","\u0049\u0074\u0061\u006c\u0069\u0063","\u0042\u006f\u006c\u0064\u0049\u0074\u0061\u006c\u0069\u0063"}[int (_gbc )];};func AdjustColorByLumMod (colorStr string ,lum float64 )string {var _fde ,_bbd ,_bggc uint8 ;_ace ,_ :=_f .Sscanf (colorStr ,"\u0025\u0030\u0032x\u0025\u0030\u0032\u0078\u0025\u0030\u0032\u0078",&_fde ,&_bbd ,&_bggc );if _ace !=3{return "";};_cee ,_bafdb ,_bacg :=_fga (_fde ,_bbd ,_bggc );_bacg =lum *_bacg ;_fde ,_bbd ,_bggc =_afff (_cee ,_bafdb ,_bacg );return _f .Sprintf ("\u0025\u0030\u0032x\u0025\u0030\u0032\u0078\u0025\u0030\u0032\u0078",_fde ,_bbd ,_bggc );};func FromSTPercentage (st *_bb .ST_Percentage )float64 {if _ccd :=st .ST_PercentageDecimal ;_ccd !=nil {return float64 (*_ccd )/100000;};return 0;};func (_fe *creatorContext )drawBarChart (_ag *_ea .CT_BarChart ,_fa *Rectangle ,_gag *_ea .CT_PlotAreaChoice1 )([]*legendItem ,error ){var _de bool ;if _df :=_ag .BarDir ;_df !=nil {_de =_df .ValAttr ==_ea .ST_BarDirBar ;};_ce :=_ag .Ser ;_ebc .Sort (barSerByOrder (_ce ));_ffb :=map[string ]serCategory {};_bf :=[]string {};_gf :=[]*legendItem {};_bc :=_eg .Inf (1);_ad :=_eg .Inf (-1);for _ ,_abg :=range _ce {var _cf string ;if _dfa :=_abg .Tx ;_dfa !=nil {if _fac :=_dfa .Choice ;_fac !=nil {if _fac .V !=nil {_cf =*_fac .V ;}else if _fab :=_fac .StrRef ;_fab !=nil {if _be :=_fab .StrCache ;_be !=nil {for _ ,_ceg :=range _be .Pt {_cf =_ceg .V ;};};};};};if _gg :=_abg .Cat ;_gg !=nil {if _ebe :=_gg .Choice ;_ebe !=nil {if _bee :=_ebe .StrRef ;_bee !=nil {if _da :=_bee .StrCache ;_da !=nil {for _ ,_bd :=range _da .Pt {_ebb :=_bd .V ;if _ ,_ed :=_ffb [_ebb ];!_ed {_ffb [_ebb ]=serCategory {_fd :_ebb ,_gce :[]serValue {}};_bf =append (_bf ,_ebb );};};};}else if _dab :=_ebe .NumRef ;_dab !=nil {if _baf :=_dab .NumCache ;_baf !=nil {var _edd string ;if _baf .FormatCode !=nil {_edd =*_baf .FormatCode ;};for _ ,_gff :=range _baf .Pt {var _cfb string ;if _gff .FormatCodeAttr ==nil {_cfb =_edd ;}else {_cfb =*_gff .FormatCodeAttr ;};var _gb string ;_aeb ,_cec :=_ba .ParseFloat (_gff .V ,64);if _cec !=nil {_gb =_gff .V ;}else {_gb =_dc .Number (_aeb ,_cfb );};if _ ,_cg :=_ffb [_gb ];!_cg {_ffb [_gb ]=serCategory {_fd :_gb ,_gce :[]serValue {}};_bf =append (_bf ,_gb );};};};};};};if _cc :=_abg .Val ;_cc !=nil {if _gbb :=_cc .Choice ;_gbb !=nil {if _af :=_gbb .NumRef ;_af !=nil {if _fg :=_af .NumCache ;_fg !=nil {for _cef ,_gba :=range _fg .Pt {_eec ,_ced :=_ba .ParseFloat (_gba .V ,64);if _ced !=nil {_eec =0;_a .Log .Debug ("\u0070a\u0072s\u0065\u0020\u0065\u0072\u0072\u006f\u0072\u003a\u0020\u0025\u0073",_ced );};if _eec > _ad {_ad =_eec ;};if _eec < _bc {_bc =_eec ;};_cd :=_ffb [_bf [_cef ]];_cd ._gce =append (_cd ._gce ,serValue {_acf :_cf ,_aea :_eec ,_gdg :_abg .SpPr });_ffb [_bf [_cef ]]=_cd ;};};};};};_gf =append (_gf ,&legendItem {_fcd :_cf ,_age :_abg .SpPr });};var _aec float64 ;var _gde ,_cbg float64 ;if _ad ==0&&_bc ==0{_aec =0.2;_cbg =0;_gde =1;}else {var _ebf float64 ;if _fc :=_eg .Abs (_bc );_ad < _fc {_ebf =_fc ;}else {_ebf =_ad ;};_dcc :=_eg .Pow (10,_eg .Floor (_eg .Log10 (_ebf )));_aa :=_ebf /_dcc ;if _aa >=1.715&&_aa < 4.29{_aec =0.5;}else if _aa >=4.29&&_aa < 8.58{_aec =1;}else {_aec =2;};_aec *=_dcc ;if _ad <=0{_gde =0;}else {_gde =(_eg .Ceil (_ad /_aec )+1)*_aec ;};if _bc >=0{_cbg =0;}else {_cbg =(_eg .Floor (_bc /_aec )-1)*_aec ;};};_gbd :=_fe .drawAxes (_gag ,_cbg ,_gde ,_aec ,_bf ,_fa ,_de );if _gbd !=nil {return nil ,_gbd ;};_gfc :=0.0;if _ag .GapWidth !=nil {if _ge :=_ag .GapWidth .ValAttr ;_ge !=nil {if _dfe :=_ge .ST_GapAmountUShort ;_dfe !=nil {_gfc =float64 (*_dfe )/100.0;};};};_adc :=_fa .Right -_fa .Left ;_cgb :=_fa .Bottom -_fa .Top ;_cbb :=float64 (len (_bf ));if _de {_aag :=_gde /(_gde -_cbg )*_adc ;_edg :=-_cbg /(_gde -_cbg )*_adc ;_ffd :=_fa .Left +_edg ;_beee :=_cgb /_cbb ;for _fgd ,_ecg :=range _bf {_ggc :=_ffb [_ecg ];_bff :=float64 (len (_ggc ._gce ))+_gfc ;_bef :=_beee /_bff ;_ccf :=_bef *_gfc ;_ada :=_fa .Bottom -float64 (_fgd )*_beee -_ccf /2-_bef ;for _ ,_beef :=range _ggc ._gce {if _beef ._aea ==0{continue ;};var _beb ,_ac float64 ;if _beef ._aea > 0{_ac =_beef ._aea /_gde *_aag ;_fe .drawRectangleWithProps (_beef ._gdg ,_ffd ,_ada ,_ac ,_bef ,false );}else {_ac =_beef ._aea /_cbg *_edg ;_beb =_ffd -_ac ;_fe .drawRectangleWithProps (_beef ._gdg ,_beb ,_ada ,_ac ,_bef ,false );};_ada -=_bef ;};};}else {_agc :=_gde /(_gde -_cbg )*_cgb ;_abd :=-_cbg /(_gde -_cbg )*_cgb ;_fca :=_fa .Top +_agc ;_eee :=_adc /_cbb ;for _gaf ,_ebg :=range _bf {_ebd :=_ffb [_ebg ];_ecd :=float64 (len (_ebd ._gce ))+_gfc ;_dfg :=_eee /_ecd ;_egb :=_dfg *_gfc ;_gc :=_fa .Left +float64 (_gaf )*_eee +_egb /2;for _ ,_acc :=range _ebd ._gce {var _db ,_adg float64 ;if _acc ._aea > 0{_adg =_acc ._aea /_gde *_agc ;_db =_fca -_adg ;_fe .drawRectangleWithProps (_acc ._gdg ,_gc ,_db ,_dfg ,_adg ,false );}else {_adg =_acc ._aea /_cbg *_abd ;_fe .drawRectangleWithProps (_acc ._gdg ,_gc ,_fca ,_dfg ,_adg ,false );};_gc +=_dfg ;};};};return _gf ,nil ;};var _afce =_acde (5);func FromSTCoordinate (st _bb .ST_Coordinate )int64 {if _ebeg :=st .ST_CoordinateUnqualified ;_ebeg !=nil {return *_ebeg ;};return 0;};func AdjustColorByShade (colorStr string ,shade float64 )string {var _ebec ,_afa ,_gcc uint8 ;_aeag ,_ :=_f .Sscanf (colorStr ,"\u0025\u0030\u0032x\u0025\u0030\u0032\u0078\u0025\u0030\u0032\u0078",&_ebec ,&_afa ,&_gcc );if _aeag !=3{return "";};return _caag (_ebec ,shade )+_caag (_afa ,shade )+_caag (_gcc ,shade );};type BorderPosition byte ;const (BorderPositionTop BorderPosition =0;BorderPositionLeft BorderPosition =1;BorderPositionBottom BorderPosition =2;BorderPositionRight BorderPosition =3;);var _deg =_acde (0.125);func (_dgeb *creatorContext )drawLineWithProps (_cfgc *_bb .CT_ShapeProperties ,_abbcg ,_bbe ,_gcb ,_gdae float64 ,_egdf bool ){if _cfgc !=nil {if _dgg :=_cfgc .Ln ;_dgg !=nil {_degc :=_dgeb .getPdfColorFromSolidFill (_dgg .SolidFill );if _degc ==nil &&_egdf {_degc =_ga .ColorBlack ;};if _degc !=nil {var _deb float64 ;if _eeef :=_dgg .WAttr ;_eeef !=nil {_deb =_cb .FromEMU (int64 (*_eeef ));}else {_deb =_deg ;};DrawLine (_dgeb ._dbgg ,_abbcg ,_bbe ,_gcb ,_gdae ,_deb ,_degc );};};};};type serCategory struct{_fd string ;_gce []serValue ;};func GetDataFromXfrm (xfrm *_bb .CT_Transform2D )(float64 ,float64 ,float64 ,float64 ){var _abfd ,_caaga ,_bcg ,_afad float64 ;if _daaba :=xfrm .Off ;_daaba !=nil {_abfd =_cb .FromEMU (FromSTCoordinate (_daaba .XAttr ));_caaga =_cb .FromEMU (FromSTCoordinate (_daaba .YAttr ));};if _debe :=xfrm .Ext ;_debe !=nil {_bcg =_cb .FromEMU (_debe .CxAttr );_afad =_cb .FromEMU (_debe .CyAttr );};return _abfd ,_caaga ,_bcg ,_afad ;};type fontsMap struct{_bea *_b .Mutex ;_ccbc map[string ]map[FontStyle ]*_ffe .PdfFont ;};func AssignStdFontByName (style _ga .TextStyle ,fontName string )*_ffe .PdfFont {_dfbc :=_ffe .StdFontName (fontName );return _ffe .NewStandard14FontMustCompile (_dfbc );};func _dff (_cga *_ea .CT_CatAx )(uint32 ,_ea .ST_AxPos ,_ea .ST_TickMark ,_ea .ST_TickLblPos ,*_ea .CT_ChartLines ,uint32 ,*_bb .CT_ShapeProperties ,error ){var _fbe ,_bdd uint32 ;var _cedf _ea .ST_AxPos ;var _dcbb _ea .ST_TickMark ;var _daa *_ea .CT_ChartLines ;var _fcc _ea .ST_TickLblPos ;if _cga .AxId ==nil {return _fbe ,_cedf ,_dcbb ,_fcc ,_daa ,_bdd ,_cga .SpPr ,_c .New ("\u004e\u006f\u0020x\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");}else {_fbe =_cga .AxId .ValAttr ;};if _cga .AxPos ==nil {return _fbe ,_cedf ,_dcbb ,_fcc ,_daa ,_bdd ,_cga .SpPr ,_c .New ("\u004eo\u0020x\u0020\u0061\u0078\u0069\u0073 \u0070\u006fs\u0069\u0074\u0069\u006f\u006e");}else {_cedf =_cga .AxPos .ValAttr ;};if _cga .MajorTickMark !=nil {_dcbb =_cga .MajorTickMark .ValAttr ;};if _cga .TickLblPos !=nil {_fcc =_cga .TickLblPos .ValAttr ;};if _cga .CrossAx ==nil {return _fbe ,_cedf ,_dcbb ,_fcc ,_daa ,_bdd ,_cga .SpPr ,_c .New ("\u004e\u006f \u0063\u0072\u006fs\u0073\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");}else {_bdd =_cga .CrossAx .ValAttr ;};_daa =_cga .MajorGridlines ;return _fbe ,_cedf ,_dcbb ,_fcc ,_daa ,_bdd ,_cga .SpPr ,nil ;};const (ImgPart_whole ImgPart =0;ImgPart_t ImgPart =1;ImgPart_b ImgPart =2;ImgPart_l ImgPart =3;ImgPart_r ImgPart =4;ImgPart_lt ImgPart =5;ImgPart_rt ImgPart =6;ImgPart_lb ImgPart =7;ImgPart_rb ImgPart =8;);func _acde (_ebgc float64 )float64 {return _ebgc *_cb .Millimeter };func _dae (_edae _bb .ST_SchemeColorVal ,_cac *_bb .Theme )string {if _fbf :=_cac .ThemeElements ;_fbf !=nil {if _cdba :=_fbf .ClrScheme ;_cdba !=nil {switch _edae {case _bb .ST_SchemeColorValLt1 :return GetColorStringFromDmlColor (_cdba .Lt1 );case _bb .ST_SchemeColorValDk1 ,_bb .ST_SchemeColorValTx1 :return GetColorStringFromDmlColor (_cdba .Dk1 );case _bb .ST_SchemeColorValLt2 :return GetColorStringFromDmlColor (_cdba .Lt2 );case _bb .ST_SchemeColorValDk2 :return GetColorStringFromDmlColor (_cdba .Dk2 );case _bb .ST_SchemeColorValAccent1 :return GetColorStringFromDmlColor (_cdba .Accent1 );case _bb .ST_SchemeColorValAccent2 :return GetColorStringFromDmlColor (_cdba .Accent2 );case _bb .ST_SchemeColorValAccent3 :return GetColorStringFromDmlColor (_cdba .Accent3 );case _bb .ST_SchemeColorValAccent4 :return GetColorStringFromDmlColor (_cdba .Accent4 );case _bb .ST_SchemeColorValAccent5 :return GetColorStringFromDmlColor (_cdba .Accent5 );case _bb .ST_SchemeColorValAccent6 :return GetColorStringFromDmlColor (_cdba .Accent6 );};};};return "";};const _agef =6.0;func (_agcg barSerByOrder )Less (i ,j int )bool {return _agcg [i ].Order .ValAttr < _agcg [j ].Order .ValAttr ;};func (_bbaf *Rectangle )scale (_fge float64 ){_bbaf .Top *=_fge ;_bbaf .Bottom *=_fge ;_bbaf .Left *=_fge ;_bbaf .Right *=_fge ;};func RegisterFontsFromFiles (files []string )error {for _ ,_gfad :=range files {if _eb .HasSuffix (_gfad ,"\u002e\u0074\u0074\u0066"){_daec ,_caea :=_cefg (_gfad );if _daec ==""||_caea ==""{continue ;};_ccba ,_bebe :=_ffe .NewCompositePdfFontFromTTFFile (_gfad );if _bebe !=nil {_a .Log .Debug ("C\u0061\u006e\u006e\u006f\u0074\u0020m\u0061\u006b\u0065\u0020\u0061\u0020f\u006f\u006e\u0074\u0020\u0066\u0072\u006fm\u0020\u0054\u0054\u0046\u0020\u0066\u0069\u006c\u0065\u0020%\u0073",_bebe );continue ;};RegisterFont (_daec ,_ecf [_caea ],_ccba );};};return nil ;};func CropImageByRect (sourceImg _dg .Image ,rect _dg .Rectangle )_dg .Image {_gfba ,_gede ,_agebf ,_eba :=rect .Min .X ,rect .Min .Y ,rect .Max .X ,rect .Max .Y ;_gdf :=_dg .NewNRGBA (_dg .Rect (0,0,_agebf -_gfba ,_eba -_gede ));for _geag :=_gfba ;_geag < _agebf ;_geag ++{for _dgec :=_gede ;_dgec < _eba ;_dgec ++{_gdf .Set (_geag -_gfba ,_dgec -_gede ,sourceImg .At (_geag ,_dgec ));};};return _gdf ;};var StdFontsMap =map[string ][]string {"\u0048e\u006c\u0076\u0065\u0074\u0069\u0063a":[]string {"\u0048e\u006c\u0076\u0065\u0074\u0069\u0063a","\u0048\u0065\u006c\u0076\u0065\u0074\u0069\u0063\u0061-\u0042\u006f\u006c\u0064","\u0048\u0065\u006c\u0076\u0065\u0074\u0069\u0063\u0061\u002d\u004f\u0062l\u0069\u0071\u0075\u0065","H\u0065\u006c\u0076\u0065ti\u0063a\u002d\u0042\u006f\u006c\u0064O\u0062\u006c\u0069\u0071\u0075\u0065"},"\u0043o\u0075\u0072\u0069\u0065\u0072":[]string {"\u0043o\u0075\u0072\u0069\u0065\u0072","\u0043\u006f\u0075r\u0069\u0065\u0072\u002d\u0042\u006f\u006c\u0064","\u0043o\u0075r\u0069\u0065\u0072\u002d\u004f\u0062\u006c\u0069\u0071\u0075\u0065","\u0043\u006f\u0075\u0072ie\u0072\u002d\u0042\u006f\u006c\u0064\u004f\u0062\u006c\u0069\u0071\u0075\u0065"},"\u0054i\u006de\u0073\u0020\u004e\u0065\u0077\u0020\u0052\u006f\u006d\u0061\u006e":[]string {"T\u0069\u006d\u0065\u0073\u002d\u0052\u006f\u006d\u0061\u006e","\u0054\u0069\u006d\u0065\u0073\u002d\u0042\u006f\u006c\u0064","\u0054\u0069\u006de\u0073\u002d\u0049\u0074\u0061\u006c\u0069\u0063","\u0054\u0069m\u0065\u0073\u002dB\u006f\u006c\u0064\u0049\u0074\u0061\u006c\u0069\u0063"},"\u0064e\u0066\u0061\u0075\u006c\u0074":[]string {"\u0048e\u006c\u0076\u0065\u0074\u0069\u0063a","\u0048\u0065\u006c\u0076\u0065\u0074\u0069\u0063\u0061-\u0042\u006f\u006c\u0064","\u0048\u0065\u006c\u0076\u0065\u0074\u0069\u0063\u0061\u002d\u004f\u0062l\u0069\u0071\u0075\u0065","H\u0065\u006c\u0076\u0065ti\u0063a\u002d\u0042\u006f\u006c\u0064O\u0062\u006c\u0069\u0071\u0075\u0065"}};func AdjustColor (colorStr string ,EG_ColorTransform []*_bb .EG_ColorTransform )string {for _ ,_ageff :=range EG_ColorTransform {if _gee :=_ageff .Tint ;_gee !=nil {if _baa :=_gee .ValAttr .ST_PositiveFixedPercentageDecimal ;_baa !=nil {colorStr =AdjustColorByTint (colorStr ,float64 (*_baa )/100000);};};if _dbe :=_ageff .Shade ;_dbe !=nil {if _efe :=_dbe .ValAttr .ST_PositiveFixedPercentageDecimal ;_efe !=nil {colorStr =AdjustColorByShade (colorStr ,float64 (*_efe )/100000);};};if _aaea :=_ageff .LumMod ;_aaea !=nil {if _afca :=_aaea .ValAttr .ST_PercentageDecimal ;_afca !=nil {colorStr =AdjustColorByLumMod (colorStr ,float64 (*_afca )/100000);};};};return colorStr ;};func (_dgd *Rectangle )Translate (x ,y float64 ){_dgd .Left +=x ;_dgd .Right +=x ;_dgd .Top +=y ;_dgd .Bottom +=y ;};func MakeTempCreator (width ,height float64 )*_ga .Creator {_edf :=_ga .New ();_edf .SetPageSize (_ga .PageSize {width ,height });_edf .SetPageMargins (0,0,0,0);return _edf ;};type creatorContext struct{_dbgg *_ga .Creator ;_bge *_bb .Theme ;_afb float64 ;};func _cdb (_gcg *_ea .CT_ValAx )(uint32 ,_ea .ST_AxPos ,_ea .ST_TickMark ,_ea .ST_TickLblPos ,*_ea .CT_ChartLines ,uint32 ,*_bb .CT_ShapeProperties ,error ){var _ceda ,_bcd uint32 ;var _ffg _ea .ST_AxPos ;var _caf _ea .ST_TickMark ;var _daab *_ea .CT_ChartLines ;var _adgc _ea .ST_TickLblPos ;if _gcg .AxId ==nil {return _ceda ,_ffg ,_caf ,_adgc ,_daab ,_bcd ,_gcg .SpPr ,_c .New ("\u004e\u006f\u0020x\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");}else {_ceda =_gcg .AxId .ValAttr ;};if _gcg .AxPos ==nil {return _ceda ,_ffg ,_caf ,_adgc ,_daab ,_bcd ,_gcg .SpPr ,_c .New ("\u004eo\u0020x\u0020\u0061\u0078\u0069\u0073 \u0070\u006fs\u0069\u0074\u0069\u006f\u006e");}else {_ffg =_gcg .AxPos .ValAttr ;};if _gcg .MajorTickMark !=nil {_caf =_gcg .MajorTickMark .ValAttr ;};if _gcg .TickLblPos !=nil {_adgc =_gcg .TickLblPos .ValAttr ;};if _gcg .CrossAx ==nil {return _ceda ,_ffg ,_caf ,_adgc ,_daab ,_bcd ,_gcg .SpPr ,_c .New ("\u004e\u006f \u0063\u0072\u006fs\u0073\u0020\u0061\u0078\u0069\u0073\u0020\u0049\u0044");}else {_bcd =_gcg .CrossAx .ValAttr ;};_daab =_gcg .MajorGridlines ;return _ceda ,_ffg ,_caf ,_adgc ,_daab ,_bcd ,_gcg .SpPr ,nil ;};func MakeBlockFromChartSpace (cs *_ea .ChartSpace ,width ,height float64 ,theme *_bb .Theme )(*_ga .Block ,error ){_bfg ,_cca :=_eef (cs ,width ,height ,theme ,false );if _cca !=nil {return nil ,_cca ;};_ccbf ,_cca :=GetPageFromCreator (_bfg );if _cca !=nil {return nil ,_cca ;};_agg ,_cca :=_ga .NewBlockFromPage (_ccbf );if _cca !=nil {return nil ,_cca ;};return _agg ,nil ;};